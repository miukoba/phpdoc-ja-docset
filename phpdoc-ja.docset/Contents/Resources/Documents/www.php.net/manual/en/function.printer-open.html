<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>プリンタへの接続をオープンする</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.printer-logical-fontheight.html">printer_logical_fontheight</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.printer-select-brush.html">printer_select_brush</a></div>
 <div class="up"><a href="ref.printer.html">プリンタ 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.printer-open" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">printer_open</h1>
  <p class="verinfo">(PECL printer SVN)</p><p class="refpurpose"><span class="refname">printer_open</span> &mdash; <span class="dc-title">プリンタへの接続をオープンする</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.printer-open-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>printer_open</strong></span>
    ([ <span class="methodparam"><span class="type">string</span> <code class="parameter">$printername</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   この関数は、指定したプリンタへの接続を試みます。
  </p>
  <p class="para">
    <span class="function"><strong>printer_open()</strong></span> は、
   デバイスコンテキストも開始します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.printer-open-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><em><code class="parameter">printername</code></em></span>
     <dd>

      <p class="para">
       プリンタ名。このパラメータが指定されない場合、
       この関数はデフォルトのプリンタへの接続をオープンします(<var class="filename">php.ini</var> に
       <em>printer.default_printer</em> として指定されていない場合は、
       PHP はデフォルトのプリンタの検出を試みます)。
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.printer-open-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功時にハンドルを返します。失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.printer-open-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-5335">
    <p><strong>例1  <span class="function"><strong>printer_open()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$handle&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">printer_open</span><span style="color: #007700">(</span><span style="color: #DD0000">"HP&nbsp;Deskjet&nbsp;930c"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$handle&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">printer_open</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="91605""></a>
  <div class="note">
   <strong class="user">Sunny Chan from HK</strong>
   <a href="#91605" class="date">19-Jun-2009 06:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you cannot print on a client shared printer, you may create a admin user account, and assign it to run Apache under Windows Service.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89731""></a>
  <div class="note">
   <strong class="user">John Middleton</strong>
   <a href="#89731" class="date">20-Mar-2009 07:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had been playing around with trying to get PHP to print to a network server off and on for quite some time, and I finally came across somebody who had the piece of the puzzle I've been missing.<br />
<br />
Like I said, the printer I've been trying to print to is a network printer, so I had been trying to open the printer as follows:<br />
<br />
<span class="default">&lt;?php printer_open</span><span class="keyword">(</span><span class="string">"\\\\servername\\printername"</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
What I had been missing is that the function needed the internet host name of the server, which includes the domain name.&nbsp; So, let's say my print server was called "PServer" and my network's domain was called php.net:<br />
<br />
<span class="default">&lt;?php printer_open</span><span class="keyword">(</span><span class="string">"\\\\Pserver.php.net\\printername"</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
This will more than likely work, then you can open and print a file as follows:<br />
<br />
<span class="default">&lt;?php<br />
$printer </span><span class="keyword">= </span><span class="string">"\\\\Pserver.php.net\\printername"</span><span class="keyword">);<br />
if(</span><span class="default">$ph </span><span class="keyword">= </span><span class="default">printer_open</span><span class="keyword">(</span><span class="default">$printer</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp; </span><span class="comment">// Get file contents<br />
&nbsp;&nbsp; </span><span class="default">$fh </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"filename.ext"</span><span class="keyword">, </span><span class="string">"rb"</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$content </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">(</span><span class="string">"filename.ext"</span><span class="keyword">));<br />
&nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; </span><span class="comment">// Set print mode to RAW and send PDF to printer<br />
&nbsp;&nbsp; </span><span class="default">printer_set_option</span><span class="keyword">(</span><span class="default">$ph</span><span class="keyword">, </span><span class="default">PRINTER_MODE</span><span class="keyword">, </span><span class="string">"RAW"</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">printer_write</span><span class="keyword">(</span><span class="default">$ph</span><span class="keyword">, </span><span class="default">$content</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">printer_close</span><span class="keyword">(</span><span class="default">$ph</span><span class="keyword">);<br />
}<br />
else </span><span class="string">"Couldn't connect..."</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71771""></a>
  <div class="note">
   <strong class="user">knightcon at bluebottle dot com</strong>
   <a href="#71771" class="date">15-Dec-2006 02:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are desperate to do server-side printing with PHP on a *nix machine then you can always use the fsockopen() function and send a pre-build PJL (Printer Job Language) string directly to the printer. As long as your printer supports PJL then there should be no problem. Just also bare in mind that unless you are doing something very special, like sending the print job to a remote printer and not the printer the client is at you should just make a report page generated by php and apply a css stylesheet which makes the page styled for printing.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51403""></a>
  <div class="note">
   <strong class="user">philip</strong>
   <a href="#51403" class="date">29-Mar-2005 11:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function may also return NULL on failure, instead of FALSE.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45249""></a>
  <div class="note">
   <strong class="user">jt at jtis dot de</strong>
   <a href="#45249" class="date">31-Aug-2004 12:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Revision: Single quotes DO work, but with a triple slash, like<br />
printer_open('\\\SERVERNAME\PRINTERNAME');<br />
<br />
Weird.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32705""></a>
  <div class="note">
   <strong class="user">jasonlam_ at hotmail dot com</strong>
   <a href="#32705" class="date">05-Jun-2003 01:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Connecting to Network Printers<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $handle </span><span class="keyword">= </span><span class="default">printer_open</span><span class="keyword">(</span><span class="string">"\\\\DOMAIN_NAME\\Printer_Name"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Similiar to how you would locate a domain on your network<br />
you need to have 2 prefix slashes.&nbsp; But as reminder <br />
you need to escape it.&nbsp; So really you need 4 slashes.&nbsp; It <br />
worked me. Hopefully this helps who is having problems <br />
connecting to network printer.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.printer-logical-fontheight.html">printer_logical_fontheight</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.printer-select-brush.html">printer_select_brush</a></div>
 <div class="up"><a href="ref.printer.html">プリンタ 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
