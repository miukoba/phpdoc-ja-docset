<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>文字列に rot13 変換を行う</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.str-replace.html">str_replace</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.str-shuffle.html">str_shuffle</a></div>
 <div class="up"><a href="ref.strings.html">String 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.str-rot13" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">str_rot13</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.2.0, PHP 5)</p><p class="refpurpose"><span class="refname">str_rot13</span> &mdash; <span class="dc-title">文字列に rot13 変換を行う</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.str-rot13-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>str_rot13</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$str</code></span>
   )</div>

  <p class="para rdfs-comment">
   引数 <em><code class="parameter">str</code></em> に対して ROT13 変換を施し、
   その結果の文字列を返します。
  </p>
  <p class="para">
   ROT13 は、各文字をアルファベット順に 13 文字シフトさせ、
   アルファベット以外の文字はそのままとするエンコードを行います。
   エンコードとデコードは同じ関数で行われます。
   引数にエンコードされた文字列を指定した場合には、元の文字列が返されます。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.str-rot13-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><em><code class="parameter">str</code></em></span>
     <dd>

      <p class="para">
       入力文字列。
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.str-rot13-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   指定した文字列を ROT13 変換した結果を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.str-rot13-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-4853">
    <p><strong>例1  <span class="function"><strong>str_rot13()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">str_rot13</span><span style="color: #007700">(</span><span style="color: #DD0000">'PHP&nbsp;4.3.0'</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;CUC&nbsp;4.3.0<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.str-rot13-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>4.3.0</td>
       <td>
        この関数の挙動が修正されました。以前のバージョンでは、
        <em><code class="parameter">str</code></em> 自体も変更されてしまっていました。
        ちょうど、参照渡しで渡したときと同じような挙動だったのです。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="112599""></a>
  <div class="note">
   <strong class="user">steve</strong>
   <a href="#112599" class="date">03-Jul-2013 06:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Below is a short function that allows you to rotate a string which includes non alphabetic characters you choose.<br />
<br />
By running the code without the second argument you can both obfuscate then de-obfuscate.&nbsp; This isn't a safe form of encryption, just a quick way to hide stuff from the casual viewer.<br />
<br />
function str_rot($s, $n = -1) {<br />
&nbsp;&nbsp;&nbsp; //Rotate a string by a number.<br />
&nbsp;&nbsp;&nbsp; static $letters = 'AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789.,!$*+-?@#'; //To be able to de-obfuscate your string the length of this needs to be a multiple of 4 AND no duplicate characters<br />
&nbsp;&nbsp;&nbsp; $letterLen=round(strlen($letters)/2);<br />
&nbsp;&nbsp;&nbsp; if($n==-1) $n=(int)($letterLen/2); //Find the "halfway rotate point"<br />
&nbsp;&nbsp;&nbsp; $n = (int)$n % ($letterLen);<br />
&nbsp;&nbsp;&nbsp; if (!$n) return $s;<br />
&nbsp;&nbsp;&nbsp; if ($n &lt; 0) $n += ($letterLen);<br />
&nbsp;&nbsp;&nbsp; //if ($n == 13) return str_rot13($s);<br />
&nbsp;&nbsp;&nbsp; $rep = substr($letters, $n * 2) . substr($letters, 0, $n * 2);<br />
&nbsp;&nbsp;&nbsp; return strtr($s, $letters, $rep);<br />
}<br />
<br />
$input="ABC123";<br />
$output=str_rot($input);<br />
echo $input." = ".$output." = ".str_rot($output)."&lt;br&gt;";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107475""></a>
  <div class="note">
   <strong class="user">shaun</strong>
   <a href="#107475" class="date">11-Feb-2012 11:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was reminded again of the desire for a generic str_rot function. Character manipulation loops in PHP are slow compared to their C counterparts, so here's a tuned version of the previous function I posted. It's 1.6 times as fast, mainly by avoiding chr() calls.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">str_rot</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">= </span><span class="default">13</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$letters </span><span class="keyword">= </span><span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= (int)</span><span class="default">$n </span><span class="keyword">% </span><span class="default">26</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$n</span><span class="keyword">) return </span><span class="default">$s</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$n </span><span class="keyword">== </span><span class="default">13</span><span class="keyword">) return </span><span class="default">str_rot13</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$l </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$l</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="string">'a' </span><span class="keyword">&amp;&amp; </span><span class="default">$c </span><span class="keyword">&lt;= </span><span class="string">'z'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">$letters</span><span class="keyword">[(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) - </span><span class="default">71 </span><span class="keyword">+ </span><span class="default">$n</span><span class="keyword">) % </span><span class="default">26</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="string">'A' </span><span class="keyword">&amp;&amp; </span><span class="default">$c </span><span class="keyword">&lt;= </span><span class="string">'Z'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">$letters</span><span class="keyword">[(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">) - </span><span class="default">39 </span><span class="keyword">+ </span><span class="default">$n</span><span class="keyword">) % </span><span class="default">26 </span><span class="keyword">+ </span><span class="default">26</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$s</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
But using strtr() you can get something 10 times as fast as the above :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">str_rot</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">= </span><span class="default">13</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$letters </span><span class="keyword">= </span><span class="string">'AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= (int)</span><span class="default">$n </span><span class="keyword">% </span><span class="default">26</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$n</span><span class="keyword">) return </span><span class="default">$s</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$n </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) </span><span class="default">$n </span><span class="keyword">+= </span><span class="default">26</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$n </span><span class="keyword">== </span><span class="default">13</span><span class="keyword">) return </span><span class="default">str_rot13</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rep </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$letters</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">* </span><span class="default">2</span><span class="keyword">) . </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$letters</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">* </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">, </span><span class="default">$letters</span><span class="keyword">, </span><span class="default">$rep</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This technique is faster because PHP's strtr is implemented in C using a byte lookup table (it has O(m + n) complexity). However, PHP 6 will use Unicode, so I guess(?) strtr will then have to be implemented with a search for each character (O(m * n)). Using strtr might still be faster since it offloads the character manipulation to C rather than PHP, but I don't really know. Take your pick.<br />
<br />
Happy coding!<br />
<br />
(Benchmark code):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">for (</span><span class="default">$k </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$k </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">; </span><span class="default">$k</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="string">'The quick brown fox jumps over the lazy dog.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">1000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) </span><span class="default">$s </span><span class="keyword">= </span><span class="default">str_rot</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">) - </span><span class="default">$t</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$t</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93759""></a>
  <div class="note">
   <strong class="user">shaunspiller at spammenotgmail dot com</strong>
   <a href="#93759" class="date">26-Sep-2009 05:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's my implementation of a str_rot that takes a custom offset. It's faster than the others here because it allocates the output string in one go instead of tacking on characters one at a time. It can handle positive or negative offsets of any size, and it fixes everything up to ensure only upper and lower case letters are translated and that they wrap around correctly within the alphabet.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">str_rot</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">= </span><span class="default">13</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= (int)</span><span class="default">$n </span><span class="keyword">% </span><span class="default">26</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$n</span><span class="keyword">) return </span><span class="default">$s</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$l </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$l</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="default">97 </span><span class="keyword">&amp;&amp; </span><span class="default">$c </span><span class="keyword">&lt;= </span><span class="default">122</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">chr</span><span class="keyword">((</span><span class="default">$c </span><span class="keyword">- </span><span class="default">71 </span><span class="keyword">+ </span><span class="default">$n</span><span class="keyword">) % </span><span class="default">26 </span><span class="keyword">+ </span><span class="default">97</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="default">65 </span><span class="keyword">&amp;&amp; </span><span class="default">$c </span><span class="keyword">&lt;= </span><span class="default">90</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">chr</span><span class="keyword">((</span><span class="default">$c </span><span class="keyword">- </span><span class="default">39 </span><span class="keyword">+ </span><span class="default">$n</span><span class="keyword">) % </span><span class="default">26 </span><span class="keyword">+ </span><span class="default">65</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$s</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93388""></a>
  <div class="note">
   <strong class="user">peter at NOSPAM jamit dot com</strong>
   <a href="#93388" class="date">07-Sep-2009 04:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This ROT13 variant is different from my earlier version in that it retains 'ethnicity'. For example, a Chinese text when encrypted will remain Chinese, and the string will not be making sense (the real meaning will be encrypted). Just look at the code and you will understand.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">unichar2ords</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">'UTF-8'</span><span class="keyword">) {&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">, </span><span class="string">'UCS-4'</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'N'</span><span class="keyword">, </span><span class="default">$char</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$val</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
function </span><span class="default">ords2unichar</span><span class="keyword">(</span><span class="default">$ords</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">'UTF-8'</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'N'</span><span class="keyword">, </span><span class="default">$ords</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">, </span><span class="string">'UCS-4'</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
function </span><span class="default">mbStringToArray </span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">'UTF-8'</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (empty(</span><span class="default">$string</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$strlen </span><span class="keyword">= </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">); </span><span class="default">$strlen </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">; ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[] = </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string&nbsp; </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">$strlen</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$strlen&nbsp; </span><span class="keyword">= </span><span class="default">$strlen </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
function </span><span class="default">unicodeRotN</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">'UTF-8'</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">mbStringToArray </span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">'UTF-8'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">.= </span><span class="default">ords2unichar</span><span class="keyword">(</span><span class="default">unichar2ords</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">$encoding</span><span class="keyword">) + </span><span class="default">$offset</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="comment">// example<br />
<br />
</span><span class="default">$original </span><span class="keyword">= </span><span class="string">'中國是我的家'</span><span class="keyword">; </span><span class="comment">// means "China is my home"<br />
<br />
</span><span class="default">$encrypted </span><span class="keyword">= </span><span class="default">unicodeRotN</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">13</span><span class="keyword">); </span><span class="comment">// 为團昼戞皑寃 means "Ñ Ai injustice for the Mission Day" (Google translation)<br />
<br />
</span><span class="default">$decrypted </span><span class="keyword">= </span><span class="default">unicodeRotN</span><span class="keyword">(</span><span class="default">$encrypted</span><span class="keyword">, -</span><span class="default">13</span><span class="keyword">); </span><span class="comment">// 中國是我的家<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93385""></a>
  <div class="note">
   <strong class="user">peter at NOSPAM jamit dot com</strong>
   <a href="#93385" class="date">07-Sep-2009 10:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is my ROT13 function that works for all possible characters and not just ASCII. It can be used on Chinese, Japanese, ....<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">rot13encrypt </span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">str_rot13</span><span class="keyword">(</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
function </span><span class="default">rot13decrypt </span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">base64_decode</span><span class="keyword">(</span><span class="default">str_rot13</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="comment">// example<br />
<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="string">'中國是我的家'</span><span class="keyword">;<br />
<br />
</span><span class="default">$encrypted </span><span class="keyword">= </span><span class="default">rot13encrypt </span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">); </span><span class="comment">// produces 5Yvg5MlY5cvi5bvE55dR5n62<br />
<br />
</span><span class="default">$decrypted </span><span class="keyword">= </span><span class="default">rot13decrypt </span><span class="keyword">(</span><span class="default">$encrypted</span><span class="keyword">); </span><span class="comment">// produces 中國是我的家<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76355""></a>
  <div class="note">
   <strong class="user">arwab at surrealwebs dot com</strong>
   <a href="#76355" class="date">11-Jul-2007 10:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
here's my rot function, it works anyway<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* preforms the rotation algorithm on the passed in string<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">_rot</span><span class="keyword">( </span><span class="default">$str </span><span class="keyword">, </span><span class="default">$dist</span><span class="keyword">=</span><span class="default">13 </span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if( !</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$dist</span><span class="keyword">) || </span><span class="default">$dist </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dist </span><span class="keyword">= </span><span class="default">13</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$u_lower </span><span class="keyword">=&nbsp; </span><span class="default">65</span><span class="keyword">; </span><span class="default">$u_upper </span><span class="keyword">=&nbsp; </span><span class="default">90</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$l_lower </span><span class="keyword">=&nbsp; </span><span class="default">97</span><span class="keyword">; </span><span class="default">$l_upper </span><span class="keyword">= </span><span class="default">122</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$char_count </span><span class="keyword">= (</span><span class="default">$u_upper </span><span class="keyword">- </span><span class="default">$u_lower</span><span class="keyword">) +</span><span class="default">1</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; while( </span><span class="default">$dist </span><span class="keyword">&gt; </span><span class="default">$char_count </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dist </span><span class="keyword">-= </span><span class="default">$char_count</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$newstr </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for( </span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">); ++</span><span class="default">$i</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * Check if the character is within the bounds of our function (a-zA-z)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * if not it gets tacked on to the string as is and we move on to the <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * next one.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">$c</span><span class="keyword">&lt;</span><span class="default">$u_lower </span><span class="keyword">|| </span><span class="default">$c</span><span class="keyword">&gt;</span><span class="default">$l_upper </span><span class="keyword">|| ( </span><span class="default">$c</span><span class="keyword">&gt;</span><span class="default">$u_upper </span><span class="keyword">&amp;&amp; </span><span class="default">$c </span><span class="keyword">&lt;</span><span class="default">$l_lower </span><span class="keyword">) ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newstr </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lower </span><span class="keyword">= ( </span><span class="default">$c</span><span class="keyword">&lt;=</span><span class="default">$u_upper</span><span class="keyword">?</span><span class="default">$u_lower</span><span class="keyword">:</span><span class="default">$l_lower</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$upper </span><span class="keyword">= ( </span><span class="default">$c</span><span class="keyword">&lt;=</span><span class="default">$u_upper</span><span class="keyword">?</span><span class="default">$u_upper</span><span class="keyword">:</span><span class="default">$l_upper</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">+= </span><span class="default">$dist</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$c </span><span class="keyword">&gt; </span><span class="default">$upper</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= ((</span><span class="default">$c </span><span class="keyword">- </span><span class="default">$upper</span><span class="keyword">) + (</span><span class="default">$lower</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newstr </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$newstr</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75469""></a>
  <div class="note">
   <strong class="user">electro at whatever dot com</strong>
   <a href="#75469" class="date">31-May-2007 09:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Rotate each string characters by n positions in ASCII table<br />
&nbsp;* To encode use positive n, to decode - negative.<br />
&nbsp;* With n = 13 (ROT13), encode and decode n can be positive.<br />
&nbsp;* <br />
&nbsp;* @param string $string<br />
&nbsp;* @param integer $n<br />
&nbsp;* @return string<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">rotate</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$n</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$length</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ascii </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">});<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rotated </span><span class="keyword">= </span><span class="default">$ascii</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$ascii </span><span class="keyword">&gt; </span><span class="default">64 </span><span class="keyword">&amp;&amp; </span><span class="default">$ascii </span><span class="keyword">&lt; </span><span class="default">91</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rotated </span><span class="keyword">+= </span><span class="default">$n</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rotated </span><span class="keyword">&gt; </span><span class="default">90 </span><span class="keyword">&amp;&amp; </span><span class="default">$rotated </span><span class="keyword">+= -</span><span class="default">90 </span><span class="keyword">+ </span><span class="default">64</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rotated </span><span class="keyword">&lt; </span><span class="default">65 </span><span class="keyword">&amp;&amp; </span><span class="default">$rotated </span><span class="keyword">+= -</span><span class="default">64 </span><span class="keyword">+ </span><span class="default">90</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } elseif (</span><span class="default">$ascii </span><span class="keyword">&gt; </span><span class="default">96 </span><span class="keyword">&amp;&amp; </span><span class="default">$ascii </span><span class="keyword">&lt; </span><span class="default">123</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rotated </span><span class="keyword">+= </span><span class="default">$n</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rotated </span><span class="keyword">&gt; </span><span class="default">122 </span><span class="keyword">&amp;&amp; </span><span class="default">$rotated </span><span class="keyword">+= -</span><span class="default">122 </span><span class="keyword">+ </span><span class="default">96</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rotated </span><span class="keyword">&lt; </span><span class="default">97 </span><span class="keyword">&amp;&amp; </span><span class="default">$rotated </span><span class="keyword">+= -</span><span class="default">96 </span><span class="keyword">+ </span><span class="default">122</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$rotated</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$enc </span><span class="keyword">= </span><span class="default">rotate</span><span class="keyword">(</span><span class="string">'string'</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">);<br />
echo </span><span class="string">"Encoded: </span><span class="default">$enc</span><span class="string">&lt;br/&gt;\n"</span><span class="keyword">;<br />
echo </span><span class="string">'Decoded: ' </span><span class="keyword">. </span><span class="default">rotate</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, -</span><span class="default">6</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75382""></a>
  <div class="note">
   <strong class="user">maximius at gmail dot com</strong>
   <a href="#75382" class="date">26-May-2007 01:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Perhaps someone will find this useful ;)<br />
<br />
&lt;?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; function rotN($s, $n){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $s2 = "";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for($i = 0; $i &lt; strlen($s); $i++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $char2 = $char = ord($s{$i});<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $cap = $char &amp; 32;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $char &amp;= ~ $cap;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $char = $char &gt; 64 &amp;&amp; $char &lt; 123 ? (($char - 65 + $n) % 26 + 65) : $char;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $char |= $cap;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if($char &lt; 65 &amp;&amp; $char2 &gt; 64 || ($char &gt; 90 &amp;&amp; $char &lt; 97 &amp;&amp; ($char2 &lt; 91 || $char2 &gt; 96))) $char += 26;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if($char &gt; 122 &amp;&amp; $char2 &lt; 123) $char -= 52;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(strtoupper(chr($char2)) === chr($char2)) $char = strtoupper(chr($char)); else $char = strtolower(chr($char));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $s2 .= $char;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $s2;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
?&gt;<br />
It takes any string, $s, and any ROT value, $n. Just like str_rot13, it's both an encoder and decoder. To decode an encoded string, just pass -$n instead of $n.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.str-replace.html">str_replace</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.str-shuffle.html">str_shuffle</a></div>
 <div class="up"><a href="ref.strings.html">String 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
