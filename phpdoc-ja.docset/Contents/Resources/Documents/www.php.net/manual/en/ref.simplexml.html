<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>SimpleXML 関数</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="simplexmliterator.valid.html">SimpleXMLIterator::valid</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.simplexml-import-dom.html">simplexml_import_dom</a></div>
 <div class="up"><a href="book.simplexml.html">SimpleXML</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="ref.simplexml" class="reference">
 <h1 class="title">SimpleXML 関数</h1>

 

























<h2>目次</h2><ul class="chunklist chunklist_reference"><li><a href="function.simplexml-import-dom.html">simplexml_import_dom</a> — DOM ノードから SimpleXMLElement オブジェクトを取得する</li><li><a href="function.simplexml-load-file.html">simplexml_load_file</a> — XMLファイルをパースし、オブジェクトに代入する</li><li><a href="function.simplexml-load-string.html">simplexml_load_string</a> — XML 文字列をオブジェクトに代入する</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113179""></a>
  <div class="note">
   <strong class="user">brandonkirsch at gmail dot com</strong>
   <a href="#113179" class="date">10-Sep-2013 04:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Contrary to other notes posted here, SimpleXML *DOES NOT* properly handle non-UTF8 encoded XML documents.&nbsp; <br />
<br />
A proper "iso-8859-1" declared and encoded XML document will not parse with SimpleXML for PHP 5.2.17 or 5.5.1 when using extended characters (that is, byte values greater than 127)<br />
<br />
DOMDocument, on the other hand, will correctly parse incoming iso-8859-1 XML documents and can also be used to perform character translation to UTF8:<br />
<br />
$dom = new DOMDocument();<br />
<br />
if($dom-&gt;loadXML($fileContents)){ // $fileContents is an XML document with iso-8859-1 encoding specified in the declaration<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $dom-&gt;encoding = 'utf-8'; // convert document encoding to UTF8 <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $dom-&gt;saveXML(); // return valid, utf8-encoded XML</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112710""></a>
  <div class="note">
   <strong class="user">William Fahria</strong>
   <a href="#112710" class="date">16-Jul-2013 04:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple implementation:<br />
You can inform a direct XML in text format to the function.<br />
<br />
function eoXML2Array($xmlContent, $out = array()){<br />
&nbsp;&nbsp;&nbsp; $xmlObject = is_object($xmlContent) ? $xmlContent : simplexml_load_string($xmlContent);<br />
&nbsp;&nbsp;&nbsp; foreach((array) $xmlObject as $index =&gt; $node)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $out[$index] = ( is_object($node) || is_array($node) ) ? eoXML2Array( $node ) : $node;<br />
&nbsp;&nbsp;&nbsp; return $out;<br />
}<br />
<br />
Usage: $your_array = eoXML2Array(your xml text);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112038""></a>
  <div class="note">
   <strong class="user">r dot m dot 0100101 at gmail dot com</strong>
   <a href="#112038" class="date">26-Apr-2013 12:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a slight adjustment to <a href="http://www.php.net/manual/en/ref.simplexml.php#103617 " rel="nofollow" target="_blank">http://www.php.net/manual/en/ref.simplexml.php#103617 </a>'s function.<br />
The function given by them would convert a simpleXML to an array but only at the highest level. Once you add the is_array check with the is_object it should convert each level to an array (well it did for me through 3 levels).<br />
<br />
function simpleXmlObjectToArray ( $xmlObject, $out = array () )<br />
{<br />
&nbsp;&nbsp;&nbsp; foreach ( (array) $xmlObject as $index =&gt; $node )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $out[$index] = ( is_object ( $node ) || is_array($node) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ? simpleXmlObjectToArray ( $node )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; : $node;<br />
<br />
&nbsp;&nbsp;&nbsp; return $out;<br />
}<br />
Happy Coding!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111227""></a>
  <div class="note">
   <strong class="user">Eric</strong>
   <a href="#111227" class="date">29-Jan-2013 12:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If the SimpleXMLObject contains an array, adding is_array() allows the function to keep digging for Objects. <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">xml2array </span><span class="keyword">( </span><span class="default">$xmlObject</span><span class="keyword">, </span><span class="default">$out </span><span class="keyword">= array () )<br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ( (array) </span><span class="default">$xmlObject </span><span class="keyword">as </span><span class="default">$index </span><span class="keyword">=&gt; </span><span class="default">$node </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] = ( </span><span class="default">is_object </span><span class="keyword">( </span><span class="default">$node </span><span class="keyword">) ||&nbsp; </span><span class="default">is_array </span><span class="keyword">( </span><span class="default">$node </span><span class="keyword">) ) ? </span><span class="default">xml2array </span><span class="keyword">( </span><span class="default">$node </span><span class="keyword">) : </span><span class="default">$node</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$out</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106876""></a>
  <div class="note">
   <strong class="user">thomas at guenneguez dot com</strong>
   <a href="#106876" class="date">14-Dec-2011 11:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Merge two xml only with SimpleXML :<br />
Function corrected if note containe only value.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mergeXML</span><span class="keyword">(&amp;</span><span class="default">$base</span><span class="keyword">, </span><span class="default">$add</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$add</span><span class="keyword">-&gt;</span><span class="default">count</span><span class="keyword">() != </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new </span><span class="keyword">= </span><span class="default">$base</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$add</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new </span><span class="keyword">= </span><span class="default">$base</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$add</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(), </span><span class="default">$add</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$add</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$a </span><span class="keyword">=&gt; </span><span class="default">$b</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new</span><span class="keyword">-&gt;</span><span class="default">addAttribute</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$add</span><span class="keyword">-&gt;</span><span class="default">count</span><span class="keyword">() != </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$add</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$child</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mergeXML</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">$child</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Use : <span class="default">&lt;?php mergeXML</span><span class="keyword">(</span><span class="default">$xmlElement</span><span class="keyword">, </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$toMerge</span><span class="keyword">)) </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106829""></a>
  <div class="note">
   <strong class="user">julien dot breiner at laposte dot net</strong>
   <a href="#106829" class="date">09-Dec-2011 07:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Merge two xml only with SimpleXML :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">private function </span><span class="default">mergeXML</span><span class="keyword">(&amp;</span><span class="default">$base</span><span class="keyword">, </span><span class="default">$add</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$new </span><span class="keyword">= </span><span class="default">$base</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$add</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$add</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$a </span><span class="keyword">=&gt; </span><span class="default">$b</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">] = </span><span class="default">$b</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$add</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$child</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">mergeXML</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">$child</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span><span class="default">?&gt;<br />
</span><br />
Use : <span class="default">&lt;?php mergeXML</span><span class="keyword">(</span><span class="default">$xmlElement</span><span class="keyword">, </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$toMerge</span><span class="keyword">)) </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103617""></a>
  <div class="note">
   <strong class="user">k dot antczak at livedata dot pl</strong>
   <a href="#103617" class="date">22-Apr-2011 10:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A quick snippet which converts XML Object into array:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">xml2array </span><span class="keyword">( </span><span class="default">$xmlObject</span><span class="keyword">, </span><span class="default">$out </span><span class="keyword">= array () )<br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ( (array) </span><span class="default">$xmlObject </span><span class="keyword">as </span><span class="default">$index </span><span class="keyword">=&gt; </span><span class="default">$node </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] = ( </span><span class="default">is_object </span><span class="keyword">( </span><span class="default">$node </span><span class="keyword">) ) ? </span><span class="default">xml2array </span><span class="keyword">( </span><span class="default">$node </span><span class="keyword">) : </span><span class="default">$node</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$out</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Have fun! ;-)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103351""></a>
  <div class="note">
   <strong class="user">help :-) @ theapotek :-) com</strong>
   <a href="#103351" class="date">08-Apr-2011 09:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having trouble accessing CDATA in your simplexml document, you don't need to str_replace/preg_replace the CDATA out before loading it with simplexml.<br />
<br />
You can do this instead, and all your CDATA contents will be merged into the element contents as strings.<br />
<br />
$xml = simplexml_load_file($xmlfile,<br />
'SimpleXMLElement', LIBXML_NOCDATA);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92272""></a>
  <div class="note">
   <strong class="user">Andrez  zenarter at hotmail dot com</strong>
   <a href="#92272" class="date">17-Jul-2009 07:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just wanna add an additional to<br />
"Append/combine/merge one simplexml to another"<br />
The parent should has attributes too.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">append_simplexml</span><span class="keyword">(&amp;</span><span class="default">$simplexml_to</span><span class="keyword">, &amp;</span><span class="default">$simplexml_from</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; <br />
static </span><span class="default">$firstLoop</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
</span><span class="comment">//Here adding attributes to parent&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
</span><span class="keyword">if( </span><span class="default">$firstLoop </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$simplexml_from</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$attr_key </span><span class="keyword">=&gt; </span><span class="default">$attr_value </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$simplexml_to</span><span class="keyword">-&gt;</span><span class="default">addAttribute</span><span class="keyword">(</span><span class="default">$attr_key</span><span class="keyword">, </span><span class="default">$attr_value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
foreach (</span><span class="default">$simplexml_from</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$simplexml_child</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$simplexml_temp </span><span class="keyword">= </span><span class="default">$simplexml_to</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$simplexml_child</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(), (string) </span><span class="default">$simplexml_child</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$simplexml_child</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$attr_key </span><span class="keyword">=&gt; </span><span class="default">$attr_value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$simplexml_temp</span><span class="keyword">-&gt;</span><span class="default">addAttribute</span><span class="keyword">(</span><span class="default">$attr_key</span><span class="keyword">, </span><span class="default">$attr_value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$firstLoop</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">append_simplexml</span><span class="keyword">(</span><span class="default">$simplexml_temp</span><span class="keyword">, </span><span class="default">$simplexml_child</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
unset( </span><span class="default">$firstLoop</span><span class="keyword">=</span><span class="default">false </span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I have aproblem to assign an object into a variable used as an object later, Then i found the code above, it solve half of my problem. I have it should have the parent name assign too but it didnt. Any better code?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92034""></a>
  <div class="note">
   <strong class="user">Douglas Marsh</strong>
   <a href="#92034" class="date">06-Jul-2009 05:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SimpleXML is really nice for loading/converting XML data into native PHP data structures. I was considering crude searching of SVG for the width/height and since it really is an XML file... I found a SUPER easy method for parsing out the information I wanted:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// putting incomplete SVG data inline for readability<br />
</span><span class="default">$RawXML </span><span class="keyword">= &lt;&lt;&lt; XML<br />
</span><span class="string">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;<br />
&lt;svg<br />
&nbsp;&nbsp; xmlns:dc="<a href="http://www.example.com/dc" rel="nofollow" target="_blank">http://www.example.com/dc</a>"<br />
&nbsp;&nbsp; xmlns:cc="<a href="http://www.example.com/cc" rel="nofollow" target="_blank">http://www.example.com/cc</a>"<br />
&nbsp;&nbsp; xmlns:rdf="<a href="http://www.example.com/rdf" rel="nofollow" target="_blank">http://www.example.com/rdf</a>"<br />
&nbsp;&nbsp; xmlns:svg="<a href="http://www.example.com/svg" rel="nofollow" target="_blank">http://www.example.com/svg</a>"<br />
&nbsp;&nbsp; xmlns="<a href="http://www.example.com/" rel="nofollow" target="_blank">http://www.example.com/</a>"<br />
&nbsp;&nbsp; xmlns:sodipodi="<a href="http://www.example.com/sodipodi" rel="nofollow" target="_blank">http://www.example.com/sodipodi</a>"<br />
&nbsp;&nbsp; xmlns:inkscape="<a href="http://www.example.com/inkscape" rel="nofollow" target="_blank">http://www.example.com/inkscape</a>"<br />
&nbsp;&nbsp; id="svg2"<br />
&nbsp;&nbsp; sodipodi:version="0.32"<br />
&nbsp;&nbsp; inkscape:version="0.46"<br />
&nbsp;&nbsp; width="586.25"<br />
&nbsp;&nbsp; height="743.75"<br />
&nbsp;&nbsp; xml:space="preserve"<br />
&nbsp;&nbsp; sodipodi:docname="some_svg_file.svg"<br />
&nbsp;&nbsp; inkscape:output_extension="org.inkscape.output.svg.inkscape"&gt;<br />
&nbsp;&lt;!-- portions removed to keep this short --&gt;<br />
&lt;/svg&gt;<br />
</span><span class="keyword">XML;<br />
<br />
</span><span class="default">$svg </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$RawXML</span><span class="keyword">);<br />
<br />
</span><span class="default">$height </span><span class="keyword">= </span><span class="default">$svg</span><span class="keyword">[</span><span class="string">'height'</span><span class="keyword">];<br />
</span><span class="default">$width </span><span class="keyword">= </span><span class="default">$svg</span><span class="keyword">[</span><span class="string">'width'</span><span class="keyword">];<br />
<br />
echo </span><span class="string">"The width x height is: </span><span class="keyword">${</span><span class="default">width</span><span class="keyword">}</span><span class="string"> x </span><span class="keyword">${</span><span class="default">height</span><span class="keyword">}</span><span class="string"> \n"</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91561""></a>
  <div class="note">
   <strong class="user">info at ajaxforum dot ru</strong>
   <a href="#91561" class="date">17-Jun-2009 09:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Append/combine/merge one simplexml to another:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">include </span><span class="string">'example.php'</span><span class="keyword">;<br />
</span><span class="default">$el1 </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xmlstr</span><span class="keyword">);<br />
</span><span class="default">$el2 </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xmlstr</span><span class="keyword">);<br />
<br />
</span><span class="comment">// wrong way!<br />
// php convert $el2-&gt;movie[0] to string silently<br />
</span><span class="default">$el1</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">'movie'</span><span class="keyword">, </span><span class="default">$el2</span><span class="keyword">-&gt;</span><span class="default">movie</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
<br />
</span><span class="comment">// wrong way!<br />
// php 5.1 convert $el2-&gt;movie[0] to string and generate Warning: It is not yet possible to assign complex types to properties. It is not possible to assign complex types to nodes<br />
// php 5.2 convert $el2-&gt;movie[0] to string silently<br />
</span><span class="default">$el1</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">'movie'</span><span class="keyword">);<br />
</span><span class="default">$el1</span><span class="keyword">-&gt;</span><span class="default">movie</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] = </span><span class="default">$el2</span><span class="keyword">-&gt;</span><span class="default">movie</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
<br />
</span><span class="comment">// right way!<br />
</span><span class="default">$el1_movie </span><span class="keyword">= </span><span class="default">$el1</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="string">'movie'</span><span class="keyword">);<br />
</span><span class="default">append_simplexml</span><span class="keyword">(</span><span class="default">$el1_movie</span><span class="keyword">, </span><span class="default">$el2</span><span class="keyword">-&gt;</span><span class="default">movie</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
<br />
echo </span><span class="string">"&lt;pre&gt;"</span><span class="keyword">; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$el1</span><span class="keyword">); echo </span><span class="string">"&lt;/pre&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Add one simplexml to another<br />
&nbsp;*<br />
&nbsp;* @param object $simplexml_to<br />
&nbsp;* @param object $simplexml_from<br />
&nbsp;* @author Boris Korobkov<br />
&nbsp;* @link <a href="http://www.ajaxforum.ru/" rel="nofollow" target="_blank">http://www.ajaxforum.ru/</a><br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">append_simplexml</span><span class="keyword">(&amp;</span><span class="default">$simplexml_to</span><span class="keyword">, &amp;</span><span class="default">$simplexml_from</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$simplexml_from</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$simplexml_child</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$simplexml_temp </span><span class="keyword">= </span><span class="default">$simplexml_to</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$simplexml_child</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(), (string) </span><span class="default">$simplexml_child</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$simplexml_child</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$attr_key </span><span class="keyword">=&gt; </span><span class="default">$attr_value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$simplexml_temp</span><span class="keyword">-&gt;</span><span class="default">addAttribute</span><span class="keyword">(</span><span class="default">$attr_key</span><span class="keyword">, </span><span class="default">$attr_value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">append_simplexml</span><span class="keyword">(</span><span class="default">$simplexml_temp</span><span class="keyword">, </span><span class="default">$simplexml_child</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91057""></a>
  <div class="note">
   <strong class="user">codejunky32 at NOSPAM dot com</strong>
   <a href="#91057" class="date">22-May-2009 05:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just wanted to add a post as to how you can extract the value from a SimpleXMLElement. Its not as straightforward as you think. Because its a complex object you can't just access the element directly. Here is a sample of data that represents a var_dump of a SimpleXmlElement<br />
<br />
array(1) {<br />
&nbsp; [0]=&gt;<br />
&nbsp; object(SimpleXMLElement)#13 (2) {<br />
&nbsp;&nbsp;&nbsp; ["@attributes"]=&gt;<br />
&nbsp;&nbsp;&nbsp; array(1) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; ["name"]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; string(5) "title"<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; [0]=&gt;<br />
&nbsp;&nbsp;&nbsp; string(19) "PHP Tech Book"<br />
&nbsp; }<br />
}<br />
<br />
If you want to extract the title of the book you have to cast the specified element to a string like so.<br />
$newTitle = (string) $title[0];&nbsp; <br />
<br />
The $title variable is the SimpleXMLElement that you have extracted from the xml document using simplexml_load_string for instance.&nbsp; To initially access the title element from the xml document you can do like so, using xpath.<br />
$title = $doc-&gt;xpath('str[@name="title"]');<br />
<br />
Hope this helps someone out there.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85414""></a>
  <div class="note">
   <strong class="user">james dot ellis at gmail dot com</strong>
   <a href="#85414" class="date">29-Aug-2008 03:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While SimpleXML is a powerful tool, developers using it to process and handle large XML documents &amp; strings should take into careful consideration its memory usage requirements.<br />
SimpleXML requires the entire XML tree to be available prior to any processing actions on that tree -- this requires the entire tree to be in memory. Ok for a 40kb XML file but when dealing with &gt; 100MB files you will see performance degradation, especially if you have a busy server.<br />
<br />
An alternative to processing large XML files is the XMLReader class, which operates in streaming mode, of which an excellent tutorial is presented here:<br />
<a href="http://www.ibm.com/developerworks/library/x-pullparsingphp.html" rel="nofollow" target="_blank">http://www.ibm.com/developerworks/library/x-pullparsingphp.html</a><br />
<br />
XML is an incredibly verbose format. If you are dealing with large data structures, especially in web services, do you you actually need to represent the data as an XML tree? - other serialisation formats such as JSON, Serialised PHP, Google Protocol Buffers (<a href="http://code.google.com/p/protobuf/" rel="nofollow" target="_blank">http://code.google.com/p/protobuf/</a>) and even CSV can remarkably reduce processing time, bandwidth and load&nbsp; when dealing with large files. A 110MB XML file can become a 65MB CSV file, with the same data in it, simply because the data identifiers (tags) are only represented once in the entire document.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83378""></a>
  <div class="note">
   <strong class="user">m0sh3 at hotmail dot com</strong>
   <a href="#83378" class="date">23-May-2008 12:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware of quirks like this one:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$a </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">'&lt;a&gt;&lt;b/&gt;&lt;/a&gt;'</span><span class="keyword">);<br />
<br />
</span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">b </span><span class="keyword">= </span><span class="string">'test &amp;amp; test'</span><span class="keyword">;<br />
</span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">c </span><span class="keyword">= </span><span class="string">'test &amp;amp; test'</span><span class="keyword">;<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
</span><span class="comment">/*<br />
OUTPUT:<br />
<br />
SimpleXMLElement Object<br />
(<br />
&nbsp;&nbsp;&nbsp; [b] =&gt; test &amp; test<br />
&nbsp;&nbsp;&nbsp; [c] =&gt; test &amp;amp; test<br />
)<br />
*/</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82323""></a>
  <div class="note">
   <strong class="user">nathan at gimpstraw dot com</strong>
   <a href="#82323" class="date">05-Apr-2008 06:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm using SimpleXML to process data sent back from an API request, and I ran into the CDATA problem and the error you get from html entities, and here is a solution i came up with, don't know if it's the most practical, but it's working.<br />
<br />
<span class="default">&lt;?php<br />
$str </span><span class="keyword">= &lt;&lt;&lt; XML<br />
</span><span class="string">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;<br />
&lt;menu&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;item&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;title&gt;&lt;![CDATA[Caf&amp;eacute;]]&gt;&lt;/title&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;description&gt;&lt;![CDATA[Some description.]]&gt;&lt;/description&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/item&gt;<br />
&lt;/menu&gt;<br />
</span><span class="keyword">XML;<br />
<br />
</span><span class="default">$str </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/\&lt;\!\[CDATA\[(.*?)\]\]\&gt;/ies"</span><span class="keyword">, </span><span class="string">"'[CDATA]'.base64_encode('$1').'[/CDATA]'"</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br />
</span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Return item title's<br />
</span><span class="keyword">foreach (</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">item </span><span class="keyword">as </span><span class="default">$item</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tmp </span><span class="keyword">= (string) </span><span class="default">$item</span><span class="keyword">-&gt;</span><span class="default">title</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/\[CDATA\](.*?)\[\/CDATA\]/ies"</span><span class="keyword">, </span><span class="string">"base64_decode('$1')"</span><span class="keyword">, </span><span class="default">$tmp</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$tmp</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81923""></a>
  <div class="note">
   <strong class="user">ngkongs at gmail dot com</strong>
   <a href="#81923" class="date">19-Mar-2008 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
fix the function i posted before, have a wrong quote placement<br />
<br />
function implode2($glue="", $var){<br />
&nbsp;&nbsp;&nbsp; if ($var){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ($var as $value){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $array[]=strval($value);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return implode($glue, $array);<br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; else return false;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81048""></a>
  <div class="note">
   <strong class="user">philippe_marc_--a---t--_novartis_com</strong>
   <a href="#81048" class="date">12-Feb-2008 06:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
TIP: if you run into memory issue using simpleXML. <br />
You may want to use PHP&gt;5.2.5 in order to avoid that: <a href="http://bugs.php.net/bug.php?id=38604" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=38604</a><br />
If not possible, avoid "foreach ( $xmldata-&gt;node as $node )" like calls.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80176""></a>
  <div class="note">
   <strong class="user">andrvm</strong>
   <a href="#80176" class="date">03-Jan-2008 12:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; * Remove node/nodes xml with xpath<br />
&nbsp;&nbsp;&nbsp; *<br />
&nbsp;&nbsp;&nbsp; * @param SimpleXMLElement&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $xml<br />
&nbsp;&nbsp;&nbsp; * @param string XPath&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $path<br />
&nbsp;&nbsp;&nbsp; * @param string ('one'|'child'|'all')&nbsp; &nbsp;&nbsp; $multi<br />
&nbsp;&nbsp;&nbsp; * <br />
&nbsp;&nbsp;&nbsp; * Use:<br />
&nbsp;&nbsp;&nbsp; * <br />
&nbsp;&nbsp;&nbsp; * Example xml file - <a href="http://ru2.php.net/manual/ru/ref.simplexml.php" rel="nofollow" target="_blank">http://ru2.php.net/manual/ru/ref.simplexml.php</a><br />
&nbsp;&nbsp;&nbsp; * <br />
&nbsp;&nbsp;&nbsp; * $xml = simplexml_load_file($xmlfile);<br />
&nbsp;&nbsp;&nbsp; * <br />
&nbsp;&nbsp;&nbsp; * //1. remove only 1 node (without child nodes)<br />
&nbsp;&nbsp;&nbsp; * //&nbsp;&nbsp; $path must return only 1 (unique) node without child nodes<br />
&nbsp;&nbsp;&nbsp; * removeNode($xml, '//movie/rating[@type="thumbs"]');<br />
&nbsp;&nbsp;&nbsp; * <br />
&nbsp;&nbsp;&nbsp; * //2. remove 1 node (with 1 child nodes)<br />
&nbsp;&nbsp;&nbsp; * //&nbsp; &nbsp; $path can return any nodes - will be removed only first node<br />
&nbsp;&nbsp;&nbsp; * //&nbsp;&nbsp; with all child nodes<br />
&nbsp;&nbsp;&nbsp; * removeNode($xml, '//characters', 'child')<br />
&nbsp;&nbsp;&nbsp; * <br />
&nbsp;&nbsp;&nbsp; * //3. remove all nodes (with child nodes)<br />
&nbsp;&nbsp;&nbsp; * //&nbsp;&nbsp; $path can return any nodes - will be removed all<br />
&nbsp;&nbsp;&nbsp; * //&nbsp;&nbsp; with child nodes<br />
&nbsp;&nbsp;&nbsp; * removeNode($xml, '//rating', 'all')<br />
&nbsp;&nbsp;&nbsp; * <br />
&nbsp;&nbsp;&nbsp; * $xml-&gt;asXML($xmlfile);<br />
&nbsp;&nbsp;&nbsp; * <br />
&nbsp;&nbsp;&nbsp; */<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">removeNode</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$multi</span><span class="keyword">=</span><span class="string">'one'</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">xpath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># for wrong $path<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!isset(</span><span class="default">$result</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">$multi</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'all'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$errlevel </span><span class="keyword">= </span><span class="default">error_reporting</span><span class="keyword">(</span><span class="default">E_ALL </span><span class="keyword">&amp; ~</span><span class="default">E_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$result </span><span class="keyword">as </span><span class="default">$r</span><span class="keyword">) unset (</span><span class="default">$r</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">error_reporting</span><span class="keyword">(</span><span class="default">$errlevel</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'child'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unset(</span><span class="default">$result</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'one'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]-&gt;</span><span class="default">children</span><span class="keyword">())==</span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)==</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unset(</span><span class="default">$result</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;}&nbsp; <br />
</span><span class="default">?&gt;<br />
</span><br />
p.s. after use (if deleted all nodes):<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">trimXml</span><span class="keyword">(</span><span class="default">$xmlfile</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dom </span><span class="keyword">= new </span><span class="default">DOMDocument</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dom</span><span class="keyword">-&gt;</span><span class="default">preserveWhiteSpace </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">$dom</span><span class="keyword">-&gt;</span><span class="default">load</span><span class="keyword">(</span><span class="default">$xmlfile</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$dom</span><span class="keyword">-&gt;</span><span class="default">formatOutput </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">$dom</span><span class="keyword">-&gt;</span><span class="default">save</span><span class="keyword">(</span><span class="default">$xmlfile</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79258""></a>
  <div class="note">
   <strong class="user">onPHP5.com</strong>
   <a href="#79258" class="date">18-Nov-2007 01:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It does not say in the docs, but SimpleXML will convert all text into UTF-8, if the source XML declaration has another encoding. Eg, if the source has the following XML decl:<br />
<br />
&lt;?xml version="1.0" encoding="windows-1251" ?&gt;<br />
<br />
all the text in the resulting SimpleXMLElement will be in UTF-8 automatically.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78683""></a>
  <div class="note">
   <strong class="user">lordi at msdi dot ca</strong>
   <a href="#78683" class="date">23-Oct-2007 02:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need to do math calculations on values extracted from simplexml document, you might need to cast the value as float to prevent precision loss. Here is an example:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $objXML </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">'&lt;test x="-123.45"&gt;&lt;/test&gt;'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Shows correctly<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$objXML</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">].</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//We loose the decimals<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$objXML</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">] + </span><span class="default">$objXML</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">].</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">$objXML</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//This works if we cast the amounts<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo (float)</span><span class="default">$objXML</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">] + (float)</span><span class="default">$objXML</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">].</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Calculated on a string, no problem<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"-123.45" </span><span class="keyword">+ </span><span class="string">"-123.45"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">?&gt;<br />
</span><br />
This is due to the fact that $objXML['x'] is not a string (php would cast it automatically) neither a float, but a SimpleXMLElement object.<br />
<br />
"echo var_dump($x);" will output this<br />
~~<br />
object(SimpleXMLElement)#3 (1) {<br />
&nbsp; [0]=&gt;<br />
&nbsp; string(7) "-123.45"<br />
}<br />
~~<br />
<br />
I opened a bug request on php but here is the answer they gave me:<br />
<br />
~~<br />
Status: Won't fix<br />
<br />
The behavior is defined by the engine not the extension. When performing mathematical operations on objects, they are treated as integers. It is up to the user to cast the object to the appropriate type to maintain proper precision.<br />
~~</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77380""></a>
  <div class="note">
   <strong class="user">cmsa at gmx dot de</strong>
   <a href="#77380" class="date">27-Aug-2007 02:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a problem with entities.<br />
<br />
My first solution: <br />
I saved Data that way:<br />
$ENTRY_-&gt;<br />
addchild('Nachricht',htmlentities($_POST["blog"]));<br />
<br />
Had Entities in the XML-File like:<br />
&lt;!ENTITY auml "&amp;amp;auml"&gt;<br />
<br />
And I loaded the Data that way:<br />
html_entity_decode($ENTRY-&gt;Nachname);<br />
<br />
But after saving and <br />
loading the xml-file the entity-entry<br />
&lt;!ENTITY auml "&amp;amp;auml"&gt;<br />
disappeared. strange...<br />
<br />
My second solution: <br />
With saving the Data this way:<br />
$ENTRY_-&gt;<br />
addchild('Nachricht',htmlentities(htmlentities($_POST["blog"])));<br />
<br />
I can now load it with html_entity_decode without the<br />
&nbsp;entity-entry in the XML-file! <br />
I tested it with äöü. <br />
<br />
Hope it helpes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77134""></a>
  <div class="note">
   <strong class="user">karsten dot bruch at bms-verlage dot de</strong>
   <a href="#77134" class="date">16-Aug-2007 05:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When creating a new XML document and adding text with umlauts and such<br />
<br />
<span class="default">&lt;?php $SimpleXMLElement</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">(); </span><span class="default">?&gt;<br />
</span><br />
will silently NOT output any content with umlauts. <br />
<br />
Use htmlentities () while adding Umlauts &amp; co to solve the "problem"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76894""></a>
  <div class="note">
   <strong class="user">anthony dot parsons at manx dot net</strong>
   <a href="#76894" class="date">04-Aug-2007 04:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're handling lots of HTML or mixed-content XML you'll probably want to use the DOM functions instead of SimpleXML. Take this for example:<br />
<span class="default">&lt;?php<br />
$html </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">'&lt;div&gt;&lt;p&gt;Some text, &lt;a href="#"&gt;a link,&lt;/a&gt; more text&lt;/p&gt;&lt;/div&gt;'</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$html</span><span class="keyword">-&gt;</span><span class="default">p</span><span class="keyword">-&gt;</span><span class="default">a</span><span class="keyword">,</span><span class="string">"&lt;br&gt;\n"</span><span class="keyword">; </span><span class="comment">// "a link,"<br />
</span><span class="keyword">echo </span><span class="default">$html</span><span class="keyword">-&gt;</span><span class="default">p</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// "Some text, more text" (!)<br />
</span><span class="default">?&gt;<br />
</span>In the above example reconstructing the original markup is impossible because of the way SimpleXML represents the data.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74172""></a>
  <div class="note">
   <strong class="user">php at werner dash ott dot de</strong>
   <a href="#74172" class="date">28-Mar-2007 03:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Concerning SimpleXML and sessions:<br />
<br />
When creating a SimpleXML object (to be precise: a SimpleXMLElement object) in the context of a session and storing it in $_SESSION['XMLobject'], this object does not "survive" the session!<br />
<br />
By the time re-entering the session, print_r($_SESSION['XMLobject']) says:<br />
<br />
['XMLobject'] =&gt; SimpleXMLElement Object<br />
Warning:&nbsp; Node no longer exists in /your_php_file.php on line xyz<br />
&nbsp;&nbsp; (<br />
&nbsp;&nbsp; )<br />
<br />
(Message simplified for the sake of better readability.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73817""></a>
  <div class="note">
   <strong class="user">codje2 at lboro dot ac dot uk</strong>
   <a href="#73817" class="date">11-Mar-2007 10:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes it's nice to mix up data storage types. This is a very simple SQL to XML converter. Feed it a SQL query and it outputs the result in XML.<br />
<br />
The first paramater should be a mysql_query result<br />
(optional)The second is the xml name for each row (i.e the second depth of XML)<br />
(optional)The third is the name of the XML document, the root name<br />
<br />
<span class="default">&lt;?php<br />
$result</span><span class="keyword">=</span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"SELECT * FROM users"</span><span class="keyword">);<br />
</span><span class="default">sql_to_xml</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,</span><span class="string">"users"</span><span class="keyword">,</span><span class="string">"members"</span><span class="keyword">);<br />
<br />
function </span><span class="default">sql_to_xml</span><span class="keyword">(</span><span class="default">$mysql_result</span><span class="keyword">,</span><span class="default">$row_name</span><span class="keyword">=</span><span class="string">"row"</span><span class="keyword">,</span><span class="default">$doc_name</span><span class="keyword">=</span><span class="string">"root"</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xml</span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">"&lt;</span><span class="default">$doc_name</span><span class="string">&gt;&lt;/</span><span class="default">$doc_name</span><span class="string">&gt;"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">$line</span><span class="keyword">=</span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$mysql_result</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$row</span><span class="keyword">=</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">(</span><span class="default">$row_name</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$line </span><span class="keyword">as </span><span class="default">$column </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">$column</span><span class="keyword">=</span><span class="string">"</span><span class="default">$value</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73407""></a>
  <div class="note">
   <strong class="user">php at NOSPAM dot coutch dot com</strong>
   <a href="#73407" class="date">21-Feb-2007 11:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Memory leak when setting attributes as in example (#Example 2134. Setting values)<br />
<br />
This probably goes unnoticed in web scripts (unless you do a LOT of xml manipulations), but I ran into this in my standalone script that processes a large number of XML files.<br />
<br />
The following code will eat up memory quite fast:<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">include </span><span class="string">'example.php'</span><span class="keyword">;<br />
<br />
while (</span><span class="default">true</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xmlstr</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">movie</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]-&gt;</span><span class="default">characters</span><span class="keyword">-&gt;</span><span class="default">character</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="string">'Miss Coder'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
while this seems to behave correctly:<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">include </span><span class="string">'example.php'</span><span class="keyword">;<br />
<br />
while (</span><span class="default">true</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xmlstr</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">xpath</span><span class="keyword">(</span><span class="string">"//character"</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$c</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="string">'Miss Coder'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This looks like bug #38604, and I just confirmed that in 6.0.0-dev (on Windows at least) it is fixed.&nbsp; It is NOT fixed in 5.2.1 or&nbsp; 5.2.2-dev (2/21 build), so for 5.2 users, use the second form to avoid leaks.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73362""></a>
  <div class="note">
   <strong class="user">joel [from the website] purerave.com</strong>
   <a href="#73362" class="date">20-Feb-2007 02:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It doesn't mention this anywhere, but creationg a new SimpleXMLElement object from a non-valid string throws an exception. It looks ugly in the php log as it dumps the stack in multiple lines.<br />
<br />
The correct way to create a new SimpleXMLElement object is like so:<br />
<span class="default">&lt;?php<br />
$xmlstr </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">; </span><span class="comment">// empty to throw an exception<br />
</span><span class="keyword">try {<br />
&nbsp;&nbsp; </span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xmlstr</span><span class="keyword">);<br />
} catch (</span><span class="default">Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="comment">// handle the error<br />
&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'$xmlstr is not a valid xml string'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70950""></a>
  <div class="note">
   <strong class="user">matt at mattbostock dot com</strong>
   <a href="#70950" class="date">06-Nov-2006 08:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful when using var_export to debug element attributes - it won't work! Always use print() or similar for checking the contents of element attributes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70519""></a>
  <div class="note">
   <strong class="user">Arnaud Bienvenu</strong>
   <a href="#70519" class="date">19-Oct-2006 04:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of PHP 5.1.4, trying to iterate on a non-existent node will actually create that node.<br />
<br />
&lt;?<br />
$xml = simplexml_load_string('&lt;root&gt;&lt;/root&gt;');<br />
foreach($xml-&gt;b as $dummy);<br />
echo $xml-&gt;asXML();<br />
?&gt;<br />
<br />
Gives :<br />
<br />
&lt;?xml version="1.0"?&gt; <br />
&lt;root&gt;&lt;b/&gt;&lt;/root&gt;<br />
<br />
You might think it is a bug, but PHP developers seam to consider it as a feature : <a href="http://bugs.php.net/bug.php?id=39164" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=39164</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66896""></a>
  <div class="note">
   <strong class="user">Jason Sheets &lt;jsheets at shadonet dot com&gt;</strong>
   <a href="#66896" class="date">31-May-2006 07:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is my Simple XML to array function, it is recursive and has the benefit of maintaining key value relationships and has worked well for me.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">XMLToArray</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">)<br />
{<br />
&nbsp; if (</span><span class="default">$xml </span><span class="keyword">instanceof </span><span class="default">SimpleXMLElement</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$children </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; foreach (</span><span class="default">$children </span><span class="keyword">as </span><span class="default">$element </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$value </span><span class="keyword">instanceof </span><span class="default">SimpleXMLElement</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$values </span><span class="keyword">= (array)</span><span class="default">$value</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="default">$element</span><span class="keyword">] = </span><span class="default">XMLToArray</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$return</span><span class="keyword">[</span><span class="default">$element</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="default">$element</span><span class="keyword">] = (string)</span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$return</span><span class="keyword">[</span><span class="default">$element</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="default">$element</span><span class="keyword">] = array(</span><span class="default">$return</span><span class="keyword">[</span><span class="default">$element</span><span class="keyword">], (string)</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="default">$element</span><span class="keyword">][] = (string)</span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; <br />
&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$return</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;<br />
&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$false</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66259""></a>
  <div class="note">
   <strong class="user">daniel dot oconnor at gmail dot com</strong>
   <a href="#66259" class="date">18-May-2006 03:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SimpleXML handles namespaces, but it's not documented very well here at all.<br />
<br />
If you wanted to parse, say, an open office manifest file or a piece of RDF/XML, you have to get elements and attributes by the namespace url.<br />
<br />
Example:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">display</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xml </span><span class="keyword">= </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="default">$in </span><span class="keyword">. </span><span class="string">" does not exist"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$manifest </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">(</span><span class="string">'<a href="http://openoffice.org/2001/manifest" rel="nofollow" target="_blank">http://openoffice.org/2001/manifest</a>'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$manifest</span><span class="keyword">-&gt;</span><span class="default">xpath</span><span class="keyword">(</span><span class="string">'//manifest:file-entry'</span><span class="keyword">) as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">(</span><span class="string">'<a href="http://openoffice.org/2001/manifest" rel="nofollow" target="_blank">http://openoffice.org/2001/manifest</a>'</span><span class="keyword">) as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"Key:" </span><span class="keyword">. </span><span class="default">$key </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"Value:" </span><span class="keyword">. </span><span class="default">$value </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
File: manifest.xml<br />
<br />
&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br />
&lt;!DOCTYPE manifest:manifest PUBLIC "-//OpenOffice.org//DTD Manifest 1.0//EN" "Manifest.dtd"&gt;<br />
&lt;manifest:manifest xmlns:manifest="<a href="http://openoffice.org/2001/manifest" rel="nofollow" target="_blank">http://openoffice.org/2001/manifest</a>"&gt;<br />
&nbsp;&lt;manifest:file-entry manifest:media-type="application/vnd.sun.xml.writer" manifest:full-path="/"/&gt;<br />
&nbsp;&lt;manifest:file-entry manifest:media-type="application/vnd.sun.xml.ui.configuration" manifest:full-path="Configurations2/"/&gt;<br />
&nbsp;&lt;manifest:file-entry manifest:media-type="application/binary" manifest:full-path="layout-cache"/&gt;<br />
&nbsp;&lt;manifest:file-entry manifest:media-type="text/xml" manifest:full-path="content.xml"/&gt;<br />
&nbsp;&lt;manifest:file-entry manifest:media-type="text/xml" manifest:full-path="styles.xml"/&gt;<br />
&nbsp;&lt;manifest:file-entry manifest:media-type="text/xml" manifest:full-path="meta.xml"/&gt;<br />
&nbsp;&lt;manifest:file-entry manifest:media-type="" manifest:full-path="Thumbnails/thumbnail.png"/&gt;<br />
&nbsp;&lt;manifest:file-entry manifest:media-type="" manifest:full-path="Thumbnails/"/&gt;<br />
&nbsp;&lt;manifest:file-entry manifest:media-type="text/xml" manifest:full-path="settings.xml"/&gt;<br />
&lt;/manifest:manifest&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52583""></a>
  <div class="note">
   <strong class="user">paul at preinheimer dot com</strong>
   <a href="#52583" class="date">06-May-2005 02:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi,<br />
<br />
If you want to access an element that has a dash in its name, (as is common with the XML documents provided by the Library of Congress, as well as the NWS) you will need to handle it a little bit differently. <br />
<br />
You can either use XPATH, which works fine, but will return an array of results every time, even if there is a single result.<br />
eg.<br />
<br />
<span class="default">&lt;?php<br />
$xml</span><span class="keyword">-&gt;</span><span class="default">xpath</span><span class="keyword">(</span><span class="string">'/data/time-layout/start-valid-time'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
You can also choose just to encapsulate the element names containing a dash:<br />
<span class="default">&lt;?php $xml</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">-&gt;{</span><span class="string">'time-layout'</span><span class="keyword">}-&gt;{</span><span class="string">'start-valid-time'</span><span class="keyword">} </span><span class="default">?&gt;<br />
</span><br />
--<br />
<br />
On a only partially related note, dealing with SimpleXML is one of the only times I have employed casting with PHP. While iterating (foreach) through the valid times, echo'ing the element worked great (it merely echo'ed the apropriate time), assigning it to another variable resulted in a SimpleXML object containing the time to be assigned, rather than just the time itself. This was resolved by casting the time to a string:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">foreach(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">-&gt;{</span><span class="string">'time-layout'</span><span class="keyword">}-&gt;{</span><span class="string">'start-valid-time'</span><span class="keyword">} AS </span><span class="default">$time</span><span class="keyword">)<br />
{<br />
&nbsp;</span><span class="default">$weatherDates</span><span class="keyword">[] = (string) </span><span class="default">$time</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52512""></a>
  <div class="note">
   <strong class="user">T CHASSAGNETTE t_chassagnette at yahoo dot fr</strong>
   <a href="#52512" class="date">04-May-2005 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another method to parse an XML Document into a PHP array with SIMPLEXML inspired from Daniel FAIVRE !<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">xml2php</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fils </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tab </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$child </span><span class="keyword">= </span><span class="default">xml2php</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//To deal with the attributes<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$node</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$ak</span><span class="keyword">=&gt;</span><span class="default">$av</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$child</span><span class="keyword">[</span><span class="default">$ak</span><span class="keyword">] = (string)</span><span class="default">$av</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Let see if the new child is not in the array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$tab</span><span class="keyword">==</span><span class="default">false </span><span class="keyword">&amp;&amp; </span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">,</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//If this element is already in the array we will create an indexed array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">][] = </span><span class="default">$tmp</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">][] = </span><span class="default">$child</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tab </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; elseif(</span><span class="default">$tab </span><span class="keyword">== </span><span class="default">true</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Add an element in an existing array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">][] = </span><span class="default">$child</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Add a simple element<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$child</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fils</span><span class="keyword">++;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$fils</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (string)</span><span class="default">$xml</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50470""></a>
  <div class="note">
   <strong class="user">nelson_menezes at yahoo dot co dot uk</strong>
   <a href="#50470" class="date">01-Mar-2005 02:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that SimpleXML expects to both read and output XML in UTF-8 encoding. You'll need to add a line such as this at the top of your input XML file if it isn't saved in UTF-8 (adjust to whatever encoding used):<br />
<br />
&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt;<br />
<br />
On the output side of things, if you're not serving/handling UTF-8, you'll need to use utf8_decode() [red. but that will only work for ISO-8859-1, not other encodings]. Common mistake: <a href="http://bugs.php.net/bug.php?id=28154" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=28154</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48646""></a>
  <div class="note">
   <strong class="user">brcavanagh AT NO SPAM hotmail.com</strong>
   <a href="#48646" class="date">03-Jan-2005 06:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are looking to use SimpleXML for anything but reading XML documents, you should really reconsider, and use the XML DOM library.&nbsp; By the time you get enough utilities implemented in DOM to handle all the set backs in SimpleXML, you will have defeated the purpose of using SimpleXML.&nbsp; There are a few reasons for this, and there are already many workrounds, but the primairy issues are this <br />
<br />
1) No complex node assignment.&nbsp; You cannot switch nodes or replace them.&nbsp; <br />
<br />
2) No appending new child nodes<br />
<br />
3) Whenever you do something like $new_node = $xml_doc-&gt;node you will always get a reference even if you use a clone method, which will crash the script.<br />
<br />
Other than that, its a great tool for reading docs.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="simplexmliterator.valid.html">SimpleXMLIterator::valid</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.simplexml-import-dom.html">simplexml_import_dom</a></div>
 <div class="up"><a href="book.simplexml.html">SimpleXML</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
