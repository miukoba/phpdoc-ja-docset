<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>ファイルの内容を全て文字列に読み込む</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.file-exists.html">file_exists</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.file-put-contents.html">file_put_contents</a></div>
 <div class="up"><a href="ref.filesystem.html">ファイルシステム 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.file-get-contents" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">file_get_contents</h1> 
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5)</p><p class="refpurpose"><span class="refname">file_get_contents</span> &mdash; <span class="dc-title">ファイルの内容を全て文字列に読み込む</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.file-get-contents-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>file_get_contents</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$use_include_path</code><span class="initializer"> = false</span></span>
   [, <span class="methodparam"><span class="type">resource</span> <code class="parameter">$context</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$offset</code><span class="initializer"> = -1</span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$maxlen</code></span>
  ]]]] )</div>

  <p class="para rdfs-comment"> 
   この関数は  <span class="function"><a href="function.file.html" class="function">file()</a></span> と似ていますが、
   <em><code class="parameter">offset</code></em> で指定した場所から開始し
   <em><code class="parameter">maxlen</code></em> バイト分だけ
   ファイルの内容を文字列に読み込むという点が異なります。
   失敗した場合、 <span class="function"><strong>file_get_contents()</strong></span> は <strong><code>FALSE</code></strong> を返します。
  </p>
  <p class="para">
    <span class="function"><strong>file_get_contents()</strong></span>はファイルの内容を文字列に読み込む
   方法として好ましいものです。もしOSがサポートしていれば
   パフォーマンス向上のためにメモリマッピング技術が使用されます。
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    空白のような特殊な文字を有する URI をオープンする場合には、
     <span class="function"><a href="function.urlencode.html" class="function">urlencode()</a></span> でその URI をエンコードする必要があります。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.file-get-contents-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><em><code class="parameter">filename</code></em></span>
     <dd>

      <p class="para">
       データを読み込みたいファイルの名前。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">use_include_path</code></em></span>
     <dd>

      <blockquote class="note"><p><strong class="note">注意</strong>: 
       <p class="para">
        PHP 5 以降では、定数 <strong><code>FILE_USE_INCLUDE_PATH</code></strong>
        を使用して <a href="ini.core.html#ini.include-path" class="link">インクルードパス</a>
        から探すことができます。
       </p>
      </p></blockquote>
      
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">context</code></em></span>
     <dd>

      <p class="para">
        <span class="function"><a href="function.stream-context-create.html" class="function">stream_context_create()</a></span> で作成したコンテキストリソース。
       独自のコンテキストを使用する必要がない場合は、このパラメータに
       <strong><code>NULL</code></strong> を指定します。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">offset</code></em></span>
     <dd>

      <p class="para">
       元のストリーム上で、読み込みを開始するオフセット位置。
      </p>
      <p class="para">
       リモートファイルに対するシーク (<em><code class="parameter">offset</code></em> 指定) はサポートしていません。
       オフセットが小さい場合はリモートファイルでのシークがうまくいくこともありますが、
       これはバッファリングされたストリーム上で動作しているだけのことです。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">maxlen</code></em></span>
     <dd>

      <p class="para">
       読み込むデータの最大バイト数。
       デフォルトは、ファイル終端に達するまで読み込みます。
       このパラメータは、フィルタが処理した後のストリームに適用されることに注意しましょう。
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.file-get-contents-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   読み込んだデータを返します。失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
  <div class="warning"><strong class="warning">警告</strong><p class="simpara">この関数は論理値
<strong><code>FALSE</code></strong> を返す可能性がありますが、<strong><code>FALSE</code></strong> として評価される値を返す可能性もあります。
詳細については <a href="language.types.boolean.html" class="link">論理値</a>の
セクションを参照してください。この関数の返り値を調べるには
<a href="language.operators.comparison.html" class="link">===演算子</a> を
使用してください。</p></div>
 </div>


 <div class="refsect1 errors" id="refsect1-function.file-get-contents-errors">
  <h3 class="title">エラー / 例外</h3>
  <p class="para">
   <em><code class="parameter">filename</code></em> が見つからない場合、<em><code class="parameter">maxlength</code></em>
   がゼロより小さい場合、あるいはストリーム内での指定した <em><code class="parameter">offset</code></em> へのシークが失敗した場合に
   <strong><code>E_WARNING</code></strong> レベルのエラーが発生します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.file-get-contents-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-2356">
    <p><strong>例1 とあるウェブサイトのホームページのソースの取得と出力</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$homepage&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://www.example.com/'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$homepage</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-2357">
    <p><strong>例2 include_path の検索</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;&lt;=&nbsp;PHP&nbsp;5<br /></span><span style="color: #0000BB">$file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'./people.txt'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//&nbsp;&gt;&nbsp;PHP&nbsp;5<br /></span><span style="color: #0000BB">$file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'./people.txt'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">FILE_USE_INCLUDE_PATH</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-2358">
    <p><strong>例3 ファイルの一部の読み込み</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;21&nbsp;文字目から&nbsp;14&nbsp;文字ぶん読み込みます<br /></span><span style="color: #0000BB">$section&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'./people.txt'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">14</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$section</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は、
たとえば以下のようになります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(14) &quot;lle Bjori Ro&quot; 
</pre></div>
    </div>
   </div>
   <div class="example" id="example-2359">
    <p><strong>例4 ストリームコンテキストの使用</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;ストリームを作成します<br /></span><span style="color: #0000BB">$opts&nbsp;</span><span style="color: #007700">=&nbsp;array(<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'http'</span><span style="color: #007700">=&gt;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'method'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"GET"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'header'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"Accept-language:&nbsp;en\r\n"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"Cookie:&nbsp;foo=bar\r\n"<br />&nbsp;&nbsp;</span><span style="color: #007700">)<br />);<br /><br /></span><span style="color: #0000BB">$context&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_context_create</span><span style="color: #007700">(</span><span style="color: #0000BB">$opts</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;上で設定した&nbsp;HTTP&nbsp;ヘッダを使用してファイルをオープンします<br /></span><span style="color: #0000BB">$file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://www.example.com/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$context</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 
 <div class="refsect1 changelog" id="refsect1-function.file-get-contents-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      
      <tr>
       <td>5.1.0</td>
       <td>
        <em><code class="parameter">offset</code></em> と
        <em><code class="parameter">maxlen</code></em> パラメータが追加されました。
       </td>
      </tr>

      <tr>
       <td>5.0.0</td>
       <td>
        コンテキストサポートが追加されました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.file-get-contents-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara">この関数はバイナリデータに対応しています。
</span></p></blockquote>
  <div class="tip"><strong class="tip">ヒント</strong><p class="simpara"><a href="filesystem.configuration.html#ini.allow-url-fopen" class="link">fopen wrappers</a> が有効の場合、この関数のファイル名として
URL を使用することができます。ファイル名の指定方法に関する詳細は
 <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span> を参照ください。
<a href="wrappers.html" class="xref">サポートするプロトコル/ラッパー</a> には、さまざまなラッパーの機能やその使用法、
提供される定義済み変数などの情報がまとめられています。</p></div>
  <div class="warning"><strong class="warning">警告</strong><p class="para">IIS のような、いくつかの標準に
対応してない Web サーバーは、PHP に警告を発生させるような手順でデータを送信します。
このようなサーバーを使用する場合は、<a href="errorfunc.configuration.html#ini.error-reporting" class="link">
error_reporting</a> を警告を発生しないレベルまで小さくする必要があります。
PHP 4.3.7 以降では、<em>https://</em> ラッパーでストリームをオープンする際に
バグがある IIS サーバーソフトウエアを検出することができ、この警告を抑制することができます。
あなたが <em>ssl://</em> ソケットを作成するために   <span class="function"><a href="function.fsockopen.html" class="function">fsockopen()</a></span> を使用している場合、
自らこの警告を検出し、抑制する必要があります。</p></div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.file-get-contents-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"> <span class="function"><a href="function.file.html" class="function" rel="rdfs-seeAlso">file()</a> - ファイル全体を読み込んで配列に格納する</span></li>
    <li class="member"> <span class="function"><a href="function.fgets.html" class="function" rel="rdfs-seeAlso">fgets()</a> - ファイルポインタから 1 行取得する</span></li>
    <li class="member"> <span class="function"><a href="function.fread.html" class="function" rel="rdfs-seeAlso">fread()</a> - バイナリセーフなファイルの読み込み</span></li>
    <li class="member"> <span class="function"><a href="function.readfile.html" class="function" rel="rdfs-seeAlso">readfile()</a> - ファイルを出力する</span></li>
    <li class="member"> <span class="function"><a href="function.file-put-contents.html" class="function" rel="rdfs-seeAlso">file_put_contents()</a> - 文字列をファイルに書き込む</span></li>
    <li class="member"> <span class="function"><a href="function.stream-get-contents.html" class="function" rel="rdfs-seeAlso">stream_get_contents()</a> - 残りのストリームを文字列に読み込む</span></li>
    <li class="member"> <span class="function"><a href="function.stream-context-create.html" class="function" rel="rdfs-seeAlso">stream_context_create()</a> - ストリームコンテキストを作成する</span></li>
    <li class="member"><a href="reserved.variables.httpresponseheader.html" class="link">$http_response_header</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111708""></a>
  <div class="note">
   <strong class="user">volkan-k at users dot sourceforge dot net</strong>
   <a href="#111708" class="date">20-Mar-2013 06:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using file_get_contents() function to retrieve HTTP url and printing HTTP content, you can also send original content-type header using $http_response_header and header() function;<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">foreach (</span><span class="default">$http_response_header </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^Content-Type:/i'</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Successful match<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">,</span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110297""></a>
  <div class="note">
   <strong class="user">leomac at inbox dot ru</strong>
   <a href="#110297" class="date">09-Oct-2012 06:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Reading all script input is simple task with file_get_contents, but it depends on what SAPI is being used.<br />
<br />
Only in Apache, not in CLI:<br />
<span class="default">&lt;?php<br />
&nbsp; $input </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"php://input"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Only in CLI, not in Apache:<br />
<span class="default">&lt;?php<br />
&nbsp; $input </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"php://stdin"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
In Apache php://stdin will be empty, in CLI php://input will be empyt instead with no error indication.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110235""></a>
  <div class="note">
   <strong class="user">rnd</strong>
   <a href="#110235" class="date">04-Oct-2012 12:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Function to get enum values for table field.<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">enumValues</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fGetContents </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$fGetContents</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$e</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[] = </span><span class="default">$e</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] .</span><span class="string">"','"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="default">$arr</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var </span><span class="keyword">= </span><span class="string">"'" </span><span class="keyword">. </span><span class="default">$str</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$var</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Insert into file like this<br />
Value1<br />
Value2<br />
Value3</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109906""></a>
  <div class="note">
   <strong class="user">andrew at 21cv dot co dot uk</strong>
   <a href="#109906" class="date">02-Sep-2012 07:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Negative offsets don't work as you might expect (like in <a href="http://php.net/substr for example" rel="nofollow" target="_blank">http://php.net/substr for example</a>)<br />
<br />
So<br />
<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">null</span><span class="keyword">, -</span><span class="default">10</span><span class="keyword">) </span><span class="default">?&gt;<br />
</span>does the same as<br />
<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">null</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">) </span><span class="default">?&gt;<br />
</span><br />
To get the last 10 characters of a file, you need to use<br />
<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">file_get_contents </span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">null</span><span class="keyword">, (</span><span class="default">filesize </span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) - </span><span class="default">10</span><span class="keyword">)) </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108975""></a>
  <div class="note">
   <strong class="user">werdnanoslen at gmail dot com</strong>
   <a href="#108975" class="date">09-Jun-2012 03:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an easy way to trigger scripts by listening for POSTs. I simply point a service's webhook url to the script, which file_get_contents("php://input"), cast to an array, and then simplexml_load_string() to parse it and use one of the keys' data as the parameter for my script.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108431""></a>
  <div class="note">
   <strong class="user">dustin at dumontproject dot com-spam sux</strong>
   <a href="#108431" class="date">26-Apr-2012 06:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who use file_get_contents for JSON or other RESTful services - like my architecture did for a big site - this will probably help a lot.<br />
<br />
We struggled with having the site using get urls that would go through our load balancer instead of hitting the local server.<br />
<br />
What we did was load this function through a local url and set the Host: header for our virtualhost entries on the site we wanted to laod.<br />
<br />
This code solved our issue:<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">//set the header context stream for virtualhost lookup<br />
</span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(array(</span><span class="string">'http' </span><span class="keyword">=&gt; array(</span><span class="string">'header' </span><span class="keyword">=&gt; </span><span class="string">'Host: www.VIRTUALHOSTDOMAIN.com'</span><span class="keyword">)));<br />
<br />
</span><span class="comment">//use a localhost url or alternatively 127.0.0.1 ip<br />
</span><span class="default">$url </span><span class="keyword">= </span><span class="string">'<a href="http://localhost/rest-service/?get-user&amp;id=######" rel="nofollow" target="_blank">http://localhost/rest-service/?get-user&amp;id=######</a>'</span><span class="keyword">;<br />
<br />
</span><span class="comment">//fetch the data through webserver using the Host http header we set<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$context</span><span class="keyword">));<br />
<br />
</span><span class="comment">//verify you have your data<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108309""></a>
  <div class="note">
   <strong class="user">Bart Friederichs</strong>
   <a href="#108309" class="date">16-Apr-2012 09:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
file_get_contents can do a POST, create a context for that first:<br />
<br />
$opts = array('http' =&gt;<br />
&nbsp; array(<br />
&nbsp;&nbsp;&nbsp; 'method'&nbsp; =&gt; 'POST',<br />
&nbsp;&nbsp;&nbsp; 'header'&nbsp; =&gt; "Content-Type: text/xml\r\n".<br />
&nbsp;&nbsp; &nbsp;&nbsp; "Authorization: Basic ".base64_encode("$https_user:$https_password")."\r\n",<br />
&nbsp;&nbsp;&nbsp; 'content' =&gt; $body,<br />
&nbsp;&nbsp;&nbsp; 'timeout' =&gt; 60<br />
&nbsp; )<br />
);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
$context&nbsp; = stream_context_create($opts);<br />
$url = 'https://'.$https_server;<br />
$result = file_get_contents($url, false, $context, -1, 40000);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106969""></a>
  <div class="note">
   <strong class="user">pperegrina</strong>
   <a href="#106969" class="date">22-Dec-2011 08:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those having this problem when trying to get_file_contents(url):<br />
<br />
Warning: file_get_contents(url): failed to open stream: HTTP request failed!&nbsp; in xx on line yy<br />
<br />
If you are behind a SonicWall firewall, read this:<br />
https://bugs.php.net/bug.php?id=40197<br />
(this little line: uncheck a box in the internal settings of the firewall labled "Enforce Host Tag Search with for CFS")<br />
<br />
Apparently by default SonicWall blocks any HTTP request without a "Host:" header, which is the case in the PHP get_file_contents(url) implementation.<br />
<br />
This is why, if you try to get the same URL from the same machine with cURL our wget, it works.<br />
<br />
I hope this will be useful to someone, it took me hours to find out :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106108""></a>
  <div class="note">
   <strong class="user">godwraith01 at yahoo dot com</strong>
   <a href="#106108" class="date">11-Oct-2011 01:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I experienced a problem in using hostnames instead straight IP with some server destinations.<br />
<br />
If i use file_get_contents("www.jbossServer.example/app1",...)<br />
i will get an 'Invalid hostname' from the server i'm calling.<br />
<br />
This is because file_get_contents probably will rewrite your request after getting the IP, obtaining the same thing as :<br />
file_get_contents("xxx.yyy.www.zzz/app1",...)<br />
<br />
And you know that many servers will deny you access if you go through IP addressing in the request.<br />
<br />
With cURL this problem doesn't exists. It resolves the hostname leaving the request as you set it, so the server is not rude in response.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104746""></a>
  <div class="note">
   <strong class="user">fibrefox at dynamicfiles dot de</strong>
   <a href="#104746" class="date">05-Jul-2011 02:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to insert tracking-scripts into your shopping-system, some scripts doesn't support intelligent detection of HTTPS, so i made a script i put on the server that rewrites 'http' to 'https' in the script, assuming everything has to be UTF-8 encoded (as a fallback it makes a redirect).<br />
<br />
It is important that the HTTPS-source DOES exist!<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">file_get_contents_utf8</span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$opts </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'method'</span><span class="keyword">=&gt;</span><span class="string">"GET"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt;</span><span class="string">"Content-Type: text/html; charset=utf-8"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; );<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= @</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">,</span><span class="default">false</span><span class="keyword">,</span><span class="default">$context</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-Type: text/html; charset=utf-8"</span><span class="keyword">);<br />
</span><span class="default">$tPath </span><span class="keyword">= </span><span class="string">"URL YOU WANT TO MODIFY"</span><span class="keyword">;<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">file_get_contents_utf8</span><span class="keyword">(</span><span class="string">"<a href="http://" rel="nofollow" target="_blank">http://</a>"</span><span class="keyword">.</span><span class="default">$tPath</span><span class="keyword">);<br />
<br />
if( </span><span class="default">$result </span><span class="keyword">== </span><span class="default">false</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Location: https://"</span><span class="keyword">.</span><span class="default">$tPath</span><span class="keyword">); </span><span class="comment">// fallback<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">exit();<br />
}<br />
else{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">mb_ereg_replace</span><span class="keyword">(</span><span class="string">"http"</span><span class="keyword">,</span><span class="string">"https"</span><span class="keyword">,</span><span class="default">$result</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104502""></a>
  <div class="note">
   <strong class="user">andre-s at home dot nl</strong>
   <a href="#104502" class="date">18-Jun-2011 09:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are getting a failed to open stream message on your windows machine check your hosts file.<br />
<br />
127.0.0.1&nbsp; &nbsp; &nbsp;&nbsp; localhost<br />
<br />
must be in it and the IP6 line must be commented<br />
<br />
#&nbsp; &nbsp; ::1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; localhost</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102769""></a>
  <div class="note">
   <strong class="user">eric at midkotasolutions dot com</strong>
   <a href="#102769" class="date">04-Mar-2011 08:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
At least as of PHP 5.3, file_get_contents no longer uses memory mapping.<br />
<br />
See comments on this bug report:<br />
<br />
<a href="http://bugs.php.net/bug.php?id=52802" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=52802</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102575""></a>
  <div class="note">
   <strong class="user">Stas Trefilov, OpteamIS</strong>
   <a href="#102575" class="date">22-Feb-2011 04:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
here is another (maybe the easiest) way of doing POST http requests from php using its built-in capabilities. feel free to add the headers you need (notably the Host: header) to further customize the request.<br />
<br />
note: this method does not allow file uploads. if you want to upload a file with your request you will need to modify the context parameters to provide multipart/form-data encoding (check out <a href="http://www.php.net/manual/en/context.http.php " rel="nofollow" target="_blank">http://www.php.net/manual/en/context.http.php </a>) and build the $data_url following the guidelines on <a href="http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.2" rel="nofollow" target="_blank">http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.2</a><br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
make an http POST request and return the response content and headers<br />
@param string $url&nbsp; &nbsp; url of the requested script<br />
@param array $data&nbsp; &nbsp; hash array of request variables<br />
@return returns a hash array with response content and headers in the following form:<br />
&nbsp;&nbsp;&nbsp; array ('content'=&gt;'&lt;html&gt;&lt;/html&gt;'<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; , 'headers'=&gt;array ('HTTP/1.1 200 OK', 'Connection: close', ...)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
*/<br />
</span><span class="keyword">function </span><span class="default">http_post </span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data_url </span><span class="keyword">= </span><span class="default">http_build_query </span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data_len </span><span class="keyword">= </span><span class="default">strlen </span><span class="keyword">(</span><span class="default">$data_url</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return array (</span><span class="string">'content'</span><span class="keyword">=&gt;</span><span class="default">file_get_contents </span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">stream_context_create </span><span class="keyword">(array (</span><span class="string">'http'</span><span class="keyword">=&gt;array (</span><span class="string">'method'</span><span class="keyword">=&gt;</span><span class="string">'POST'<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">, </span><span class="string">'header'</span><span class="keyword">=&gt;</span><span class="string">"Connection: close\r\nContent-Length: </span><span class="default">$data_len</span><span class="string">\r\n"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">, </span><span class="string">'content'</span><span class="keyword">=&gt;</span><span class="default">$data_url<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">))))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; , </span><span class="string">'headers'</span><span class="keyword">=&gt;</span><span class="default">$http_response_header<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102319""></a>
  <div class="note">
   <strong class="user">Yoga Wibowo Aji</strong>
   <a href="#102319" class="date">08-Feb-2011 06:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
read text per line and convert to array<br />
<br />
for example, the input file is input.txt<br />
the input file containt text below<br />
<br />
one<br />
two<br />
three<br />
four<br />
five<br />
<br />
++++++++++++++++++++++++++<br />
<br />
read value per line<br />
<br />
<span class="default">&lt;?php<br />
$data </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"input.txt"</span><span class="keyword">); </span><span class="comment">//read the file<br />
</span><span class="default">$convert </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">); </span><span class="comment">//create array separate by new line<br />
<br />
</span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$convert</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++)&nbsp; <br />
{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$convert</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="string">', '</span><span class="keyword">; </span><span class="comment">//write value by index<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
++++++++++++++++++++++++++<br />
<br />
Output :<br />
<br />
one, two, three, four, five,</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101639""></a>
  <div class="note">
   <strong class="user">contact at webapp dot fr</strong>
   <a href="#101639" class="date">31-Dec-2010 12:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using a URI with a login / password (HTTP or FTP, for an example), you may need to urlencode the password if it contains special characters.<br />
Do not urlencode the whole URI, just the password.<br />
<br />
Don't do :<br />
urlencode('<a href="ftp://login:mdp%?special@host/dir/file" rel="nofollow" target="_blank">ftp://login:mdp%?special@host/dir/file</a>')<br />
<br />
Do :<br />
'<a href="ftp://login:" rel="nofollow" target="_blank">ftp://login:</a>' . urlencode('mdp%?special') . '@host/dir/file';<br />
<br />
Might seem obvious, but is worth noting.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101263""></a>
  <div class="note">
   <strong class="user">slymak at gmail dot com</strong>
   <a href="#101263" class="date">06-Dec-2010 12:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If working file is bigger than 64kb and you getting deadlock. Your buffer is overflow. Here are two way how to avoid that.<br />
1) use temporary file for descriptor<br />
<span class="default">&lt;?php<br />
&nbsp; $descriptorspec </span><span class="keyword">= array(<br />
&nbsp;&nbsp; </span><span class="default">0 </span><span class="keyword">=&gt; array(</span><span class="string">"file"</span><span class="keyword">, </span><span class="string">"/tmp/ens/a.ens"</span><span class="keyword">,</span><span class="string">"r"</span><span class="keyword">),&nbsp; </span><span class="comment">// stdin is a pipe that the child will read from<br />
&nbsp;&nbsp; </span><span class="default">1 </span><span class="keyword">=&gt; array(</span><span class="string">"file"</span><span class="keyword">, </span><span class="string">"/tmp/ens/a.html"</span><span class="keyword">,</span><span class="string">"w"</span><span class="keyword">),&nbsp; </span><span class="comment">// stdout is a pipe that the child will write to<br />
&nbsp;&nbsp; </span><span class="default">2 </span><span class="keyword">=&gt; array(</span><span class="string">"file"</span><span class="keyword">, </span><span class="string">"/tmp/ens/error-output.txt"</span><span class="keyword">, </span><span class="string">"a"</span><span class="keyword">) </span><span class="comment">// stderr is a file to write to<br />
&nbsp; </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
2) inline read using stream_set_blocking. PHP doesn't proper handle last part of file.<br />
<span class="default">&lt;?php<br />
&nbsp; $READ_LEN </span><span class="keyword">= </span><span class="default">64</span><span class="keyword">*</span><span class="default">1024</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$MAX_BUF_LEN </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">*</span><span class="default">$READ_LEN</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="string">"<a href="http://some.domain.com:5984/" rel="nofollow" target="_blank">http://some.domain.com:5984/</a>"</span><span class="keyword">.</span><span class="default">$db</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$member</span><span class="keyword">.</span><span class="string">"/contents"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$src </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="string">"r"</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">$cwd </span><span class="keyword">= </span><span class="string">'/tmp'</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$cmd</span><span class="keyword">[</span><span class="string">'enscript'</span><span class="keyword">] = </span><span class="string">"/usr/bin/enscript"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$cmd</span><span class="keyword">[</span><span class="string">'enscript-options'</span><span class="keyword">] = </span><span class="string">" -q --language=html --color -Ejcl -o -"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$descriptorspec </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">0 </span><span class="keyword">=&gt; array(</span><span class="string">"pipe"</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">),&nbsp; </span><span class="comment">// stdin is a pipe that the child will read from<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">1 </span><span class="keyword">=&gt; array(</span><span class="string">"pipe"</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">)&nbsp;&nbsp; </span><span class="comment">// stdout is a pipe that the child will write to<br />
&nbsp; </span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">$ph</span><span class="keyword">=</span><span class="default">proc_open</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">[</span><span class="string">'enscript'</span><span class="keyword">].</span><span class="string">" "</span><span class="keyword">.</span><span class="default">$cmd</span><span class="keyword">[</span><span class="string">'enscript-options'</span><span class="keyword">],</span><span class="default">$descriptorspec</span><span class="keyword">,</span><span class="default">$pipes</span><span class="keyword">,</span><span class="default">$cwd</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">stream_set_blocking</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
&nbsp; </span><span class="default">stream_set_blocking</span><span class="keyword">(</span><span class="default">$pipes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">);<br />
&nbsp; </span><span class="default">stream_set_blocking</span><span class="keyword">(</span><span class="default">$pipes</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">$CMD_OUT_OPEN </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">; </span><span class="default">$k </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$pipes</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) || !</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">) || </span><span class="default">$k </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">) &amp;&amp; </span><span class="default">$k</span><span class="keyword">+</span><span class="default">$READ_LEN </span><span class="keyword">&lt;= </span><span class="default">$MAX_BUF_LEN</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$input </span><span class="keyword">.= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">,</span><span class="default">$READ_LEN</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$k </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$k </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$l </span><span class="keyword">= </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$pipes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$input</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$k </span><span class="keyword">-= </span><span class="default">$l</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$input </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">,</span><span class="default">$l</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$CMD_OUT_OPEN </span><span class="keyword">&amp;&amp; </span><span class="default">$k </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">feof</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$pipes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$CMD_OUT_OPEN </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$pipes</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],</span><span class="default">$READ_LEN</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$outputn </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"&lt;H1&gt;(stdin)&lt;/H1&gt;"</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">$output</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$outputn</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$pipes</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
<br />
&nbsp; </span><span class="default">$return_value </span><span class="keyword">= </span><span class="default">proc_close</span><span class="keyword">(</span><span class="default">$ph</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101239""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#101239" class="date">04-Dec-2010 04:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The offset is 0 based.&nbsp; Setting it to 1 will skip the first character of the stream.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101026""></a>
  <div class="note">
   <strong class="user">KrisWebDev</strong>
   <a href="#101026" class="date">21-Nov-2010 10:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your file_get_contents freezes during several seconds, here is maybe your answer:<br />
<br />
Beware that the default keepalive timeout of Apache 2.0 httpd is 15 seconds. This is true for HTTP/1.1 connections, which is not the default behavior of file_get_contents but you can force it, especially if you are trying to act as a web browser. I don't know if this is also the case for HTTP/1.0 connections.<br />
<br />
Forcing the server to close the connection would make you gain those 15 seconds in your script:<br />
<br />
<span class="default">&lt;?php<br />
$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(array(</span><span class="string">'http' </span><span class="keyword">=&gt; array(</span><span class="string">'header'</span><span class="keyword">=&gt;</span><span class="string">'Connection: close'</span><span class="keyword">)));<br />
</span><span class="default">$content </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"<a href="http://www.example.com/test.html" rel="nofollow" target="_blank">http://www.example.com/test.html</a>"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Another way of resolving slowness issues is to use cURL or fsockopen. Bear in mind that contrary to the behavior of web browsers, file_get_contents doesn't return the result when the web page is fully downloaded (i.e. HTTP payload length = value of the response HTTP "Content-Length" header) but when the TCP connection is closed.<br />
I hope this behavior will change in future releases of PHP.<br />
This has been experienced with PHP 5.3.3.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97009""></a>
  <div class="note">
   <strong class="user">vlad dot wing at gmail dot com</strong>
   <a href="#97009" class="date">27-Mar-2010 11:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to check if the function returned error, in case of a HTTP request an, it's not sufficient to test it against false. It may happen the return for that HTTP request was empty. In this case it's better to check if the return value is a bool.<br />
<br />
<span class="default">&lt;?php<br />
$result</span><span class="keyword">=</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"<a href="http://www.example.com" rel="nofollow" target="_blank">http://www.example.com</a>"</span><span class="keyword">);<br />
if (</span><span class="default">$result </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// treat error<br />
</span><span class="keyword">} else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// handle good case<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
[EDIT BY thiago: Has enhacements from an anonymous user]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95665""></a>
  <div class="note">
   <strong class="user">rutger at webjin dot nl</strong>
   <a href="#95665" class="date">14-Jan-2010 03:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes you might get an error opening an http URL.<br />
even though you have set "allow_url_fopen = On" in php.ini<br />
<br />
For me the the solution was to also set "user_agent" to something.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94303""></a>
  <div class="note">
   <strong class="user">ken at wetken dot net</strong>
   <a href="#94303" class="date">28-Oct-2009 02:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On Centos 5, and maybe other Red Hat based systems, any attempt to use file_get_contents to access a URL on an http&nbsp; port other than 80 (e.g. "<a href="http://www.example.com:8040/page" rel="nofollow" target="_blank">http://www.example.com:8040/page</a>") may fail with a permissions violation (error 13) unless the box you are running php on has its seLinux set to 'permissive' not 'enforcing' . Otherwise the request doesn't even get out of the box, i.e. the permissions violation is generated locally by seLinux.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91414""></a>
  <div class="note">
   <strong class="user">corey at effim dot com</strong>
   <a href="#91414" class="date">09-Jun-2009 11:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In my dev environment with a relatively low-speed drive (standard SATA 7200RPM) reading a 25MB zip file in 10 times...<br />
<br />
<span class="default">&lt;?php<br />
<br />
$data </span><span class="keyword">= `</span><span class="string">cat /tmp/test.zip</span><span class="keyword">`;<br />
</span><span class="comment">// 1.05 seconds<br />
<br />
</span><span class="default">$fh </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/tmp/test.zip'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">);<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">(</span><span class="string">'/tmp/test.zip'</span><span class="keyword">));<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);<br />
</span><span class="comment">// 1.31 seconds<br />
<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'/tmp/test.zip'</span><span class="keyword">);<br />
</span><span class="comment">// 1.33 seconds<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
However, on a 21k text file running 100 iterations...<br />
<br />
<span class="default">&lt;?php<br />
<br />
$data </span><span class="keyword">= `</span><span class="string">cat /tmp/test.txt</span><span class="keyword">`;<br />
</span><span class="comment">// 1.98 seconds<br />
<br />
</span><span class="default">$fh </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/tmp/test.txt'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">);<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">(</span><span class="string">'/tmp/test.txt'</span><span class="keyword">));<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);<br />
</span><span class="comment">// 0.00082 seconds<br />
<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'/tmp/test.txt'</span><span class="keyword">);<br />
</span><span class="comment">// 0.0069 seconds<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Despite the comment about file_get_contents being faster do to memory mapping, file_get_contents is slowest in both of the above examples. If you need the best performance out of your production box, you might want to throw together a script to check out which method is fastest for what size files on that particular machine, then optimize your code to check the file size and use the appropriate function for it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85008""></a>
  <div class="note">
   <strong class="user">colnector bla-at_bla colnect.com</strong>
   <a href="#85008" class="date">10-Aug-2008 11:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A UTF-8 issue I've encountered is that of reading a URL with a non-UTF-8 encoding that is later displayed improperly since file_get_contents() related to it as UTF-8. This small function should show you how to address this issue:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">file_get_contents_utf8</span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$content </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mb_detect_encoding</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">, </span><span class="string">'UTF-8, ISO-8859-1'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84956""></a>
  <div class="note">
   <strong class="user">EOD</strong>
   <a href="#84956" class="date">07-Aug-2008 02:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if $filename has a relative path file_get_contents returns the uninterpreted sourcecode of the php-file with all comments etc.<br />
<br />
I don't know whether this is a bug or intented or caused by server-configuration.<br />
<br />
I think this behaviour should be included in the description of the function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82527""></a>
  <div class="note">
   <strong class="user">joachimb at gmail dot com</strong>
   <a href="#82527" class="date">15-Apr-2008 11:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Setting the timeout properly without messing with ini values:<br />
<br />
<span class="default">&lt;?php<br />
$ctx </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'timeout' </span><span class="keyword">=&gt; </span><span class="default">1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; )<br />
);<br />
</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"<a href="http://example.com/" rel="nofollow" target="_blank">http://example.com/</a>"</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$ctx</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82255""></a>
  <div class="note">
   <strong class="user">3n1gm4 [at] gmail [dot] com</strong>
   <a href="#82255" class="date">02-Apr-2008 10:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a nice and simple substitute to get_file_contents() using curl, it returns FALSE if $contents is empty.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">curl_get_file_contents</span><span class="keyword">(</span><span class="default">$URL</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$URL</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$contents </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$contents</span><span class="keyword">) return </span><span class="default">$contents</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope this help, if there is something wrong or something you don't understand let me know :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80435""></a>
  <div class="note">
   <strong class="user">php [spat] hm2k.org</strong>
   <a href="#80435" class="date">16-Jan-2008 12:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I decided to make a similar function to this, called file_post_contents, it uses POST instead of GET to call, kinda handy...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">file_post_contents</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">$headers</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if (!isset(</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">] == </span><span class="string">'http'</span><span class="keyword">) { </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]=</span><span class="default">80</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; elseif (</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">] == </span><span class="string">'https'</span><span class="keyword">) { </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]=</span><span class="default">443</span><span class="keyword">; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]=isset(</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">])?</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]:</span><span class="string">''</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'protocol'</span><span class="keyword">]=</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">].</span><span class="string">'://'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$eol</span><span class="keyword">=</span><span class="string">"\r\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">=&nbsp; </span><span class="string">"POST "</span><span class="keyword">.</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'protocol'</span><span class="keyword">].</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">].</span><span class="string">" HTTP/1.0"</span><span class="keyword">.</span><span class="default">$eol</span><span class="keyword">. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"Host: "</span><span class="keyword">.</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].</span><span class="default">$eol</span><span class="keyword">. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"Referer: "</span><span class="keyword">.</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'protocol'</span><span class="keyword">].</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">].</span><span class="default">$eol</span><span class="keyword">. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"Content-Type: application/x-www-form-urlencoded"</span><span class="keyword">.</span><span class="default">$eol</span><span class="keyword">. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"Content-Length: "</span><span class="keyword">.</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]).</span><span class="default">$eol</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$eol</span><span class="keyword">.</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fsockopen</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">], </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">], </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$fp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$headers</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; while(!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">)) { </span><span class="default">$result </span><span class="keyword">.= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">128</span><span class="keyword">); }<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (!</span><span class="default">$headers</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//removes headers<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pattern</span><span class="keyword">=</span><span class="string">"/^.*\r\n\r\n/s"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">=</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$result</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79563""></a>
  <div class="note">
   <strong class="user">francois hill</strong>
   <a href="#79563" class="date">03-Dec-2007 05:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Seems file looks for the file inside the current working (executing) directory before looking in the include path, even with the FILE_USE_INCLUDE_PATH flag specified.<br />
<br />
Same behavior as include actually.<br />
<br />
By the way I feel the doc is not entirely clear on the exact order of inclusion (see include). It seems to say the include_path is the first location to be searched, but I have come across at least one case where the directory containing the file including was actually the first to be searched.<br />
<br />
Drat.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76358""></a>
  <div class="note">
   <strong class="user">bearachute at gmail dot com</strong>
   <a href="#76358" class="date">11-Jul-2007 11:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're having problems with binary and hex data:<br />
<br />
I had a problem when trying to read information from a ttf, which is primarily hex data. A binary-safe file read automatically replaces byte values with their corresponding ASCII characters, so I thought that I could use the binary string when I needed readable ASCII strings, and bin2hex() when I needed hex strings.<br />
<br />
However, this became a problem when I tried to pass those ASCII strings into other functions (namely gd functions). var_dump showed that a 5-character string contained 10 characters, but they weren't visible. A binary-to-"normal" string conversion function didn't seem to exist and I didn't want to have to convert every single character in hex using chr().<br />
<br />
I used unpack with "c*" as the format flag to see what was going on, and found that every other character was null data (ordinal 0). To solve it, I just did<br />
<br />
str_replace(chr(0), "", $string);<br />
<br />
which did the trick.<br />
<br />
This took forever to figure out so I hope this helps people reading from hex data!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74877""></a>
  <div class="note">
   <strong class="user">tobsn at php dot net</strong>
   <a href="#74877" class="date">02-May-2007 06:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you'll find the http response headers in: $http_response_header<br />
<br />
;o)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74551""></a>
  <div class="note">
   <strong class="user">Greg Ambrose (greg at catalina-it dot com dot au)</strong>
   <a href="#74551" class="date">17-Apr-2007 06:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editors note: As of PHP 5.2.1 you can specify `timeout` context option and pass the context to file_get_contents()]<br />
<br />
The only way I could get get_file_contents() to wait for a very slow http request was to set the socket timeout as follows.<br />
<br />
&nbsp;ini_set('default_socket_timeout',&nbsp; &nbsp; 120);&nbsp; &nbsp; <br />
$a = file_get_contents("<a href="http://abcxyz.com" rel="nofollow" target="_blank">http://abcxyz.com</a>");<br />
<br />
Other times like execution time and input time had no effect.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71556""></a>
  <div class="note">
   <strong class="user">siegfri3d at gmail dot com</strong>
   <a href="#71556" class="date">05-Dec-2006 09:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Use the previous example if you want to request the server for a special part of the content, IF and only if the server accepts the method.<br />
If you want a simple example to ask the server for all the content, but only save a portion of it, do it this way:<br />
<span class="default">&lt;?php<br />
$content</span><span class="keyword">=</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"<a href="http://www.google.com" rel="nofollow" target="_blank">http://www.google.com</a>"</span><span class="keyword">,</span><span class="default">FALSE</span><span class="keyword">,</span><span class="default">NULL</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">20</span><span class="keyword">);<br />
echo </span><span class="default">$content</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
This will echo the 20 first bytes of the google.com source code.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68636""></a>
  <div class="note">
   <strong class="user">fcicqbbs at gmail dot com</strong>
   <a href="#68636" class="date">04-Aug-2006 10:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
the bug #36857 was fixed.<br />
<a href="http://bugs.php.net/36857" rel="nofollow" target="_blank">http://bugs.php.net/36857</a><br />
<br />
Now you may use this code,to fetch the partial content like this:<br />
<span class="default">&lt;?php<br />
$context</span><span class="keyword">=array(</span><span class="string">'http' </span><span class="keyword">=&gt; array (</span><span class="string">'header'</span><span class="keyword">=&gt; </span><span class="string">'Range: bytes=1024-'</span><span class="keyword">, ),);<br />
</span><span class="default">$xcontext </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$context</span><span class="keyword">);<br />
</span><span class="default">$str</span><span class="keyword">=</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"<a href="http://www.fcicq.net/wp/" rel="nofollow" target="_blank">http://www.fcicq.net/wp/</a>"</span><span class="keyword">,</span><span class="default">FALSE</span><span class="keyword">,</span><span class="default">$xcontext</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>that's all.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58758""></a>
  <div class="note">
   <strong class="user">richard dot quadling at bandvulc dot co dot uk</strong>
   <a href="#58758" class="date">15-Nov-2005 11:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If, like me, you are on a Microsoft network with ISA server and require NTLM authentication, certain applications will not get out of the network. SETI@Home Classic and PHP are just 2 of them.<br />
<br />
The workaround is fairly simple.<br />
<br />
First you need to use an NTLM Authentication Proxy Server. There is one written in Python and is available from <a href="http://apserver.sourceforge.net/. You will need Python from http://www.python.org/." rel="nofollow" target="_blank">http://apserver.sourceforge.net/. You will need Python from http://www.python.org/.</a><br />
<br />
Both sites include excellent documentation.<br />
<br />
Python works a bit like PHP. Human readable code is handled without having to produce a compiled version. You DO have the opportunity of compiling the code (from a .py file to a .pyc file).<br />
<br />
Once compiled, I installed this as a service (instsrv and srvany - parts of the Windows Resource Kit), so when the server is turned on (not logged in), the Python based NTLM Authentication Proxy Server is running.<br />
<br />
Then, and here is the bit I'm really interested in, you need to tell PHP you intend to route http/ftp requests through the NTLM APS.<br />
<br />
To do this, you use contexts.<br />
<br />
Here is an example.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Define a context for HTTP.<br />
</span><span class="default">$aContext </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'proxy' </span><span class="keyword">=&gt; </span><span class="string">'tcp://127.0.0.1:8080'</span><span class="keyword">, </span><span class="comment">// This needs to be the server and the port of the NTLM Authentication Proxy Server.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'request_fulluri' </span><span class="keyword">=&gt; </span><span class="default">True</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ),<br />
&nbsp;&nbsp;&nbsp; );<br />
</span><span class="default">$cxContext </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$aContext</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Now all file stream functions can use this context.<br />
<br />
</span><span class="default">$sFile </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"<a href="http://www.php.net" rel="nofollow" target="_blank">http://www.php.net</a>"</span><span class="keyword">, </span><span class="default">False</span><span class="keyword">, </span><span class="default">$cxContext</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$sFile</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Hopefully this helps SOMEONE!!!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49520""></a>
  <div class="note">
   <strong class="user">aidan at php dot net</strong>
   <a href="#49520" class="date">31-Jan-2005 08:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This functionality is now implemented in the PEAR package PHP_Compat.<br />
<br />
More information about using this function without upgrading your version of PHP can be found on the below link:<br />
<br />
<a href="http://pear.php.net/package/PHP_Compat" rel="nofollow" target="_blank">http://pear.php.net/package/PHP_Compat</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.file-exists.html">file_exists</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.file-put-contents.html">file_put_contents</a></div>
 <div class="up"><a href="ref.filesystem.html">ファイルシステム 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
