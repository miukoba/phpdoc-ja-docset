<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>設定を変更するには</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="configuration.changes.modes.html">どこで設定を行うのか</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="langref.html">言語リファレンス</a></div>
 <div class="up"><a href="configuration.html">実行時設定</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="configuration.changes" class="sect1">
   <h2 class="title">設定を変更するには</h2>

   <div class="sect2" id="configuration.changes.apache">
    <h3 class="title">Apache モジュールとして PHP を実行している場合</h3>
    <p class="simpara">
     PHP を Apache モジュールとして使用している場合、Apache 設定ファイル (例、<var class="filename">httpd.conf</var>)
     もしくは <var class="filename">.htaccess</var> ファイルにディレクティブを記述することで、PHP の設定の変更を行うことが
     可能です。このようにして設定変更を行うには、&quot;AllowOverride Options&quot; もしくは
     &quot;AllowOverride All&quot; 権限が必要です。
    </p>

    <p class="para">
     Apache 設定ファイルから PHP の設定を変更するには、
     以下に示す Apache ディレクティブを使用します。
     各設定オプションの変更の可否 (<strong><code>PHP_INI_ALL</code></strong>,
     <strong><code>PHP_INI_PERDIR</code></strong>, または <strong><code>PHP_INI_SYSTEM</code></strong>)
     については、付録
     <a href="ini.list.html" class="link">php.ini ディレクティブのリスト</a>
     を参照してください。
    </p>

    <p class="para">
     <dl>

      <dt>

       <span class="term">
        <code class="systemitem systemitem">php_value</code>
        <em><code class="parameter">name</code></em>
        <em><code class="parameter">value</code></em>
       </span>
       <dd>

        <p class="para">
         指定した設定オプションに値を設定します。変更の可否が、
         <strong><code>PHP_INI_ALL</code></strong> もしくは
         <strong><code>PHP_INI_PERDIR</code></strong> である設定オプションに対し利用できます。
         セット済みの値をクリアしたい場合は、<em>none</em> を
         値として使用してください。
        </p>
        <blockquote class="note"><p><strong class="note">注意</strong>: 
         <span class="simpara">
          論理値を設定する場合には <code class="systemitem systemitem">php_value</code>
          を使用しないでください。代わりに、<code class="systemitem systemitem">php_flag</code>
          （下記参照）を使用する必要があります。
         </span>
        </p></blockquote>
       </dd>

      </dt>

      <dt>

       <span class="term">
        <code class="systemitem systemitem">php_flag</code>
        <em><code class="parameter">name</code></em>
        <em><code class="parameter">on|off</code></em>
       </span>
       <dd>

        <p class="para">
         設定オプションに論理値を設定するために使用します。変更の可否が、
         <strong><code>PHP_INI_ALL</code></strong> もしくは
         <strong><code>PHP_INI_PERDIR</code></strong> である設定オプションで利用できます。
        </p>
       </dd>

      </dt>

      <dt>

       <span class="term">
        <code class="systemitem systemitem">php_admin_value</code>
        <em><code class="parameter">name</code></em>
        <em><code class="parameter">value</code></em>
       </span>
       <dd>

        <p class="para">
         指定した設定オプションに値を設定します。このディレクティブは、<var class="filename">.htaccess</var>
         ファイルでは利用できません。また、
         <code class="systemitem systemitem">php_admin_value</code>
         で設定された設定オプションの値は、<var class="filename">.htaccess</var>
         や  <span class="function"><a href="function.ini-set.html" class="function">ini_set()</a></span> では上書きできません。
         セット済みの値をクリアしたい場合は、<em>none</em>
         を値として使用してください。
        </p>
       </dd>

      </dt>

      <dt>

       <span class="term">
        <code class="systemitem systemitem">php_admin_flag</code>
        <em><code class="parameter">name</code></em>
        <em><code class="parameter">on|off</code></em>
       </span>
       <dd>

        <p class="para">
         設定オプションに論理値を設定するために使用します。
         このディレクティブは、<var class="filename">.htaccess</var> ファイルでは利用できません。
         php_admin_value で設定された設定オプションの値は、<var class="filename">.htaccess</var>
         や  <span class="function"><a href="function.ini-set.html" class="function">ini_set()</a></span> では上書きできません。
        </p>
       </dd>

      </dt>

     </dl>

    </p>
    <p class="para">
     <div class="example" id="example-64">
      <p><strong>例1 Apache 設定の例</strong></p>
      <div class="example-contents">
<div class="inicode"><pre class="inicode">&lt;IfModule mod_php5.c&gt;
  php_value include_path &quot;.:/usr/local/lib/php&quot;
  php_admin_flag engine on
&lt;/IfModule&gt;
&lt;IfModule mod_php4.c&gt;
  php_value include_path &quot;.:/usr/local/lib/php&quot;
  php_admin_flag engine on
&lt;/IfModule&gt;</pre>
</div>
      </div>

     </div>
    </p>
    <div class="caution"><strong class="caution">警告</strong>
     <p class="para">
      PHP 定数は PHP 以外では使用できません。たとえば、
      <var class="filename">httpd.conf</var> の中で
      <a href="errorfunc.configuration.html#ini.error-reporting" class="link">error_reporting</a>
      オプションを設定しようとして <strong><code>E_ALL</code></strong>
      や <strong><code>E_NOTICE</code></strong> のような PHP 定数を使用することは
      できません。これらは意味を有さないため、
      <em class="emphasis">0</em> と評価されてしまいます。
      代わりに、対応するビットマスク値を使用してください。
      <var class="filename">php.ini</var> の中では、これらの PHP 定数を使用することができます。
     </p>
    </div>
   </div>

   <div class="sect2" id="configuration.changes.windows">
    <h3 class="title">Windows レジストリによる PHP の設定の変更</h3>
    <p class="simpara">
     Windows 上で PHP を実行している場合、Windows レジストリを使用して設定値を
     ディレクトリ毎に変更することができます。
     設定値は、レジストリキー <em>HKLM\SOFTWARE\PHP\Per Directory Values</em>
     に保存され、そのサブキーがパス名となります。例えば、ディレクトリ
     <em>c:\inetpub\wwwroot</em> に対する設定値は、 キー
     <em>HKLM\SOFTWARE\PHP\Per Directory Values\c\inetpub\wwwroot</em>
     に保存されます。ディレクトリに対する設定は、そのディレクトリ、
     およびそのサブディレクトリで実行されるすべてのスクリプトで有効となります。
     PHP 設定オプションのディレクティブを名前とする文字列値をキーに登録してください。
     また、値のデータに PHP 定数を記述しても解釈されませんので、注意してください。
     しかし、<strong><code>PHP_INI_USER</code></strong>
     で変更可能な設定値はこの方法で設定することが可能ですが、
     <strong><code>PHP_INI_PERDIR</code></strong> である設定値は設定できません。
    </p>
   </div>

   <div class="sect2" id="configuration.changes.other">
    <h3 class="title">他の方法</h3>
    <p class="para">
     どのように PHP を実行しているかに係わらず、 <span class="function"><a href="function.ini-set.html" class="function">ini_set()</a></span> 関数を
     用いて、スクリプトの実行時に一部のオプションの設定値を変更することができます。詳細は、
      <span class="function"><a href="function.ini-set.html" class="function">ini_set()</a></span> 関数のリファレンスを参照してください。
    </p>
    <p class="para">
     使用しているシステムにおける現在のオプション設定値の完全なリストを得たい場合は、
      <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span> 関数を実行し、出力された結果を参照してください。
     また、 <span class="function"><a href="function.ini-get.html" class="function">ini_get()</a></span> 関数または  <span class="function"><a href="function.get-cfg-var.html" class="function">get_cfg_var()</a></span>
     関数を用いて、個々のオプションの設定値にアクセスすることも可能です。
    </p>
   </div>
  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="109605""></a>
  <div class="note">
   <strong class="user">nick at vistaworks dot net</strong>
   <a href="#109605" class="date">02-Aug-2012 12:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On Windows, as the documentation above states, you cannot set max_upload_filesize and post_max_size in the registry, because they are PHP_INI_PERDIR. <br />
<br />
Confusingly, however, is the fact that phpinfo() will show your changes if you do add those to the regsitry, as if they were taking effect. However, the upload size is *not* changed, regardless of what phpinfo() reports.<br />
<br />
I believe the reading of registry values and override happen 'too late' in the request processing, ie, after the file has already been uploaded and rejected.<br />
<br />
In a perfect world, phpinfo() would recognize this and not report the overridden values, which is very confusing.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107058""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#107058" class="date">04-Jan-2012 05:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For Mac users (Leopard/Tiger/Lion) it's worth knowing exactly where your httpd.conf and php.ini ares picked up, but, out of the box, these are defined only in the compiler settings as defaults.<br />
<br />
The httpd binary was compiled with default settings of <br />
SERVER_CONFIG_FILE="/private/etc/apache2/httpd.conf"<br />
meaning starting apache using apachectl picks up this httpd.conf without it being specified on the command line via the org.apache.httpd.plist file is /System/Library/LaunchDaemons.<br />
<br />
Again, the default httpd.conf does not contain a PHPIniDir, and locates php.ini via libphp5.so in /etc - you would need to create one here (using one of the php.ini.default templates if you want).<br />
<br />
It's worth changing the PHPIniDir setting in httpd.conf setting to eg.:<br />
<br />
Configuration File&nbsp; &nbsp;&nbsp; /usr/local/php5/lib/php.ini<br />
<br />
so you know exactly which php.ini is being used at all times.<br />
<br />
phpinfo() will then advise you that it's using this file.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105770""></a>
  <div class="note">
   <strong class="user">user at NOSPAM dot example dot com</strong>
   <a href="#105770" class="date">13-Sep-2011 08:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP Constants will work with php_value; for example:<br />
&nbsp;<br />
php_value error_reporting 30711 #bitmask is the same as<br />
php_value error_reporting "E_ALL &amp; ~E_STRICT &amp; ~E_NOTICE" #string of constants</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104657""></a>
  <div class="note">
   <strong class="user">rohitkumar at cftechno dot com</strong>
   <a href="#104657" class="date">29-Jun-2011 09:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Open php.ini from c:/php in your text editor<br />
<br />
If you installed Apache in the default location, the path should<br />
be "C:\Program Files\Apache Software Foundation\Apache2.2\htdocs". If you installed<br />
it elsewhere, find the htdocs folder and type its path:<br />
<br />
doc_root = "C:\Program Files\Apache Software Foundation\Apache2.2\htdocs"<br />
<br />
Just a little further down in the file, look for the line that begins with remove the semicolon from the start of the extension_<br />
dir, and set it so that it points to the ext subfolder of your PHP folder:<br />
extension_dir = "C:\PHP\ext"<br />
<br />
These are optional extensions to PHP, disabled by default. We<br />
want to enable the MySQL extension so that PHP can communicate with MySQL.<br />
To do this, remove the semicolon from the start of the php_mysqli.dll line:<br />
extension=php_mysqli.dll<br />
<br />
note - php_mysqli, not php_mysql<br />
<br />
Keep scrolling even further down in the file, and look for a line that starts with<br />
;session.save_path. Once again, remove the semicolon to enable this line,<br />
and set it to your Windows Temp folder:<br />
session.save_path = "C:\Windows\Temp"<br />
<br />
Browse to the conf subfolder in your Apache<br />
installation folder (by default, C:\Program Files\Apache Software<br />
Foundation\Apache2.2\conf), and select the httpd.conf file located there. In order<br />
to make this file visible for selection, you’ll need to select All Files (*.*) from the<br />
file type drop-down menu at the bottom of the Open window.<br />
Look for the existing line in this file that begins with DirectoryIndex, shown<br />
here:<br />
&lt;IfModule dir_module&gt;<br />
DirectoryIndex index.html<br />
&lt;/IfModule&gt;<br />
<br />
This line tells Apache which filenames to use when it looks for the default page<br />
for a given directory. Add index.php to the end of this line:<br />
&lt;IfModule dir_module&gt;<br />
DirectoryIndex index.html index.php<br />
&lt;/IfModule&gt;<br />
<br />
All of the remaining options in this long and intimidating configuration file<br />
should have been set up correctly by the Apache install program. All you need<br />
to do is add the following lines to the very end of the file:<br />
<br />
LoadModule php5_module "C:/PHP/php5apache2_2.dll"<br />
AddType application/x-httpd-php .php<br />
PHPIniDir "C:/PHP"<br />
<br />
Make sure the LoadModule and PHPIniDir lines point to your PHP installation<br />
directory, and note the use of forward slashes (/) instead of backslashes (\) in<br />
the paths.<br />
<br />
Save your changes and Restart Apache using the Apache Service Monitor system tray icon. If all is<br />
well, Apache will start up again without complaint.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91520""></a>
  <div class="note">
   <strong class="user">self at pabloviquez dot com</strong>
   <a href="#91520" class="date">15-Jun-2009 03:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that, changing the PHP configuration via the windows registry will set the new values using php_admin_value. This makes that you cannot override them on runtime.<br />
<br />
So for example, if you set the include_path on the windows registry and then you call the set_include_path function in your application, it will return false and won't change the include_path.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90679""></a>
  <div class="note">
   <strong class="user">cawoodm at gmail dot com</strong>
   <a href="#90679" class="date">04-May-2009 04:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With IIS it can become confusing that changes to php.ini are ineffective. It seems it is necessary to restart the application pool for the changes to be seen. It would be great if this was not necessary - I am sure I have worked with systems where php.ini changes were immediately effectvie.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89459""></a>
  <div class="note">
   <strong class="user">ravi at syntric dot net</strong>
   <a href="#89459" class="date">09-Mar-2009 07:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a quick note regarding per-directory php settings. A number of flags can be set custom to a particular app's requirement based on one of two methods describe her <a href="http://www.cognitivecombine.com/?p=207" rel="nofollow" target="_blank">http://www.cognitivecombine.com/?p=207</a><br />
<br />
I particularly stumbled upon this to turn off register_globals. Drupal, for e.g., required this to be off but I knew of numerous php apps that had code which relied on these globals. The .htaccess method described in the above URL worked for my case.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88816""></a>
  <div class="note">
   <strong class="user">hyponiq at gmail dot com</strong>
   <a href="#88816" class="date">09-Feb-2009 06:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Running PHP under Apache poses a major problem when it comes to per-directory configuration settings for PHP.&nbsp; In Apache virtual hosting, only a master PHP configuration file (i.e. php.ini) is parsed at run-time per PHP script.&nbsp; Under IIS 6.0 or greater, you can include per-directory PHP configuration files to override or overwrite the master configuration settings.&nbsp; The issue here, however, is having Apache virtual hosts override/overwrite master settings; not what IIS can do.<br />
<br />
So, there are two possible solutions.&nbsp; The first solution is described in this section and uses the Apache configuration settings php_value, php_flag, php_admin_value, and php_admin_flag.&nbsp; In that, each virtual host which you'd like to have certain configuration settings changed must have these directives set (and that is for each PHP configuration setting).&nbsp; This, to me, is the more viable solution, although it is time-consuming and mentally taxing.<br />
<br />
The other possible solution is to set the PHPRC environment variable.&nbsp; To my knowledge, all implementations of Apache HTTPD allow for the SetEnv directive to set the PHPRC variable per-virtual-host.&nbsp; What that does is tell PHP to look in the specified location for that virtual host's configuration settings file (i.e. "C:/path/to/custom/php.ini").&nbsp; The only downside to this tactic is that EVERY virtual host's custom php.ini file must contain all set parameters.&nbsp; In other words, every single PHP configuration directive you have set in the master php.ini file must ALSO be set in per-virtual-host configuration settings.&nbsp; Doesn't that suck?&nbsp; It seems rather redundant to me (and completely defeats the purpose) that you have to include all configuration settings OVER AND OVER AGAIN.<br />
<br />
The great thing about per-directory configuration settings (when they're implemented correctly) is that PHP already has the master settings pre-loaded and the per-directory settings (which may only ammount to one directive in difference) can be loaded per request and, thus, there is less over-head.<br />
<br />
There really is more to this topic than that, which is why I blogged a rather lengthy and detailed article here: <a href="http://hyponiq.blogspot.com/2009/02/apache-php-multiple-phpini.html&nbsp; This information is meant to help users and administrators.&nbsp; I highly suggest it be read if anyone has any questions on Apache and PHP configurations.&nbsp; I have included some examples that illustrate the two possible solutions, as well.&nbsp; I did my best to research everything before I wrote the article." rel="nofollow" target="_blank">http://hyponiq.blogspot.com/2009/02/apache-php-multiple-phpini.html&nbsp; This information is meant to help users and administrators.&nbsp; I highly suggest it be read if anyone has any questions on Apache and PHP configurations.&nbsp; I have included some examples that illustrate the two possible solutions, as well.&nbsp; I did my best to research everything before I wrote the article.</a><br />
<br />
I hope this helps!<br />
<br />
<br />
==== 10-FEB-09: ====<br />
I must add a little more information:<br />
<br />
I've done some thorough testing on my PC as to the PHPRC environment variable set by the Apache directive SetEnv.&nbsp; It seems to me that this variable is completely disregarded using that directive.&nbsp; I tried everything and can only come to the conclusion that either A) I did something very wrong, or B) that it simply doesn't work as expected.<br />
<br />
The former solution, however, does work magically!&nbsp; So, to expand on my previous post, the only real and viable solution to this problem is to use the php_value, php_flag, php_admin_value and php_admin_flag directives in your virtual hosts configurations.<br />
<br />
Once again, it can be very boring!&nbsp; But it does work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80831""></a>
  <div class="note">
   <strong class="user">contrees.du.reve at gmail dot com</strong>
   <a href="#80831" class="date">02-Feb-2008 02:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Being able to put php directives in httpd.conf and have them work on a per-directory or per-vitual host basis is just great. Now there's another aspect which might be worth being aware of:<br />
<br />
A php.ini directive put into your apache conf file applies to php when it runs as an apache module (i.e. in a web page), but NOT when it runs as CLI (command-line interface).<br />
<br />
Such feature that might be unwanted by an unhappy few, but I guess most will find it useful. As far as I'm concerned, I'm really happy that I can use open_basedir in my httpd.conf file, and it restricts the access of web users and sub-admins&nbsp; of my domain, but it does NOT restrict my own command-line php scripts...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76285""></a>
  <div class="note">
   <strong class="user">Woody/mC</strong>
   <a href="#76285" class="date">09-Jul-2007 03:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@ pgl: As the documentation says:<br />
<br />
"To clear a previously set value use none as the value."<br />
<br />
Works fine for me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76035""></a>
  <div class="note">
   <strong class="user">pgl at yoyo dot org</strong>
   <a href="#76035" class="date">27-Jun-2007 12:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is not possible to unset a config option using php_value. This caused me problems with auto_prepend_file settings where I wanted to have a global file auto included, with an exception for only one site. The solution used to be to use auto_prepend_file /dev/null, but this now causes errors, so I just create and include blank.inc now instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="configuration.changes.modes.html">どこで設定を行うのか</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="langref.html">言語リファレンス</a></div>
 <div class="up"><a href="configuration.html">実行時設定</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
