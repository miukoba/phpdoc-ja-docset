<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>SQLite3</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.sqlite-valid.html">sqlite_valid</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="intro.sqlite3.html">導入</a></div>
 <div class="up"><a href="refs.database.vendors.html">ベンダー固有のモジュール</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="book.sqlite3" class="book">
 
 <h1 class="title">SQLite3</h1>
 

 

 








 








 







 







 








<ul class="chunklist chunklist_book"><li><a href="intro.sqlite3.html">導入</a></li><li><a href="sqlite3.setup.html">インストール/設定</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="sqlite3.requirements.html">要件</a></li><li><a href="sqlite3.installation.html">インストール手順</a></li><li><a href="sqlite3.configuration.html">実行時設定</a></li><li><a href="sqlite3.resources.html">リソース型</a></li></ul></li><li><a href="sqlite3.constants.html">定義済み定数</a></li><li><a href="class.sqlite3.html">SQLite3</a> — SQLite3 クラス<ul class="chunklist chunklist_book chunklist_children"><li><a href="sqlite3.busytimeout.html">SQLite3::busyTimeout</a> — 接続がビジー状態のときのハンドラを設定する</li><li><a href="sqlite3.changes.html">SQLite3::changes</a> — 直近の SQL 文で変更 (あるいは挿入、削除) された行の数を返す</li><li><a href="sqlite3.close.html">SQLite3::close</a> — データベースとの接続を閉じる</li><li><a href="sqlite3.construct.html">SQLite3::__construct</a> — SQLite3 オブジェクトを作成し、SQLite 3 データベースをオープンする</li><li><a href="sqlite3.createaggregate.html">SQLite3::createAggregate</a> — SQL の集約関数として使用する PHP 関数を登録する</li><li><a href="sqlite3.createcollation.html">SQLite3::createCollation</a> — Registers a PHP function for use as an SQL collating function</li><li><a href="sqlite3.createfunction.html">SQLite3::createFunction</a> — SQL のスカラー関数として使用する PHP 関数を登録する</li><li><a href="sqlite3.escapestring.html">SQLite3::escapeString</a> — 適切にエスケープされた文字列を返す</li><li><a href="sqlite3.exec.html">SQLite3::exec</a> — 指定したデータベースに、結果を返さないクエリを実行する</li><li><a href="sqlite3.lasterrorcode.html">SQLite3::lastErrorCode</a> — 直近で失敗した SQLite リクエストの結果コードを数値で返す</li><li><a href="sqlite3.lasterrormsg.html">SQLite3::lastErrorMsg</a> — 直近で失敗した SQLite リクエストについての英文テキストの説明を返す</li><li><a href="sqlite3.lastinsertrowid.html">SQLite3::lastInsertRowID</a> — 直近の INSERT 文でデータベースに追加された行の ID を返す</li><li><a href="sqlite3.loadextension.html">SQLite3::loadExtension</a> — SQLite 拡張ライブラリを読み込む</li><li><a href="sqlite3.open.html">SQLite3::open</a> — SQLite データベースをオープンする</li><li><a href="sqlite3.prepare.html">SQLite3::prepare</a> — 実行する SQL 文を準備する</li><li><a href="sqlite3.query.html">SQLite3::query</a> — SQL クエリを実行する</li><li><a href="sqlite3.querysingle.html">SQLite3::querySingle</a> — クエリを実行し、単一の結果を返す</li><li><a href="sqlite3.version.html">SQLite3::version</a> — SQLite3 ライブラリのバージョンを、文字列定数と数値で返す</li></ul></li><li><a href="class.sqlite3stmt.html">SQLite3Stmt</a> — SQLite3Stmt クラス<ul class="chunklist chunklist_book chunklist_children"><li><a href="sqlite3stmt.bindparam.html">SQLite3Stmt::bindParam</a> — パラメータを変数にバインドする</li><li><a href="sqlite3stmt.bindvalue.html">SQLite3Stmt::bindValue</a> — パラメータの値を変数にバインドする</li><li><a href="sqlite3stmt.clear.html">SQLite3Stmt::clear</a> — 現在バインドされているすべてのパラメータをクリアする</li><li><a href="sqlite3stmt.close.html">SQLite3Stmt::close</a> — プリペアドステートメントを閉じる</li><li><a href="sqlite3stmt.execute.html">SQLite3Stmt::execute</a> — プリペアドステートメントを実行し、結果セットオブジェクトを返す</li><li><a href="sqlite3stmt.paramcount.html">SQLite3Stmt::paramCount</a> — プリペアドステートメント内のパラメータの数を返す</li><li><a href="sqlite3stmt.reset.html">SQLite3Stmt::reset</a> — プリペアドステートメントをリセットする</li></ul></li><li><a href="class.sqlite3result.html">SQLite3Result</a> — SQLite3Result クラス<ul class="chunklist chunklist_book chunklist_children"><li><a href="sqlite3result.columnname.html">SQLite3Result::columnName</a> — n 番目のカラムの名前を返す</li><li><a href="sqlite3result.columntype.html">SQLite3Result::columnType</a> — n 番目のカラムの型を返す</li><li><a href="sqlite3result.fetcharray.html">SQLite3Result::fetchArray</a> — 結果の行を、連想配列あるいは数値添字配列あるいはその両方で取得する</li><li><a href="sqlite3result.finalize.html">SQLite3Result::finalize</a> — 結果セットを閉じる</li><li><a href="sqlite3result.numcolumns.html">SQLite3Result::numColumns</a> — 結果セットのカラム数を返す</li><li><a href="sqlite3result.reset.html">SQLite3Result::reset</a> — 結果セットを最初の行に戻す</li></ul></li></ul></div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113144""></a>
  <div class="note">
   <strong class="user">bohwaz</strong>
   <a href="#113144" class="date">05-Sep-2013 01:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As reported here: https://bugs.php.net/bug.php?id=65216 there are two undocumented and useful methods available:<br />
<br />
SQLite3::createCollation(collation name, callback function) appeared in PHP 5.3.11 and allows to define a custom collation method.<br />
<br />
SQLite3Stmt::readOnly(void) appeared in PHP 5.3.5 and returns true if a statement doesn't write in the database.<br />
<br />
See the documentation pages on the corresponding classes for my comments showing example use of those methods.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106779""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#106779" class="date">06-Dec-2011 09:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of PHP 5.4 support for Sqlite2 has been removed. I have a large web app that was built with sqlite2 as the database backend and thus it exploded when I updated PHP. If you're in a similar situation I've written a few wrapper functions that will allow your app to work whilst you convert the code to sqlite3. <br />
<br />
Firstly convert your DB to an sqlite3 db. <br />
<br />
sqlite OLD.DB .dump | sqlite3 NEW.DB<br />
<br />
Then add the following functions to your app:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">sqlite_open</span><span class="keyword">(</span><span class="default">$location</span><span class="keyword">,</span><span class="default">$mode</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= new </span><span class="default">SQLite3</span><span class="keyword">(</span><span class="default">$location</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$handle</span><span class="keyword">;<br />
}<br />
function </span><span class="default">sqlite_query</span><span class="keyword">(</span><span class="default">$dbhandle</span><span class="keyword">,</span><span class="default">$query</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="string">'dbhandle'</span><span class="keyword">] = </span><span class="default">$dbhandle</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] = </span><span class="default">$query</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$dbhandle</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
function </span><span class="default">sqlite_fetch_array</span><span class="keyword">(&amp;</span><span class="default">$result</span><span class="keyword">,</span><span class="default">$type</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">#Get Columns<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">columnName</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$columns</span><span class="keyword">[ ] = </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">columnName</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$resx </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">fetchArray</span><span class="keyword">(</span><span class="default">SQLITE3_ASSOC</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$resx</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
They're not perfect by any stretch but they seem to be working ok as a temporary measure while I convert the site. <br />
Hope that helps someone</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99290""></a>
  <div class="note">
   <strong class="user">alan at chandlerfamily dot org dot uk</strong>
   <a href="#99290" class="date">09-Aug-2010 10:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP 5.3.3 introduced sqlite3::busyTimeout(int milliseconds) which does not currently seem to be documented.<br />
<br />
It believe it acts like sqlite::busyTimeout - that is it tells sqlite3 to call an internal busyHandler if SQLITE_BUSY is returned from any call which waits a short period and then retries.&nbsp; It continues to do this until milliseconds milliseconds have elapsed and then returns the SQLITE_BUSY status.<br />
<br />
I don't know whether the default 60 second value is in place if this function is not called.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.sqlite-valid.html">sqlite_valid</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="intro.sqlite3.html">導入</a></div>
 <div class="up"><a href="refs.database.vendors.html">ベンダー固有のモジュール</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
