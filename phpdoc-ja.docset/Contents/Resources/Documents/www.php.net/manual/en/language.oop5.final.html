<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>finalキーワード</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="language.oop5.magic.html">マジックメソッド</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="language.oop5.cloning.html">オブジェクトのクローン作成</a></div>
 <div class="up"><a href="language.oop5.html">クラスとオブジェクト</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="language.oop5.final" class="sect1">
 <h2 class="title">finalキーワード</h2>
 <p class="para">
  PHP 5 ではキーワード <em class="emphasis">final</em> が導入され、
  <em class="emphasis">final</em> を前に付けて定義されたメソッドは子クラスから上書きできません。
  クラス自体がfinalと定義された場合には、このクラスを拡張することはできません。
 </p>
  <p class="para">
   <div class="example" id="example-221">
    <p><strong>例1 finalメソッドの例</strong></p>
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">BaseClass&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">test</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"BaseClass::test()&nbsp;called\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;final&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">moreTesting</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"BaseClass::moreTesting()&nbsp;called\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;}<br />}<br /><br />class&nbsp;</span><span style="color: #0000BB">ChildClass&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">BaseClass&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">moreTesting</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"ChildClass::moreTesting()&nbsp;called\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;}<br />}<br /></span><span style="color: #FF8000">//&nbsp;Results&nbsp;in&nbsp;Fatal&nbsp;error:&nbsp;Cannot&nbsp;override&nbsp;final&nbsp;method&nbsp;BaseClass::moreTesting()<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
  </div>

 </div>
  </p>
  <p class="para">
   <div class="example" id="example-222">
    <p><strong>例2 finalクラスの例</strong></p>
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">final&nbsp;class&nbsp;</span><span style="color: #0000BB">BaseClass&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">test</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"BaseClass::test()&nbsp;called\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Here&nbsp;it&nbsp;doesn't&nbsp;matter&nbsp;if&nbsp;you&nbsp;specify&nbsp;the&nbsp;function&nbsp;as&nbsp;final&nbsp;or&nbsp;not<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">final&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">moreTesting</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"BaseClass::moreTesting()&nbsp;called\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;}<br />}<br /><br />class&nbsp;</span><span style="color: #0000BB">ChildClass&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">BaseClass&nbsp;</span><span style="color: #007700">{<br />}<br /></span><span style="color: #FF8000">//&nbsp;Results&nbsp;in&nbsp;Fatal&nbsp;error:&nbsp;Class&nbsp;ChildClass&nbsp;may&nbsp;not&nbsp;inherit&nbsp;from&nbsp;final&nbsp;class&nbsp;(BaseClass)<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <span class="simpara">
    プロパティを final として宣言することはできません。
    final として宣言できるのはクラスとメソッドのみです。
   </span>
  </p></blockquote>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113843""></a>
  <div class="note">
   <strong class="user">thomas at somewhere dot com</strong>
   <a href="#113843" class="date">08-Dec-2013 07:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please, please, please never use this keyword anywhere in your code. By using it you are saying that you somehow magically know that your class or method is perfect and will suit every possible use of the class API you're defining and that no one will ever need to do so much as add some data checking before calling parent:: on the method. <br />
<br />
This is never true and will never be true, so let the poor programmer that needs to extend your code do so.<br />
<br />
If you want to have "final" in your code then you don't understand OOP.<br />
<br />
Hopefully this will be removed in some future version of the language.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100149""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#100149" class="date">28-Sep-2010 04:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The behaviour of FINAL is not as serious as you may think. A little explample:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; final private function </span><span class="default">method</span><span class="keyword">(){}&nbsp; &nbsp;&nbsp; <br />
}<br />
<br />
class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">method</span><span class="keyword">(){}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Normally you would expect some of the following will happen:<br />
- An error that final and private keyword cannot be used together<br />
- No error as the private visibility says, that a method/var/etc. is only visible within the same class<br />
<br />
But what happens is PHP is a little curios: "Cannot override final method A::method()"<br />
<br />
So its possible to deny method names in subclasses! Don't know if this is&nbsp; a good behavior, but maybe its useful for your purpose.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99705""></a>
  <div class="note">
   <strong class="user">Baldurien</strong>
   <a href="#99705" class="date">31-Aug-2010 10:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"Note for Java developers: the 'final' keyword is not used for class constants in PHP. We use the keyword 'const'."<br />
<br />
<a href="http://php.net/manual/en/language.oop5.constants.php" rel="nofollow" target="_blank">http://php.net/manual/en/language.oop5.constants.php</a><br />
<br />
This is more or less true, regardless of the fact that constant (being defined at class level or not) in PHP are only scalar (int, string, etc) while in Java they may be pure object (ex: java.awat.Color.BLACK). The only possible solution of having such kind of constant is :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Bar </span><span class="keyword">{...}<br />
class </span><span class="default">Foo </span><span class="keyword">{<br />
&nbsp; public static </span><span class="default">$FOOBAR</span><span class="keyword">;<br />
<br />
&nbsp; static function </span><span class="default">__init</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$init </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$init</span><span class="keyword">) throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Constants were already initialized'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$FOOBAR </span><span class="keyword">= new </span><span class="default">Bar</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$init </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
</span><span class="default">Foo</span><span class="keyword">::</span><span class="default">__init</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span>That said, perhaps it is useless unless PHP automatically calls the __init() method.<br />
<br />
However, one alternative that could be done in certain case is this : <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">__autoload</span><span class="keyword">(</span><span class="default">$className</span><span class="keyword">) { <br />
&nbsp; ... require </span><span class="default">the file where the </span><span class="keyword">class </span><span class="default">is </span><span class="keyword">...<br />
&nbsp; if (</span><span class="default">interface_exists</span><span class="keyword">(</span><span class="default">$className</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">)) return;<br />
&nbsp; if (</span><span class="default">class_exists</span><span class="keyword">(</span><span class="default">$className</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rc </span><span class="keyword">= new </span><span class="default">ReflectionClass</span><span class="keyword">(</span><span class="default">$className</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$rc</span><span class="keyword">-&gt;</span><span class="default">hasMethod</span><span class="keyword">(</span><span class="string">'__init'</span><span class="keyword">)) return;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$m </span><span class="keyword">= </span><span class="default">$rc</span><span class="keyword">-&gt;</span><span class="default">getMethod</span><span class="keyword">(</span><span class="string">'__init'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (!(</span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">isStatic</span><span class="keyword">() &amp;&amp; </span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">isPrivate</span><span class="keyword">())) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="default">$className </span><span class="keyword">. </span><span class="string">' __init() method must be private and static !'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">invoke</span><span class="keyword">(</span><span class="default">null</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return;<br />
&nbsp; }<br />
&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Class or interface not found ' </span><span class="keyword">. </span><span class="default">$className</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This can only work when one class is defined per file, since we are assured that __autoload() will be called to load the file containing the class.<br />
<br />
eg: <br />
<br />
test2.php:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">B </span><span class="keyword">{<br />
&nbsp;public static </span><span class="default">$X</span><span class="keyword">;<br />
&nbsp;private static function </span><span class="default">__init</span><span class="keyword">() {<br />
&nbsp;&nbsp; echo </span><span class="string">'B'</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">; <br />
&nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$X </span><span class="keyword">= array(</span><span class="default">1</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;}<br />
}<br />
class </span><span class="default">A </span><span class="keyword">{<br />
&nbsp; public static </span><span class="default">$Y</span><span class="keyword">;<br />
&nbsp; private static function </span><span class="default">__init</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'A'</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$Y </span><span class="keyword">= array(</span><span class="default">3</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span>test.php:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">__autoload</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">) {<br />
&nbsp; if (</span><span class="default">$n </span><span class="keyword">== </span><span class="string">'A' </span><span class="keyword">|| </span><span class="default">$n </span><span class="keyword">== </span><span class="string">'B'</span><span class="keyword">) require </span><span class="string">'test2.php'</span><span class="keyword">;<br />
&nbsp; ... do </span><span class="default">our __init</span><span class="keyword">() </span><span class="default">trick </span><span class="keyword">...<br />
}<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">B</span><span class="keyword">::</span><span class="default">$X</span><span class="keyword">); </span><span class="comment">// shows B, then array(2) (1, 2)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">A</span><span class="keyword">::</span><span class="default">$Y</span><span class="keyword">); </span><span class="comment">// shows NULL.<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92295""></a>
  <div class="note">
   <strong class="user">jriddy at gmail dot com</strong>
   <a href="#92295" class="date">17-Jul-2009 11:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note for Java developers: the 'final' keyword is not used for class constants in PHP. We use the keyword 'const'.<br />
<br />
<a href="http://php.net/manual/en/language.oop5.constants.php" rel="nofollow" target="_blank">http://php.net/manual/en/language.oop5.constants.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87444""></a>
  <div class="note">
   <strong class="user">santoshjoshi2003 at yahoo dot co dot in</strong>
   <a href="#87444" class="date">05-Dec-2008 11:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The use of final keyword is just like that occurs in Java<br />
In java final has three uses<br />
&nbsp;&nbsp;&nbsp; 1) prevent class Inheritance<br />
&nbsp;&nbsp;&nbsp; 2) prevent method overriding or redifination of <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; method in subclass <br />
&nbsp;&nbsp;&nbsp; 3) and to declare constants <br />
&nbsp;But the third point seems to be missing from the PHP<br />
&nbsp;I guess, as i am a java developer Currently gaining competence in PHP</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78862""></a>
  <div class="note">
   <strong class="user">slorenzo at clug dot org dot ve</strong>
   <a href="#78862" class="date">31-Oct-2007 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">parentClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">someMethod</span><span class="keyword">() { }<br />
}<br />
class </span><span class="default">childClass </span><span class="keyword">extends </span><span class="default">parentClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public final function </span><span class="default">someMethod</span><span class="keyword">() { } </span><span class="comment">//override parent function<br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">$class </span><span class="keyword">= new </span><span class="default">childClass</span><span class="keyword">;<br />
</span><span class="default">$class</span><span class="keyword">-&gt;</span><span class="default">someMethod</span><span class="keyword">(); </span><span class="comment">//call the override function in chield class<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74058""></a>
  <div class="note">
   <strong class="user">penartur at yandex dot ru</strong>
   <a href="#74058" class="date">22-Mar-2007 10:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that you cannot ovverride final methods even if they are defined as private in parent class.<br />
Thus, the following example:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">parentClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; final private function </span><span class="default">someMethod</span><span class="keyword">() { }<br />
}<br />
class </span><span class="default">childClass </span><span class="keyword">extends </span><span class="default">parentClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">someMethod</span><span class="keyword">() { }<br />
}<br />
</span><span class="default">?&gt;<br />
</span>dies with error "Fatal error: Cannot override final method parentClass::someMethod() in ***.php on line 7"<br />
<br />
Such behaviour looks slight unexpected because in child class we cannot know, which private methods exists in a parent class and vice versa.<br />
<br />
So, remember that if you defined a private final method, you cannot place method with the same name in child class.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="language.oop5.magic.html">マジックメソッド</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="language.oop5.cloning.html">オブジェクトのクローン作成</a></div>
 <div class="up"><a href="language.oop5.html">クラスとオブジェクト</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
