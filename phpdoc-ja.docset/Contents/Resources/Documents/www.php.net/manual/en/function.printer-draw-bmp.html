<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>ビットマップを描画する</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.printer-delete-pen.html">printer_delete_pen</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.printer-draw-chord.html">printer_draw_chord</a></div>
 <div class="up"><a href="ref.printer.html">プリンタ 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.printer-draw-bmp" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">printer_draw_bmp</h1>
  <p class="verinfo">(PECL printer SVN)</p><p class="refpurpose"><span class="refname">printer_draw_bmp</span> &mdash; <span class="dc-title">ビットマップを描画する</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.printer-draw-bmp-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>printer_draw_bmp</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$printer_handle</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$x</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$y</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$width</code></span>
   ], <span class="methodparam"><span class="type">int</span> <code class="parameter">$height</code></span>
   )</div>

  <p class="para rdfs-comment">
   この関数はビットマップを描画します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.printer-draw-bmp-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><em><code class="parameter">printer_handle</code></em></span>
     <dd>

      <p class="para">
       <em><code class="parameter">printer_handle</code></em>
       には、プリンタへの有効なハンドルを指定する必要があります。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">filename</code></em></span>
     <dd>

      <p class="para">
       ビットマップへのパス。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">x</code></em></span>
     <dd>

      <p class="para">
       <em><code class="parameter">x</code></em> はビットマップの左上の x 座標です。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">y</code></em></span>
     <dd>

      <p class="para">
       <em><code class="parameter">y</code></em> はビットマップの左上の y 座標です。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">width</code></em></span>
     <dd>

      <p class="para">
       ビットマップの幅。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">height</code></em></span>
     <dd>

      <p class="para">
       ビットマップの高さ。
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.printer-draw-bmp-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
  成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.printer-draw-bmp-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-5324">
    <p><strong>例1  <span class="function"><strong>printer_draw_bmp()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$handle&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">printer_open</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">printer_start_doc</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"My&nbsp;Document"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printer_start_page</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">printer_draw_bmp</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"c:\\image.bmp"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">printer_end_page</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printer_end_doc</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printer_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="73404""></a>
  <div class="note">
   <strong class="user">codeslinger at compsalot dot com</strong>
   <a href="#73404" class="date">21-Feb-2007 08:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't get confused by the example.&nbsp; The X Y offset is Base 0&nbsp; not 1.&nbsp; The example was trying to show that you could position the image elsewhere.<br />
<br />
Also, the X Y offsets accept a negative value which can be very handy if you want to print just part of the image.&nbsp; Such as when splitting an image across multiple pages.<br />
<br />
Most (all?) printers will shift your output by the amount of the "unprintable" area.<br />
<br />
Suppose you want to print an image at exactly X = 0.25, Y = 0.25 inches (from the top left).<br />
<br />
On a typical printer with an unprintable area of 0.116 inches, the printer adds that amount as an offset.&nbsp; So, to compensate you just subtract the offset.&nbsp; <br />
<br />
$X = 0.25 - 0.116;<br />
$Y = 0.25 - 0.116;<br />
<br />
With the result being that your image will be physically located where you intended.<br />
<br />
Keep in mind that the unprintable area can be a different amount for the X and Y, for this example printer they both just happen to be the same.<br />
<br />
Now the catch is that printer_get_option does not provide a way to get the unprintable area size.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61343""></a>
  <div class="note">
   <strong class="user">Fuzzmaster</strong>
   <a href="#61343" class="date">01-Feb-2006 12:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Added a bit a fuzz:<br />
<br />
&nbsp; function print_img($doc,$img,$res,$pos_x,$pos_y)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; $img_size = getimagesize($img);<br />
&nbsp;&nbsp; &nbsp; $img_resolution = $res;<br />
<br />
&nbsp;&nbsp; &nbsp; $img_width = $img_size[0];<br />
&nbsp;&nbsp; &nbsp; $img_height = $img_size[1];<br />
<br />
&nbsp;&nbsp; &nbsp; echo $img_width.'&lt;BR&gt;';<br />
&nbsp;&nbsp; &nbsp; echo $img_height.'&lt;BR&gt;';<br />
<br />
&nbsp;&nbsp; &nbsp; $ptr_resolution_x = printer_get_option($doc, PRINTER_RESOLUTION_X);<br />
&nbsp;&nbsp; &nbsp; $ptr_resolution_y = printer_get_option($doc, PRINTER_RESOLUTION_Y);<br />
<br />
&nbsp;&nbsp; &nbsp; echo $ptr_resolution_x.'&lt;BR&gt;';<br />
&nbsp;&nbsp; &nbsp; echo $ptr_resolution_y.'&lt;BR&gt;';<br />
<br />
&nbsp;&nbsp; &nbsp; $img_scale_x = $ptr_resolution_x / $img_resolution;<br />
&nbsp;&nbsp; &nbsp; $img_scale_y = $ptr_resolution_y / $img_resolution;<br />
<br />
&nbsp;&nbsp; &nbsp; echo $img_scale_x.'&lt;BR&gt;';<br />
&nbsp;&nbsp; &nbsp; echo $img_scale_y.'&lt;BR&gt;';<br />
<br />
&nbsp;&nbsp; &nbsp; $ptr_width = $img_width * $img_scale_x;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; $ptr_height = $img_height * $img_scale_y;<br />
<br />
&nbsp;&nbsp; &nbsp; echo $doc.'&lt;BR&gt;';<br />
&nbsp;&nbsp; &nbsp; echo $ptr_width.'&lt;BR&gt;';<br />
&nbsp;&nbsp; &nbsp; echo $ptr_height.'&lt;BR&gt;';<br />
&nbsp; <br />
&nbsp;&nbsp; &nbsp; printer_draw_bmp($doc,$img,$pos_x,$pos_y,$ptr_width,$ptr_height);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
print_img($handle, '../img/someimage.bmp', 72, 10, 10);<br />
<br />
Of course, if someone can figure out how to capture the resolution of the image from the file that's one less value to manually assign.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60728""></a>
  <div class="note">
   <strong class="user">ramiro_puc[AT]hotmail[DOT]com</strong>
   <a href="#60728" class="date">15-Jan-2006 11:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When trying to print any image file it was getting a very, very small as someone said above. To solve this problem, ive made a script that will calculate the correct size of image before output it to printer.<br />
<br />
Most of InkJet printers use 300 dpi. You can change values if you have any other printer... In this case, im using a HP DeskJet 930c.<br />
<br />
To make this script better, you can use GD to discover image resolution automatically.<br />
<br />
<span class="default">&lt;?php<br />
$handle </span><span class="keyword">= </span><span class="default">printer_open</span><span class="keyword">();<br />
</span><span class="default">printer_start_doc</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="string">"My Document"</span><span class="keyword">);<br />
</span><span class="default">printer_start_page</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
<br />
</span><span class="default">$largura </span><span class="keyword">= </span><span class="default">415</span><span class="keyword">; </span><span class="comment">//Image Width in Pixels<br />
</span><span class="default">$altura </span><span class="keyword">= </span><span class="default">284</span><span class="keyword">;&nbsp; </span><span class="comment">//Image Height in Pixels<br />
<br />
</span><span class="default">$fator_x </span><span class="keyword">= </span><span class="default">$largura </span><span class="keyword">/ </span><span class="default">72</span><span class="keyword">; </span><span class="comment">//Image Resolution (72 ppi)<br />
</span><span class="default">$fator_y </span><span class="keyword">= </span><span class="default">$largura </span><span class="keyword">/ </span><span class="default">300</span><span class="keyword">; </span><span class="comment">//Printer Resolution (300 dpi)<br />
</span><span class="default">$fator_z </span><span class="keyword">= </span><span class="default">$fator_x </span><span class="keyword">/ </span><span class="default">$fator_y</span><span class="keyword">;<br />
<br />
</span><span class="default">$largura_f </span><span class="keyword">= </span><span class="default">$largura </span><span class="keyword">* </span><span class="default">$fator_z</span><span class="keyword">;<br />
</span><span class="default">$altura_f </span><span class="keyword">= </span><span class="default">$altura </span><span class="keyword">* </span><span class="default">$fator_z</span><span class="keyword">;<br />
<br />
</span><span class="default">printer_set_option</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">PRINTER_MODE</span><span class="keyword">, </span><span class="string">"RAW"</span><span class="keyword">);<br />
</span><span class="default">printer_draw_bmp</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="string">"c:\image.bmp"</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">$largura_f</span><span class="keyword">, </span><span class="default">$altura_f</span><span class="keyword">);<br />
<br />
</span><span class="default">printer_end_page</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
</span><span class="default">printer_end_doc</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
</span><span class="default">printer_close</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51029""></a>
  <div class="note">
   <strong class="user">da_vinci7[at]hotmail[dot]com</strong>
   <a href="#51029" class="date">17-Mar-2005 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
what i notice was that <br />
[qoute]<br />
void printer_draw_bmp ( resource handle, string filename, int x, int y)<br />
[/qoute]<br />
is only that here only the starting x and y are shown<br />
and that if you have an bmp with the size 600 x 120 wil be shown as 600x120 pixels and printed very very smale<br />
<br />
and when i tried giving ending x and y like this:<br />
&lt;?<br />
&nbsp; printer_draw_bmp($handle, $file, 1, 1, 4600, 860)<br />
?&gt;<br />
<br />
it printed the image in the correct size</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47999""></a>
  <div class="note">
   <strong class="user">lapoA at TseanetD dot O dot Tcom</strong>
   <a href="#47999" class="date">08-Dec-2004 07:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
something I found out the hard way...<br />
in order for the example above to work, the file being printed must be in a directory that has been opened for reading.<br />
The example in the docs should probably have been listed as:<br />
(There should probably be a check for the filename, but this should give an idea)<br />
<br />
<span class="default">&lt;?php<br />
$dir </span><span class="keyword">= </span><span class="string">'c:\\somedir'</span><span class="keyword">;<br />
</span><span class="default">$file </span><span class="keyword">= </span><span class="string">'myimage.bmp'</span><span class="keyword">;<br />
<br />
if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; if(</span><span class="default">$dhandle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">printer_open</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">printer_start_doc</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="string">"My Document"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">printer_start_page</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">printer_draw_bmp</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">printer_end_page</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">printer_end_doc</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">printer_close</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dhandle</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.printer-delete-pen.html">printer_delete_pen</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.printer-draw-chord.html">printer_draw_chord</a></div>
 <div class="up"><a href="ref.printer.html">プリンタ 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
