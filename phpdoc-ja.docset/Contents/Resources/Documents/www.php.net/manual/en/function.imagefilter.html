<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>画像にフィルタを適用する</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.imagefilltoborder.html">imagefilltoborder</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.imageflip.html">imageflip</a></div>
 <div class="up"><a href="ref.image.html">GD および Image 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.imagefilter" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imagefilter</h1>
  <p class="verinfo">(PHP 5)</p><p class="refpurpose"><span class="refname">imagefilter</span> &mdash; <span class="dc-title">画像にフィルタを適用する</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imagefilter-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>imagefilter</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$image</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$filtertype</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$arg1</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$arg2</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$arg3</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$arg4</code></span>
  ]]]] )</div>

  <p class="para rdfs-comment">
    <span class="function"><strong>imagefilter()</strong></span> は、指定したフィルタ
   <em><code class="parameter">filtertype</code></em> を <em><code class="parameter">image</code></em>
   に適用します。
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imagefilter-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>
<span class="term"><em><code class="parameter">
image</code></em></span><dd>
<p class="para"> <span class="function"><a href="function.imagecreatetruecolor.html" class="function">imagecreatetruecolor()</a></span>
のような画像作成関数が返す画像リソース。</p></dd>
</dt>

    <dt>

     <span class="term"><em><code class="parameter">filtertype</code></em></span>
     <dd>

      <p class="para">
       <em><code class="parameter">filtertype</code></em> は、以下のいずれかです。
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_NEGATE</code></strong>: 画像の色を反転させます。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_GRAYSCALE</code></strong>: 画像をグレースケールに変換します。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_BRIGHTNESS</code></strong>: 画像の輝度を変更します。
          輝度レベルを <em><code class="parameter">arg1</code></em> で設定します。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_CONTRAST</code></strong>: 画像のコントラストを
          変更します。コントラストのレベルを <em><code class="parameter">arg1</code></em>
          で設定します。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_COLORIZE</code></strong>:
          <strong><code>IMG_FILTER_GRAYSCALE</code></strong> と似ていますが、
          色を指定することが可能です。
          <em><code class="parameter">arg1</code></em>、<em><code class="parameter">arg2</code></em> および
          <em><code class="parameter">arg3</code></em> を使用して
          <em><code class="parameter">red</code></em>、<em><code class="parameter">green</code></em>、
          <em><code class="parameter">blue</code></em> の値を指定します。また
          <em><code class="parameter">arg4</code></em> を使用して
          <em><code class="parameter">alpha</code></em> チャネルの値を指定します。
          各値の範囲は 0 から 255 までです。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_EDGEDETECT</code></strong>: エッジを検出し、
          画像のエッジを強調します。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_EMBOSS</code></strong>: 画像にエンボス処理を行います。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_GAUSSIAN_BLUR</code></strong>: ガウス分布を
          使用して画像をぼかします。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_SELECTIVE_BLUR</code></strong>: 画像をぼかします。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_MEAN_REMOVAL</code></strong>: 平均を除去し、
          「スケッチ風の」効果を得ます。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_SMOOTH</code></strong>: 画像を滑らかにします。
          滑らかさのレベルを <em><code class="parameter">arg1</code></em> で指定します。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_PIXELATE</code></strong>: モザイク効果を画像に適用します。
          <em><code class="parameter">arg1</code></em> でブロックの大きさを、
          そして <em><code class="parameter">arg2</code></em> でモザイク効果のモードを指定します。
         </span>
        </li>
       </ul>
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">arg1</code></em></span>
     <dd>

      <p class="para">
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_BRIGHTNESS</code></strong>: 輝度レベル。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_CONTRAST</code></strong>: コントラストレベル。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_COLORIZE</code></strong>: 赤コンポーネントの値。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_SMOOTH</code></strong>: 平滑度レベル。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_PIXELATE</code></strong>: ピクセル単位のブロックサイズ。
         </span>
        </li>
       </ul>
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">arg2</code></em></span>
     <dd>

      <p class="para">
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_COLORIZE</code></strong>: 緑コンポーネントの値。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_PIXELATE</code></strong>: 高度なモザイク効果を使用するか否か
          (デフォルトは <strong><code>FALSE</code></strong>)。
         </span>
        </li>
       </ul>
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">arg3</code></em></span>
     <dd>

      <p class="para">
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_COLORIZE</code></strong>: 青コンポーネントの値。
         </span>
        </li>
       </ul>
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">arg4</code></em></span>
     <dd>

      <p class="para">
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_COLORIZE</code></strong>: アルファチャネル。
          0 から 127 までの値で、0 は完全な不透明、127
          は完全な透明を表す。
         </span>
        </li>
       </ul>
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imagefilter-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>

 <div class="refsect1 changelog" id="refsect1-function.imagefilter-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.2.5</td>
       <td>
        <strong><code>IMG_FILTER_COLORIZE</code></strong>
        でアルファチャネルをサポートするようになりました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.imagefilter-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-3222">
    <p><strong>例1  <span class="function"><strong>imagefilter()</strong></span> グレースケールの例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'dave.png'</span><span style="color: #007700">);<br /><br />if(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_GRAYSCALE</span><span style="color: #007700">))<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;converted&nbsp;to&nbsp;grayscale.'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'dave.png'</span><span style="color: #007700">);<br />}<br />else<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Conversion&nbsp;to&nbsp;grayscale&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3223">
    <p><strong>例2  <span class="function"><strong>imagefilter()</strong></span> 輝度の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'sean.png'</span><span style="color: #007700">);<br /><br />if(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_BRIGHTNESS</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">))<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;brightness&nbsp;changed.'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sean.png'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br />}<br />else<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;brightness&nbsp;change&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3224">
    <p><strong>例3  <span class="function"><strong>imagefilter()</strong></span> 単色化の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'philip.png'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;R,&nbsp;G,&nbsp;B,&nbsp;so&nbsp;0,&nbsp;255,&nbsp;0&nbsp;is&nbsp;green&nbsp;*/<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_COLORIZE</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">))<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;successfully&nbsp;shaded&nbsp;green.'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'philip.png'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br />}<br />else<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Green&nbsp;shading&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3225">
    <p><strong>例4  <span class="function"><strong>imagefilter()</strong></span> での打ち消しの例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Define&nbsp;our&nbsp;negate&nbsp;function&nbsp;so&nbsp;its&nbsp;portable&nbsp;for&nbsp;<br />//&nbsp;php&nbsp;versions&nbsp;without&nbsp;imagefilter()<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">negate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'imagefilter'</span><span style="color: #007700">))<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_NEGATE</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">imagesx</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);&nbsp;++</span><span style="color: #0000BB">$x</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">imagesy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);&nbsp;++</span><span style="color: #0000BB">$y</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$index&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorat</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$y</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$rgb&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorsforindex</span><span style="color: #007700">(</span><span style="color: #0000BB">$index</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$color&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255&nbsp;</span><span style="color: #007700">-&nbsp;</span><span style="color: #0000BB">$rgb</span><span style="color: #007700">[</span><span style="color: #DD0000">'red'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">255&nbsp;</span><span style="color: #007700">-&nbsp;</span><span style="color: #0000BB">$rgb</span><span style="color: #007700">[</span><span style="color: #DD0000">'green'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">255&nbsp;</span><span style="color: #007700">-&nbsp;</span><span style="color: #0000BB">$rgb</span><span style="color: #007700">[</span><span style="color: #DD0000">'blue'</span><span style="color: #007700">]);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagesetpixel</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$y</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$color</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;return(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefromjpeg</span><span style="color: #007700">(</span><span style="color: #DD0000">'kalle.jpg'</span><span style="color: #007700">);<br /><br />if(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">negate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">))<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;successfully&nbsp;converted&nbsp;to&nbsp;negative&nbsp;colors.'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagejpeg</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'kalle.jpg'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br />}<br />else<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Converting&nbsp;to&nbsp;negative&nbsp;colors&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3226">
    <p><strong>例5  <span class="function"><strong>imagefilter()</strong></span> でのモザイク処理の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Load&nbsp;the&nbsp;PHP&nbsp;logo,&nbsp;we&nbsp;need&nbsp;to&nbsp;create&nbsp;two&nbsp;instances&nbsp;<br />//&nbsp;to&nbsp;show&nbsp;the&nbsp;differences<br /></span><span style="color: #0000BB">$logo1&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'./php.png'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$logo2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'./php.png'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Create&nbsp;the&nbsp;image&nbsp;instance&nbsp;we&nbsp;want&nbsp;to&nbsp;show&nbsp;the&nbsp;<br />//&nbsp;differences&nbsp;on<br /></span><span style="color: #0000BB">$output&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatetruecolor</span><span style="color: #007700">(</span><span style="color: #0000BB">imagesx</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">)&nbsp;*&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesy</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">//&nbsp;Apply&nbsp;pixelation&nbsp;to&nbsp;each&nbsp;instance,&nbsp;with&nbsp;a&nbsp;block&nbsp;<br />//&nbsp;size&nbsp;of&nbsp;3<br /></span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_PIXELATE</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_PIXELATE</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Merge&nbsp;the&nbsp;differences&nbsp;onto&nbsp;the&nbsp;output&nbsp;image<br /></span><span style="color: #0000BB">imagecopy</span><span style="color: #007700">(</span><span style="color: #0000BB">$output</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesx</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesy</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagecopy</span><span style="color: #007700">(</span><span style="color: #0000BB">$output</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesx</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesx</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesy</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Output&nbsp;the&nbsp;differences<br /></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-Type:&nbsp;image/png'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$output</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$output</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は、
たとえば以下のようになります。</p></div>
    <div class="mediaobject">
     
     <div class="imageobject">
      <img src="images/21009b70229598c6a80eef8b45bf282b-imagefilterpixelate.png" alt="出力例 : imagefilter() でのモザイク処理" width="190" height="51" />
     </div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 notes" id="refsect1-function.imagefilter-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara">この関数は、PHP がバンドル版の GD ライブラリで
コンパイルされている場合のみ使用可能です。</span></p></blockquote>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.imagefilter-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"> <span class="function"><a href="function.imageconvolution.html" class="function" rel="rdfs-seeAlso">imageconvolution()</a> - div および offset の係数を使用し、3x3 の畳み込み配列を適用する</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113049""></a>
  <div class="note">
   <strong class="user">yoann at yoone dot eu</strong>
   <a href="#113049" class="date">22-Aug-2013 11:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an alternative to IMG_FILTER_COLORIZE filter, but taking the alpha parameter of each pixel in account.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">rgba_colorize</span><span class="keyword">(&amp;</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagesavealpha</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$img_x </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$img_y </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$img_x</span><span class="keyword">; ++</span><span class="default">$x</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">$img_y</span><span class="keyword">; ++</span><span class="default">$y</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgba </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color_alpha </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">], </span><span class="default">$rgba</span><span class="keyword">[</span><span class="string">'alpha'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$color_alpha</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecolordeallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$color_alpha</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110793""></a>
  <div class="note">
   <strong class="user">Padde</strong>
   <a href="#110793" class="date">09-Dec-2012 04:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I played with IMG_FILTER_SMOOTH and tried some negative<br />
values.<br />
<br />
-1 to -7: looks like a mix of smoothness and edgedetect<br />
<br />
-8: image seems to be completely broken<br />
<br />
-9 and lower: kind of sharpening effect (-9 sharper than -10)<br />
<br />
I think the sharpening effect in particular could be useful.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110391""></a>
  <div class="note">
   <strong class="user">martijn(97+1) at gmail dot com (solve math)</strong>
   <a href="#110391" class="date">18-Oct-2012 02:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple pixelate function, just in case you are &lt; 5.3<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">pixelate</span><span class="keyword">(&amp;</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$pixelsize</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$maxX </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$maxY </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rad</span><span class="keyword">=</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$pixelsize</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">$rad</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">$maxX</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">+=</span><span class="default">$pixelsize</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">$rad</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">$maxY</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">+=</span><span class="default">$pixelsize</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilledrectangle </span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">-</span><span class="default">$rad</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">-</span><span class="default">$rad</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">+</span><span class="default">$pixelsize</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">+</span><span class="default">$pixelsize</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109809""></a>
  <div class="note">
   <strong class="user">cookie at backbone dot sk</strong>
   <a href="#109809" class="date">23-Aug-2012 10:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a function to create nice vignette effect:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">vignette</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">effect</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, &amp;</span><span class="default">$rgb</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; global </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sharp </span><span class="keyword">= </span><span class="default">0.4</span><span class="keyword">; </span><span class="comment">// 0 - 10 small is sharpnes,&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$level </span><span class="keyword">= </span><span class="default">0.7</span><span class="keyword">; </span><span class="comment">// 0 - 1 small is brighter<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$l </span><span class="keyword">= </span><span class="default">sin</span><span class="keyword">(</span><span class="default">M_PI </span><span class="keyword">/ </span><span class="default">$width </span><span class="keyword">* </span><span class="default">$x</span><span class="keyword">) * </span><span class="default">sin</span><span class="keyword">(</span><span class="default">M_PI </span><span class="keyword">/ </span><span class="default">$height </span><span class="keyword">* </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$l </span><span class="keyword">= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">$l</span><span class="keyword">, </span><span class="default">$sharp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$l </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">- </span><span class="default">$level </span><span class="keyword">* (</span><span class="default">1 </span><span class="keyword">- </span><span class="default">$l</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">] *= </span><span class="default">$l</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">] *= </span><span class="default">$l</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">] *= </span><span class="default">$l</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">); ++</span><span class="default">$x</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">); ++</span><span class="default">$y</span><span class="keyword">){&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$index </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$index</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">effect</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$rgb</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">], </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">], </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">]);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">);&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return(</span><span class="default">true</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="string">'cars7_134.jpg'</span><span class="keyword">);<br />
<br />
if(</span><span class="default">$im </span><span class="keyword">and </span><span class="default">vignette</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Type: image/jpeg'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
}else{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Vignette failed.'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106344""></a>
  <div class="note">
   <strong class="user">mail at pedrocandeias dot com</strong>
   <a href="#106344" class="date">29-Oct-2011 04:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
// With transparent PNG file you can colorize the "positive" items and stand the transparent has it is - Beta code<br />
<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">'Content-Type: image/png'</span><span class="keyword">);<br />
<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="string">'image.png'</span><span class="keyword">);<br />
</span><span class="default">$width </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">$imn </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
</span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">,</span><span class="default">false</span><span class="keyword">);<br />
</span><span class="default">$col</span><span class="keyword">=</span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">127</span><span class="keyword">);<br />
</span><span class="default">imagesavealpha</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">,</span><span class="default">$col</span><span class="keyword">);<br />
</span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">imagecopy</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">, </span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
</span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">, </span><span class="default">IMG_FILTER_NEGATE</span><span class="keyword">);<br />
<br />
</span><span class="comment">// FOR A TRANSPARENT PNG FILE WITH SOMETHING INSIDE, YOU CAN CHANGE THE COLOR HERE: I HAVE RGB: 0, 255, 0<br />
</span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">, </span><span class="default">IMG_FILTER_COLORIZE</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104528""></a>
  <div class="note">
   <strong class="user">hadrien dot jouet at grownseed dot net</strong>
   <a href="#104528" class="date">21-Jun-2011 03:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For people looking to apply a 'multiply' effect on images like the one in Photoshop (generally b&amp;w ones), you can achieve it with the IMG_FILTER_COLORIZE filter.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">multiplyColor</span><span class="keyword">(&amp;</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$color </span><span class="keyword">= array(</span><span class="default">255</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp; </span><span class="comment">//get opposite color<br />
&nbsp;&nbsp; </span><span class="default">$opposite </span><span class="keyword">= array(</span><span class="default">255 </span><span class="keyword">- </span><span class="default">$color</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">255 </span><span class="keyword">- </span><span class="default">$color</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">255 </span><span class="keyword">- </span><span class="default">$color</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
<br />
&nbsp;&nbsp; </span><span class="comment">//now we subtract the opposite color from the image<br />
&nbsp;&nbsp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">IMG_FILTER_COLORIZE</span><span class="keyword">, -</span><span class="default">$opposite</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], -</span><span class="default">$opposite</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], -</span><span class="default">$opposite</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102966""></a>
  <div class="note">
   <strong class="user">bushmakin stas (bushstas at mail dot ru)</strong>
   <a href="#102966" class="date">17-Mar-2011 09:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a function to make all colors gray except the only one<br />
i made it myself so the code is note so beautiful )<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">imagecolorfilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">$width</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">$height</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">ImageColorAt</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$g </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">$rgb </span><span class="keyword">&amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">=(</span><span class="default">$r</span><span class="keyword">+</span><span class="default">$g</span><span class="keyword">+</span><span class="default">$b</span><span class="keyword">)/</span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
</span><span class="comment">//if($g&lt;$r || $g&lt;$b+20){$r=$c;$g=$c; $b=$c;}//leaves only green <br />
//if($b&lt;$r || $b&lt;$g){$r=$c;$g=$c; $b=$c;}//only blue<br />
</span><span class="keyword">if(</span><span class="default">$r</span><span class="keyword">&lt;</span><span class="default">$g</span><span class="keyword">+</span><span class="default">30 </span><span class="keyword">|| </span><span class="default">$r</span><span class="keyword">&lt;</span><span class="default">$b</span><span class="keyword">){</span><span class="default">$r</span><span class="keyword">=</span><span class="default">$c</span><span class="keyword">;</span><span class="default">$g</span><span class="keyword">=</span><span class="default">$c</span><span class="keyword">; </span><span class="default">$b</span><span class="keyword">=</span><span class="default">$c</span><span class="keyword">;}</span><span class="comment">//only red<br />
//if($r&lt;$g-1 || $r&gt;$g+60 || $b&gt;$g-50){$r=$c;$g=$c; $b=$c;}//only yellow<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
</span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">,</span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">,</span><span class="default">$g</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">header </span><span class="keyword">(</span><span class="string">"Content-type: image/jpeg"</span><span class="keyword">);<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="string">"image.jpg"</span><span class="keyword">);<br />
</span><span class="default">imagecolorfilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101159""></a>
  <div class="note">
   <strong class="user">jonathan dot gotti  at gmail dot com</strong>
   <a href="#101159" class="date">30-Nov-2010 03:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IMG_FILTER_COLORIZE doesn't seem to work on palette image, here's a way to achieve same result with palette image:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//$color is an array containing rvb infos (ie: array(255,80,0))<br />
</span><span class="keyword">function </span><span class="default">paletteColorize</span><span class="keyword">(</span><span class="default">$imgResource</span><span class="keyword">,array </span><span class="default">$color</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nbColors </span><span class="keyword">= </span><span class="default">imagecolorstotal</span><span class="keyword">(</span><span class="default">$imgResource</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$nbColors</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">3</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">] = </span><span class="default">max</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">min</span><span class="keyword">(</span><span class="default">255</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">]+</span><span class="default">$color</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">]));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecolorset</span><span class="keyword">(</span><span class="default">$imgResource</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$c</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],</span><span class="default">$c</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Here's also a function that work on both truecolor and palette images that try to do something similar to greyscale with a given color<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">colorScale</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">,array </span><span class="default">$color</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">,</span><span class="default">IMG_FILTER_GRAYSCALE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">_read_color</span><span class="keyword">(</span><span class="default">$color</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$luminance</span><span class="keyword">=(</span><span class="default">$color</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]+</span><span class="default">$color</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]+</span><span class="default">$color</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">])/</span><span class="default">3</span><span class="keyword">; </span><span class="comment">// average luminance added by the color<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$brightnessCorrection </span><span class="keyword">= </span><span class="default">$luminance</span><span class="keyword">/</span><span class="default">3</span><span class="keyword">; </span><span class="comment">// quantity of brightness to correct for each channel<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">$luminance </span><span class="keyword">&lt; </span><span class="default">127 </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$brightnessCorrection </span><span class="keyword">-= </span><span class="default">127</span><span class="keyword">/</span><span class="default">3</span><span class="keyword">; </span><span class="comment">// color is dark so we have to negate the brightness correction <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(! </span><span class="default">imageistruecolor</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">) ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nbColors </span><span class="keyword">= </span><span class="default">imagecolorstotal</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$nbColors</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">imgagecolorsforindex</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">3</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">] = </span><span class="default">max</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">min</span><span class="keyword">(</span><span class="default">255</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">] + (</span><span class="default">$color</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">]-</span><span class="default">$luminance</span><span class="keyword">) + </span><span class="default">$brightnessCorrection</span><span class="keyword">) ); </span><span class="comment">// parentheses just for better comprehension<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecolorset</span><span class="keyword">(</span><span class="default">$omgRes</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$c</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],</span><span class="default">$c</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{ </span><span class="comment">// much easier with truecolor<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">, </span><span class="default">IMG_FILTER_COLORIZE</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]-</span><span class="default">$luminance</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-</span><span class="default">$luminance</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]-</span><span class="default">$luminance</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">, </span><span class="default">IMG_FILTER_BRIGHTNESS</span><span class="keyword">, </span><span class="default">$brightnessCorrection</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
with hope that someone will find this useful</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91796""></a>
  <div class="note">
   <strong class="user">mail at kavisiegel dot com</strong>
   <a href="#91796" class="date">25-Jun-2009 08:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Searching for a way to easily change the color of the image, I tried IMG_FILTER_COLORIZE. I was unable to get the quality results I wanted. It turns out PHP's Colorize is the equivalent of Photoshop's "Linear Dodge" layer filter. <br />
<br />
Hue adjustments have always worked well for me, so I figured I could try with PHP.<br />
This function is kind of slow on larger images, but on small images like what I'm using it for, the difference is trivial.<br />
<br />
The script calculates the ratio or red, to green, to blue in the color provided, then scales the image appropriately... unfortunately, it does it pixel by pixel.<br />
<br />
Here's a demo and comparison of this function, to photoshop's hue function, to PHP's colorize. <a href="http://img146.imageshack.us/img146/3167/imagefilterhuedemo.png" rel="nofollow" target="_blank">http://img146.imageshack.us/img146/3167/imagefilterhuedemo.png</a><br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">imagefilterhue</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">,</span><span class="default">$g</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">+</span><span class="default">$g</span><span class="keyword">+</span><span class="default">$b</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$col </span><span class="keyword">= array(</span><span class="default">$r</span><span class="keyword">/</span><span class="default">$rgb</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">/</span><span class="default">$rgb</span><span class="keyword">,</span><span class="default">$g</span><span class="keyword">/</span><span class="default">$rgb</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">$width</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">$height</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">ImageColorAt</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$g </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">$rgb </span><span class="keyword">&amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newR </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] + </span><span class="default">$g</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] + </span><span class="default">$b</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newG </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] + </span><span class="default">$g</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] + </span><span class="default">$b</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newB </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] + </span><span class="default">$g</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] + </span><span class="default">$b</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">,</span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$newR</span><span class="keyword">, </span><span class="default">$newG</span><span class="keyword">, </span><span class="default">$newB</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">header </span><span class="keyword">(</span><span class="string">"Content-type: image/jpeg"</span><span class="keyword">);<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="string">"test.jpg"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Usage: Just as imagefilter(), except with no filtertype.<br />
// imagefilterhue(resource $image, int $red, int $green , int $blue)<br />
</span><span class="default">imagefilterhue</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">70</span><span class="keyword">,</span><span class="default">188</span><span class="keyword">);<br />
<br />
</span><span class="comment">// The equivalent with colorize, as tested in demo image: imagefilter($im, IMG_FILTER_COLORIZE, 2, 70, 188);<br />
<br />
</span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82162""></a>
  <div class="note">
   <strong class="user">aiden dot mail at freemail dot hu</strong>
   <a href="#82162" class="date">29-Mar-2008 09:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Function to change the transparency of a png image on the fly. Works only with PNG, and with a browser supporting alpha channel.<br />
The function stretches the opacity-range of the image, so that the most opaque pixel(s) will be set to the given opacity. (Other opacity values in pixels are modified accordingly.)<br />
Returns success or failure.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">filter_opacity</span><span class="keyword">( &amp;</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$opacity </span><span class="keyword">) </span><span class="comment">//params: image resource id, opacity in percentage (eg. 80)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( !isset( </span><span class="default">$opacity </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { return </span><span class="default">false</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$opacity </span><span class="keyword">/= </span><span class="default">100</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//get image width and height<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">( </span><span class="default">$img </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$h </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">( </span><span class="default">$img </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//turn alpha blending off<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagealphablending</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">false </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//find the most opaque pixel in the image (the one with the smallest alpha value)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$minalpha </span><span class="keyword">= </span><span class="default">127</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for( </span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$w</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++ )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for( </span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">$h</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++ )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$alpha </span><span class="keyword">= ( </span><span class="default">imagecolorat</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y </span><span class="keyword">) &gt;&gt; </span><span class="default">24 </span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$alpha </span><span class="keyword">&lt; </span><span class="default">$minalpha </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { </span><span class="default">$minalpha </span><span class="keyword">= </span><span class="default">$alpha</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//loop through image pixels and modify alpha for each<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">for( </span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$w</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++ )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for( </span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">$h</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++ )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//get current alpha value (represents the TANSPARENCY!)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$colorxy </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$alpha </span><span class="keyword">= ( </span><span class="default">$colorxy </span><span class="keyword">&gt;&gt; </span><span class="default">24 </span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//calculate new alpha<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">$minalpha </span><span class="keyword">!== </span><span class="default">127 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { </span><span class="default">$alpha </span><span class="keyword">= </span><span class="default">127 </span><span class="keyword">+ </span><span class="default">127 </span><span class="keyword">* </span><span class="default">$opacity </span><span class="keyword">* ( </span><span class="default">$alpha </span><span class="keyword">- </span><span class="default">127 </span><span class="keyword">) / ( </span><span class="default">127 </span><span class="keyword">- </span><span class="default">$minalpha </span><span class="keyword">); }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { </span><span class="default">$alpha </span><span class="keyword">+= </span><span class="default">127 </span><span class="keyword">* </span><span class="default">$opacity</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//get the color index with new alpha<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$alphacolorxy </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, ( </span><span class="default">$colorxy </span><span class="keyword">&gt;&gt; </span><span class="default">16 </span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">, ( </span><span class="default">$colorxy </span><span class="keyword">&gt;&gt; </span><span class="default">8 </span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">, </span><span class="default">$colorxy </span><span class="keyword">&amp; </span><span class="default">0xFF</span><span class="keyword">, </span><span class="default">$alpha </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//set pixel with the new color + opacity<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( !</span><span class="default">imagesetpixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$alphacolorxy </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { return </span><span class="default">false</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Example for use:<br />
<br />
&nbsp;<span class="default">&lt;?php<br />
&nbsp; $image </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">( </span><span class="string">"img.png" </span><span class="keyword">);<br />
&nbsp; </span><span class="default">filter_opacity</span><span class="keyword">( </span><span class="default">$image</span><span class="keyword">, </span><span class="default">75 </span><span class="keyword">);<br />
&nbsp; </span><span class="default">header</span><span class="keyword">( </span><span class="string">"content-type: image/png" </span><span class="keyword">);<br />
&nbsp; </span><span class="default">imagepng</span><span class="keyword">( </span><span class="default">$image </span><span class="keyword">);<br />
&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">( </span><span class="default">$image </span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79337""></a>
  <div class="note">
   <strong class="user">michaeln no at spam associationsplus ca</strong>
   <a href="#79337" class="date">21-Nov-2007 05:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note: applying IMG_FILTER_EMBOSS to text and using in a customization to the CAPTCHA image script in phpBB or a project of your own is a very good way to stop OCR-ing bots from getting through. Embossed serif fonts are fairly easy for the human eye to understand but to an OCR script it is extremely difficult because it seems to give it the illusion of 3D. <br />
<br />
If you only allocate 2 or 3 colours in the image, it uses the background colour alot in the embossed text, which greatly contributes to this.<br />
<br />
I made my own custom CAPTCHA script to stop phpBB post spam for a client site I was developing and I have gone from getting 2-3 new spam users created every day to zero.<br />
<br />
Anything with the source code freely available out there right now is possible to be defeated by spammers once one of them stars sharing code with the other spammers, but if you run something at least someone custom, their bots will pass you over.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79133""></a>
  <div class="note">
   <strong class="user">ssttoo at gmail dot com</strong>
   <a href="#79133" class="date">13-Nov-2007 09:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a page that shows the different filters in action<br />
<a href="http://www.phpied.com/image-fun-with-php-part-2/" rel="nofollow" target="_blank">http://www.phpied.com/image-fun-with-php-part-2/</a><br />
Also shows some quick ways to do sepia.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75003""></a>
  <div class="note">
   <strong class="user">webmaster at designsbykosi dot info</strong>
   <a href="#75003" class="date">08-May-2007 09:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This will only work if you have php5. For php4, you'll have to use the sepia function set webmaster at qudi dot de suggested.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73944""></a>
  <div class="note">
   <strong class="user">fananf at nerdshack dot com</strong>
   <a href="#73944" class="date">16-Mar-2007 06:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're looking for fast sepia effect that can be used for on-the-fly thumbnails generation you can't use sophisticated functions. The faster and much better way than described by webmaster at qudi dot de in the note from 31-Jan-2006 is applying colorize filter AFTER grayscale.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">(...)<br />
<br />
</span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$yourimage</span><span class="keyword">, </span><span class="default">IMG_FILTER_GRAYSCALE</span><span class="keyword">); </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$yourimage</span><span class="keyword">, </span><span class="default">IMG_FILTER_COLORIZE</span><span class="keyword">, </span><span class="default">90</span><span class="keyword">, </span><span class="default">60</span><span class="keyword">, </span><span class="default">40</span><span class="keyword">); <br />
<br />
(...)<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I used (90,60,40) for my sepia after couple of tests, however, if you need darker or lighter just check what suits you best.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73253""></a>
  <div class="note">
   <strong class="user">trucex email over at gmail</strong>
   <a href="#73253" class="date">14-Feb-2007 09:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It appears that imagefilter doesn't play nice with apha. If you run an imagefilter on a transparent image it'll return a black image...similar to a lot of Photoshop plugins do.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72329""></a>
  <div class="note">
   <strong class="user">PanuWorld</strong>
   <a href="#72329" class="date">14-Jan-2007 03:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The documentation misses the exact meaning and valid ranges of the arguments for ImageFilter(). According to the 5.2.0 sources the arguments are:<br />
IMG_FILTER_BRIGHTNESS<br />
-255 = min brightness, 0 = no change, +255 = max brightness<br />
<br />
IMG_FILTER_CONTRAST<br />
-100 = max contrast, 0 = no change, +100 = min contrast (note the direction!)<br />
<br />
IMG_FILTER_COLORIZE<br />
Adds (subtracts) specified RGB values to each pixel. The valid range for each color is -255...+255, not 0...255. The correct order is red, green, blue.<br />
-255 = min, 0 = no change, +255 = max<br />
This has not much to do with IMG_FILTER_GRAYSCALE.<br />
<br />
IMG_FILTER_SMOOTH<br />
Applies a 9-cell convolution matrix where center pixel has the weight arg1 and others weight of 1.0. The result is normalized by dividing the sum with arg1 + 8.0 (sum of the matrix).<br />
any float is accepted, large value (in practice: 2048 or more) = no change<br />
<br />
ImageFilter seem to return false if the argument(s) are out of range for the chosen filter.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68626""></a>
  <div class="note">
   <strong class="user">nancy at hypertextdigital dot com</strong>
   <a href="#68626" class="date">03-Aug-2006 11:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This routine was just what I was looking for, I wanted web admin users to be able to recolour their uploaded photos (to go with a news item) either a blue tint or sepia to match the appearance of other colours used on the website. <br />
<br />
Using a form with a select box containing the RGB values, I can give them the option of either of the two tints or no colourization at all, plus resize their images to the viewing size and a thumbnail image on the fly without having to use any other image editing software.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62395""></a>
  <div class="note">
   <strong class="user">santibari at fibertel dot com</strong>
   <a href="#62395" class="date">27-Feb-2006 08:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A colorize algorithm wich preserves color luminosity (i.e black <br />
will output black, and white will output white).<br />
This works in PHP4 and is great for customizing interfaces <br />
dinamically.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">colorize</span><span class="keyword">(</span><span class="default">$img_src</span><span class="keyword">,</span><span class="default">$img_dest</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$g</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">) <br />
{<br />
if(!</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatefromgif</span><span class="keyword">(</span><span class="default">$img_src</span><span class="keyword">))<br />
&nbsp; return </span><span class="string">"Could not use image </span><span class="default">$img_src</span><span class="string">"</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="comment">//We will create a monochromatic palette based on<br />
//the input color<br />
//which will go from black to white<br />
//Input color luminosity: this is equivalent to the <br />
//position of the input color in the monochromatic<br />
//palette<br />
</span><span class="default">$lum_inp</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">255</span><span class="keyword">*(</span><span class="default">$r</span><span class="keyword">+</span><span class="default">$g</span><span class="keyword">+</span><span class="default">$b</span><span class="keyword">)/</span><span class="default">765</span><span class="keyword">); </span><span class="comment">//765=255*3<br />
<br />
//We fill the palette entry with the input color at its <br />
//corresponding position<br />
<br />
</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$lum_inp</span><span class="keyword">][</span><span class="string">'r'</span><span class="keyword">]=</span><span class="default">$r</span><span class="keyword">;<br />
</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$lum_inp</span><span class="keyword">][</span><span class="string">'g'</span><span class="keyword">]=</span><span class="default">$g</span><span class="keyword">;<br />
</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$lum_inp</span><span class="keyword">][</span><span class="string">'b'</span><span class="keyword">]=</span><span class="default">$b</span><span class="keyword">;<br />
<br />
</span><span class="comment">//Now we complete the palette, first we'll do it to<br />
//the black,and then to the white.<br />
<br />
//FROM input to black<br />
//===================<br />
//how many colors between black and input<br />
</span><span class="default">$steps_to_black</span><span class="keyword">=</span><span class="default">$lum_inp</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; <br />
<br />
</span><span class="comment">//The step size for each component<br />
</span><span class="keyword">if(</span><span class="default">$steps_to_black</span><span class="keyword">)<br />
&nbsp;{<br />
&nbsp;</span><span class="default">$step_size_red</span><span class="keyword">=</span><span class="default">$r</span><span class="keyword">/</span><span class="default">$steps_to_black</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;</span><span class="default">$step_size_green</span><span class="keyword">=</span><span class="default">$g</span><span class="keyword">/</span><span class="default">$steps_to_black</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;</span><span class="default">$step_size_blue</span><span class="keyword">=</span><span class="default">$b</span><span class="keyword">/</span><span class="default">$steps_to_black</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;}<br />
<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">$steps_to_black</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&gt;=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">--)<br />
&nbsp;{<br />
&nbsp;</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$steps_to_black</span><span class="keyword">-</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'r'</span><span class="keyword">]=</span><span class="default">$r</span><span class="keyword">-</span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_red</span><span class="keyword">*</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$steps_to_black</span><span class="keyword">-</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'g'</span><span class="keyword">]=</span><span class="default">$g</span><span class="keyword">-</span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_green</span><span class="keyword">*</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$steps_to_black</span><span class="keyword">-</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'b'</span><span class="keyword">]=</span><span class="default">$b</span><span class="keyword">-</span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_blue</span><span class="keyword">*</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;}<br />
<br />
</span><span class="comment">//From input to white:<br />
//===================<br />
//how many colors between input and white<br />
</span><span class="default">$steps_to_white</span><span class="keyword">=</span><span class="default">255</span><span class="keyword">-</span><span class="default">$lum_inp</span><span class="keyword">;<br />
<br />
if(</span><span class="default">$steps_to_white</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp; </span><span class="default">$step_size_red</span><span class="keyword">=(</span><span class="default">255</span><span class="keyword">-</span><span class="default">$r</span><span class="keyword">)/</span><span class="default">$steps_to_white</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp; </span><span class="default">$step_size_green</span><span class="keyword">=(</span><span class="default">255</span><span class="keyword">-</span><span class="default">$g</span><span class="keyword">)/</span><span class="default">$steps_to_white</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp; </span><span class="default">$step_size_blue</span><span class="keyword">=(</span><span class="default">255</span><span class="keyword">-</span><span class="default">$b</span><span class="keyword">)/</span><span class="default">$steps_to_white</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp; }<br />
&nbsp;else<br />
&nbsp; </span><span class="default">$step_size_red</span><span class="keyword">=</span><span class="default">$step_size_green</span><span class="keyword">=</span><span class="default">$step_size_blue</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;</span><span class="comment">//The step size for each component<br />
&nbsp;</span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=(</span><span class="default">$lum_inp</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">255</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp; {<br />
&nbsp; </span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'r'</span><span class="keyword">]=</span><span class="default">$r </span><span class="keyword">+ </span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_red</span><span class="keyword">*(</span><span class="default">$i</span><span class="keyword">-</span><span class="default">$lum_inp</span><span class="keyword">));<br />
&nbsp; </span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'g'</span><span class="keyword">]=</span><span class="default">$g </span><span class="keyword">+ </span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_green</span><span class="keyword">*(</span><span class="default">$i</span><span class="keyword">-</span><span class="default">$lum_inp</span><span class="keyword">));<br />
&nbsp; </span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'b'</span><span class="keyword">]=</span><span class="default">$b </span><span class="keyword">+ </span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_blue</span><span class="keyword">*(</span><span class="default">$i</span><span class="keyword">-</span><span class="default">$lum_inp</span><span class="keyword">));<br />
&nbsp; }<br />
</span><span class="comment">//--- End of palette creation<br />
<br />
//Now,let's change the original palette into the one we<br />
//created<br />
</span><span class="keyword">for(</span><span class="default">$c </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$c </span><span class="keyword">&lt; </span><span class="default">$palette_size</span><span class="keyword">; </span><span class="default">$c</span><span class="keyword">++)<br />
&nbsp;{ <br />
&nbsp;</span><span class="default">$col </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;</span><span class="default">$lum_src</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">255</span><span class="keyword">*(</span><span class="default">$col</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">]+</span><span class="default">$col</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; +</span><span class="default">$col</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">])/</span><span class="default">765</span><span class="keyword">);<br />
&nbsp;</span><span class="default">$col_out</span><span class="keyword">=</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$lum_src</span><span class="keyword">];<br />
&nbsp;</span><span class="default">imagecolorset</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">, </span><span class="default">$col_out</span><span class="keyword">[</span><span class="string">'r'</span><span class="keyword">], <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$col_out</span><span class="keyword">[</span><span class="string">'g'</span><span class="keyword">],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$col_out</span><span class="keyword">[</span><span class="string">'b'</span><span class="keyword">]);<br />
&nbsp;}<br />
<br />
&nbsp;</span><span class="comment">//save the image file<br />
&nbsp;</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">,</span><span class="default">$img_dest</span><span class="keyword">);<br />
&nbsp;</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
}</span><span class="comment">//end function colorize<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61317""></a>
  <div class="note">
   <strong class="user">webmaster at qudi dot de</strong>
   <a href="#61317" class="date">31-Jan-2006 03:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
for a quick, ok-looking, sepia-effect (also in php4) I just use this little fellow, since a real implementation of sepia was just way too slow.<br />
<br />
function pseudosepia(&amp;$im,$percent){<br />
&nbsp;&nbsp; &nbsp;&nbsp; $sx=imagesx($im);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $sy=imagesy($im);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $filter=imagecreatetruecolor($sx,$sy);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $c=imagecolorallocate($filter,100,50,50);<br />
&nbsp;&nbsp; &nbsp;&nbsp; imagefilledrectangle($filter,0,0,$sx,$sy,$c);<br />
&nbsp;&nbsp; &nbsp;&nbsp; imagecopymerge($im,$filter,0,0,0,0,$sx,$sy,$percent);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59944""></a>
  <div class="note">
   <strong class="user">a php user  at  nowhere dot com</strong>
   <a href="#59944" class="date">20-Dec-2005 09:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<a href="http://www.hudzilla.org/phpbook/read.php/11_2_15" rel="nofollow" target="_blank">http://www.hudzilla.org/phpbook/read.php/11_2_15</a><br />
for more detailed info, and some &lt;i&gt;arg&lt;/i&gt; guidelines.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45391""></a>
  <div class="note">
   <strong class="user">vdepizzol at hotmail dot com</strong>
   <a href="#45391" class="date">04-Sep-2004 10:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Examples using imagefilter():<br />
<br />
<span class="default">&lt;?php<br />
$im </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="string">'dave.png'</span><span class="keyword">);<br />
if (</span><span class="default">$im </span><span class="keyword">&amp;&amp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">IMG_FILTER_GRAYSCALE</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Image converted to grayscale.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="string">'dave.png'</span><span class="keyword">);<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Conversion to grayscale failed.'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
/////////////////////////////<br />
<br />
<span class="default">&lt;?php<br />
$im </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="string">'sean.png'</span><span class="keyword">);<br />
if (</span><span class="default">$im </span><span class="keyword">&amp;&amp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">IMG_FILTER_BRIGHTNESS</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Image brightness changed.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="string">'sean.png'</span><span class="keyword">);<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Image brightness change failed.'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
/////////////////////////////<br />
<br />
<span class="default">&lt;?php<br />
$im </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="string">'philip.png'</span><span class="keyword">);<br />
<br />
</span><span class="comment">/* R, G, B, so 0, 255, 0 is green */<br />
</span><span class="keyword">if (</span><span class="default">$im </span><span class="keyword">&amp;&amp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">IMG_FILTER_COLORIZE</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Image successfully shaded green.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="string">'philip.png'</span><span class="keyword">);<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Green shading failed.'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44316""></a>
  <div class="note">
   <strong class="user">kees at tweakers dot net</strong>
   <a href="#44316" class="date">21-Jul-2004 03:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
From what i have been able to find from this function, it accepts the following arguments:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_NEGATE<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_GRAYSCALE<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_EDGEDETECT<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_GAUSSIAN_BLUR<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_SELECTIVE_BLUR<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_EMBOSS<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_MEAN_REMOVAL<br />
<br />
The following arguments need one or more arguments.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_SMOOTH, -1924.124<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_COLORIZE, -127.12, -127.98, 127<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_CONTRAST, -90<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_BRIGHTNESS, 98<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
I haven't tested them all, the names speak for themselves.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.imagefilltoborder.html">imagefilltoborder</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.imageflip.html">imageflip</a></div>
 <div class="up"><a href="ref.image.html">GD および Image 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
