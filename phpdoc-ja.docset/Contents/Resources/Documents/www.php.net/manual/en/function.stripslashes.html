<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>クォートされた文字列のクォート部分を取り除く</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.stripos.html">stripos</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.stristr.html">stristr</a></div>
 <div class="up"><a href="ref.strings.html">String 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.stripslashes" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">stripslashes</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">stripslashes</span> &mdash; <span class="dc-title">クォートされた文字列のクォート部分を取り除く</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.stripslashes-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>stripslashes</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$str</code></span>
   )</div>

  <p class="para rdfs-comment">
   クォートされた文字列を元に戻します。
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    <a href="sybase.configuration.html#ini.magic-quotes-sybase" class="link">magic_quotes_sybase</a> が
    on の場合はバックスラッシュは取り除かれず、そのかわりに 2 つの
    アポストロフィが 1 つに置き換えられます。
   </p>
  </p></blockquote>
  <p class="para">
    <span class="function"><strong>stripslashes()</strong></span> の使用例は、PHP ディレクティブ
   <a href="info.configuration.html#ini.magic-quotes-gpc" class="link">magic_quotes_gpc</a>
   が <em>on</em> (PHP 5.4 より前のバージョンでのデフォルト値) かつ、
   データをエスケープして (データベースのような)
   ある場所に挿入していない場合です。
   例えば、単純に HTML フォームからのデータを直接出力するような場合です。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.stripslashes-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><em><code class="parameter">str</code></em></span>
     <dd>

      <p class="para">
       入力文字列。
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.stripslashes-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   バックスラッシュが取り除かれた文字列を返します(<em>\&#039;
   </em> が <em>&#039;</em> になるなど)。
   2 つ並んだバックスラッシュ (<em>\\</em>)
   は 1 つのバックスラッシュ (<em>\</em>) になります。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.stripslashes-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-4861">
    <p><strong>例1  <span class="function"><strong>stripslashes()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"Is&nbsp;your&nbsp;name&nbsp;O\'reilly?"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;出力:&nbsp;Is&nbsp;your&nbsp;name&nbsp;O'reilly?<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">stripslashes</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
     <span class="function"><strong>stripslashes()</strong></span> は再帰的な処理を行いません。
    この関数を多次元配列に適用する場合は、
    再帰的な関数を使用する必要があります。
   </p>
  </p></blockquote>
  <p class="para">
   <div class="example" id="example-4862">
    <p><strong>例2 配列に対する  <span class="function"><strong>stripslashes()</strong></span> の使用</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">stripslashes_deep</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">is_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;?<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">array_map</span><span style="color: #007700">(</span><span style="color: #DD0000">'stripslashes_deep'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">stripslashes</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;例<br /></span><span style="color: #0000BB">$array&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"f\\'oo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"b\\'ar"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"fo\\'o"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"b\\'ar"</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">$array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stripslashes_deep</span><span style="color: #007700">(</span><span style="color: #0000BB">$array</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;出力<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$array</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [0] =&gt; f&#039;oo
    [1] =&gt; b&#039;ar
    [2] =&gt; Array
        (
            [0] =&gt; fo&#039;o
            [1] =&gt; b&#039;ar
        )

)
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.stripslashes-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"> <span class="function"><a href="function.addslashes.html" class="function" rel="rdfs-seeAlso">addslashes()</a> - 文字列をスラッシュでクォートする</span></li>
    <li class="member"> <span class="function"><a href="function.get-magic-quotes-gpc.html" class="function" rel="rdfs-seeAlso">get_magic_quotes_gpc()</a> - magic_quotes_gpc の現在の設定を得る</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111426""></a>
  <div class="note">
   <strong class="user">Yousef Ismaeil Cliprz</strong>
   <a href="#111426" class="date">19-Feb-2013 04:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to use stripslashes(); function for a string or array you can create a user function<br />
<br />
as in example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'strip_slashes'</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Un-quotes a quoted string.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param (mixed) $str - The input string.<br />
&nbsp;&nbsp; &nbsp; * @author Yousef Ismaeil Cliprz<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">strip_slashes</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$str </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">strip_slashes</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$arr </span><span class="keyword">= array(</span><span class="string">'Yousef\\\'s'</span><span class="keyword">,</span><span class="string">'\"PHP.net\"'</span><span class="keyword">,</span><span class="string">'user\\\'s'</span><span class="keyword">);<br />
<br />
echo </span><span class="string">'With strip_slashes() function:&lt;br /&gt;'</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">strip_slashes</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">));<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'Without strip_slashes() function:&lt;br /&gt;'</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br />
<br />
</span><span class="comment">/** You will get<br />
With strip_slashes() function:<br />
Array ( [0] =&gt; Yousef's [1] =&gt; "PHP.net" [2] =&gt; user's )<br />
Without strip_slashes() function:<br />
Array ( [0] =&gt; Yousef\'s [1] =&gt; \"PHP.net\" [2] =&gt; user\'s )<br />
*/<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111216""></a>
  <div class="note">
   <strong class="user">StefanoAI</strong>
   <a href="#111216" class="date">27-Jan-2013 11:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Recursive stripslashes<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">get_magic_quotes_gpc</span><span class="keyword">()) {<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">stripslashes_array</span><span class="keyword">(&amp;</span><span class="default">$arr</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; &amp;</span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nk </span><span class="keyword">= </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$nk </span><span class="keyword">!= </span><span class="default">$k</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$nk</span><span class="keyword">] = &amp;</span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">stripslashes_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$nk</span><span class="keyword">] = </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">stripslashes_array</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">stripslashes_array</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">stripslashes_array</span><span class="keyword">(</span><span class="default">$_REQUEST</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">stripslashes_array</span><span class="keyword">(</span><span class="default">$_COOKIE</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109189""></a>
  <div class="note">
   <strong class="user">todd at toddzebert dot com</strong>
   <a href="#109189" class="date">27-Jun-2012 04:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Attempting to use stripslashes on an array in 5.2.17 returns the string "Array", but in 5.3.6 it returns NULL.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107802""></a>
  <div class="note">
   <strong class="user">tarmo at goyf dot de</strong>
   <a href="#107802" class="date">06-Mar-2012 11:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When matching strings with approstrophes against the mysql database, my query kept failing while it worked fine when I copied the same query directly to perform the database query. After several hours I found that stripslashes() made the string longer and hence it wasn't "equal" for the query.<br />
<br />
This code shows the behavior (copy into "test.php"). Replacing stripslashes worked for me.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">'&lt;h2&gt;Post-Data&lt;/h2&gt;'</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">);<br />
<br />
</span><span class="default">$f1 </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">filter_var</span><span class="keyword">(</span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">form</span><span class="keyword">]), </span><span class="default">FILTER_SANITIZE_STRING</span><span class="keyword">));<br />
echo </span><span class="string">'&lt;h2&gt;stripslashes&lt;/h2&gt;'</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$f1</span><span class="keyword">);<br />
<br />
</span><span class="default">$f2 </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"|"</span><span class="keyword">,</span><span class="string">"'"</span><span class="keyword">,</span><span class="default">filter_var</span><span class="keyword">(</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\'"</span><span class="keyword">,</span><span class="string">"|"</span><span class="keyword">,</span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">form</span><span class="keyword">]), </span><span class="default">FILTER_SANITIZE_STRING</span><span class="keyword">)));<br />
echo </span><span class="string">'&lt;h2&gt;workaround&lt;/h2&gt;'</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$f2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
echo </span><span class="string">'&lt;form action="test.php" method="post"&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;input type="text" name="form"&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;input type="submit"&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/form&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Entering "foo'bar" creates this output:<br />
// Post-Data<br />
// array(1) { ["form"]=&gt; string(8) "foo\'bar" }<br />
// stripslashes<br />
// string(11) "foo'bar"<br />
// workaround<br />
// string(7) "foo'bar"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101338""></a>
  <div class="note">
   <strong class="user">jeremysawesome</strong>
   <a href="#101338" class="date">10-Dec-2010 09:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm using this to clean the $_POST array:<br />
<span class="default">&lt;?php<br />
array_walk_recursive</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">, </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'&amp;$val'</span><span class="keyword">, </span><span class="string">'$val = stripslashes($val);'</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99183""></a>
  <div class="note">
   <strong class="user">jeremycook0 at googlemail dot com</strong>
   <a href="#99183" class="date">01-Aug-2010 05:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a way of stripping slashes in PHP 5.3 using a recursive closure:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">if (</span><span class="default">get_magic_quotes_gpc</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$strip_slashes_deep </span><span class="keyword">= function (</span><span class="default">$value</span><span class="keyword">) use (&amp;</span><span class="default">$strip_slashes_deep</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) ? </span><span class="default">array_map</span><span class="keyword">(</span><span class="default">$strip_slashes_deep</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) : </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$_GET </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="default">$strip_slashes_deep</span><span class="keyword">, </span><span class="default">$_GET</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$_POST </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="default">$strip_slashes_deep</span><span class="keyword">, </span><span class="default">$_POST</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$_COOKIE </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="default">$strip_slashes_deep</span><span class="keyword">, </span><span class="default">$_COOKIE</span><span class="keyword">);<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Note that the variable '$strip_slashes_deep' has to be passed to the closure by reference. I think that this is because at the time the closure is created the variable '$strip_slashes_deep' doesn't exist: the closure itself becomes the value of the variable. Passing by reference solves this issue. This closure could easily be adapted to use other methods of stripping slashes such as preg_replace().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94758""></a>
  <div class="note">
   <strong class="user">eugene at ultimatecms dot co dot za</strong>
   <a href="#94758" class="date">23-Nov-2009 02:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a simple function to remove the slashes added by functions such as magic_quotes_gpc and mysql_escape_string etc.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">no_magic_quotes</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\\"</span><span class="keyword">,</span><span class="default">$query</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cleaned </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">,</span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$cleaned</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// I'm using mysql_escape_string as a simple example, but this function would work for any escaped string.<br />
</span><span class="default">$query </span><span class="keyword">= </span><span class="string">"It's amaizing! Who's to say this isn't a simple function?"</span><span class="keyword">;<br />
</span><span class="default">$badstring </span><span class="keyword">= </span><span class="default">mysql_escape_string</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br />
<br />
echo </span><span class="string">'&lt;b&gt;Without funtion:&lt;/b&gt; '</span><span class="keyword">.</span><span class="default">$badstring</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br&gt;&lt;br&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;b&gt;With function:&lt;/b&gt; '</span><span class="keyword">.</span><span class="default">no_magic_quotes</span><span class="keyword">(</span><span class="default">$badstring</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Output:<br />
Without funtion: It\'s amaizing! Who\'s to say this isn\'t a simple function?<br />
<br />
With function: It's amaizing! Who's to say this isn't a simple function?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93278""></a>
  <div class="note">
   <strong class="user">michal at roszka dot pl</strong>
   <a href="#93278" class="date">01-Sep-2009 05:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The goal is to leave the input untouched in PHP 5.2.8. Let's have this sample text given in $_POST['example']:<br />
<br />
a backslash ( \ ), a single-quote ( ' ), a double-quote ( " ) and a null character ( \0 )<br />
<br />
Let's have two simple scripts:<br />
<br />
Script A:<br />
<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'example'</span><span class="keyword">]; </span><span class="default">?&gt;<br />
</span><br />
Script B:<br />
<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'example'</span><span class="keyword">]); </span><span class="default">?&gt;<br />
</span><br />
Let's have four different configurations and corresponding output:<br />
<br />
Case #1:<br />
<br />
&nbsp;* magic_quotes_gpc = Off<br />
&nbsp;* magic_quotes_sybase = Off<br />
<br />
A: a backslash ( \ ), a single-quote ( ' ), a double-quote ( " ) and a null character ( \0 )<br />
B: a backslash (&nbsp; ), a single-quote ( ' ), a double-quote ( " ) and a null character ( � )<br />
<br />
Case #2<br />
<br />
&nbsp;* magic_quotes_gpc = On<br />
&nbsp;* magic_quotes_sybase = Off<br />
<br />
A: a backslash ( \\ ), a single-quote ( \' ), a double-quote ( \" ) and a null character ( \\0 )<br />
B: a backslash ( \ ), a single-quote ( ' ), a double-quote ( " ) and a null character ( \0 )<br />
<br />
Case #3<br />
<br />
&nbsp;* magic_quotes_gpc = On<br />
&nbsp;* magic_quotes_sybase = On<br />
&nbsp;<br />
A: a backslash ( \ ), a single-quote ( '' ), a double-quote ( " ) and a null character ( \0 )<br />
B: a backslash ( \ ), a single-quote ( ' ), a double-quote ( " ) and a null character ( � )<br />
<br />
Case #4<br />
<br />
&nbsp;* magic_quotes_gpc = Off<br />
&nbsp;* magic_quotes_sybase = On<br />
<br />
A: a backslash ( \ ), a single-quote ( ' ), a double-quote ( " ) and a null character ( \0 )<br />
B: a backslash (&nbsp; ), a single-quote ( ' ), a double-quote ( " ) and a null character ( � )<br />
<br />
Conclusions:<br />
<br />
1) we do not need to do anything, if the magic_quotes_gpc is disabled (cases 1 and 4);<br />
2) stripslashes($_POST['example']) only works, if the magic_quotes_gpc is enabled, but the magic_quotes_sybase is disabled (case 2);<br />
3) str_replace("''", "'", $_POST['example']) will do the trick if both the magic_quotes_gpc and the magic_quotes_sybase are enabled (case 3);<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">disable_magic_quotes_gpc</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">TRUE </span><span class="keyword">== </span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'get_magic_quotes_gpc'</span><span class="keyword">) &amp;&amp; </span><span class="default">1 </span><span class="keyword">== </span><span class="default">get_magic_quotes_gpc</span><span class="keyword">())<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mqs </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'magic_quotes_sybase'</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">TRUE </span><span class="keyword">== empty(</span><span class="default">$mqs</span><span class="keyword">) || </span><span class="string">'off' </span><span class="keyword">== </span><span class="default">$mqs</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// we need to do stripslashes on $_GET, $_POST and $_COOKIE<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// we need to do str_replace("''", "'", ...) on $_GET, $_POST, $_COOKIE<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// otherwise we do not need to do anything<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
Important notes:<br />
<br />
1) arrays need to be processed recursively;<br />
<br />
2) both stripslashes and str_replace functions always return strings, so:<br />
<br />
* TRUE will become a string "1",<br />
* FALSE will become an empty string,<br />
* integers and floats will become strings,<br />
* NULL will become an empty string.<br />
<br />
On the other hand you only need to process strings, so use the is_string function to check;<br />
<br />
3) when dealing with other (than GPC) data sources, such as databases or text files, remember to play with the magic_quotes_runtime setting as well, see, what happens and write a corresponding function, i.e. disable_magic_quotes_runtime() or something.<br />
<br />
4) VERY IMPORTANT: when testing, remember the null character. Otherwise your tests will be inconclusive and you may end up with... well, serious bugs :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92524""></a>
  <div class="note">
   <strong class="user">JacobRas.nl</strong>
   <a href="#92524" class="date">28-Jul-2009 02:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi,<br />
<br />
Here's an function that strips not only \', but also \\' and \\\' and so on (depending on $times). $text = the text that needs to be stripped, $times = how much backslashes should be stripped.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">stripslashes_deep </span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$times</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// loop will execute $times times.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">while (</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">) &amp;&amp; </span><span class="default">$i </span><span class="keyword">!= </span><span class="default">$times</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$text</span><span class="keyword">= </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$text</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Example: $text = \\'quote\\' . <span class="default">&lt;?php stripslashes_deep</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">); </span><span class="default">?&gt;</span> will return 'quote'.<br />
Note: <span class="default">&lt;?php stripslashes_deep</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">); </span><span class="default">?&gt;</span> will also return 'quote'.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90788""></a>
  <div class="note">
   <strong class="user">shredder at technodrome dot com</strong>
   <a href="#90788" class="date">10-May-2009 12:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi, <br />
<br />
Here are recursive addslashes / stripslashes functions.<br />
given a string - it will simply add / strip slashes<br />
given an array - it will recursively add / strip slashes from the array and all of it subarrays. <br />
if the value is not a string or array - it will remain unmodified!<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">add_slashes_recursive</span><span class="keyword">( </span><span class="default">$variable </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">is_string</span><span class="keyword">( </span><span class="default">$variable </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">addslashes</span><span class="keyword">( </span><span class="default">$variable </span><span class="keyword">) ;<br />
<br />
&nbsp;&nbsp;&nbsp; elseif ( </span><span class="default">is_array</span><span class="keyword">( </span><span class="default">$variable </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$variable </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$variable</span><span class="keyword">[ </span><span class="default">$i </span><span class="keyword">] = </span><span class="default">add_slashes_recursive</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">) ;<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$variable </span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">strip_slashes_recursive</span><span class="keyword">( </span><span class="default">$variable </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">is_string</span><span class="keyword">( </span><span class="default">$variable </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">stripslashes</span><span class="keyword">( </span><span class="default">$variable </span><span class="keyword">) ;<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">is_array</span><span class="keyword">( </span><span class="default">$variable </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$variable </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$variable</span><span class="keyword">[ </span><span class="default">$i </span><span class="keyword">] = </span><span class="default">strip_slashes_recursive</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">) ;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$variable </span><span class="keyword">; <br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89819""></a>
  <div class="note">
   <strong class="user">dragon[dot]dionysius[at]gmail[dot]com</strong>
   <a href="#89819" class="date">24-Mar-2009 05:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use this function in my class to stripslashes arrays including NULL-check:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private function </span><span class="default">stripslashes_deep</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$value </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">stripslashes_deep</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } elseif(isset(</span><span class="default">$value</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89785""></a>
  <div class="note">
   <strong class="user">Tom Worster</strong>
   <a href="#89785" class="date">23-Mar-2009 04:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A replacement that should be safe on utf-8 strings.<br />
<span class="default">&lt;?php<br />
&nbsp; preg_replace</span><span class="keyword">(array(</span><span class="string">'/\x5C(?!\x5C)/u'</span><span class="keyword">, </span><span class="string">'/\x5C\x5C/u'</span><span class="keyword">), array(</span><span class="string">''</span><span class="keyword">,</span><span class="string">'\\'</span><span class="keyword">), </span><span class="default">$s</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89687""></a>
  <div class="note">
   <strong class="user">o-zone at zerozone dot it</strong>
   <a href="#89687" class="date">19-Mar-2009 12:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need to remove all slashes from a string, here's a quick hack:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">stripallslashes</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">strchr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="string">'\\'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope it's usefull , O-Zone</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82831""></a>
  <div class="note">
   <strong class="user">techdesk100</strong>
   <a href="#82831" class="date">28-Apr-2008 04:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Function which checks if $input has correct slashes,<br />
otherwise adds slashes. For cases when you are not sure the input is not already addslashed.<br />
<br />
&nbsp;&nbsp;&nbsp; public function addslashes_once($input){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //These characters are single quote ('), double quote ("), backslash (\) and NUL (the NULL byte).<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $pattern = array("\\'", "\\\"", "\\\\", "\\0");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $replace = array("", "", "", "");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(preg_match("/[\\\\'\"\\0]/", str_replace($pattern, $replace, $input))){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return addslashes($input);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $input;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82121""></a>
  <div class="note">
   <strong class="user">Aditya P Bhatt (adityabhai at gmail dot com)</strong>
   <a href="#82121" class="date">28-Mar-2008 07:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is simple example code which you can use as a common function in your functions file:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">stripslashes_if_gpc_magic_quotes</span><span class="keyword">( </span><span class="default">$string </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">get_magic_quotes_gpc</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81402""></a>
  <div class="note">
   <strong class="user">Evgeny</strong>
   <a href="#81402" class="date">26-Feb-2008 04:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
extended version of stripslashes_deep. This allow to strip one also in the array_keys<br />
<br />
&nbsp;&nbsp;&nbsp; function stripslashes_deep($value) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (is_array($value)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (count($value)&gt;0) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $return = array_combine(array_map('stripslashes_deep', array_keys($value)),array_map('stripslashes_deep', array_values($value)));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $return = array_map('stripslashes_deep', $value);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $return;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $return = stripslashes($value);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $return ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79976""></a>
  <div class="note">
   <strong class="user">alex dot launi at gmail dot com</strong>
   <a href="#79976" class="date">21-Dec-2007 04:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
kibby: I modified the stripslashes_deep() function so that I could use it on NULL values.<br />
<br />
function stripslashes_deep($value)<br />
{<br />
&nbsp;&nbsp;&nbsp; if(isset($value)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $value = is_array($value) ?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array_map('stripslashes_deep', $value) :<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; stripslashes($value);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $value;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75887""></a>
  <div class="note">
   <strong class="user">lukas.skowronski at gmail dot com</strong>
   <a href="#75887" class="date">20-Jun-2007 01:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If You want to delete all slashes from any table try to use my function:<br />
<br />
function no_slashes($array)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach($array as $key=&gt;$value)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(is_array($value))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value=no_slashes($value);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $array_temp[$key]=$value;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $array_temp[$key]=stripslashes($value);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $array_temp;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73820""></a>
  <div class="note">
   <strong class="user">dragonfly at networkinsight dot net</strong>
   <a href="#73820" class="date">12-Mar-2007 12:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having trouble with stripslashes() corrupting binary data, try using urlencode() and urldecode() instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73658""></a>
  <div class="note">
   <strong class="user">JAB Creations</strong>
   <a href="#73658" class="date">06-Mar-2007 05:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When writing to a flatfile such as an HTML page you'll notice slashes being inserted. When you write to that page it's interesting how to apply stripslashes...<br />
<br />
I replaced this line...<br />
<span class="default">&lt;?php fwrite</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'textarea'</span><span class="keyword">]); </span><span class="default">?&gt;<br />
</span><br />
With...<br />
<span class="default">&lt;?php </span><span class="keyword">if (</span><span class="default">get_magic_quotes_gpc</span><span class="keyword">()) {</span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'textarea'</span><span class="keyword">]));}</span><span class="default">?&gt;<br />
</span><br />
You have to directly apply stripslashes to $_POST, $_GET, $_REQUEST, and $_COOKIE.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73418""></a>
  <div class="note">
   <strong class="user">gregory at nutt dot ca</strong>
   <a href="#73418" class="date">22-Feb-2007 03:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is code I use to clean the results from a MySQL query using the stripslashes function.<br />
<br />
I do it by passing the sql result and the sql columns to the function strip_slashes_mysql_results.&nbsp; This way, my data is already clean by the time I want to use it.<br />
<br />
&nbsp;&nbsp;&nbsp; function db_query($querystring, $array, $columns)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (!$this-&gt;connect_to_mysql())<br />
&nbsp;&nbsp; &nbsp; &nbsp; return 0;<br />
<br />
&nbsp;&nbsp; &nbsp; $queryresult = mysql_query($querystring, $this-&gt;link)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; or die("Invalid query: " . mysql_error());<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; if(mysql_num_rows($queryresult))<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $columns = mysql_field_names ($queryresult);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if($array)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while($row = mysql_fetch_row($queryresult))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $row_meta[] = $this-&gt;strip_slashes_mysql_results($row, $columns);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $row_meta;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while($row = mysql_fetch_object($queryresult))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $row_meta[] = $this-&gt;strip_slashes_mysql_results($row, $columns);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $row_meta;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return 0;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function strip_slashes_mysql_results($result, $columns)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach($columns as $column)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if($this-&gt;debug)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; printp(sprintf("strip_slashes_mysql_results: %s",strip_slashes_mysql_results));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result-&gt;$column = stripslashes($result-&gt;$column);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $result;<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72094""></a>
  <div class="note">
   <strong class="user">stoic</strong>
   <a href="#72094" class="date">02-Jan-2007 05:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
in response to crab dot crab at gmail dot com:<br />
<br />
$value need not be passed by reference. The 'stripped' value is returned. The passed value is not altered.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66081""></a>
  <div class="note">
   <strong class="user">Kibby</strong>
   <a href="#66081" class="date">14-May-2006 10:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Okay, if using stripslashes_deep, it will definitely replace any NULL to "".&nbsp; This will affect to coding that depends isset().&nbsp; Please provide a workaround based on recent note.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62146""></a>
  <div class="note">
   <strong class="user">hauser dot j at gmail dot com</strong>
   <a href="#62146" class="date">21-Feb-2006 11:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't use stripslashes if you depend on the values NULL.<br />
<br />
Apparently stripslashes converts NULL to string(0) "" <br />
<br />
<span class="default">&lt;?php<br />
$a </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Will output<br />
<br />
NULL<br />
string(0) ""</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58159""></a>
  <div class="note">
   <strong class="user">alf at mitose dot net</strong>
   <a href="#58159" class="date">26-Oct-2005 02:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Take care using stripslashes() if the text you want to insert in the database contain \n characters ! You'll see "n" instead of (not seeing) "\n".<br />
<br />
It should be no problem for XML, but is still boring ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49858""></a>
  <div class="note">
   
   <a href="#49858" class="date">10-Feb-2005 04:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to deal with slashes in double-byte encodings, such as shift_jis or big5, you may use this:<br />
<br />
&lt;?<br />
function stripslashes2($string) {<br />
&nbsp;&nbsp;&nbsp; $string = str_replace("\\\"", "\"", $string);<br />
&nbsp;&nbsp;&nbsp; $string = str_replace("\\'", "'", $string);<br />
&nbsp;&nbsp;&nbsp; $string = str_replace("\\\\", "\\", $string);<br />
&nbsp;&nbsp;&nbsp; return $string;<br />
}<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45556""></a>
  <div class="note">
   <strong class="user">mattyblah at gmail dot com</strong>
   <a href="#45556" class="date">10-Sep-2004 05:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be of note that if you are stripping slashes to get rid of the slashes added by magic_quotes_gpc then it will also remove slashes from \. This may not seem that bad but if you have someone enter text such as 'testing\' with a slash at the end, this will cause an error if not corrected. It's best to strip the slashes, then add a slash to every single slash using $text = str_replace('\\', '\\\\', $text);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37876""></a>
  <div class="note">
   <strong class="user">hash at samurai dot fm</strong>
   <a href="#37876" class="date">01-Dec-2003 06:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Might I warn readers that they should be vary careful with the use of stripslashes on Japanese text. The shift_jis character set includes a number of two-byte code charcters that contain the hex-value 0x5c (backslash) which will get stripped by this function thus garbling those characters.<br />
<br />
What a nightmare!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.stripos.html">stripos</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.stristr.html">stristr</a></div>
 <div class="up"><a href="ref.strings.html">String 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
