<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>指定されたパスのファイルとディレクトリのリストを取得する</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.rewinddir.html">rewinddir</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="book.fileinfo.html">Fileinfo</a></div>
 <div class="up"><a href="ref.dir.html">ディレクトリ 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.scandir" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">scandir</h1>
  <p class="verinfo">(PHP 5)</p><p class="refpurpose"><span class="refname">scandir</span> &mdash; <span class="dc-title">
   指定されたパスのファイルとディレクトリのリストを取得する
  </span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.scandir-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>scandir</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$directory</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$sorting_order</code><span class="initializer"> = SCANDIR_SORT_ASCENDING</span></span>
   [, <span class="methodparam"><span class="type">resource</span> <code class="parameter">$context</code></span>
  ]] )</div>

  <p class="para rdfs-comment">
   <em><code class="parameter">directory</code></em> 内のファイルおよびディレクトリを
   配列で返します。
  </p>

 </div>


 <div class="refsect1 parameters" id="refsect1-function.scandir-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><em><code class="parameter">directory</code></em></span>
     <dd>

      <p class="para">
       調べるディレクトリ。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">sorting_order</code></em></span>
     <dd>

      <p class="para">
       デフォルトでは、ソート順はアルファベット昇順です。
       オプションの <em><code class="parameter">sorting_order</code></em>
       に <strong><code>SCANDIR_SORT_DESCENDING</code></strong> を設定した場合、
       ソート順はアルファベット降順になります。
       <strong><code>SCANDIR_SORT_NONE</code></strong> を設定すると、
       結果をソートせずに返します。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">context</code></em></span>
     <dd>

      <p class="para">
       <em><code class="parameter">context</code></em> パラメータの説明については、
       マニュアルの<a href="ref.stream.html" class="link">ストリーム</a>
       を参照ください。
      </p> 
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.scandir-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合にファイル名の配列、失敗した場合に <strong><code>FALSE</code></strong> を返します。
   <em><code class="parameter">directory</code></em> がディレクトリではない場合は、
   <strong><code>FALSE</code></strong> を返し、<strong><code>E_WARNING</code></strong> レベルのエラーを
   発行します。
  </p> 
 </div>


 <div class="refsect1 changelog" id="refsect1-function.scandir-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.4.0</td>
       <td>
        <em><code class="parameter">sorting_order</code></em> <a href="dir.constants.html" class="link">定数</a>
        が追加されました。これまでのバージョンでは、非ゼロの値を指定するとすべて降順となっていました。
        つまり、PHP のバージョンにかかわらず、次のようになります。
        <em>0</em> を指定すれば昇順、<em>1</em> を指定すれば降順。
        <strong><code>SCANDIR_SORT_NONE</code></strong> に対応する設定は、PHP 5.4.0 より前のバージョンにはありません。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.scandir-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-2332">
    <p><strong>例1  <span class="function"><strong>scandir()</strong></span> の簡単な例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$dir&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'/tmp'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$files1&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">scandir</span><span style="color: #007700">(</span><span style="color: #0000BB">$dir</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$files2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">scandir</span><span style="color: #007700">(</span><span style="color: #0000BB">$dir</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$files1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$files2</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は、
たとえば以下のようになります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [0] =&gt; .
    [1] =&gt; ..
    [2] =&gt; bar.php
    [3] =&gt; foo.txt
    [4] =&gt; somedir
)
Array
(
    [0] =&gt; somedir
    [1] =&gt; foo.txt
    [2] =&gt; bar.php
    [3] =&gt; ..
    [4] =&gt; .
)
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2333">
    <p><strong>例2 PHP 4 での  <span class="function"><strong>scandir()</strong></span> の代用方法</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$dir&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"/tmp"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$dh&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">opendir</span><span style="color: #007700">(</span><span style="color: #0000BB">$dir</span><span style="color: #007700">);<br />while&nbsp;(</span><span style="color: #0000BB">false&nbsp;</span><span style="color: #007700">!==&nbsp;(</span><span style="color: #0000BB">$filename&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">readdir</span><span style="color: #007700">(</span><span style="color: #0000BB">$dh</span><span style="color: #007700">)))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$files</span><span style="color: #007700">[]&nbsp;=&nbsp;</span><span style="color: #0000BB">$filename</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">sort</span><span style="color: #007700">(</span><span style="color: #0000BB">$files</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$files</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">rsort</span><span style="color: #007700">(</span><span style="color: #0000BB">$files</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$files</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は、
たとえば以下のようになります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [0] =&gt; .
    [1] =&gt; ..
    [2] =&gt; bar.php
    [3] =&gt; foo.txt
    [4] =&gt; somedir
)
Array
(
    [0] =&gt; somedir
    [1] =&gt; foo.txt
    [2] =&gt; bar.php
    [3] =&gt; ..
    [4] =&gt; .
)
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.scandir-notes">
  <h3 class="title">注意</h3>
  <div class="tip"><strong class="tip">ヒント</strong><p class="simpara"><a href="filesystem.configuration.html#ini.allow-url-fopen" class="link">fopen wrappers</a> が有効の場合、この関数のファイル名として
URL を使用することができます。ファイル名の指定方法に関する詳細は
 <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span> を参照ください。
<a href="wrappers.html" class="xref">サポートするプロトコル/ラッパー</a> には、さまざまなラッパーの機能やその使用法、
提供される定義済み変数などの情報がまとめられています。</p></div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.scandir-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"> <span class="function"><a href="function.opendir.html" class="function" rel="rdfs-seeAlso">opendir()</a> - ディレクトリハンドルをオープンする</span></li>
    <li class="member"> <span class="function"><a href="function.readdir.html" class="function" rel="rdfs-seeAlso">readdir()</a> - ディレクトリハンドルからエントリを読み込む</span></li>
    <li class="member"> <span class="function"><a href="function.glob.html" class="function" rel="rdfs-seeAlso">glob()</a> - パターンにマッチするパス名を探す</span></li>
    <li class="member"> <span class="function"><a href="function.is-dir.html" class="function" rel="rdfs-seeAlso">is_dir()</a> - ファイルがディレクトリかどうかを調べる</span></li>
    <li class="member"> <span class="function"><a href="function.sort.html" class="function" rel="rdfs-seeAlso">sort()</a> - 配列をソートする</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113773""></a>
  <div class="note">
   <strong class="user">arfon at cradur dot com</strong>
   <a href="#113773" class="date">29-Nov-2013 09:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Care needed going from PHP 5.3 to 5.4, as the constant SCANDIR_SORT_DESCENDING is only defined from 5.4.<br />
<br />
I had previously been using literal, i.e. scandir($targetDir,2) in 5.3, but this did not give desired result in 5.4 (Ascending is default). However when I used SCANDIR_SORT_DESCENDING which is not defined in 5.3,&nbsp; on my web host (still on 5.3) I got error - second argument assumed to be a string.<br />
<br />
My solution (very primitive):<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $sort_desc = defined('SCANDIR_SORT_DESCENDING') ? <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; SCANDIR_SORT_DESCENDING : 2;<br />
&nbsp;&nbsp; &nbsp;&nbsp; $infiles = scandir($targetDir, $sort_desc);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113254""></a>
  <div class="note">
   <strong class="user">faruk at pamukbilisim dot com</strong>
   <a href="#113254" class="date">18-Sep-2013 09:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Directory Name<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">= </span><span class="string">"messages"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Directory Control<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if ( !</span><span class="default">is_dir</span><span class="keyword">( </span><span class="default">$dir </span><span class="keyword">) ) { die( </span><span class="string">"File &lt;b&gt;\" </span><span class="keyword">{</span><span class="default">$dir</span><span class="keyword">}</span><span class="string"> \"&lt;/b&gt; Not Found" </span><span class="keyword">); }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Optional<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">chmod</span><span class="keyword">( </span><span class="default">$dir</span><span class="keyword">, </span><span class="string">"0777" </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Print<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">scandir</span><span class="keyword">( </span><span class="default">$dir </span><span class="keyword">. </span><span class="string">"/" </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113167""></a>
  <div class="note">
   <strong class="user">hex at mail dot nnov dot ru</strong>
   <a href="#113167" class="date">08-Sep-2013 04:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
// Extreme minimal version recursive scan:<br />
function rscandir($dir){<br />
&nbsp; $dirs = array_fill_keys( array_diff( scandir( $dir ), array( '.', '..' ) ), array());<br />
&nbsp; foreach( $dirs as $d =&gt; $v )<br />
&nbsp;&nbsp;&nbsp; if( is_dir($dir."/".$d) )<br />
&nbsp;&nbsp; &nbsp;&nbsp; $dirs[$d] = rscandir($dir."/".$d);<br />
&nbsp; return $dirs;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112255""></a>
  <div class="note">
   <strong class="user">holdoffhunger at gmail dot com</strong>
   <a href="#112255" class="date">24-May-2013 09:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you would like to use scandir on the root directory of your server, you would imagine the command to be either scandir("") or scandir("/"), but neither work.&nbsp; However, scandir(".") works perfectly.&nbsp; Use scandir("/") and scandir("..") to poke around the Linuxy areas of your webhost.&nbsp; At least, these are the observations I've made with my own webhost when it comes to root directory scandir.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112244""></a>
  <div class="note">
   <strong class="user">mirthenemrys at gmail dot com</strong>
   <a href="#112244" class="date">22-May-2013 04:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This method would leave the file system vulnerable using ../ for the ?dir= A person could navigate any readable file system simply by adding ../ enough times to get back to the root of the drive.<br />
<br />
On a proper secure system this might not matter, however for less secure file systems where the web user(apache user) can at least read most files, or on multi-user web servers this could lead to potential security risks.<br />
<br />
Adding a check to see if ../ is in the&nbsp; $_GET["dir"] is one way to prevent this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112156""></a>
  <div class="note">
   <strong class="user">era_esteban at hotmail dot com</strong>
   <a href="#112156" class="date">11-May-2013 12:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
# Hacer hash&nbsp; de estructura de directorio<br />
<br />
$print_dir = "SOME DIR TO EXPLORE";<br />
<br />
$parentDir=array();<br />
myScandir($parentDir,$print_dir);<br />
print_r ($parentDir);<br />
<br />
function myScandir(&amp;$parentDir,$actual_dir){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $scanDir = scandir($actual_dir);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for ($i=0;$i&lt;count($scanDir);$i++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($scanDir[$i] == '.svn' || $scanDir[$i] == '.' || $scanDir[$i] == '..' ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (is_file($actual_dir.'/'.$scanDir[$i])){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $file = $scanDir[$i];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array_push($parentDir,$file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } elseif (is_dir($actual_dir.'/'.$scanDir[$i])){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $dir =&nbsp; $scanDir[$i];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $parentDir[$dir]=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; myScandir( $parentDir[$dir] , "$actual_dir/$dir" );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return true;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110570""></a>
  <div class="note">
   <strong class="user">mmda dot nl at gmail dot com</strong>
   <a href="#110570" class="date">08-Nov-2012 09:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is my 2 cents. I wanted to create an array of my directory structure recursively. I wanted to easely access data in a certain directory using foreach. I came up with the following:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">dirToArray</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) {<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp; </span><span class="default">$cdir </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; foreach (</span><span class="default">$cdir </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">,array(</span><span class="string">"."</span><span class="keyword">,</span><span class="string">".."</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">$value</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$value</span><span class="keyword">] = </span><span class="default">dirToArray</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; } <br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Output<br />
Array<br />
(<br />
&nbsp;&nbsp; [subdir1] =&gt; Array<br />
&nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp;&nbsp; [0] =&gt; file1.txt<br />
&nbsp;&nbsp; &nbsp;&nbsp; [subsubdir] =&gt; Array<br />
&nbsp;&nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; file2.txt<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; file3.txt<br />
&nbsp;&nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; )<br />
&nbsp;&nbsp; [subdir2] =&gt; Array<br />
&nbsp;&nbsp; (<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; file4.txt<br />
&nbsp;&nbsp; }<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109140""></a>
  <div class="note">
   <strong class="user">carneiro at isharelife dot com dot br</strong>
   <a href="#109140" class="date">23-Jun-2012 03:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Get an array that represents directory tree<br />
&nbsp;&nbsp; &nbsp; * @param string $directory&nbsp; &nbsp;&nbsp; Directory path<br />
&nbsp;&nbsp; &nbsp; * @param bool $recursive&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Include sub directories<br />
&nbsp;&nbsp; &nbsp; * @param bool $listDirs&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Include directories on listing<br />
&nbsp;&nbsp; &nbsp; * @param bool $listFiles&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Include files on listing<br />
&nbsp;&nbsp; &nbsp; * @param regex $exclude&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Exclude paths that matches this regex<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">directoryToArray</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">, </span><span class="default">$recursive </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">, </span><span class="default">$listDirs </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$listFiles </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">, </span><span class="default">$exclude </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arrayItems </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$skipByExclude </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$handle</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/(^(([\.]){1,2})$|(\.(svn|git|md))|(Thumbs\.db|\.DS_STORE))$/iu"</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$skip</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$exclude</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$exclude</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$skipByExclude</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$skip </span><span class="keyword">&amp;&amp; !</span><span class="default">$skipByExclude</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$recursive</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arrayItems </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$arrayItems</span><span class="keyword">, </span><span class="default">directoryToArray</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$recursive</span><span class="keyword">, </span><span class="default">$listDirs</span><span class="keyword">, </span><span class="default">$listFiles</span><span class="keyword">, </span><span class="default">$exclude</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$listDirs</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$directory </span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arrayItems</span><span class="keyword">[] = </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$listFiles</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$directory </span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arrayItems</span><span class="keyword">[] = </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$arrayItems</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109115""></a>
  <div class="note">
   <strong class="user">2bbasic at gmail dot com</strong>
   <a href="#109115" class="date">21-Jun-2012 08:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">//-- Directory Navigation with SCANDIR<br />
//-- <br />
//-- optional placemenet<br />
</span><span class="default">$exclude_list </span><span class="keyword">= array(</span><span class="string">"."</span><span class="keyword">, </span><span class="string">".."</span><span class="keyword">, </span><span class="string">"example.txt"</span><span class="keyword">);<br />
if (isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">"dir"</span><span class="keyword">])) {<br />
&nbsp; </span><span class="default">$dir_path </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">"DOCUMENT_ROOT"</span><span class="keyword">].</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">"dir"</span><span class="keyword">];<br />
}<br />
else {<br />
&nbsp; </span><span class="default">$dir_path </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">"DOCUMENT_ROOT"</span><span class="keyword">].</span><span class="string">"/"</span><span class="keyword">;<br />
}<br />
</span><span class="comment">//-- until here<br />
</span><span class="keyword">function </span><span class="default">dir_nav</span><span class="keyword">() {<br />
&nbsp; global </span><span class="default">$exclude_list</span><span class="keyword">, </span><span class="default">$dir_path</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$directories </span><span class="keyword">= </span><span class="default">array_diff</span><span class="keyword">(</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir_path</span><span class="keyword">), </span><span class="default">$exclude_list</span><span class="keyword">);<br />
&nbsp; echo </span><span class="string">"&lt;ul style='list-style:none;padding:0'&gt;"</span><span class="keyword">;<br />
&nbsp; foreach(</span><span class="default">$directories </span><span class="keyword">as </span><span class="default">$entry</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir_path</span><span class="keyword">.</span><span class="default">$entry</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;li style='margin-left:1em;'&gt;[`] &lt;a href='?dir="</span><span class="keyword">.</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">"dir"</span><span class="keyword">].</span><span class="default">$entry</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="string">"'&gt;"</span><span class="keyword">.</span><span class="default">$entry</span><span class="keyword">.</span><span class="string">"&lt;/a&gt;&lt;/li&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; echo </span><span class="string">"&lt;/ul&gt;"</span><span class="keyword">;<br />
&nbsp; </span><span class="comment">//-- separator<br />
&nbsp; </span><span class="keyword">echo </span><span class="string">"&lt;ul style='list-style:none;padding:0'&gt;"</span><span class="keyword">;<br />
&nbsp; foreach(</span><span class="default">$directories </span><span class="keyword">as </span><span class="default">$entry</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$dir_path</span><span class="keyword">.</span><span class="default">$entry</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;li style='margin-left:1em;'&gt;[ ] &lt;a href='?file="</span><span class="keyword">.</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">"dir"</span><span class="keyword">].</span><span class="default">$entry</span><span class="keyword">.</span><span class="string">"'&gt;"</span><span class="keyword">.</span><span class="default">$entry</span><span class="keyword">.</span><span class="string">"&lt;/a&gt;&lt;/li&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; echo </span><span class="string">"&lt;/ul&gt;"</span><span class="keyword">;<br />
}<br />
</span><span class="default">dir_nav</span><span class="keyword">();<br />
</span><span class="comment">//-- optional placement<br />
</span><span class="keyword">if (isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">"file"</span><span class="keyword">])) {<br />
&nbsp; echo </span><span class="string">"&lt;div style='margin:1em;border:1px solid Silver;'&gt;"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$dir_path</span><span class="keyword">.</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">]);<br />
&nbsp; echo </span><span class="string">"&lt;/div&gt;"</span><span class="keyword">;<br />
}<br />
</span><span class="comment">//-- until here<br />
//--<br />
//-- Because I love php.net<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108229""></a>
  <div class="note">
   <strong class="user">fazle dot elahee at gmail dot com</strong>
   <a href="#108229" class="date">10-Apr-2012 03:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
/**<br />
&nbsp;* This function will scan all files recursively in the sub-folder and folder.<br />
&nbsp;*<br />
&nbsp;* @author Fazle Elahee<br />
&nbsp;*<br />
&nbsp;*/<br />
<br />
function scanFileNameRecursivly($path = '', &amp;$name = array() )<br />
{<br />
&nbsp; $path = $path == ''? dirname(__FILE__) : $path;<br />
&nbsp; $lists = @scandir($path);<br />
&nbsp; <br />
&nbsp; if(!empty($lists))<br />
&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; foreach($lists as $f)<br />
&nbsp;&nbsp; &nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; if(is_dir($path.DIRECTORY_SEPARATOR.$f) &amp;&amp; $f != ".." &amp;&amp; $f != ".")<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; scanFileNameRecursivly($path.DIRECTORY_SEPARATOR.$f, &amp;$name); <br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $name[] = $path.DIRECTORY_SEPARATOR.$f;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; return $name;<br />
}<br />
<br />
$path = "/var/www/SimplejQueryDropdowns";<br />
$file_names = scanFileNameRecursivly($path);<br />
<br />
echo "&lt;pre&gt;";<br />
var_dump($file_names);<br />
echo "&lt;/pre&gt;";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107215""></a>
  <div class="note">
   <strong class="user">dwieeb at gmail dot com</strong>
   <a href="#107215" class="date">22-Jan-2012 05:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Easy way to get rid of the dots that scandir() picks up in Linux environments:<br />
<br />
<span class="default">&lt;?php<br />
$directory </span><span class="keyword">= </span><span class="string">'/path/to/my/directory'</span><span class="keyword">;<br />
</span><span class="default">$scanned_directory </span><span class="keyword">= </span><span class="default">array_diff</span><span class="keyword">(</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">), array(</span><span class="string">'..'</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107117""></a>
  <div class="note">
   <strong class="user">kodlee at kodleeshare dot net</strong>
   <a href="#107117" class="date">09-Jan-2012 12:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed to find a way to get the full path of all files in the directory and all subdirectories of a directory.<br />
Here's my solution: Recursive functions!<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">find_all_files</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$root </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$root </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$value </span><span class="keyword">=== </span><span class="string">'.' </span><span class="keyword">|| </span><span class="default">$value </span><span class="keyword">=== </span><span class="string">'..'</span><span class="keyword">) {continue;}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="string">"</span><span class="default">$dir</span><span class="string">/</span><span class="default">$value</span><span class="string">"</span><span class="keyword">)) {</span><span class="default">$result</span><span class="keyword">[]=</span><span class="string">"</span><span class="default">$dir</span><span class="string">/</span><span class="default">$value</span><span class="string">"</span><span class="keyword">;continue;}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">find_all_files</span><span class="keyword">(</span><span class="string">"</span><span class="default">$dir</span><span class="string">/</span><span class="default">$value</span><span class="string">"</span><span class="keyword">) as </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[]=</span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104150""></a>
  <div class="note">
   <strong class="user">Gerjoo at gmail dot com</strong>
   <a href="#104150" class="date">26-May-2011 08:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you wish to sort by folders first then files, you could use something like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">scandirSorted</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sortedData </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$sortedData</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_unshift</span><span class="keyword">(</span><span class="default">$sortedData</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$sortedData</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
NB.: This approach *might* be suboptimal for high performance situations.<br />
<br />
- Gerard</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101094""></a>
  <div class="note">
   <strong class="user">robin leffmann</strong>
   <a href="#101094" class="date">25-Nov-2010 09:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that scandir() will enforce alphanumerical sorting on the array it returns. If you wish to reduce CPU overhead by avoiding the sorting, or if you wish to obtain "natural filesystem order" - that is, the order in which the files are found while traversing the filesystem (usually the order in which they were written to the disk) - you need to go back to the PHP4 equivalent of opendir() + readdir().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96326""></a>
  <div class="note">
   <strong class="user">boen dot robot at gmail dot com</strong>
   <a href="#96326" class="date">20-Feb-2010 07:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have a folder with many files and/or subfolders, doing a recursive scandir will likely either slow down your application, or cause a high rise in RAM consumption due to the large size of the generated array.<br />
<br />
To help with this, as well as to make processing of files in a folder easier, I wrote a function that reads a folder and its subfolders recursively, and calls a function upon each match.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Calls a function for every file in a folder.<br />
&nbsp;*<br />
&nbsp;* @author Vasil Rangelov a.k.a. boen_robot<br />
&nbsp;*<br />
&nbsp;* @param string $callback The function to call. It must accept one argument that is a relative filepath of the file.<br />
&nbsp;* @param string $dir The directory to traverse.<br />
&nbsp;* @param array $types The file types to call the function for. Leave as NULL to match all types.<br />
&nbsp;* @param bool $recursive Whether to list subfolders as well.<br />
&nbsp;* @param string $baseDir String to append at the beginning of every filepath that the callback will receive.<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">dir_walk</span><span class="keyword">(</span><span class="default">$callback</span><span class="keyword">, </span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$types </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$recursive </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$baseDir </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$dh </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">=== </span><span class="string">'.' </span><span class="keyword">|| </span><span class="default">$file </span><span class="keyword">=== </span><span class="string">'..'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$types</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">pathinfo</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">, </span><span class="default">PATHINFO_EXTENSION</span><span class="keyword">)), </span><span class="default">$types</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$callback</span><span class="keyword">(</span><span class="default">$baseDir </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }elseif(</span><span class="default">$recursive </span><span class="keyword">&amp;&amp; </span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">dir_walk</span><span class="keyword">(</span><span class="default">$callback</span><span class="keyword">, </span><span class="default">$dir </span><span class="keyword">. </span><span class="default">$file </span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$types</span><span class="keyword">, </span><span class="default">$recursive</span><span class="keyword">, </span><span class="default">$baseDir </span><span class="keyword">. </span><span class="default">$file </span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Of course, because it is recursive, a folder with many levels of folders could potentially consume lots of memory, but then again, so can every other recursive scandir implementation here.<br />
<br />
BTW, there's also the RecursiveDirectoryIterator SPL class:<br />
<a href="http://bg.php.net/manual/en/class.recursivedirectoryiterator.php" rel="nofollow" target="_blank">http://bg.php.net/manual/en/class.recursivedirectoryiterator.php</a><br />
which, even if using the same approach, will most likely be faster and hold down deeper levels (because it works on the C level), but this one will always work, regardless of settings... even on PHP4.<br />
<br />
Point is, avoid recursive scandir implementations.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96140""></a>
  <div class="note">
   <strong class="user">franzemmanuel at gmail dot com</strong>
   <a href="#96140" class="date">10-Feb-2010 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Scandir does not work properly with non-english caracters (like french accents for example : éàçè...) in the files name.<br />
As PHP does not support unicode operations until PHP 6, this is not a bug.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95913""></a>
  <div class="note">
   <strong class="user">moik78 at gmail dot com</strong>
   <a href="#95913" class="date">28-Jan-2010 02:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a function to count the number of files of a directory<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">countFiles</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$directory </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">$item </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// We filter the elements that we don't want to appear ".", ".." and ".svn" <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if((</span><span class="default">$item </span><span class="keyword">!= </span><span class="string">"."</span><span class="keyword">) &amp;&amp; (</span><span class="default">$item </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">) &amp;&amp; (</span><span class="default">$item </span><span class="keyword">!= </span><span class="string">".svn"</span><span class="keyword">) ){ <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[] = </span><span class="default">$item</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; } <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$numFiles </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$numFiles</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95588""></a>
  <div class="note">
   <strong class="user">phpnet at novaclic dot com</strong>
   <a href="#95588" class="date">11-Jan-2010 11:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Was looking for a simple way to search for a file/directory using a mask. Here is such a function.<br />
<br />
By default, this function will keep in memory the scandir() result, to avoid scaning multiple time for the same directory.<br />
<br />
Requires at least PHP5.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">sdir</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">=</span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$mask</span><span class="keyword">=</span><span class="string">'*'</span><span class="keyword">, </span><span class="default">$nocache</span><span class="keyword">=</span><span class="default">0 </span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$dir </span><span class="keyword">= array(); </span><span class="comment">// cache result in memory<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if ( !isset(</span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$path</span><span class="keyword">]) || </span><span class="default">$nocache</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$path</span><span class="keyword">] = </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$path</span><span class="keyword">] as </span><span class="default">$i</span><span class="keyword">=&gt;</span><span class="default">$entry</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$entry</span><span class="keyword">!=</span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$entry</span><span class="keyword">!=</span><span class="string">'..' </span><span class="keyword">&amp;&amp; </span><span class="default">fnmatch</span><span class="keyword">(</span><span class="default">$mask</span><span class="keyword">, </span><span class="default">$entry</span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sdir</span><span class="keyword">[] = </span><span class="default">$entry</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$sdir</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91380""></a>
  <div class="note">
   <strong class="user">magicmind at netcabo dot pt</strong>
   <a href="#91380" class="date">09-Jun-2009 02:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello all,<br />
<br />
I just added a extension filter to the getDirectoryTree function, so it can filter an extension for files in the folders/subfolders:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getDirectoryTree</span><span class="keyword">( </span><span class="default">$outerDir </span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">){ <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">array_diff</span><span class="keyword">( </span><span class="default">scandir</span><span class="keyword">( </span><span class="default">$outerDir </span><span class="keyword">), Array( </span><span class="string">"."</span><span class="keyword">, </span><span class="string">".." </span><span class="keyword">) ); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir_array </span><span class="keyword">= Array(); <br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$dirs </span><span class="keyword">as </span><span class="default">$d </span><span class="keyword">){ <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$outerDir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$d</span><span class="keyword">)&nbsp; ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir_array</span><span class="keyword">[ </span><span class="default">$d </span><span class="keyword">] = </span><span class="default">getDirectoryTree</span><span class="keyword">( </span><span class="default">$outerDir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$d </span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if ((</span><span class="default">$x</span><span class="keyword">)?</span><span class="default">ereg</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">.</span><span class="string">'$'</span><span class="keyword">,</span><span class="default">$d</span><span class="keyword">):</span><span class="default">1</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir_array</span><span class="keyword">[ </span><span class="default">$d </span><span class="keyword">] = </span><span class="default">$d</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$dir_array</span><span class="keyword">; <br />
} <br />
<br />
</span><span class="default">$dirlist </span><span class="keyword">= </span><span class="default">getDirectoryTree</span><span class="keyword">(</span><span class="string">'filmes'</span><span class="keyword">,</span><span class="string">'flv'</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90628""></a>
  <div class="note">
   <strong class="user">phpdotnet at lavavortex dot com</strong>
   <a href="#90628" class="date">01-May-2009 02:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How a ninja may retrieve a list of files, files filtered by extension, or directories:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//NNNIIIinnnjaaa::<br />
//array of files without directories... optionally filtered by extension<br />
</span><span class="keyword">function </span><span class="default">file_list</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; foreach(</span><span class="default">array_diff</span><span class="keyword">(</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">),array(</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">'..'</span><span class="keyword">)) as </span><span class="default">$f</span><span class="keyword">)if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$f</span><span class="keyword">)&amp;&amp;((</span><span class="default">$x</span><span class="keyword">)?</span><span class="default">ereg</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">.</span><span class="string">'$'</span><span class="keyword">,</span><span class="default">$f</span><span class="keyword">):</span><span class="default">1</span><span class="keyword">))</span><span class="default">$l</span><span class="keyword">[]=</span><span class="default">$f</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$l</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">//NNNIIIinnnjaaa::<br />
//array of directories<br />
</span><span class="keyword">function </span><span class="default">dir_list</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; foreach(</span><span class="default">array_diff</span><span class="keyword">(</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">),array(</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">'..'</span><span class="keyword">)) as </span><span class="default">$f</span><span class="keyword">)if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$f</span><span class="keyword">))</span><span class="default">$l</span><span class="keyword">[]=</span><span class="default">$f</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$l</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">/********************************************************************\<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; PRETTY PRETTY LIGHTS (DOCUMENTATION)<br />
\********************************************************************/<br />
<br />
/********************************************************************<br />
Overloaded PHP file listing function:<br />
array file_list ( string $directory [, string $file_extension] )<br />
<br />
$directory<br />
&nbsp; path without backslash, e.g. "/home/public_html/blarg"<br />
<br />
$file_extention<br />
&nbsp; optionally filter specific filename extentions, e.g. ".jpg"<br />
<br />
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; TRANSLATION &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />
file_list("/home");&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //return list of files (no directories)<br />
file_list("/home", ".jpg");&nbsp; //return only .jpg file list<br />
\********************************************************************/<br />
<br />
//(note: one slash (/) below and you enable all your test functions, guess where ;-))<br />
/********************************************************************\<br />
// TEST FUNCTIONS... IF THESE WORK, THIS FUNCTION WORKS ON THIS PLATFORM<br />
echo "&lt;hr&gt;&lt;b&gt;File List:&lt;/b&gt;&lt;br&gt;";<br />
$n = file_list(getcwd());<br />
if($n) foreach($n as $f) echo "$f&lt;br&gt;";&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //current files<br />
<br />
echo "&lt;hr&gt;&lt;b&gt;Files with extension .php:&lt;/b&gt;&lt;br&gt;";<br />
$n = file_list(getcwd(),".php");<br />
if($n) foreach($n as $f) echo "$f&lt;br&gt;";&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //files with .php extensions<br />
<br />
echo "&lt;hr&gt;&lt;b&gt;Directories:&lt;/b&gt;&lt;br&gt;";<br />
$d = dir_list(getcwd());<br />
if($d) foreach($d as $f) echo "$f&lt;br&gt;";&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //directories<br />
/********************************************************************/<br />
<br />
/************\<br />
RUNTIME NOTES:<br />
file_list($arg1); // php issues a warning that there is no second parameter, but we know that, izz ok<br />
\************/<br />
<br />
/*******************************\<br />
TESTED AND WORKING ON 2009.04.30:<br />
OS:&nbsp; &nbsp;&nbsp; Linux 2.6.9-78.0.17.ELsmp<br />
APACHE: 2.2.9<br />
PHP:&nbsp; &nbsp; 5.2.5<br />
\*******************************/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88729""></a>
  <div class="note">
   <strong class="user">kyperkins at gmail dot com</strong>
   <a href="#88729" class="date">05-Feb-2009 12:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a simple little scandir() function that can pick a random photo (jpg only so far) and dislpay it. This also goes through an exclusion list and doesn't store anything you don't want to display. Use as you wish<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $dir</span><span class="keyword">=</span><span class="default">scandir</span><span class="keyword">(</span><span class="string">"photos"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$exclude</span><span class="keyword">=array(</span><span class="string">"photos/."</span><span class="keyword">,</span><span class="string">"photos/.."</span><span class="keyword">,</span><span class="string">"photos/ex"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$photos</span><span class="keyword">=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">); </span><span class="default">$x</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">]=</span><span class="string">"photos/"</span><span class="keyword">.</span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">]) &amp;&amp; !</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">], </span><span class="default">$exclude</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$thisfolder</span><span class="keyword">=</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$f</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$f</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$thisfolder</span><span class="keyword">); </span><span class="default">$f</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$thisfolder</span><span class="keyword">[</span><span class="default">$f</span><span class="keyword">]), </span><span class="string">".jpg"</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$photos</span><span class="keyword">[]=</span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">].</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$thisfolder</span><span class="keyword">[</span><span class="default">$f</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rand</span><span class="keyword">=</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">count</span><span class="keyword">(</span><span class="default">$photos</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;div style='text-align: center;'&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;img src='"</span><span class="keyword">.</span><span class="default">$photos</span><span class="keyword">[</span><span class="default">$rand</span><span class="keyword">].</span><span class="string">"' alt='' style='width: 80%'/&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;/div&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88006""></a>
  <div class="note">
   <strong class="user">Dustin</strong>
   <a href="#88006" class="date">06-Jan-2009 12:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If I'm remembering my CS classes right... this would be the 'bare bones' recursive method to extract directories and files... <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getDirectoryTree</span><span class="keyword">( </span><span class="default">$outerDir </span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">array_diff</span><span class="keyword">( </span><span class="default">scandir</span><span class="keyword">( </span><span class="default">$outerDir </span><span class="keyword">), Array( </span><span class="string">"."</span><span class="keyword">, </span><span class="string">".." </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir_array </span><span class="keyword">= Array();<br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$dirs </span><span class="keyword">as </span><span class="default">$d </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$outerDir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$d</span><span class="keyword">) ) </span><span class="default">$dir_array</span><span class="keyword">[ </span><span class="default">$d </span><span class="keyword">] = </span><span class="default">getDirectoryTree</span><span class="keyword">( </span><span class="default">$outerDir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$d </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$dir_array</span><span class="keyword">[ </span><span class="default">$d </span><span class="keyword">] = </span><span class="default">$d</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$dir_array</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87760""></a>
  <div class="note">
   <strong class="user">admin at utahfishinginfo dot com</strong>
   <a href="#87760" class="date">20-Dec-2008 12:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a function that parses your website's directory tree, similar to the scanDirectories function provided by fatpratmatt.&nbsp; However, this allows you to filter out all files except for those with specific extensions, in addition to allowing you to ignore entire directories, and also has a list of specific files to ignore.&nbsp; One last addition is that it allows you to use a regular expression to ignore another set of files.<br />
<br />
I use this to walk the directory structure of my website, and to generate a sitemap.xml for Google sitemaps to index my site.&nbsp; This allows me to skip dev, data, library, etc. folders, and files that are not front end files.<br />
<br />
The way it's written means you don't need to worry about excluding specific files at all unless they have the extension you are looking for (i.e. html or php files).<br />
<br />
Enjoy.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">function </span><span class="default">get_files</span><span class="keyword">(</span><span class="default">$root_dir</span><span class="keyword">, </span><span class="default">$all_data</span><span class="keyword">=array()) <br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// only include files with these extensions<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$allow_extensions </span><span class="keyword">= array(</span><span class="string">"php"</span><span class="keyword">, </span><span class="string">"html"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// make any specific files you wish to be excluded<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ignore_files </span><span class="keyword">= array(</span><span class="string">"gdform.php"</span><span class="keyword">,</span><span class="string">"fishheader.php"</span><span class="keyword">,</span><span class="string">"fishfooter.php"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">"sitelinks.php"</span><span class="keyword">,</span><span class="string">"google204accd1c3ac0501.html"</span><span class="keyword">,</span><span class="string">"sitemapxml.php"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">"rotate.php"</span><span class="keyword">, </span><span class="string">"fishstockingreport2.php"</span><span class="keyword">, </span><span class="string">"repcentral.php"</span><span class="keyword">, </span><span class="string">"repne.php"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">"repnorth.php"</span><span class="keyword">,</span><span class="string">"reppowell.php"</span><span class="keyword">,</span><span class="string">"repse.php"</span><span class="keyword">,</span><span class="string">"repsouth.php"</span><span class="keyword">,</span><span class="string">"repse.php"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">"stockreplib.php"</span><span class="keyword">,</span><span class="string">"iestyles.php"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ignore_regex </span><span class="keyword">= </span><span class="string">'/^_/'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// skip these directories<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ignore_dirs </span><span class="keyword">= array(</span><span class="string">"."</span><span class="keyword">, </span><span class="string">".."</span><span class="keyword">, </span><span class="string">"images"</span><span class="keyword">, </span><span class="string">"dev"</span><span class="keyword">, </span><span class="string">"lib"</span><span class="keyword">, </span><span class="string">"data"</span><span class="keyword">, </span><span class="string">"osh"</span><span class="keyword">, </span><span class="string">"fiq"</span><span class="keyword">, </span><span class="string">"google"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">"stats"</span><span class="keyword">, </span><span class="string">"_db_backups"</span><span class="keyword">, </span><span class="string">"maps"</span><span class="keyword">, </span><span class="string">"php_uploads"</span><span class="keyword">, </span><span class="string">"test"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// run through content of root directory<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir_content </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$root_dir</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$dir_content </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$content</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">$root_dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$content</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; </span><span class="default">is_readable</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// skip ignored files<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">, </span><span class="default">$ignore_files</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$ignore_regex</span><span class="keyword">,</span><span class="default">$content</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$content_chunks </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">,</span><span class="default">$content</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ext </span><span class="keyword">= </span><span class="default">$content_chunks</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$content_chunks</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// only include files with desired extensions<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$ext</span><span class="keyword">, </span><span class="default">$allow_extensions</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// save file name with path<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$all_data</span><span class="keyword">[] = </span><span class="default">$path</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// if content is a directory and readable, add path and name<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">elseif(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; </span><span class="default">is_readable</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// skip any ignored dirs<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">, </span><span class="default">$ignore_dirs</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// recursive callback to open new directory<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$all_data </span><span class="keyword">= </span><span class="default">get_files</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$all_data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } </span><span class="comment">// end foreach<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$all_data</span><span class="keyword">;<br />
&nbsp; } </span><span class="comment">// end get_files()<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87527""></a>
  <div class="note">
   <strong class="user">dsiembab at fullchannel dot net</strong>
   <a href="#87527" class="date">09-Dec-2008 08:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Back in the saddle of scandir I wrote this function for a function that I needed to seperate directories from files. Since I am still learning from my last example way below I would figure I would add it so it can be criticized.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">dirlist</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$bool </span><span class="keyword">= </span><span class="string">"dirs"</span><span class="keyword">){<br />
&nbsp;&nbsp; </span><span class="default">$truedir </span><span class="keyword">= </span><span class="default">$dir</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; if(</span><span class="default">$bool </span><span class="keyword">== </span><span class="string">"files"</span><span class="keyword">){ </span><span class="comment">// dynamic function based on second pram<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$direct </span><span class="keyword">= </span><span class="string">'is_dir'</span><span class="keyword">; <br />
&nbsp;&nbsp; }elseif(</span><span class="default">$bool </span><span class="keyword">== </span><span class="string">"dirs"</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$direct </span><span class="keyword">= </span><span class="string">'is_file'</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; foreach(</span><span class="default">$dir </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; if((</span><span class="default">$direct</span><span class="keyword">(</span><span class="default">$truedir</span><span class="keyword">.</span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">])) || </span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] == </span><span class="string">'.' </span><span class="keyword">|| </span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] == </span><span class="string">'..' </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; unset(</span><span class="default">$dir</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; return </span><span class="default">$dir</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
&lt;?php<br />
print_r</span><span class="keyword">(</span><span class="default">dirlist</span><span class="keyword">(</span><span class="string">"../"</span><span class="keyword">));&nbsp; </span><span class="comment">//confirm array of subdirectories<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">dirlist</span><span class="keyword">(</span><span class="string">"../"</span><span class="keyword">, </span><span class="string">"files"</span><span class="keyword">) </span><span class="comment">// confirm list on files in the directory <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84638""></a>
  <div class="note">
   <strong class="user">webmaster at asylum-et dot com</strong>
   <a href="#84638" class="date">23-Jul-2008 09:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* outputs all files and directories<br />
&nbsp;* recursively starting with the given<br />
&nbsp;* $base path. This function is a combination<br />
&nbsp;* of some of the other snips on the php.net site. <br />
&nbsp;* All are good but lacked one thing or another <br />
&nbsp;* that I needed like .htaccess <br />
&nbsp;* files get excluded with the one that checks to <br />
&nbsp;* see if the first character is a . and omits<br />
&nbsp;* that. <br />
&nbsp;*<br />
&nbsp;* @example rscandir(dirname(__FILE__).'/'));<br />
&nbsp;* @param string $base<br />
&nbsp;* @param array $omit<br />
&nbsp;* @param array $data<br />
&nbsp;* @return array<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">rscandir</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, &amp;</span><span class="default">$data</span><span class="keyword">=array()) {<br />
&nbsp; <br />
&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">array_diff</span><span class="keyword">(</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">), array(</span><span class="string">'.'</span><span class="keyword">, </span><span class="string">'..'</span><span class="keyword">)); </span><span class="comment"># remove ' and .. from the array */<br />
&nbsp;&nbsp; <br />
&nbsp; </span><span class="keyword">foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">) : </span><span class="comment">/* loop through the array at the level of the supplied $base */<br />
&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">)) : </span><span class="comment">/* if this is a directory */<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[] = </span><span class="default">$base</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">; </span><span class="comment">/* add it to the $data array */<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">rscandir</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">); </span><span class="comment">/* then make a recursive call with the <br />
&nbsp;&nbsp; &nbsp;&nbsp; current $value as the $base supplying the $data array to carry into the recursion */<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">elseif (</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">)) : </span><span class="comment">/* else if the current $value is a file */<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[] = </span><span class="default">$base</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">; </span><span class="comment">/* just add the current $value to the $data array */<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">endif;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp; endforeach;<br />
&nbsp; <br />
&nbsp; return </span><span class="default">$data</span><span class="keyword">; </span><span class="comment">// return the $data array<br />
&nbsp; <br />
</span><span class="keyword">}<br />
<br />
echo </span><span class="string">'&lt;pre&gt;'</span><span class="keyword">; </span><span class="default">var_export</span><span class="keyword">(</span><span class="default">rscandir</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">).</span><span class="string">'/'</span><span class="keyword">)); echo </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br />
</span><span class="comment">/*<br />
Output:<br />
array (<br />
&nbsp; 0 =&gt; '/path/to/web/.htaccess',<br />
&nbsp; 1 =&gt; '/path/to/web/foo/',<br />
&nbsp; 2 =&gt; '/path/to/web/foo/file.txt'<br />
)<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81597""></a>
  <div class="note">
   <strong class="user">asamir at asamir dot net</strong>
   <a href="#81597" class="date">05-Mar-2008 01:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a modification of scanDirectories function that generates a list of all files in the chosen directory and all subdirectories of specific extentions $allowext<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">scanDirectories</span><span class="keyword">(</span><span class="default">$rootDir</span><span class="keyword">, </span><span class="default">$allowext</span><span class="keyword">, </span><span class="default">$allData</span><span class="keyword">=array()) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirContent </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$rootDir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$dirContent </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$content</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">$rootDir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$content</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ext </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">, </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$ext</span><span class="keyword">, </span><span class="default">$allowext</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; </span><span class="default">is_readable</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$allData</span><span class="keyword">[] = </span><span class="default">$path</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }elseif(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; </span><span class="default">is_readable</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// recursive callback to open new directory<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$allData </span><span class="keyword">= </span><span class="default">scanDirectories</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$allData</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$allData</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$rootDir </span><span class="keyword">= </span><span class="string">"www"</span><span class="keyword">;<br />
</span><span class="default">$allowext </span><span class="keyword">= array(</span><span class="string">"zip"</span><span class="keyword">,</span><span class="string">"rar"</span><span class="keyword">,</span><span class="string">"html"</span><span class="keyword">);<br />
</span><span class="default">$files_array </span><span class="keyword">= </span><span class="default">scanDirectories</span><span class="keyword">(</span><span class="default">$rootDir</span><span class="keyword">,</span><span class="default">$allowext</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$files_array</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81158""></a>
  <div class="note">
   <strong class="user">SlowWalkere at gmail dot com</strong>
   <a href="#81158" class="date">16-Feb-2008 01:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just noticed a minor difference between scandir and readdir.<br />
<br />
When opening a directory and using readdir(), each file appears to be accessed in the process.&nbsp; This resets the "Last Accessed" time that you would get with fileatime().<br />
<br />
With scandir(), the list is created and none of the files are accessed.&nbsp; Therefore the access times remain unchanged.<br />
<br />
I encountered this while writing a script to scan a directory and delete any file that hadn't been accessed in x time.&nbsp; Kind of defeated the purpose when the directory listing accessed every file...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80057""></a>
  <div class="note">
   <strong class="user">fatpratmatt dot  at  dot gmail dot com</strong>
   <a href="#80057" class="date">27-Dec-2007 01:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function generates a list of all files in the chosen directory and all subdirectories, throws them into a NON-multidimentional array and returns them.<br />
<br />
Most of the recursive functions on this page only return a multi-dimensional array.<br />
<br />
This is actually a modification of some one else's function (thanks mail at bartrail dot de ;])<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">scanDirectories</span><span class="keyword">(</span><span class="default">$rootDir</span><span class="keyword">, </span><span class="default">$allData</span><span class="keyword">=array()) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// set filenames invisible if you want<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$invisibleFileNames </span><span class="keyword">= array(</span><span class="string">"."</span><span class="keyword">, </span><span class="string">".."</span><span class="keyword">, </span><span class="string">".htaccess"</span><span class="keyword">, </span><span class="string">".htpasswd"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// run through content of root directory<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirContent </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$rootDir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$dirContent </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$content</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// filter all files not accessible<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">$rootDir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$content</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">, </span><span class="default">$invisibleFileNames</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// if content is file &amp; readable, add to array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; </span><span class="default">is_readable</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// save file name with path<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$allData</span><span class="keyword">[] = </span><span class="default">$path</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// if content is a directory and readable, add path and name<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}elseif(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; </span><span class="default">is_readable</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// recursive callback to open new directory<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$allData </span><span class="keyword">= </span><span class="default">scanDirectories</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$allData</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$allData</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Example output:<br />
<br />
print_r(scanDirectories("www"));<br />
---<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; www/index.php<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; www/admin.php<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; www/css/css.css<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; www/articles/2007/article1.txt<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; www/articles/2006/article1.txt<br />
&nbsp;&nbsp;&nbsp; [8] =&gt; www/img/img1.png<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78977""></a>
  <div class="note">
   <strong class="user">cHH</strong>
   <a href="#78977" class="date">05-Nov-2007 06:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since scandir() returns and array, here is a more concise method of dealing with the '.' and '..' problem when listing directories:<br />
<br />
<span class="default">&lt;?php<br />
$target </span><span class="keyword">= </span><span class="string">'/'</span><span class="keyword">;<br />
</span><span class="default">$weeds </span><span class="keyword">= array(</span><span class="string">'.'</span><span class="keyword">, </span><span class="string">'..'</span><span class="keyword">);<br />
</span><span class="default">$directories </span><span class="keyword">= </span><span class="default">array_diff</span><span class="keyword">(</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$target</span><span class="keyword">), </span><span class="default">$weeds</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
foreach(</span><span class="default">$directories </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$target</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">))<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="default">$value</span><span class="keyword">.</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77479""></a>
  <div class="note">
   <strong class="user">deryckchan at gmail dot com</strong>
   <a href="#77479" class="date">31-Aug-2007 04:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Bear in mind that sorting is *always* performed when scandir() is called. String sorting takes O(|s|n log n) runtime, and this adds to the burden of the server's memory and processing power.<br />
<br />
Therefore, whenever the alphabetical order of the directory content is unimportant, especially if sorting is to be performed by another order, or the natural order of the files on the filesystem is to be utilized, the use of opendir(), readdir() and closedir() combined is always preferred to scandir().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76071""></a>
  <div class="note">
   <strong class="user">dsiembab at fullchannel dot net</strong>
   <a href="#76071" class="date">28-Jun-2007 09:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Saw banzai monkeys code and tweaked it a little. I don't have scandir. So I had to play with the suggested use for php4.<br />
Pretty new to PHP so beer with me. This will show your current directory as a link called "Back" and will list all of your files in a menu. I wanted this because I have a lot of static pages and needed a menu that would auto update every time I added a file.<br />
<br />
<span class="default">&lt;?php<br />
$current</span><span class="keyword">=</span><span class="default">getcwd</span><span class="keyword">();<br />
</span><span class="default">$directory</span><span class="keyword">=</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">);<br />
</span><span class="default">$direct</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'-'</span><span class="keyword">,</span><span class="string">' '</span><span class="keyword">,</span><span class="default">$directory</span><span class="keyword">);<br />
</span><span class="default">$directoryuppercasewords</span><span class="keyword">=</span><span class="default">ucwords</span><span class="keyword">(</span><span class="default">$direct</span><span class="keyword">);<br />
<br />
</span><span class="comment">/*this first section above will&nbsp; get your current folder or directory and since I have a "-" between the words of my file I have to strip them to look good if I want to show the current folder or directory in the title of the first link<br />
*/<br />
</span><span class="default">$dir </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">;<br />
</span><span class="default">$dh&nbsp; </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$filename </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">))) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[] =</span><span class="default">$filename</span><span class="keyword">;<br />
}<br />
</span><span class="default">$t</span><span class="keyword">=</span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">);<br />
</span><span class="default">$f</span><span class="keyword">=</span><span class="default">array_search</span><span class="keyword">(</span><span class="string">'index.php'</span><span class="keyword">,</span><span class="default">$t</span><span class="keyword">);<br />
</span><span class="comment">/*this code above with the variable $t gets rid of the '.' and the '..' parent and ancestor files. And the variable $f finds the index file and with the code below 'unset' let you use $f as the key to get rid of that file.<br />
*/<br />
</span><span class="keyword">unset(</span><span class="default">$t</span><span class="keyword">[</span><span class="default">$f</span><span class="keyword">]);<br />
&nbsp; print(</span><span class="string">'&lt;ul align="left"&gt;'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; print(</span><span class="string">'&lt;li&gt;&lt;a href="." title="'</span><span class="keyword">.</span><span class="default">$directoryuppercasewords</span><span class="keyword">.</span><span class="string">'"&gt;Back&lt;/a&gt;&lt;/br&gt;&lt;/li&gt;'</span><span class="keyword">);<br />
&nbsp; foreach(</span><span class="default">$t </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$phpkill</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'.php'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$htmlkill</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'.html'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$phpkill</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dashkill</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'-'</span><span class="keyword">,</span><span class="string">' '</span><span class="keyword">,</span><span class="default">$htmlkill</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uppercasewords</span><span class="keyword">=</span><span class="default">ucwords</span><span class="keyword">(</span><span class="default">$dashkill</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; print(</span><span class="string">'&lt;li&gt;&lt;a href="' </span><span class="keyword">. </span><span class="default">$dir </span><span class="keyword">. </span><span class="string">'/' </span><span class="keyword">. </span><span class="default">$value </span><span class="keyword">. </span><span class="string">'" title="'</span><span class="keyword">.</span><span class="default">$uppercasewords</span><span class="keyword">.</span><span class="string">'&gt;' </span><span class="keyword">. </span><span class="default">$uppercasewords </span><span class="keyword">. </span><span class="string">"&lt;/a&gt;&lt;/br&gt;&lt;/li&gt;"</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; print(</span><span class="string">'&lt;/ul&gt;'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span> <br />
I basically made all the variables so they could explain themselves, Regular expression is not my strong point right now, just becoming familiar with php functions is more of a priority, I hope this is usefull to someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73062""></a>
  <div class="note">
   <strong class="user">aryel at redtwilight dot com dot br</strong>
   <a href="#73062" class="date">07-Feb-2007 08:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function is similar to scandir, but works in PHP4. It uses readdir to get directory info.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">php4_scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="default">$listDirectories</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">, </span><span class="default">$skipDots</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirArray </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">) || </span><span class="default">$skipDots </span><span class="keyword">== </span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$listDirectories </span><span class="keyword">== </span><span class="default">false</span><span class="keyword">) { if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)) { continue; } }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$dirArray</span><span class="keyword">,</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$dirArray</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68856""></a>
  <div class="note">
   <strong class="user">beingmrkenny at gmail dot com</strong>
   <a href="#68856" class="date">13-Aug-2006 08:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote this function to read a folder and place all the folders and sub folders it contains into an array.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Initialise empty array, otherwise an error occurs<br />
</span><span class="default">$folders </span><span class="keyword">= array();<br />
<br />
function </span><span class="default">recursive_subfolders</span><span class="keyword">(</span><span class="default">$folders</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Set path here<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="string">'/path/to/folder'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Create initial "Folders" array<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$dir </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$j </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'..' </span><span class="keyword">&amp;&amp; </span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$j</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$folders</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">] = </span><span class="default">$path </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Then check each folder in that array for subfolders and add the subfolders to the "Folders" array.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$j </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$folders</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$folders </span><span class="keyword">as </span><span class="default">$folder</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$dir </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$folder</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pathto </span><span class="keyword">= </span><span class="default">$folder</span><span class="keyword">. </span><span class="string">'/' </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'..' </span><span class="keyword">&amp;&amp; </span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$pathto</span><span class="keyword">) &amp;&amp; !</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$pathto</span><span class="keyword">, </span><span class="default">$folders</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$j</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$folders</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">] = </span><span class="default">$pathto</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$folders </span><span class="keyword">= </span><span class="default">recursive_subfolders</span><span class="keyword">(</span><span class="default">$folders</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">sort</span><span class="keyword">(</span><span class="default">$folders</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$folders</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$folders </span><span class="keyword">= </span><span class="default">recursive_subfolders</span><span class="keyword">(</span><span class="default">$folders</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
$folders now contains an array with the full paths to each subfolder. E.g.:<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; /path/to/folder/dir1<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; /path/to/folder/dir1/subdir<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; /path/to/folder/dir1/subdir/subsubdir<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; /path/to/dolfer/dir2<br />
)<br />
<br />
This function has only been tested on Linux.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64114""></a>
  <div class="note">
   <strong class="user">www.mdsjack.bo.it</strong>
   <a href="#64114" class="date">07-Apr-2006 08:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I would like to share a couple of functions I've made to get an Array of files of a certain extension inside a Directory.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Firstly, a PHP 5 emulation<br />
<br />
</span><span class="keyword">function </span><span class="default">php4_scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$sort </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">PHP_VERSION </span><span class="keyword">&gt;= </span><span class="string">'5'</span><span class="keyword">) return </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$sort</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirmap </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">"lib::scandir(</span><span class="default">$dir</span><span class="string">): failed to open dir: Invalid argument"</span><span class="keyword">, </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dirmap</span><span class="keyword">[] = </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; (</span><span class="default">$sort </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">) ? </span><span class="default">rsort</span><span class="keyword">(</span><span class="default">$dirmap</span><span class="keyword">) : </span><span class="default">sort</span><span class="keyword">(</span><span class="default">$dirmap</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$dirmap</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">/*<br />
Then, this one converts directory files into array items.<br />
It also can filter by file extension.<br />
*/<br />
<br />
</span><span class="keyword">function </span><span class="default">dir2arr</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$ext </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">PHP_VERSION </span><span class="keyword">&gt;= </span><span class="string">'4.3.0'</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># PHP 4.3.0 code<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$dir </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"</span><span class="default">$dir</span><span class="string">*"</span><span class="keyword">.(!</span><span class="default">$ext </span><span class="keyword">? </span><span class="string">'.*' </span><span class="keyword">: </span><span class="string">'{'</span><span class="keyword">.</span><span class="default">$ext</span><span class="keyword">.</span><span class="string">', '</span><span class="keyword">.</span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">$ext</span><span class="keyword">).</span><span class="string">'}'</span><span class="keyword">), </span><span class="default">GLOB_NOSORT </span><span class="keyword">+ </span><span class="default">GLOB_BRACE</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$dir </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[] = </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"#(?:.+\/{1})*([^\.]+)\.(.+)#i"</span><span class="keyword">, </span><span class="string">'$1'</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># PHP 4.2.x code<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">= </span><span class="default">php4_scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">); </span><span class="comment">// See code snippet above<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(!</span><span class="default">$ext</span><span class="keyword">) </span><span class="default">$ext </span><span class="keyword">= </span><span class="string">'\.[a-z]+'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pattern </span><span class="keyword">= </span><span class="string">"#([^\.|\.\.$]+)</span><span class="default">$ext</span><span class="string">#i"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$dir </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$filename</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[] = </span><span class="default">$filename</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return (empty(</span><span class="default">$arr</span><span class="keyword">) ? </span><span class="default">false </span><span class="keyword">: </span><span class="default">$arr</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56379""></a>
  <div class="note">
   <strong class="user">Yassin Ezbakhe &lt;yassin88 at gmail dot com&gt;</strong>
   <a href="#56379" class="date">01-Sep-2005 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">/**********************************************<br />
&nbsp;*<br />
&nbsp;*&nbsp;&nbsp; PURPOSE: List files inside the specified path and its<br />
&nbsp;*&nbsp;&nbsp; subdirectories<br />
&nbsp;*<br />
&nbsp;*&nbsp;&nbsp; array scandir_recursive (string dir)<br />
&nbsp;*<br />
&nbsp;*&nbsp;&nbsp; This function will return a multidimensional array <br />
&nbsp;*&nbsp;&nbsp; that represents main folder's tree structure. <br />
&nbsp;*&nbsp;&nbsp; Each folder has its own named array<br />
&nbsp;*<br />
&nbsp;**********************************************/<br />
<br />
</span><span class="keyword">function </span><span class="default">scandir_recursive</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$folderContents </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$directory </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">).</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">) as </span><span class="default">$folderItem</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$folderItem </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">AND </span><span class="default">$folderItem </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">.</span><span class="default">$folderItem</span><span class="keyword">.</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$folderContents</span><span class="keyword">[</span><span class="default">$folderItem</span><span class="keyword">] = </span><span class="default">scandir_recursive</span><span class="keyword">( </span><span class="default">$directory</span><span class="keyword">.</span><span class="default">$folderItem</span><span class="keyword">.</span><span class="string">"\\"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$folderContents</span><span class="keyword">[] = </span><span class="default">$folderItem</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$folderContents</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54581""></a>
  <div class="note">
   <strong class="user">trevi55 at gmail dot com</strong>
   <a href="#54581" class="date">08-Jul-2005 02:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For non php5-users here you are this function...<br />
It isn't set the wrapper, but I think it's enough :P.<br />
<br />
If no pararameter is set, the scandir() function will scan the local file directory.<br />
<br />
Set the optional parameter "$sort" to 1 to reverse the alphabetical-sorting.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">= </span><span class="string">'./'</span><span class="keyword">, </span><span class="default">$sort </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">) <br />
{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir_open </span><span class="keyword">= @ </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (! </span><span class="default">$dir_open</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; while ((</span><span class="default">$dir_content </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dir_open</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[] = </span><span class="default">$dir_content</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$sort </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">rsort</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">, </span><span class="default">SORT_STRING</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sort</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">, </span><span class="default">SORT_STRING</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$files</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54344""></a>
  <div class="note">
   <strong class="user">progrium+php at gmail dot com</strong>
   <a href="#54344" class="date">01-Jul-2005 01:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made this to represent a directory tree in an array that uses the file or directory names as keys and full paths as the value for files. Directories are nested arrays.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">generatePathTree</span><span class="keyword">(</span><span class="default">$rootPath</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pathStack </span><span class="keyword">= array(</span><span class="default">$rootPath</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$contentsRoot </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$contents </span><span class="keyword">= &amp;</span><span class="default">$contentsRoot</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$path </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$pathStack</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$contents</span><span class="keyword">[</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$contents </span><span class="keyword">= &amp;</span><span class="default">$contents</span><span class="keyword">[</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)];<br />
&nbsp;&nbsp; &nbsp; &nbsp; foreach (</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) as </span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="string">'.' </span><span class="keyword">!= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newPath </span><span class="keyword">= </span><span class="default">$path</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$newPath</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$pathStack</span><span class="keyword">, </span><span class="default">$newPath</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$contents</span><span class="keyword">[</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$newPath</span><span class="keyword">)] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$contents</span><span class="keyword">[</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)] = </span><span class="default">$newPath</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$contentsRoot</span><span class="keyword">[</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$rootPath</span><span class="keyword">)];<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
The function will return something like this:<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [index.php] =&gt; /usr/local/www/index.php<br />
&nbsp;&nbsp;&nbsp; [js] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [async.js] =&gt; /usr/local/www/js/async.js<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [dom.js] =&gt; /usr/local/www/js/dom.js<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [effects.js] =&gt; /usr/local/www/js/effects.js<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [prototype.js] =&gt; /usr/local/www/js/prototype.js<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [logo.png] =&gt; /usr/local/www/logo.png<br />
&nbsp;&nbsp;&nbsp; [server.php] =&gt; /usr/local/www/server.php<br />
&nbsp;&nbsp;&nbsp; [test.js] =&gt; /usr/local/www/test.js<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52755""></a>
  <div class="note">
   <strong class="user">Pawel Dlugosz</strong>
   <a href="#52755" class="date">11-May-2005 08:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For directory containing files like (for example) -.jpg the results of scandir are a little "weird" ;)<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; $dir </span><span class="keyword">= </span><span class="string">'/somedir'</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; -.jpg<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; .<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; ..<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; foo.txt<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; somedir<br />
)<br />
<br />
Beware - sorting is in ASCII order :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51839""></a>
  <div class="note">
   <strong class="user">wwwebdesigner at web doott de</strong>
   <a href="#51839" class="date">12-Apr-2005 09:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
using sort of scandir() that returns the content sorted by Filemodificationtime.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">scandir_by_mtime</span><span class="keyword">(</span><span class="default">$folder</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$dircontent </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$folder</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$arr </span><span class="keyword">= array();<br />
&nbsp; foreach(</span><span class="default">$dircontent </span><span class="keyword">as </span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$filename </span><span class="keyword">!= </span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$filename </span><span class="keyword">!= </span><span class="string">'..'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">filemtime</span><span class="keyword">(</span><span class="default">$folder</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">) === </span><span class="default">false</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$dat </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"YmdHis"</span><span class="keyword">, </span><span class="default">filemtime</span><span class="keyword">(</span><span class="default">$folder</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$dat</span><span class="keyword">] = </span><span class="default">$filename</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; if (!</span><span class="default">ksort</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp; return </span><span class="default">$arr</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
returns false if an error occured<br />
otherwise it returns an array like this.<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [20040813231320] =&gt; DSC00023.JPG<br />
&nbsp;&nbsp;&nbsp; [20040813231456] =&gt; DSC00024.JPG<br />
&nbsp;&nbsp;&nbsp; [20040814003728] =&gt; MOV00055.MPG<br />
&nbsp;&nbsp;&nbsp; [20040814003804] =&gt; DSC00056.JPG<br />
&nbsp;&nbsp;&nbsp; [20040814003946] =&gt; DSC00057.JPG<br />
&nbsp;&nbsp;&nbsp; [20040814004030] =&gt; DSC00058.JPG<br />
&nbsp;&nbsp;&nbsp; [20040814014516] =&gt; DSC00083.JPG<br />
&nbsp;&nbsp;&nbsp; [20050401161718] =&gt; album.txt<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51267""></a>
  <div class="note">
   <strong class="user">brodseba at brodseba dot com</strong>
   <a href="#51267" class="date">25-Mar-2005 05:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function create a HTML view of a directory.&nbsp; It also look for subdirectory.&nbsp; I use some icon to differ from folders or files.&nbsp; It's also possible to get specific icon for specific file type.<br />
<br />
Each entrey is clickable so you can use it to populate a form field.<br />
<br />
Have fun!<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">ls_recursive2</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)<br />
{<br />
&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">))<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$files </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$currentfile </span><span class="keyword">= </span><span class="default">$dir </span><span class="keyword">. </span><span class="string">"/" </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$last_dir </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Calculate they identation.<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$currentfile</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$minus_count </span><span class="keyword">= </span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">], </span><span class="string">'/'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">-= (</span><span class="default">$minus_count </span><span class="keyword">+ </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; for(</span><span class="default">$p </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$p </span><span class="keyword">&lt; </span><span class="default">$count</span><span class="keyword">; </span><span class="default">$p</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last_dir </span><span class="keyword">.= </span><span class="string">"&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$currentfile</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'..'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last_dir </span><span class="keyword">.= </span><span class="string">"&lt;img src='images/folder.gif' alt='' align='middle' width='16' height='16' border='0'&gt;&amp;nbsp;&lt;a href=\"javascript:go('" </span><span class="keyword">. </span><span class="default">$currentfile </span><span class="keyword">. </span><span class="string">"')\"&gt;"</span><span class="keyword">. </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$currentfile</span><span class="keyword">, </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$currentfile</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">)) . </span><span class="string">"&lt;/a&gt;&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$last_dir</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">ls_recursive2</span><span class="keyword">(</span><span class="default">$currentfile</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last_dir </span><span class="keyword">.= </span><span class="string">"&lt;img src='images/file.gif' alt='' align='middle' width='16' height='16' border='0'&gt;&amp;nbsp;&lt;a href=\"javascript:go('" </span><span class="keyword">. </span><span class="default">$currentfile </span><span class="keyword">. </span><span class="string">"')\"&gt;"</span><span class="keyword">. </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$currentfile</span><span class="keyword">, </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$currentfile</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">)) . </span><span class="string">"&lt;/a&gt;&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$last_dir</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50623""></a>
  <div class="note">
   <strong class="user">csaba at alum dot mit dot edu</strong>
   <a href="#50623" class="date">05-Mar-2005 12:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Scandir on steroids:<br />
For when you want to filter your file list, or only want to list so many levels of subdirectories...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">dirList</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">, </span><span class="default">$types</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">, </span><span class="default">$levels</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">, </span><span class="default">$aFilter</span><span class="keyword">=array()) {<br />
</span><span class="comment">//&nbsp; returns an array of the specified files/directories<br />
//&nbsp; start search in $path (defaults to current working directory)<br />
//&nbsp; return $types:&nbsp; 2 =&gt; files; 1 =&gt; directories; 3 =&gt; both;<br />
//&nbsp; $levels: 1 =&gt; look in the $path only; 2 =&gt; $path and all children;<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3 =&gt; $path, children, grandchildren; 0 =&gt; $path and all subdirectories;<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; less than 0 =&gt; complement of -$levels, OR everything starting -$levels down<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.g. -1 =&gt; everthing except $path; -2 =&gt; all descendants except $path + children<br />
//&nbsp; Remaining argument(s) is(are) a filter array(list) of regular expressions which operate on the full path.<br />
//&nbsp; &nbsp; First character (before the '/' of the regExp) '-' =&gt; NOT.<br />
//&nbsp; &nbsp; First character (after a possible '-') 'd' =&gt; apply to directory name<br />
//&nbsp; &nbsp; The filters may be passed in as an array of strings or as a list of strings<br />
//&nbsp; Note that output directories are prefixed with a '*' (done in the line above the return)<br />
&nbsp;&nbsp; </span><span class="default">$dS </span><span class="keyword">= </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">;<br />
&nbsp;&nbsp; if (!(</span><span class="default">$path </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">?</span><span class="default">$path</span><span class="keyword">:</span><span class="default">getcwd</span><span class="keyword">()))) return array();&nbsp; &nbsp; </span><span class="comment">// bad path<br />
&nbsp;&nbsp; // next line rids terminating \ on drives (works since c: == c:\ on PHP).&nbsp; OK in *nix?<br />
&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">)==</span><span class="default">$dS</span><span class="keyword">) </span><span class="default">$path </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; if (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$types</span><span class="keyword">)) </span><span class="default">$types </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; if (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$levels</span><span class="keyword">)) </span><span class="default">$levels </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; if (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$aFilter</span><span class="keyword">)) </span><span class="default">$aFilter</span><span class="keyword">=array();<br />
<br />
&nbsp;&nbsp; </span><span class="comment">// last argument may be passed as a list or as an array<br />
&nbsp;&nbsp; </span><span class="default">$aFilter </span><span class="keyword">= </span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">func_get_args</span><span class="keyword">(),</span><span class="default">3</span><span class="keyword">);<br />
&nbsp;&nbsp; if (</span><span class="default">$aFilter </span><span class="keyword">&amp;&amp; </span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$aFilter</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])==</span><span class="string">"array"</span><span class="keyword">) </span><span class="default">$aFilter</span><span class="keyword">=</span><span class="default">$aFilter</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; </span><span class="default">$adFilter </span><span class="keyword">= array();<br />
&nbsp;&nbsp; </span><span class="comment">// now move directory filters to separate array:<br />
&nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$aFilter </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">=&gt;</span><span class="default">$filter</span><span class="keyword">)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// for each directory filter...<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">if ((</span><span class="default">$pos</span><span class="keyword">=</span><span class="default">stripos</span><span class="keyword">(</span><span class="string">" </span><span class="default">$filter</span><span class="string">"</span><span class="keyword">,</span><span class="string">"d"</span><span class="keyword">)) &amp;&amp; </span><span class="default">$pos</span><span class="keyword">&lt;</span><span class="default">3</span><span class="keyword">) {&nbsp; </span><span class="comment">// next line eliminates the 'd'<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$adFilter</span><span class="keyword">[] = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$filter</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$pos</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">) . </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$filter</span><span class="keyword">,</span><span class="default">$pos</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; unset(</span><span class="default">$aFilter</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]); }<br />
&nbsp;&nbsp; </span><span class="default">$aFilter </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$aFilter</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// reset indeces<br />
<br />
&nbsp;&nbsp; </span><span class="default">$aRes </span><span class="keyword">= array();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// results, $aAcc is an Accumulator<br />
&nbsp;&nbsp; </span><span class="default">$aDir </span><span class="keyword">= array(</span><span class="default">$path</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// dirs to check<br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">$levels</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">?</span><span class="default">$levels</span><span class="keyword">++:-</span><span class="default">1</span><span class="keyword">;(</span><span class="default">$aAcc</span><span class="keyword">=array())||</span><span class="default">$i</span><span class="keyword">--&amp;&amp;</span><span class="default">$aDir</span><span class="keyword">;</span><span class="default">$aDir</span><span class="keyword">=</span><span class="default">$aAcc</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; while (</span><span class="default">$dir </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$aDir</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">scandir </span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) as </span><span class="default">$fileOrDir</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$fileOrDir</span><span class="keyword">!=</span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$fileOrDir</span><span class="keyword">!=</span><span class="string">".."</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$dirP </span><span class="keyword">= </span><span class="default">is_dir </span><span class="keyword">(</span><span class="default">$rp</span><span class="keyword">=</span><span class="string">"</span><span class="default">$dir$dS$fileOrDir</span><span class="string">"</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">pathFilter</span><span class="keyword">(</span><span class="string">"</span><span class="default">$rp$dS</span><span class="string">"</span><span class="keyword">, </span><span class="default">$adFilter</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aAcc</span><span class="keyword">[] = </span><span class="default">$rp</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$levels</span><span class="keyword">-</span><span class="default">1 </span><span class="keyword">&amp;&amp; (</span><span class="default">$types </span><span class="keyword">&amp; (</span><span class="default">2</span><span class="keyword">-</span><span class="default">$dirP</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">pathFilter</span><span class="keyword">(</span><span class="default">$rp</span><span class="keyword">, </span><span class="default">$aFilter</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRes</span><span class="keyword">[] = (</span><span class="default">$dirP</span><span class="keyword">?</span><span class="string">"*"</span><span class="keyword">:</span><span class="string">""</span><span class="keyword">) . </span><span class="default">$rp</span><span class="keyword">; }<br />
&nbsp;&nbsp; return </span><span class="default">$aRes</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
example usage:<br />
<span class="default">&lt;?php<br />
define </span><span class="keyword">(</span><span class="string">"_"</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">);<br />
</span><span class="comment">// this will find all non .jpg, non .Thumbs.db files under c:\Photo<br />
</span><span class="default">$aFiles </span><span class="keyword">= </span><span class="default">dirList</span><span class="keyword">(</span><span class="string">'c:\Photo'</span><span class="keyword">, </span><span class="default">_</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="string">'-/\.jpg$/i'</span><span class="keyword">, </span><span class="string">'-/\\\\Thumbs.db$/'</span><span class="keyword">);<br />
</span><span class="default">$aFiles </span><span class="keyword">= </span><span class="default">dirList</span><span class="keyword">();&nbsp; &nbsp; </span><span class="comment">// find the files in the current directory<br />
// next lines will find .jpg files in non Photo(s) subdirectories, excluding Temporary Internet Files<br />
</span><span class="default">set_time_limit</span><span class="keyword">(</span><span class="default">60</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// iterating from the top level can take a while<br />
</span><span class="default">$aFiles </span><span class="keyword">= </span><span class="default">dirList</span><span class="keyword">(</span><span class="string">"c:\\"</span><span class="keyword">, </span><span class="default">_</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="string">'/\.jpg$/i'</span><span class="keyword">, </span><span class="string">'-d/\\\\Photos?$/i'</span><span class="keyword">, </span><span class="string">'-d/Temporary Internet/i'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Note that this function will consume a lot of time if scanning large<br />
directory structures (which is the reason for the '[-]d/.../' filters).<br />
<br />
Csaba Gabor from Vienna</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50600""></a>
  <div class="note">
   <strong class="user">csaba at alum dot mit dot edu</strong>
   <a href="#50600" class="date">04-Mar-2005 01:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A nice way to filter the files/directories you get back from scandir:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">pathFilter </span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$aFilter</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="comment">// returns true iff $path survives the tests from $aFilter<br />
&nbsp;&nbsp; // $aFilter is an array of regular expressions: [-]/regExp/modifiers<br />
&nbsp;&nbsp; // if there is a leading '-' it means exclude $path upon a match (a NOT test)<br />
&nbsp;&nbsp; // If the first expression has a leading '-', $path is in, unless it gets excluded.<br />
&nbsp;&nbsp; // Otherwise, $path is out, unless it gets included via the filter tests.<br />
&nbsp;&nbsp; // The tests are applied in succession.<br />
&nbsp;&nbsp; // A NOT test is applied only if $path is currently (within the tests) included<br />
&nbsp;&nbsp; // Other tests are applied only if $path is currently excluded.&nbsp; Thus,<br />
&nbsp;&nbsp; // array("/a/", "-/b/", "/c/") =&gt; passes if $path has a c or if $path has an a but no b<br />
&nbsp;&nbsp; // array("/a/", "/c/", "-/b/") =&gt; passes if $path has an a or c, but no b<br />
&nbsp;&nbsp; // array("-/b/", "/a/", "/c/") =&gt; passes if $path has no b, or if $path has an a or c<br />
&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$aFilter</span><span class="keyword">) return </span><span class="default">true</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// automatic inclusion (pass) if no filters<br />
&nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$aFilter </span><span class="keyword">as </span><span class="default">$filter</span><span class="keyword">) break;&nbsp; </span><span class="comment">// we don't know how it's indexed<br />
&nbsp;&nbsp; </span><span class="default">$in </span><span class="keyword">= </span><span class="default">$filter</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]==</span><span class="string">"-"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// initial in/exclusion based on first filter<br />
&nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$aFilter </span><span class="keyword">as </span><span class="default">$filter</span><span class="keyword">)&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// walk the filters<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$in</span><span class="keyword">==</span><span class="default">$not</span><span class="keyword">=(</span><span class="default">$filter</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]==</span><span class="string">"-"</span><span class="keyword">))&nbsp;&nbsp; </span><span class="comment">//&nbsp; &nbsp;&nbsp; testing only when necessary<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$in </span><span class="keyword">^= </span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$filter</span><span class="keyword">,</span><span class="default">$not</span><span class="keyword">),</span><span class="default">$path</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// flip in/exclusion upon a match<br />
&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$in</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Csaba Gabor from Vienna</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49819""></a>
  <div class="note">
   <strong class="user">virtual at NOSPAM dot lapinbleu dot ch</strong>
   <a href="#49819" class="date">09-Feb-2005 02:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since I needed to scan dirs and subdirs and wanted to have files and dirs not in the same var without having to explode it, I did this little function:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">scan_Dir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">)<br />
{<br />
</span><span class="default">$temp </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
if (</span><span class="default">$directory</span><span class="keyword">==</span><span class="default">NULL</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$directory </span><span class="keyword">= </span><span class="default">getcwd</span><span class="keyword">();<br />
}<br />
</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">);<br />
while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$filename </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">)))<br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$filename</span><span class="keyword">!=</span><span class="string">"."</span><span class="keyword">) AND (</span><span class="default">$filename</span><span class="keyword">!=</span><span class="string">".."</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$old_directory </span><span class="keyword">= </span><span class="default">$directory</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$directory </span><span class="keyword">.= </span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$temp </span><span class="keyword">= </span><span class="default">scan_Dir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cpt </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$cpt</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">[</span><span class="string">"filename"</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arrfiles</span><span class="keyword">[</span><span class="string">"path"</span><span class="keyword">][]&nbsp; &nbsp; &nbsp; = </span><span class="default">$directory</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$temp</span><span class="keyword">[</span><span class="string">"filename"</span><span class="keyword">][</span><span class="default">$cpt</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arrfiles</span><span class="keyword">[</span><span class="string">"directory"</span><span class="keyword">][] = </span><span class="default">$directory</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arrfiles</span><span class="keyword">[</span><span class="string">"filename"</span><span class="keyword">][]&nbsp; = </span><span class="default">$temp</span><span class="keyword">[</span><span class="string">"filename"</span><span class="keyword">][</span><span class="default">$cpt</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cpt</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$directory </span><span class="keyword">= </span><span class="default">$old_directory</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arrfiles</span><span class="keyword">[</span><span class="string">"path"</span><span class="keyword">][]&nbsp; &nbsp; &nbsp; = </span><span class="default">$directory</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arrfiles</span><span class="keyword">[</span><span class="string">"directory"</span><span class="keyword">][] = </span><span class="default">$directory</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arrfiles</span><span class="keyword">[</span><span class="string">"filename"</span><span class="keyword">][]&nbsp; = </span><span class="default">$filename</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
}<br />
return </span><span class="default">$arrfiles</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This one seems to work properly and use multidimensional array. <br />
<br />
To show your files, just use:<br />
<span class="default">&lt;?php<br />
<br />
$dir2scan </span><span class="keyword">= </span><span class="string">"admin"</span><span class="keyword">;<br />
</span><span class="default">$yourvar </span><span class="keyword">= </span><span class="default">scan_Dir</span><span class="keyword">(</span><span class="default">$dir2scan</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$yourvar</span><span class="keyword">[</span><span class="string">"path"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br&gt;"</span><span class="keyword">; </span><span class="comment">//Complete path of the file with key 0 (dir + filename)<br />
<br />
</span><span class="keyword">echo </span><span class="default">$yourvar</span><span class="keyword">[</span><span class="string">"directory"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br&gt;"</span><span class="keyword">; </span><span class="comment">//Directory of the file with key 0<br />
<br />
</span><span class="keyword">echo </span><span class="default">$yourvar</span><span class="keyword">[</span><span class="string">"filename"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br&gt;"</span><span class="keyword">; </span><span class="comment">//Filename of the file with key 0<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Note that the parameter of the function is not necessary. If you don't give any, it will scan from the returned value of getcwd() function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46872""></a>
  <div class="note">
   <strong class="user">Stan P. van de Burgt</strong>
   <a href="#46872" class="date">26-Oct-2004 06:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
scandir() with regexp matching on file name and sorting options based on stat().<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">myscandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$exp</span><span class="keyword">, </span><span class="default">$how</span><span class="keyword">=</span><span class="string">'name'</span><span class="keyword">, </span><span class="default">$desc</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dh </span><span class="keyword">= @</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$dh</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$fname </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$exp</span><span class="keyword">, </span><span class="default">$fname</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stat </span><span class="keyword">= </span><span class="default">stat</span><span class="keyword">(</span><span class="string">"</span><span class="default">$dir</span><span class="string">/</span><span class="default">$fname</span><span class="string">"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[</span><span class="default">$fname</span><span class="keyword">] = (</span><span class="default">$how </span><span class="keyword">== </span><span class="string">'name'</span><span class="keyword">)? </span><span class="default">$fname</span><span class="keyword">: </span><span class="default">$stat</span><span class="keyword">[</span><span class="default">$how</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$desc</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">arsort</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">asort</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return(</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">));<br />
}<br />
<br />
</span><span class="default">$r </span><span class="keyword">= </span><span class="default">myscandir</span><span class="keyword">(</span><span class="string">'./book/'</span><span class="keyword">, </span><span class="string">'/^article[0-9]{4}\.txt$/i'</span><span class="keyword">, </span><span class="string">'ctime'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
files can be sorted on name and stat() attributes, ascending and descending:<br />
<br />
name&nbsp; &nbsp; file name<br />
dev&nbsp; &nbsp;&nbsp; device number<br />
ino&nbsp; &nbsp;&nbsp; inode number<br />
mode&nbsp; &nbsp; inode protection mode<br />
nlink&nbsp;&nbsp; number of links<br />
uid&nbsp; &nbsp;&nbsp; userid of owner<br />
gid&nbsp; &nbsp;&nbsp; groupid of owner<br />
rdev&nbsp; &nbsp; device type, if inode device *<br />
size&nbsp; &nbsp; size in bytes<br />
atime&nbsp;&nbsp; time of last access (Unix timestamp)<br />
mtime&nbsp;&nbsp; time of last modification (Unix timestamp)<br />
ctime&nbsp;&nbsp; time of last inode change (Unix timestamp)<br />
blksize blocksize of filesystem IO *<br />
blocks&nbsp; number of blocks allocated</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42553""></a>
  <div class="note">
   <strong class="user">aidan at php dot net</strong>
   <a href="#42553" class="date">21-May-2004 04:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This functionality is now implemented in the PEAR package PHP_Compat.<br />
<br />
More information about using this function without upgrading your version of PHP can be found on the below link:<br />
<br />
<a href="http://pear.php.net/package/PHP_Compat" rel="nofollow" target="_blank">http://pear.php.net/package/PHP_Compat</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.rewinddir.html">rewinddir</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="book.fileinfo.html">Fileinfo</a></div>
 <div class="up"><a href="ref.dir.html">ディレクトリ 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
