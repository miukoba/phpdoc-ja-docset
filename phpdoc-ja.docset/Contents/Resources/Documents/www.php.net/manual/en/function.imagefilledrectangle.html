<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>塗りつぶした矩形を描画する</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.imagefilledpolygon.html">imagefilledpolygon</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.imagefilltoborder.html">imagefilltoborder</a></div>
 <div class="up"><a href="ref.image.html">GD および Image 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.imagefilledrectangle" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imagefilledrectangle</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">imagefilledrectangle</span> &mdash; <span class="dc-title">塗りつぶした矩形を描画する</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imagefilledrectangle-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>imagefilledrectangle</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$image</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$x1</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$y1</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$x2</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$y2</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$color</code></span>
   )</div>

  <p class="para rdfs-comment">
   色 <em><code class="parameter">color</code></em> で塗りつぶした矩形を、
   指定した <em><code class="parameter">image</code></em> 上に作成します。
   開始位置と終了位置を指定します。0, 0
   が画像の左上角を表します。
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imagefilledrectangle-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>
<span class="term"><em><code class="parameter">
image</code></em></span><dd>
<p class="para"> <span class="function"><a href="function.imagecreatetruecolor.html" class="function">imagecreatetruecolor()</a></span>
のような画像作成関数が返す画像リソース。</p></dd>
</dt>

    <dt>

     <span class="term"><em><code class="parameter">x1</code></em></span>
     <dd>

      <p class="para">
       開始位置の x 座標。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">y1</code></em></span>
     <dd>

      <p class="para">
       開始位置の y 座標。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">x2</code></em></span>
     <dd>

      <p class="para">
       終了位置の x 座標。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">y2</code></em></span>
     <dd>

      <p class="para">
       終了位置の y 座標。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">color</code></em></span>
     <dd>

      <p class="para">
       塗りつぶし色。
        <span class="function"><a href="function.imagecolorallocate.html" class="function">imagecolorallocate()</a></span>
       で作成した色 ID です。
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imagefilledrectangle-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.imagefilledrectangle-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-3220">
    <p><strong>例1  <span class="function"><strong>imagefilledrectangle()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;55x30&nbsp;の画像を作成します<br /></span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatetruecolor</span><span style="color: #007700">(</span><span style="color: #0000BB">55</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">30</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$white&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;白の矩形を描画します<br /></span><span style="color: #0000BB">imagefilledrectangle</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">50</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">25</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$white</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;画像を保存します<br /></span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'./imagefilledrectangle.png'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は、
たとえば以下のようになります。</p></div>
    <div class="mediaobject">
     
     <div class="imageobject">
      <img src="images/21009b70229598c6a80eef8b45bf282b-imagefilledrectangle.png" alt="出力例 : imagefilledrectangle()" width="55" height="30" />
     </div>
    </div>
   </div>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113374""></a>
  <div class="note">
   <strong class="user">Darren Edale</strong>
   <a href="#113374" class="date">03-Oct-2013 06:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The issue with filling using a rectangle is caused in your code by having alpha blending turned on before rendering the filled rectangle. Alpha blending causes what you draw on the image to be blended with whatever is already on the image according to the alpha channels of each. Therefore, because blending is on, and because the rectangle's fill colour is completely transparent, the blending of the existing image content with the transparent rectangle results in no change to the existing image.<br />
<br />
With blending off, when drawing to the image what you draw completely replaces what is already there. So, drawing the rectangle in this case results in the original content of the image being completely replaced with a transparent rectangle.<br />
<br />
So in order to use imagefilledrectangle() to erase an image to transparency, you need to turn off alpha blending first.<br />
<br />
I guess the reason imagefill() works with alpha blending on is because it does not perform any alpha blending - it always works without alpha blending regardless of the setting. I suspect there are reasons for this to do with alpha channels complicating edge detection.<br />
<br />
I would recommend using imagefilledrectangle() to create a blank transparent image resource instead of imagefill() because it is undoubtedly much faster in probably all cases.<br />
<br />
Here is some example code to blank an image to transparent, assuming $im is a successfully created image:<br />
<br />
<span class="default">&lt;?php<br />
$transparent </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">127</span><span class="keyword">);<br />
</span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br />
</span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">, </span><span class="default">$imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">, </span><span class="default">$transparent</span><span class="keyword">);<br />
</span><span class="default">imagecolordeallocate</span><span class="keyword">(</span><span class="default">$transparent</span><span class="keyword">);<br />
</span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109787""></a>
  <div class="note">
   <strong class="user">olivier dot pons at google dot mail dot com</strong>
   <a href="#109787" class="date">21-Aug-2012 06:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wanted to clear an image, and set it to full transparent.<br />
imagefilledrectangle() seems to ignore alpha channel and alpha blending.<br />
Use imagefill() instead:<br />
<br />
<span class="default">&lt;?php<br />
$w </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$final</span><span class="keyword">);<br />
</span><span class="default">$h </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$final</span><span class="keyword">);<br />
</span><span class="default">$grande </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Alpha blending on to use channel alpha<br />
</span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$grande</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="comment">// Allocate a transparent color and fill the new image with it.<br />
// Without this the image will have a black background instead<br />
// of being transparent.<br />
</span><span class="default">$transparent </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$grande</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">127</span><span class="keyword">);<br />
</span><span class="comment">// transparent alpha will be _ignored_:<br />
</span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$grande</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">, </span><span class="default">$transparent</span><span class="keyword">);<br />
</span><span class="comment">// ok, transparent will be used and set whole alpha channel to transparent:<br />
</span><span class="default">imagefill</span><span class="keyword">(</span><span class="default">$grande</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$transparent</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100111""></a>
  <div class="note">
   <strong class="user">Tobi</strong>
   <a href="#100111" class="date">25-Sep-2010 11:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It looks like there are waves beetween the points, but it's straight.<br />
<br />
<span class="default">&lt;?php<br />
$maxwert </span><span class="keyword">= </span><span class="default">300</span><span class="keyword">;<br />
</span><span class="default">$size </span><span class="keyword">= </span><span class="default">10</span><span class="keyword">;<br />
</span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$maxwert</span><span class="keyword">, </span><span class="default">$maxwert</span><span class="keyword">);<br />
</span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">$maxwert</span><span class="keyword">;</span><span class="default">$y </span><span class="keyword">+= </span><span class="default">$size</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; for(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">$maxwert</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">+=</span><span class="default">$size</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$g </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$g</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">imagefilledrectangle </span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">+</span><span class="default">$size </span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">+</span><span class="default">$size</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">); <br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96871""></a>
  <div class="note">
   <strong class="user">Mice32</strong>
   <a href="#96871" class="date">20-Mar-2010 01:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
That script draws Serpinski's carpet:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; set_time_limit</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Iterations<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xy </span><span class="keyword">= </span><span class="default">500</span><span class="keyword">;&nbsp; &nbsp; </span><span class="comment">// Picture size<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$xy</span><span class="keyword">, </span><span class="default">$xy</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$white </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$xy</span><span class="keyword">, </span><span class="default">$xy</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">, </span><span class="default">$d</span><span class="keyword">, </span><span class="default">$n</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; global </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$white</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$n </span><span class="keyword">&lt;= </span><span class="default">0</span><span class="keyword">) return;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a1 </span><span class="keyword">= </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$a </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">+ </span><span class="default">$c </span><span class="keyword">/ </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c1 </span><span class="keyword">= </span><span class="default">$a </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">+ </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$c </span><span class="keyword">/ </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$b1 </span><span class="keyword">= </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$b </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">+ </span><span class="default">$d </span><span class="keyword">/ </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d1 </span><span class="keyword">= </span><span class="default">$b </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">+ </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$d </span><span class="keyword">/ </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$b1</span><span class="keyword">, </span><span class="default">$c1</span><span class="keyword">, </span><span class="default">$d1</span><span class="keyword">, </span><span class="default">$white</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">, </span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$b1</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">, </span><span class="default">$c1</span><span class="keyword">, </span><span class="default">$b1</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">$c1</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">, </span><span class="default">$b1</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">$c1</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">, </span><span class="default">$b1</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b1</span><span class="keyword">, </span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$d1</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">$c1</span><span class="keyword">, </span><span class="default">$b1</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">, </span><span class="default">$d1</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$d1</span><span class="keyword">, </span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$d</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">, </span><span class="default">$d1</span><span class="keyword">, </span><span class="default">$c1</span><span class="keyword">, </span><span class="default">$d</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">drawCarpet</span><span class="keyword">(</span><span class="default">$c1</span><span class="keyword">, </span><span class="default">$d1</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">, </span><span class="default">$d</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Type: image/png'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83036""></a>
  <div class="note">
   <strong class="user">mike at delenk dot net</strong>
   <a href="#83036" class="date">07-May-2008 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The examples in function imagettfbbox() gave me many problems because of misunderstand of how the text is positionned in the box.<br />
<br />
So I did a new example:<br />
- writing a text<br />
- in the correct position in its box<br />
- with a padding around<br />
<br />
Enjoy !<br />
Mike<br />
<br />
&lt;?<br />
<br />
// some settings<br />
&nbsp;&nbsp;&nbsp; $angle = 0;<br />
&nbsp;&nbsp;&nbsp; $text = 'Ühg 0123456789';<br />
&nbsp;&nbsp;&nbsp; $font_face = dirname(__FILE__).'/verdana.ttf'; // put the file in the same directory<br />
&nbsp;&nbsp;&nbsp; $font_size = 9; //(int) pixels in GD 1, or points in GD 2<br />
<br />
// retrieves box frame<br />
&nbsp;&nbsp;&nbsp; $box = imagettfbbox($font_size, 0, $font_face, $text);<br />
&nbsp;&nbsp;&nbsp; $bottom_left_x = $box[0]; // used below<br />
&nbsp;&nbsp;&nbsp; $bottom_left_y = $box[1]; // used below<br />
&nbsp;&nbsp;&nbsp; $bottom_right_x = $box[2]; // used below<br />
&nbsp;&nbsp;&nbsp; $bottom_right_y = $box[3];<br />
&nbsp;&nbsp;&nbsp; $top_right_x = $box[4];<br />
&nbsp;&nbsp;&nbsp; $top_right_y = $box[5];<br />
&nbsp;&nbsp;&nbsp; $top_left_x = $box[6];<br />
&nbsp;&nbsp;&nbsp; $top_left_y = $box[7]; // used below<br />
<br />
// define width and height of the text box<br />
&nbsp;&nbsp;&nbsp; $box_w = abs($bottom_left_x) + abs($bottom_right_x);<br />
&nbsp;&nbsp;&nbsp; $box_h = abs($bottom_left_y) + abs($top_left_y);<br />
<br />
// add padding<br />
&nbsp;&nbsp;&nbsp; $padding_x = 5;<br />
&nbsp;&nbsp;&nbsp; $padding_y = 5;<br />
&nbsp;&nbsp;&nbsp; $box_w = $box_w + 2 * $padding_x;<br />
&nbsp;&nbsp;&nbsp; $box_h = $box_h + 2 * $padding_y;<br />
<br />
// origin of the text = baseline of the first char<br />
&nbsp;&nbsp;&nbsp; $text_x = abs($bottom_left_x) -1 + $padding_x;<br />
&nbsp;&nbsp;&nbsp; $text_y = $box_h -1 - abs($bottom_left_y) - $padding_y;<br />
&nbsp;&nbsp;&nbsp; <br />
// mysterious correction for the characters going low like pgjq<br />
&nbsp;&nbsp;&nbsp; if(abs($bottom_left_y) &lt;= 1) $box_h--;<br />
<br />
// create the image<br />
&nbsp;&nbsp;&nbsp; $img = imagecreatetruecolor($box_w, $box_h);<br />
&nbsp;<br />
// define some colors<br />
&nbsp;&nbsp;&nbsp; $white = imagecolorallocate($img,255,255,255);<br />
&nbsp;&nbsp;&nbsp; $black = imagecolorallocate($img,0,0,0);<br />
&nbsp;&nbsp;&nbsp; $lightgrey = imagecolorallocate($img, 200, 200, 200);<br />
&nbsp;&nbsp;&nbsp; $grey = imagecolorallocate($img,100,100,100);<br />
&nbsp;&nbsp;&nbsp; $yellow = imagecolorallocate($img, 0xFF, 0xFF, 0x00);<br />
&nbsp;<br />
// attribute colors<br />
&nbsp;&nbsp;&nbsp; $font_color =&nbsp; $black;<br />
&nbsp;&nbsp;&nbsp; $padding_color =&nbsp; $lightgrey;<br />
&nbsp;&nbsp;&nbsp; $background_color =&nbsp; $yellow;<br />
&nbsp;<br />
// fill image with background color<br />
&nbsp;&nbsp;&nbsp; imagefill($img, 0, 0, $background_color);<br />
<br />
// fill image with padding color<br />
&nbsp;&nbsp;&nbsp; imagefilledrectangle($img, 0, 0, $box_w, $padding_y - 1, $padding_color); // top<br />
&nbsp;&nbsp;&nbsp; imagefilledrectangle($img, 0, 0, $padding_x - 1, $box_h - 1, $padding_color); // left<br />
&nbsp;&nbsp;&nbsp; imagefilledrectangle($img, 0, $box_h - $padding_y -1, $box_w, $box_h - 1, $padding_color); // bottom<br />
&nbsp;&nbsp;&nbsp; imagefilledrectangle($img, $box_w - $padding_x, 0, $box_w - 1, $box_h - 1, $padding_color); // right<br />
<br />
//write text<br />
imagettftext($img, $font_size, 0, $text_x, $text_y, $font_color, $font_face, $text);<br />
<br />
//rotate image<br />
&nbsp;&nbsp;&nbsp; if ($angle &gt; 0) $img = imagerotate($img, $angle, $white);<br />
<br />
// send header<br />
&nbsp;&nbsp;&nbsp; header("Content-type: image/gif");<br />
&nbsp;<br />
//sends image<br />
&nbsp;&nbsp;&nbsp; imagegif($img);<br />
&nbsp;&nbsp;&nbsp; imagedestroy($img);<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71788""></a>
  <div class="note">
   <strong class="user">Google</strong>
   <a href="#71788" class="date">15-Dec-2006 10:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">//index.php <br />
//set your year, month, daym hour, minute, second you want to cuuntdown to.<br />
<br />
//ONLY CHANGE FROM HERE<br />
</span><span class="default">$year</span><span class="keyword">=</span><span class="string">"2006"</span><span class="keyword">;<br />
</span><span class="default">$month</span><span class="keyword">=</span><span class="string">"12"</span><span class="keyword">;<br />
</span><span class="default">$day</span><span class="keyword">=</span><span class="string">"25"</span><span class="keyword">;<br />
</span><span class="default">$hour</span><span class="keyword">=</span><span class="string">"00"</span><span class="keyword">;<br />
</span><span class="default">$minute</span><span class="keyword">=</span><span class="string">"00"</span><span class="keyword">;<br />
</span><span class="default">$second</span><span class="keyword">=</span><span class="string">"00"</span><span class="keyword">;<br />
</span><span class="default">$event</span><span class="keyword">=</span><span class="string">"Christmas Day 2006"</span><span class="keyword">;<br />
<br />
</span><span class="default">$time</span><span class="keyword">=</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">$hour</span><span class="keyword">, </span><span class="default">$minute</span><span class="keyword">, </span><span class="default">$second</span><span class="keyword">, </span><span class="default">$month</span><span class="keyword">, </span><span class="default">$day</span><span class="keyword">, </span><span class="default">$year</span><span class="keyword">);<br />
<br />
</span><span class="default">$timecurrent</span><span class="keyword">=</span><span class="default">date</span><span class="keyword">(</span><span class="string">'U'</span><span class="keyword">);<br />
</span><span class="default">$cdtime</span><span class="keyword">=</span><span class="default">$time</span><span class="keyword">-</span><span class="default">$timecurrent</span><span class="keyword">;<br />
</span><span class="default">$cdmonths</span><span class="keyword">=</span><span class="default">$cddays</span><span class="keyword">/</span><span class="default">30</span><span class="keyword">;<br />
</span><span class="default">$cdyears</span><span class="keyword">=</span><span class="default">$cddays</span><span class="keyword">/</span><span class="default">365</span><span class="keyword">;<br />
<br />
</span><span class="comment">//Used this case only...<br />
</span><span class="default">$cdminutes</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">$cdtime</span><span class="keyword">/</span><span class="default">60</span><span class="keyword">);<br />
</span><span class="comment">//cdtime is seconds<br />
</span><span class="default">$cdhours</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">$cdtime</span><span class="keyword">/</span><span class="default">3600</span><span class="keyword">);<br />
</span><span class="default">$cddays</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">$cdhours</span><span class="keyword">/</span><span class="default">24</span><span class="keyword">);<br />
<br />
</span><span class="comment">//String the date<br />
</span><span class="default">$currentdate </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">'l, F j, Y'</span><span class="keyword">);<br />
</span><span class="comment">// Set the content-type<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Create the image<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">701</span><span class="keyword">, </span><span class="default">355</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Temp BGCOLOR (center of c-finder)<br />
</span><span class="default">$bg1 </span><span class="keyword">= </span><span class="default">208</span><span class="keyword">;<br />
</span><span class="default">$bg2 </span><span class="keyword">= </span><span class="default">130</span><span class="keyword">;<br />
</span><span class="default">$bg3 </span><span class="keyword">= </span><span class="default">208</span><span class="keyword">;<br />
<br />
</span><span class="default">$s1 </span><span class="keyword">= </span><span class="default">$bg1 </span><span class="keyword">- </span><span class="default">20</span><span class="keyword">;<br />
</span><span class="default">$s2 </span><span class="keyword">= </span><span class="default">$bg2 </span><span class="keyword">- </span><span class="default">20</span><span class="keyword">;<br />
</span><span class="default">$s3 </span><span class="keyword">= </span><span class="default">$bg3 </span><span class="keyword">- </span><span class="default">20</span><span class="keyword">;<br />
<br />
</span><span class="default">$t1 </span><span class="keyword">= </span><span class="default">$bg1 </span><span class="keyword">+ </span><span class="default">30</span><span class="keyword">;<br />
</span><span class="default">$t2 </span><span class="keyword">= </span><span class="default">$bg2 </span><span class="keyword">+ </span><span class="default">30</span><span class="keyword">;<br />
</span><span class="default">$t3 </span><span class="keyword">= </span><span class="default">$bg3 </span><span class="keyword">+ </span><span class="default">30</span><span class="keyword">;<br />
<br />
</span><span class="default">$cArray</span><span class="keyword">=array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c1 </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$bg1</span><span class="keyword">, </span><span class="default">$bg2</span><span class="keyword">, </span><span class="default">$bg3</span><span class="keyword">); </span><span class="comment">//Background<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c8 </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">$bg2</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">); </span><span class="comment">//Background<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c2 </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$s1</span><span class="keyword">, </span><span class="default">$s2</span><span class="keyword">, </span><span class="default">$s3</span><span class="keyword">); </span><span class="comment">//Shadow<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c3 </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$t1</span><span class="keyword">, </span><span class="default">$t2</span><span class="keyword">, </span><span class="default">$t3</span><span class="keyword">); </span><span class="comment">//Text<br />
<br />
</span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">701</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">$c1</span><span class="keyword">);<br />
<br />
</span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">701</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">, </span><span class="default">$c8</span><span class="keyword">);<br />
<br />
</span><span class="comment">// The text to draw<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">$string</span><span class="keyword">;<br />
</span><span class="comment">// Replace path by your own font path<br />
</span><span class="default">$fnum </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">);<br />
</span><span class="default">$font </span><span class="keyword">= </span><span class="string">"/f/font (</span><span class="default">$fnum</span><span class="string">)"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Add some shadow to the text<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">29</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">17</span><span class="keyword">, </span><span class="default">42</span><span class="keyword">, </span><span class="default">$c2</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"Today is:"</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">28</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">, </span><span class="default">40</span><span class="keyword">, </span><span class="default">$c3</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"Today is:"</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">29</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">17</span><span class="keyword">, </span><span class="default">92</span><span class="keyword">, </span><span class="default">$c2</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"...</span><span class="default">$currentdate</span><span class="string">..."</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">28</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">, </span><span class="default">90</span><span class="keyword">, </span><span class="default">$c3</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"...</span><span class="default">$currentdate</span><span class="string">..."</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">29</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">17</span><span class="keyword">, </span><span class="default">142</span><span class="keyword">, </span><span class="default">$c2</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"So there are exactly:"</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">28</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">, </span><span class="default">140</span><span class="keyword">, </span><span class="default">$c3</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"So there are exactly:"</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">29</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">17</span><span class="keyword">, </span><span class="default">192</span><span class="keyword">, </span><span class="default">$c2</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"</span><span class="default">$cddays</span><span class="string"> with just..."</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">28</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">, </span><span class="default">190</span><span class="keyword">, </span><span class="default">$c3</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"</span><span class="default">$cddays</span><span class="string"> days with just..."</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">29</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">17</span><span class="keyword">, </span><span class="default">242</span><span class="keyword">, </span><span class="default">$c2</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"</span><span class="default">$cdminutes</span><span class="string"> minutes and only..."</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">28</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">, </span><span class="default">240</span><span class="keyword">, </span><span class="default">$c3</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"</span><span class="default">$cdminutes</span><span class="string"> minutes and only..."</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">29</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">17</span><span class="keyword">, </span><span class="default">292</span><span class="keyword">, </span><span class="default">$c2</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"</span><span class="default">$cdseconds</span><span class="string"> seconds until..."</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">28</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">, </span><span class="default">290</span><span class="keyword">, </span><span class="default">$c3</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"</span><span class="default">$cdseconds</span><span class="string"> seconds until..."</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">29</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">17</span><span class="keyword">, </span><span class="default">342</span><span class="keyword">, </span><span class="default">$c2</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"- + </span><span class="default">$event</span><span class="string"> + -"</span><span class="keyword">);<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">28</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">, </span><span class="default">340</span><span class="keyword">, </span><span class="default">$c3</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="string">"- + </span><span class="default">$event</span><span class="string"> + -"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Using imagepng() results in clearer text compared with imagejpeg()<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70731""></a>
  <div class="note">
   <strong class="user">info at 555webdesign dot com</strong>
   <a href="#70731" class="date">25-Oct-2006 07:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks terereese. it took me over two hours to figure that one out.<br />
it worked locally: imagefilledrectangle(imagresource, int x1, int x2, int y1, inty2, color)<br />
<br />
BUT remote on my provider only this worked: imagefilledrectangle(imagresource, int x1, int y2, int x1, inty1, color)<br />
<br />
Any ideas why and where?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68066""></a>
  <div class="note">
   <strong class="user">terereese at hotmail dot com</strong>
   <a href="#68066" class="date">12-Jul-2006 05:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I would like to inform developers about a problem I encountered when trying to use imagefilledrectangle.<br />
<br />
I noted that the order in which the start and end y coordinates are listed is extremely important.<br />
as in the statements below.<br />
if($this-&gt;d_values[$i]['unit_value'] &lt; 0)<br />
imagefilledrectangle($this-&gt;img,$position_x, $start_y , $end_x, $end_y ,$d_color);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
imagefilledrectangle($this-&gt;img, $position_x,$ end_y , $end_x, $start_y,$d_colour);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
<br />
Thanks</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65557""></a>
  <div class="note">
   <strong class="user">administrador(ensaimada)sphoera(punt)com</strong>
   <a href="#65557" class="date">03-May-2006 12:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've made a function to make full color gradients:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// The image must be in truecolor mode!!<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">gradient_region</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">,</span><span class="default">$src_color</span><span class="keyword">, </span><span class="default">$dest_color</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$src_alpha </span><span class="keyword">= (</span><span class="default">$src_color</span><span class="keyword">) &gt;&gt; </span><span class="default">24</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$src_red </span><span class="keyword">= (</span><span class="default">$src_color </span><span class="keyword">&amp; </span><span class="default">0xFF0000</span><span class="keyword">) &gt;&gt; </span><span class="default">16</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$src_green </span><span class="keyword">= (</span><span class="default">$src_color </span><span class="keyword">&amp; </span><span class="default">0x00FF00</span><span class="keyword">) &gt;&gt; </span><span class="default">8</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$src_blue </span><span class="keyword">= (</span><span class="default">$src_color </span><span class="keyword">&amp; </span><span class="default">0x0000FF</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dest_alpha </span><span class="keyword">= (</span><span class="default">$dest_color</span><span class="keyword">) &gt;&gt; </span><span class="default">24</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dest_red </span><span class="keyword">= (</span><span class="default">$dest_color </span><span class="keyword">&amp; </span><span class="default">0xFF0000</span><span class="keyword">) &gt;&gt; </span><span class="default">16</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dest_green </span><span class="keyword">= (</span><span class="default">$dest_color </span><span class="keyword">&amp; </span><span class="default">0x00FF00</span><span class="keyword">) &gt;&gt; </span><span class="default">8</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dest_blue </span><span class="keyword">= (</span><span class="default">$dest_color </span><span class="keyword">&amp; </span><span class="default">0x0000FF</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$inc_alpha </span><span class="keyword">= (</span><span class="default">$dest_alpha </span><span class="keyword">- </span><span class="default">$src_alpha</span><span class="keyword">) / </span><span class="default">$width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$inc_red </span><span class="keyword">= (</span><span class="default">$dest_red </span><span class="keyword">- </span><span class="default">$src_red</span><span class="keyword">)/</span><span class="default">$width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$inc_green </span><span class="keyword">= (</span><span class="default">$dest_green </span><span class="keyword">- </span><span class="default">$src_green</span><span class="keyword">)/</span><span class="default">$width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$inc_blue </span><span class="keyword">= (</span><span class="default">$dest_blue </span><span class="keyword">- </span><span class="default">$src_blue</span><span class="keyword">)/</span><span class="default">$width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// If you need more performance, the step can be increased<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$width</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$src_alpha </span><span class="keyword">+= </span><span class="default">$inc_alpha</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$src_blue </span><span class="keyword">+= </span><span class="default">$inc_blue</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$src_green </span><span class="keyword">+= </span><span class="default">$inc_green</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$src_red </span><span class="keyword">+= </span><span class="default">$inc_red</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x</span><span class="keyword">+</span><span class="default">$i</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x</span><span class="keyword">+</span><span class="default">$i</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">+</span><span class="default">$height</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$src_red</span><span class="keyword">,</span><span class="default">$src_green</span><span class="keyword">,</span><span class="default">$src_blue</span><span class="keyword">,</span><span class="default">$src_alpha</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
More functions at <a href="http://www.sphoera.com" rel="nofollow" target="_blank">http://www.sphoera.com</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57743""></a>
  <div class="note">
   <strong class="user">me [a.t.] forestfactory [d.o.t.] de</strong>
   <a href="#57743" class="date">13-Oct-2005 01:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of PHP 5, it seems to be no longer necessary to draw the rectangle from the upper left to the lower right corner. This led me into big trouble porting a script developed under PHP 5 to PHP 4.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42815""></a>
  <div class="note">
   <strong class="user">michal dot kocarek at seznam dot cz</strong>
   <a href="#42815" class="date">30-May-2004 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to draw a rectangle with rounded corners, you can use this simple function... <br />
Rectangle starts at x1y1 and ends at x2y2. $radius defines radius of circled corner. <br />
<br />
&lt;?<br />
<br />
function ImageRectangleWithRoundedCorners(&amp;$im, $x1, $y1, $x2, $y2, $radius, $color) {<br />
// draw rectangle without corners<br />
imagefilledrectangle($im, $x1+$radius, $y1, $x2-$radius, $y2, $color);<br />
imagefilledrectangle($im, $x1, $y1+$radius, $x2, $y2-$radius, $color);<br />
// draw circled corners<br />
imagefilledellipse($im, $x1+$radius, $y1+$radius, $radius*2, $radius*2, $color);<br />
imagefilledellipse($im, $x2-$radius, $y1+$radius, $radius*2, $radius*2, $color);<br />
imagefilledellipse($im, $x1+$radius, $y2-$radius, $radius*2, $radius*2, $color);<br />
imagefilledellipse($im, $x2-$radius, $y2-$radius, $radius*2, $radius*2, $color);<br />
}<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39123""></a>
  <div class="note">
   <strong class="user">booga</strong>
   <a href="#39123" class="date">18-Jan-2004 02:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a simple way of using imagerectangle to create a percentage bar<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//this needs to reside in its own php page<br />
//you can include that php page in your html as you would an image:<br />
//&lt;IMG SRC="ratingpng.php?rating=25.2" border="0"&gt;<br />
<br />
</span><span class="keyword">function </span><span class="default">drawRating</span><span class="keyword">(</span><span class="default">$rating</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$image </span><span class="keyword">= </span><span class="default">imagecreate</span><span class="keyword">(</span><span class="default">102</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$back </span><span class="keyword">= </span><span class="default">ImageColorAllocate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$border </span><span class="keyword">= </span><span class="default">ImageColorAllocate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$red </span><span class="keyword">= </span><span class="default">ImageColorAllocate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">60</span><span class="keyword">,</span><span class="default">75</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fill </span><span class="keyword">= </span><span class="default">ImageColorAllocate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">,</span><span class="default">44</span><span class="keyword">,</span><span class="default">81</span><span class="keyword">,</span><span class="default">150</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ImageFilledRectangle</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">101</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">,</span><span class="default">$back</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ImageFilledRectangle</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">$rating</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">,</span><span class="default">$fill</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ImageRectangle</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">101</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">,</span><span class="default">$border</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagePNG</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">Header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
</span><span class="default">drawRating</span><span class="keyword">(</span><span class="default">$rating</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20333""></a>
  <div class="note">
   <strong class="user">ivank at 2xtreme dot net</strong>
   <a href="#20333" class="date">31-Mar-2002 01:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As stated above, it needs to go from the top left corner to the bottom right corner. Just use this to flip it if neccessary:<br />
<br />
// flip them if neccessary (x3, y3 are temp vars)<br />
if($x1 &gt; $x2) { $x3 = $x2; $x2 = $x1; $x1 = $x3; }<br />
if($y1 &gt; $y2) { $y3 = $y2; $y2 = $y1; $y1 = $y3; }<br />
ImageFilledRectangle($im, $x1, $y1, $x2, $y2, $color);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="17216""></a>
  <div class="note">
   <strong class="user">saramg at uclink dot berkeley dot edu</strong>
   <a href="#17216" class="date">30-Nov-2001 04:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Important quirk to note:<br />
<br />
While imagerectangle will allow you to use a different order of your coordinates (such as bottom-left to upper-right), imagefilledrectangle will only work correctly if you use top-left to bottom-right as indicated in the docs.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.imagefilledpolygon.html">imagefilledpolygon</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.imagefilltoborder.html">imagefilltoborder</a></div>
 <div class="up"><a href="ref.image.html">GD および Image 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
