<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>画像処理 (GD)</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.read-exif-data.html">read_exif_data</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="intro.image.html">導入</a></div>
 <div class="up"><a href="refs.utilspec.image.html">画像処理および作成</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="book.image" class="book">
 
 <h1 class="title">画像処理 (GD)</h1>
 
 
 
 

 
 
 









 





 









 








<ul class="chunklist chunklist_book"><li><a href="intro.image.html">導入</a></li><li><a href="image.setup.html">インストール/設定</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="image.requirements.html">要件</a></li><li><a href="image.installation.html">インストール手順</a></li><li><a href="image.configuration.html">実行時設定</a></li><li><a href="image.resources.html">リソース型</a></li></ul></li><li><a href="image.constants.html">定義済み定数</a></li><li><a href="image.examples.html">例</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="image.examples-png.html">PHP による PNG の生成</a></li><li><a href="image.examples-watermark.html">アルファチャネルを使用した、画像へのすかしの追加</a></li><li><a href="image.examples.merged-watermark.html">imagecopymerge による半透明なすかしの作成</a></li></ul></li><li><a href="ref.image.html">GD および Image 関数</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="function.gd-info.html">gd_info</a> — 現在インストールされているGDライブラリに関する情報を取得する</li><li><a href="function.getimagesize.html">getimagesize</a> — 画像の大きさを取得する</li><li><a href="function.getimagesizefromstring.html">getimagesizefromstring</a> — 画像の大きさを文字列から取得する</li><li><a href="function.image-type-to-extension.html">image_type_to_extension</a> — 画像形式からファイルの拡張子を取得する</li><li><a href="function.image-type-to-mime-type.html">image_type_to_mime_type</a> — getimagesize, exif_read_data, exif_thumbnail, exif_imagetypeから返される
   画像形式のMIMEタイプを取得する</li><li><a href="function.image2wbmp.html">image2wbmp</a> — 画像をブラウザあるいはファイルに出力する</li><li><a href="function.imageaffine.html">imageaffine</a> — 元の画像を、オプションのクリッピング領域を使ってアフィン変換した画像を返す</li><li><a href="function.imageaffinematrixconcat.html">imageaffinematrixconcat</a> — 二つの行列を連結する (複数の操作を一度に行う)</li><li><a href="function.imageaffinematrixget.html">imageaffinematrixget</a> — 元の画像を、オプションのクリッピング領域を使ってアフィン変換した画像を返す</li><li><a href="function.imagealphablending.html">imagealphablending</a> — イメージのブレンドモードを設定する</li><li><a href="function.imageantialias.html">imageantialias</a> — アンチエイリアス機能を使用すべきかどうかを判断する</li><li><a href="function.imagearc.html">imagearc</a> — 部分楕円を描画する</li><li><a href="function.imagechar.html">imagechar</a> — 水平に文字を描画する</li><li><a href="function.imagecharup.html">imagecharup</a> — 垂直に文字を描画する</li><li><a href="function.imagecolorallocate.html">imagecolorallocate</a> — 画像で使用する色を作成する</li><li><a href="function.imagecolorallocatealpha.html">imagecolorallocatealpha</a> — 画像で使用する色を透過度を指定して作成する</li><li><a href="function.imagecolorat.html">imagecolorat</a> — ピクセルの色のインデックスを取得する</li><li><a href="function.imagecolorclosest.html">imagecolorclosest</a> — 指定した色に最も近い色のインデックスを取得する</li><li><a href="function.imagecolorclosestalpha.html">imagecolorclosestalpha</a> — 指定した色+アルファ値に最も近い色のインデックスを取得する</li><li><a href="function.imagecolorclosesthwb.html">imagecolorclosesthwb</a> — 色合い、白、黒を有する色のインデックスを得る</li><li><a href="function.imagecolordeallocate.html">imagecolordeallocate</a> — イメージの色リソースを開放する</li><li><a href="function.imagecolorexact.html">imagecolorexact</a> — 指定した色のインデックスを取得する</li><li><a href="function.imagecolorexactalpha.html">imagecolorexactalpha</a> — 指定した色+アルファ値のインデックスを取得する</li><li><a href="function.imagecolormatch.html">imagecolormatch</a> — パレットイメージの色を True カラーイメージに近づける</li><li><a href="function.imagecolorresolve.html">imagecolorresolve</a> — 指定した色または出来るだけ近い色のインデックスを得る</li><li><a href="function.imagecolorresolvealpha.html">imagecolorresolvealpha</a> — 指定した色+アルファ値または最も近い色のインデックスを取得する</li><li><a href="function.imagecolorset.html">imagecolorset</a> — 指定したパレットインデックスの色を設定する</li><li><a href="function.imagecolorsforindex.html">imagecolorsforindex</a> — カラーインデックスからカラーを取得する</li><li><a href="function.imagecolorstotal.html">imagecolorstotal</a> — 画像パレットの色数を検出する</li><li><a href="function.imagecolortransparent.html">imagecolortransparent</a> — 透明色を定義する</li><li><a href="function.imageconvolution.html">imageconvolution</a> — div および offset の係数を使用し、3x3 の畳み込み配列を適用する</li><li><a href="function.imagecopy.html">imagecopy</a> — 画像の一部をコピーする</li><li><a href="function.imagecopymerge.html">imagecopymerge</a> — イメージの一部をコピー、マージする</li><li><a href="function.imagecopymergegray.html">imagecopymergegray</a> — グレースケールでイメージの一部をコピー、マージする</li><li><a href="function.imagecopyresampled.html">imagecopyresampled</a> — 再サンプリングを行いイメージの一部をコピー、伸縮する</li><li><a href="function.imagecopyresized.html">imagecopyresized</a> — 画像の一部をコピーしサイズを変更する</li><li><a href="function.imagecreate.html">imagecreate</a> — パレットを使用する新規画像を作成する</li><li><a href="function.imagecreatefromgd2.html">imagecreatefromgd2</a> — GD2 ファイルまたは URL から新規イメージを生成する</li><li><a href="function.imagecreatefromgd2part.html">imagecreatefromgd2part</a> — GD2 ファイルまたは URL の指定した部分から新規イメージを生成する</li><li><a href="function.imagecreatefromgd.html">imagecreatefromgd</a> — GD ファイルまたは URL から新規イメージを生成する</li><li><a href="function.imagecreatefromgif.html">imagecreatefromgif</a> — 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromjpeg.html">imagecreatefromjpeg</a> — 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefrompng.html">imagecreatefrompng</a> — 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromstring.html">imagecreatefromstring</a> — 文字列の中のイメージストリームから新規イメージを作成する</li><li><a href="function.imagecreatefromwbmp.html">imagecreatefromwbmp</a> — 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromwebp.html">imagecreatefromwebp</a> — 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromxbm.html">imagecreatefromxbm</a> — 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromxpm.html">imagecreatefromxpm</a> — 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatetruecolor.html">imagecreatetruecolor</a> — TrueColor イメージを新規に作成する</li><li><a href="function.imagecrop.html">imagecrop</a> — 座標とサイズを指定して、画像をクロップする</li><li><a href="function.imagecropauto.html">imagecropauto</a> — 利用可能なモードを指定して、画像を自動的にクロップする</li><li><a href="function.imagedashedline.html">imagedashedline</a> — 破線を描画する</li><li><a href="function.imagedestroy.html">imagedestroy</a> — 画像を破棄する</li><li><a href="function.imageellipse.html">imageellipse</a> — 楕円を描画する</li><li><a href="function.imagefill.html">imagefill</a> — 塗り潰す</li><li><a href="function.imagefilledarc.html">imagefilledarc</a> — 楕円弧を描画し、塗りつぶす</li><li><a href="function.imagefilledellipse.html">imagefilledellipse</a> — 塗りつぶされた楕円を描画する</li><li><a href="function.imagefilledpolygon.html">imagefilledpolygon</a> — 塗りつぶした多角形を描画する</li><li><a href="function.imagefilledrectangle.html">imagefilledrectangle</a> — 塗りつぶした矩形を描画する</li><li><a href="function.imagefilltoborder.html">imagefilltoborder</a> — 特定色で塗りつぶす</li><li><a href="function.imagefilter.html">imagefilter</a> — 画像にフィルタを適用する</li><li><a href="function.imageflip.html">imageflip</a> — 指定したモードで画像を反転させる</li><li><a href="function.imagefontheight.html">imagefontheight</a> — フォントの高さを取得する</li><li><a href="function.imagefontwidth.html">imagefontwidth</a> — フォントの幅を取得する</li><li><a href="function.imageftbbox.html">imageftbbox</a> — freetype2 によるフォントを用いたテキストを囲む箱を取得する</li><li><a href="function.imagefttext.html">imagefttext</a> — FreeType 2 によるフォントを用いてイメージにテキストを描画する</li><li><a href="function.imagegammacorrect.html">imagegammacorrect</a> — GD イメージにガンマ補正を適用する</li><li><a href="function.imagegd2.html">imagegd2</a> — GD2 イメージをブラウザまたはファイルに出力する</li><li><a href="function.imagegd.html">imagegd</a> — GD イメージをブラウザまたはファイルに出力する</li><li><a href="function.imagegif.html">imagegif</a> — 画像をブラウザあるいはファイルに出力する</li><li><a href="function.imagegrabscreen.html">imagegrabscreen</a> — 画面全体をキャプチャする</li><li><a href="function.imagegrabwindow.html">imagegrabwindow</a> — ウィンドウをキャプチャする</li><li><a href="function.imageinterlace.html">imageinterlace</a> — インターレースを有効もしくは無効にする</li><li><a href="function.imageistruecolor.html">imageistruecolor</a> — 画像が truecolor かどうか調べる</li><li><a href="function.imagejpeg.html">imagejpeg</a> — 画像をブラウザあるいはファイルに出力する</li><li><a href="function.imagelayereffect.html">imagelayereffect</a> — アルファブレンディングフラグを設定し、
   libgd にバンドルされているレイヤ効果を使用する</li><li><a href="function.imageline.html">imageline</a> — 直線を描画する</li><li><a href="function.imageloadfont.html">imageloadfont</a> — 新しいフォントを読み込む</li><li><a href="function.imagepalettecopy.html">imagepalettecopy</a> — あるイメージから他のイメージにパレットをコピーする</li><li><a href="function.imagepalettetotruecolor.html">imagepalettetotruecolor</a> — パレット形式の画像を true color に変換する</li><li><a href="function.imagepng.html">imagepng</a> — PNG イメージをブラウザまたはファイルに出力する</li><li><a href="function.imagepolygon.html">imagepolygon</a> — 多角形を描画する</li><li><a href="function.imagepsbbox.html">imagepsbbox</a> — PostScript Type1 フォントを用いてテキスト矩形のバウンディングボックスを指定する</li><li><a href="function.imagepsencodefont.html">imagepsencodefont</a> — フォントの文字エンコードベクトルを変更する</li><li><a href="function.imagepsextendfont.html">imagepsextendfont</a> — フォントを展開または圧縮する</li><li><a href="function.imagepsfreefont.html">imagepsfreefont</a> — PostScript Type 1 フォント用メモリを解放する</li><li><a href="function.imagepsloadfont.html">imagepsloadfont</a> — ファイルから PostScript Type 1 フォントをロードする</li><li><a href="function.imagepsslantfont.html">imagepsslantfont</a> — フォントを傾ける</li><li><a href="function.imagepstext.html">imagepstext</a> — PostScript Type1 フォントを用いて画像の上に文字列を描く</li><li><a href="function.imagerectangle.html">imagerectangle</a> — 矩形を描画する</li><li><a href="function.imagerotate.html">imagerotate</a> — 指定された角度で画像を回転する</li><li><a href="function.imagesavealpha.html">imagesavealpha</a> — PNG 画像を保存する際に（単一色の透過設定ではない）完全な
   アルファチャネル情報を保存するフラグを設定する</li><li><a href="function.imagescale.html">imagescale</a> — 幅と高さを指定して、画像の縮尺を変更する</li><li><a href="function.imagesetbrush.html">imagesetbrush</a> — 線の描画用にブラシイメージを設定する</li><li><a href="function.imagesetinterpolation.html">imagesetinterpolation</a> — 補間方法を設定する</li><li><a href="function.imagesetpixel.html">imagesetpixel</a> — 点を生成する</li><li><a href="function.imagesetstyle.html">imagesetstyle</a> — 線描画用のスタイルを設定する</li><li><a href="function.imagesetthickness.html">imagesetthickness</a> — 線描画用の線幅を設定する</li><li><a href="function.imagesettile.html">imagesettile</a> — 塗りつぶし用のイメージを設定する</li><li><a href="function.imagestring.html">imagestring</a> — 文字列を水平に描画する</li><li><a href="function.imagestringup.html">imagestringup</a> — 文字列を垂直に描画する</li><li><a href="function.imagesx.html">imagesx</a> — 画像の幅を取得する</li><li><a href="function.imagesy.html">imagesy</a> — 画像の高さを取得する</li><li><a href="function.imagetruecolortopalette.html">imagetruecolortopalette</a> — TrueColor イメージをパレットイメージに変換する</li><li><a href="function.imagettfbbox.html">imagettfbbox</a> — TypeType フォントを使用したテキストの bounding box を生成する</li><li><a href="function.imagettftext.html">imagettftext</a> — TrueType フォントを使用してテキストを画像に書き込む</li><li><a href="function.imagetypes.html">imagetypes</a> — この PHP がサポートしている画像形式を返す</li><li><a href="function.imagewbmp.html">imagewbmp</a> — 画像をブラウザあるいはファイルに出力する</li><li><a href="function.imagewebp.html">imagewebp</a> — WebP 画像をブラウザあるいはファイルに出力する</li><li><a href="function.imagexbm.html">imagexbm</a> — XBM 画像をブラウザあるいはファイルに出力する</li><li><a href="function.iptcembed.html">iptcembed</a> — バイナリ IPTC データを JPEG イメージに埋めこむ</li><li><a href="function.iptcparse.html">iptcparse</a> — バイナリの IPTC ブロックのタグをパースする</li><li><a href="function.jpeg2wbmp.html">jpeg2wbmp</a> — JPEG イメージファイルから WBMP イメージファイルに変換する</li><li><a href="function.png2wbmp.html">png2wbmp</a> — PNG イメージファイルから WBMP イメージファイルに変換する</li></ul></li></ul></div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="112952""></a>
  <div class="note">
   <strong class="user">zsolt dot trenyik at gmail dot com</strong>
   <a href="#112952" class="date">12-Aug-2013 03:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
According to&nbsp; kurdtpage at gmail dot com, we faced a fairly strange behavior of GD. We saved an incluce file incorrectly, and everything worked (OCI8, other php functions) except GD. It took one and half day to find the reason, at the end commenting out the require part of the main file. <br />
<br />
The solution was: we took a HEX editor to see if there is a problem with that .inc file. There was some crazy invisible characters before the <span class="default">&lt;?php tag</span><span class="keyword">, </span><span class="default">signing that the text editor saved the file in utf format</span><span class="keyword">. </span><span class="default">These characters cannot be deleted</span><span class="keyword">, </span><span class="default">we had to open a </span><span class="keyword">new </span><span class="default">file in eclipse </span><span class="keyword">(</span><span class="default">notepad</span><span class="keyword">++ </span><span class="default">also works right</span><span class="keyword">), </span><span class="default">copy the visible part of the file to it</span><span class="keyword">, </span><span class="default">replace them</span><span class="keyword">, </span><span class="default">ready</span><span class="keyword">. <br />
<br />
</span><span class="default">Maybe this detailed warning helps somebody</span><span class="keyword">.</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107069""></a>
  <div class="note">
   <strong class="user">herbert dot walde at googlemail dot com</strong>
   <a href="#107069" class="date">04-Jan-2012 08:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In case your script is using output-buffering-functions somewhere, then you have to clear the buffer first ( with ob_clear() ), before outputting an image with a function like imagepng(). <br />
<br />
And you should make sure that no buffer will get send after outputing an image by using the ob_end_flush()-function.<br />
<br />
Furthermore you should check if a buffer has already been flushed somewhere before. This can be done using the headers_sent()-function.<br />
<br />
Here is the full solution:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(</span><span class="default">headers_sent</span><span class="keyword">()){<br />
&nbsp;&nbsp;&nbsp; die(</span><span class="string">'Headers have been send somewhere within my script'</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">ob_clean</span><span class="keyword">(); </span><span class="comment">//Clears the buffer<br />
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-type: image/png'</span><span class="keyword">);<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,&nbsp; </span><span class="default">NULL</span><span class="keyword">);<br />
<br />
</span><span class="default">ob_end_flush</span><span class="keyword">(); </span><span class="comment">//Now we send the header and image plus we make sure that nothing will get send from now on (including possible shutdown-functions and __destruct()-methods) till the end of page-execution<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104869""></a>
  <div class="note">
   <strong class="user">donatj at gmail dot com</strong>
   <a href="#104869" class="date">12-Jul-2011 10:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
UTF-8 is fine with GD - as well as any other Unicode transformation format - you just need to ensure your saved file doesn't contain the dreaded byte order mark.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103685""></a>
  <div class="note">
   <strong class="user">kurdtpage at gmail dot com</strong>
   <a href="#103685" class="date">28-Apr-2011 07:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using GD, please make sure of the following things:<br />
<br />
1. The file that is used to manipulate images is saved as ANSI format and not UTF-8<br />
2. There is no space in front of the opening tag &lt;?php</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98153""></a>
  <div class="note">
   <strong class="user">mac_doggie at hotmail dot com</strong>
   <a href="#98153" class="date">28-May-2010 04:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A way to read the color of a pixel:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $img </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="string">"image1.png"</span><span class="keyword">);<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; </span><span class="default">$w </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$h </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">$h</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; for(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">$w</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$r </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$g </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">$rgb </span><span class="keyword">&amp; </span><span class="default">0xFF</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"#"</span><span class="keyword">.</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"0"</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">-</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">))).</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">).<br />
</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"0"</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">-</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$g</span><span class="keyword">))).</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$g</span><span class="keyword">).<br />
</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"0"</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">-</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">))).</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">).</span><span class="string">","</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;br /&gt;\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
[EDIT BY thiago: merged two notes from same submitter.]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97137""></a>
  <div class="note">
   <strong class="user">mail at ecross dot nl</strong>
   <a href="#97137" class="date">03-Apr-2010 04:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
hello there,<br />
i made a function to create a gradient image.<br />
<br />
description:<br />
gradient(int image_width, int image_height, <br />
int start_red, int start_green, int start_blue, <br />
int end_red, int end_green, int end_blue, <br />
bool vertical)<br />
<br />
function:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">gradient</span><span class="keyword">(</span><span class="default">$image_width</span><span class="keyword">, </span><span class="default">$image_height</span><span class="keyword">,</span><span class="default">$c1_r</span><span class="keyword">, </span><span class="default">$c1_g</span><span class="keyword">, </span><span class="default">$c1_b</span><span class="keyword">, </span><span class="default">$c2_r</span><span class="keyword">, </span><span class="default">$c2_g</span><span class="keyword">, </span><span class="default">$c2_b</span><span class="keyword">, </span><span class="default">$vertical</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">)<br />
{<br />
</span><span class="comment">// first: lets type cast;<br />
</span><span class="default">$image_width </span><span class="keyword">= (integer)</span><span class="default">$image_width</span><span class="keyword">;<br />
</span><span class="default">$image_height </span><span class="keyword">= (integer)</span><span class="default">$image_height</span><span class="keyword">;<br />
</span><span class="default">$c1_r </span><span class="keyword">= (integer)</span><span class="default">$c1_r</span><span class="keyword">;<br />
</span><span class="default">$c1_g </span><span class="keyword">= (integer)</span><span class="default">$c1_g</span><span class="keyword">;<br />
</span><span class="default">$c1_b </span><span class="keyword">= (integer)</span><span class="default">$c1_b</span><span class="keyword">;<br />
</span><span class="default">$c2_r </span><span class="keyword">= (integer)</span><span class="default">$c2_r</span><span class="keyword">;<br />
</span><span class="default">$c2_g </span><span class="keyword">= (integer)</span><span class="default">$c2_g</span><span class="keyword">;<br />
</span><span class="default">$c2_b </span><span class="keyword">= (integer)</span><span class="default">$c2_b</span><span class="keyword">;<br />
</span><span class="default">$vertical </span><span class="keyword">= (bool)</span><span class="default">$vertical</span><span class="keyword">;<br />
<br />
</span><span class="comment">// create a image<br />
</span><span class="default">$image&nbsp; </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$image_width</span><span class="keyword">, </span><span class="default">$image_height</span><span class="keyword">); <br />
<br />
</span><span class="comment">// make the gradient<br />
</span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$image_height</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) <br />
{ <br />
</span><span class="default">$color_r </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$i </span><span class="keyword">* (</span><span class="default">$c2_r</span><span class="keyword">-</span><span class="default">$c1_r</span><span class="keyword">) / </span><span class="default">$image_height</span><span class="keyword">)+</span><span class="default">$c1_r</span><span class="keyword">;<br />
</span><span class="default">$color_g </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$i </span><span class="keyword">* (</span><span class="default">$c2_g</span><span class="keyword">-</span><span class="default">$c1_g</span><span class="keyword">) / </span><span class="default">$image_height</span><span class="keyword">)+</span><span class="default">$c1_g</span><span class="keyword">;<br />
</span><span class="default">$color_b </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$i </span><span class="keyword">* (</span><span class="default">$c2_b</span><span class="keyword">-</span><span class="default">$c1_b</span><span class="keyword">) / </span><span class="default">$image_height</span><span class="keyword">)+</span><span class="default">$c1_b</span><span class="keyword">;<br />
<br />
</span><span class="default">$color </span><span class="keyword">= </span><span class="default">ImageColorAllocate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$color_r</span><span class="keyword">, </span><span class="default">$color_g</span><span class="keyword">, </span><span class="default">$color_b</span><span class="keyword">);<br />
</span><span class="default">imageline</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$image_width</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">);<br />
} <br />
<br />
</span><span class="comment"># Prints out all the figures and picture and frees memory <br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-type: image/png'</span><span class="keyword">); <br />
<br />
if(</span><span class="default">$vertical</span><span class="keyword">){</span><span class="default">$image </span><span class="keyword">= </span><span class="default">imagerotate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">90</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);}<br />
</span><span class="default">ImagePNG</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">); <br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">); <br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87566""></a>
  <div class="note">
   <strong class="user">Thomas</strong>
   <a href="#87566" class="date">10-Dec-2008 11:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You know, maybe this goes without saying, but I thought I would drop a note in here.&nbsp; When developing code to resize images, it is best not to use GD.&nbsp; When using the current GD methodologies, you are reading content from an image and manipulating it.&nbsp; By then writing that content to a brand new file, you are losing the EXIF data.<br />
<br />
For purposes when you want to retain EXIF data, it is recommended that you compile in and use the PECL Imagick extension.&nbsp; It has great resizing methods built right in and the EXIF data is retained.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86564""></a>
  <div class="note">
   <strong class="user">code at ashleyhunt dot co dot uk</strong>
   <a href="#86564" class="date">24-Oct-2008 03:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have been looking to send the output from GD to a text string without proxying via a file or to a browser.<br />
<br />
I have come up with a solution.<br />
<br />
This code buffers the output between the ob_start() and ob_end() functions into ob_get_contents()<br />
<br />
See the example below<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Create a test source image for this example<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">300</span><span class="keyword">, </span><span class="default">50</span><span class="keyword">);<br />
</span><span class="default">$text_color </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">233</span><span class="keyword">, </span><span class="default">14</span><span class="keyword">, </span><span class="default">91</span><span class="keyword">);<br />
</span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">,&nbsp; </span><span class="string">'A Simple Text String'</span><span class="keyword">, </span><span class="default">$text_color</span><span class="keyword">);<br />
<br />
</span><span class="comment">// start buffering<br />
</span><span class="default">ob_start</span><span class="keyword">();<br />
</span><span class="comment">// output jpeg (or any other chosen) format &amp; quality<br />
</span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">85</span><span class="keyword">);<br />
</span><span class="comment">// capture output to string<br />
</span><span class="default">$contents </span><span class="keyword">= </span><span class="default">ob_get_contents</span><span class="keyword">();<br />
</span><span class="comment">// end capture<br />
</span><span class="default">ob_end_clean</span><span class="keyword">();<br />
<br />
</span><span class="comment">// be tidy; free up memory<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
<br />
</span><span class="comment">// lastly (for the example) we are writing the string to a file<br />
</span><span class="default">$fh </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"./temp/img.jpg"</span><span class="keyword">, </span><span class="string">"a+" </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">( </span><span class="default">$fh</span><span class="keyword">, </span><span class="default">$contents </span><span class="keyword">);<br />
</span><span class="default">fclose</span><span class="keyword">( </span><span class="default">$fh </span><span class="keyword">);<br />
</span><span class="default">?&gt;</span> <br />
<br />
Enjoy!<br />
Ashley</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.read-exif-data.html">read_exif_data</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="intro.image.html">導入</a></div>
 <div class="up"><a href="refs.utilspec.image.html">画像処理および作成</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
