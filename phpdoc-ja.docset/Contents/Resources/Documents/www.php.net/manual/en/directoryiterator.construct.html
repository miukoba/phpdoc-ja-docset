<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>パスから新規ディレクトリイテレータを生成する</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="class.directoryiterator.html">DirectoryIterator</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="directoryiterator.current.html">DirectoryIterator::current</a></div>
 <div class="up"><a href="class.directoryiterator.html">DirectoryIterator</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="directoryiterator.construct" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">DirectoryIterator::__construct</h1>
  <p class="verinfo">(PHP 5)</p><p class="refpurpose"><span class="refname">DirectoryIterator::__construct</span> &mdash; <span class="dc-title">パスから新規ディレクトリイテレータを生成する</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-directoryiterator.construct-description">
  <h3 class="title">説明</h3>
  <div class="constructorsynopsis dc-description">
   <span class="modifier">public</span>  <span class="methodname"><strong>DirectoryIterator::__construct()</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$path</code></span>
   )</div>


  <p class="para rdfs-comment">
   パスから新規ディレクトリイテレータを生成します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-directoryiterator.construct-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><em><code class="parameter">path</code></em></span>
     <dd>

      <p class="para">
       処理したいディレクトリのパス。
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-directoryiterator.construct-errors">
  <h3 class="title">エラー / 例外</h3>
  <p class="para">
   <em><code class="parameter">path</code></em> が開けない場合に
   <a href="class.unexpectedvalueexception.html" class="classname">UnexpectedValueException</a> をスローします。
  </p>
  <p class="para">
   <em><code class="parameter">path</code></em> が空文字列の場合に
   <a href="class.runtimeexception.html" class="classname">RuntimeException</a> をスローします。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-directoryiterator.construct-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.0</td>
       <td>
        <em><code class="parameter">path</code></em> を開けない場合に
        <a href="class.unexpectedvalueexception.html" class="classname">UnexpectedValueException</a> をスローします。
       </td>
      </tr>

      <tr>
       <td>5.1.3</td>
       <td>
        <em><code class="parameter">path</code></em> が空文字列の場合に
        <a href="class.runtimeexception.html" class="classname">RuntimeException</a> をスローします。
       </td>
      </tr>

      <tr>
       <td>5.1.0</td>
       <td>
        エラーが発生したときに <a href="class.runtimeexception.html" class="classname">RuntimeException</a> をスローします。
        これより前のバージョンでは <a href="class.exception.html" class="classname">Exception</a> をスローしていました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-directoryiterator.construct-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-3824">
    <p><strong>例1  <span class="methodname"><strong>DirectoryIterator::__construct()</strong></span> の例</strong></p>
     <div class="example-contents"><p>
      この例は、スクリプト自身がいるディレクトリの中身を一覧表示します。
     </p></div>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$dir&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">DirectoryIterator</span><span style="color: #007700">(</span><span style="color: #0000BB">dirname</span><span style="color: #007700">(</span><span style="color: #0000BB">__FILE__</span><span style="color: #007700">));<br />foreach&nbsp;(</span><span style="color: #0000BB">$dir&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$fileinfo</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">$fileinfo</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">isDot</span><span style="color: #007700">())&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$fileinfo</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getFilename</span><span style="color: #007700">());<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-directoryiterator.construct-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><a href="class.splfileinfo.html" class="classname">SplFileInfo</a></li>
    <li class="member"><a href="class.iterator.html" class="classname">Iterator</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="95214""></a>
  <div class="note">
   <strong class="user">a dot lyskawa at nisza dot org</strong>
   <a href="#95214" class="date">18-Dec-2009 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's all-in-one DirectoryIterator:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Real Recursive Directory Iterator<br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">RRDI </span><span class="keyword">extends </span><span class="default">RecursiveIteratorIterator </span><span class="keyword">{<br />
&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; * Creates Real Recursive Directory Iterator<br />
&nbsp;&nbsp; * @param string $path<br />
&nbsp;&nbsp; * @param int $flags<br />
&nbsp;&nbsp; * @return DirectoryIterator<br />
&nbsp;&nbsp; */<br />
&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$flags </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(new </span><span class="default">RecursiveDirectoryIterator</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$flags</span><span class="keyword">));<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Real RecursiveDirectoryIterator Filtered Class<br />
&nbsp;* Returns only those items which filenames match given regex<br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">AdvancedDirectoryIterator </span><span class="keyword">extends </span><span class="default">FilterIterator </span><span class="keyword">{<br />
&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; * Regex storage<br />
&nbsp;&nbsp; * @var string<br />
&nbsp;&nbsp; */<br />
&nbsp; </span><span class="keyword">private </span><span class="default">$regex</span><span class="keyword">;<br />
&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; * Creates new AdvancedDirectoryIterator<br />
&nbsp;&nbsp; * @param string $path, prefix with '-R ' for recursive, postfix with /[wildcards] for matching<br />
&nbsp;&nbsp; * @param int $flags<br />
&nbsp;&nbsp; * @return DirectoryIterator<br />
&nbsp;&nbsp; */<br />
&nbsp; </span><span class="keyword">public function&nbsp; </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$flags </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="string">'-R '</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">) { </span><span class="default">$recursive </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">); }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'~/?([^/]*\*[^/]*)$~'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">)) { </span><span class="comment">// matched wildcards in filename<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) - </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// strip wildcards part from path<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">regex </span><span class="keyword">= </span><span class="string">'~^' </span><span class="keyword">. </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'*'</span><span class="keyword">, </span><span class="string">'.*'</span><span class="keyword">, </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">, </span><span class="string">'\.'</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])) . </span><span class="string">'$~'</span><span class="keyword">; </span><span class="comment">// convert wildcards to regex <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$path</span><span class="keyword">) </span><span class="default">$path </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">; </span><span class="comment">// if no path given, we assume CWD<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$recursive </span><span class="keyword">? new </span><span class="default">RRDI</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$flags</span><span class="keyword">) : new </span><span class="default">DirectoryIterator</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">));<br />
&nbsp; }<br />
&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; * Checks for regex in current filename, or matches all if no regex specified<br />
&nbsp;&nbsp; * @return bool<br />
&nbsp;&nbsp; */<br />
&nbsp; </span><span class="keyword">public function </span><span class="default">accept</span><span class="keyword">() { </span><span class="comment">// FilterIterator method<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">regex </span><span class="keyword">=== </span><span class="default">null </span><span class="keyword">? </span><span class="default">true </span><span class="keyword">: </span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">regex</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getInnerIterator</span><span class="keyword">()-&gt;</span><span class="default">getFilename</span><span class="keyword">());<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Some examples:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/* @var $i DirectoryIterator */<br />
<br />
</span><span class="keyword">foreach (new </span><span class="default">AdvancedDirectoryIterator</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">) as </span><span class="default">$i</span><span class="keyword">) echo </span><span class="default">$i</span><span class="keyword">-&gt;</span><span class="default">getPathname</span><span class="keyword">() . </span><span class="string">'&lt;br/&gt;'</span><span class="keyword">;<br />
</span><span class="comment">// will output all files and directories in CWD<br />
<br />
</span><span class="keyword">foreach (new </span><span class="default">AdvancedDirectoryIterator</span><span class="keyword">(</span><span class="string">'-R *.php'</span><span class="keyword">) as </span><span class="default">$i</span><span class="keyword">) echo </span><span class="default">$i</span><span class="keyword">-&gt;</span><span class="default">getPathname</span><span class="keyword">() . </span><span class="string">'&lt;br/&gt;'</span><span class="keyword">;<br />
</span><span class="comment">// will output all php files in CWD and all subdirectories<br />
<br />
</span><span class="keyword">foreach (new </span><span class="default">AdvancedDirectoryIterator</span><span class="keyword">(</span><span class="string">'-R js/jquery-*.js'</span><span class="keyword">) as </span><span class="default">$i</span><span class="keyword">) echo </span><span class="default">$i</span><span class="keyword">-&gt;</span><span class="default">getPathname</span><span class="keyword">() . </span><span class="string">'&lt;br/&gt;'</span><span class="keyword">;<br />
</span><span class="comment">// will output all jQuery versions in directory js, or throw an exception if directory js doesn't exist<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Pretty cool, huh? :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87425""></a>
  <div class="note">
   <strong class="user">kendsnyder at gmail dot com</strong>
   <a href="#87425" class="date">04-Dec-2008 08:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't store DirectoryIterator objects for later; you will get an error saying "too many open files" when you store more than the operating system limit (usually 256 or 1024).<br />
<br />
For example, this will yield an error if the directory has too many files:<br />
<br />
<span class="default">&lt;?php<br />
$files </span><span class="keyword">= array();<br />
foreach (new </span><span class="default">DirectoryIterator</span><span class="keyword">(</span><span class="string">'myDir'</span><span class="keyword">) as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$files</span><span class="keyword">[] = </span><span class="default">$file</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Presumably, this approach is memory intensive as well.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77049""></a>
  <div class="note">
   <strong class="user">pcdinh at phpvietnam dot net</strong>
   <a href="#77049" class="date">13-Aug-2007 04:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I need to traverse recursively through a directory tree and get all sub-directory paths and has written a snippet to do that.<br />
<br />
<span class="default">&lt;?php<br />
$path </span><span class="keyword">= </span><span class="string">"D:\webroot\phpvietnamcms"</span><span class="keyword">;<br />
foreach (new </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new </span><span class="default">RecursiveDirectoryIterator</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">RecursiveDirectoryIterator</span><span class="keyword">::</span><span class="default">KEY_AS_PATHNAME</span><span class="keyword">), </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">::</span><span class="default">CHILD_FIRST</span><span class="keyword">) as </span><span class="default">$file </span><span class="keyword">=&gt; </span><span class="default">$info</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$info</span><span class="keyword">-&gt;</span><span class="default">isDir</span><span class="keyword">()) <br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$file</span><span class="keyword">.</span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } <br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75900""></a>
  <div class="note">
   <strong class="user">goran at extensionsforjoomla dot com</strong>
   <a href="#75900" class="date">21-Jun-2007 01:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed to match in directory tree file name(s) by regular expression. Code is based on Marcus Börger class DirectoryTreeIterator <a href="http://cvs.php.net/viewvc.cgi/php-src/ext/spl/examples/ and on examples given in his lecture Introduction to object oriented PHP at PHP Quebec conference 2007 http://talks.somabo.de/" rel="nofollow" target="_blank">http://cvs.php.net/viewvc.cgi/php-src/ext/spl/examples/ and on examples given in his lecture Introduction to object oriented PHP at PHP Quebec conference 2007 http://talks.somabo.de/</a><br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">KeyFilter </span><span class="keyword">extends </span><span class="default">FilterIterator<br />
</span><span class="keyword">{<br />
&nbsp; private </span><span class="default">$_rx</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">Iterator $it</span><span class="keyword">, </span><span class="default">$regex</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$it</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_rx</span><span class="keyword">= </span><span class="default">$regex</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; function </span><span class="default">accept</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">ereg</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_rx</span><span class="keyword">,</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getInnerIterator</span><span class="keyword">()-&gt;</span><span class="default">key</span><span class="keyword">());<br />
&nbsp; }<br />
<br />
&nbsp; protected function </span><span class="default">__clone</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
<br />
class </span><span class="default">DirMach </span><span class="keyword">extends </span><span class="default">KeyFilter<br />
</span><span class="keyword">{<br />
&nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">, </span><span class="default">$regex</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; new </span><span class="default">DirectoryTreeIterator</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">), </span><span class="default">$regex</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; function </span><span class="default">current</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">key</span><span class="keyword">();<br />
&nbsp; }<br />
<br />
&nbsp; function </span><span class="default">key</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">key</span><span class="keyword">();<br />
&nbsp; }<br />
}<br />
<br />
class </span><span class="default">DirectoryTreeIterator </span><span class="keyword">extends </span><span class="default">RecursiveIteratorIterator<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/** Construct from a path.<br />
&nbsp;&nbsp; &nbsp; * @param $path directory to iterate<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; try {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; new </span><span class="default">RecursiveCachingIterator</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; new </span><span class="default">RecursiveDirectoryIterator</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">RecursiveDirectoryIterator</span><span class="keyword">::</span><span class="default">KEY_AS_FILENAME<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">), <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">CachingIterator</span><span class="keyword">::</span><span class="default">CALL_TOSTRING</span><span class="keyword">|</span><span class="default">CachingIterator</span><span class="keyword">::</span><span class="default">CATCH_GET_CHILD<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">), <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">SELF_FIRST<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; } catch(</span><span class="default">Exception $e</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; exit;<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/** @return the current element prefixed with ASCII graphics<br />
&nbsp;&nbsp; &nbsp; */&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">current</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">hasChildren</span><span class="keyword">())<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">next</span><span class="keyword">();&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">key</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/** Aggregates the inner iterator<br />
&nbsp;&nbsp; &nbsp; */&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">__call</span><span class="keyword">(</span><span class="default">$func</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">call_user_func_array</span><span class="keyword">(array(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getSubIterator</span><span class="keyword">(), </span><span class="default">$func</span><span class="keyword">), </span><span class="default">$params</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">$PathToSearch </span><span class="keyword">= </span><span class="string">'path_to_search'</span><span class="keyword">;<br />
</span><span class="default">$regex </span><span class="keyword">= </span><span class="string">'regular_expression'</span><span class="keyword">;<br />
</span><span class="default">$FileList </span><span class="keyword">= new </span><span class="default">DirMach</span><span class="keyword">(</span><span class="default">$PathToSearch</span><span class="keyword">, </span><span class="default">$regex</span><span class="keyword">);<br />
foreach (</span><span class="default">$FileList </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$match</span><span class="keyword">[] = </span><span class="default">$file</span><span class="keyword">;<br />
}<br />
echo </span><span class="string">'&lt;pre&gt;'</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$match</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74594""></a>
  <div class="note">
   <strong class="user">pcdinh at phpvietnam dot net</strong>
   <a href="#74594" class="date">19-Apr-2007 10:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The use of this class is rather simple<br />
<span class="default">&lt;?php<br />
$dataDir&nbsp; </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">).</span><span class="string">'/world_vest_base/'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
try<br />
{<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$dir&nbsp; </span><span class="keyword">= new </span><span class="default">DirectoryIterator</span><span class="keyword">(</span><span class="default">$dataDir</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$dir </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fileName </span><span class="keyword">= </span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">getFilename</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
}<br />
catch (</span><span class="default">Exception $ex</span><span class="keyword">)<br />
{<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
If $dataDir is null, a Runtime Exception will throws a message like this: Directory name must not be empty.<br />
<br />
If $dataDir does not exist, that message will look like this:&nbsp; failed to open dir: No such file or directory.<br />
<br />
Please be careful in case you are looking for filenames in that directory because DirectoryIterator will return a very special symbolic filenames: . and .. You must do a check to ignore them before dealing with real file names.<br />
<br />
$dir is a DirectoryIterator object</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74281""></a>
  <div class="note">
   <strong class="user">troels</strong>
   <a href="#74281" class="date">03-Apr-2007 04:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The documentation for DirectoryIterator is sparse. I found this nice overview:<br />
<a href="http://www.jellyandcustard.com/2006/05/18" rel="nofollow" target="_blank">http://www.jellyandcustard.com/2006/05/18</a><br />
/using-directoryiterator-to-list-files-in-php<br />
<br />
(The above is one line, but I'm not allowed to post it like that)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71721""></a>
  <div class="note">
   <strong class="user">springub at northclick dot de</strong>
   <a href="#71721" class="date">13-Dec-2006 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
udvig dot ericson at gmail dot com<br />
29-Jul-2006 07:48<br />
<br />
In response to the comment below from udvig. The Example ist wrong, here is the right one:<br />
<br />
<span class="default">&lt;?php<br />
$dir </span><span class="keyword">= new </span><span class="default">DirectoryIterator</span><span class="keyword">(</span><span class="string">"/tmp"</span><span class="keyword">);<br />
foreach (</span><span class="default">$dir </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp; if (</span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">isDot</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; continue;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; echo </span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">getFilename</span><span class="keyword">() . </span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68489""></a>
  <div class="note">
   <strong class="user">ludvig dot ericson at gmail dot com</strong>
   <a href="#68489" class="date">29-Jul-2006 07:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to the comment below, you don't have to simulate a foreach(), DirectoryIterator obviously inherits SPL's Iterator interface, therefore:<br />
<br />
<span class="default">&lt;?php<br />
$dir </span><span class="keyword">= new </span><span class="default">DirectoryIterator</span><span class="keyword">(</span><span class="string">"/tmp"</span><span class="keyword">);<br />
foreach (</span><span class="default">$dir </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$dir</span><span class="keyword">-&gt;</span><span class="default">isDot</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$file </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61102""></a>
  <div class="note">
   <strong class="user">fernandobassani at gmail dot com</strong>
   <a href="#61102" class="date">25-Jan-2006 07:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
We can now replace the old fashioned way of listing the content from a directory!<br />
<br />
the old way:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="string">'/home/fernando/temp'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"</span><span class="default">$file</span><span class="string"> &lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span> <br />
<br />
the new way:<br />
<span class="default">&lt;?php<br />
$dir </span><span class="keyword">= new </span><span class="default">DirectoryIterator</span><span class="keyword">(</span><span class="string">'/home/fernando/temp'</span><span class="keyword">);<br />
while(</span><span class="default">$dir</span><span class="keyword">-&gt;</span><span class="default">valid</span><span class="keyword">()) {<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$dir</span><span class="keyword">-&gt;</span><span class="default">isDot</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="default">$dir</span><span class="keyword">-&gt;</span><span class="default">current</span><span class="keyword">().</span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir</span><span class="keyword">-&gt;</span><span class="default">next</span><span class="keyword">();<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60350""></a>
  <div class="note">
   <strong class="user">jakob dot buchgraber at gmail dot com</strong>
   <a href="#60350" class="date">04-Jan-2006 04:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote a function for finding all files in the current and in subdirectories.<br />
<br />
The Code:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getFiles</span><span class="keyword">(&amp;</span><span class="default">$rdi</span><span class="keyword">,</span><span class="default">$depth</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$rdi</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$rdi</span><span class="keyword">-&gt;</span><span class="default">rewind</span><span class="keyword">();</span><span class="default">$rdi</span><span class="keyword">-&gt;</span><span class="default">valid</span><span class="keyword">();</span><span class="default">$rdi</span><span class="keyword">-&gt;</span><span class="default">next</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$rdi</span><span class="keyword">-&gt;</span><span class="default">isDot</span><span class="keyword">())<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$rdi</span><span class="keyword">-&gt;</span><span class="default">isDir</span><span class="keyword">() || </span><span class="default">$rdi</span><span class="keyword">-&gt;</span><span class="default">isFile</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">$depth</span><span class="keyword">;++</span><span class="default">$i</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&amp;nbsp;&amp;nbsp;&amp;nbsp;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$rdi</span><span class="keyword">-&gt;</span><span class="default">current</span><span class="keyword">().</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$rdi</span><span class="keyword">-&gt;</span><span class="default">hasChildren</span><span class="keyword">())<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">getFiles</span><span class="keyword">(</span><span class="default">$rdi</span><span class="keyword">-&gt;</span><span class="default">getChildren</span><span class="keyword">(),</span><span class="default">1</span><span class="keyword">+</span><span class="default">$depth</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">getFiles</span><span class="keyword">(new </span><span class="default">RecursiveDirectoryIterator</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="class.directoryiterator.html">DirectoryIterator</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="directoryiterator.current.html">DirectoryIterator::current</a></div>
 <div class="up"><a href="class.directoryiterator.html">DirectoryIterator</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
