<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>&quot;静的遅延束縛&quot; のクラス名</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.class-exists.html">class_exists</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.get-class-methods.html">get_class_methods</a></div>
 <div class="up"><a href="ref.classobj.html">クラス/オブジェクト関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.get-called-class" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">get_called_class</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.3.0)</p><p class="refpurpose"><span class="refname">get_called_class</span> &mdash; <span class="dc-title">&quot;静的遅延束縛&quot; のクラス名</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.get-called-class-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>get_called_class</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="para rdfs-comment">
   静的メソッドのコール元のクラス名を取得します。
  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.get-called-class-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   クラス名を返します。クラスの外部からコールされた場合は <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.get-called-class-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-5020">
    <p><strong>例1  <span class="function"><strong>get_called_class()</strong></span> の使用法</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">test</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">get_called_class</span><span style="color: #007700">());<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />class&nbsp;</span><span style="color: #0000BB">bar&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">{<br />}<br /><br /></span><span style="color: #0000BB">foo</span><span style="color: #007700">::</span><span style="color: #0000BB">test</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">bar</span><span style="color: #007700">::</span><span style="color: #0000BB">test</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
string(3) &quot;foo&quot;
string(3) &quot;bar&quot;
</pre></div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.get-called-class-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"> <span class="function"><a href="function.get-parent-class.html" class="function" rel="rdfs-seeAlso">get_parent_class()</a> - オブジェクトの親クラスの名前を取得する</span></li>
    <li class="member"> <span class="function"><a href="function.get-class.html" class="function" rel="rdfs-seeAlso">get_class()</a> - オブジェクトのクラス名を返す</span></li>
    <li class="member"> <span class="function"><a href="function.is-subclass-of.html" class="function" rel="rdfs-seeAlso">is_subclass_of()</a> - あるオブジェクトが指定したクラスのサブクラスに属するかどうかを調べる</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111312""></a>
  <div class="note">
   <strong class="user">luc at s dot illi dot be</strong>
   <a href="#111312" class="date">06-Feb-2013 12:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
get_called_class() in closure-scopes:<br />
<br />
<span class="default">&lt;?PHP<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">ABSTRACT CLASS </span><span class="default">Base<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; protected static </span><span class="default">$stub </span><span class="keyword">= [</span><span class="string">'baz'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//final public function boot()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">static public function </span><span class="default">boot</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="default">__METHOD__</span><span class="keyword">.</span><span class="string">'-&gt; '</span><span class="keyword">.</span><span class="default">get_called_class</span><span class="keyword">().</span><span class="default">PHP_EOL</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk</span><span class="keyword">(static::</span><span class="default">$stub</span><span class="keyword">, function()<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="default">__METHOD__</span><span class="keyword">.</span><span class="string">'-&gt; '</span><span class="keyword">.</span><span class="default">get_called_class</span><span class="keyword">().</span><span class="default">PHP_EOL</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; });<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">boot</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="default">__METHOD__</span><span class="keyword">.</span><span class="string">'-&gt; '</span><span class="keyword">.</span><span class="default">get_called_class</span><span class="keyword">().</span><span class="default">PHP_EOL</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk</span><span class="keyword">(static::</span><span class="default">$stub</span><span class="keyword">, function()<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="default">__METHOD__</span><span class="keyword">.</span><span class="string">'-&gt; '</span><span class="keyword">.</span><span class="default">get_called_class</span><span class="keyword">().</span><span class="default">PHP_EOL</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; });<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; CLASS </span><span class="default">Sub </span><span class="keyword">EXTENDS </span><span class="default">Base<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// static boot<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">Base</span><span class="keyword">::</span><span class="default">boot</span><span class="keyword">(); print </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Base::boot&nbsp; &nbsp; &nbsp; &nbsp; -&gt; Base<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Base::{closure}&nbsp; &nbsp; -&gt; Base<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">Sub</span><span class="keyword">::</span><span class="default">boot</span><span class="keyword">(); print </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Base::boot&nbsp; &nbsp; &nbsp; &nbsp; -&gt; Sub<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Base::{closure}&nbsp; &nbsp; -&gt; Base<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">new </span><span class="default">sub</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Base::boot&nbsp; &nbsp; &nbsp; &nbsp; -&gt; Sub<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Base::{closure}&nbsp; &nbsp; -&gt; Base<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Base-&gt;__construct&nbsp; &nbsp; -&gt; Sub<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Base-&gt;{closure}&nbsp; &nbsp; -&gt; Sub<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; // instance boot<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">new </span><span class="default">sub</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Base-&gt;boot&nbsp; &nbsp; &nbsp; &nbsp; -&gt; Sub<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Base-&gt;{closure}&nbsp; &nbsp; -&gt; Sub<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Base-&gt;__construct&nbsp; &nbsp; -&gt; Sub<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Base-&gt;{closure}&nbsp; &nbsp; -&gt; Sub<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103309""></a>
  <div class="note">
   <strong class="user">uebele</strong>
   <a href="#103309" class="date">06-Apr-2011 06:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SEE: <a href="http://php.net/manual/en/language.oop5.late-static-bindings.php" rel="nofollow" target="_blank">http://php.net/manual/en/language.oop5.late-static-bindings.php</a><br />
<br />
I think it is worth mentioning on this page, that many uses of the value returned by get_called_function() could be handled with the new use of the old keyword static, as in<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">static::</span><span class="default">$foo</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
versus<br />
<span class="default">&lt;?php<br />
$that</span><span class="keyword">=</span><span class="default">get_called_class</span><span class="keyword">();<br />
</span><span class="default">$that</span><span class="keyword">::</span><span class="default">$foo</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
I had been using $that:: as my conventional replacement for self:: until my googling landed me the url above.&nbsp; I have replaced all uses of $that with static with success both as <br />
<span class="default">&lt;?php <br />
</span><span class="keyword">static::</span><span class="default">$foo</span><span class="keyword">; </span><span class="comment">//and...<br />
</span><span class="keyword">new static();<br />
</span><span class="default">?&gt;<br />
</span><br />
Since static:: is listed with the limitation: "Another difference is that static:: can only refer to static properties." one may still need to use a $that:: to call static functions; though I have not yet needed this semantic.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96717""></a>
  <div class="note">
   <strong class="user">webmaster at easy-coding dot de</strong>
   <a href="#96717" class="date">12-Mar-2010 05:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you cannot avoid that carriage return characters will be used as windows linebreaks, you should set<br />
<br />
<span class="default">&lt;?php ini_set</span><span class="keyword">(</span><span class="string">"auto_detect_line_endings"</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
otherwise the solutions posted here will fail.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94331""></a>
  <div class="note">
   <strong class="user">Abhi Beckert</strong>
   <a href="#94331" class="date">29-Oct-2009 05:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware that this does not behave as expected if your method is not declared as static! For example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">foo </span><span class="keyword">{<br />
&nbsp; static public function </span><span class="default">test</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">get_called_class</span><span class="keyword">());<br />
&nbsp; }<br />
&nbsp; <br />
&nbsp; public function </span><span class="default">testTwo</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">get_called_class</span><span class="keyword">());<br />
&nbsp; }<br />
}<br />
<br />
class </span><span class="default">bar </span><span class="keyword">extends </span><span class="default">foo </span><span class="keyword">{<br />
}<br />
<br />
class </span><span class="default">abc </span><span class="keyword">{<br />
&nbsp; function </span><span class="default">test</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">foo</span><span class="keyword">::</span><span class="default">test</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">bar</span><span class="keyword">::</span><span class="default">test</span><span class="keyword">();<br />
&nbsp; }<br />
&nbsp; <br />
&nbsp; function </span><span class="default">testTwo</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">foo</span><span class="keyword">::</span><span class="default">testTwo</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">bar</span><span class="keyword">::</span><span class="default">testTwo</span><span class="keyword">();<br />
&nbsp; }<br />
}<br />
<br />
echo </span><span class="string">"basic\n"</span><span class="keyword">;<br />
</span><span class="default">foo</span><span class="keyword">::</span><span class="default">test</span><span class="keyword">();<br />
</span><span class="default">bar</span><span class="keyword">::</span><span class="default">test</span><span class="keyword">();<br />
<br />
echo </span><span class="string">"basic without static declaration\n"</span><span class="keyword">;<br />
</span><span class="default">foo</span><span class="keyword">::</span><span class="default">testTwo</span><span class="keyword">();<br />
</span><span class="default">bar</span><span class="keyword">::</span><span class="default">testTwo</span><span class="keyword">();<br />
<br />
echo </span><span class="string">"in a class\n"</span><span class="keyword">;<br />
</span><span class="default">$abc </span><span class="keyword">= new </span><span class="default">abc</span><span class="keyword">();<br />
</span><span class="default">$abc</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">();<br />
<br />
echo </span><span class="string">"in a class without static declaration\n"</span><span class="keyword">;<br />
</span><span class="default">$abc</span><span class="keyword">-&gt;</span><span class="default">testTwo</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The result is:<br />
<br />
basic<br />
string 'foo'<br />
string 'bar'<br />
<br />
basic without static declaration<br />
string 'foo'<br />
string 'bar'<br />
<br />
in a class<br />
string 'foo'<br />
string 'bar'<br />
<br />
in a class without static declaration<br />
string 'abc'<br />
string 'abc'</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92757""></a>
  <div class="note">
   <strong class="user">php at itronic dot at</strong>
   <a href="#92757" class="date">07-Aug-2009 03:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you call a static getInstance() function to create a instance of a class from another class, this function have to be static, if it is not static the original name of the caller class and not of the current class get returned.<br />
<br />
example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">a </span><span class="keyword">{<br />
&nbsp; function </span><span class="default">getXName</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">x</span><span class="keyword">::</span><span class="default">getClassName</span><span class="keyword">();<br />
&nbsp; }<br />
&nbsp; function </span><span class="default">getXStaticName</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">x</span><span class="keyword">::</span><span class="default">getStaticClassName</span><span class="keyword">();<br />
&nbsp; }<br />
<br />
}<br />
<br />
class </span><span class="default">b </span><span class="keyword">extends </span><span class="default">a </span><span class="keyword">{<br />
}<br />
<br />
class </span><span class="default">x </span><span class="keyword">{<br />
&nbsp; public function </span><span class="default">getClassName</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">get_called_class</span><span class="keyword">();<br />
&nbsp; }<br />
&nbsp; public static function </span><span class="default">getStaticClassName</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">get_called_class</span><span class="keyword">();<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="default">$a </span><span class="keyword">= new </span><span class="default">a</span><span class="keyword">();<br />
<br />
</span><span class="default">$b </span><span class="keyword">= new </span><span class="default">b</span><span class="keyword">();<br />
<br />
echo </span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">getXName</span><span class="keyword">(); </span><span class="comment">// will return "a"<br />
</span><span class="keyword">echo </span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">getXName</span><span class="keyword">(); </span><span class="comment">// will return "b"<br />
<br />
</span><span class="keyword">echo </span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">getXStaticName</span><span class="keyword">(); </span><span class="comment">// will return "x"<br />
</span><span class="keyword">echo </span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">getXStaticName</span><span class="keyword">(); </span><span class="comment">// will return "x"<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89096""></a>
  <div class="note">
   <strong class="user">a dot cudbard-bell at sussex dot ac dot uk</strong>
   <a href="#89096" class="date">21-Feb-2009 07:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a simple way of getting the inheritance tree of a class, no matter which class the function was actually defined in. Will work as a static function method too.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">get_class_tree</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cur_class </span><span class="keyword">= </span><span class="default">get_called_class</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; do {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$cur_class</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">$cur_class </span><span class="keyword">= </span><span class="default">get_parent_class</span><span class="keyword">(</span><span class="default">$cur_class</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">B </span><span class="keyword">{<br />
<br />
}<br />
<br />
class </span><span class="default">C </span><span class="keyword">{<br />
<br />
}<br />
<br />
</span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">C</span><span class="keyword">();<br />
</span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">get_class_tree</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
CBA</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86231""></a>
  <div class="note">
   <strong class="user">danbettles at yahoo dot co dot uk</strong>
   <a href="#86231" class="date">08-Oct-2008 09:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is possible to write a completely self-contained Singleton base class in PHP 5.3 using get_called_class.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">abstract class </span><span class="default">Singleton </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; protected function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; final public static function </span><span class="default">getInstance</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static </span><span class="default">$aoInstance </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$calledClassName </span><span class="keyword">= </span><span class="default">get_called_class</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (! isset (</span><span class="default">$aoInstance</span><span class="keyword">[</span><span class="default">$calledClassName</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aoInstance</span><span class="keyword">[</span><span class="default">$calledClassName</span><span class="keyword">] = new </span><span class="default">$calledClassName</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$aoInstance</span><span class="keyword">[</span><span class="default">$calledClassName</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; final private function </span><span class="default">__clone</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">DatabaseConnection </span><span class="keyword">extends </span><span class="default">Singleton </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$connection</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; protected function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// @todo Connect to the database<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// @todo Drop the connection to the database<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
<br />
</span><span class="default">$oDbConn </span><span class="keyword">= new </span><span class="default">DatabaseConnection</span><span class="keyword">();&nbsp; </span><span class="comment">// Fatal error<br />
<br />
</span><span class="default">$oDbConn </span><span class="keyword">= </span><span class="default">DatabaseConnection</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();&nbsp; </span><span class="comment">// Returns single instance<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.class-exists.html">class_exists</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.get-class-methods.html">get_class_methods</a></div>
 <div class="up"><a href="ref.classobj.html">クラス/オブジェクト関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
