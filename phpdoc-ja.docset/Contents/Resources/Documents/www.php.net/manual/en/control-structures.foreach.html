<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>foreach</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="control-structures.for.html">for</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="control-structures.break.html">break</a></div>
 <div class="up"><a href="language.control-structures.html">制御構造</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="control-structures.foreach" class="sect1">
 <h2 class="title"><em>foreach</em></h2>
 <p class="verinfo">(PHP 4, PHP 5)</p>
 <p class="para">
  <em>foreach</em> は、配列を反復処理するための便利な方法です。
  <em>foreach</em> が使えるのは配列とオブジェクトだけであり、
  別のデータ型や初期化前の変数に対して使うとエラーになります。
  この構造には二種類の構文があります。
  <div class="informalexample">
   <div class="example-contents">
<div class="cdata"><pre>
foreach (array_expression as $value)
    文
foreach (array_expression as $key =&gt; $value)
    文
</pre></div>
   </div>

  </div>
 </p>
 <p class="simpara">
  最初の形式は、<em>array_expression</em>で指定した配列に
  関してループ処理を行います。各反復において現在の要素の値が
  <em>$value</em>に代入され、内部配列ポインタが一つ前に
  進められます。(よって、次の反復では次の要素を見ることになります。)
 </p>
 <p class="simpara">
  2番目の形式は、さらに各反復で現在の要素のキーを変数
  <em>$key</em>に代入します。
 </p>
 <p class="simpara">
  <a href="language.oop5.iterations.html" class="link">オブジェクトの反復処理をカスタマイズ</a>
  することもできます。
 </p>
 <p class="para">
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    <em>foreach</em>の実行開始時に内部配列ポインタは、
    配列の先頭要素を指すように自動的にリセットされます。
    このため、<em>foreach</em>ループの前に
     <span class="function"><a href="function.reset.html" class="function">reset()</a></span>をコールする必要はありません。
   </p>
   <p class="para">
    <em>foreach</em> は内部の配列ポインタに依存するので、
    ループ内で配列ポインタを変更すると予期せぬ振る舞いを引き起こします。
   </p>
  </p></blockquote>
 </p>
 <p class="para">
  ループの中で配列の要素を直接変更したい場合は、
  <em>$value</em> の前に &amp; をつけます。こうすると、変数には
  <a href="language.references.html" class="link">リファレンス</a>
  が代入されることになります。
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$arr&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">);<br />foreach&nbsp;(</span><span style="color: #0000BB">$arr&nbsp;</span><span style="color: #007700">as&nbsp;&amp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br />}<br /></span><span style="color: #FF8000">//&nbsp;$arr&nbsp;は&nbsp;array(2,&nbsp;4,&nbsp;6,&nbsp;8)&nbsp;となります<br /></span><span style="color: #007700">unset(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;最後の要素への参照を解除します<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="para">
  <em>$value</em> の参照は、ループ処理される配列が参照可能である場合 (すなわち、
  変数である) のみ使用可能です。つまり、次のコードは動作しません。
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">foreach&nbsp;(array(</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">)&nbsp;as&nbsp;&amp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <div class="warning"><strong class="warning">警告</strong>
  <p class="para">
   <em>foreach</em> ループを終えた後でも、
   <em>$value</em> は配列の最後の要素を参照したままとなります。
    <span class="function"><a href="function.unset.html" class="function">unset()</a></span> でその参照を解除しておくようにしましょう。
  </p>
 </div>
 <p class="para">
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    <em>foreach</em> は、&#039;@&#039; によりエラーメッセージ出力を抑
    制する機能をサポートしていません。
   </p>
  </p></blockquote>
 </p>
 <p class="para">
  既にご存知かと思いますが、以下の文は機能的に等価です。
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$arr&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"one"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"two"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"three"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">reset</span><span style="color: #007700">(</span><span style="color: #0000BB">$arr</span><span style="color: #007700">);<br />while&nbsp;(list(,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;=&nbsp;</span><span style="color: #0000BB">each</span><span style="color: #007700">(</span><span style="color: #0000BB">$arr</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Value:&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #DD0000">&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />}<br /><br />foreach&nbsp;(</span><span style="color: #0000BB">$arr&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Value:&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #DD0000">&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="para">
  以下の文も機能的に等価です。
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$arr&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"one"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"two"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"three"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">reset</span><span style="color: #007700">(</span><span style="color: #0000BB">$arr</span><span style="color: #007700">);<br />while&nbsp;(list(</span><span style="color: #0000BB">$key</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;=&nbsp;</span><span style="color: #0000BB">each</span><span style="color: #007700">(</span><span style="color: #0000BB">$arr</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Key:&nbsp;</span><span style="color: #0000BB">$key</span><span style="color: #DD0000">;&nbsp;Value:&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #DD0000">&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />}<br /><br />foreach&nbsp;(</span><span style="color: #0000BB">$arr&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Key:&nbsp;</span><span style="color: #0000BB">$key</span><span style="color: #DD0000">;&nbsp;Value:&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #DD0000">&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="para">
  使用法を示すためにその他の例を示します。
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;foreach&nbsp;の例&nbsp;1:&nbsp;値のみ&nbsp;*/<br /><br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">17</span><span style="color: #007700">);<br /><br />foreach&nbsp;(</span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Current&nbsp;value&nbsp;of&nbsp;\$a:&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #DD0000">.\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;foreachの例2:&nbsp;値&nbsp;(説明用に、手動でアクセスする際の表記を出力)&nbsp;*/<br /><br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">17</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">/*&nbsp;説明用&nbsp;*/<br /><br /></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"\$a[</span><span style="color: #0000BB">$i</span><span style="color: #DD0000">]&nbsp;=&gt;&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #DD0000">.\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++;<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;foreachの例3:&nbsp;キーと値&nbsp;*/<br /><br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"one"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"two"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"three"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"seventeen"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">17<br /></span><span style="color: #007700">);<br /><br />foreach&nbsp;(</span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$k&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"\$a[</span><span style="color: #0000BB">$k</span><span style="color: #DD0000">]&nbsp;=&gt;&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #DD0000">.\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;foreach&nbsp;の例4:&nbsp;多次元配列&nbsp;*/<br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"a"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">][</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"b"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"y"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">][</span><span style="color: #0000BB">1</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"z"</span><span style="color: #007700">;<br /><br />foreach&nbsp;(</span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$v1</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$v1&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$v2</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$v2</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;foreach&nbsp;の例5:&nbsp;動的配列&nbsp;*/<br /><br /></span><span style="color: #007700">foreach&nbsp;(array(</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$v</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>

 <div class="sect2" id="control-structures.foreach.list">
  <h3 class="title">ネストした配列の list() による展開</h3>
  <p class="verinfo">(PHP 5 &gt;= 5.5.0)</p>

  <p class="para">
   PHP 5.5 からは、配列の配列の反復処理ができるようになりました。
   値として  <span class="function"><a href="function.list.html" class="function">list()</a></span> を渡すと、
   ネストした配列をループ変数に展開できます。
  </p>

  <p class="para">
   例を示します。

   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$array&nbsp;</span><span style="color: #007700">=&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;[</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;[</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">],<br />];<br /><br />foreach&nbsp;(</span><span style="color: #0000BB">$array&nbsp;</span><span style="color: #007700">as&nbsp;list(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$b</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;$a&nbsp;にはネストした配列の最初の要素が含まれ、<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$b&nbsp;には二番目の要素が含まれます。<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"A:&nbsp;</span><span style="color: #0000BB">$a</span><span style="color: #DD0000">;&nbsp;B:&nbsp;</span><span style="color: #0000BB">$b</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <p class="para">上の例の出力は以下となります。</p>
    <div class="example-contents screen">
<div class="cdata"><pre>
A: 1; B: 2
A: 3; B: 4
</pre></div>
    </div>
   </div>
  </p>

  <p class="para">
    <span class="function"><a href="function.list.html" class="function">list()</a></span> で指定する要素数を、ネストした配列の要素数より少なくしてもかまいません。
   その場合は、配列の残りの要素は無視されます。

   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$array&nbsp;</span><span style="color: #007700">=&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;[</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;[</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">],<br />];<br /><br />foreach&nbsp;(</span><span style="color: #0000BB">$array&nbsp;</span><span style="color: #007700">as&nbsp;list(</span><span style="color: #0000BB">$a</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;$b&nbsp;を指定していないことに注目。<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$a</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <p class="para">上の例の出力は以下となります。</p>
    <div class="example-contents screen">
<div class="cdata"><pre>
1
3
</pre></div>
    </div>
   </div>
  </p>

  <p class="para">
    <span class="function"><a href="function.list.html" class="function">list()</a></span> で指定した変数を埋めるだけの要素が足りないときには、notice が発生します。

   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$array&nbsp;</span><span style="color: #007700">=&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;[</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;[</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">],<br />];<br /><br />foreach&nbsp;(</span><span style="color: #0000BB">$array&nbsp;</span><span style="color: #007700">as&nbsp;list(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$b</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$c</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"A:&nbsp;</span><span style="color: #0000BB">$a</span><span style="color: #DD0000">;&nbsp;B:&nbsp;</span><span style="color: #0000BB">$b</span><span style="color: #DD0000">;&nbsp;C:&nbsp;</span><span style="color: #0000BB">$c</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <p class="para">上の例の出力は以下となります。</p>
    <div class="example-contents screen">
<div class="cdata"><pre>

Notice: Undefined offset: 2 in example.php on line 7
A: 1; B: 2; C: 

Notice: Undefined offset: 2 in example.php on line 7
A: 3; B: 4; C: 
</pre></div>
    </div>
   </div>
  </p>
 </div>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113098""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#113098" class="date">29-Aug-2013 05:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[quote]<br />
I want to add some inline comments to dtowell's piece of code about the iteration by reference:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$a </span><span class="keyword">= array(</span><span class="string">'abe'</span><span class="keyword">,</span><span class="string">'ben'</span><span class="keyword">,</span><span class="string">'cam'</span><span class="keyword">);<br />
<br />
foreach (</span><span class="default">$a </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;&amp;</span><span class="default">$n</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">);<br />
<br />
</span><span class="comment"># At the end of this cycle the variable $n refers to the same memory as $a[2]<br />
# So when the second "foreach" assigns a value to $n :<br />
<br />
</span><span class="keyword">foreach (</span><span class="default">$a </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$n</span><span class="keyword">) </span><span class="comment">// notice NO reference here!<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"</span><span class="default">$n</span><span class="string">\n"</span><span class="keyword">;<br />
<br />
</span><span class="comment"># it is also modifying $a[2] .<br />
# So on the three repetitions of the second "foreach" the array will look like:<br />
# 1. ('abe','ben','abe') - assigned the value of the first element to the last element<br />
# 2. ('abe','ben','ben') - assigned the value of the second element to the last element<br />
# 3. ('abe','ben','ben') - assigned the value of the third element to itself<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>[/quote]<br />
<br />
To resolve this problem - should always use unset after foreach:<br />
<span class="default">&lt;?php<br />
<br />
$array </span><span class="keyword">= array(</span><span class="string">'abe'</span><span class="keyword">,</span><span class="string">'ben'</span><span class="keyword">,</span><span class="string">'cam'</span><span class="keyword">);<br />
<br />
foreach ( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;&amp;</span><span class="default">$val </span><span class="keyword">) {}<br />
unset(</span><span class="default">$key</span><span class="keyword">); unset(</span><span class="default">$val</span><span class="keyword">);<br />
foreach ( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val </span><span class="keyword">) {}<br />
unset(</span><span class="default">$key</span><span class="keyword">); unset(</span><span class="default">$val</span><span class="keyword">);<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112590""></a>
  <div class="note">
   <strong class="user">Delian Krustev</strong>
   <a href="#112590" class="date">02-Jul-2013 10:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I want to add some inline comments to dtowell's piece of code about the iteration by reference:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$a </span><span class="keyword">= array(</span><span class="string">'abe'</span><span class="keyword">,</span><span class="string">'ben'</span><span class="keyword">,</span><span class="string">'cam'</span><span class="keyword">);<br />
<br />
foreach (</span><span class="default">$a </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;&amp;</span><span class="default">$n</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">);<br />
<br />
</span><span class="comment"># At the end of this cycle the variable $n refers to the same memory as $a[2]<br />
# So when the second "foreach" assigns a value to $n :<br />
<br />
</span><span class="keyword">foreach (</span><span class="default">$a </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$n</span><span class="keyword">) </span><span class="comment">// notice NO reference here!<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"</span><span class="default">$n</span><span class="string">\n"</span><span class="keyword">;<br />
<br />
</span><span class="comment"># it is also modifying $a[2] .<br />
# So on the three repetitions of the second "foreach" the array will look like:<br />
# 1. ('abe','ben','abe') - assigned the value of the first element to the last element<br />
# 2. ('abe','ben','ben') - assigned the value of the second element to the last element<br />
# 3. ('abe','ben','ben') - assigned the value of the third element to itself<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111825""></a>
  <div class="note">
   <strong class="user">Ashus</strong>
   <a href="#111825" class="date">02-Apr-2013 10:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you wondered how to create a list of all possible combinations of variable amount of arrays (multiple foreach), you might use this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$a</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = array(</span><span class="string">'a1'</span><span class="keyword">,</span><span class="string">'a2'</span><span class="keyword">);<br />
</span><span class="default">$a</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = array(</span><span class="string">'b1'</span><span class="keyword">,</span><span class="string">'b2'</span><span class="keyword">,</span><span class="string">'b3'</span><span class="keyword">);<br />
</span><span class="default">$a</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] = array(</span><span class="string">'c1'</span><span class="keyword">,</span><span class="string">'c2'</span><span class="keyword">);<br />
<br />
function </span><span class="default">getAllCombinations</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">$s</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$a</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] as </span><span class="default">$v</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$a</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$s</span><span class="keyword">.</span><span class="default">$v</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">getAllCombinations</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">,</span><span class="default">$s</span><span class="keyword">.</span><span class="default">$v</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$s</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
echo </span><span class="default">getAllCombinations</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
the result:<br />
<br />
a1b1c1<br />
a1b1c2<br />
a1b2c1<br />
a1b2c2<br />
a1b3c1<br />
a1b3c2<br />
a2b1c1<br />
a2b1c2<br />
a2b2c1<br />
a2b2c2<br />
a2b3c1<br />
a2b3c2</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111688""></a>
  <div class="note">
   <strong class="user">php at darkain dot com</strong>
   <a href="#111688" class="date">17-Mar-2013 06:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"Reference of a $value and the last array element remain even after the foreach loop. It is recommended to destroy it by unset()."<br />
<br />
I cannot stress this point of the documentation enough! Here is a simple example of exactly why this must be done:<br />
<br />
<span class="default">&lt;?php<br />
$arr1 </span><span class="keyword">= array(</span><span class="string">"a" </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">, </span><span class="string">"b" </span><span class="keyword">=&gt; </span><span class="default">2</span><span class="keyword">, </span><span class="string">"c" </span><span class="keyword">=&gt; </span><span class="default">3</span><span class="keyword">);<br />
</span><span class="default">$arr2 </span><span class="keyword">= array(</span><span class="string">"x" </span><span class="keyword">=&gt; </span><span class="default">4</span><span class="keyword">, </span><span class="string">"y" </span><span class="keyword">=&gt; </span><span class="default">5</span><span class="keyword">, </span><span class="string">"z" </span><span class="keyword">=&gt; </span><span class="default">6</span><span class="keyword">);<br />
<br />
foreach (</span><span class="default">$arr1 </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; &amp;</span><span class="default">$val</span><span class="keyword">) {}<br />
foreach (</span><span class="default">$arr2 </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {}<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$arr1</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$arr2</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
The output is:<br />
array(3) { ["a"]=&gt; int(1) ["b"]=&gt; int(2) ["c"]=&gt; &amp;int(6) }<br />
array(3) { ["x"]=&gt; int(4) ["y"]=&gt; int(5) ["z"]=&gt; int(6) }<br />
<br />
Notice how the last index in $arr1 is now the value from the last index in $arr2!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109698""></a>
  <div class="note">
   <strong class="user">dtowell</strong>
   <a href="#109698" class="date">11-Aug-2012 09:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
References created by foreach hang around past their best-used-by date. For example, the following:<br />
<br />
<span class="default">&lt;?php<br />
$a </span><span class="keyword">= array(</span><span class="string">'abe'</span><span class="keyword">,</span><span class="string">'ben'</span><span class="keyword">,</span><span class="string">'cam'</span><span class="keyword">);<br />
foreach (</span><span class="default">$a </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;&amp;</span><span class="default">$n</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">);<br />
foreach (</span><span class="default">$a </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$n</span><span class="keyword">) </span><span class="comment">// notice NO reference here!<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"</span><span class="default">$n</span><span class="string">\n"</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
will result in:<br />
<br />
ABE<br />
BEN<br />
BEN<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; ABE<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; BEN<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; BEN<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107533""></a>
  <div class="note">
   <strong class="user">Voitcus at wp dot pl</strong>
   <a href="#107533" class="date">16-Feb-2012 05:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can even iterate through "dynamic" arrays that do not physically exist, but are objects that implement Iterator interface. They don't need to be stored in memory when foreach starts.<br />
<br />
Consider the array that contains some values (I called it $allValues in the example below) and we want to have only some of them (eg. the ones that are dividable by 2). I create an object that would serve as dynamic array, that means it would "dynamically update" its values together with $allValues. The main advantage is that I store only one array, and it's the only array I serialize.<br />
<br />
An object of MyIter class will not contain any values itself:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">MyIter </span><span class="keyword">implements </span><span class="default">Iterator </span><span class="keyword">{ </span><span class="comment">// you can implement ArrayAccess and Countable interfaces too, this will make class MyIter behave like a "real" array<br />
&nbsp; </span><span class="keyword">private </span><span class="default">$position </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="comment">// an internal position of the current element<br />
&nbsp; // please note that $position has nothing common with $allValues!<br />
<br />
&nbsp; </span><span class="keyword">private function </span><span class="default">getTable</span><span class="keyword">(){ </span><span class="comment">// prepare a temporary "static" table of all objects in the class<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">global </span><span class="default">$allValues</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">=array(); </span><span class="comment">// temporary variable<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$allValues </span><span class="keyword">as </span><span class="default">$obj</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(</span><span class="default">$obj </span><span class="keyword">% </span><span class="default">2 </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) </span><span class="comment">// check if the value is even<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[]=</span><span class="default">$obj</span><span class="keyword">; </span><span class="comment">// if yes, I want it<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp; }&nbsp; &nbsp; <br />
<br />
&nbsp; </span><span class="comment">// the all below declared methods are public and belong to the Iterator interface<br />
&nbsp; </span><span class="keyword">function </span><span class="default">rewind</span><span class="keyword">() { </span><span class="comment">// a method to start iterating<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">position </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="comment">// just move to the beginning<br />
&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp; function </span><span class="default">current</span><span class="keyword">() { </span><span class="comment">// retrieves the current element<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$table</span><span class="keyword">=</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getTable</span><span class="keyword">(); </span><span class="comment">// let us prepare a table<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$table</span><span class="keyword">[</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">position</span><span class="keyword">]; </span><span class="comment">// and return the current element<br />
&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp; function </span><span class="default">key</span><span class="keyword">() { </span><span class="comment">// retrieves the current element's key<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">position</span><span class="keyword">; </span><span class="comment">// this is used by foreach(... as $key=&gt;$value), not important here<br />
&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp; function </span><span class="default">next</span><span class="keyword">() { </span><span class="comment">// move to next element<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">++</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">position</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; function </span><span class="default">valid</span><span class="keyword">() { </span><span class="comment">// check if the current element is valid (ie. if it exists)<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">position</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getTable</span><span class="keyword">());<br />
&nbsp; }<br />
} </span><span class="comment">// end of class<br />
<br />
// now prepare the array of 12 elements<br />
</span><span class="default">$allValues</span><span class="keyword">=array(</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">,</span><span class="default">7</span><span class="keyword">,</span><span class="default">8</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">,</span><span class="default">11</span><span class="keyword">);<br />
<br />
</span><span class="comment">//we would like to have a dynamic array of all even values<br />
</span><span class="default">$iterator</span><span class="keyword">=new </span><span class="default">MyIter</span><span class="keyword">();<br />
<br />
foreach(</span><span class="default">$iterator </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">){<br />
&nbsp; echo </span><span class="default">$value</span><span class="keyword">.</span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>This will result in:<br />
0<br />
2<br />
4<br />
6<br />
8<br />
10<br />
<br />
(You may also like to see what var_dump($iterator) produces).<br />
<br />
Another great advantage is that you can modify the main table "on-the-fly" and it has its impact. Let us modify the last foreach loop:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// ...all above shall stay as it was<br />
</span><span class="keyword">foreach(</span><span class="default">$iterator </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">){<br />
&nbsp; echo </span><span class="default">$value</span><span class="keyword">.</span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp; if(</span><span class="default">$value</span><span class="keyword">==</span><span class="default">6</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$allValues</span><span class="keyword">=array(</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"I modified source array!&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span>This produces now:<br />
0<br />
2<br />
4<br />
6<br />
I modified source array!<br />
<br />
However, if you feel it is rather a catastrophic disadvantage (maybe for example, it shows the values 0, 4, and 6 which were removed when we reached 6), and wish to have a "static" array that will iterate even in modified objects, just call getTable() in rewind() method and save it in temporary (private perhaps) field. In my example getTable() is called every iteration, and it calls another foreach through $allValues, which together might be time-consuming. Consider what you need.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106971""></a>
  <div class="note">
   <strong class="user">nobody at nobody dot com</strong>
   <a href="#106971" class="date">22-Dec-2011 10:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
$d3 </span><span class="keyword">= array(</span><span class="string">'a'</span><span class="keyword">=&gt;array(</span><span class="string">'b'</span><span class="keyword">=&gt;</span><span class="string">'c'</span><span class="keyword">));<br />
foreach(</span><span class="default">$d3</span><span class="keyword">[</span><span class="string">'a'</span><span class="keyword">] as &amp;</span><span class="default">$v4</span><span class="keyword">){}<br />
foreach(</span><span class="default">$d3 </span><span class="keyword">as </span><span class="default">$v4</span><span class="keyword">){}<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$d3</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>will get something look like this:<br />
array(1) {<br />
&nbsp; ["a"]=&gt;<br />
&nbsp; array(1) {<br />
&nbsp;&nbsp;&nbsp; ["b"]=&gt;<br />
&nbsp;&nbsp;&nbsp; &amp;array(1) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; ["b"]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; *RECURSION*<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
}<br />
then you try to walk some data with this array.<br />
the script run out of memory and connect reset by peer<br />
<br />
the document says:<br />
Warning<br />
Reference of a $value and the last array element remain even after the foreach loop. It is recommended to destroy it by unset().<br />
<br />
so what I learn is that NEVER ignore """Warning""" in document....</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104060""></a>
  <div class="note">
   <strong class="user">billardmchl at aol dot com</strong>
   <a href="#104060" class="date">20-May-2011 10:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function find well the words, add well adds a () around short words, but the <br />
array at the end of th function is the same as at the beginning.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">isole_mots</span><span class="keyword">(</span><span class="default">$chaine</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chaine </span><span class="keyword">= </span><span class="string">"le petit chat est fou"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mots </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">'/[!,-.;?:()[ ]/'</span><span class="keyword">, </span><span class="default">$chaine</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">PREG_SPLIT_NO_EMPTY</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$mots </span><span class="keyword">as </span><span class="default">$mot</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$mot</span><span class="keyword">) &lt;= </span><span class="default">3</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mot </span><span class="keyword">= </span><span class="string">"("</span><span class="keyword">.</span><span class="default">$mot</span><span class="keyword">.</span><span class="string">")"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">" inside foreach </span><span class="default">$mot</span><span class="string"> &lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
print </span><span class="string">"after foreach array mots"</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$mots</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; die();<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$mots</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
inside foreach (le)<br />
inside foreach petit<br />
inside foreach chat<br />
inside foreach (est)<br />
inside foreach (fou)<br />
after foreach array motsArray ( [0] =&gt; le [1] =&gt; petit [2] =&gt; chat [3] =&gt; est [4] =&gt; fou )</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99909""></a>
  <div class="note">
   <strong class="user">Oleg englishman at bigmir dot net</strong>
   <a href="#99909" class="date">14-Sep-2010 04:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who'd like to traverse an array including just added elements (within this very foreach), here's a workaround:<br />
<br />
<span class="default">&lt;?php<br />
$values </span><span class="keyword">= array(</span><span class="default">1 </span><span class="keyword">=&gt; </span><span class="string">'a'</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">=&gt; </span><span class="string">'b'</span><span class="keyword">, </span><span class="default">3 </span><span class="keyword">=&gt; </span><span class="string">'c'</span><span class="keyword">);<br />
while (list(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$key</span><span class="string"> =&gt; </span><span class="default">$value</span><span class="string"> \r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$key </span><span class="keyword">== </span><span class="default">3</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">] = </span><span class="string">'d'</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$key </span><span class="keyword">== </span><span class="default">4</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">] = </span><span class="string">'e'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
the code above will output:<br />
<br />
1 =&gt; a<br />
2 =&gt; b<br />
3 =&gt; c<br />
4 =&gt; d<br />
5 =&gt; e</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88578""></a>
  <div class="note">
   <strong class="user">tedivm at tedivm dot com</strong>
   <a href="#88578" class="date">29-Jan-2009 11:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
foreach and the while/list/each methods are not completely identical, and there are occasions where one way is beneficial over the other.<br />
<br />
<span class="default">&lt;?php<br />
$arr </span><span class="keyword">= array(</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">,</span><span class="default">7</span><span class="keyword">,</span><span class="default">8</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">);<br />
<br />
foreach(</span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; unset(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$key </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$value </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Output:<br />
1 2 3 4 5 6 7 8 9 <br />
<br />
<span class="default">&lt;?php<br />
$arr </span><span class="keyword">= array(</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">,</span><span class="default">7</span><span class="keyword">,</span><span class="default">8</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">);<br />
<br />
while (list(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp;&nbsp; unset(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$key </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$value </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Output:<br />
1 3 5 7 9<br />
<br />
<br />
[EDIT BY danbrown AT php DOT net: Contains a typofix by (scissor AT phplabs DOT pl) on 30-JAN-2009.]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82511""></a>
  <div class="note">
   <strong class="user">adam dot sindelar at gmail dot com</strong>
   <a href="#82511" class="date">14-Apr-2008 03:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can also use the alternative syntax for the foreach cycle:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$element</span><span class="keyword">):<br />
&nbsp; </span><span class="comment">#do something<br />
</span><span class="keyword">endforeach;<br />
</span><span class="default">?&gt;<br />
</span><br />
Just thought it worth mentioning.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76133""></a>
  <div class="note">
   <strong class="user">Luke at chaoticlogic dot net</strong>
   <a href="#76133" class="date">02-Jul-2007 10:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Alright, I had a little error. I had one foreach() declaration, and then another foreach() declaration.<br />
<br />
They went:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//$connections is an array of Socket resources<br />
</span><span class="keyword">foreach (</span><span class="default">$connections </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; &amp;</span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//the code here is impertinent <br />
<br />
</span><span class="keyword">}<br />
<br />
</span><span class="comment">//$users is an associative array<br />
</span><span class="keyword">foreach (</span><span class="default">$users </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; &amp;</span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//the code here is impertinent <br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
Alright, now, what error was produced as a result of this?<br />
This one:<br />
"Warning: Cannot use scalar value as array in filename.php on line 69."<br />
<br />
I then realized something; the reason for this came from the fact that I used $key, and $value for both of them in the exact same way.<br />
<br />
As a response to this, I've developed two ways to fix this:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//add this to the end of every foreach() you use<br />
</span><span class="keyword">unset(</span><span class="default">$key</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">)<br />
</span><span class="default">?&gt;<br />
</span><br />
OR<br />
<br />
Simply use different variables for each one.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71854""></a>
  <div class="note">
   <strong class="user">simplex</strong>
   <a href="#71854" class="date">19-Dec-2006 09:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"As of PHP 5, you can easily modify array's elements by preceding $value with &amp;. This will assign reference instead of copying the value."<br />
<br />
There are cases where array_walk or array_map are inadequate (conditional required) or you're just too lazy to write a function and pass values to it for use with array_map...<br />
<br />
My solution to foreach for php 4 and 5 to modify values of an array directly:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$testarr </span><span class="keyword">= array(</span><span class="string">"a" </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">, </span><span class="string">"b" </span><span class="keyword">=&gt; </span><span class="default">2</span><span class="keyword">, </span><span class="string">"c" </span><span class="keyword">=&gt; </span><span class="default">3</span><span class="keyword">, </span><span class="string">"d" </span><span class="keyword">=&gt; </span><span class="default">4</span><span class="keyword">);<br />
<br />
</span><span class="default">$testarr_keys </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$testarr</span><span class="keyword">);<br />
</span><span class="default">$testarr_values </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$testarr</span><span class="keyword">);<br />
<br />
for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt;= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$testarr</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$testarr</span><span class="keyword">[</span><span class="default">$testarr_keys</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]] = </span><span class="default">$testarr_values</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] * </span><span class="default">2</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$testarr</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31455""></a>
  <div class="note">
   <strong class="user">php at electricsurfer dot com</strong>
   <a href="#31455" class="date">22-Apr-2003 10:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Ed Note:&nbsp; You can also use array_keys() so that you don't have to have the $value_copy variable --alindeman at php.net]<br />
<br />
I use the following to modify the original values of the array:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value_copy</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">=&amp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// ...<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="string">'New Value'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="control-structures.for.html">for</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="control-structures.break.html">break</a></div>
 <div class="up"><a href="language.control-structures.html">制御構造</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
