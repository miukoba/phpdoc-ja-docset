<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>実行時設定</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="apc.installation.html">インストール手順</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="apc.resources.html">リソース型</a></div>
 <div class="up"><a href="apc.setup.html">インストール/設定</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="apc.configuration" class="section">
 <h2 class="title">実行時設定</h2>
 <p class="simpara">
<var class="filename">php.ini</var> の設定により動作が変化します。
</p>
 <p class="para">
  たいていの場合はデフォルトの APC 設定でうまく動作しますが、
  きちんとチューニングをしたい場合は以下のパラメータを設定します。
 </p>
 <p class="para">
  あなたが決めなければいけないことは、以下の 2 つです。
  まず APC にどれくらいの共有メモリを設定するかということ、そして、
  ファイルの更新チェックをリクエストのたびに APC が行うかどうかということです。
  これらに関連する ini ディレクティブが <em>apc.shm_size</em>
  および <em>apc.stat</em> です。これらのディレクティブについて、
  以下の説明を注意深くお読みください。
 </p>
 <p class="para">
  サーバーを起動したら、この拡張モジュールに含まれているスクリプト
  <em>apc.php</em> をドキュメントルート以下に配置し、
  ブラウザでアクセスしてください。
  キャッシュの状態についての詳細な情報がここで得られます。
  PHP で GD が使用可能になっている場合は、きれいなグラフも表示されます。
  まず最初にチェックすべきなのは、当然、
  実際にファイルがキャッシュされているかどうかでしょう。
  実際に動作していることを確認したら、次は左側にある
  <em>Cache full count</em> の値に注目しましょう。
  これは、キャッシュがいっぱいになったために強制削除が行われた
  (直近の <em>apc.ttl</em> 秒間にアクセスされなかったエントリが、
  キャッシュから削除された) 回数を表します。
  この値ができるだけ小さくなるようにキャッシュを設定しなければなりません。
  キャッシュが絶えずいっぱいになっているようだと、
  パフォーマンスに影響を及ぼします。
  この場合は、APC に割り当てるメモリの量を増やすか、
  キャッシュするスクリプトを絞り込むために
  <em>apc.filters</em> を使用します。
 </p>
 <p class="para">
  APC を mmap (メモリマッピング) サポート付きでコンパイルすると、
  ひとつのメモリセグメントだけを使うようになります。一方、APC を SHM (SysV 共有メモリ)
  サポートでビルドした場合は複数のメモリセグメントを使います。
  MMAP には、SHM における
  <em>/proc/sys/kernel/shmmax</em>
  のような最大値の制限はありません。
  一般的には MMAP サポートを推奨します。
  ウェブサーバーを再起動するよりも高速にメモリを再利用するし、
  起動時のメモリ割り当て量も軽減できるからです。
 </p>
 <p class="para">
  <table class="doctable table">
   <caption><strong>APC の設定オプション</strong></caption>
   
    <thead>
     <tr>
      <th>名前</th>
      <th>デフォルト</th>
      <th>変更可能</th>
      <th>変更履歴</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td><a href="apc.configuration.html#ini.apc.enabled" class="link">apc.enabled</a></td>
      <td>&quot;1&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 2 で PHP_INI_SYSTEM。APC &lt;= 3.0.12 で PHP_INI_ALL。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.shm-segments" class="link">apc.shm_segments</a></td>
      <td>&quot;1&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.shm-size" class="link">apc.shm_size</a></td>
      <td>&quot;32M&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.shm-strings-buffer" class="link">apc.shm_strings_buffer</a></td>
      <td>&quot;4M&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.1.4 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.optimization" class="link">apc.optimization</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_ALL</td>
      <td>APC 2 では PHP_INI_SYSTEM。APC 3.0.13 で削除。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.num-files-hint" class="link">apc.num_files_hint</a></td>
      <td>&quot;1000&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.user-entries-hint" class="link">apc.user_entries_hint</a></td>
      <td>&quot;4096&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.0 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.ttl" class="link">apc.ttl</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.0 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.user-ttl" class="link">apc.user_ttl</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.0 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.gc-ttl" class="link">apc.gc_ttl</a></td>
      <td>&quot;3600&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.cache-by-default" class="link">apc.cache_by_default</a></td>
      <td>&quot;1&quot;</td>
      <td>PHP_INI_ALL</td>
      <td>APC &lt;= 3.0.12 で PHP_INI_SYSTEM。APC 3.0.0 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.filters" class="link">apc.filters</a></td>
      <td>NULL</td>
      <td>PHP_INI_SYSTEM</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.mmap-file-mask" class="link">apc.mmap_file_mask</a></td>
      <td>NULL</td>
      <td>PHP_INI_SYSTEM</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.slam-defense" class="link">apc.slam_defense</a></td>
      <td>&quot;1&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.0 以降で利用可能。APC 3.1.4 より前のバージョンでは、デフォルト値が <em>&quot;0&quot;</em> (無効) でした。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.file-update-protection" class="link">apc.file_update_protection</a></td>
      <td>&quot;2&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.6 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.enable-cli" class="link">apc.enable_cli</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.7 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.max-file-size" class="link">apc.max_file_size</a></td>
      <td>&quot;1M&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.7 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.use-request-time" class="link">apc.use_request_time</a></td>
      <td>&quot;1&quot;</td>
      <td>PHP_INI_ALL</td>
      <td>APC 3.1.3 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.stat" class="link">apc.stat</a></td>
      <td>&quot;1&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.10 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.write-lock" class="link">apc.write_lock</a></td>
      <td>&quot;1&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.11 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.report-autofilter" class="link">apc.report_autofilter</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.11 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.serializer" class="link">apc.serializer</a></td>
      <td>&quot;default&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.1.0 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.include-once-override" class="link">apc.include_once_override</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.12 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.rfc1867" class="link">apc.rfc1867</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.13 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.rfc1867-prefix" class="link">apc.rfc1867_prefix</a></td>
      <td>&quot;upload_&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.rfc1867-name" class="link">apc.rfc1867_name</a></td>
      <td>&quot;APC_UPLOAD_PROGRESS&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.rfc1867-freq" class="link">apc.rfc1867_freq</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td class="empty">&nbsp;</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.rfc1867-ttl" class="link">apc.rfc1867_ttl</a></td>
      <td>&quot;3600&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.1.1 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.localcache" class="link">apc.localcache</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.14 から 3.1.11 で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.localcache.size" class="link">apc.localcache.size</a></td>
      <td>&quot;512&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.14 から 3.1.11 で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.coredump-unmap" class="link">apc.coredump_unmap</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.16 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.stat-ctime" class="link">apc.stat_ctime</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.0.13 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.preload-path" class="link">apc.preload_path</a></td>
      <td>NULL</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.1.1 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.file-md5" class="link">apc.file_md5</a></td>
      <td>&quot;0&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.1.1 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.canonicalize" class="link">apc.canonicalize</a></td>
      <td>&quot;1&quot;</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.1.1 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.lazy-functions" class="link">apc.lazy_functions</a></td>
      <td>0</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.1.3 以降で利用可能。</td>
     </tr>

     <tr>
      <td><a href="apc.configuration.html#ini.apc.lazy-classes" class="link">apc.lazy_classes</a></td>
      <td>0</td>
      <td>PHP_INI_SYSTEM</td>
      <td>APC 3.1.3 以降で利用可能。</td>
     </tr>

    </tbody>
   
  </table>

  PHP_INI_* モードの詳細および定義については
<a href="configuration.changes.modes.html" class="xref">どこで設定を行うのか</a> を参照してください。
 </p>
 
 <p class="para">以下に設定ディレクティブに関する
簡単な説明を示します。</p>
 
 <p class="para">
  <dl>

   <dt id="ini.apc.enabled">
    <span class="term">
     <em><code class="parameter">apc.enabled</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
    </span>
    <dd>

     <p class="para">
      <em>apc.enabled</em> を 0 にすることで APC を無効にできます。
      APC が静的にコンパイルされて PHP に組み込まれており、
      他に無効にする手段がない場合などに有用です (DSO としてコンパイルされている場合は、
      単に <em>php.ini</em> の中の <em>extension</em>
      という行をコメントアウトするだけで無効にできます)。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.shm-segments">
    <span class="term">
     <em><code class="parameter">apc.shm_segments</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      コンパイラキャッシュのために割り当てる共有メモリセグメントの数。
      APC が割り当て済みの共有メモリを使い切ってしまっているが、
      すでにシステムが許す限り <em>apc.shm_size</em>
      を拡大しているといった場合に、この値を大きくすることを試みます。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.shm-size">
    <span class="term">
     <em><code class="parameter">apc.shm_size</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      個々の共有メモリセグメントの大きさを MB 単位で指定します。デフォルトで、
      共有メモリセグメントの大きさが非常に小さく設定されているシステムもあります
      (大半の BSD 系システムがこれに含まれます)。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.shm-strings-buffer">
    <span class="term">
     <em><code class="parameter">apc.shm_strings_buffer</code></em>
     <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
    </span>
    <dd>

     <p class="para">
      APC が内部的に文字列用の共有バッファとして使うためのメモリのサイズ。
      最後に M (メガバイト) あるいは G (ギガバイト) をつけなければいけません。
      このオプションを有効にすると、PHP-FPM ごとに使うメモリの量を減らせます。
      文字列をワーカーごとに格納するのではなく、一括で格納することになるからです。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.optimization">
    <span class="term">
     <em><code class="parameter">apc.optimization</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      最適化レベル。ゼロは最適化を無効にし、
      値を大きくするほど最適化のレベルが高くなります。
      わずかながら速度の向上が期待できます。この項目は実験的なものです。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.num-files-hint">
    <span class="term">
     <em><code class="parameter">apc.num_files_hint</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      Web サーバーで読み込まれるソースファイルの総数についての
      「ヒント」。よくわからない場合はゼロを指定するか、
      単に無視してください。
      何千ものソースファイルを扱っているようなサイトで有用です。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.user-entries-hint">
    <span class="term">
     <em><code class="parameter">apc.user_entries_hint</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      <a href="apc.configuration.html#ini.apc.num-files-hint" class="link">apc.num_files_hint</a> と同様に、
      保存するユーザーキャッシュ変数の数についての「ヒント」。
      よくわからない場合は、ゼロを設定するか無視してください。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.ttl">
    <span class="term">
     <em><code class="parameter">apc.ttl</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      キャッシュされているエントリが、
      他のエントリに割り当てられるまでスロットに残っていることの可能な秒数。
      ゼロのままにしておくと、キャッシュの中身が古いエントリでいっぱいになってしまい、
      新しいエントリがキャッシュできなくなります。
      キャッシュが使用可能メモリを超えてしまった場合、
      ttl が 0 ならキャッシュを完全に破棄します。
      ttl が 0 より大きい場合は、APC は期限切れのエントリの削除を試みます。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.user-ttl">
    <span class="term">
     <em><code class="parameter">apc.user_ttl</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      ユーザーキャッシュエントリが、
      他のエントリに割り当てられるまでスロットに残っていることの可能な秒数。
      ゼロのままにしておくと、キャッシュの中身が古いエントリでいっぱいになってしまい、
      新しいエントリがキャッシュできなくなります。
      キャッシュが使用可能メモリを超えてしまった場合、
      ttl が 0 ならキャッシュを完全に破棄します。
      ttl が 0 より大きい場合は、APC は期限切れのエントリの削除を試みます。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.gc-ttl">
    <span class="term">
     <em><code class="parameter">apc.gc_ttl</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      キャッシュエントリがガベージコレクションのリストに残り続ける秒数。
      ソースファイルのキャッシュ中にサーバープロセスが死んだ場合の安全装置となります。
      ソースファイルが変更された場合、メモリに割り当てられている古いバージョンは、
      この TTL に達するまで再読み込みされません。
      この機能を無効にするにはゼロを設定します。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.cache-by-default">
    <span class="term">
     <em><code class="parameter">apc.cache_by_default</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
    </span>
    <dd>

     <p class="para">
      デフォルトで On です。しかし、これを Off にして
      <em>+</em> で始まる <em>apc.filters</em>
      とともに使用することで、
      フィルタに一致したファイルのみをキャッシュすることが可能です。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.filters">
    <span class="term">
     <em><code class="parameter">apc.filters</code></em>
     <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
    </span>
    <dd>

     <p class="para">
      カンマで区切られた、POSIX 拡張正規表現のリスト。
      ソースファイル名がいずれかのパターンにマッチした場合、そのファイルはキャッシュされません。
      マッチングに使用されるファイル名は include/require に渡される名前であり、
      絶対パスではないことに注意しましょう。正規表現が <em>+</em>
      で始まっている場合、その条件にマッチするファイルはキャッシュされます。
      また <em>-</em> で始まっている場合は、
      条件にマッチするファイルはキャッシュされません。
      デフォルトは <em>-</em> なので、これは省略可能です。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.mmap-file-mask">
    <span class="term">
     <em><code class="parameter">apc.mmap_file_mask</code></em>
     <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
    </span>
    <dd>

     <p class="para">
      <em>--enable-mmap</em> を用いて MMAP
      サポートつきでコンパイルされている場合、ここで
      mktemp 形式のファイルマスクを指定します。mmap モジュールは、
      mmap されたメモリ領域をファイルに置くか共有メモリに置くかを、
      これによって判断します。
      ファイルベースの mmap を使用するには、この値を
      <em>/tmp/apc.XXXXXX</em>
      （正確に 6 つの <em>X</em>）のように指定します。
      POSIX 形式の shm_open/mmap を使用するには、<em>.shm</em>
      をマスクのどこかで指定します。例: <em>/apc.shm.XXXXXX</em> 。
      また、<em>/dev/zero</em> を指定することで、カーネルの
      <em>/dev/zero</em> インターフェイスを使用した anonymous mmap
      を使用することもできます。未定義の場合は、この方式が用いられます。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.slam-defense">
    <span class="term">
     <em><code class="parameter">apc.slam_defense</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      非常にアクセスの多いサーバーでは、
      サーバーを起動したりファイルを書き換えたりするたびに
      「多くのプロセスが」「同時に」「同じファイルを」
      キャッシュしようとすることになります。このオプションを指定すると、
      ある一定のパーセンテージでファイルをキャッシュせずに利用するようにします。
      あるいは、単一のプロセスがキャッシュ処理をスキップする確率と考えることもできます。
      たとえば、<em>apc.slam_defense</em> を <em>75</em>
      に設定すると、プロセスがキャッシュされていないファイルをキャッシュする処理を 
      75% の確率で抑えられます。つまり、この値を大きく設定することで、
      キャッシュ処理の混雑を防ぐことが可能です。値を <em>0</em>
      に設定すると、この機能が無効になります。
     </p>
     <p class="para">
      非推奨です。かわりに <a href="apc.configuration.html#ini.apc.write-lock" class="link">apc.write_lock</a>
      を使用しましょう。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.file-update-protection">
    <span class="term">
     <em><code class="parameter">apc.file_update_protection</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      稼動中の Web サーバー上のファイルを書き換える場合、
      アトミックな手段で行うべきです。つまり、まずいったん一時ファイルに書き込み、
      準備ができた時点でそれをリネーム（<em>mv</em>）
      して正しい位置に移動します。多くのテキストエディタや <strong class="command">cp</strong>、<strong class="command">tar</strong>
      その他のプログラムはこの方式ではありません。
      ということは、ファイルの書き込み中にそのファイルがアクセスされる
      （そしてキャッシュされる）可能性があるわけです。
      <em>apc.file_update_protection</em> は、
      新しいファイルをキャッシュするまでの遅延を設定します。デフォルトは
      2 秒で、ファイルの更新時刻（<em>mtime</em>）がアクセス時刻と
      2 秒未満しか違わない場合はファイルをキャッシュしないという意味です。
      更新の最中のファイルにアクセスしてしまった不幸な人には
      変なデータが見えてしまいますが、
      少なくともその変な状態がキャッシュされてしまうことはありません。
      <strong class="command">rsync</strong> などのアトミックな更新を保証する方式を利用することがわかっている場合は、
      値を 0 に設定することでこの機能を無効にできます。
      更新処理に 2 秒以上かかるようなシステムを利用している場合は、
      この値をもう少し大きくしたくなるかもしれません。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.enable-cli">
    <span class="term">
     <em><code class="parameter">apc.enable_cli</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      たいていは、テストやデバッグ用に使用します。これを設定すると
      CLI バージョンの PHP で APC を有効にします。通常は、すべての
      CLI リクエストに対して APC キャッシュを作成/格納/削除したいとは思わないでしょう。
      しかし、CLI バージョンの APC を簡単に作成できるようにしておくことは、
      多くのテストシナリオで有用です。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.max-file-size">
    <span class="term">
     <em><code class="parameter">apc.max_file_size</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      この値よも大きなサイズのファイルは、キャッシュされません。
      デフォルトは 1M です。
     </p>
    </dd>

   </dt>

   <dt id="ini.apc.stat">
    <span class="term">
     <em><code class="parameter">apc.stat</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      この設定を変更する場合は十分注意してください。デフォルト設定は On で、
      これは、ファイルが変更されていないかどうかを
      スクリプトの実行のたびに APC が調べ、
      もし変更されていれば、再コンパイルして新しいバージョンをキャッシュします。
      この設定を Off にすると、変更されているかどうかがチェックされません。
      つまり、変更内容を有効にするには Web サーバーを再起動する必要があるということです。
      実運用環境ではコードを変更することはめったにないでしょうから、
      この設定を Off にしておくことでパフォーマンスを大きく向上させられます。
     </p>
     <p class="para">
      include/require されたファイルについてもこのオプションは適用されますが、
      もし相対パス (Unix の場合は / で始まらないすべてのパス) の include
      を使用している場合は、ファイルを一意に識別するために APC
      がチェックする必要があります。
      絶対パスの include を使用している場合、
      APC 絶対パスをファイルの識別子として使用し、
      チェックを飛ばすことができます。
     </p>
    </dd>

   </dt>

   
   <dt id="ini.apc.write-lock">
    <span class="term">
     <em><code class="parameter">apc.write_lock</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
    </span>
    <dd>

     <p class="para">
      多くの処理が実行されるサーバーでは、最初にサーバーを立ち上げたときや
      多くのファイルを変更した場合などに、
      すべてのプロセスが同一のファイルをコンパイルしたりキャッシュしたりしてしまうことがあります。
      write_lock を有効にすると、ひとつのプロセスのみが
      未キャッシュのスクリプトをコンパイルするようになります。
      その間、他のプロセスはロック待ちをするのではなく
      キャッシュされていない状態で実行します。
     </p>
    </dd>

   </dt>

   
   <dt id="ini.apc.report-autofilter">
    <span class="term">
     <em><code class="parameter">apc.report_autofilter</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
    </span>
    <dd>

     <p class="para">
      バインド時の問題によりキャッシュから自動的に除外されたスクリプトを記録します。
     </p>
    </dd>

   </dt>

   
   <dt id="ini.apc.serializer">
    <span class="term">
     <em><code class="parameter">apc.serializer</code></em>
     <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
    </span>
    <dd>

     <p class="para">
      APC でサードパーティーのシリアライザーを使うよう設定します。
     </p>
    </dd>

   </dt>

   
   <dt id="ini.apc.include-once-override">
    <span class="term">
     <em><code class="parameter">apc.include_once_override</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
    </span>
    <dd>

     <p class="para">
       <span class="function"><a href="function.include-once.html" class="function">include_once</a></span> および  <span class="function"><a href="function.require-once.html" class="function">require_once</a></span>
      を最適化し、コストの高いシステムコールの使用を避けるようにします。
     </p>
     <div class="warning"><strong class="warning">警告</strong>
      <p class="simpara">
       この機能は<em class="emphasis">実験的</em>なものです。
       このディレクティブの挙動やディレクティブ名、そして関連するドキュメントなどは、
       今後 APC の新バージョンがリリースされるときに予告なく変更される可能性があります。
       この機能は自己責任の下で使うようにしましょう。
      </p>
     </div>
    </dd>

   </dt>

   
   <dt id="ini.apc.rfc1867">
    <span class="term">
     <em><code class="parameter">apc.rfc1867</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
    </span>
    <dd>

     <p class="para">
      RFC1867 のファイルアップロード進捗ハンドラが有効になるのは、
      PHP 5.2.0 以降で APC をコンパイルした場合のみです。
      これを有効にすると、ファイルアップロードフォームの file フィールドの前に
      <em>APC_UPLOAD_PROGRESS</em> というフィールドがある場合に
      APC が自動的にユーザーキャッシュエントリ upload_<em class="emphasis">key</em>
      を作成します。ここで、<em class="emphasis">key</em> はフォームの
      <em>APC_UPLOAD_PROGRESS</em> エントリの値となります。
     </p>
     <p class="para">
      <em>APC_UPLOAD_PROGRESS</em> で指定した hidden フィールドが
      file フィールドよりも前にこなければならないことに注意しましょう。
      そうしないと、アップロードの進捗処理が正しく動作しません。
     </p>
     <p class="para">
      現時点では、ファイルアップロードの追跡はスレッドセーフではないことに注意しましょう。
      前のアップロード処理が終わる前に別のアップロードを開始すると、
      前のアップロードの追跡が無効になってしまいます。
     </p>
     <p class="para">
      <em>rate</em> が使えるのは、
      すべてのファイルの転送が完了してからであることに注意しましょう。
     </p>
     <p class="para">
      <div class="example" id="example-400">
       <p><strong>例1 apc.rfc1867 の例</strong></p>
       <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">apc_fetch</span><span style="color: #007700">(</span><span style="color: #DD0000">"upload_</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #0000BB">APC_UPLOAD_PROGRESS</span><span style="color: #007700">]</span><span style="color: #DD0000">"</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
       </div>

       <div class="example-contents"><p>上の例の出力は、
たとえば以下のようになります。</p></div>
       <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [total] =&gt; 1142543
    [current] =&gt; 1142543
    [rate] =&gt; 1828068.8
    [filename] =&gt; test
    [name] =&gt; file
    [temp_filename] =&gt; /tmp/php8F
    [cancel_upload] =&gt; 0
    [done] =&gt; 1
)
</pre></div>
       </div>
      </div>
     </p>
    </dd>

   </dt>

   
   <dt id="ini.apc.rfc1867-prefix">
    <span class="term">
     <em><code class="parameter">apc.rfc1867_prefix</code></em>
     <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
    </span>
    <dd>

     <p class="para">
      rfc1867 のアップロード進捗処理機能で作成するユーザーキャッシュエントリの
      キーにつけるプレフィックスを指定します。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.rfc1867-name">
    <span class="term">
     <em><code class="parameter">apc.rfc1867_name</code></em>
     <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
    </span>
    <dd>

     <p class="para">
      APC のアップロード進捗処理機能を有効にするフォームの hidden
      項目名、そしてユーザーキャッシュエントリのキーのサフィックスを指定します。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.rfc1867-freq">
    <span class="term">
     <em><code class="parameter">apc.rfc1867_freq</code></em>
     <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
    </span>
    <dd>

     <p class="para">
      アップロードの進捗を記録するユーザーキャッシュエントリの更新頻度を指定します。
      ファイルサイズに対するパーセンテージ、あるいはファイルサイズで指定します。
      サイズを指定する場合は、最後に
      <em>&quot;k&quot;</em>、<em>&quot;m&quot;</em> あるいは <em>&quot;g&quot;</em>
      を指定することでそれぞれキロバイト、メガバイト、ギガバイトを指定できます
      (大文字小文字は区別しません)。
      0 を指定すると、可能な限り進捗を更新するようにします。
      これは、アップロードの速度を低下させてしまいます。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.rfc1867-ttl">
    <span class="term">
     <em><code class="parameter">apc.rfc1867_ttl</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      rfc1867 エントリの <acronym>TTL</acronym>。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.localcache">
    <span class="term">
     <em><code class="parameter">apc.localcache</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
    </span>
    <dd>

     <p class="para">
      これは、ロックが不要なローカルプロセスのシャドウキャッシュを有効にします。
      これにより、キャッシュが書き込まれる際のロックの競合を軽減します。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.localcache.size">
    <span class="term">
     <em><code class="parameter">apc.localcache.size</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      ローカルプロセスのシャドウキャッシュの大きさ。
      ある程度大きなな値を設定しておく必要があります。目安としては
      <a href="apc.configuration.html#ini.apc.num-files-hint" class="link">apc.num_files_hint</a>
      の半分程度となります。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.coredump-unmap">
    <span class="term">
     <em><code class="parameter">apc.coredump_unmap</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
    </span>
    <dd>

     <p class="para">
      APC で SIGSEGV のようなシグナルを捕捉し、
      シグナルの発生時にコアファイルを書き出せるようにします。
      シグナルを受け取ると、
      APC は共有メモリセグメントの割り当てを解除し、
      コアファイルにそれが書き出されないようにします。
      この設定を行うと、
      APC の共有メモリセグメントを大きめに設定しているときに
      致命的なシグナルを受け取った場合のシステムの安定性が向上します。
     </p>
     <div class="warning"><strong class="warning">警告</strong>
      <p class="para">
       この機能には危険性があります。
       致命的なシグナルのハンドラで共有メモリセグメントの割り当てを解除しようとすると、
       発生したエラーによっては未定義の振る舞いを起こす可能性があります。
      </p>
     </div>
     <blockquote class="note"><p><strong class="note">注意</strong>: 
      <p class="para">
       カーネルによってはコアダンプファイルの生成時に共有メモリを無視する機能を持つものもありますが、
       そのような実装は、たとえば Apache のスコアボードのような
       重要な共有メモリセグメントも無視してしまう可能性があります。
      </p>
     </p></blockquote>
    </dd>

   </dt>


   <dt id="ini.apc.stat-ctime">
    <span class="term">
     <em><code class="parameter">apc.stat_ctime</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      ctime による検証を行えば、svn や rsync といったプログラムが引き起こす問題を回避することができます。
      直近の状態から inode が変わっていないことを確実に確かめられるからです。
      APC は、通常は mtime のみしか確認しません。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.canonicalize">
    <span class="term">
     <em><code class="parameter">apc.canonicalize</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type bool">bool</a></span>
    </span>
    <dd>

     <p class="para">
      オンにすると、no-stat モードのときに相対パスを正規化します。
      これを設定すると、ストリームラッパー経由でインクルードしたファイルは
      キャッシュできなくなります。 <span class="function"><a href="function.realpath.html" class="function">realpath()</a></span>
      はストリームラッパーをサポートしていないからです。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.preload-path">
    <span class="term">
     <em><code class="parameter">apc.preload_path</code></em>
     <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
    </span>
    <dd>

     <p class="para">
      オプションで、ディレクトリへのパスを指定します。
      APC の起動時に、ここにあるキャッシュデータを読み込みます。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.use-request-time">
    <span class="term">
     <em><code class="parameter">apc.use_request_time</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type bool">bool</a></span>
    </span>
    <dd>

     <p class="para">
      <acronym title="Server Application Programming Interface">SAPI</acronym> リクエストの開始時刻を
      <acronym>TTL</acronym> に使用します。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.file-md5">
    <span class="term">
     <em><code class="parameter">apc.file_md5</code></em>
     <span class="type"><a href="language.types.boolean.html" class="type bool">bool</a></span>
    </span>
    <dd>

     <p class="para">
      ファイルの md5 ハッシュを記録します。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.lazy-functions">
    <span class="term">
     <em><code class="parameter">apc.lazy_functions</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      関数の lazy loading を有効にします。
     </p>
    </dd>

   </dt>


   <dt id="ini.apc.lazy-classes">
    <span class="term">
     <em><code class="parameter">apc.lazy_classes</code></em>
     <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
    </span>
    <dd>

     <p class="para">
      クラスの lazy loading を有効にします。
     </p>
    </dd>

   </dt>

  </dl>

 </p>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="112393""></a>
  <div class="note">
   <strong class="user">klaus at hax dot at</strong>
   <a href="#112393" class="date">11-Jun-2013 10:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note: If you want to run a script on Windows with apc.enabled=1 as a scheduled task whilst another instance of php is running (like on a webserver) apparently you have to disable apc for this scheduled task, otherwise it will not run and you will have something in your error log like: PHP Fatal error: PHP Startup: apc_shm_create: shmget(0, 33554432, 658) failed: No such file or directory.<br />
<br />
So simply execute your scheduled task with:<br />
<br />
c:\php\php.exe -d apc.enabled=0 and all will be fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109755""></a>
  <div class="note">
   <strong class="user">bas_vijfiwinkel</strong>
   <a href="#109755" class="date">17-Aug-2012 02:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I took some time to look at the preload_path option.<br />
<br />
At the moment of writing the preload_path option is broken because of a bug in the APC source code <br />
which will not allow you to properly preload the cache.<br />
<br />
The way to fix it :<br />
Inside 'main_apc.c' in the method called 'static int apc_load_data(const char *data_file TSRMLS_DC)', the length of the key of the value that needs to be stored is determined with the following line :<br />
key_len = strlen(key);<br />
If I am correct this is only the length of the string itself without the null-terminator<br />
However, "_apc_store" seems to want the length of the key string including the terminator.<br />
If I change the line above to :<br />
key_len = strlen(key)+1;<br />
then the preload function works as expected.<br />
You can also notice that 1 character is missing when looking at the user cache entries apc.php. But if you try to use that as a key then APC will not return the contents so that didn't work as a workaround.<br />
<br />
If one is able to compile the apc library from source, then one can of course easily fix this option by changing the source code.<br />
<br />
Files in the specified path should have the extension '.data'.<br />
The filename itself will become the key for the data that is in that specific file.<br />
The data in the file is a serialized string representing what you want to assign to the specific key. For example s:2:"123" will generate the string "123".<br />
One can only specify 1 value for each key and it should be null-terminated.<br />
<br />
It is not possible to preload PHP scripts.<br />
Only values that one retrieved with apc_fetch can be preloaded.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96330""></a>
  <div class="note">
   <strong class="user">d_inkubus at yahoo dot com</strong>
   <a href="#96330" class="date">20-Feb-2010 08:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
apc.include_once_override=1 can cause more problems than it solves.&nbsp; If you're running into weird errors regarding relative paths, make sure this setting is off.&nbsp; PHP 5.3 already implements most of the speed ups in these calls anyway.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95981""></a>
  <div class="note">
   <strong class="user">amir w of colnect dot com TIPS</strong>
   <a href="#95981" class="date">01-Feb-2010 02:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
apc.stat is an extremely important setting for a production server, especially if many files are accessed on every request, which is quite normal on complicated web applications.<br />
<br />
Always aspire to use:<br />
apc.stat="0"<br />
so that APC does not try to check that each and every file exists on every request you make. It also means you can update files on your server without crashing incoming requests on that time fragment. Whenever you wish to force APC to re-read all the files, simply clear the cache or restart your server.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95980""></a>
  <div class="note">
   <strong class="user">amir w of colnect dot com TIPS</strong>
   <a href="#95980" class="date">01-Feb-2010 02:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Want to avoid segmentation with apc.shm_segments?If your linux server limits the shared memory block size and you're forced to use apc.shm_segments instead, change the setting by using (here is 512M but change it as you like):<br />
# sysctl -w kernel.shmmax=536870912<br />
<br />
(but if you want the change to be permanent after a restart you would have to add the following line in /etc/sysctl.conf<br />
<br />
kernel.shmmax=536870912)<br />
<br />
and updating apc.ini<br />
<br />
apc.shm_segments="1"<br />
apc.shm_size="512"<br />
<br />
<br />
apc.stat is an extremely important setting for a production server, especially if many files are accessed on every request, which is quite normal on complicated web applications.<br />
<br />
Always aspire to use:<br />
apc.stat="0"<br />
so that APC does not try to check that each and every file exists on every request you make. It also means you can update files on your server without crashing incoming requests on that time fragment. Whenever you wish to force APC to re-read all the files, simply clear the cache or restart your server.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95659""></a>
  <div class="note">
   <strong class="user">fusionstream [a](t) gmail.com</strong>
   <a href="#95659" class="date">14-Jan-2010 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are getting 0kb out of 0kb for your upload progress with large files, make sure that upload_max_filesize and post_max_size are larger than the file you are uploading. As far as I can tell, apc.max_file_size does not affect it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94529""></a>
  <div class="note">
   <strong class="user">Will</strong>
   <a href="#94529" class="date">10-Nov-2009 01:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For anyone wondering why shm_segments is being ignored on their setup, it could be because of the following:<br />
<br />
If you've configured APC to use memory mapped files (with the --enable-mmap option), the shm_segments setting is ignored unless you specify a file mask via the mmap_file_mask setting.<br />
<br />
This is because APC won't attempt to create multiple anonymous files to map into memory without a mask (since it has no way of naming them sensibly). To set up multiple segments you have to give a file mask so they can be named separately.<br />
<br />
apc.mmap_file_mask=/tmp/apc.XXXXXX<br />
<br />
Make sure to use exactly 6 "X"s (this is the part that is changed by APC). You can place these files anywhere, they don't have to go in /tmp.<br />
<br />
With that said, I'm not sure what the performance impact of having multiple MMAP segments would be. I'm guessing it would probably be negative so you probably don't want to do this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93169""></a>
  <div class="note">
   <strong class="user">neorush at gmail dot com</strong>
   <a href="#93169" class="date">27-Aug-2009 12:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
apc_fetch always returned false.&nbsp; Turns out that "apc.rfc1867" was set to "0".&nbsp; I added this line to my php.ini:<br />
apc.rfc1867 = 1<br />
but it could have certainly been changed with ini_set().&nbsp; That took me way to long to figure out.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89211""></a>
  <div class="note">
   <strong class="user">bishop</strong>
   <a href="#89211" class="date">26-Feb-2009 04:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The apc.rfc1867 example code above is a little fast and loose for those running in environments where APC RFC1867 may or may not be available.&nbsp; This is a little more expressive:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// if we have PHP and APC<br />
</span><span class="default">$havePHP </span><span class="keyword">= (</span><span class="default">1 </span><span class="keyword">=== </span><span class="default">version_compare</span><span class="keyword">(</span><span class="default">PHP_VERSION</span><span class="keyword">, </span><span class="string">'5.2.0'</span><span class="keyword">) ? </span><span class="default">true </span><span class="keyword">: </span><span class="default">false</span><span class="keyword">);<br />
</span><span class="default">$haveAPC </span><span class="keyword">= (</span><span class="default">extension_loaded</span><span class="keyword">(</span><span class="string">'apc'</span><span class="keyword">) &amp;&amp; </span><span class="default">1 </span><span class="keyword">=== </span><span class="default">version_compare</span><span class="keyword">(</span><span class="default">phpversion</span><span class="keyword">(</span><span class="string">'apc'</span><span class="keyword">), </span><span class="string">'3.0.13'</span><span class="keyword">) ? </span><span class="default">true </span><span class="keyword">: </span><span class="default">false</span><span class="keyword">);<br />
if (</span><span class="default">$havePHP </span><span class="keyword">&amp;&amp; </span><span class="default">$haveAPC</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// if APC and upload tracking is enabled<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'apc.enabled'</span><span class="keyword">) &amp;&amp; </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'apc.rfc1867'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// get the stats<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'apc.rfc1867_prefix'</span><span class="keyword">) . </span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'apcid'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stats </span><span class="keyword">= </span><span class="default">apc_fetch</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86711""></a>
  <div class="note">
   <strong class="user">lamperz at gmail dot com</strong>
   <a href="#86711" class="date">31-Oct-2008 06:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm trying to get upload progress with apc_fetch.<br />
I founded apc_fetch always return false till the upload completed.After fews hours debug, I finally notice that my APC_UPLOAD_PROGRESS was set after the file form.<br />
<br />
SO, You should write your form like this<br />
&lt;input type="hidden" id="file_id" name="APC_UPLOAD_PROGRESS" value="blablabla"/&gt;<br />
&lt;input type="file" id="select_file" name="file" value="upload" onchange="parent.test();"/&gt;<br />
<br />
the hidden field with name="APC_UPLOAD_PROGRESS" SHOULD be ALWAYS BEFORE input type="file"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86293""></a>
  <div class="note">
   <strong class="user">danbettles at yahoo dot co dot uk</strong>
   <a href="#86293" class="date">11-Oct-2008 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To automatically cache only PHP class files named "&lt;class name&gt;.class.php", add the following lines to php.ini.<br />
<br />
apc.cache_by_default = "Off"<br />
apc.filters = "+\.class\.php$"<br />
<br />
Notes:<br />
- The regexp is case /sensitive/, so if, say, your project contains filenames with mixed case, you'll need something like "+\.(class|CLASS)\.(php|PHP)$".&nbsp; I've tried delimiting patterns and using the "i" modifier, but that doesn't seem to work.<br />
- Setting cache_by_default to "On" and applying the positive filter will /not/ work.<br />
<br />
If you have more complicated requirements and, like me, you're not familiar with POSIX Extended Regular Expressions (ERE) inparticular, you may find the following link useful.&nbsp; <a href="http://www.regular-expressions.info/refflavors.html" rel="nofollow" target="_blank">http://www.regular-expressions.info/refflavors.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="apc.installation.html">インストール手順</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="apc.resources.html">リソース型</a></div>
 <div class="up"><a href="apc.setup.html">インストール/設定</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
