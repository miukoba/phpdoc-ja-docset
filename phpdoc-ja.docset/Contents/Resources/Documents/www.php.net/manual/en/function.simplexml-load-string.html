<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>XML 文字列をオブジェクトに代入する</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.simplexml-load-file.html">simplexml_load_file</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="book.wddx.html">WDDX</a></div>
 <div class="up"><a href="ref.simplexml.html">SimpleXML 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.simplexml-load-string" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">simplexml_load_string</h1>
  <p class="verinfo">(PHP 5)</p><p class="refpurpose"><span class="refname">simplexml_load_string</span> &mdash; <span class="dc-title">
   XML 文字列をオブジェクトに代入する
  </span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.simplexml-load-string-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><a href="class.simplexmlelement.html" class="type SimpleXMLElement">SimpleXMLElement</a></span> <span class="methodname"><strong>simplexml_load_string</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$class_name</code><span class="initializer"> = &quot;SimpleXMLElement&quot;</span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$ns</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$is_prefix</code><span class="initializer"> = false</span></span>
  ]]]] )</div>

  <p class="para rdfs-comment">
   整形式 XML 文字列をオブジェクトとして返します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.simplexml-load-string-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><em><code class="parameter">data</code></em></span>
     <dd>

      <p class="para">
       整形式 XML 文字列。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">class_name</code></em></span>
     <dd>

      <p class="para">
       このオプションのパラメータを使用して、
        <span class="function"><a href="function.simplexml-load-file.html" class="function">simplexml_load_file()</a></span>
       が指定されたクラスのオブジェクトを返すようにします。
       このクラスは、<span class="type"><a href="class.simplexmlelement.html" class="type SimpleXMLElement">SimpleXMLElement</a></span>
       クラスを継承していなければなりません。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">options</code></em></span>
     <dd>

      <p class="para">
       PHP 5.1.0 と Libxml 2.6.0 から、<a href="libxml.constants.html" class="link">追加の Libxml パラメータ</a>
       を指定するために <em><code class="parameter">options</code></em>
       を使用することもできます。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">ns</code></em></span>
     <dd>

      <p class="para">
       名前空間プレフィックスあるいは URI。
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">is_prefix</code></em></span>
     <dd>

      <p class="para">
       <em><code class="parameter">ns</code></em> がプレフィックスである場合に <strong><code>TRUE</code></strong>、
       URI である場合に <strong><code>FALSE</code></strong>。デフォルトは <strong><code>FALSE</code></strong> です。
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.simplexml-load-string-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   <span class="type"><a href="class.simplexmlelement.html" class="type SimpleXMLElement">SimpleXMLElement</a></span> クラスのオブジェクトを返します。
   XML ドキュメント内のデータをプロパティに含みます。
   失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-function.simplexml-load-string-errors">
  <h3 class="title">エラー / 例外</h3>
  <p class="para">
   XML データ内でエラーが見つかるたびに <strong><code>E_WARNING</code></strong>
   エラーメッセージが発生します。
  </p>
  <div class="tip"><strong class="tip">ヒント</strong>
   <p class="para">
     <span class="function"><a href="function.libxml-use-internal-errors.html" class="function">libxml_use_internal_errors()</a></span> ですべての XML エラーを抑制し、
    後から  <span class="function"><a href="function.libxml-get-errors.html" class="function">libxml_get_errors()</a></span> で取得することもできます。
   </p>
  </div>
 </div>


 <div class="refsect1 examples" id="refsect1-function.simplexml-load-string-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-5478">
    <p><strong>例1 XML 文字列をパースする</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$string&nbsp;</span><span style="color: #007700">=&nbsp;&lt;&lt;&lt;XML<br /></span><span style="color: #DD0000">&lt;?xml&nbsp;version='1.0'?&gt;&nbsp;<br />&lt;document&gt;<br />&nbsp;&lt;title&gt;Forty&nbsp;What?&lt;/title&gt;<br />&nbsp;&lt;from&gt;Joe&lt;/from&gt;<br />&nbsp;&lt;to&gt;Jane&lt;/to&gt;<br />&nbsp;&lt;body&gt;<br />&nbsp;&nbsp;I&nbsp;know&nbsp;that's&nbsp;the&nbsp;answer&nbsp;--&nbsp;but&nbsp;what's&nbsp;the&nbsp;question?<br />&nbsp;&lt;/body&gt;<br />&lt;/document&gt;<br /></span><span style="color: #007700">XML;<br /><br /></span><span style="color: #0000BB">$xml&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">simplexml_load_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$xml</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
SimpleXMLElement Object
(
  [title] =&gt; Forty What?
  [from] =&gt; Joe
  [to] =&gt; Jane
  [body] =&gt;
   I know that&#039;s the answer -- but what&#039;s the question?
)
</pre></div>
    </div>
    <div class="example-contents"><p>
     この時点で、<em>$xml-&gt;body</em> のようにアクセスすることができます。
    </p></div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.simplexml-load-string-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"> <span class="function"><a href="function.simplexml-load-file.html" class="function" rel="rdfs-seeAlso">simplexml_load_file()</a> - XMLファイルをパースし、オブジェクトに代入する</span></li>
    <li class="member"> <span class="methodname"><a href="simplexmlelement.construct.html" class="methodname" rel="rdfs-seeAlso">SimpleXMLElement::__construct()</a> - 新しい SimpleXMLElement オブジェクトを作成する</span></li>
    <li class="member"><a href="simplexml.examples-errors.html" class="xref">XML エラーの対応</a></li>
    <li class="member"> <span class="function"><a href="function.libxml-use-internal-errors.html" class="function" rel="rdfs-seeAlso">libxml_use_internal_errors()</a> - libxmlエラーを無効にし、ユーザーが必要に応じてエラー情報を取得できるようにする</span></li>
    <li class="member"><a href="simplexml.examples-basic.html" class="xref">基本的な SimpleXML の使用法</a></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113349""></a>
  <div class="note">
   <strong class="user">dkrnl at yandex dot ru</strong>
   <a href="#113349" class="date">30-Sep-2013 11:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Wrapper XMLReader class, for simple SAX-reading huge xml:<br />
https://github.com/dkrnl/SimpleXMLReader<br />
<br />
Usage example: <a href="http://github.com/dkrnl/SimpleXMLReader/blob/master/examples/example1.php" rel="nofollow" target="_blank">http://github.com/dkrnl/SimpleXMLReader/blob/master/examples/example1.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110334""></a>
  <div class="note">
   <strong class="user">AllenJB</strong>
   <a href="#110334" class="date">12-Oct-2012 05:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
$xml </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">json_encode</span><span class="keyword">((array) </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)), </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
A reminder that json_encode attempts to convert data to UTF-8 without specific knowledge of the source encoding. This method can cause encoding issues if you're not working in UTF-8.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107732""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#107732" class="date">01-Mar-2012 05:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Use libxml_disable_entity_loader() to restrict loading of external files.&nbsp; See <a href="http://www.idontplaydarts.com/2011/02/scanning-the-internal-network-using-simplexml/" rel="nofollow" target="_blank">http://www.idontplaydarts.com/2011/02/scanning-the-internal-network-using-simplexml/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106408""></a>
  <div class="note">
   <strong class="user">lb at bostontech dot net</strong>
   <a href="#106408" class="date">08-Nov-2011 07:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
please note that:<br />
<br />
&lt;?<br />
$data_array = (array) simplexml_load_string($xml_string);<br />
?&gt;<br />
<br />
will only convert the root element to an array, where as the child elements remain XML objects.<br />
<br />
To prove this, try returning a value N objects deep by association.&nbsp; Then try the same exercise using something like the object2array example below. (Which works great).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102277""></a>
  <div class="note">
   <strong class="user">Diego Araos, diego at klapmedia dot com</strong>
   <a href="#102277" class="date">05-Feb-2011 09:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simpler way to transform the result into an array (requires json module).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">object2array</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">) { return @</span><span class="default">json_decode</span><span class="keyword">(@</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">),</span><span class="default">1</span><span class="keyword">); }<br />
</span><span class="default">?&gt;<br />
</span><br />
Example:<br />
<span class="default">&lt;?php<br />
$xml_object</span><span class="keyword">=</span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'&lt;SOME XML DATA'</span><span class="keyword">);<br />
</span><span class="default">$xml_array</span><span class="keyword">=</span><span class="default">object2array</span><span class="keyword">(</span><span class="default">$xml_object</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101594""></a>
  <div class="note">
   <strong class="user">ascammon at hotmail dot com</strong>
   <a href="#101594" class="date">28-Dec-2010 10:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a hard time finding this documented, so posting it here in case it helps someone:<br />
<br />
If you want to use multiple libxml options, separate them with a pipe, like so:<br />
<br />
<span class="default">&lt;?php<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="string">'SimpleXMLElement'</span><span class="keyword">, </span><span class="default">LIBXML_NOCDATA </span><span class="keyword">| </span><span class="default">LIBXML_NOBLANKS</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99677""></a>
  <div class="note">
   <strong class="user">thejhereg at gmail dot com</strong>
   <a href="#99677" class="date">30-Aug-2010 08:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"simplexml_load_string() : Entity: line #: parser error : Comment not terminated"<br />
<br />
On the off chance you see this error and you're pulling your hair out over it, simplexml can't seem to correctly parse XML comment tags if the comment contains "--". <br />
<br />
Is silly and likely won't happen very often -- but sometimes it does. ;-)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94658""></a>
  <div class="note">
   <strong class="user">jeff at creabilis dot com</strong>
   <a href="#94658" class="date">17-Nov-2009 11:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to set the charset of the outputed xml, simply set the encoding attribute like this :<br />
<br />
<span class="default">&lt;?php simplexml_load_string</span><span class="keyword">(</span><span class="string">'&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;xml/&gt;'</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
The generated xml outputed by $xml-&gt;asXML will containt accentuated characters like 'é' instead of &amp;#xE9;.<br />
<br />
Hope this help</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91564""></a>
  <div class="note">
   <strong class="user">Bob</strong>
   <a href="#91564" class="date">17-Jun-2009 11:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is my simple SimpleXML wrapper function.<br />
As far as I can tell, it does the same as Julio Cesar Oliveira's (above).<br />
It parses an XML string into a multi-dimensional associative array.<br />
The second argument is a callback that is run on all data (so for example, if you want all data trimmed, like Julio does in his function, just pass 'trim' as the second arg).<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">unserialize_xml</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$callback </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$recurse </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
</span><span class="comment">/* bool/array unserialize_xml ( string $input [ , callback $callback ] )<br />
&nbsp;* Unserializes an XML string, returning a multi-dimensional associative array, optionally runs a callback on all non-array data<br />
&nbsp;* Returns false on all failure<br />
&nbsp;* Notes:<br />
&nbsp;&nbsp;&nbsp; * Root XML tags are stripped<br />
&nbsp;&nbsp;&nbsp; * Due to its recursive nature, unserialize_xml() will also support SimpleXMLElement objects and arrays as input<br />
&nbsp;&nbsp;&nbsp; * Uses simplexml_load_string() for XML parsing, see SimpleXML documentation for more info<br />
&nbsp;*/<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Get input, loading an xml string with simplexml if its the top level of recursion<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= ((!</span><span class="default">$recurse</span><span class="keyword">) &amp;&amp; </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">))? </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">): </span><span class="default">$input</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Convert SimpleXMLElements to array<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$data </span><span class="keyword">instanceof </span><span class="default">SimpleXMLElement</span><span class="keyword">) </span><span class="default">$data </span><span class="keyword">= (array) </span><span class="default">$data</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Recurse into arrays<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">)) foreach (</span><span class="default">$data </span><span class="keyword">as &amp;</span><span class="default">$item</span><span class="keyword">) </span><span class="default">$item </span><span class="keyword">= </span><span class="default">unserialize_xml</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$callback</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Run callback and return<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) &amp;&amp; </span><span class="default">is_callable</span><span class="keyword">(</span><span class="default">$callback</span><span class="keyword">))? </span><span class="default">call_user_func</span><span class="keyword">(</span><span class="default">$callback</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">): </span><span class="default">$data</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90108""></a>
  <div class="note">
   <strong class="user">tiznull</strong>
   <a href="#90108" class="date">07-Apr-2009 07:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SimpleXMLElement - Warning: unserialize() [function.unserialize]: Node no longer exists in … .php<br />
<br />
If you get this error from storing serialized SimpleXMLElement data then this is your fix…<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">sxml_unserialze</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br />
return </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">'O:16:"SimpleXMLElement":0:{}'</span><span class="keyword">, </span><span class="string">'O:16:"SimpleXMLElement":'</span><span class="keyword">), array(</span><span class="string">'s:0:"";'</span><span class="keyword">, </span><span class="string">'O:8:"stdClass":'</span><span class="keyword">), </span><span class="default">$str</span><span class="keyword">));<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89951""></a>
  <div class="note">
   <strong class="user">Julio Cesar Oliveira</strong>
   <a href="#89951" class="date">30-Mar-2009 04:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The XML2Array func now Recursive!<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">XML2Array </span><span class="keyword">( </span><span class="default">$xml </span><span class="keyword">, </span><span class="default">$recursive </span><span class="keyword">= </span><span class="default">false </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if ( ! </span><span class="default">$recursive </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">simplexml_load_string </span><span class="keyword">( </span><span class="default">$xml </span><span class="keyword">) ;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">$xml </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$newArray </span><span class="keyword">= array () ;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= ( array ) </span><span class="default">$array </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach ( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= ( array ) </span><span class="default">$value </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( isset ( </span><span class="default">$value </span><span class="keyword">[ </span><span class="default">0 </span><span class="keyword">] ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newArray </span><span class="keyword">[ </span><span class="default">$key </span><span class="keyword">] = </span><span class="default">trim </span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">[ </span><span class="default">0 </span><span class="keyword">] ) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newArray </span><span class="keyword">[ </span><span class="default">$key </span><span class="keyword">] = </span><span class="default">XML2Array </span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">, </span><span class="default">true </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$newArray </span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89869""></a>
  <div class="note">
   <strong class="user">Julio Cesar Oliveira</strong>
   <a href="#89869" class="date">26-Mar-2009 05:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">XML2Array </span><span class="keyword">( </span><span class="default">$xml </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">simplexml_load_string </span><span class="keyword">( </span><span class="default">$xml </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$newArray </span><span class="keyword">= array ( ) ;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= ( array ) </span><span class="default">$array </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach ( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= ( array ) </span><span class="default">$value </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newArray </span><span class="keyword">[ </span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value </span><span class="keyword">[ </span><span class="default">0 </span><span class="keyword">] ;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$newArray </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">"trim"</span><span class="keyword">, </span><span class="default">$newArray</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">$newArray </span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89430""></a>
  <div class="note">
   <strong class="user">supzero at phparts dot net</strong>
   <a href="#89430" class="date">07-Mar-2009 07:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if we don't know children number. How many loop. How many key.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">XML </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$pointer</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public&nbsp; &nbsp; </span><span class="default">$degerler</span><span class="keyword">=array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">loadString</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pointer </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pointer</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">loadFile</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pointer </span><span class="keyword">= </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pointer</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">getname</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pointer</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">child</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pointer</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">att</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pointer</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">toArray</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">child</span><span class="keyword">() as </span><span class="default">$sq</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">degerler</span><span class="keyword">[</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getname</span><span class="keyword">()][</span><span class="default">$sq</span><span class="keyword">-&gt;</span><span class="default">getname</span><span class="keyword">()][][] = </span><span class="default">$sq</span><span class="keyword">; </span><span class="comment">// How many key<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86807""></a>
  <div class="note">
   <strong class="user">Mark Omohundro, ajamyajax.com</strong>
   <a href="#86807" class="date">04-Nov-2008 07:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How about a recursive function to reduce the xml hard-coding in your apps?&nbsp; Here is my simple listing routine as an example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">list_xml</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$root </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp; </span><span class="default">list_node</span><span class="keyword">(</span><span class="default">$root</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">list_node</span><span class="keyword">(</span><span class="default">$node</span><span class="keyword">) {<br />
&nbsp; foreach (</span><span class="default">$node </span><span class="keyword">as </span><span class="default">$element</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$element</span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$element</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;br/&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">list_node</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86428""></a>
  <div class="note">
   <strong class="user">javalc6 at gmail dot com</strong>
   <a href="#86428" class="date">18-Oct-2008 03:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wanted to convert an array containing strings and other arrays of the same type into a simplexml object.<br />
<br />
Here is the code of the function array2xml that I've developed to perform this conversion. Please note that this code is simple without any checks.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">array2xml</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$tag</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ia2xml</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xml</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xml</span><span class="keyword">.=</span><span class="string">"&lt;</span><span class="default">$key</span><span class="string">&gt;"</span><span class="keyword">.</span><span class="default">ia2xml</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">).</span><span class="string">"&lt;/</span><span class="default">$key</span><span class="string">&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$xml</span><span class="keyword">.=</span><span class="string">"&lt;</span><span class="default">$key</span><span class="string">&gt;"</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">.</span><span class="string">"&lt;/</span><span class="default">$key</span><span class="string">&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$xml</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">"&lt;</span><span class="default">$tag</span><span class="string">&gt;"</span><span class="keyword">.</span><span class="default">ia2xml</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">).</span><span class="string">"&lt;/</span><span class="default">$tag</span><span class="string">&gt;"</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$test</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">]=</span><span class="string">'lunch'</span><span class="keyword">;<br />
</span><span class="default">$test</span><span class="keyword">[</span><span class="string">'time'</span><span class="keyword">]=</span><span class="string">'12:30'</span><span class="keyword">;<br />
</span><span class="default">$test</span><span class="keyword">[</span><span class="string">'menu'</span><span class="keyword">]=array(</span><span class="string">'entree'</span><span class="keyword">=&gt;</span><span class="string">'salad'</span><span class="keyword">, </span><span class="string">'maincourse'</span><span class="keyword">=&gt;</span><span class="string">'steak'</span><span class="keyword">);<br />
<br />
echo </span><span class="default">array2xml</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">,</span><span class="string">"meal"</span><span class="keyword">)-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84365""></a>
  <div class="note">
   <strong class="user">rowan dot collins at gmail dot com</strong>
   <a href="#84365" class="date">10-Jul-2008 04:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There seems to be a lot of talk about SimpleXML having a "problem" with CDATA, and writing functions to rip it out, etc. I thought so too, at first, but it's actually behaving just fine under PHP 5.2.6<br />
<br />
The key is noted above example #6 here:<br />
<a href="http://uk2.php.net/manual/en/simplexml.examples.php" rel="nofollow" target="_blank">http://uk2.php.net/manual/en/simplexml.examples.php</a><br />
<br />
"To compare an element or attribute with a string or pass it into a function that requires a string, you must cast it to a string using (string). Otherwise, PHP treats the element as an object."<br />
<br />
If a tag contains CDATA, SimpleXML remembers that fact, by representing it separately from the string content of the element. So some functions, including print_r(), might not show what you expect. But if you explicitly cast to a string, you get the whole content.<br />
<br />
<span class="default">&lt;?php<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;Text1 &amp;amp; XML entities&lt;/foo&gt;'</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
</span><span class="comment">/*<br />
SimpleXMLElement Object<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; Text1 &amp; XML entities<br />
)<br />
*/<br />
<br />
</span><span class="default">$xml2 </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;&lt;![CDATA[Text2 &amp; raw data]]&gt;&lt;/foo&gt;'</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$xml2</span><span class="keyword">);<br />
</span><span class="comment">/*<br />
SimpleXMLElement Object<br />
(<br />
)<br />
*/<br />
// Where's my CDATA?<br />
<br />
// Let's try explicit casts<br />
</span><span class="default">print_r</span><span class="keyword">( (string)</span><span class="default">$xml </span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">( (string)</span><span class="default">$xml2 </span><span class="keyword">);<br />
</span><span class="comment">/*<br />
Text1 &amp; XML entities<br />
Text2 &amp; raw data<br />
*/<br />
// Much better<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83781""></a>
  <div class="note">
   <strong class="user">SmartD</strong>
   <a href="#83781" class="date">11-Jun-2008 05:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A small 'n nice function to extract an XML and return it as an array. If there is a bug, please let me know here. I testet it for my purposes and it works.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">public function </span><span class="default">extractXML</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
if (!(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">())) {<br />
&nbsp;&nbsp;&nbsp; return (string) </span><span class="default">$xml</span><span class="keyword">;<br />
}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
foreach (</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$child</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$name</span><span class="keyword">=</span><span class="default">$child</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">$name</span><span class="keyword">)==</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$element</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">extractXML</span><span class="keyword">(</span><span class="default">$child</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$element</span><span class="keyword">[][</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">extractXML</span><span class="keyword">(</span><span class="default">$child</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
return </span><span class="default">$element</span><span class="keyword">;&nbsp; &nbsp; <br />
}<br />
<br />
</span><span class="comment">// you can call it this way<br />
<br />
</span><span class="default">$xml </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
<br />
</span><span class="default">$xml </span><span class="keyword">= @</span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xmlstring</span><span class="keyword">);<br />
<br />
</span><span class="comment">// 1)<br />
<br />
</span><span class="keyword">if (</span><span class="default">$xml</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">extractXML</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
}&nbsp; else {<br />
&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// 2)<br />
<br />
</span><span class="keyword">if (</span><span class="default">$xml</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">()] = </span><span class="default">extractXML</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
}&nbsp; else {<br />
&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83641""></a>
  <div class="note">
   <strong class="user">nospam at qool dot com</strong>
   <a href="#83641" class="date">05-Jun-2008 08:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
simplexml doesn't appear to like long attributes. I have tried passing it a valid xhtml document but the url in the anchor tag was causing simplexml to generate an error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82686""></a>
  <div class="note">
   <strong class="user">kyle at codeincarnate dot com</strong>
   <a href="#82686" class="date">22-Apr-2008 02:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A looked through a lot of the sample code for reading XML files with CDATA, but they didn't work out that well for me.&nbsp; However, I found that the following piece of code worked perfectly for reading through a file using lots of CDATA.<br />
<br />
<span class="default">&lt;?php<br />
$article_string </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
</span><span class="default">$article_string </span><span class="keyword">= </span><span class="default">preg_replace_callback</span><span class="keyword">(</span><span class="string">'/&lt;!\[CDATA\[(.*)\]\]&gt;/'</span><span class="keyword">, </span><span class="string">'filter_xml'</span><span class="keyword">, </span><span class="default">$article_string</span><span class="keyword">);<br />
</span><span class="default">$article_xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$article_string</span><span class="keyword">);&nbsp; <br />
<br />
function </span><span class="default">filter_xml</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">trim</span><span class="keyword">(</span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]));<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81217""></a>
  <div class="note">
   <strong class="user">paulyg76 at NOSPAM dot gmail dot com</strong>
   <a href="#81217" class="date">19-Feb-2008 03:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful using nested SimpleXML objects in double quoted strings.<br />
<br />
<span class="default">&lt;?php<br />
$xmlstring </span><span class="keyword">= </span><span class="string">'&lt;root&gt;&lt;node&gt;123&lt;/node&gt;&lt;foo&gt;&lt;bar&gt;456&lt;/bar&gt;&lt;/foo&gt;&lt;/root&gt;'</span><span class="keyword">;<br />
<br />
</span><span class="default">$root </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xmlstring</span><span class="keyword">);<br />
<br />
echo </span><span class="string">"Node is: </span><span class="default">$root</span><span class="keyword">-&gt;</span><span class="default">node</span><span class="string">"</span><span class="keyword">; </span><span class="comment">// Works: Node is 123<br />
</span><span class="keyword">echo </span><span class="string">"Bar is: </span><span class="default">$root</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="string">-&gt;bar"</span><span class="keyword">; </span><span class="comment">// Doesn't work, outputs: Bar is: -&gt;bar<br />
// use curly brackets to fix<br />
</span><span class="keyword">echo </span><span class="string">"Bar is: </span><span class="keyword">{</span><span class="default">$root</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">-&gt;</span><span class="default">bar</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">; </span><span class="comment">// Works: Bar is 456<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80968""></a>
  <div class="note">
   <strong class="user">amir_abiri at ipcmedia dot com</strong>
   <a href="#80968" class="date">08-Feb-2008 05:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It doesn't seem to be documented anywhere, but you can refer to an element "value" for the purpose of changing it like so:<br />
<br />
<span class="default">&lt;?php<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'&lt;root&gt;&lt;number&gt;1&lt;/number&gt;&lt;/root&gt;'</span><span class="keyword">);<br />
echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXml</span><span class="keyword">(). </span><span class="string">"\n\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">number</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">} = </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">number</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">} + </span><span class="default">1</span><span class="keyword">;<br />
<br />
echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXml</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
echos:<br />
&lt;?xml version="1.0"?&gt;<br />
&lt;root&gt;&lt;number&gt;1&lt;/number&gt;&lt;/root&gt;<br />
<br />
&lt;?xml version="1.0"?&gt;<br />
&lt;root&gt;&lt;number&gt;2&lt;/number&gt;&lt;/root&gt;<br />
<br />
However, this only works with a direct assignment, not with any of the other operators:<br />
<br />
<span class="default">&lt;?php<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'&lt;root&gt;&lt;number&gt;1&lt;/number&gt;&lt;/root&gt;'</span><span class="keyword">);<br />
echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXml</span><span class="keyword">(). </span><span class="string">"\n\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">number</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">} += </span><span class="default">1</span><span class="keyword">;<br />
</span><span class="comment">// Or:<br />
</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">number</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">}++;<br />
<br />
echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXml</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Both of the above cases would result in:<br />
<br />
&lt;?xml version="1.0"?&gt;<br />
&lt;root&gt;&lt;number&gt;1&lt;/number&gt;&lt;/root&gt;<br />
<br />
&lt;?xml version="1.0"?&gt;<br />
&lt;root&gt;&lt;number&gt;1&lt;0/&gt;&lt;/number&gt;&lt;/root&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80855""></a>
  <div class="note">
   <strong class="user">bojan</strong>
   <a href="#80855" class="date">04-Feb-2008 01:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As was said before don't use var_dump() or print_r() to see SimpleXML object structure as they do not returns always what you expect.<br />
Consider the following:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// data in xml<br />
</span><span class="default">$xml_txt </span><span class="keyword">= </span><span class="string">'<br />
&lt;root&gt;<br />
&nbsp; &lt;folder ID="65" active="1" permission="1"&gt;&lt;![CDATA[aaaa]]&gt;&lt;/folder&gt;<br />
&nbsp; &lt;folder ID="65" active="1" permission="1"&gt;&lt;![CDATA[bbbb]]&gt;&lt;/folder&gt;<br />
&lt;/root&gt;'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// load xml into SimpleXML object<br />
</span><span class="default">$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xml_txt</span><span class="keyword">, </span><span class="string">'SimpleXMLElement'</span><span class="keyword">, </span><span class="default">LIBXML_NOCDATA</span><span class="keyword">);</span><span class="comment">//LIBXML_NOCDATA LIBXML_NOWARNING<br />
<br />
// see object structure<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
<br />
</span><span class="comment">/* this prints<br />
SimpleXMLElement Object<br />
(<br />
&nbsp;&nbsp;&nbsp; [folder] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; aaaa<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1] =&gt; bbbb<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
)<br />
*/<br />
<br />
// but...<br />
</span><span class="keyword">foreach (</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">folder </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
}<br />
</span><span class="comment">/* prints complete structure of each folder element:<br />
SimpleXMLElement Object<br />
(<br />
&nbsp;&nbsp;&nbsp; [@attributes] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ID] =&gt; 65<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [active] =&gt; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [permission] =&gt; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; aaaa<br />
)<br />
<br />
SimpleXMLElement Object<br />
(<br />
&nbsp;&nbsp;&nbsp; [@attributes] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ID] =&gt; 65<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [active] =&gt; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [permission] =&gt; 1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; bbbb<br />
)<br />
<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78513""></a>
  <div class="note">
   <strong class="user">hattori at hanso dot com</strong>
   <a href="#78513" class="date">16-Oct-2007 12:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Theres a problem with the below workaround when serializing fields containing html CDATA. For any other content type then HTML try to modfiy function parseCDATA.<br />
Just add these lines before serializing.<br />
This is also a workaround for this bug <a href="http://bugs.php.net/bug.php?id=42001" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=42001</a><br />
<br />
<span class="default">&lt;?PHP<br />
</span><span class="keyword">if(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">, </span><span class="string">'&lt;![CDATA['</span><span class="keyword">)) {<br />
&nbsp;&nbsp; function </span><span class="default">parseCDATA</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; </span><span class="default">$content </span><span class="keyword">= </span><span class="default">preg_replace_callback</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'#&lt;!\[CDATA\[(.*)\]\]&gt;#'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'parseCDATA'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="string">" "</span><span class="keyword">, </span><span class="default">$content</span><span class="keyword">)<br />
&nbsp;&nbsp; );<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77868""></a>
  <div class="note">
   <strong class="user">hattori at hanso dot com</strong>
   <a href="#77868" class="date">17-Sep-2007 11:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to serialize and unserialize SimpleXMLElement objects for caching, you need to transform the SimpleXMLElement object into a standard class object before unserializing.<br />
This is only if you want to cache converted data, the functionallity of the SimpleXMLElement will not be held.<br />
<br />
$content = '&lt;SomeXML....'<br />
<br />
$serialized = str_replace(<br />
&nbsp; array('O:16:"SimpleXMLElement":0:{}', 'O:16:"SimpleXMLElement":'),<br />
&nbsp; array('s:0:"";', 'O:8:"stdClass":'),<br />
&nbsp; serialize(simplexml_load_string($content))<br />
);<br />
<br />
$unserialized = unserialize($serialized);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77713""></a>
  <div class="note">
   <strong class="user">nbijnens at servs dot eu</strong>
   <a href="#77713" class="date">10-Sep-2007 02:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that not all LIBXML options are supported with the options argument.<br />
<br />
For instance LIBXML_XINCLUDE does not work. But there is however a work around:<br />
<br />
<span class="default">&lt;?php<br />
$xml </span><span class="keyword">= new </span><span class="default">DOMDocument</span><span class="keyword">();<br />
</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">loadXML </span><span class="keyword">(</span><span class="default">$XMLString</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">xinclude</span><span class="keyword">();<br />
</span><span class="default">$xml </span><span class="keyword">= </span><span class="default">simplexml_import_dom</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76228""></a>
  <div class="note">
   <strong class="user">Pedro</strong>
   <a href="#76228" class="date">06-Jul-2007 10:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Attention:<br />
<br />
simplexml_load_string has a problem with entities other than (&amp;lt;, &amp;gt;, &amp;amp;, &amp;quot; and &amp;apos;). <br />
<br />
Use numeric character references instead!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75316""></a>
  <div class="note">
   <strong class="user">youx_free_fr</strong>
   <a href="#75316" class="date">23-May-2007 06:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While needing to add an xml subtree to an existing simplexml object, I noticed that simplexml_load_string fails with strings like<br />
&lt;emptynode&gt;&lt;/emptynode&gt;<br />
<br />
I needed to use dom instead of simplexml to bypass this problem and work with any kind of xml strings.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74717""></a>
  <div class="note">
   <strong class="user">php at teamhirsch dot com</strong>
   <a href="#74717" class="date">24-Apr-2007 11:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's worth noting that in the example above, $xml-&gt;body will actually return an object of type SimpleXMLElement, not a string, e.g. <br />
<br />
&nbsp;SimpleXMLElement Object ( <br />
&nbsp;&nbsp; &nbsp; &nbsp; [0] =&gt; this is the text in the body tag <br />
&nbsp; )&nbsp; <br />
<br />
If you want to get a string out of it you must explicitly cast it using (string) or double quotes, or pass $xml-&gt;body (or whatever attribute you want to access) to any function that returns a string, such as urldecode() or trim().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73684""></a>
  <div class="note">
   <strong class="user">m dot ament at mailcity dot com</strong>
   <a href="#73684" class="date">06-Mar-2007 03:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning:<br />
<br />
The parsing of XML-data will stop when reaching character 0.<br />
Please avoid this character in your XML-data.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72697""></a>
  <div class="note">
   <strong class="user">mindpower</strong>
   <a href="#72697" class="date">30-Jan-2007 12:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple extension that adds a method for retrieving a specific attribute:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">simple_xml_extended </span><span class="keyword">extends </span><span class="default">SimpleXMLElement<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public&nbsp; &nbsp; function&nbsp; &nbsp; </span><span class="default">Attribute</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Attributes</span><span class="keyword">() as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$key </span><span class="keyword">== </span><span class="default">$name</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return (string)</span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
</span><span class="default">$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'<br />
&lt;xml&gt;<br />
&nbsp; &lt;dog type="poodle" owner="Mrs Smith"&gt;Rover&lt;/dog&gt;<br />
&lt;/xml&gt;'</span><span class="keyword">, </span><span class="string">'simple_xml_extended'</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">dog</span><span class="keyword">-&gt;</span><span class="default">Attribute</span><span class="keyword">(</span><span class="string">'type'</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
outputs 'poodle'<br />
<br />
I prefer to use this technique rather than typecasting attributes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71190""></a>
  <div class="note">
   <strong class="user">h</strong>
   <a href="#71190" class="date">15-Nov-2006 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
seems like simplexml has a line-length restriction - fails if a largeish XML doc with no linebreaks is passed as a string or file.<br />
<br />
h</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70433""></a>
  <div class="note">
   <strong class="user">roy dot walter at nospam dot brookhouse dot co dot uk</strong>
   <a href="#70433" class="date">16-Oct-2006 06:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
simplexml provides a neat way to do 'ini' files. Preferences for any number of users can be held in a single XML file having elements for each user name with user specific preferences as attributes of child elements. The separate &lt;pref/&gt;'s could of course be combined as multiple attributes of a single &lt;pref/&gt; element but this could get unwieldy.<br />
<br />
In the sample code below the makeXML() function uses the simplexml_load_string function to generate some XML to play with and the readPrefs() function parses the requested users preferences into an array.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">makeXML</span><span class="keyword">() {<br />
<br />
</span><span class="default">$xmlString </span><span class="keyword">= &lt;&lt;&lt;XML<br />
</span><span class="string">&lt;preferences&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;johndoe&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;pref color="#FFFFFF"/&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;pref size="14"/&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;pref font="Verdana"/&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/johndoe&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;janedoe&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;pref color="#000000"/&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;pref size="16"/&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;pref font="Georgia"/&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/janedoe&gt;&nbsp; &nbsp; <br />
&lt;/preferences&gt;<br />
</span><span class="keyword">XML;<br />
<br />
return </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xmlString</span><span class="keyword">);<br />
<br />
}<br />
function </span><span class="default">readPrefs</span><span class="keyword">(</span><span class="default">$user</span><span class="keyword">, </span><span class="default">$xml</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">$user </span><span class="keyword">as </span><span class="default">$arr</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$n</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">$user</span><span class="keyword">-&gt;</span><span class="default">pref</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$a</span><span class="keyword">=&gt;</span><span class="default">$b</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$prefs</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">] = (string)</span><span class="default">$b</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$prefs</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">readPrefs</span><span class="keyword">(</span><span class="string">'johndoe'</span><span class="keyword">, </span><span class="default">makeXML</span><span class="keyword">());<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68395""></a>
  <div class="note">
   <strong class="user">paul at santasoft dot com</strong>
   <a href="#68395" class="date">25-Jul-2006 05:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have PHP &gt; 5.1 and LibXML &gt; 2.6, use this function call to have simplexml convert CDATA into plain text.<br />
<br />
simplexml_load_string($xmlstring, 'SimpleXMLElement', LIBXML_NOCDATA);<br />
<br />
Too bad, so sad with PHP &lt; 5.1.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56571""></a>
  <div class="note">
   <strong class="user">lists at cyberlot dot net</strong>
   <a href="#56571" class="date">07-Sep-2005 09:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While you can't add new elements to a SimpleXML object you can however add new attributes<br />
<span class="default">&lt;?php<br />
$string </span><span class="keyword">= </span><span class="string">'&lt;doc channel="chat"&gt;&lt;test1&gt;Hello&lt;/test1&gt;&lt;/doc&gt;'</span><span class="keyword">;<br />
</span><span class="default">$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">test1</span><span class="keyword">[</span><span class="string">'sub'</span><span class="keyword">] = </span><span class="string">'No'</span><span class="keyword">;<br />
echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Will return output<br />
&lt;doc channel="chat"&gt;&lt;test1 sub="No"&gt;Hello&lt;/test1&gt;&lt;/doc&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53638""></a>
  <div class="note">
   <strong class="user">Maciek Ruckgaber &lt;maciekrb at gmai dot com&gt;</strong>
   <a href="#53638" class="date">08-Jun-2005 02:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
after wondering around some time, i just realized something (maybe obvious, not very much for me). Hope helps someone to not waste time as i did :-P<br />
<br />
when you have something like:<br />
<br />
<span class="default">&lt;?php<br />
$xmlstr </span><span class="keyword">= &lt;&lt;&lt;XML<br />
</span><span class="string">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />
&lt;double xmlns="<a href="http://foosite.foo/" rel="nofollow" target="_blank">http://foosite.foo/</a>"&gt;2328&lt;/double&gt;<br />
</span><span class="keyword">XML;<br />
</span><span class="default">?&gt;<br />
</span><br />
you will have the simpleXML object "transformed" to the text() content:<br />
<br />
<span class="default">&lt;?php<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xmlstr</span><span class="keyword">);<br />
echo </span><span class="default">$xml</span><span class="keyword">; </span><span class="comment">// this will echo 2328&nbsp; (string)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48814""></a>
  <div class="note">
   <strong class="user">igor kraus</strong>
   <a href="#48814" class="date">07-Jan-2005 07:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple way to merge two SimpleXML objects.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
* Pumps all child elements of second SimpleXML object into first one.<br />
* <br />
* @param&nbsp; &nbsp; object&nbsp; &nbsp; &nbsp; $xml1&nbsp;&nbsp; SimpleXML object<br />
* @param&nbsp; &nbsp; object&nbsp; &nbsp; &nbsp; $xml2&nbsp;&nbsp; SimpleXML object<br />
* @return&nbsp;&nbsp; void<br />
*/<br />
</span><span class="keyword">function </span><span class="default">simplexml_merge </span><span class="keyword">(</span><span class="default">SimpleXMLElement </span><span class="keyword">&amp;</span><span class="default">$xml1</span><span class="keyword">, </span><span class="default">SimpleXMLElement $xml2</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// convert SimpleXML objects into DOM ones<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dom1 </span><span class="keyword">= new </span><span class="default">DomDocument</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dom2 </span><span class="keyword">= new </span><span class="default">DomDocument</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dom1</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="default">$xml1</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dom2</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="default">$xml2</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">());<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// pull all child elements of second XML<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xpath </span><span class="keyword">= new </span><span class="default">domXPath</span><span class="keyword">(</span><span class="default">$dom2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xpathQuery </span><span class="keyword">= </span><span class="default">$xpath</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">'/*/*'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$xpathQuery</span><span class="keyword">-&gt;</span><span class="default">length</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// and pump them into first one<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dom1</span><span class="keyword">-&gt;</span><span class="default">documentElement</span><span class="keyword">-&gt;</span><span class="default">appendChild</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dom1</span><span class="keyword">-&gt;</span><span class="default">importNode</span><span class="keyword">(</span><span class="default">$xpathQuery</span><span class="keyword">-&gt;</span><span class="default">item</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">), </span><span class="default">true</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xml1 </span><span class="keyword">= </span><span class="default">simplexml_import_dom</span><span class="keyword">(</span><span class="default">$dom1</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$xml1 </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'&lt;root&gt;&lt;child&gt;child 1&lt;/child&gt;&lt;/root&gt;'</span><span class="keyword">);<br />
</span><span class="default">$xml2 </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'&lt;root&gt;&lt;child&gt;child 2&lt;/child&gt;&lt;/root&gt;'</span><span class="keyword">);<br />
</span><span class="default">simplexml_merge</span><span class="keyword">(</span><span class="default">$xml1</span><span class="keyword">, </span><span class="default">$xml2</span><span class="keyword">);<br />
echo(</span><span class="default">$xml1</span><span class="keyword">-&gt;</span><span class="default">asXml</span><span class="keyword">());<br />
</span><span class="default">?&gt;<br />
</span><br />
Will output:<br />
&lt;?xml version="1.0"?&gt;<br />
&lt;root&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;child&gt;child 1&lt;/child&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;child&gt;child 2&lt;/child&gt;<br />
&lt;/root&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45278""></a>
  <div class="note">
   <strong class="user">cellog at php dot net</strong>
   <a href="#45278" class="date">01-Sep-2004 01:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
simplexml does not simply handle CDATA sections in a foreach loop.<br />
<br />
<span class="default">&lt;?php<br />
$sx </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'<br />
&lt;test&gt;<br />
&nbsp;&lt;one&gt;hi&lt;/one&gt;<br />
&nbsp;&lt;two&gt;&lt;![CDATA[stuff]]&gt;&lt;/two&gt;<br />
&nbsp;&lt;t&gt;<br />
&nbsp; &lt;for&gt;two&lt;/for&gt;<br />
&nbsp;&lt;/t&gt;<br />
&nbsp;&lt;multi&gt;one&lt;/multi&gt;<br />
&nbsp;&lt;multi&gt;two&lt;/multi&gt;<br />
&lt;/test&gt;'</span><span class="keyword">);<br />
foreach((array) </span><span class="default">$sx </span><span class="keyword">as </span><span class="default">$tagname </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// &lt;one&gt; will go here<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">} elseif (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// &lt;multi&gt; will go here because it happens multiple times<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">} elseif (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// &lt;t&gt; will go here because it contains tags<br />
&nbsp;&nbsp; &nbsp;&nbsp; // &lt;two&gt; will go here because it contains CDATA!<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
To test in the loop, do this<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">count</span><span class="keyword">((array) </span><span class="default">$val</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// this is not a tag that contains other tags<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="string">'' </span><span class="keyword">. </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// now the CDATA is revealed magically.<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40044""></a>
  <div class="note">
   <strong class="user">greg dot steffensen at spamless dot richmond dot edu</strong>
   <a href="#40044" class="date">20-Feb-2004 12:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simplexml's simplicity can be deceptive.&nbsp; Simplexml elements behave either as objects or strings, depending on the context in which they're used (through overloading of the __toString() method, I assume).&nbsp; Statements implying conversion to string treat them as strings, while assignment operations treat them as objects.&nbsp; This can lead to unexpected behavior if, for example, you are trying to compare the values of two Simplexml elements.&nbsp; The expected syntax will not work.&nbsp; To force conversion to strings, just "typecast' whatever Simplexml element you're using.&nbsp; For example:<br />
<br />
<span class="default">&lt;?php<br />
$s </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;43&lt;/foo&gt; &lt;bar&gt;43&lt;/bar&gt;'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Evaluates to false by comparing object IDs instead of strings<br />
</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">-&gt;</span><span class="default">foo </span><span class="keyword">== </span><span class="default">$s</span><span class="keyword">-&gt;</span><span class="default">bar</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Evaluates to true<br />
</span><span class="keyword">((string)</span><span class="default">$s</span><span class="keyword">-&gt;</span><span class="default">foo </span><span class="keyword">== (string)</span><span class="default">$s</span><span class="keyword">-&gt;</span><span class="default">bar</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
[Ed. Note: Changed from quotes to casts because casts provide a quicker and more explicit conversion than do double quotes.]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.simplexml-load-file.html">simplexml_load_file</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="book.wddx.html">WDDX</a></div>
 <div class="up"><a href="ref.simplexml.html">SimpleXML 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
