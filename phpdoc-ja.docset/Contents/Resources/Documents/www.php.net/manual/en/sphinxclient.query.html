<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Execute search query</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="sphinxclient.open.html">SphinxClient::open</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="sphinxclient.resetfilters.html">SphinxClient::resetFilters</a></div>
 <div class="up"><a href="class.sphinxclient.html">SphinxClient</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="sphinxclient.query" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">SphinxClient::query</h1>
  <p class="verinfo">(PECL sphinx &gt;= 0.1.0)</p><p class="refpurpose"><span class="refname">SphinxClient::query</span> &mdash; <span class="dc-title">Execute search query</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-sphinxclient.query-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">array</span> <span class="methodname"><strong>SphinxClient::query</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$index</code><span class="initializer"> = &quot;*&quot;</span></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$comment</code><span class="initializer"> = &quot;&quot;</span></span>
  ]] )</div>

  <p class="para rdfs-comment">
   Connects to searchd server, runs the given search query with the current settings,
   obtains and returns the result set.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-sphinxclient.query-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><em><code class="parameter">query</code></em></span>
     <dd>

      <p class="para">
      Query string.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">index</code></em></span>
     <dd>

      <p class="para">
       An index name (or names).
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><em><code class="parameter">comment</code></em></span>
     <dd>

      <p class="para">
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-sphinxclient.query-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   On success,  <span class="function"><strong>SphinxClient::query()</strong></span> returns a list of 
   found matches and additional per-query statistics. The result set is a 
   hash utilize other structures instead of hash) with the following keys and
   values:
   <table class="doctable table">
    <caption><strong>Result set structure</strong></caption>
    
     <thead>
      <tr>
       <th>Key</th>
       <th>Value description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>&quot;matches&quot;</td>
       <td>An array with found document IDs as keys and their weight and
        attributes values as values</td>
      </tr>

      <tr>
       <td>&quot;total&quot;</td>
       <td>Total number of matches found and retrieved (depends on your
        settings)</td>
      </tr>

      <tr>
       <td>&quot;total_found&quot;</td>
       <td>Total number of found documents matching the query</td>
      </tr>

      <tr>
       <td>&quot;words&quot;</td>
       <td>An array with words (case-folded and stemmed) as keys and
        per-word statistics as values</td>
      </tr>

      <tr>
       <td>&quot;error&quot;</td>
       <td>Query error message reported by searchd</td>
      </tr>

      <tr>
       <td>&quot;warning&quot;</td>
       <td>Query warning reported by searchd</td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-sphinxclient.query-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><a href="sphinxclient.runqueries.html" class="xref">SphinxClient::runQueries</a></li>
    <li class="member"><a href="sphinxclient.addquery.html" class="xref">SphinxClient::addQuery</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="102434""></a>
  <div class="note">
   <strong class="user">moosh at php dot net</strong>
   <a href="#102434" class="date">14-Feb-2011 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
public array SphinxClient::query ( string $query [, string $index = "*" [, string $comment = "" ]] )<br />
<br />
If you add a value for comment, you can retrieve them in sphinx query log.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99927""></a>
  <div class="note">
   <strong class="user">php at senz dot su</strong>
   <a href="#99927" class="date">15-Sep-2010 04:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is also a "status" key showing in what status query has ended. <br />
Here are codes, taken from searchd.cpp:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/// known status return codes<br />
</span><span class="default">enum SearchdStatus_e<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">SEARCHD_OK&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">,&nbsp; &nbsp; </span><span class="comment">///&lt; general success, command-specific reply follows<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">SEARCHD_ERROR&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">,&nbsp; &nbsp; </span><span class="comment">///&lt; general failure, error message follows<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">SEARCHD_RETRY&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">,&nbsp; &nbsp; </span><span class="comment">///&lt; temporary failure, error message follows, client should retry later<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">SEARCHD_WARNING </span><span class="keyword">= </span><span class="default">3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">///&lt; general success, warning message and command-specific reply follow<br />
</span><span class="keyword">};<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87585""></a>
  <div class="note">
   <strong class="user">fkoehl at gmail dot com</strong>
   <a href="#87585" class="date">11-Dec-2008 05:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It appears that Query() (or the Sphinx program in general) does have some kind of limit imposed on the maximum length of a query submission. Stumbled across this limitation when trying to perform some searches based on content from user-submitted e-mails.<br />
<br />
In looking at the returned array, the 'words' portion only accounts for the first 8 or 9 words of the long query. I'm assuming that the rest of the string is being truncated. The number of accepted words appears to change based on the total length of the words. Just a heads-up.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="sphinxclient.open.html">SphinxClient::open</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="sphinxclient.resetfilters.html">SphinxClient::resetFilters</a></div>
 <div class="up"><a href="class.sphinxclient.html">SphinxClient</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
