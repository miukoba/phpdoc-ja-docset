<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>ディレクトリハンドルからエントリを読み込む</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.opendir.html">opendir</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.rewinddir.html">rewinddir</a></div>
 <div class="up"><a href="ref.dir.html">ディレクトリ 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.readdir" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">readdir</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">readdir</span> &mdash; <span class="dc-title">ディレクトリハンドルからエントリを読み込む</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.readdir-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>readdir</strong></span>
    ([ <span class="methodparam"><span class="type">resource</span> <code class="parameter">$dir_handle</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   ディレクトリから次のエントリの名前を返します。
   エントリ名はファイルシステム上に格納されている順番で返されます。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.readdir-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><em><code class="parameter">dir_handle</code></em></span>
     <dd>

      <p class="para">
        <span class="function"><a href="function.opendir.html" class="function">opendir()</a></span> が事前にオープンした
       ディレクトリハンドル<span class="type"><span class="type リソース">リソース</span></span>。
       ディレクトリハンドルを指定しなかった場合は、
        <span class="function"><a href="function.opendir.html" class="function">opendir()</a></span> が最後にオープンしたものを使用します。
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.readdir-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合にエントリ名、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p> 
  <div class="warning"><strong class="warning">警告</strong><p class="simpara">この関数は論理値
<strong><code>FALSE</code></strong> を返す可能性がありますが、<strong><code>FALSE</code></strong> として評価される値を返す可能性もあります。
詳細については <a href="language.types.boolean.html" class="link">論理値</a>の
セクションを参照してください。この関数の返り値を調べるには
<a href="language.operators.comparison.html" class="link">===演算子</a> を
使用してください。</p></div>
 </div>


 <div class="refsect1 examples" id="refsect1-function.readdir-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-2330">
    <p><strong>例1 ディレクトリ内の全てのエントリのリストを得る</strong></p>
    <div class="example-contents"><p>
     以下の例で、 <span class="function"><strong>readdir()</strong></span> の返り値をどのように調べているかに
     注目してください。返り値が <strong><code>FALSE</code></strong> と一致することを、明示的に
     （値が等しく、かつ型も等しい - 詳細は <a href="language.operators.comparison.html" class="link">
     比較演算子</a> を参照ください）調べています。なぜなら、そうしないと
     <strong><code>FALSE</code></strong> と評価されてしまうディレクトリエントリ
     （例: &quot;0&quot; という名前のディレクトリ）があった場合にループが
     とまってしまうからです。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$handle&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">opendir</span><span style="color: #007700">(</span><span style="color: #DD0000">'/path/to/files'</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Directory&nbsp;handle:&nbsp;</span><span style="color: #0000BB">$handle</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Entries:\n"</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;ディレクトリをループする際の正しい方法です&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">while&nbsp;(</span><span style="color: #0000BB">false&nbsp;</span><span style="color: #007700">!==&nbsp;(</span><span style="color: #0000BB">$entry&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">readdir</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">)))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$entry</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;ディレクトリをループする際の「間違った」方法です&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">while&nbsp;(</span><span style="color: #0000BB">$entry&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">readdir</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$entry</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">closedir</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2331">
    <p><strong>例2 
     カレントディレクトリの全てのエントリを一覧する。ただし <em>.</em>
     および <em>..</em> は取り除く
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$handle&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">opendir</span><span style="color: #007700">(</span><span style="color: #DD0000">'.'</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(</span><span style="color: #0000BB">false&nbsp;</span><span style="color: #007700">!==&nbsp;(</span><span style="color: #0000BB">$entry&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">readdir</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">)))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$entry&nbsp;</span><span style="color: #007700">!=&nbsp;</span><span style="color: #DD0000">"."&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">$entry&nbsp;</span><span style="color: #007700">!=&nbsp;</span><span style="color: #DD0000">".."</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$entry</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">closedir</span><span style="color: #007700">(</span><span style="color: #0000BB">$handle</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.readdir-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"> <span class="function"><a href="function.is-dir.html" class="function" rel="rdfs-seeAlso">is_dir()</a> - ファイルがディレクトリかどうかを調べる</span></li>
    <li class="member"> <span class="function"><a href="function.glob.html" class="function" rel="rdfs-seeAlso">glob()</a> - パターンにマッチするパス名を探す</span></li>
    <li class="member"> <span class="function"><a href="function.opendir.html" class="function" rel="rdfs-seeAlso">opendir()</a> - ディレクトリハンドルをオープンする</span></li>
    <li class="member"> <span class="function"><a href="function.scandir.html" class="function" rel="rdfs-seeAlso">scandir()</a> - 指定されたパスのファイルとディレクトリのリストを取得する</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113122""></a>
  <div class="note">
   <strong class="user">Blizzz</strong>
   <a href="#113122" class="date">03-Sep-2013 01:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If dir_handle is not a proper resource, null will be returned instead of false.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112980""></a>
  <div class="note">
   <strong class="user">canyildiz at gmail dot com</strong>
   <a href="#112980" class="date">14-Aug-2013 10:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that readdir() doesn't mean in alphabetical order everytime while it sorts in directory order which means "ls -U" in linux</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112741""></a>
  <div class="note">
   <strong class="user">jpittman2 at gmail dot com</strong>
   <a href="#112741" class="date">19-Jul-2013 02:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning when using readdir() on certain versions of CentOS on NFS-mounted directories:<br />
<br />
This is not a bug with PHP's readdir, but a bug with certain versions of CentOS's readdir implementation.&nbsp; According to Post #6213 in the CentOS Bugs forum, when using CentOS kernel versions 2.6.18-348 through 2.6.18-348.3.1, invoking readdir on an NFS-mounted directory may not return all the entries.&nbsp; Since PHP's readdir() uses this library, the issue is manifest in PHP as well.<br />
<br />
According to the post, upgrading to version 2.6.18-348.4.1.el5 should solve the issue, though I haven't tried it.<br />
<br />
glob() does NOT seem to suffer from this same vulnerability.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109132""></a>
  <div class="note">
   <strong class="user">avi dot megladon at gmail dot com</strong>
   <a href="#109132" class="date">22-Jun-2012 09:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
loop through folders and sub folders with option to remove specific files.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">listFolderFiles</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="default">$exclude</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ffs </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;ul class="ulli"&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$ffs </span><span class="keyword">as </span><span class="default">$ff</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$exclude</span><span class="keyword">) and !</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$ff</span><span class="keyword">,</span><span class="default">$exclude</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$ff </span><span class="keyword">!= </span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$ff </span><span class="keyword">!= </span><span class="string">'..'</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$ff</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;li&gt;&lt;a href="edit_page.php?path='</span><span class="keyword">.</span><span class="default">ltrim</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$ff</span><span class="keyword">,</span><span class="string">'./'</span><span class="keyword">).</span><span class="string">'"&gt;'</span><span class="keyword">.</span><span class="default">$ff</span><span class="keyword">.</span><span class="string">'&lt;/a&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;li&gt;'</span><span class="keyword">.</span><span class="default">$ff</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$ff</span><span class="keyword">)) </span><span class="default">listFolderFiles</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$ff</span><span class="keyword">,</span><span class="default">$exclude</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;/li&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;/ul&gt;'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">listFolderFiles</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">,array(</span><span class="string">'index.php'</span><span class="keyword">,</span><span class="string">'edit_page.php'</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104943""></a>
  <div class="note">
   <strong class="user">Mauro Alessandro Nonnis</strong>
   <a href="#104943" class="date">17-Jul-2011 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
## List and Rename&nbsp; all files on recursive directories with "recursive directory name" as template + filename<br />
## Advice:&nbsp; other files in the same directory will result in a warning <br />
## scriptname : Recursive Dir_Renfiles_dirname-filename.php<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"Recursive Dir_Renfiles_dirname-filename.php"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$file</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$handle2 </span><span class="keyword">= @</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file2 </span><span class="keyword">= @</span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle2</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$file2</span><span class="string">"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$count </span><span class="keyword">&lt;</span><span class="default">10 </span><span class="keyword">){ @</span><span class="default">rename</span><span class="keyword">(</span><span class="string">"</span><span class="default">$file</span><span class="string">/</span><span class="default">$file2</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$file</span><span class="string">/</span><span class="default">$file</span><span class="string">"</span><span class="keyword">.</span><span class="string">"_</span><span class="default">$file2</span><span class="string">"</span><span class="keyword">);}<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else { @</span><span class="default">rename</span><span class="keyword">(</span><span class="string">"</span><span class="default">$file</span><span class="string">/</span><span class="default">$file2</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$file</span><span class="string">/</span><span class="default">$file</span><span class="string">"</span><span class="keyword">.</span><span class="string">"_</span><span class="default">$file2</span><span class="string">"</span><span class="keyword">);}<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">$count </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104824""></a>
  <div class="note">
   <strong class="user">mrlemonade</strong>
   <a href="#104824" class="date">09-Jul-2011 12:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Get all files on recursive directories in single array.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
&nbsp;* mrlemonade ~<br />
&nbsp;*/<br />
<br />
</span><span class="keyword">function </span><span class="default">getFilesFromDir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) {<br />
<br />
&nbsp; </span><span class="default">$files </span><span class="keyword">= array();<br />
&nbsp; if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir2 </span><span class="keyword">= </span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[] = </span><span class="default">getFilesFromDir</span><span class="keyword">(</span><span class="default">$dir2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[] = </span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; return </span><span class="default">array_flat</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">array_flat</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">) {<br />
<br />
&nbsp; foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$a</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">, </span><span class="default">array_flat</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$tmp</span><span class="keyword">[] = </span><span class="default">$a</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
<br />
&nbsp; return </span><span class="default">$tmp</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// Usage<br />
</span><span class="default">$dir </span><span class="keyword">= </span><span class="string">'/data'</span><span class="keyword">;<br />
</span><span class="default">$foo </span><span class="keyword">= </span><span class="default">getFilesFromDir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103771""></a>
  <div class="note">
   <strong class="user">stuart at horuskol dot net</strong>
   <a href="#103771" class="date">03-May-2011 07:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Looking through the examples, I can't see any that do a simple check on the value of the directory resource that opendir returns and is subsequently used by readdir.<br />
<br />
If opendir returns false, and you simply pass this to the readdir call in the while loop, you will get an infinite loop. <br />
<br />
A simple test helps prevent this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$dir </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
while (</span><span class="default">$dir </span><span class="keyword">&amp;&amp; (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp; </span><span class="comment">// do stuff<br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103418""></a>
  <div class="note">
   <strong class="user">sreekumar [at] sreek [dot] in</strong>
   <a href="#103418" class="date">12-Apr-2011 11:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A function I created to non-recursively get the path of all files and folders including sub-directories of a given folder.<br />
Though I have not tested it completely, it seems to be working.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Finds path, relative to the given root folder, of all files and directories in the given directory and its sub-directories non recursively.<br />
&nbsp;* Will return an array of the form <br />
&nbsp;* array(<br />
&nbsp;*&nbsp;&nbsp; 'files' =&gt; [],<br />
&nbsp;*&nbsp;&nbsp; 'dirs'&nbsp; =&gt; [],<br />
&nbsp;* )<br />
&nbsp;* @author sreekumar<br />
&nbsp;* @param string $root<br />
&nbsp;* @result array<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">read_all_files</span><span class="keyword">(</span><span class="default">$root </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">){<br />
&nbsp; </span><span class="default">$files&nbsp; </span><span class="keyword">= array(</span><span class="string">'files'</span><span class="keyword">=&gt;array(), </span><span class="string">'dirs'</span><span class="keyword">=&gt;array());<br />
&nbsp; </span><span class="default">$directories&nbsp; </span><span class="keyword">= array();<br />
&nbsp; </span><span class="default">$last_letter&nbsp; </span><span class="keyword">= </span><span class="default">$root</span><span class="keyword">[</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$root</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">];<br />
&nbsp; </span><span class="default">$root&nbsp; </span><span class="keyword">= (</span><span class="default">$last_letter </span><span class="keyword">== </span><span class="string">'\\' </span><span class="keyword">|| </span><span class="default">$last_letter </span><span class="keyword">== </span><span class="string">'/'</span><span class="keyword">) ? </span><span class="default">$root </span><span class="keyword">: </span><span class="default">$root</span><span class="keyword">.</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; </span><span class="default">$directories</span><span class="keyword">[]&nbsp; = </span><span class="default">$root</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; while (</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$directories</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir&nbsp; </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$directories</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">== </span><span class="string">'.' </span><span class="keyword">|| </span><span class="default">$file </span><span class="keyword">== </span><span class="string">'..'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file&nbsp; </span><span class="keyword">= </span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$directory_path </span><span class="keyword">= </span><span class="default">$file</span><span class="keyword">.</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$directories</span><span class="keyword">, </span><span class="default">$directory_path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[</span><span class="string">'dirs'</span><span class="keyword">][]&nbsp; = </span><span class="default">$directory_path</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } elseif (</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[</span><span class="string">'files'</span><span class="keyword">][]&nbsp; = </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; <br />
&nbsp; return </span><span class="default">$files</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100872""></a>
  <div class="note">
   <strong class="user">Qwerp</strong>
   <a href="#100872" class="date">12-Nov-2010 07:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a handy function you can use to list the files in the directory you specify, their type (dir or file) and whether they are hidden. <br />
You could modify it to do other things too.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">listDirs</span><span class="keyword">(</span><span class="default">$where</span><span class="keyword">){<br />
echo </span><span class="string">"&lt;table border=\"1\"&gt;&lt;tr&gt;&lt;td&gt;&lt;b&gt;Name&lt;/b&gt;&lt;/td&gt;&lt;td&gt;&lt;b&gt;Type&lt;/b&gt;&lt;/td&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"&lt;td&gt;&lt;b&gt;Invisible (Hidden)?&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$itemHandler</span><span class="keyword">=</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$where</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while((</span><span class="default">$item</span><span class="keyword">=</span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$itemHandler</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">)!=</span><span class="string">"."</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;&lt;td&gt;</span><span class="default">$item</span><span class="string">&lt;/td&gt;&lt;td&gt;Directory&lt;/td&gt;&lt;td&gt;No&lt;/td&gt;&lt;/tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;&lt;td&gt;</span><span class="default">$item</span><span class="string">&lt;/td&gt;&lt;td&gt;File&lt;/td&gt;&lt;td&gt;No&lt;/td&gt;&lt;/tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;&lt;td&gt;</span><span class="default">$item</span><span class="string">&lt;/td&gt;&lt;td&gt;Directory&lt;/td&gt;&lt;td&gt;Yes&lt;/td&gt;&lt;/tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;&lt;td&gt;</span><span class="default">$item</span><span class="string">&lt;/td&gt;&lt;td&gt;File&lt;/td&gt;&lt;td&gt;Yes&lt;/td&gt;&lt;/tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
echo </span><span class="string">"&lt;/table&gt;"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Then call it like this.<br />
<span class="default">&lt;?php<br />
listDirs</span><span class="keyword">(</span><span class="default">DIR</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Example:<br />
<span class="default">&lt;?php<br />
listDirs</span><span class="keyword">(</span><span class="string">"/tests/directorylisting"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
You get a table like this.<br />
<br />
Name&nbsp; &nbsp; Type&nbsp; &nbsp; Invisible (Hidden)?<br />
.&nbsp; &nbsp; Directory&nbsp; &nbsp; Yes<br />
..&nbsp; &nbsp; Directory&nbsp; &nbsp; Yes<br />
.DS_Store&nbsp; &nbsp; File&nbsp; &nbsp; Yes<br />
.localized&nbsp; &nbsp; File&nbsp; &nbsp; Yes<br />
index.php&nbsp; &nbsp; File&nbsp; &nbsp; No<br />
OOOLS&nbsp; &nbsp; Directory&nbsp; &nbsp; No<br />
QwerpWiki.php&nbsp; &nbsp; File&nbsp; &nbsp; No</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100710""></a>
  <div class="note">
   <strong class="user">frasq at frasq dot org</strong>
   <a href="#100710" class="date">01-Nov-2010 04:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A variation on listing all the files in a directory recursively. The code illustrates a basic technique : the use of an auxiliary function. It avoids building temporary lists which are merged on the way back. Note that the array which collects the information must be passed by reference.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">listdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">=</span><span class="string">'.'</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">listdiraux</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$files</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$files</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">listdiraux</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, &amp;</span><span class="default">$files</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">== </span><span class="string">'.' </span><span class="keyword">|| </span><span class="default">$file </span><span class="keyword">== </span><span class="string">'..'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filepath </span><span class="keyword">= </span><span class="default">$dir </span><span class="keyword">== </span><span class="string">'.' </span><span class="keyword">? </span><span class="default">$file </span><span class="keyword">: </span><span class="default">$dir </span><span class="keyword">. </span><span class="string">'/' </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_link</span><span class="keyword">(</span><span class="default">$filepath</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$filepath</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[] = </span><span class="default">$filepath</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$filepath</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">listdiraux</span><span class="keyword">(</span><span class="default">$filepath</span><span class="keyword">, </span><span class="default">$files</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$files </span><span class="keyword">= </span><span class="default">listdir</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">);<br />
</span><span class="default">sort</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">, </span><span class="default">SORT_LOCALE_STRING</span><span class="keyword">);<br />
<br />
foreach (</span><span class="default">$files </span><span class="keyword">as </span><span class="default">$f</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo&nbsp; </span><span class="default">$f</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96490""></a>
  <div class="note">
   <strong class="user">gherson at snet dot net</strong>
   <a href="#96490" class="date">02-Mar-2010 01:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
readdir_recursive() is a recursive readdir() that returns filespecs not filenames.<br />
<br />
<span class="default">&lt;?php<br />
<br />
define</span><span class="keyword">(</span><span class="string">'SEEK'</span><span class="keyword">, </span><span class="string">'the grail'</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'ORIGIN'</span><span class="keyword">, </span><span class="string">"C:\\Documents and Settings\\myname\\My Documents"</span><span class="keyword">);<br />
</span><span class="default">$hits </span><span class="keyword">= array();<br />
</span><span class="default">$handles </span><span class="keyword">= array(</span><span class="default">ORIGIN</span><span class="keyword">=&gt;</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">ORIGIN</span><span class="keyword">)); </span><span class="comment">// Associate handle with its (absolute) path.<br />
////\\\\ "$handles" is special to<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \\\\\\\\\////////<br />
</span><span class="keyword">while (</span><span class="default">$filespec </span><span class="keyword">= </span><span class="default">readdir_recursive</span><span class="keyword">(</span><span class="default">$handles</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cmd </span><span class="keyword">= </span><span class="string">"c:\\cygwin\\bin\\strings '</span><span class="default">$filespec</span><span class="string">' | c:\\cygwin\\bin\\grep -li "</span><span class="keyword">.</span><span class="default">SEEK</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lastLine </span><span class="keyword">= </span><span class="default">exec</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">, </span><span class="default">$out</span><span class="keyword">, </span><span class="default">$status</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// echo "out is ". implode(' ', $out) .", lastLine is $lastLine, status is $status\n";<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">strstr</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">, </span><span class="default">$out</span><span class="keyword">), </span><span class="string">'(standard input)'</span><span class="keyword">)) { </span><span class="comment">// Hit.<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$hits</span><span class="keyword">[] = </span><span class="default">$filespec</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
echo </span><span class="string">"'"</span><span class="keyword">.</span><span class="default">SEEK</span><span class="keyword">.</span><span class="string">"' found in files: &lt;br/&gt;\n"</span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">, </span><span class="default">$hits</span><span class="keyword">);<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Return unique filespecs under given directory tree until all found.<br />
&nbsp;*<br />
&nbsp;* To use: while ($filespec = readdir_recursive(array($dir="\\path\\to\\folder" =&gt; opendir($dir)))) { ...<br />
&nbsp;*<br />
&nbsp;* @param mixed $seed Array(&lt;path&gt;=&gt;&lt;resource&gt;) on 1st call | false during recursion.<br />
&nbsp;* @return mixed $filespec String | false<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">readdir_recursive</span><span class="keyword">(</span><span class="default">$seed </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$handles</span><span class="keyword">; </span><span class="comment">// ("global" instead of "static" because with latter,<br />
&nbsp;&nbsp;&nbsp; // assignments go out of scope when function executions end (via return $filespec;).)<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; // $seed is only true (ie, includes a directory path specified by the user)<br />
&nbsp;&nbsp;&nbsp; // when readdir_recursive() is executing for the 1st time.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$seed</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$handles </span><span class="keyword">= </span><span class="default">$seed</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">assert</span><span class="keyword">(</span><span class="string">'is_array($handles)'</span><span class="keyword">); <br />
<br />
&nbsp;&nbsp;&nbsp; if (empty(</span><span class="default">$handles</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">; </span><span class="comment">// All done.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Advance the current($handles) handle to a new file or folder.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">current</span><span class="keyword">(</span><span class="default">$handles</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$filespec </span><span class="keyword">= </span><span class="default">key</span><span class="keyword">(</span><span class="default">$handles</span><span class="keyword">) .</span><span class="string">"\\"</span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">false</span><span class="keyword">===</span><span class="default">$file</span><span class="keyword">) { </span><span class="comment">// End of current($handles) directory reached.<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // The current element, an exhausted handle, is the last element.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$handles</span><span class="keyword">); </span><span class="comment">// Discard exhausted handle. (This also sets array pointer to array beginning.)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">end</span><span class="keyword">(</span><span class="default">$handles</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// echo "\nUp to element ". key($handles) .'=&gt;'. current($handles) ."\n";<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">readdir_recursive</span><span class="keyword">(); </span><span class="comment">// Resume finding files in a higher level directory.<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">} elseif (</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$filespec</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$filespec</span><span class="keyword">; <br />
<br />
&nbsp;&nbsp;&nbsp; } else { </span><span class="comment">// $file is a directory: Recurse.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$file</span><span class="keyword">!==</span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$file</span><span class="keyword">!==</span><span class="string">'..'</span><span class="keyword">) { </span><span class="comment">// Non-pointer directory reached.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Add this subdirectory to the list that must be traversed.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$handles</span><span class="keyword">[</span><span class="default">$filespec</span><span class="keyword">] = </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$filespec</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">next</span><span class="keyword">(</span><span class="default">$handles</span><span class="keyword">); </span><span class="comment">// Prepare to proceed to the appended subdirectory.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">readdir_recursive</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95458""></a>
  <div class="note">
   <strong class="user">yasirlayth at live dot com</strong>
   <a href="#95458" class="date">04-Jan-2010 02:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this simple function will index the directories and sub-directories of a given dir<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">get_dirs</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$dirs</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (!isset(</span><span class="default">$dirs</span><span class="keyword">)){</span><span class="default">$dirs </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;}<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">) !== </span><span class="string">'\\'</span><span class="keyword">){</span><span class="default">$dir </span><span class="keyword">.= </span><span class="string">'\\'</span><span class="keyword">;}<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">filetype</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">) === </span><span class="string">'dir' </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">clearstatcache</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">.= </span><span class="default">$file </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">get_dirs</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$dirs</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90941""></a>
  <div class="note">
   <strong class="user">DaveRandom</strong>
   <a href="#90941" class="date">17-May-2009 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A very flexible function to recursively list all files in a directory with the option to perform a custom set of actions on those files and/or include extra information about them in the returned data.<br />
<br />
&nbsp;----------<br />
<br />
&nbsp;SYNTAX:<br />
&nbsp;&nbsp; $array = process_dir ( $dir , $recursive = FALSE )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $dir&nbsp; (STRING)&nbsp;&nbsp; =&nbsp; Directory to process<br />
&nbsp; $recursive&nbsp; (BOOLEAN)&nbsp; =&nbsp; [Optional] Recursive if set to TRUE<br />
<br />
&nbsp;RETURN VALUES:<br />
&nbsp; The function returns an indexed array, one entry for every file. Each entry is an associative array, containing the basic information 'filename' (name of file) and 'dirpath' (directory component of path to file), and any additional keys you configure. Returns FALSE on failure.<br />
<br />
&nbsp;----------<br />
<br />
&nbsp; To allow you to configure another key, the entry for each file is stored in an array, "$entry" for each iteration. You can easily return any additional data for a given file using $entry['keyname'] = ... (Note that this data can be any variable type - string, bool, float, resource etc)<br />
<br />
&nbsp; There is a string variable "$path" available, which contains the full path of the current file, relative to the initial "$dir" supplied at function call. This data is also available in it's constituent parts, "$dir" and "$file". Actions for each file can be constructed on the basis of these variables. The variables "$list", "$handle" and "$recursive" should not be used within your code.<br />
<br />
&nbsp;----------<br />
<br />
&nbsp;Simply insert you code into the sections indicated by the comments below and your away!<br />
<br />
&nbsp;The following example returns filename, filepath, and file modified time (in a human-readable string) for all items, filesize for all files but not directories, and a resource stream for all files with 'log' in the filename (but not *.log files).<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp; </span><span class="keyword">function </span><span class="default">process_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="default">$recursive </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; for (</span><span class="default">$list </span><span class="keyword">= array(),</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">); (</span><span class="default">FALSE </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">)));) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'..'</span><span class="keyword">) &amp;&amp; (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">= </span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; (</span><span class="default">$recursive</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$list </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$list</span><span class="keyword">, </span><span class="default">process_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$entry </span><span class="keyword">= array(</span><span class="string">'filename' </span><span class="keyword">=&gt; </span><span class="default">$file</span><span class="keyword">, </span><span class="string">'dirpath' </span><span class="keyword">=&gt; </span><span class="default">$dir</span><span class="keyword">);<br />
<br />
&nbsp;</span><span class="comment">//---------------------------------------------------------//<br />
&nbsp;//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; - SECTION 1 -&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //<br />
&nbsp;//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Actions to be performed on ALL ITEMS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //<br />
&nbsp;//-----------------&nbsp; &nbsp; Begin Editable&nbsp; &nbsp; ------------------//<br />
<br />
&nbsp; </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'modtime'</span><span class="keyword">] = </span><span class="default">filemtime</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
<br />
&nbsp;</span><span class="comment">//-----------------&nbsp; &nbsp;&nbsp; End Editable&nbsp; &nbsp;&nbsp; ------------------//<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">do if (!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {<br />
&nbsp;</span><span class="comment">//---------------------------------------------------------//<br />
&nbsp;//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; - SECTION 2 -&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //<br />
&nbsp;//&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Actions to be performed on FILES ONLY&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //<br />
&nbsp;//-----------------&nbsp; &nbsp; Begin Editable&nbsp; &nbsp; ------------------//<br />
<br />
&nbsp; </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'size'</span><span class="keyword">] = </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp; if (</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">pathinfo</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="default">PATHINFO_BASENAME</span><span class="keyword">),</span><span class="string">'log'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'handle'</span><span class="keyword">] = </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="default">r</span><span class="keyword">)) </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'handle'</span><span class="keyword">] = </span><span class="string">"FAIL"</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; <br />
&nbsp;</span><span class="comment">//-----------------&nbsp; &nbsp;&nbsp; End Editable&nbsp; &nbsp;&nbsp; ------------------//<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;</span><span class="comment">//---------------------------------------------------------//<br />
&nbsp;//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; - SECTION 3 -&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //<br />
&nbsp;//&nbsp; &nbsp; &nbsp;&nbsp; Actions to be performed on DIRECTORIES ONLY&nbsp; &nbsp; &nbsp;&nbsp; //<br />
&nbsp;//-----------------&nbsp; &nbsp; Begin Editable&nbsp; &nbsp; ------------------//<br />
<br />
&nbsp;//-----------------&nbsp; &nbsp;&nbsp; End Editable&nbsp; &nbsp;&nbsp; ------------------//<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } while (</span><span class="default">FALSE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$list</span><span class="keyword">[] = </span><span class="default">$entry</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$list</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">process_dir</span><span class="keyword">(</span><span class="string">'C:/webserver/Apache2/httpdocs/processdir'</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">);<br />
<br />
&nbsp;</span><span class="comment">// Output each opened file and then close<br />
&nbsp; </span><span class="keyword">foreach (</span><span class="default">$result </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'handle'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"\n\nFILE (" </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">[</span><span class="string">'dirpath'</span><span class="keyword">].</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'filename'</span><span class="keyword">] . </span><span class="string">"):\n\n" </span><span class="keyword">. </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'handle'</span><span class="keyword">], </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'dirpath'</span><span class="keyword">].</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'filename'</span><span class="keyword">]));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">[</span><span class="string">'handle'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90770""></a>
  <div class="note">
   <strong class="user">HeadRoom</strong>
   <a href="#90770" class="date">08-May-2009 09:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thought I would include what I wrote to get a random image from a directory.<br />
<br />
<span class="default">&lt;?php<br />
$image_dir </span><span class="keyword">= </span><span class="string">'images'</span><span class="keyword">;<br />
</span><span class="default">$count </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$image_dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$retval </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$file </span><span class="keyword">&lt;&gt; </span><span class="string">"."</span><span class="keyword">) &amp;&amp; (</span><span class="default">$file </span><span class="keyword">&lt;&gt; </span><span class="string">".."</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retval</span><span class="keyword">[</span><span class="default">$count</span><span class="keyword">] = </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">$count </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
}<br />
</span><span class="default">shuffle</span><span class="keyword">(</span><span class="default">$retval</span><span class="keyword">);<br />
</span><span class="default">$current_image </span><span class="keyword">= </span><span class="default">$retval</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
</span><span class="default">?&gt;<br />
</span><br />
[NOTE BY danbrown AT php DOT net: Contains a bugfix/typofix inspired by 'ffd8' on 19-JUN-09.]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89582""></a>
  <div class="note">
   <strong class="user">hanan dot ali dot shaikh at gmail dot com</strong>
   <a href="#89582" class="date">15-Mar-2009 08:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function is used to display random image i.e. at header position of a site. It reads the whole directory and then randomly print the image. I think it may be useful for someone.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="string">'images/'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; </span><span class="default">$dir_array </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$file</span><span class="keyword">!=</span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file</span><span class="keyword">!=</span><span class="string">".."</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir_array</span><span class="keyword">[] = </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$dir_array</span><span class="keyword">[</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">count</span><span class="keyword">(</span><span class="default">$dir_array</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">)];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87733""></a>
  <div class="note">
   <strong class="user">hotrungdungit at gmail dot com</strong>
   <a href="#87733" class="date">18-Dec-2008 05:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Below will return an array of file names and folders in directory<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">ReadFolderDirectory</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">= </span><span class="string">"root_dir/here"</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$listDir </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$handler </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$sub </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handler</span><span class="keyword">)) !== </span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$sub </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$sub </span><span class="keyword">!= </span><span class="string">".." </span><span class="keyword">&amp;&amp; </span><span class="default">$sub </span><span class="keyword">!= </span><span class="string">"Thumb.db"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$sub</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$listDir</span><span class="keyword">[] = </span><span class="default">$sub</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }elseif(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$sub</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$listDir</span><span class="keyword">[</span><span class="default">$sub</span><span class="keyword">] = </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ReadFolderDirectory</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$sub</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handler</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$listDir</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84381""></a>
  <div class="note">
   <strong class="user">MetaNull</strong>
   <a href="#84381" class="date">11-Jul-2008 08:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple directory browser... that handles the windows charset in filenames (it should work for every iso-8859-1 characters).<br />
<span class="default">&lt;?php<br />
&nbsp;$basepath </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="string">"./pub/"</span><span class="keyword">);&nbsp; </span><span class="comment">// Root directory<br />
&nbsp;</span><span class="default">$path </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$basepath</span><span class="keyword">.</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">"path"</span><span class="keyword">]);&nbsp; </span><span class="comment">// Requested&nbsp; path<br />
</span><span class="default">$relativepath </span><span class="keyword">= </span><span class="string">"./"</span><span class="keyword">.</span><span class="default">substr_replace</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">( </span><span class="default">$basepath </span><span class="keyword">) );<br />
&nbsp;if( </span><span class="string">"/" </span><span class="keyword">== </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$relativepath</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">)) {&nbsp; </span><span class="comment">// Remove the trailing slash<br />
&nbsp; </span><span class="default">$relativepath </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$relativepath</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">);<br />
&nbsp;}<br />
<br />
</span><span class="default">$dh </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">( </span><span class="default">$path </span><span class="keyword">);<br />
&nbsp; while( </span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">( </span><span class="default">$dh </span><span class="keyword">))) {<br />
&nbsp;&nbsp; if(</span><span class="string">"." </span><span class="keyword">== </span><span class="default">$file</span><span class="keyword">) {continue;}<br />
&nbsp;&nbsp; </span><span class="comment">// converts the filename to utf8<br />
&nbsp;&nbsp; </span><span class="default">$file_utf8 </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">( </span><span class="string">"iso-8859-1"</span><span class="keyword">, </span><span class="string">"utf-8"</span><span class="keyword">, </span><span class="default">$file </span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="comment">// encode the path ('path' part: already utf8; 'filename' part: still iso-8859-1)<br />
&nbsp;&nbsp; </span><span class="default">$link </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">( </span><span class="string">"%2F"</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="default">rawurlencode</span><span class="keyword">( </span><span class="string">"</span><span class="keyword">{</span><span class="default">$relativepath</span><span class="keyword">}</span><span class="string">/" </span><span class="keyword">)) . </span><span class="default">rawurlencode</span><span class="keyword">( </span><span class="default">utf8_decode</span><span class="keyword">( </span><span class="string">"</span><span class="keyword">{</span><span class="default">$file_utf8</span><span class="keyword">}</span><span class="string">" </span><span class="keyword">));<br />
&nbsp;&nbsp; if( </span><span class="default">is_dir</span><span class="keyword">( </span><span class="string">"</span><span class="keyword">{</span><span class="default">$path</span><span class="keyword">}</span><span class="string">/</span><span class="keyword">{</span><span class="default">$file</span><span class="keyword">}</span><span class="string">" </span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;a href=\"?path=</span><span class="keyword">{</span><span class="default">$link</span><span class="keyword">}</span><span class="string">&amp;amp;\"&gt;</span><span class="keyword">{</span><span class="default">$file_utf8</span><span class="keyword">}</span><span class="string">&lt;/a&gt;&lt;br/&gt;"<br />
&nbsp;&nbsp; </span><span class="keyword">} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;a href=\"</span><span class="keyword">{</span><span class="default">$link</span><span class="keyword">}</span><span class="string">&amp;amp;\"&gt;</span><span class="keyword">{</span><span class="default">$file_utf8</span><span class="keyword">}</span><span class="string">&lt;/a&gt;&lt;br/&gt;"<br />
&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp; }<br />
&nbsp;}<br />
&nbsp;</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82988""></a>
  <div class="note">
   <strong class="user">Kim Christensen</strong>
   <a href="#82988" class="date">05-May-2008 05:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Handy little function that returns the number of files (not directories) that exists under a directory. <br />
Choose if you want the function to recurse through sub-directories with the second parameter - <br />
the default mode (false) is just to count the files directly under the supplied path.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; * Return the number of files that resides under a directory.<br />
&nbsp;&nbsp; * <br />
&nbsp;&nbsp; * @return integer<br />
&nbsp;&nbsp; * @param&nbsp; &nbsp; string (required)&nbsp;&nbsp; The directory you want to start in<br />
&nbsp;&nbsp; * @param&nbsp; &nbsp; boolean (optional)&nbsp; Recursive counting. Default to FALSE. <br />
&nbsp;&nbsp; * @param&nbsp; &nbsp; integer (optional)&nbsp; Initial value of file count<br />
&nbsp;&nbsp; */&nbsp; <br />
<br />
&nbsp; </span><span class="keyword">function </span><span class="default">num_files</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$recursive</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">, </span><span class="default">$counter</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$counter</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(</span><span class="default">$dh </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$counter </span><span class="keyword">= (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">)) ? </span><span class="default">num_files</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$recursive</span><span class="keyword">, </span><span class="default">$counter</span><span class="keyword">) : </span><span class="default">$counter</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$counter</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="comment">// Usage:<br />
&nbsp; </span><span class="default">$nfiles </span><span class="keyword">= </span><span class="default">num_files</span><span class="keyword">(</span><span class="string">"/home/kchr"</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">); </span><span class="comment">// count all files that resides under /home/kchr, including subdirs<br />
&nbsp; </span><span class="default">$nfiles </span><span class="keyword">= </span><span class="default">num_files</span><span class="keyword">(</span><span class="string">"/tmp"</span><span class="keyword">); </span><span class="comment">// count the files directly under /tmp<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82529""></a>
  <div class="note">
   <strong class="user">info at agentur-obermaier dot de</strong>
   <a href="#82529" class="date">15-Apr-2008 01:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a nice quick full dir read - sorry for my bad english ;)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">ReadDirs</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="default">$em</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"Thumb.db"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$em</span><span class="keyword">.</span><span class="string">"&amp;raquo; "</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">ReadDirs</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">,</span><span class="default">$em</span><span class="keyword">.</span><span class="string">"&amp;nbsp;&amp;nbsp;"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81897""></a>
  <div class="note">
   <strong class="user">dbzfanatic_1 at hotmail dot com</strong>
   <a href="#81897" class="date">18-Mar-2008 06:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's an easy way to output the contents as a list of download links.<br />
<br />
<span class="default">&lt;?php<br />
$count </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">) {</span><span class="default">$count</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print(</span><span class="string">"&lt;a href=\""</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"\"&gt;"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"&lt;/a&gt;&lt;br /&gt;\n"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
echo </span><span class="string">'&lt;br /&gt;&lt;br /&gt;&lt;a href=".."&gt;Return&lt;/a&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
and simply use $count to list the overall number of files.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77776""></a>
  <div class="note">
   <strong class="user">skysama at googles_email dot com</strong>
   <a href="#77776" class="date">12-Sep-2007 07:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Yet another view files by extension<br />
<br />
/* NOTE:<br />
&nbsp;*&nbsp; /a-d = do not include directories<br />
&nbsp;*&nbsp; /b&nbsp;&nbsp; = show files in bare mode ( no dates or filesize )<br />
&nbsp;*/<br />
<br />
<span class="default">&lt;?php<br />
$dir </span><span class="keyword">= </span><span class="string">'.\\img\\'</span><span class="keyword">;&nbsp; &nbsp; </span><span class="comment">// reminder: escape your slashes<br />
</span><span class="default">$filetype </span><span class="keyword">= </span><span class="string">"*.png"</span><span class="keyword">;<br />
</span><span class="default">$filelist </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">( </span><span class="string">"dir </span><span class="keyword">{</span><span class="default">$dir</span><span class="keyword">}{</span><span class="default">$filetype</span><span class="keyword">}</span><span class="string"> /a-d /b" </span><span class="keyword">);<br />
</span><span class="default">$file_arr </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">( </span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$filelist </span><span class="keyword">);<br />
</span><span class="default">array_pop</span><span class="keyword">( </span><span class="default">$file_arr </span><span class="keyword">); </span><span class="comment">// last line is always blank<br />
</span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$file_arr </span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77202""></a>
  <div class="note">
   <strong class="user">nullbyte at hotmail dot com</strong>
   <a href="#77202" class="date">20-Aug-2007 09:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I haven't tested this yet, but it seems like it'll do just fine if you need files of a certain extension:<br />
<br />
<span class="default">&lt;?php<br />
$dh </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'inputDir'</span><span class="keyword">]);<br />
</span><span class="default">$files </span><span class="keyword">= array();<br />
while ((</span><span class="default">$filename </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">)) == </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'inputExt'</span><span class="keyword">])<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[] = </span><span class="default">$filename</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75402""></a>
  <div class="note">
   <strong class="user">schursin at gmail[deleteme] dot com</strong>
   <a href="#75402" class="date">28-May-2007 03:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
code:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">permission</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$perms </span><span class="keyword">= </span><span class="default">fileperms</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if&nbsp; &nbsp;&nbsp; ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0xC000</span><span class="keyword">) == </span><span class="default">0xC000</span><span class="keyword">) { </span><span class="default">$info </span><span class="keyword">= </span><span class="string">'s'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0xA000</span><span class="keyword">) == </span><span class="default">0xA000</span><span class="keyword">) { </span><span class="default">$info </span><span class="keyword">= </span><span class="string">'l'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x8000</span><span class="keyword">) == </span><span class="default">0x8000</span><span class="keyword">) { </span><span class="default">$info </span><span class="keyword">= </span><span class="string">'-'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x6000</span><span class="keyword">) == </span><span class="default">0x6000</span><span class="keyword">) { </span><span class="default">$info </span><span class="keyword">= </span><span class="string">'b'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x4000</span><span class="keyword">) == </span><span class="default">0x4000</span><span class="keyword">) { </span><span class="default">$info </span><span class="keyword">= </span><span class="string">'d'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x2000</span><span class="keyword">) == </span><span class="default">0x2000</span><span class="keyword">) { </span><span class="default">$info </span><span class="keyword">= </span><span class="string">'c'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x1000</span><span class="keyword">) == </span><span class="default">0x1000</span><span class="keyword">) { </span><span class="default">$info </span><span class="keyword">= </span><span class="string">'p'</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { </span><span class="default">$info </span><span class="keyword">= </span><span class="string">'u'</span><span class="keyword">; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// владелец<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">.= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0100</span><span class="keyword">) ? </span><span class="string">'r' </span><span class="keyword">: </span><span class="string">'-'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">.= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0080</span><span class="keyword">) ? </span><span class="string">'w' </span><span class="keyword">: </span><span class="string">'-'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">.= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0040</span><span class="keyword">) ? ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0800</span><span class="keyword">) ? </span><span class="string">'s' </span><span class="keyword">: </span><span class="string">'x' </span><span class="keyword">) : ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0800</span><span class="keyword">) ? </span><span class="string">'S' </span><span class="keyword">: </span><span class="string">'-'</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// группа<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">.= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0020</span><span class="keyword">) ? </span><span class="string">'r' </span><span class="keyword">: </span><span class="string">'-'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">.= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0010</span><span class="keyword">) ? </span><span class="string">'w' </span><span class="keyword">: </span><span class="string">'-'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">.= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0008</span><span class="keyword">) ? ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0400</span><span class="keyword">) ? </span><span class="string">'s' </span><span class="keyword">: </span><span class="string">'x' </span><span class="keyword">) : ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0400</span><span class="keyword">) ? </span><span class="string">'S' </span><span class="keyword">: </span><span class="string">'-'</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// все<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">.= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0004</span><span class="keyword">) ? </span><span class="string">'r' </span><span class="keyword">: </span><span class="string">'-'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">.= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0002</span><span class="keyword">) ? </span><span class="string">'w' </span><span class="keyword">: </span><span class="string">'-'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">.= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0001</span><span class="keyword">) ? ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0200</span><span class="keyword">) ? </span><span class="string">'t' </span><span class="keyword">: </span><span class="string">'x' </span><span class="keyword">) : ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0200</span><span class="keyword">) ? </span><span class="string">'T' </span><span class="keyword">: </span><span class="string">'-'</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$info</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; function </span><span class="default">dir_list</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$dir</span><span class="keyword">[</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">] != </span><span class="string">'/'</span><span class="keyword">) </span><span class="default">$dir </span><span class="keyword">.= </span><span class="string">'/'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) return array();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir_handle&nbsp; </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir_objects </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$object </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dir_handle</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">, array(</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">'..'</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filename&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">$dir </span><span class="keyword">. </span><span class="default">$object</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file_object </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'name' </span><span class="keyword">=&gt; </span><span class="default">$object</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'size' </span><span class="keyword">=&gt; </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'perm' </span><span class="keyword">=&gt; </span><span class="default">permission</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'type' </span><span class="keyword">=&gt; </span><span class="default">filetype</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'time' </span><span class="keyword">=&gt; </span><span class="default">date</span><span class="keyword">(</span><span class="string">"d F Y H:i:s"</span><span class="keyword">, </span><span class="default">filemtime</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir_objects</span><span class="keyword">[] = </span><span class="default">$file_object</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$dir_objects</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
call:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; print_r</span><span class="keyword">(</span><span class="default">dir_list</span><span class="keyword">(</span><span class="string">'/path/to/you/dir/'</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
output sample:<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [name] =&gt; api<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [size] =&gt; 0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [perm] =&gt; drwxrwxrwx<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [type] =&gt; dir<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [time] =&gt; 28 May 2007 01:55:02<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [name] =&gt; classes<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [size] =&gt; 0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [perm] =&gt; drwxrwxrwx<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [type] =&gt; dir<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [time] =&gt; 26 May 2007 00:56:44<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [name] =&gt; config.inc.php<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [size] =&gt; 143<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [perm] =&gt; -rw-rw-rw-<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [type] =&gt; file<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [time] =&gt; 26 May 2007 13:13:19<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [name] =&gt; index.php<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [size] =&gt; 131<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [perm] =&gt; -rw-rw-rw-<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [type] =&gt; file<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [time] =&gt; 26 May 2007 22:15:18<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [name] =&gt; modules<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [size] =&gt; 0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [perm] =&gt; drwxrwxrwx<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [type] =&gt; dir<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [time] =&gt; 28 May 2007 00:47:40<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [5] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [name] =&gt; temp<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [size] =&gt; 0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [perm] =&gt; drwxrwxrwx<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [type] =&gt; dir<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [time] =&gt; 28 May 2007 04:49:33<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75156""></a>
  <div class="note">
   <strong class="user">(Qube#php@Efnet)</strong>
   <a href="#75156" class="date">15-May-2007 05:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Sample function to recursively return all files within a directory.<br />
// <a href="http://www.pgregg.com/projects/php/code/recursive_readdir.phps" rel="nofollow" target="_blank">http://www.pgregg.com/projects/php/code/recursive_readdir.phps</a><br />
<br />
</span><span class="keyword">Function </span><span class="default">listdir</span><span class="keyword">(</span><span class="default">$start_dir</span><span class="keyword">=</span><span class="string">'.'</span><span class="keyword">) {<br />
<br />
&nbsp; </span><span class="default">$files </span><span class="keyword">= array();<br />
&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$start_dir</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fh </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$start_dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment"># loop through the files, skipping . and .., and recursing if necessary<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">strcmp</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">)==</span><span class="default">0 </span><span class="keyword">|| </span><span class="default">strcmp</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="string">'..'</span><span class="keyword">)==</span><span class="default">0</span><span class="keyword">) continue;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$filepath </span><span class="keyword">= </span><span class="default">$start_dir </span><span class="keyword">. </span><span class="string">'/' </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ( </span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$filepath</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">, </span><span class="default">listdir</span><span class="keyword">(</span><span class="default">$filepath</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">, </span><span class="default">$filepath</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);<br />
&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment"># false if the function was called with an invalid non-directory argument<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; return </span><span class="default">$files</span><span class="keyword">;<br />
<br />
}<br />
<br />
</span><span class="default">$files </span><span class="keyword">= </span><span class="default">listdir</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75132""></a>
  <div class="note">
   <strong class="user">(Qube#php@Efnet)</strong>
   <a href="#75132" class="date">14-May-2007 11:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an updated version of preg_find() [which has been linked from the glob() man page for years] - this function should provide most of what you want back from reading files, directories, different sorting methods, recursion, and perhaps most powerful of all the ability to pattern match with a PCRE regex.<br />
<br />
You can get preg_find here: <a href="http://www.pgregg.com/projects/php/preg_find/preg_find.php.txt" rel="nofollow" target="_blank">http://www.pgregg.com/projects/php/preg_find/preg_find.php.txt</a><br />
or if you prefer colourful .phps format: <a href="http://www.pgregg.com/projects/php/preg_find/preg_find.phps" rel="nofollow" target="_blank">http://www.pgregg.com/projects/php/preg_find/preg_find.phps</a><br />
or scoll down to the end of this note.<br />
<br />
I wrote several examples on how to use it on my blog at: <a href="http://www.pgregg.com/forums/viewtopic.php?tid=73" rel="nofollow" target="_blank">http://www.pgregg.com/forums/viewtopic.php?tid=73</a><br />
<br />
simple glob() type replacement:<br />
$files = preg_find('/./', $dir);<br />
<br />
recursive?<br />
$files = preg_find('/./', $dir, PREG_FIND_RECURSIVE);<br />
<br />
pattern match? find all .php files:<br />
$files = preg_find('/\.php$/D', $dir, PREG_FIND_RECURSIVE);<br />
<br />
sorted alphabetically?<br />
$files = preg_find('/\.php$/D', $dir, PREG_FIND_RECURSIVE|PREG_FIND_SORTKEYS);<br />
<br />
sorted in by filesize, in descending order?<br />
$files = preg_find('/./', $dir,<br />
&nbsp; PREG_FIND_RECURSIVE|PREG_FIND_RETURNASSOC |PREG_FIND_SORTFILESIZE|PREG_FIND_SORTDESC);<br />
$files=array_keys($files);<br />
<br />
sorted by date modified?<br />
$files = preg_find('/./', $dir,<br />
&nbsp; PREG_FIND_RECURSIVE|PREG_FIND_RETURNASSOC |PREG_FIND_SORTMODIFIED);<br />
$files=array_keys($files);<br />
<br />
Ok, the PHP note says my note is too long, so please click on one of the above links to get it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22941""></a>
  <div class="note">
   <strong class="user">phpwizard-at-pech-dot-cz</strong>
   <a href="#22941" class="date">04-Jul-2002 10:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should work, but it'll be better to read section 13.1.3 Cache-control Mechanisms of RFC 2616 available at <a href="http://rfc.net/rfc2616.html before you start with confusing proxies on the way from you and the client." rel="nofollow" target="_blank">http://rfc.net/rfc2616.html before you start with confusing proxies on the way from you and the client.</a><br />
<br />
Reading it is the best way to learn how proxies work, what should you do to modify cache-related headers of your documents and what you should never do again. :-)<br />
<br />
And of course not reading RFCs is the best way to never learn how internet works and the best way to behave like Microsoft corp.<br />
<br />
Have a nice day!<br />
Jirka Pech</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.opendir.html">opendir</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.rewinddir.html">rewinddir</a></div>
 <div class="up"><a href="ref.dir.html">ディレクトリ 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
