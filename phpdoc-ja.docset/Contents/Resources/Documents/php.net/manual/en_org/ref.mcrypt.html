<html><!-- Mirrored from php.net/manual/en/ref.mcrypt.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:45:06 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Mcrypt Functions</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="ref.mcrypt.html">
 <link rel="shorturl" href="http://php.net/mcrypt">
 <link rel="alternate" href="http://php.net/mcrypt" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="book.mcrypt.html">
 <link rel="prev" href="mcrypt.examples.html">
 <link rel="next" href="function.mcrypt-cbc.html">

 <link rel="alternate" href="ref.mcrypt.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/ref.mcrypt.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/ref.mcrypt.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/ref.mcrypt.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/ref.mcrypt.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/ref.mcrypt.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/ref.mcrypt.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/ref.mcrypt.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/ref.mcrypt.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/ref.mcrypt.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/ref.mcrypt.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.crypto.html">Cryptography Extensions</a></li>      <li><a href="book.mcrypt.html">Mcrypt</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="ref.mcrypt" class="reference">
 <h1 class="title">Mcrypt Functions</h1>

 































































































































































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.mcrypt-cbc.html">mcrypt_cbc</a> — Encrypts/decrypts data in CBC mode</li><li><a href="function.mcrypt-cfb.html">mcrypt_cfb</a> — Encrypts/decrypts data in CFB mode</li><li><a href="function.mcrypt-create-iv.html">mcrypt_create_iv</a> — Creates an initialization vector (IV) from a random source</li><li><a href="function.mcrypt-decrypt.html">mcrypt_decrypt</a> — Decrypts crypttext with given parameters</li><li><a href="function.mcrypt-ecb.html">mcrypt_ecb</a> — Deprecated: Encrypts/decrypts data in ECB mode</li><li><a href="function.mcrypt-enc-get-algorithms-name.html">mcrypt_enc_get_algorithms_name</a> — Returns the name of the opened algorithm</li><li><a href="function.mcrypt-enc-get-block-size.html">mcrypt_enc_get_block_size</a> — Returns the blocksize of the opened algorithm</li><li><a href="function.mcrypt-enc-get-iv-size.html">mcrypt_enc_get_iv_size</a> — Returns the size of the IV of the opened algorithm</li><li><a href="function.mcrypt-enc-get-key-size.html">mcrypt_enc_get_key_size</a> — Returns the maximum supported keysize of the opened mode</li><li><a href="function.mcrypt-enc-get-modes-name.html">mcrypt_enc_get_modes_name</a> — Returns the name of the opened mode</li><li><a href="function.mcrypt-enc-get-supported-key-sizes.html">mcrypt_enc_get_supported_key_sizes</a> — Returns an array with the supported keysizes of the opened algorithm</li><li><a href="function.mcrypt-enc-is-block-algorithm-mode.html">mcrypt_enc_is_block_algorithm_mode</a> — Checks whether the encryption of the opened mode works on blocks</li><li><a href="function.mcrypt-enc-is-block-algorithm.html">mcrypt_enc_is_block_algorithm</a> — Checks whether the algorithm of the opened mode is a block algorithm</li><li><a href="function.mcrypt-enc-is-block-mode.html">mcrypt_enc_is_block_mode</a> — Checks whether the opened mode outputs blocks</li><li><a href="function.mcrypt-enc-self-test.html">mcrypt_enc_self_test</a> — Runs a self test on the opened module</li><li><a href="function.mcrypt-encrypt.html">mcrypt_encrypt</a> — Encrypts plaintext with given parameters</li><li><a href="function.mcrypt-generic-deinit.html">mcrypt_generic_deinit</a> — This function deinitializes an encryption module</li><li><a href="function.mcrypt-generic-end.html">mcrypt_generic_end</a> — This function terminates encryption</li><li><a href="function.mcrypt-generic-init.html">mcrypt_generic_init</a> — This function initializes all buffers needed for encryption</li><li><a href="function.mcrypt-generic.html">mcrypt_generic</a> — This function encrypts data</li><li><a href="function.mcrypt-get-block-size.html">mcrypt_get_block_size</a> — Gets the block size of the specified cipher</li><li><a href="function.mcrypt-get-cipher-name.html">mcrypt_get_cipher_name</a> — Gets the name of the specified cipher</li><li><a href="function.mcrypt-get-iv-size.html">mcrypt_get_iv_size</a> — Returns the size of the IV belonging to a specific cipher/mode combination</li><li><a href="function.mcrypt-get-key-size.html">mcrypt_get_key_size</a> — Gets the key size of the specified cipher</li><li><a href="function.mcrypt-list-algorithms.html">mcrypt_list_algorithms</a> — Gets an array of all supported ciphers</li><li><a href="function.mcrypt-list-modes.html">mcrypt_list_modes</a> — Gets an array of all supported modes</li><li><a href="function.mcrypt-module-close.html">mcrypt_module_close</a> — Closes the mcrypt module</li><li><a href="function.mcrypt-module-get-algo-block-size.html">mcrypt_module_get_algo_block_size</a> — Returns the blocksize of the specified algorithm</li><li><a href="function.mcrypt-module-get-algo-key-size.html">mcrypt_module_get_algo_key_size</a> — Returns the maximum supported keysize of the opened mode</li><li><a href="function.mcrypt-module-get-supported-key-sizes.html">mcrypt_module_get_supported_key_sizes</a> — Returns an array with the supported keysizes of the opened algorithm</li><li><a href="function.mcrypt-module-is-block-algorithm-mode.html">mcrypt_module_is_block_algorithm_mode</a> — Returns if the specified module is a block algorithm or not</li><li><a href="function.mcrypt-module-is-block-algorithm.html">mcrypt_module_is_block_algorithm</a> — This function checks whether the specified algorithm is a block algorithm</li><li><a href="function.mcrypt-module-is-block-mode.html">mcrypt_module_is_block_mode</a> — Returns if the specified mode outputs blocks or not</li><li><a href="function.mcrypt-module-open.html">mcrypt_module_open</a> — Opens the module of the algorithm and the mode to be used</li><li><a href="function.mcrypt-module-self-test.html">mcrypt_module_self_test</a> — This function runs a self test on the specified module</li><li><a href="function.mcrypt-ofb.html">mcrypt_ofb</a> — Encrypts/decrypts data in OFB mode</li><li><a href="function.mdecrypt-generic.html">mdecrypt_generic</a> — Decrypts data</li></ul>
</div>

<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="99263">  
  <a class="name">
  <strong class="user"><em>patrickdk at patrickdk dot com</em></strong></a><div class="date" title="2010-08-06 10:30"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom99263">
<div class="phpcode"><code><span class="html">
This works completely with mysql aes, even long keys.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">mysql_aes_decrypt</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">,</span><span class="default">$ky</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">=</span><span class="string">"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</span><span class="keyword">;
<br>&nbsp; &nbsp; for(</span><span class="default">$a</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$ky</span><span class="keyword">);</span><span class="default">$a</span><span class="keyword">++)
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">]=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">]) ^ </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$ky</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">]));
<br>&nbsp; &nbsp; </span><span class="default">$mode </span><span class="keyword">= </span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$enc </span><span class="keyword">= </span><span class="default">MCRYPT_RIJNDAEL_128</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$dec </span><span class="keyword">= @</span><span class="default">mcrypt_decrypt</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">, @</span><span class="default">mcrypt_create_iv</span><span class="keyword">( @</span><span class="default">mcrypt_get_iv_size</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">), </span><span class="default">MCRYPT_DEV_URANDOM </span><span class="keyword">) );
<br>&nbsp; &nbsp; return </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">,(( </span><span class="default">ord</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">))&gt;=</span><span class="default">0 </span><span class="keyword">and </span><span class="default">ord</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">))&lt;=</span><span class="default">16</span><span class="keyword">)? </span><span class="default">chr</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">( </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dec</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">))):</span><span class="default">null</span><span class="keyword">));
<br>}
<br>
<br>function </span><span class="default">mysql_aes_encrypt</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">,</span><span class="default">$ky</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">=</span><span class="string">"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"</span><span class="keyword">;
<br>&nbsp; &nbsp; for(</span><span class="default">$a</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$ky</span><span class="keyword">);</span><span class="default">$a</span><span class="keyword">++)
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">]=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">%</span><span class="default">16</span><span class="keyword">]) ^ </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$ky</span><span class="keyword">[</span><span class="default">$a</span><span class="keyword">]));
<br>&nbsp; &nbsp; </span><span class="default">$mode</span><span class="keyword">=</span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$enc</span><span class="keyword">=</span><span class="default">MCRYPT_RIJNDAEL_128</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$val</span><span class="keyword">=</span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, (</span><span class="default">16</span><span class="keyword">*(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) / </span><span class="default">16</span><span class="keyword">)+(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) % </span><span class="default">16</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">?</span><span class="default">2</span><span class="keyword">:</span><span class="default">1</span><span class="keyword">))), </span><span class="default">chr</span><span class="keyword">(</span><span class="default">16</span><span class="keyword">-(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) % </span><span class="default">16</span><span class="keyword">)));
<br>&nbsp; &nbsp; return </span><span class="default">mcrypt_encrypt</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">, </span><span class="default">mcrypt_create_iv</span><span class="keyword">( </span><span class="default">mcrypt_get_iv_size</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">), </span><span class="default">MCRYPT_DEV_URANDOM</span><span class="keyword">));
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="92013">  
  <a class="name">
  <strong class="user"><em>manyagain</em></strong></a><div class="date" title="2009-07-04 08:44"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom92013">
<div class="phpcode"><code><span class="html">
if you don't have mcrypt installed, try phpseclib - <a rel="nofollow" target="_blank">http://phpseclib.sourceforge.net</a><br><br>includes pure-php implementations of des, 3des, rc4, aes, and rijndael.&nbsp; uses mcrypt if it's available and a pure-php implementation otherwise.&nbsp; it also has the distinction of having the fastest existent pure-php aes implementation as per section 3.5.5. "Speed Comparisons" of the documentation.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="69782">  
  <a class="name">
  <strong class="user"><em>duerra_NOT_THIS_ at pushitlive dot net</em></strong></a><div class="date" title="2006-09-20 12:56"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom69782">
<div class="phpcode"><code><span class="html">
For those of you that need to use PKCS#5 padding, the mcrypt API's for PHP do not support it.&nbsp; However, you can DIY using the following:
<br>
<br><span class="default">&lt;?php
<br>
<br></span><span class="keyword">function </span><span class="default">encrypt_something</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; </span><span class="default">$size </span><span class="keyword">= </span><span class="default">mcrypt_get_block_size</span><span class="keyword">(</span><span class="string">'des'</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$input </span><span class="keyword">= </span><span class="default">pkcs5_pad</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$size</span><span class="keyword">);
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="string">'YOUR SECRET KEY HERE'</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'des'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$iv </span><span class="keyword">= </span><span class="default">mcrypt_create_iv </span><span class="keyword">(</span><span class="default">mcrypt_enc_get_iv_size</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">), </span><span class="default">MCRYPT_RAND</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">mcrypt_generic_init</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$iv</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">mcrypt_generic</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">mcrypt_generic_deinit</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">mcrypt_module_close</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);
<br>&nbsp; &nbsp; return </span><span class="default">$data</span><span class="keyword">;
<br>}
<br>
<br>function </span><span class="default">pkcs5_pad </span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$blocksize</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; </span><span class="default">$pad </span><span class="keyword">= </span><span class="default">$blocksize </span><span class="keyword">- (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) % </span><span class="default">$blocksize</span><span class="keyword">);
<br>&nbsp; &nbsp; return </span><span class="default">$text </span><span class="keyword">. </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="default">chr</span><span class="keyword">(</span><span class="default">$pad</span><span class="keyword">), </span><span class="default">$pad</span><span class="keyword">);
<br>}
<br>
<br>function </span><span class="default">pkcs5_unpad</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; </span><span class="default">$pad </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">{</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">});
<br>&nbsp; &nbsp; if (</span><span class="default">$pad </span><span class="keyword">&gt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; if (</span><span class="default">strspn</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$pad</span><span class="keyword">), </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) - </span><span class="default">$pad</span><span class="keyword">) != </span><span class="default">$pad</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">* </span><span class="default">$pad</span><span class="keyword">);
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="34579">  
  <a class="name">
  <strong class="user"><em>herowekker at hotmail dot com</em></strong></a><div class="date" title="2003-07-31 05:55"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom34579">
<div class="phpcode"><code><span class="html">
mcrypt_ecb with base64_decode gave some problems, i found out that it had to be chopped to work:
<br>
<br><span class="default">&lt;?php
<br>chop</span><span class="keyword">(</span><span class="default">mcrypt_ecb</span><span class="keyword">(</span><span class="default">MCRYPT_BLOWFISH</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">,</span><span class="default">base64_decode</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">),</span><span class="default">MCRYPT_DECRYPT</span><span class="keyword">));
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="20267">  
  <a class="name">
  <strong class="user"><em>scott at boothcreek dot com</em></strong></a><div class="date" title="2002-03-28 01:28"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom20267">
<div class="phpcode"><code><span class="html">
If you are using ECB mode to encrypt it does not seem to use the iv (initialization vector) for much of anything, given the same key it will always decrypt it no matter what the iv is.&nbsp; If you use CBC mode you must decrypt with the same iv that you encrypted with. <br><br> If you use a different iv before decrypting, your decrypt will not work.&nbsp; IMHO it seems better to use CBC mode than ECB as ECB will always encrypt to the same cipher text given the same plain text&nbsp; (leaving you open to know plaintext attacks).&nbsp; CBC uses the random iv which means text encrypts to different things.&nbsp; You probably could get the same effect from using random keys in ECB mode.<br><br>Read that in the Schneier book - Applied Cryptography (ISBN 0-471-11709-9)&nbsp; This book is a must for anyone seriously using any type of encryption.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="14536">  
  <a class="name">
  <strong class="user"><em>pawelNOSPAM at rsc dot pl</em></strong></a><div class="date" title="2001-08-02 06:37"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom14536">
<div class="phpcode"><code><span class="html">
If you compiled mcrypt and php without problem, but phpinfo() shows there are no supported ciphers and modes, try to change mode to 755 on libdirs (/usr/local/libmcrypt, /usr/local/libcrypt).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="3671">  
  <a class="name">
  <strong class="user"><em>mountie at paygate dot net</em></strong></a><div class="date" title="2000-02-10 05:21"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom3671">
<div class="phpcode"><code><span class="html">
the encrypted result data maybe binary data and It make errors in sql query.
<br>so use the base64_encode/base64_decode function with mcrypt()
<br>try below
<br>
<br><span class="default">&lt;?php
<br>base64_encode</span><span class="keyword">(</span><span class="default">mcrypt_ecb</span><span class="keyword">(</span><span class="default">MCRYPT_BLOWFISH</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">,</span><span class="default">$input</span><span class="keyword">,</span><span class="default">MCRYPT_ENCRYPT</span><span class="keyword">));
<br>
<br></span><span class="default">mcrypt_ecb</span><span class="keyword">(</span><span class="default">MCRYPT_BLOWFISH</span><span class="keyword">,</span><span class="default">$key</span><span class="keyword">,</span><span class="default">base64_decode</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">),</span><span class="default">MCRYPT_DECRYPT</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="94373">  
  <a class="name">
  <strong class="user"><em>p ete postma - googlemail.com</em></strong></a><div class="date" title="2009-10-30 09:42"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom94373">
<div class="phpcode"><code><span class="html">
mcrypt module initialization failed
<br>
<br>I found this circumstance:
<br>
<br>usemcrypt.php:
<br><span class="default">&lt;?php
<br> </span><span class="keyword">function </span><span class="default">protect</span><span class="keyword">() {
<br> </span><span class="comment">//some mcrypt/decrypt command
<br> </span><span class="keyword">}
<br></span><span class="default">?&gt;
<br></span>
<br>filea.php:
<br><span class="default">&lt;?php
<br></span><span class="keyword">include_once(</span><span class="string">'usemcrypt.php'</span><span class="keyword">);
<br>
<br>function </span><span class="default">a</span><span class="keyword">() {
<br> </span><span class="default">protect</span><span class="keyword">();
<br>} </span><span class="default">?&gt;
<br></span>
<br>fileb.php
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">b</span><span class="keyword">() {
<br>&nbsp; include_once(</span><span class="string">'usemcrypt.php'</span><span class="keyword">);
<br>&nbsp; </span><span class="default">protect</span><span class="keyword">();
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>filea.php and a() work fine
<br>fileb.php and b() will report a mcrypt module initialization failed
<br>
<br>I am assuming you can't pull that module in on the fly. If you use a file that calls mcrypt, it has to be included at the head, not in a function.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="80808">  
  <a class="name">
  <strong class="user"><em>phpknights at pookmail dot com</em></strong></a><div class="date" title="2008-02-01 01:18"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80808">
<div class="phpcode"><code><span class="html">
The Pear class Crypt/Blowfish.php will use the mcrypt module if available but the mcrypt module is not required.<br><br>Some very easy Pear and example pseudocode to protect your data by encrypting your databases with a one-way hash and blowfish symmetric encryption.<br><a rel="nofollow" target="_blank">http://en.wikibooks.org/wiki/Cryptography/Database_protection</a><br><br>Using a one-way hash and blowfish symmetric encryption.<br>1. Insert a record of John Doe in an encrypted database.<br>2. Get the encrypted record of user John Doe and decrypt the data.<br><br>1. Insert a record of John Doe in an encrypted database.<br><span class="default">&lt;?php<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">require_once(</span><span class="string">"Crypt/Blowfish.php"</span><span class="keyword">); </span><span class="comment">// a Pear class<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">]&nbsp; &nbsp; &nbsp;&nbsp; =&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"johndoe@anisp.localhost"</span><span class="keyword">; </span><span class="comment">// The Primary key<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]&nbsp; &nbsp; &nbsp; &nbsp; =&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"John Doe"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'creditnr'</span><span class="keyword">]&nbsp; &nbsp; =&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"0192733652342" </span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// crypt - one-way encryption<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$cipher_key </span><span class="keyword">= </span><span class="default">crypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">] , </span><span class="string">"AN_SECRET_COMPANY_SALT"</span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$bf </span><span class="keyword">= new </span><span class="default">Crypt_Blowfish</span><span class="keyword">(</span><span class="string">'ecb'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">setKey</span><span class="keyword">( </span><span class="default">$cipher_key </span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// crypt_blowfish symmetric encryption to encrypt the data<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">]&nbsp; &nbsp; &nbsp;&nbsp; = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">encrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">] );<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]&nbsp; &nbsp; &nbsp; &nbsp; = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">encrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] );<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'creditnr'</span><span class="keyword">]&nbsp; &nbsp; = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">encrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'creditnr'</span><span class="keyword">] );<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">sqlInsert</span><span class="keyword">( </span><span class="default">$aRecord </span><span class="keyword">) ;<br></span><span class="default">?&gt;<br></span><br>2. Get the encrypted record of user John Doe and decrypt the data.<br><span class="default">&lt;?php<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">require_once(</span><span class="string">"Crypt/Blowfish.php"</span><span class="keyword">);&nbsp; </span><span class="comment">// a Pear class<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$primary_key </span><span class="keyword">= </span><span class="string">"johndoe@anisp.localhost"</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// crypt - one-way encryption<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$cipher_key </span><span class="keyword">= </span><span class="default">crypt</span><span class="keyword">(&nbsp; </span><span class="default">$primary_key </span><span class="keyword">, </span><span class="string">"AN_SECRET_COMPANY_SALT"</span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$bf </span><span class="keyword">= new </span><span class="default">Crypt_Blowfish</span><span class="keyword">(</span><span class="string">'ecb'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">setKey</span><span class="keyword">( </span><span class="default">$cipher_key </span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// crypt_blowfish symmetric encryption to ecrypt the primary key for a sql select<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$select_key </span><span class="keyword">= </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">encrypt</span><span class="keyword">(&nbsp; </span><span class="default">$primary_key </span><span class="keyword">) ;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRecord </span><span class="keyword">= </span><span class="default">sqlSelectWithPKEY</span><span class="keyword">( </span><span class="default">$select_key </span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// crypt_blowfish symmetric encryption to decrypt the data<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">]&nbsp; &nbsp; &nbsp;&nbsp; = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">decrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'email'</span><span class="keyword">] );<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]&nbsp; &nbsp; &nbsp; &nbsp; = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">decrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">] );<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'creditnr'</span><span class="keyword">]&nbsp; &nbsp; = </span><span class="default">$bf</span><span class="keyword">-&gt;</span><span class="default">decrypt</span><span class="keyword">( </span><span class="default">$aRecord</span><span class="keyword">[</span><span class="string">'creditnr'</span><span class="keyword">] );<br></span><span class="default">?&gt;<br></span><br>Thanks for reading this.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="80587">  
  <a class="name">
  <strong class="user"><em>Kevin</em></strong></a><div class="date" title="2008-01-23 09:37"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80587">
<div class="phpcode"><code><span class="html">
Solved Problem:<br><br>when compiling php --with-mcrypt, phpinfo() says, that mcrypt ist enabled, but<br>"Supported ciphers none" and<br>"Supported modes none"<br><br>In order to get mcrypt to work in php, you have to configure and compile the libmcrypt source package with the following options:<br>./configure --disable-posix-threads --enable-dynamic-loading</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74817">  
  <a class="name">
  <strong class="user"><em>Ivan Frederiks</em></strong></a><div class="date" title="2007-04-28 07:03"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74817">
<div class="phpcode"><code><span class="html">
To enable mcrypt extension under Windows you need to:<br>1) uncomment line "extension=php_mcrypt.dll" in php.ini<br>2) download libmcrypt.dll from <a rel="nofollow" target="_blank">http://files.edin.dk/php/win32/mcrypt/</a> and put it to System32 directory (for example C:\Windows\System32).<br>Tested on Windows XP+Apache 1.3.37+PHP 4.4.6 (as SAPI module!!!)<br><br>P.S.<br>I wrote this because I got "Cannot load mcrypt extension. Please check your PHP configuration." from phpMyAdmin when I simply uncommented "extension=php_mcrypt.dll" line.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="62850">  
  <a class="name">
  <strong class="user"><em>rolf at winmutt dot com</em></strong></a><div class="date" title="2006-03-10 12:19"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom62850">
<div class="phpcode"><code><span class="html">
mysql AES_ENCRYPT() compatibly function for PHP :
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">mysql_aes_encrypt</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">,</span><span class="default">$ky</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$mode</span><span class="keyword">=</span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">;&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$enc</span><span class="keyword">=</span><span class="default">MCRYPT_RIJNDAEL_128</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$val</span><span class="keyword">=</span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, (</span><span class="default">16</span><span class="keyword">*(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) / </span><span class="default">16</span><span class="keyword">)+(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) % </span><span class="default">16</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">?</span><span class="default">2</span><span class="keyword">:</span><span class="default">1</span><span class="keyword">))), </span><span class="default">chr</span><span class="keyword">(</span><span class="default">16</span><span class="keyword">-(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) % </span><span class="default">16</span><span class="keyword">)));
<br>&nbsp; &nbsp; return </span><span class="default">mcrypt_encrypt</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$ky</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">, </span><span class="default">mcrypt_create_iv</span><span class="keyword">( </span><span class="default">mcrypt_get_iv_size</span><span class="keyword">(</span><span class="default">$enc</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">), </span><span class="default">MCRYPT_DEV_URANDOM</span><span class="keyword">));
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>Please note that if the strlen($ky)&gt;16 then this function will not be compatible.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="62494">  
  <a class="name">
  <strong class="user"><em>vincent at verbrugh dot nl</em></strong></a><div class="date" title="2006-03-01 01:55"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom62494">
<div class="phpcode"><code><span class="html">
If you plan to use Mcrypt Encryption to store encrypted data (e.g. passwords) in a (MySQL) database make sure to set the column to BLOB rather than VARCHAR. Otherwise the data may change which can give unexpected results if you decrypt the value.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="62006">  
  <a class="name">
  <strong class="user"><em>Jerry Hathaway</em></strong></a><div class="date" title="2006-02-16 10:23"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom62006">
<div class="phpcode"><code><span class="html">
After benchmarking AES in 256-bit operation, I've concluded that CBC is far faster than OFB.&nbsp; Using a 14.9 MiB file, on average...<br><br>Encrypt in CBC:&nbsp;&nbsp; 1.9 seconds<br>Encrypt in OFB:&nbsp;&nbsp; 45.7 seconds (same as CFB)<br>Just reading the file:&nbsp; ~.53 seconds<br><br>After some research, I've concluded that OFB and CFB are slightly more secure than CBC, however I believe the performance difference to be due to an implementation issue.<br><br>As a side note on ECB:&nbsp; As stated in the wiki linked to below, ECB is wholly inadequate.&nbsp; It not use an IV (whether it was supplied ot MCrypt or not), meaning the same key and plaintext always produce the same ciphertext and it doesn't hide patterns.&nbsp; The site shows an excellent example of this.<br><br>Very useful info:<br><a rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="61490">  
  <a class="name">
  <strong class="user"><em>triptripon at gmail dot com</em></strong></a><div class="date" title="2006-02-05 03:28"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom61490">
<div class="phpcode"><code><span class="html">
Regarding storing the result on a postgres DB that uses Unicode (follow up to a post below). <br>You don't need to change the DB's encoding to ASCII. <br>Simply use BASE64 to encode the result, it's perfectly safe.<br>use base64_decode before you decrypt.<br>-- Tomer Levinboim</span>
</code></div>
  </div>
 </div>
  <div class="note" id="58446">  
  <a class="name">
  <strong class="user"><em>coz AT metamule D0T com</em></strong></a><div class="date" title="2005-11-04 05:15"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom58446">
<div class="phpcode"><code><span class="html">
If you're going to encrypt data with something like this and store it in postgres.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">encrypt</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">){
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$keychar </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, (</span><span class="default">$i </span><span class="keyword">% </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">))-</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">)+</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$keychar</span><span class="keyword">));
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result</span><span class="keyword">.=</span><span class="default">$char</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$result</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br></span><span class="default">?&gt;
<br></span>
<br>Make sure when you create your database to set the encoding to SQL_ASCII because you won't be able to store this data in a database that uses UNICODE</span>
</code></div>
  </div>
 </div>
  <div class="note" id="54717">  
  <a class="name">
  <strong class="user"><em>paul dot lewis at absolutegenius dot co dot uk</em></strong></a><div class="date" title="2005-07-13 08:33"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom54717">
<div class="phpcode"><code><span class="html">
I've spent the majority of the day attempting to get mcrypt to work under IIS6 with Windows Server 2003 (Web Edition) and PHP 5.0.4<br><br>There seems to be some incompatability with enabling certain extensions (mcrypt being one) when you are running PHP as ISAPI in this environment.<br><br>The way to solve the problem (the error will be that it cannot load php_mcrypt.dll - access is denied) is to run in CGI. While this isn't supposed to be as good performance wise, if you need the mcrypt support (or Oracle support, too, I believe) then this is the only way I've found to do it.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="47626">  
  <a class="name">
  <strong class="user"><em>Jurgen Schwietering</em></strong></a><div class="date" title="2004-11-23 01:20"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47626">
<div class="phpcode"><code><span class="html">
Attention when using keys longer than the actual key size (i.e. 160 bit instead of 128 bit). <br><br>It will work inbetween PHP scripts, but might cause problems when using openssl or other packages with this integration of mcrypt. Cut them always to the supported size (mcrypt_enc_get_key_size) to avoid sleepless hours.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="38860">  
  <a class="name">
  <strong class="user"><em>groundzero at zuavra dot net</em></strong></a><div class="date" title="2004-01-09 05:08"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom38860">
<div class="phpcode"><code><span class="html">
If you've ever compiled PHP from source (any version) you may be familiar with the [in]famous MCRYPT_BLOWFISH_128 compilation error that appears when you attempt to compile --with-mcrypt. It occurs often on Debian but not only there. The problem: during compilation, the PHP configure script always assumes that libmcrypt has been built in conjunction with libltdl. Whenever that is not the case, PHP compilation will fail later saying certain headers (such as the above blowfish example) are missing from mcrypt.h (which is misleading, they're not supposed to be there nor looked after if libltdl was properly involved). Solution: make sure your libmcrypt was linked against libltdl before you even start configuring PHP. You can check by running 'ldd lybmcrypt.so' and verifying that libltdl appears in the output. libltdl can be found in libltld[3][-dev] on Debian or in libtool-libs on Red Hat.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="36291">  
  <a class="name">
  <strong class="user"><em>simms</em></strong></a><div class="date" title="2003-10-03 02:03"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom36291">
<div class="phpcode"><code><span class="html">
DEBIAN users: avoid mcrypt installation headaches. 
<br>to add mcrypt support to an existing php installation, get root and run 
<br>
<br>apt-get install php4-mcrypt
<br>
<br>restart your webserver, and voila.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="36161">  
  <a class="name">
  <strong class="user"><em>steve@itemfront dot ltd dot uk</em></strong></a><div class="date" title="2003-09-29 05:17"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom36161">
<div class="phpcode"><code><span class="html">
Just spent a while getting mcrypt support working with php. Used libmcrypt version 2.5.7 with php 4.3.3. Out of the box it just won't work. Configure as follows:<br><br>libmcrypt:<br><br>&nbsp; ./configure --disable-posix-threads --enable-dynamic-loading<br><br>php: ( as you can see, it's built for a SunONE server, but that's the easy bit to configure! )<br><br>./configure&nbsp; --with-nsapi=/usr/iplanet/servers --enable-sigchld --with-ldap --with-zlib-dir=/usr/lib --with-mcrypt=&lt;srcdir&gt;/libmcrypt-2.5.7<br><br>hth, steve</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83519">  
  <a class="name">
  <strong class="user"><em>artem at it-nt dot ru</em></strong></a><div class="date" title="2008-05-29 12:25"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83519">
<div class="phpcode"><code><span class="html">
And some code for LM hash:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">LMhash</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">14</span><span class="keyword">));<br><br>&nbsp; &nbsp; </span><span class="default">$p1 </span><span class="keyword">= </span><span class="default">LMhash_DESencrypt</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">));<br>&nbsp; &nbsp; </span><span class="default">$p2 </span><span class="keyword">= </span><span class="default">LMhash_DESencrypt</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">));<br><br>&nbsp; &nbsp; return </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">$p1</span><span class="keyword">.</span><span class="default">$p2</span><span class="keyword">);<br>}<br><br>function </span><span class="default">LMhash_DESencrypt</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= array();<br>&nbsp; &nbsp; </span><span class="default">$tmp </span><span class="keyword">= array();<br>&nbsp; &nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br><br>&nbsp; &nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">7</span><span class="keyword">; ++</span><span class="default">$i</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp</span><span class="keyword">[] = </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$len </span><span class="keyword">? </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) : </span><span class="default">0</span><span class="keyword">;<br><br>&nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">[] = </span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] &amp; </span><span class="default">254</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] &lt;&lt; </span><span class="default">7</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] &gt;&gt; </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] &lt;&lt; </span><span class="default">6</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] &gt;&gt; </span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] &lt;&lt; </span><span class="default">5</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">] &gt;&gt; </span><span class="default">3</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">] &lt;&lt; </span><span class="default">4</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">] &gt;&gt; </span><span class="default">4</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">] &lt;&lt; </span><span class="default">3</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">] &gt;&gt; </span><span class="default">5</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">[] = (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">] &lt;&lt; </span><span class="default">2</span><span class="keyword">) | (</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] &gt;&gt; </span><span class="default">6</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$key</span><span class="keyword">[] = </span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] &lt;&lt; </span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="default">$is </span><span class="keyword">= </span><span class="default">mcrypt_get_iv_size</span><span class="keyword">(</span><span class="default">MCRYPT_DES</span><span class="keyword">, </span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$iv </span><span class="keyword">= </span><span class="default">mcrypt_create_iv</span><span class="keyword">(</span><span class="default">$is</span><span class="keyword">, </span><span class="default">MCRYPT_RAND</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$key0 </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; foreach (</span><span class="default">$key </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$key0 </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$crypt </span><span class="keyword">= </span><span class="default">mcrypt_encrypt</span><span class="keyword">(</span><span class="default">MCRYPT_DES</span><span class="keyword">, </span><span class="default">$key0</span><span class="keyword">, </span><span class="string">"KGS!@#$%"</span><span class="keyword">, </span><span class="default">MCRYPT_MODE_ECB</span><span class="keyword">, </span><span class="default">$iv</span><span class="keyword">);<br><br>&nbsp; &nbsp; return </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">$crypt</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;<br></span><br>Some optimization?</span>
</code></div>
  </div>
 </div>
  <div class="note" id="58300">  
  <a class="name">
  <strong class="user"><em>joseph-at-digiweb-dot-net-dot-nz</em></strong></a><div class="date" title="2005-10-30 05:22"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom58300">
<div class="phpcode"><code><span class="html">
A further note for those doing interop between PHP and Java:<br><br>If you're using the BouncyCastle library on the Java side, then you can use the ZeroBytePadding mode now available in it. Mcrypt pads the data with Nulls rather than spaces....<br><br>I've sucessfully done interop using Blowfish/CBC/ZeroBytePadding between PHP and Java this way.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87274">  
  <a class="name">
  <strong class="user"><em>Rafael M. Salvioni</em></strong></a><div class="date" title="2008-11-27 04:26"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom87274">
<div class="phpcode"><code><span class="html">
The follow function is a implementation of the RC4 cypher algorithm in pure PHP code.<br><br>The function is used to encrypt and decrypt data.<br><br><span class="default">&lt;?php<br></span><span class="comment">/**<br> * Crypt/decrypt strings with RC4 stream cypher algorithm.<br> *<br> * @param string $key Key<br> * @param string $data Encripted/pure data<br> * @see&nbsp;&nbsp; <a rel="nofollow" target="_blank">http://pt.wikipedia.org/wiki/RC4</a><br> * @return string<br> */<br></span><span class="keyword">function </span><span class="default">rc4</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="comment">// Store the vectors "S" has calculated<br>&nbsp; &nbsp; </span><span class="keyword">static </span><span class="default">$SC</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="comment">// Function to swaps values of the vector "S"<br>&nbsp; &nbsp; </span><span class="default">$swap </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'&amp;$v1, &amp;$v2'</span><span class="keyword">, </span><span class="string">'<br>&nbsp; &nbsp; &nbsp; &nbsp; $v1 = $v1 ^ $v2;<br>&nbsp; &nbsp; &nbsp; &nbsp; $v2 = $v1 ^ $v2;<br>&nbsp; &nbsp; &nbsp; &nbsp; $v1 = $v1 ^ $v2;<br>&nbsp; &nbsp; '</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$ikey </span><span class="keyword">= </span><span class="default">crc32</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br>&nbsp; &nbsp; if (!isset(</span><span class="default">$SC</span><span class="keyword">[</span><span class="default">$ikey</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Make the vector "S", basead in the key<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$S&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">range</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$j&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$n&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">255</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$char&nbsp; </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">{</span><span class="default">$i </span><span class="keyword">% </span><span class="default">$n</span><span class="keyword">});<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$j&nbsp; &nbsp;&nbsp; </span><span class="keyword">= (</span><span class="default">$j </span><span class="keyword">+ </span><span class="default">$S</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] + </span><span class="default">$char</span><span class="keyword">) % </span><span class="default">256</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$swap</span><span class="keyword">(</span><span class="default">$S</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">$S</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$SC</span><span class="keyword">[</span><span class="default">$ikey</span><span class="keyword">] = </span><span class="default">$S</span><span class="keyword">;<br>&nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$S </span><span class="keyword">= </span><span class="default">$SC</span><span class="keyword">[</span><span class="default">$ikey</span><span class="keyword">];<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="comment">// Crypt/decrypt the data<br>&nbsp; &nbsp; </span><span class="default">$n&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$i&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">$j </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; for (</span><span class="default">$m </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$m </span><span class="keyword">&lt; </span><span class="default">$n</span><span class="keyword">; </span><span class="default">$m</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$i&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= (</span><span class="default">$i </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">) % </span><span class="default">256</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$j&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= (</span><span class="default">$j </span><span class="keyword">+ </span><span class="default">$S</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) % </span><span class="default">256</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$swap</span><span class="keyword">(</span><span class="default">$S</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">$S</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$char&nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$m</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$char&nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">$S</span><span class="keyword">[(</span><span class="default">$S</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] + </span><span class="default">$S</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">]) % </span><span class="default">256</span><span class="keyword">] ^ </span><span class="default">$char</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$m</span><span class="keyword">] = </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/ref.mcrypt.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:45:07 GMT -->


</body></html>