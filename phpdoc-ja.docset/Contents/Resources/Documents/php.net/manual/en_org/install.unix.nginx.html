<html><!-- Mirrored from php.net/manual/en/install.unix.nginx.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:53:02 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Nginx 1.4.x on Unix systems</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="install.unix.nginx.html">
 <link rel="shorturl" href="install.unix.nginx.html">
 <link rel="alternate" href="install.unix.nginx.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="install.unix.html">
 <link rel="prev" href="install.unix.apache2.html">
 <link rel="next" href="install.unix.lighttpd-14.html">

 <link rel="alternate" href="install.unix.nginx.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/install.unix.nginx.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/install.unix.nginx.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/install.unix.nginx.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/install.unix.nginx.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/install.unix.nginx.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/install.unix.nginx.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/install.unix.nginx.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/install.unix.nginx.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/install.unix.nginx.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/install.unix.nginx.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="install.html">Installation and Configuration</a></li>      <li><a href="install.unix.html">Installation on Unix systems</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="install.unix.nginx" class="sect1">
 <h2 class="title">Nginx 1.4.x on Unix systems</h2>

 <p class="para">
  This documentation will cover installing and configuring PHP with
  PHP-FPM for a Nginx 1.4.x HTTP server.
 </p>

 <p class="para">
  This guide will assume that you have built Nginx from source and therefore
  all binaries and configuration files are located at
  <em>/usr/local/nginx</em>. If this is not the case and you have
  obtained Nginx through other means then please refer to the
  <a href="http://wiki.nginx.org/Main" class="link external">»&nbsp;Nginx Wiki</a> in order translate
  this manual to your setup.
 </p>

 <p class="para">
  This guide will cover the basics of configuring an Nginx server to
  process PHP applications and serve them on port 80, it is recommended
  that you study the Nginx and PHP-FPM documentation if you wish to
  optimise your setup past the scope of this documentation.
 </p>

 <p class="para">
  Please note that throughout this documentation version numbers have been
  replaced with an 'x' to ensure this documentation stays correct in the future,
  please replace these as necessary with the corresponding version numbers.
 </p>

 <ol type="1">
  <li class="listitem">
   <p class="para">
    It is recomended that you visit the Nginx Wiki
    <a href="http://wiki.nginx.org/Install" class="link external">»&nbsp;install</a> page 
    in order to obtain and install Nginx on your system.
   </p>
  </li>

  <li class="listitem">
   <p class="para">
    Obtain and unpack the PHP source:
   </p>

   <div class="example" id="install.unix.nginx.extract.php">
    <div class="example-contents screen">
<div class="cdata"><pre>tar zxf php-x.x.x
</pre></div>
    </div>
   </div>
  </li>

  <li class="listitem">
   <p class="para">
    Configure and build PHP.  This is where you customize PHP
    with various options, like which extensions will be enabled. Run
    ./configure --help for a list of available options.  In our example
    we'll do a simple configure with PHP-FPM and MySQL support.
   </p>

   <div class="example" id="install.unix.nginx.build.php">
    <div class="example-contents screen">
<div class="cdata"><pre>cd ../php-x.x.x
./configure --enable-fpm --with-mysql
make
sudo make install
</pre></div>
    </div>
   </div>
  </li>

  <li class="listitem">
   <p class="para">
    Obtain and move configuration files to their correct locations
   </p>

   <div class="example" id="install.unix.nginx.configure.php">
    <div class="example-contents screen">
<div class="cdata"><pre>cp php.ini-development /usr/local/php/php.ini
cp /usr/local/etc/php-fpm.conf.default /usr/local/etc/php-fpm.conf
cp sapi/fpm/php-fpm /usr/local/bin
</pre></div>
    </div>
   </div>
  </li>

  <li class="listitem">
   <p class="para">
    It is important that we prevent Nginx from passing requests to the
    PHP-FPM backend if the file does not exists, allowing us to prevent
    arbitrarily script injection.
   </p>
   <p class="para">
    We can fix this by setting the
    <a href="ini.core.html#ini.cgi.fix-pathinfo" class="link">cgi.fix_pathinfo</a>
    directive to <em>0</em> within our php.ini file.
   </p>
   <p class="para">
    Load up php.ini:
   </p>

   <div class="example" id="install.unix.nginx.configure.ini">
    <div class="example-contents screen">
<div class="cdata"><pre>vim /usr/local/php/php.ini
</pre></div>
    </div>
   </div>

   <p class="para">
    Locate <em>cgi.fix_pathinfo=</em> and modify it as follows:
   </p>

   <div class="example" id="install.unix.nginx.configure.pathinfo">
    <div class="example-contents screen">
<div class="cdata"><pre>cgi.fix_pathinfo=0
</pre></div>
    </div>
   </div>
  </li>

  <li class="listitem">
   <p class="para">
    php-fpm.conf must be modified to specify that php-fpm must run as the user
    www-data and the group www-data before we can start the service:
   </p>

   <div class="example" id="install.unix.nginx.modify.phpfpm">
    <div class="example-contents screen">
<div class="cdata"><pre>vim /usr/local/etc/php-fpm.conf
</pre></div>
    </div>
   </div>

   <p class="para">
    Find and modify the following: 
   </p>

   <div class="example" id="install.unix.nginx.modify.phpfpm.usergroup">
    <div class="example-contents screen">
<div class="cdata"><pre>; Unix user/group of processes
; Note: The user is mandatory. If the group is not set, the default user's group
;       will be used.
user = www-data
group = www-data
</pre></div>
    </div>
   </div>

   <p class="para">
    The php-fpm service can now be started:
   </p>

   <div class="example" id="install.unix.nginx.start.phpfpm">
    <div class="example-contents screen">
<div class="cdata"><pre>/usr/local/bin/php-fpm
</pre></div>
    </div>
   </div>

   <p class="para">
    This guide will not configure php-fpm any further, if you are interested
    in further configuring php-fpm then please consult the documentation.
   </p>
  </li>

  <li class="listitem">
   <p class="para">
    Nginx must now be configured to support the processing of PHP applications:
   </p>

   <div class="example" id="install.unix.nginx.configure.nginx">
    <div class="example-contents">
<div class="cdata"><pre>vim /usr/local/nginx/conf/nginx.conf
</pre></div>
    </div>

   </div>

   <p class="para">
    Modify the default location block to be aware it must attempt
    to serve .php files:
   </p>

   <div class="example" id="install.unix.nginx.configure.nginx.location">
    <div class="example-contents">
<div class="nginx-confcode"><pre class="nginx-confcode">location / {
    root   html;
    index  index.php index.html index.htm;
}</pre>
</div>
    </div>

   </div>

   <p class="para">
    The next step is to ensure that .php files are passed to the
    PHP-FPM backend, blow the commented default PHP location block,
    enter the following:
   </p>

   <div class="example" id="install.unix.nginx.configure.nginx.php">
    <div class="example-contents">
<div class="nginx-confcode"><pre class="nginx-confcode">location ~* \.php$ {
    fastcgi_index   index.php;
    fastcgi_pass    127.0.0.1:9000;
    include         fastcgi_params;
    fastcgi_param   SCRIPT_FILENAME    $document_root$fastcgi_script_name;
    fastcgi_param   SCRIPT_NAME        $fastcgi_script_name;
}</pre>
</div>
    </div>

   </div>

   <p class="para">
    Restart Nginx.
   </p>

   <div class="example" id="install.unix.nginx.restart.nginx">
    <div class="example-contents screen">
<div class="cdata"><pre>sudo /usr/local/nginx/sbin/nginx -s stop
sudo /usr/local/nginx/sbin/nginx
</pre></div>
    </div>
   </div>
  </li>

  <li class="listitem">
   <p class="para">
    Create a test file
   </p>

   <div class="example" id="install.unix.nginx.test.nginx.php">
    <div class="example-contents screen">
<div class="cdata"><pre>rm /usr/local/nginx/html/index.html
echo "&lt;?php phpinfo(); ?&gt;" &gt;&gt; /usr/local/nginx/html/index.php
</pre></div>
    </div>
   </div>

   <p class="para">
    Now navigate to http://localhost. The phpinfo() should now be shown.
   </p>
  </li>
 </ol>

 <p class="para">
  Following the steps above you will have a running Nginx web server with
  support for PHP as a <em>SAPI</em> module.  Of course there are
  many more configuration options available Apache and PHP.  For more
  information type <strong class="command">./configure --help</strong> in the corresponding
  source tree.
 </p>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div>
 <div class="note">There are no user contributed notes for this page.</div></section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/install.unix.nginx.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:53:03 GMT -->


</body></html>