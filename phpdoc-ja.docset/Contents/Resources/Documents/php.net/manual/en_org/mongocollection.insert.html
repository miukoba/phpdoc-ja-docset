<html><!-- Mirrored from php.net/manual/en/mongocollection.insert.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 17:03:52 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>MongoCollection::insert</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="mongocollection.insert.html">
 <link rel="shorturl" href="mongocollection.insert.html">
 <link rel="alternate" href="mongocollection.insert.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="class.mongocollection.html">
 <link rel="prev" href="mongocollection.group.html">
 <link rel="next" href="mongocollection.parallelcollectionscan.html">

 <link rel="alternate" href="mongocollection.insert.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/mongocollection.insert.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/mongocollection.insert.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/mongocollection.insert.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/mongocollection.insert.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/mongocollection.insert.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/mongocollection.insert.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/mongocollection.insert.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/mongocollection.insert.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/mongocollection.insert.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/mongocollection.insert.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.vendors.html">Vendor Specific Database Extensions</a></li>      <li><a href="book.mongo.html">Mongo</a></li>      <li><a href="mongo.core.html">Core Classes</a></li>      <li><a href="class.mongocollection.html">MongoCollection</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="mongocollection.insert" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">MongoCollection::insert</h1>
  <p class="verinfo">(PECL mongo &gt;=0.9.0)</p><p class="refpurpose"><span class="refname">MongoCollection::insert</span> — <span class="dc-title">Inserts a document into the collection</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-mongocollection.insert-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type"><span class="type bool|array">bool|array</span></span> <span class="methodname"><strong>MongoCollection::insert</strong></span>
    ( <span class="methodparam"><span class="type"><span class="type array|object">array|object</span></span> <code class="parameter">$a</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code><span class="initializer"> = array()</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   All strings sent to the database must be UTF-8.  If a string is not UTF-8, a 
   <a href="class.mongoexception.html" class="classname">MongoException</a> will be thrown.  To insert 
   (or query for) a non-UTF-8 string, use <a href="class.mongobindata.html" class="classname">MongoBinData</a>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-mongocollection.insert-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>

      <code class="parameter">a</code>
     </dt>

     <dd>

      <p class="para">
       An array or object. If an object is used, it may not have protected or
       private properties.
      </p>
      <blockquote class="note"><p><strong class="note">Note</strong>: 
       </p><p class="para">
        If the parameter does not have an <em>_id</em> key or
        property, a new <a href="class.mongoid.html" class="classname">MongoId</a> instance will be created
        and assigned to it. This special behavior does not mean that the
        parameter is passed by reference.
       </p>
      <p></p></blockquote>
     </dd>

    
    
     <dt>

      <code class="parameter">options</code>
     </dt>

     <dd>

      <p class="para">
       An array of options for the insert operation. Currently available options
       include:
       </p><ul class="itemizedlist">
        <li class="listitem"><p class="para"><em>"fsync"</em></p><p class="para">Boolean, defaults to <strong><code>FALSE</code></strong>. If journaling is enabled, it works exactly like <em>"j"</em>. If journaling is not enabled, the write operation blocks until it is synced to database files on disk. If <strong><code>TRUE</code></strong>, an acknowledged insert is implied and this option will override setting <em>"w"</em> to <em>0</em>.</p><blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">If journaling is enabled, users are strongly encouraged to use the <em>"j"</em> option instead of <em>"fsync"</em>. Do not use <em>"fsync"</em> and <em>"j"</em> simultaneously, as that will result in an error.</span></p></blockquote></li>
        <li class="listitem"><p class="para"><em>"j"</em></p><p class="para">Boolean, defaults to <strong><code>FALSE</code></strong>. Forces the write operation to block until it is synced to the journal on disk. If <strong><code>TRUE</code></strong>, an acknowledged write is implied and this option will override setting <em>"w"</em> to <em>0</em>.</p><blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">If this option is used and journaling is disabled, MongoDB 2.6+ will raise an error and the write will fail; older server versions will simply ignore the option.</span></p></blockquote></li>
        <li class="listitem"><p class="para"><em>"socketTimeoutMS"</em></p><p class="para">This option specifies the time limit, in milliseconds, for socket communication. If the server does not respond within the timeout period, a <a href="class.mongocursortimeoutexception.html" class="classname">MongoCursorTimeoutException</a> will be thrown and there will be no way to determine if the server actually handled the write or not. A value of <em>-1</em> may be specified to block indefinitely. The default value for <a href="class.mongoclient.html" class="classname">MongoClient</a> is <em>30000</em> (30 seconds).</p></li>
        <li class="listitem"><p class="para"><em>"w"</em></p><p class="para">See <a href="mongo.writeconcerns.html" class="link">Write Concerns</a>. The default value for <a href="class.mongoclient.html" class="classname">MongoClient</a> is <em>1</em>.</p></li>
        <li class="listitem"><p class="para"><em>"wTimeoutMS"</em></p><p class="para">This option specifies the time limit, in milliseconds, for <a href="mongo.writeconcerns.html" class="link">write concern</a> acknowledgement. It is only applicable when <em>"w"</em> is greater than <em>1</em>, as the timeout pertains to replication. If the write concern is not satisfied within the time limit, a <a href="class.mongocursorexception.html" class="classname">MongoCursorException</a> will be thrown. A value of <em>0</em> may be specified to block indefinitely. The default value for <a href="class.mongoclient.html" class="classname">MongoClient</a> is <em>10000</em> (ten seconds).</p></li>
       </ul>
      <p></p>
      <p class="para">
       The following options are deprecated and should no longer be used:
       </p><ul class="itemizedlist">
        <li class="listitem"><p class="para"><em>"safe"</em></p><p class="para">Deprecated. Please use the <a href="mongo.writeconcerns.html" class="link">write concern</a> <em>"w"</em> option.</p></li>
        <li class="listitem"><p class="para"><em>"timeout"</em></p><p class="para">Deprecated alias for <em>"socketTimeoutMS"</em>.</p></li>
        <li class="listitem"><p class="para"><em>"wtimeout"</em></p><p class="para">Deprecated alias for <em>"wTimeoutMS"</em>.</p></li>
       </ul>
      <p></p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-mongocollection.insert-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns an array containing the status of the insertion if the
   <em>"w"</em> option is set. Otherwise, returns <strong><code>TRUE</code></strong> if the
   inserted array is not empty (a <a href="class.mongoexception.html" class="classname">MongoException</a> will be
   thrown if the inserted array is empty).
  </p>
  <p class="para">
   If an array is returned, the following keys may be present:
   </p><dl>

    
     <dt>

      <code class="parameter">ok</code>
     </dt>

     <dd>

      <p class="para">
       This should almost always be 1 (unless last_error itself failed).
      </p>
     </dd>

    
    
     <dt>

      <code class="parameter">err</code>
     </dt>

     <dd>

      <p class="para">
       If this field is non-null, an error occurred on the previous operation.
       If this field is set, it will be a string describing the error that
       occurred. 
      </p>
     </dd>

    
    
     <dt>

      <code class="parameter">code</code>
     </dt>

     <dd>

      <p class="para">
       If a database error occurred, the relevant error code will be passed
       back to the client. 
      </p>
     </dd>

    
    
     <dt>

      <code class="parameter">errmsg</code>
     </dt>

     <dd>

      <p class="para">
       This field is set if something goes wrong with a database command. It
       is coupled with <em>ok</em> being 0. For example, if
       <em>w</em> is set and times out, errmsg will be set to "timed
       out waiting for slaves" and <em>ok</em> will be 0.  If this
       field is set, it will be a string describing the error that occurred. 
      </p>
     </dd>

    
    
     <dt>

      <code class="parameter">n</code>
     </dt>

     <dd>

      <p class="para">
       If the last operation was an update, upsert, or a remove, the number
       of documents affected will be returned. For insert operations, this value
       is always <em>0</em>.
      </p>
     </dd>

    
    
     <dt>

      <code class="parameter">wtimeout</code>
     </dt>

     <dd>

      <p class="para">
       If the previous option timed out waiting for replication. 
      </p>
     </dd>

    
    
     <dt>

      <code class="parameter">waited</code>
     </dt>

     <dd>

      <p class="para">
       How long the operation waited before timing out. 
      </p>
     </dd>

    
    
     <dt>

      <code class="parameter">wtime</code>
     </dt>

     <dd>

      <p class="para">
       If <em>w</em> was set and the operation succeeded, how long it took to
       replicate to <em>w</em> servers. 
      </p>
     </dd>

    
    
     <dt>

      <code class="parameter">upserted</code>
     </dt>

     <dd>

      <p class="para">
       If an upsert occurred, this field will contain the new record's
       <em>_id</em> field. For upserts, either this field or
       <em>updatedExisting</em> will be present (unless an error
       occurred). 
      </p>
     </dd>

    
    
     <dt>

      <code class="parameter">updatedExisting</code>
     </dt>

     <dd>

      <p class="para">
       If an upsert updated an existing element, this field will be true. For
       upserts, either this field or upserted will be present (unless an error
       occurred). 
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 errors" id="refsect1-mongocollection.insert-errors">
  <h3 class="title">Errors/Exceptions</h3>
  <p class="para">
   Throws <a href="class.mongoexception.html" class="classname">MongoException</a> if the inserted document is
   empty or if it contains zero-length keys. Attempting to insert an object with
   protected and private properties will cause a zero-length key error.
  </p>
  <p class="para">Throws <a href="class.mongocursorexception.html" class="classname">MongoCursorException</a> if the <em>"w"</em> option is set and the write fails.</p><p class="para">Throws <a href="class.mongocursortimeoutexception.html" class="classname">MongoCursorTimeoutException</a> if the <em>"w"</em> option is set to a value greater than one and the operation takes longer than <var class="varname"><var class="varname">MongoCursor::$timeout</var></var> milliseconds to complete.  This does not kill the operation on the server, it is a client-side timeout. The operation in <var class="varname"><var class="varname">MongoCollection::$wtimeout</var></var> is milliseconds.</p>
 </div>


 <div class="refsect1 changelog" id="refsect1-mongocollection.insert-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   </p><table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>1.5.0</td>
       <td>
        <p class="para">
         Added the <em>"wTimeoutMS"</em> option, which replaces
         <em>"wtimeout"</em>. Emits <strong><code>E_DEPRECATED</code></strong>
         when <em>"wtimeout"</em> is used.
        </p>
        <p class="para">
         Added the <em>"socketTimeoutMS"</em> option, which replaces
         <em>"timeout"</em>. Emits <strong><code>E_DEPRECATED</code></strong>
         when <em>"timeout"</em> is used.
        </p>
        <p class="para">
         Emits <strong><code>E_DEPRECATED</code></strong> when <em>"safe"</em>
         is used.
        </p>
       </td>
      </tr>

      <tr>
       <td>1.3.4</td>
       <td>Added <em>"wtimeout"</em> option.</td>
      </tr>

      <tr>
       <td>1.3.0</td>
       <td>
        <p class="para">Added <em>"w"</em> option.</p>
        <p class="para">
         The <code class="parameter">options</code> parameter no longer accepts a
         boolean to signify an acknowledged write. Instead, this now has to be
         done with <em>array('w' =&gt; 1)</em> (the default behaviour of
         <a href="class.mongoclient.html" class="classname">MongoClient</a>).
        </p>
       </td>
      </tr>

      <tr>
       <td>1.2.0</td>
       <td>Added <em>"timeout"</em> option.</td>
      </tr>

      <tr>
       <td>1.0.11</td>
       <td>
        Disconnects on "not master" errors if <em>"safe"</em> is set.
       </td>
      </tr>

      <tr>
       <td>1.0.9</td>
       <td>
        <p class="para">
         Added ability to pass integers to the <em>"safe"</em> option,
         which previously only accepted booleans.
        </p>
        <p class="para">
         Added <em>"fsync"</em> option.
        </p>
        <p class="para">
         The return type was changed to be an array containing error information
         if the <em>"safe"</em> option is used. Otherwise, a boolean
         is returned as before.
        </p>
       </td>
      </tr>

      <tr>
       <td>1.0.5</td>
       <td>
        Changed second parameter to be an array of options. Pre-1.0.5, the
        second parameter was a boolean indicating the <em>"safe"</em>
        option.
       </td>
      </tr>

      <tr>
       <td>1.0.1</td>
       <td>
        Throw a <a href="class.mongocursorexception.html" class="classname">MongoCursorException</a> if the
        <em>"safe"</em> option is set and the insert fails.
       </td>
      </tr>

     </tbody>
    
   </table>

  <p></p>
 </div>


 <div class="refsect1 examples" id="refsect1-mongocollection.insert-examples">
  <h3 class="title">Examples</h3>
  <div class="example" id="example-1525">
   <p><strong>Example #1 <span class="function"><strong>MongoCollection::insert()</strong></span> <em>_id</em> example</strong></p>
   <div class="example-contents"><p>
    An <em>_id</em> field will be added to the inserted document if
    not already present. Depending on how the parameter is passed, a generated
    <em>_id</em> may or may not be available to calling code.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$m&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">MongoClient</span><span style="color: #007700">();<br></span><span style="color: #0000BB">$collection&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">selectCollection</span><span style="color: #007700">(</span><span style="color: #DD0000">'test'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'phpmanual'</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;If&nbsp;an&nbsp;array&nbsp;literal&nbsp;is&nbsp;used,&nbsp;there&nbsp;is&nbsp;no&nbsp;way&nbsp;to&nbsp;access&nbsp;the&nbsp;generated&nbsp;_id<br></span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">insert</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'x'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">));<br><br></span><span style="color: #FF8000">//&nbsp;The&nbsp;_id&nbsp;is&nbsp;available&nbsp;on&nbsp;an&nbsp;array&nbsp;passed&nbsp;by&nbsp;value<br></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'x'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">insert</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;The&nbsp;_id&nbsp;is&nbsp;not&nbsp;available&nbsp;on&nbsp;an&nbsp;array&nbsp;passed&nbsp;by&nbsp;reference<br></span><span style="color: #0000BB">$b&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'x'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$ref&nbsp;</span><span style="color: #007700">=&nbsp;&amp;</span><span style="color: #0000BB">$b</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">insert</span><span style="color: #007700">(</span><span style="color: #0000BB">$ref</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$ref</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;The&nbsp;_id&nbsp;is&nbsp;available&nbsp;if&nbsp;a&nbsp;wrapping&nbsp;function&nbsp;does&nbsp;not&nbsp;trigger&nbsp;copy-on-write<br></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">insert_no_cow</span><span style="color: #007700">(</span><span style="color: #0000BB">$collection</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$document</span><span style="color: #007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">insert</span><span style="color: #007700">(</span><span style="color: #0000BB">$document</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #0000BB">$c&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'x'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">);<br></span><span style="color: #0000BB">insert_no_cow</span><span style="color: #007700">(</span><span style="color: #0000BB">$collection</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$c</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$c</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;The&nbsp;_id&nbsp;is&nbsp;not&nbsp;available&nbsp;if&nbsp;a&nbsp;wrapping&nbsp;function&nbsp;triggers&nbsp;copy-on-write<br></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">insert_cow</span><span style="color: #007700">(</span><span style="color: #0000BB">$collection</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$document</span><span style="color: #007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$document</span><span style="color: #007700">[</span><span style="color: #DD0000">'y'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">insert</span><span style="color: #007700">(</span><span style="color: #0000BB">$document</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #0000BB">$d&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'x'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">);<br></span><span style="color: #0000BB">insert_cow</span><span style="color: #007700">(</span><span style="color: #0000BB">$collection</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$d</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$d</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>The above example will output
something similar to:</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>array(2) {
  ["x"]=&gt;
  int(2)
  ["_id"]=&gt;
  object(MongoId)#4 (0) {
  }
}
array(1) {
  ["x"]=&gt;
  int(3)
}
array(2) {
  ["x"]=&gt;
  int(4)
  ["_id"]=&gt;
  object(MongoId)#5 (0) {
  }
}
array(1) {
  ["x"]=&gt;
  int(5)
}
</pre></div>
   </div>
  </div>

  <div class="example" id="example-1526">
   <p><strong>Example #2 <span class="function"><strong>MongoCollection::insert()</strong></span> acknowledged write example</strong></p>
   <div class="example-contents"><p>
    This example shows inserting two elements with the same _id, which causes 
    a <a href="class.mongocursorexception.html" class="classname">MongoCursorException</a> to be thrown, as 
    <code class="parameter">w</code> was set.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$person&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"name"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"Joe"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"age"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">insert</span><span style="color: #007700">(</span><span style="color: #0000BB">$person</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;now&nbsp;$person&nbsp;has&nbsp;an&nbsp;_id&nbsp;field,&nbsp;so&nbsp;if&nbsp;we&nbsp;save&nbsp;it&nbsp;<br>//&nbsp;again,&nbsp;we&nbsp;will&nbsp;get&nbsp;an&nbsp;exception<br></span><span style="color: #007700">try&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">insert</span><span style="color: #007700">(</span><span style="color: #0000BB">$person</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"w"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">));<br>}&nbsp;catch(</span><span style="color: #0000BB">MongoCursorException&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Can't&nbsp;save&nbsp;the&nbsp;same&nbsp;person&nbsp;twice!\n"</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-mongocollection.insert-seealso">
  <h3 class="title">See Also</h3>
  <ul class="simplelist">
   <li class="member"><span class="function"><a href="mongocollection.batchinsert.html" class="function" rel="rdfs-seeAlso">MongoCollection::batchInsert()</a> - Inserts multiple documents into this collection</span></li>
   <li class="member"><span class="function"><a href="mongocollection.update.html" class="function" rel="rdfs-seeAlso">MongoCollection::update()</a> - Update records based on a given criteria</span></li>
   <li class="member"><span class="function"><a href="mongocollection.find.html" class="function" rel="rdfs-seeAlso">MongoCollection::find()</a> - Queries this collection, returning a MongoCursor
  for the result set</span></li>
   <li class="member"><span class="function"><a href="mongocollection.remove.html" class="function" rel="rdfs-seeAlso">MongoCollection::remove()</a> - Remove records from this collection</span></li>
   <li class="member">MongoDB core docs on <a href="http://docs.mongodb.org/manual/tutorial/insert-documents/" class="link external">»&nbsp;insert</a>.</li>
  </ul>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="111848">  
  <a class="name">
  <strong class="user"><em>root at php dot net</em></strong></a><div class="date" title="2013-04-04 11:06"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111848">
<div class="phpcode"><code><span class="html">
_id and MongoId can be a source of problems that can make what would seem a trivial operation potentially complicated.<br><br>MongoId is not as predictable or safe as mysql's auto increment (an example that most PHP developers will be familiar with). _id is generated by the client rather than the server and so does not guarantee that it will be collision free.<br><br>By comparison, server side auto_increment mechanisms that PHP programmers might typically be used to wont collide until every single id had been used and with 64bits you can ensure this will almost never happen. You will also know when your table is getting full, and you can predict the rate. Most importantly, no matter the mechanism, being server side guarantees two clients wont collide. Mongo's behaviour is different to this.<br><br>Generally speaking inserting without specifying _id will tend to work, but there are some cases where is can fail or is particularly prone to failure.<br><br>The total size I believe is 96 bits. This might seem like a lot but the value is not created randomly. It is generated like this:<br><br>$unixtime . $machine_id . $pid . $counter<br><br>The counter starts from zero and is attached to each instance of MongoClient thus two MongoClient connections to the same server will almost certainly not work (produce a collision):<br><br>$m=new MongoWrapper();<br>$m-&gt;insert([0]);<br>$m=new MongoWrapper();<br>$m-&gt;insert([1]);<br><br>If MongoWrapper is not using a singleton for the connection or something to the same effect, the second call will most likely have the same unixtime. It will certainly have the same machine_id, pid and counter. The insert will fail.<br><br>If you are not using a singleton, this will work:<br><br>$m=new MongoWrapper();<br>$m-&gt;insert([0]);<br>$m-&gt;insert([1]);<br><br>You may also have difficulties in a multiple machine environment.<br><br>machine_id is a hash of gethostname. This is not guaranteed to be unique across machines. Some people do not set hostnames at all. If you do not ensure that your machines all have unique hostnames then if in the same second, two machines run a script that inserts, the second will have a 1 in 2^15 chance of colliding (assuming the most common PID max). Depending on how the system handles pids, the probability may actually be a little less. In short, make sure any host accessing your mongodb has a hostname that is unique among any other host accessing your mongodb.<br><br>I've seen some specs specify that counter should start from a random value but I highly recommend against this as it merely hides/obscures the problem.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111172">  
  <a class="name">
  <strong class="user"><em>gmail.com@mspreij</em></strong></a><div class="date" title="2013-01-22 04:53"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111172">
<div class="phpcode"><code><span class="html">
"Note: If the parameter does not have an _id key or property, a new MongoId instance will be created and assigned to it."<br><br>Note on note: this is true even if the insert *fails* (because of, say, duplicate key error). So even if no new document was inserted, the supplied array will still have a new MongoID key -&gt;_id after the -&gt;insert().<br><br>(which can make an attempted update after that fail, because you cannot update the _id value of a document..)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109868">  
  <a class="name">
  <strong class="user"><em>John S.</em></strong></a><div class="date" title="2012-08-29 02:10"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom109868">
<div class="phpcode"><code><span class="html">
Note, that the _id field will only be added to an inserted array if it does not already exist in the supplied array:
<br>
<br><span class="default">&lt;?php
<br>$data </span><span class="keyword">= array(</span><span class="string">'x' </span><span class="keyword">=&gt; </span><span class="default">12</span><span class="keyword">);
<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);
<br></span><span class="default">$collection</span><span class="keyword">-&gt;</span><span class="default">insert</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);
<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Will output something like:
<br>
<br>array(1) {
<br>&nbsp; ["x"]=&gt;
<br>&nbsp; int(12)
<br>}
<br>array(2) {
<br>&nbsp; ["x"]=&gt;
<br>&nbsp; int(12)
<br>&nbsp; ["_id"]=&gt;
<br>&nbsp; object(MongoId)#196 (1) {
<br>&nbsp; &nbsp; ["$id"]=&gt;
<br>&nbsp; &nbsp; string(24) "503e21fc0605290912000000"
<br>&nbsp; }
<br>}
<br>
<br>however,
<br>
<br>$data = array('x' =&gt; 12, '_id' =&gt; NULL);
<br>var_dump($data);
<br>$collection-&gt;insert($data);
<br>var_dump($data);
<br>
<br>will not have the same result:
<br>
<br>array(2) {
<br>&nbsp; ["x"]=&gt;
<br>&nbsp; int(12)
<br>&nbsp; ["_id"]=&gt;
<br>&nbsp; NULL
<br>}
<br>array(2) {
<br>&nbsp; ["x"]=&gt;
<br>&nbsp; int(12)
<br>&nbsp; ["_id"]=&gt;
<br>&nbsp; NULL
<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103220">  
  <a class="name">
  <strong class="user"><em>Christer Edvartsen</em></strong></a><div class="date" title="2011-04-01 08:54"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103220">
<div class="phpcode"><code><span class="html">
Also worth noting is that the MongoCollection::insert() method accepts objects as the first argument as well as arrays.<br><br><span class="default">&lt;?php<br>$data </span><span class="keyword">= new </span><span class="default">stdClass</span><span class="keyword">;<br></span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">foo </span><span class="keyword">= </span><span class="string">'foo'</span><span class="keyword">;<br></span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">bar </span><span class="keyword">= </span><span class="string">'bar'</span><span class="keyword">;<br></span><span class="default">$collection</span><span class="keyword">-&gt;</span><span class="default">insert</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">_id</span><span class="keyword">); </span><span class="comment">// An instance of MongoId<br></span><span class="default">?&gt;<br></span><br>You can use other classes as well, but MongoCollection::insert() will fail if the object contains any protected or private properties. Public properties listed in the class will also be inserted:<br><br><span class="default">&lt;?php<br></span><span class="keyword">class </span><span class="default">SomeClass </span><span class="keyword">{<br>&nbsp; &nbsp; public </span><span class="default">$foo </span><span class="keyword">= </span><span class="string">'bar'</span><span class="keyword">;<br>&nbsp; &nbsp; public </span><span class="default">$bar </span><span class="keyword">= </span><span class="string">'foo'</span><span class="keyword">;<br>}<br><br></span><span class="default">$data </span><span class="keyword">= new </span><span class="default">SomeClass</span><span class="keyword">;<br></span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">foobar </span><span class="keyword">= </span><span class="default">42</span><span class="keyword">;<br></span><span class="default">$collection</span><span class="keyword">-&gt;</span><span class="default">insert</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">_id</span><span class="keyword">); </span><span class="comment">// An instance of MongoId<br></span><span class="default">?&gt;<br></span><br>will result in a document with four elements:<br><br>_id =&gt; some mongoid<br>foo =&gt; 'bar'<br>bar =&gt; 'foo'<br>foobar =&gt; 42</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115097">  
  <a class="name">
  <strong class="user"><em>mike at eastghost dot com</em></strong></a><div class="date" title="2014-05-25 03:53"><strong>3 months ago</strong></div>
  <div class="text" id="Hcom115097">
<div class="phpcode"><code><span class="html">
Attempting to insert() an array containing a NULL value followed by a blank space, in a non-utf8 encoding, results in the entire array (and all of its data) being ignored and the $opts array parameter being substituted instead as the data.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110745">  
  <a class="name">
  <strong class="user"><em>cuisdy at gmail dot com</em></strong></a><div class="date" title="2012-11-30 05:21"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom110745">
<div class="phpcode"><code><span class="html">
Another rarity to keep in mind. Passing references has the same effect as passing a referenced object. Even if there's no different for PHP between those two, it's probably not evident. So, this code would not have the _id field added to $a:<br><br><span class="default">&lt;?php<br><br>$b </span><span class="keyword">= &amp;</span><span class="default">$a</span><span class="keyword">;<br><br></span><span class="comment">/* ... more code here ... */<br><br></span><span class="default">$m </span><span class="keyword">= new </span><span class="default">MongoClient</span><span class="keyword">;<br></span><span class="default">$collection </span><span class="keyword">= </span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">-&gt;</span><span class="default">phpmanual</span><span class="keyword">;<br><br></span><span class="default">$a </span><span class="keyword">= array(</span><span class="string">'x' </span><span class="keyword">=&gt; </span><span class="default">12</span><span class="keyword">);<br><br></span><span class="default">$collection</span><span class="keyword">-&gt;</span><span class="default">insert</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br></span><span class="comment">// array(1) { ["x"]=&gt; int(12) }<br><br></span><span class="default">?&gt;<br></span><br>I've made the assignment above to show how this situation could happen, if you reassigned a var, for example. But it could be some normal referencing after giving $a its final value (but before calling insert), and the consequence would be the same: if a var is referenced, it won't get the _id appended.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/mongocollection.insert.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 17:03:52 GMT -->


</body></html>