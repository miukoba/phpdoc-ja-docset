<html><!-- Mirrored from php.net/manual/en/function.serialize.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:06:38 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>serialize</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.serialize.html">
 <link rel="shorturl" href="http://php.net/serialize">
 <link rel="alternate" href="http://php.net/serialize" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.var.html">
 <link rel="prev" href="function.print-r.html">
 <link rel="next" href="function.settype.html">

 <link rel="alternate" href="function.serialize.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.serialize.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.serialize.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.serialize.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.serialize.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.serialize.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.serialize.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.serialize.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.serialize.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.serialize.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.serialize.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></li>      <li><a href="book.var.html">Variable handling</a></li>      <li><a href="ref.var.html">Variable handling Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.serialize" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">serialize</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">serialize</span> â€” <span class="dc-title">Generates a storable representation of a value</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.serialize-description">
  <h3 class="title">Description</h3>
   <div class="methodsynopsis dc-description">
    <span class="type">string</span> <span class="methodname"><strong>serialize</strong></span>
     ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$value</code></span>
    )</div>

  <p class="para rdfs-comment">
   Generates a storable representation of a value.
  </p>
  <p class="para">
   This is useful for storing or passing PHP values around without
   losing their type and structure.
  </p>
  <p class="para">
   To make the serialized string into a PHP value again, use
   <span class="function"><a href="function.unserialize.html" class="function">unserialize()</a></span>.  
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.serialize-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">value</code></dt>

     <dd>

      <p class="para">
       The value to be serialized. <span class="function"><strong>serialize()</strong></span>
       handles all types, except the <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>-type.
       You can even <span class="function"><strong>serialize()</strong></span> arrays that contain
       references to itself. Circular references inside the array/object you 
       are serializing will also be stored. Any other 
       reference will be lost.
      </p>
      <p class="para">
       When serializing objects, PHP will attempt to call the member function
       <a href="language.oop5.magic.html#object.sleep" class="link">__sleep()</a> prior to serialization. 
       This is to allow the object to do any last minute clean-up, etc. prior 
       to being serialized. Likewise, when the object is restored using 
       <span class="function"><a href="function.unserialize.html" class="function">unserialize()</a></span> the <a href="language.oop5.magic.html#object.wakeup" class="link">__wakeup()</a> member function is called.
      </p>
      <blockquote class="note"><p><strong class="note">Note</strong>: 
       </p><p class="para">
       Object's private members have the class name prepended to the member
       name; protected members have a '*' prepended to the member name.
       These prepended values have null bytes on either side.
       </p>
      <p></p></blockquote>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.serialize-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns a string containing a byte-stream representation of 
   <code class="parameter">value</code> that can be stored anywhere.
  </p>
  <p class="para">
   Note that this is a binary string which may include null bytes, and needs
   to be stored and handled as such. For example,
   <span class="function"><strong>serialize()</strong></span> output should generally be stored in a BLOB
   field in a database, rather than a CHAR or TEXT field.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.serialize-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-5384">
    <p><strong>Example #1 <span class="function"><strong>serialize()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;$session_data&nbsp;contains&nbsp;a&nbsp;multi-dimensional&nbsp;array&nbsp;with&nbsp;session<br>//&nbsp;information&nbsp;for&nbsp;the&nbsp;current&nbsp;user.&nbsp;&nbsp;We&nbsp;use&nbsp;serialize()&nbsp;to&nbsp;store<br>//&nbsp;it&nbsp;in&nbsp;a&nbsp;database&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;request.<br><br></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">odbc_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"webdb"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"php"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"chicken"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">odbc_prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"UPDATE&nbsp;sessions&nbsp;SET&nbsp;data&nbsp;=&nbsp;?&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;?"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$sqldata&nbsp;</span><span style="color: #007700">=&nbsp;array&nbsp;(</span><span style="color: #0000BB">serialize</span><span style="color: #007700">(</span><span style="color: #0000BB">$session_data</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'PHP_AUTH_USER'</span><span style="color: #007700">]);<br>if&nbsp;(!</span><span style="color: #0000BB">odbc_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sqldata</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">odbc_prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;sessions&nbsp;(id,&nbsp;data)&nbsp;VALUES(?,&nbsp;?)"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">odbc_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sqldata</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Something&nbsp;went&nbsp;wrong..&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.serialize-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    Note that many built-in PHP objects cannot be serialized. However, those with 
    this ability either implement the <span class="interfacename"><a href="class.serializable.html" class="interfacename">Serializable</a></span> interface or the 
    magic <a href="language.oop5.magic.html#object.sleep" class="link">__sleep()</a> and
    <a href="language.oop5.magic.html#object.wakeup" class="link">__wakeup()</a> methods. If an 
    internal class does not fulfill any of those requirements, it cannot reliably be 
    serialized.
   </p>
   <p class="para">
    There are some historical exceptions to the above rule, where some internal objects 
    could be serialized without implementing the interface or exposing the methods. Notably, 
    the <a href="class.arrayobject.html" class="classname">ArrayObject</a> prior to PHP 5.2.0.
   </p>
  <p></p></blockquote>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">
    When <span class="function"><strong>serialize()</strong></span> serializes objects, the leading slash is not included in the class name of namespaced classes for maximum compatibility.
   </p>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.serialize-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.unserialize.html" class="function" rel="rdfs-seeAlso">unserialize()</a> - Creates a PHP value from a stored representation</span></li>
    <li class="member"><span class="function"><a href="function.var-export.html" class="function" rel="rdfs-seeAlso">var_export()</a> - Outputs or returns a parsable string representation of a variable</span></li>
    <li class="member"><span class="function"><a href="function.json-encode.html" class="function" rel="rdfs-seeAlso">json_encode()</a> - Returns the JSON representation of a value</span></li>
    <li class="member"><a href="language.oop5.serialization.html" class="link">Serializing Objects</a></li>
    <li class="member"><a href="language.oop5.magic.html#object.sleep" class="link">__sleep()</a></li>
    <li class="member"><a href="language.oop5.magic.html#object.wakeup" class="link">__wakeup()</a></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="66147">  
  <a class="name">
  <strong class="user"><em>egingell at sisna dot com</em></strong></a><div class="date" title="2006-05-15 05:12"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom66147">
<div class="phpcode"><code><span class="html">
&lt;?<br>/*<br>Anatomy of a serialize()'ed value:<br><br> String<br> s:size:value;<br><br> Integer<br> i:value;<br><br> Boolean<br> b:value; (does not store "true" or "false", does store '1' or '0')<br><br> Null<br> N;<br><br> Array<br> a:size:{key definition;value definition;(repeated per element)}<br><br> Object<br> O:strlen(object name):object name:object size:{s:strlen(property name):property name:property definition;(repeated per property)}<br><br> String values are always in double quotes<br> Array keys are always integers or strings<br>&nbsp; &nbsp; "null =&gt; 'value'" equates to 's:0:"";s:5:"value";',<br>&nbsp; &nbsp; "true =&gt; 'value'" equates to 'i:1;s:5:"value";',<br>&nbsp; &nbsp; "false =&gt; 'value'" equates to 'i:0;s:5:"value";',<br>&nbsp; &nbsp; "array(whatever the contents) =&gt; 'value'" equates to an "illegal offset type" warning because you can't use an<br>&nbsp; &nbsp; array as a key; however, if you use a variable containing an array as a key, it will equate to 's:5:"Array";s:5:"value";',<br>&nbsp; &nbsp;&nbsp; and<br>&nbsp; &nbsp; attempting to use an object as a key will result in the same behavior as using an array will.<br>*/<br>?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111168">  
  <a class="name">
  <strong class="user"><em>nh at ngin dot de</em></strong></a><div class="date" title="2013-01-21 09:59"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111168">
<div class="phpcode"><code><span class="html">
Serializing floating point numbers leads to weird precision offset errors:<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">echo </span><span class="default">round</span><span class="keyword">(</span><span class="default">96.670000000000002</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br></span><span class="comment">// 96.67<br><br></span><span class="keyword">echo </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">round</span><span class="keyword">(</span><span class="default">96.670000000000002</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">));<br></span><span class="comment">// d:96.670000000000002;<br><br></span><span class="keyword">echo </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">96.67</span><span class="keyword">);<br></span><span class="comment">// d:96.670000000000002;<br><br></span><span class="default">?&gt;<br></span><br>Not only is this wrong, but it adds a lot of unnecessary bulk to serialized data. Probably better to use json_encode() instead (which apparently is faster than serialize(), anyway).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="60317">  
  <a class="name">
  <strong class="user"><em>MC_Gurk at gmx dot net</em></strong></a><div class="date" title="2006-01-03 07:44"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom60317">
<div class="phpcode"><code><span class="html">
If you are going to serialie an object which contains references to other objects you want to serialize some time later, these references will be lost when the object is unserialized.<br>The references can only be kept if all of your objects are serialized at once.<br>That means:<br><br>$a = new ClassA(); <br>$b = new ClassB($a); //$b containes a reference to $a;<br><br>$s1=serialize($a);<br>$s2=serialize($b);<br><br>$a=unserialize($s1);<br>$b=unserialize($s2);<br><br>now b references to an object of ClassA which is not $a. $a is another object of Class A.<br><br>use this:<br>$buf[0]=$a;<br>$buf[1]=$b;<br>$s=serialize($buf);<br>$buf=unserialize($s);<br>$a=$buf[0];<br>$b=$buf[1];<br><br>all references are intact.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113305">  
  <a class="name">
  <strong class="user"><em>frost at easycast dot ru</em></strong></a><div class="date" title="2013-09-23 10:56"><strong>11 months ago</strong></div>
  <div class="text" id="Hcom113305">
<div class="phpcode"><code><span class="html">
Closures cannot be serialized:<br><span class="default">&lt;?php<br>$func </span><span class="keyword">= function () {echo </span><span class="string">'hello!'</span><span class="keyword">;};<br></span><span class="default">$func</span><span class="keyword">(); </span><span class="comment">// prints "hello!"<br><br></span><span class="default">$result </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$func</span><span class="keyword">);&nbsp; </span><span class="comment">// Fatal error: Uncaught exception 'Exception' with message 'Serialization of 'Closure' is not allowed' <br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="48239">  
  <a class="name">
  <strong class="user"><em>wiart at yahoo dot com</em></strong></a><div class="date" title="2004-12-16 03:40"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom48239">
<div class="phpcode"><code><span class="html">
Warning: on 64 bits machines,&nbsp; if you use a long string only composed of numbers as a key in an array and serialize/unserialize it, you can run into problems:<br><br>an example code:<br>$arr["20041001103319"] = 'test';<br>var_dump( $arr);<br>$arr_in_str = serialize($arr);<br>print "Now result is: $arr_in_str&lt;BR /&gt;";<br>$final_arr = unserialize($arr_in_str);<br>print "The final unserialized array:&lt;BR /&gt;";<br>var_dump($final_arr);<br><br>The result:<br>array(1) { [20041001103319]=&gt;&nbsp; string(4) "test" } <br>Now result is: a:1:{i:20041001103319;s:4:"test";}<br>The final unserialized array:<br>array(1) { [683700183]=&gt; string(4) "test" }<br><br>As you can see, the original array :<br>$arr["20041001103319"] = "test"<br><br>after serialize/unserialize is:<br>$arr[683700183] = "test"<br><br>As you can see,&nbsp; the key has changed ...<br><br>Apparently a problem of implicit casting + integer overflow (I posted a PHP bug report: <a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=31117</a>)<br><br>I tested with the latest 4.3.10 compiled on my laptop (32 bits, Mandrake 9.1) --&gt; no such problem. But compiled on AMD 64 bits (Red Hat Taroon), the problem is present.<br><br>Hope this will help some of you to not loose almost a whole day of debugging ;-)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107717">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2012-02-28 07:44"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107717">
<div class="phpcode"><code><span class="html">
Please! please! please! DO NOT serialize data and place it into your database. Serialize can be used that way, but that's missing the point of a relational database and the datatypes inherent in your database engine. Doing this makes data in your database non-portable, difficult to read, and can complicate queries. If you want your application to be portable to other languages, like let's say you find that you want to use Java for some portion of your app that it makes sense to use Java in, serialization will become a pain in the buttocks. You should always be able to query and modify data in the database without using a third party intermediary tool to manipulate data to be inserted. <br><br>I've encountered this too many times in my career, it makes for difficult to maintain code, code with portability issues, and data that is it more difficult to migrate to other RDMS systems, new schema, etc. It also has the added disadvantage of making it messy to search your database based on one of the fields that you've serialized. <br><br>That's not to say serialize() is useless. It's not... A good place to use it may be a cache file that contains the result of a data intensive operation, for instance. There are tons of others... Just don't abuse serialize because the next guy who comes along will have a maintenance or migration nightmare.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="59330">  
  <a class="name">
  <strong class="user"><em>Alexander Podgorny</em></strong></a><div class="date" title="2005-12-02 11:47"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom59330">
<div class="phpcode"><code><span class="html">
Here is an example of a base class to implement object persistence using serialize and unserialize:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">class </span><span class="default">Persistent
<br></span><span class="keyword">{
<br>&nbsp; &nbsp; var </span><span class="default">$filename</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="comment">/**********************/
<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">Persistent</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename </span><span class="keyword">= </span><span class="default">$filename</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename</span><span class="keyword">)) </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">save</span><span class="keyword">();
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="comment">/**********************/
<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">save</span><span class="keyword">()
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$f </span><span class="keyword">= @</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename</span><span class="keyword">,</span><span class="string">"w"</span><span class="keyword">))
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(@</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">,</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">))))
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else die(</span><span class="string">"Could not write to file "</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename</span><span class="keyword">.</span><span class="string">" at Persistant::save"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; else die(</span><span class="string">"Could not open file "</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename</span><span class="keyword">.</span><span class="string">" for writing, at Persistant::save"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="comment">/**********************/
<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">open</span><span class="keyword">()
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$vars </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename</span><span class="keyword">));
<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$vars </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eval(</span><span class="string">"$"</span><span class="keyword">.</span><span class="string">"this-&gt;</span><span class="default">$key</span><span class="string"> = $"</span><span class="keyword">.</span><span class="string">"vars['"</span><span class="keyword">.</span><span class="string">"</span><span class="default">$key</span><span class="string">'];"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="comment">/**********************/
<br></span><span class="keyword">}
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>When an object is extended from this one it can be easily saved and re-opened using it's own methods as follows:
<br>
<br>&lt;?
<br>
<br>class foo extends Persistent
<br>{
<br>&nbsp;&nbsp; var $counter;
<br>&nbsp;&nbsp; function inc()
<br>&nbsp;&nbsp; {
<br>&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;counter++;
<br>&nbsp;&nbsp; }
<br>}
<br>
<br>$fooObj = new $foo;
<br>$foo-&gt;open();
<br>print $foo-&gt;counter; // displays incrementing integer as page reloads
<br>$foo-&gt;inc();
<br>$foo-&gt;save();
<br>
<br>?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109953">  
  <a class="name">
  <strong class="user"><em>Andrew B</em></strong></a><div class="date" title="2012-09-05 09:42"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom109953">
<div class="phpcode"><code><span class="html">
When you serialize an array the internal pointer will not be preserved. Apparently this is the expected behavior but was a bit of a gotcha moment for me. Copy and paste example below.
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">//Internal Pointer will be 2 once variables have been assigned.
<br></span><span class="default">$array </span><span class="keyword">= array();
<br></span><span class="default">$array</span><span class="keyword">[] = </span><span class="default">1</span><span class="keyword">;
<br></span><span class="default">$array</span><span class="keyword">[] = </span><span class="default">2</span><span class="keyword">;
<br></span><span class="default">$array</span><span class="keyword">[] = </span><span class="default">3</span><span class="keyword">;
<br>
<br></span><span class="comment">//Unset variables. Internal pointer will still be at 2.&nbsp; &nbsp;&nbsp; 
<br></span><span class="keyword">unset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);
<br>unset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);
<br>unset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);
<br>
<br></span><span class="comment">//Serialize
<br></span><span class="default">$serializeArray </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);
<br>
<br></span><span class="comment">//Unserialize
<br></span><span class="default">$array </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$serializeArray</span><span class="keyword">);
<br>
<br></span><span class="comment">//Add a new element to the array
<br>//If the internal pointer was preserved, the new array key should be 3.
<br>//Instead the internal pointer has been reset, and the new array key is 0.
<br></span><span class="default">$array</span><span class="keyword">[] = </span><span class="default">4</span><span class="keyword">;
<br>
<br></span><span class="comment">//Expected Key - 3
<br>//Actual Key - 0
<br></span><span class="keyword">echo </span><span class="string">"&lt;pre&gt;" </span><span class="keyword">, </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) , </span><span class="string">"&lt;/pre&gt;"</span><span class="keyword">;
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78994">  
  <a class="name">
  <strong class="user"><em>Jeex</em></strong></a><div class="date" title="2007-11-06 02:59"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78994">
<div class="phpcode"><code><span class="html">
It may be worth noting that, depending on the size of the object you are serializing, the serialize function can take up a lot of memory.<br><br>If your script isn't working as expected, your serialize call may have pushed the memory usage over the limit set by memory_limit in php.ini.<br><br>More info on memory limits here: <a rel="nofollow" target="_blank">http://www.php.net/manual/en/ini.core.php</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="68220">  
  <a class="name">
  <strong class="user"><em>Ates Goral</em></strong></a><div class="date" title="2006-07-18 11:59"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom68220">
<div class="phpcode"><code><span class="html">
Corrections/clarifications to&nbsp; "Anatomy of a serialize()'ed value":<br><br>All strings appear inside quotes. This applies to string values, object class names and array key names. For example:<br><br>s:3:"foo"<br>O:7:"MyClass":1:{...<br>a:2:{s:3:"bar";i:42;...<br><br>Object property names and values are delimited by semi-colons, not colons. For example:<br><br>O:7:"MyClass":2:{s:3:"foo";i:10;s:3:"bar";i:20}<br><br>Double/float values are represented as:<br><br>d:0.23241446</span>
</code></div>
  </div>
 </div>
  <div class="note" id="3918">  
  <a class="name">
  <strong class="user"><em>MarkRoedel at letu dot edu</em></strong></a><div class="date" title="2000-02-21 10:58"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom3918">
<div class="phpcode"><code><span class="html">
A call to serialize() appears to mess with the array's internal pointer.&nbsp; If you're going to be walking through your array after serializing it, you'll want to make a call to reset() first.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102241">  
  <a class="name">
  <strong class="user"><em>pgl at yoyo dot org</em></strong></a><div class="date" title="2011-02-03 09:13"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102241">
<div class="phpcode"><code><span class="html">
Another suggestion for coping with binary data in serialize()d variables is just to base64_encode() those fields before serializing. It will increase the size of the variable, but not by too much.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115159">  
  <a class="name">
  <strong class="user"><em>tuxedobob</em></strong></a><div class="date" title="2014-06-04 04:36"><strong>2 months ago</strong></div>
  <div class="text" id="Hcom115159">
<div class="phpcode"><code><span class="html">
When using serialize() to convert, say, an array to a string to pass via HTML forms, you will likely run into issues with quoting. This is because serialize() puts values in double quotes. The simplest solution is to quote your HTML form value with single quotes rather than double quotes. (This *is* allowed, according to W3C specs.)<br><br>So, instead of:<br><br><span class="default">&lt;?php<br>$arr </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$some_array</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>&lt;input type="hidden" name="array" value="$arr" /&gt;<br><br>you would want to use:<br><br><span class="default">&lt;?php<br>$arr </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$some_array</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>&lt;input type="hidden" name="array" value='$arr' /&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="58356">  
  <a class="name">
  <strong class="user"><em>stephen dot adamson at smius dot com</em></strong></a><div class="date" title="2005-11-01 09:40"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom58356">
<div class="phpcode"><code><span class="html">
If you are serializing an object to store it in the database, using __sleep() can save you some space. The following code will not store empty (null) variables in the serialized string. For my purposes this saved a lot of space, since some of the member variables would not be given values.<br><br>function __sleep()<br>{<br>&nbsp; &nbsp; $allVars = get_object_vars($this);<br>&nbsp; &nbsp; $toReturn = array();<br>&nbsp; &nbsp; foreach(array_keys($allVars) as $name)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; if (isset($this-&gt;$name))<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $toReturn[] = $name;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return $toReturn;<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="47509">  
  <a class="name">
  <strong class="user"><em>paul at moveNOtoSPAMiceland DOT com</em></strong></a><div class="date" title="2004-11-18 08:29"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47509">
<div class="phpcode"><code><span class="html">
I was trying to submit a serialized array through a hidden form field using POST and was having a lot of trouble with the quotes. I couldn't figure out a way to escape the quotes in the string so that they'd show up right inside the form, so only the characters up to the first set of quotes were being sent.<br><br>My solution was to base64_encode() the string, put that in the hidden form field, and send that through the POST method. Then I decoded it (using base64_decode()) on the other end. This seemed to solve the problem.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="41775">  
  <a class="name">
  <strong class="user"><em>hfuecks at phppatterns dot com</em></strong></a><div class="date" title="2004-04-21 08:20"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom41775">
<div class="phpcode"><code><span class="html">
Regarding serializing PHP data types to Javascript, following Ivans note below, theres an example at <a rel="nofollow" target="_blank">http://www.tekool.net/php/js_serializer/.</a><br><br>The basic serialization looks good although, in its current form, it works on the basis of generating Javascript source which a browser executes as a page loads. Using Javascripts eval() the same can be done with strings containing Javascript if youre working with something like XMLHTTPRequest</span>
</code></div>
  </div>
 </div>
  <div class="note" id="29079">  
  <a class="name">
  <strong class="user"><em>pli9 at itsa dot ucsf dot edu</em></strong></a><div class="date" title="2003-01-31 11:05"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom29079">
<div class="phpcode"><code><span class="html">
I have also written some code for importing serialized PHP data into PERL and then writing it back into PHP.&nbsp; I think the similar library posted above is actually more robust for a few select cases, but mine is more compact and a little easier to follow.&nbsp; I'd really like comments if anyone finds this useful or has improvements.&nbsp; Please credit me if you use my code.<br><br><a rel="nofollow" target="_blank">http://www.hcs.harvard.edu/~pli/code/serialPHP.pm</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="96504">  
  <a class="name">
  <strong class="user"><em>travis at travishegner dot com</em></strong></a><div class="date" title="2010-03-02 12:37"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96504">
<div class="phpcode"><code><span class="html">
If serializing objects to be stored into a postgresql database, the 'null byte' injected for private and protected members throws a wrench into the system. Even pg_escape_bytea() on the value, and storing the value as a binary type fails under certain circumstances.
<br>
<br>For a dirty work around:
<br><span class="default">&lt;?php
<br>
<br>$serialized_object </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$my_object</span><span class="keyword">);
<br></span><span class="default">$safe_object </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\0"</span><span class="keyword">, </span><span class="string">"~~NULL_BYTE~~"</span><span class="keyword">, </span><span class="default">$serialized_object</span><span class="keyword">);
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>this allows you to store the object in a readable text format as well. When reading the data back:
<br>
<br><span class="default">&lt;?php
<br>
<br>$serialized_object </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"~~NULL_BYTE~~"</span><span class="keyword">, </span><span class="string">"\0"</span><span class="keyword">, </span><span class="default">$safe_object</span><span class="keyword">);
<br></span><span class="default">$my_object </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$serialized_object</span><span class="keyword">);
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>The only gotcha's with this method is if your object member names or values may somehow contain the odd "~~NULL_BYTE~~" string. If that is the case, then str_replace() to a string that you are guaranteed not to have any where else in the string that serialize() returns.
<br>Also remember to define the class before calling unserialize().
<br>
<br>If you are storing session data into a postgresql database, then this workaround is an absolute must, because the $data passed to the session's write function is already serialized.
<br>
<br>Thanks,
<br>Travis Hegner</span>
</code></div>
  </div>
 </div>
  <div class="note" id="79187">  
  <a class="name">
  <strong class="user"><em>barbuj at NOSPAM dot yahoo dot com</em></strong></a><div class="date" title="2007-11-14 02:19"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom79187">
<div class="phpcode"><code><span class="html">
In my specific situation, I wanted to be able to pass some data from page to page, but without relying on a session variable. The answer I came up with was to serialize() the object in question, pass it on to the next page as a hidden form field, then unserialize() it. When ALL class variables are public, this worked fine. However, if there was at least one private/protected variable, the code no longer worked as expected ("Fatal error: Call to a member function display() on a non-object in page2.php on line 4")<br><br>As others have already mentioned, private/protected class variables will not behave nicely (private variables are prefixed by class_name + &amp;#65533;, while protected variables are only prefixed by &amp;#65533; - when looking at the page source using Firefox). Internet Explorer does NOT display the extra character between the class name and variable name, but the code still doesn't work as one would expect.<br><br>Suppose you have a simple class:<br><br>testclass.php<br>=============<br><span class="default">&lt;?php<br></span><span class="keyword">class </span><span class="default">TestClass </span><span class="keyword">{<br>&nbsp; var </span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br><br>&nbsp; function </span><span class="default">display</span><span class="keyword">() {<br>&nbsp; &nbsp; echo </span><span class="string">"i=" </span><span class="keyword">. </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">i</span><span class="keyword">;<br>&nbsp; }<br></span><span class="default">?&gt;<br></span><br>page1.php<br>=========<br><span class="default">&lt;?php<br>&nbsp; </span><span class="keyword">require_once </span><span class="string">'testclass.php'</span><span class="keyword">;<br>&nbsp; </span><span class="default">$tc </span><span class="keyword">= new </span><span class="default">TestClass</span><span class="keyword">;<br>&nbsp; </span><span class="default">$tc</span><span class="keyword">-&gt;</span><span class="default">display</span><span class="keyword">();<br></span><span class="default">?&gt;<br></span>&lt;form method = "post" action = "page2.php"&gt;<br>&lt;input type = "hidden" name = "str" value = "<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">htmlspecialchars</span><span class="keyword">( </span><span class="default">serialize</span><span class="keyword">( </span><span class="default">$tc </span><span class="keyword">) ); </span><span class="default">?&gt;</span>"&gt;<br>&lt;input type = "submit"&gt;<br>&lt;/form&gt;<br><br>page2.php<br>=========<br><span class="default">&lt;?php<br>&nbsp; </span><span class="keyword">require_once </span><span class="string">'testclass.php'</span><span class="keyword">;<br>&nbsp; </span><span class="default">$tc </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">( </span><span class="default">stripslashes</span><span class="keyword">( </span><span class="default">htmlspecialchars_decode</span><span class="keyword">( </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">"str"</span><span class="keyword">] ) ) );<br>&nbsp; </span><span class="default">$tc</span><span class="keyword">-&gt;</span><span class="default">display</span><span class="keyword">();<br></span><span class="default">?&gt;<br></span><br>The fix, suggested by evulish on #php/irc.dal.net, is to replace htmlspecialchars()/htmlspecialchars_decode() by base64_encode()/base64_decode. The code becomes:<br><br>page1.php<br>=========<br>&lt;input type = "hidden" name = "str" value = "<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">base64_encode</span><span class="keyword">( </span><span class="default">serialize</span><span class="keyword">( </span><span class="default">$tc </span><span class="keyword">) ); </span><span class="default">?&gt;</span>"&gt;<br><br>page2.php<br>=========<br><span class="default">&lt;?php<br>&nbsp; $tc </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">( </span><span class="default">base64_decode</span><span class="keyword">( </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">"str"</span><span class="keyword">] ) );<br></span><span class="default">?&gt;<br></span><br>Hope this will help someone...</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95781">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2010-01-21 09:23"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95781">
<div class="phpcode"><code><span class="html">
you should really use mysql_real_escape_string() for escaping (serialized) strings that got thrown into a query (visit php.net/mysql_real_escape_string for further information)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111602">  
  <a class="name">
  <strong class="user"><em>allan666 at gmail.com</em></strong></a><div class="date" title="2013-03-07 01:28"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111602">
<div class="phpcode"><code><span class="html">
Oddly, if you serialize a class that was previously unserialized, the class of the variable changes to string... Example:<br><br>$R = unserialize($serialized_object);<br>$R-&gt;method(); // this is ok<br>$str = serialize($R);<br>echo(get_class($R));<br><br>this will output "string"!!!!! whereas if the first line was <br><br>$R = new my_class(); <br><br>it would output "my_class"!<br><br>I don't know if that is a bug, but the manual is not clear about that! (somehow $R in serialize($R) is being passed by reference, since it changes class).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="75859">  
  <a class="name">
  <strong class="user"><em>friday13 at ig dot com dot br</em></strong></a><div class="date" title="2007-06-19 07:15"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom75859">
<div class="phpcode"><code><span class="html">
I have problem to use serialize function with hidden form field and the resolution was use htmlentities.<br><br>Ex.:<br><br>&lt;?<br><br>$lista = array( 'pera', 'maÃ§a', 'laranja' );<br><br>print "&lt; input type='hidden' name='teste' value='htmlentities( serialize( $lista ) )'" &gt;";<br><br>?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="93313">  
  <a class="name">
  <strong class="user"><em>donotmail at me dot com</em></strong></a><div class="date" title="2009-09-02 11:16"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom93313">
<div class="phpcode"><code><span class="html">
NOTE: php's serialize does not properly serialize arrays with which a slice of the array is a reference to the array itself, observe:
<br>
<br><span class="default">&lt;?php
<br>$a </span><span class="keyword">= array();
<br></span><span class="default">$a</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"blah"</span><span class="keyword">;
<br></span><span class="default">$a</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] =&amp; </span><span class="default">$a</span><span class="keyword">;
<br>
<br></span><span class="default">$a</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"pleh"</span><span class="keyword">; </span><span class="comment">// $a[0] === "pleh"
<br>
<br></span><span class="default">$b </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">));
<br>
<br></span><span class="comment">// $b[0] == "pleh", $b[1][0] == "pleh"
<br>
<br></span><span class="default">$b</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"blah"</span><span class="keyword">;
<br></span><span class="default">?&gt;
<br></span>
<br>now $b[1][0] == "blah", but $b[0] == "pleh"
<br>after serializing and unserializing, slice 1 is no longer a reference to the array itself... I have found no way around this problem... even manually modifying the serialized string from 
<br>'a:2:{i:0;s:4:"pleh";i:1;a:2:{i:0;s:4:"pleh";i:1;R:3;}}'
<br>to
<br>'a:2:{i:0;s:4:"pleh";i:1;R:1;}'
<br>
<br>to force the second slice to be a reference to the first element of the serialization (the array itself), it seemed to work at first glance, but then unreferences it when you alter it again, observe:
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; $testser </span><span class="keyword">= </span><span class="string">'a:2:{i:0;s:4:"pleh";i:1;R:1;}'</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$testser</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; print </span><span class="string">"\n-----------------------\n"</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"blah"</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">);
<br> 
<br></span><span class="default">?&gt;
<br></span>
<br>outputs:
<br>Array
<br>(
<br>&nbsp; &nbsp; [0] =&gt; pleh
<br>&nbsp; &nbsp; [1] =&gt; Array
<br> *RECURSION*
<br>)
<br>
<br>-----------------------
<br>Array
<br>(
<br>&nbsp; &nbsp; [0] =&gt; pleh
<br>&nbsp; &nbsp; [1] =&gt; Array
<br>&nbsp; &nbsp; &nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; blah
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; Array
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; pleh
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; Array
<br> *RECURSION*
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; )
<br>
<br>)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="92284">  
  <a class="name">
  <strong class="user"><em>Alessandro Segala</em></strong></a><div class="date" title="2009-07-17 08:18"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom92284">
<div class="phpcode"><code><span class="html">
I needed to serialize an array to store it inside a database.<br>I was looking for a fast, simple way to do serialization, and I came out with 2 options: serialize() or json_encode().<br><br>I ran some benchmarks to see which is the faster, and, surprisingly, I found that serialize() is always between 46% and 96% SLOWER than json_encode().<br>So, if you don't need to serialize objects and have the json extension available, consider using it instead of serialize().</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113994">  
  <a class="name">
  <strong class="user"><em>Nanhe Kumar</em></strong></a><div class="date" title="2013-12-27 05:57"><strong>8 months ago</strong></div>
  <div class="text" id="Hcom113994">
<div class="phpcode"><code><span class="html">
Note : You cannot save the state of a static variable by serializing.<br><span class="default">&lt;?php<br></span><span class="comment">/*<br> * student.class.php<br> */<br></span><span class="keyword">class </span><span class="default">Student </span><span class="keyword">{<br><br>&nbsp; &nbsp; public </span><span class="default">$name</span><span class="keyword">;<br>&nbsp; &nbsp; private </span><span class="default">$roll</span><span class="keyword">;<br>&nbsp; &nbsp; protected </span><span class="default">$age</span><span class="keyword">;<br>&nbsp; &nbsp; static </span><span class="default">$class</span><span class="keyword">;<br><br>&nbsp; &nbsp; public function </span><span class="default">__construct</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="string">"Nanhe Kumar"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">roll </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">age </span><span class="keyword">= </span><span class="default">16</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">Student</span><span class="keyword">::</span><span class="default">$class </span><span class="keyword">= </span><span class="string">"10+2"</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>}<br></span><span class="default">?&gt;<br>&lt;?php<br></span><span class="comment">/**<br> * serialize.php<br> */<br></span><span class="keyword">include_once(</span><span class="string">"student.class.php"</span><span class="keyword">);<br><br></span><span class="comment">//Serialize<br></span><span class="default">$so </span><span class="keyword">= new </span><span class="default">Student</span><span class="keyword">();<br></span><span class="default">$serialized </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$so</span><span class="keyword">);<br></span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="string">"test.txt"</span><span class="keyword">, </span><span class="default">$serialized</span><span class="keyword">);<br>echo </span><span class="default">$serialized</span><span class="keyword">; </span><span class="comment">//O:7:"Student":3:{s:4:"name";s:11:"Nanhe Kumar";s:13:"Studentroll";i:1;s:6:"*age";i:16;}<br></span><span class="default">?&gt;<br>&lt;?php<br></span><span class="comment">/**<br> * unserialize.php<br> */<br></span><span class="keyword">include_once(</span><span class="string">"student.class.php"</span><span class="keyword">);<br></span><span class="default">$content </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"test.txt"</span><span class="keyword">);<br></span><span class="default">$unserialized </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">);<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$unserialized</span><span class="keyword">);</span><span class="comment">//Student Object ( [name] =&gt; Nanhe Kumar [roll:Student:private] =&gt; 1 [age:protected] =&gt; 16 ) <br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.serialize.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:06:39 GMT -->


</body></html>