<html><!-- Mirrored from php.net/manual/en/function.finfo-open.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:19:12 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>finfo_open</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.finfo-open.html">
 <link rel="shorturl" href="http://php.net/finfo-open">
 <link rel="alternate" href="http://php.net/finfo-open" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.fileinfo.html">
 <link rel="prev" href="function.finfo-file.html">
 <link rel="next" href="function.finfo-set-flags.html">

 <link rel="alternate" href="function.finfo-open.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.finfo-open.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.finfo-open.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.finfo-open.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.finfo-open.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.finfo-open.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.finfo-open.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.finfo-open.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.finfo-open.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.finfo-open.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.finfo-open.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.fileprocess.file.html">File System Related Extensions</a></li>      <li><a href="book.fileinfo.html">Fileinfo</a></li>      <li><a href="ref.fileinfo.html">Fileinfo Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.finfo-open" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">finfo_open</h1>
  <h1 class="refname">finfo::__construct</h1>
  <p class="verinfo">(PHP &gt;= 5.3.0, PECL fileinfo &gt;= 0.1.0)</p><p class="refpurpose"><span class="refname">finfo_open</span> -- <span class="refname">finfo::__construct</span> â€” <span class="dc-title">Create a new fileinfo resource</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.finfo-open-description">
  <h3 class="title">Description</h3>
  <p class="para">Procedural style</p>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>finfo_open</strong></span>
    ([ <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code><span class="initializer"> = FILEINFO_NONE</span></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$magic_file</code><span class="initializer"> = <strong><code>NULL</code></strong></span></span>
  ]] )</div>

  <p class="para rdfs-comment">Object oriented style (constructor):</p>
  <div class="constructorsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><strong>finfo::__construct</strong></span>
    ([ <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code><span class="initializer"> = FILEINFO_NONE</span></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$magic_file</code><span class="initializer"> = <strong><code>NULL</code></strong></span></span>
  ]] )</div>

  <p class="para rdfs-comment">
   This function opens a magic database and returns its resource.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.finfo-open-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       One or disjunction of more <a href="fileinfo.constants.html" class="link">Fileinfo
       constants</a>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">magic_file</code></dt>

     <dd>

      <p class="para">
       Name of a magic database file, usually something like
       <var class="filename">/path/to/magic.mime</var>. If not specified, the
       <em>MAGIC</em> environment variable is used. If the
       environment variable isn't set, then PHP's bundled magic database will
       be used.
      </p>
      <p class="para">
       Passing <strong><code>NULL</code></strong> or an empty string will be equivalent to the default
       value.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.finfo-open-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   (Procedural style only)
   Returns a magic database resource on success or <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.finfo-open-notes">
  <h3 class="title">Notes</h3>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">
    The expected magic database format changed in PHP 5.3.11 and 5.4.1.
    Due to this, the internal magic database was upgraded. This mostly effects
    code where an external magic database is used: reading an older magic file
    will now fail.
    
    Also, some textual representations of the mime types has changed, for
    instance for PHP would be "PHP script, ASCII text" instead of "PHP script
    text" returned.
   </p>
  </div>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    Generally, using the bundled magic database (by leaving
    <code class="parameter">magic_file</code> and the <em>MAGIC</em>
    environment variables unset) is the best course of action unless you
    specifically need a custom magic database.
   </p>
  <p></p></blockquote>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.finfo-open-examples">
  <h3 class="title">Examples</h3>
  <div class="example" id="example-2439">
   <p><strong>Example #1 Object oriented style</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$finfo&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">finfo</span><span style="color: #007700">(</span><span style="color: #0000BB">FILEINFO_MIME</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"/usr/share/misc/magic"</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;return&nbsp;mime&nbsp;type&nbsp;ala&nbsp;mimetype&nbsp;extension<br><br>/*&nbsp;get&nbsp;mime-type&nbsp;for&nbsp;a&nbsp;specific&nbsp;file&nbsp;*/<br></span><span style="color: #0000BB">$filename&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"/usr/local/something.txt"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #0000BB">$finfo</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">file</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
  </div>

  </div>
  <div class="example" id="example-2440">
   <p><strong>Example #2 Procedural style</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$finfo&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">finfo_open</span><span style="color: #007700">(</span><span style="color: #0000BB">FILEINFO_MIME</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"/usr/share/misc/magic"</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;return&nbsp;mime&nbsp;type&nbsp;ala&nbsp;mimetype&nbsp;extension<br><br></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">$finfo</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Opening&nbsp;fileinfo&nbsp;database&nbsp;failed"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;exit();<br>}<br><br></span><span style="color: #FF8000">/*&nbsp;get&nbsp;mime-type&nbsp;for&nbsp;a&nbsp;specific&nbsp;file&nbsp;*/<br></span><span style="color: #0000BB">$filename&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"/usr/local/something.txt"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #0000BB">finfo_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$finfo</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$filename</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;close&nbsp;connection&nbsp;*/<br></span><span style="color: #0000BB">finfo_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$finfo</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  <p class="para">The above example will output:</p>
  <div class="example-contents screen">
<div class="cdata"><pre>text/plain; charset=us-ascii
</pre></div>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.finfo-open-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.finfo-close.html" class="function" rel="rdfs-seeAlso">finfo_close()</a> - Close fileinfo resource</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="107383">  
  <a class="name">
  <strong class="user"><em>illusivefingers at gmail dot com</em></strong></a><div class="date" title="2012-02-06 12:53"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107383">
<div class="phpcode"><code><span class="html">
I am running Windows 7 with Apache.&nbsp; It took hours to figure out why it was not working.<br><br>First, enable the php_fileinfo.dll extension in you php.ini. You'll also need the four magic files that are found in the following library:<br><br><a rel="nofollow" target="_blank">http://sourceforge.net/projects/gnuwin32/files/file/4.23/file-4.23-bin.zip/download</a><br><br>An environment variable or a direct path to the file named "magic" is necessary, without any extension.&nbsp; <br><br>Then, make sure that xdebug is either turned off or set the ini error_reporting to not display notices or warnings for the script.<br><br>Hope this saves someone a few hours of frustration!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86897">  
  <a class="name">
  <strong class="user"><em>mark at dynom dot nl</em></strong></a><div class="date" title="2008-11-09 12:34"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom86897">
<div class="phpcode"><code><span class="html">
It seems there is quite some inconsistency in distributions and loading of magic files.<br><br>On Archlinux, the file is located here:<br>/usr/share/misc/file/magic.mgc<br><br>But this:<br><br><span class="default">&lt;?php<br>$fi </span><span class="keyword">= new </span><span class="default">finfo</span><span class="keyword">(</span><span class="default">FILEINFO_MIME</span><span class="keyword">, </span><span class="string">'/usr/share/misc/file/magic'</span><span class="keyword">);<br></span><span class="default">$fi</span><span class="keyword">-&gt;</span><span class="default">file</span><span class="keyword">(</span><span class="string">'/tmp/fubar.txt'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Actually segfaults, where if I type the full name (including the file extension:)<br><br><span class="default">&lt;?php<br>$fi </span><span class="keyword">= new </span><span class="default">finfo</span><span class="keyword">(</span><span class="default">FILEINFO_MIME</span><span class="keyword">, </span><span class="string">'/usr/share/misc/file/magic.mgc'</span><span class="keyword">); </span><span class="comment">// added ".mgc"<br></span><span class="default">$fi</span><span class="keyword">-&gt;</span><span class="default">file</span><span class="keyword">(</span><span class="string">'/tmp/fubar.txt'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>It works as expected, so I guess something goes wrong with "A .mime and/or .mgc suffix is added if needed."</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102840">  
  <a class="name">
  <strong class="user"><em>olivier dot berger at it-sudparis dot eu</em></strong></a><div class="date" title="2011-03-09 12:02"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102840">
<div class="phpcode"><code><span class="html">
On my Debian squeeze system, the path needed is like :<br><span class="default">&lt;?php <br> $finfo </span><span class="keyword">= new </span><span class="default">finfo</span><span class="keyword">(</span><span class="default">FILEINFO_MIME</span><span class="keyword">, </span><span class="string">"/usr/share/misc/magic.mgc"</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78927">  
  <a class="name">
  <strong class="user"><em>ian at createanet dot co dot uk</em></strong></a><div class="date" title="2007-11-02 08:50"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78927">
<div class="phpcode"><code><span class="html">
Couldn't get finfo to return the mimetype in the way expected so i made a function to do it with system()<br><br><span class="default">&lt;?php <br></span><span class="keyword">function </span><span class="default">get_mime_type</span><span class="keyword">(</span><span class="default">$filepath</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">ob_start</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">system</span><span class="keyword">(</span><span class="string">"file -i -b </span><span class="keyword">{</span><span class="default">$filepath</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="default">ob_get_clean</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"; "</span><span class="keyword">,</span><span class="default">$output</span><span class="keyword">);<br>&nbsp; &nbsp; if ( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">) ) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="default">$output</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$output</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>hope it works for other people too</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112617">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2013-07-04 07:41"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112617">
<div class="phpcode"><code><span class="html">
For most common image files:<br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">minimime</span><span class="keyword">(</span><span class="default">$fname</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$fh</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$fname</span><span class="keyword">,</span><span class="string">'rb'</span><span class="keyword">);<br>&nbsp; &nbsp; if (</span><span class="default">$fh</span><span class="keyword">) { <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$bytes6</span><span class="keyword">=</span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">); <br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$bytes6</span><span class="keyword">===</span><span class="default">false</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bytes6</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">)==</span><span class="string">"\xff\xd8\xff"</span><span class="keyword">) return </span><span class="string">'image/jpeg'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$bytes6</span><span class="keyword">==</span><span class="string">"\x89PNG\x0d\x0a"</span><span class="keyword">) return </span><span class="string">'image/png'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$bytes6</span><span class="keyword">==</span><span class="string">"GIF87a" </span><span class="keyword">|| </span><span class="default">$bytes6</span><span class="keyword">==</span><span class="string">"GIF89a"</span><span class="keyword">) return </span><span class="string">'image/gif'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="string">'application/octet-stream'</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97829">  
  <a class="name">
  <strong class="user"><em>franssen dot roland at gmail dot com</em></strong></a><div class="date" title="2010-05-11 12:23"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97829">
<div class="phpcode"><code><span class="html">
Notice FileInfo::__construct() has strange behavior in PHP &lt; 5.3.1 when a 2nd parameter is set explicitly, e.g.;<br><br><span class="default">&lt;?php<br>$fileInfo </span><span class="keyword">= new </span><span class="default">finfo</span><span class="keyword">(</span><span class="default">FILEINFO_MIME</span><span class="keyword">, </span><span class="default">null</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Expected result:<br>----------------<br>object(finfo)#2 (0) { }<br><br>Actual result:<br>--------------<br>Warning: finfo::finfo(): Failed to load magic database at ''. in *** on line ***<br>object(finfo)#2 (0) { }<br><br>See <a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=51732</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="85732">  
  <a class="name">
  <strong class="user"><em>php at brudaswen dot de</em></strong></a><div class="date" title="2008-09-15 03:13"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom85732">
<div class="phpcode"><code><span class="html">
Since it costed me some time to find the needed magic database files for Windows, just a hint:<br><br>The last release of the GnuWin32 project with both needed files (magic and magic.mime) currently was "file-4.23".<br>All releases after 4.23 to 4.25-1 did not contain both needed files.<br><br>Hope that helps.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82551">  
  <a class="name">
  <strong class="user"><em>dario dot borreguero at gmail dot com</em></strong></a><div class="date" title="2008-04-16 03:15"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82551">
<div class="phpcode"><code><span class="html">
Platform: WinXP-SP2, PHP5.2.5, MySQL 5.0, Apache 2.2.8<br><br>After reading former notes, I wasn't able to load my magic database: 'magic.mime' file (donwloaded from GnuWin32 project, zipped with the binary files v4.21). I always got an invalid $finfo object or finfo_open(...) returned FALSE.<br><br>In order to be able to load the 'magic.mime' file, Fileinfo library (bundled in PHP5.2.5) also requires 'magic' file.<br><br>For example:<br>1. Database:<br>&nbsp; c:\php\magic.mime<br>&nbsp; c:\php\magic<br><br>2. PHP Code:<br><span class="default">&lt;?php<br>&nbsp; $filname </span><span class="keyword">= </span><span class="string">'c:\php\php.ini'</span><span class="keyword">;<br>&nbsp; </span><span class="default">$finfo </span><span class="keyword">= new </span><span class="default">finfo</span><span class="keyword">(</span><span class="default">FILEINFO_MIME</span><span class="keyword">, </span><span class="string">'c:\php\magic'</span><span class="keyword">);<br>&nbsp; if (!</span><span class="default">$finfo</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; echo </span><span class="default">$finfo</span><span class="keyword">-&gt;</span><span class="default">file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>For further info see: <a rel="nofollow" target="_blank">http://pecl.php.net/bugs/bug.php?id=7555</a><br><br>Pay attention to comments added by 'christophe dot charron dot xul at gmail dot com'<br><br>NOTE: Before upgrading to PHP5.2.5, I was working with PHP5.2.1 and it only required 'magic.mime' file.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="80583">  
  <a class="name">
  <strong class="user"><em>php at kingsquare dot nl</em></strong></a><div class="date" title="2008-01-23 07:41"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80583">
<div class="phpcode"><code><span class="html">
The current version (1.04) doesnt support a different mime.magic database than the server default.<br><br>(the documentation is thus not correct)<br>Ubuntu default location is '/usr/share/file/magic'. In order for the examples to work all finfo_open()-commands must be issued with the extra location accordingly:<br><span class="default">&lt;?php<br>$file </span><span class="keyword">= </span><span class="string">"/path/to/file.jpg"</span><span class="keyword">;<br></span><span class="default">$handle </span><span class="keyword">= </span><span class="default">finfo_open</span><span class="keyword">(</span><span class="default">FILEINFO_MIME</span><span class="keyword">, </span><span class="string">'/usr/share/file/magic'</span><span class="keyword">);<br></span><span class="default">$mime_type </span><span class="keyword">= </span><span class="default">finfo_file</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">,</span><span class="default">$file</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74965">  
  <a class="name">
  <strong class="user"><em>tularis at php dot net</em></strong></a><div class="date" title="2007-05-06 12:55"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74965">
<div class="phpcode"><code><span class="html">
On Windows systems people might find that this always returns "application/x-dpkg".<br>There are 2 ways of solving this problem:<br>1. Get the mime-magic database file from GnuWin32 at &lt;<a rel="nofollow" target="_blank">http://sourceforge.net/projects/gnuwin32/&gt;</a><br>2. You can manually "fix" the mime-magic file by editing it and escaping all lines starting with !, thus changing each one to \!</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.finfo-open.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:19:12 GMT -->


</body></html>