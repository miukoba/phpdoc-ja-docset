<html><!-- Mirrored from php.net/manual/en/class.com.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:52:21 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>COM</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="class.com.html">
 <link rel="shorturl" href="http://php.net/com">
 <link rel="alternate" href="http://php.net/com" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="book.com.html">
 <link rel="prev" href="com.examples.arrays.html">
 <link rel="next" href="class.dotnet.html">

 <link rel="alternate" href="class.com.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/class.com.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/class.com.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/class.com.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/class.com.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/class.com.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/class.com.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/class.com.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/class.com.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/class.com.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/class.com.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.utilspec.windows.html">Windows Only Extensions</a></li>      <li><a href="book.com.html">COM</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="class.com" class="reference">
 
 <h1 class="title">The COM class</h1>
 <div class="partintro"><p class="verinfo">(PHP 4 &gt;= 4.1.0, PHP 5)</p>

 <div class="section" id="class.com.class">
  <h2 class="title">Description</h2>
  <p class="simpara">
   The COM class allows you to instantiate an OLE compatible COM object and
   call its methods and access its properties.
  </p>
  <p class="simpara">
   <em>$obj = new COM("Application.ID")</em>
  </p>
 </div>
 <div class="section" id="com.com">
  <h2 class="title">Methods</h2>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>COM::COM</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$module_name</code></span>
   [, <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$server_name</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$codepage</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$typelib</code></span>
  ]]] )</div>

  <p class="para">
   COM class constructor. The parameters have the following meanings:
   </p><dl>

    
     <dt>
module_name</dt>

     <dd>

      <span class="simpara">
       Can be a ProgID, Class ID or Moniker that names the component to load.
      </span>
      <span class="simpara">
       A ProgID is typically the application or DLL name, followed by a period,
       followed by the object name. e.g: <em>Word.Application</em>.
      </span>
      <span class="simpara">
       A Class ID is the UUID that uniquely identifies a given class.
      </span>
      <span class="simpara">
       A Moniker is a special form of naming, similar in concept to a URL
       scheme, that identifies a resource and specifies how it should be
       loaded.  As an example, you could load up Word and get an object
       representing a word document by specifying the full path to the word
       document as the module name, or you can use <em>LDAP:</em> as
       a moniker to use the ADSI interface to LDAP.
      </span>
     </dd>

    
    
     <dt>
server_name</dt>

     <dd>

      <span class="simpara">
       The name of the DCOM server on which the component should be loaded and
       run.  If <strong><code>NULL</code></strong>, the object is run using the default for the
       application.  The default is typically to run it on the local machine,
       although the administrator might have configured the application to
       launch on a different machine.
      </span>
      <span class="simpara">
       If you specify a non-<strong><code>NULL</code></strong> value for server, PHP will refuse to load
       the object unless the <a href="com.configuration.html#ini.com.allow-dcom" class="xref"></a> configuration option
       is set to <strong><code>TRUE</code></strong>.
      </span>
      <p class="para">
       If <code class="parameter">server_name</code> is an array, it should contain the
       following elements (case sensitive!).  Note that they are all optional
       (although you need to specify both Username and Password together); if
       you omit the Server setting, the default server will be used (as
       mentioned above), and the instantiation of the object will not be
       affected by the <a href="com.configuration.html#ini.com.allow-dcom" class="xref"></a>
       directive.
       </p><table class="doctable table">
        <caption><strong>DCOM server name</strong></caption>
        
         <thead>
          <tr>
           <th><code class="parameter">server_name</code> key</th>
           <th>type</th>
           <th>description</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td>Server</td>
           <td>string</td>
           <td>The name of the server.</td>
          </tr>

          <tr>
           <td>Username</td>
           <td>string</td>
           <td>The username to connect as.</td>
          </tr>

          <tr>
           <td>Password</td>
           <td>string</td>
           <td>The password for <code class="parameter">Username</code>.</td>
          </tr>

          <tr>
           <td>Flags</td>
           <td>integer</td>
           <td>One or more of the following constants, logically OR'd together:
            <strong><code>CLSCTX_INPROC_SERVER</code></strong>,
            <strong><code>CLSCTX_INPROC_HANDLER</code></strong>,
            <strong><code>CLSCTX_LOCAL_SERVER</code></strong>,
            <strong><code>CLSCTX_REMOTE_SERVER</code></strong>,
            <strong><code>CLSCTX_SERVER</code></strong> and
            <strong><code>CLSCTX_ALL</code></strong>.  The default value if not
            specified here is <strong><code>CLSCTX_SERVER</code></strong> if you also
            omit <code class="parameter">Server</code>, or
            <strong><code>CLSCTX_REMOTE_SERVER</code></strong> if you do specify a
            server.  You should consult the Microsoft documentation for
            CoCreateInstance for more information on the meaning of these
            constants; you will typically never have to use them.
           </td>
          </tr>

         </tbody>
        
       </table>

      <p></p>
     </dd>

    
    
     <dt>
codepage</dt>

     <dd>

      <span class="simpara">
       Specifies the codepage that is used to convert strings to
       unicode-strings and vice versa.  The conversion is applied whenever a
       PHP string is passed as a parameter or returned from a method of this
       COM object.  The code page is sticky in PHP 5, which means that it will
       propagate to objects and variants returned from the object.
      </span>
      <span class="simpara">
       Possible values are
       <strong><code>CP_ACP</code></strong> (use system default ANSI code page - the
       default if this parameter is omitted),
       <strong><code>CP_MACCP</code></strong>,
       <strong><code>CP_OEMCP</code></strong>, <strong><code>CP_SYMBOL</code></strong>,
       <strong><code>CP_THREAD_ACP</code></strong> (use codepage/locale set for the
       current executing thread), <strong><code>CP_UTF7</code></strong>
       and <strong><code>CP_UTF8</code></strong>.  You may also use the number for a
       given codepage; consult the Microsoft documentation for more details on
       codepages and their numeric values.
      </span>
     </dd>

    
   </dl>

  <p></p>
 </div>

 <div class="section" id="class.com.overloadedmethods">
  <h2 class="title">Overloaded Methods</h2>
  <p class="para">
   The returned object is an overloaded object, which means that PHP does
   not see any fixed methods as it does with regular classes; instead, any
   property or method accesses are passed through to COM.
  </p>
  <p class="para">
   Starting with PHP 5, PHP will automatically detect methods that accept
   parameters by reference, and will automatically convert regular PHP
   variables to a form that can be passed by reference.  This means that you
   can call the method very naturally; you needn't go to any extra effort in
   your code.
  </p>
  <p class="para">
   In PHP 4, to pass parameters by reference you need to create an instance
   of the <a href="class.variant.html" class="xref">VARIANT</a> class to wrap the
   byref parameters.
  </p>
 </div>

 <div class="section" id="class.com.falsemethods">
  <h2 class="title">Pseudo Methods</h2>
  <p class="para">
   In PHP versions prior to 5, a number of not very pleasant hacks meant that
   the following method names were not passed through to COM and were handled
   directly by PHP.  PHP 5 eliminates these things; read the details below to
   determine how to fix your scripts.  These magic method names are case
   insensitive.
  </p>
  <div class="methodsynopsis dc-description" id="com.addref">
   <span class="type"><span class="type void">void</span></span> <span class="methodname"><strong>COM::AddRef</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   Artificially adds a reference count to the COM object.
  </p>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="simpara">
    You should never need to use this method. It exists as a logical complement
    to the Release() method below.
   </p>
  </div>
  <div class="methodsynopsis dc-description" id="com.release">
   <span class="type"><span class="type void">void</span></span> <span class="methodname"><strong>COM::Release</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   Artificially removes a reference count from the COM object.
  </p>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="simpara">
    You should never need to use this method.  Its existence in PHP is a bug
    designed to work around a bug that keeps COM objects running longer than
    they should.
   </p>
  </div>
 </div>
 <div class="section" id="class.com.iteratormethods">
  <h2 class="title">Pseudo Methods for Iterating</h2>
  <p class="para">
   These pseudo methods are only available if
   <span class="function"><strong>com_isenum()</strong></span> returns <strong><code>TRUE</code></strong>, in which case, they hide
   any methods with the same names that might otherwise be provided by the
   COM object.  These methods have all been eliminated in PHP 5, and you
   should use <a href="com.examples.foreach.html" class="xref">For Each</a> instead.
  </p>
  <div class="methodsynopsis dc-description" id="com.all">
   <span class="type"><a href="class.variant.html" class="type variant">variant</a></span> <span class="methodname"><strong>COM::All</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   Returns a variant representing a SafeArray that has 10 elements;
   each element will be an empty/null variant.  This function was supposed to
   return an array containing all the elements from the iterator, but was
   never completed.  Do not use.
  </p>
  <div class="methodsynopsis dc-description" id="com.next">
   <span class="type"><a href="class.variant.html" class="type variant">variant</a></span> <span class="methodname"><strong>COM::Next</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   Returns a variant representing the next element available from
   the iterator, or <strong><code>FALSE</code></strong> when there are no more elements.
  </p>
  <div class="methodsynopsis dc-description" id="com.prev">
   <span class="type"><a href="class.variant.html" class="type variant">variant</a></span> <span class="methodname"><strong>COM::Prev</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">Returns a variant representing the previous element available from
   the iterator, or <strong><code>FALSE</code></strong> when there are no more elements.
  </p>
  <div class="methodsynopsis dc-description" id="com.reset">
   <span class="type"><span class="type void">void</span></span> <span class="methodname"><strong>COM::Reset</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   Rewinds the iterator back to the start.
  </p>
 </div>
 <div class="section" id="class.com.examples">
  <h2 class="title">COM examples</h2>
  <p class="para">
   </p><div class="example" id="example.com1">
    <p><strong>Example #1 COM example (1)</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;starting&nbsp;word<br></span><span style="color: #0000BB">$word&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">COM</span><span style="color: #007700">(</span><span style="color: #DD0000">"word.application"</span><span style="color: #007700">)&nbsp;or&nbsp;die(</span><span style="color: #DD0000">"Unable&nbsp;to&nbsp;instantiate&nbsp;Word"</span><span style="color: #007700">);<br>echo&nbsp;</span><span style="color: #DD0000">"Loaded&nbsp;Word,&nbsp;version&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Version</span><span style="color: #007700">}</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//bring&nbsp;it&nbsp;to&nbsp;front<br></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Visible&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//open&nbsp;an&nbsp;empty&nbsp;document<br></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Documents</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Add</span><span style="color: #007700">();<br><br></span><span style="color: #FF8000">//do&nbsp;some&nbsp;weird&nbsp;stuff<br></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Selection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">TypeText</span><span style="color: #007700">(</span><span style="color: #DD0000">"This&nbsp;is&nbsp;a&nbsp;test..."</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Documents</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">SaveAs</span><span style="color: #007700">(</span><span style="color: #DD0000">"Useless&nbsp;test.doc"</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//closing&nbsp;word<br></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Quit</span><span style="color: #007700">();<br><br></span><span style="color: #FF8000">//free&nbsp;the&nbsp;object<br></span><span style="color: #0000BB">$word&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example.com2">
    <p><strong>Example #2 COM example (2)</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$conn&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">COM</span><span style="color: #007700">(</span><span style="color: #DD0000">"ADODB.Connection"</span><span style="color: #007700">)&nbsp;or&nbsp;die(</span><span style="color: #DD0000">"Cannot&nbsp;start&nbsp;ADO"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Open</span><span style="color: #007700">(</span><span style="color: #DD0000">"Provider=SQLOLEDB;&nbsp;Data&nbsp;Source=localhost;<br>Initial&nbsp;Catalog=database;&nbsp;User&nbsp;ID=user;&nbsp;Password=password"</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$rs&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Execute</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;*&nbsp;FROM&nbsp;sometable"</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Recordset<br><br></span><span style="color: #0000BB">$num_columns&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Fields</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Count</span><span style="color: #007700">();<br>echo&nbsp;</span><span style="color: #0000BB">$num_columns&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br><br>for&nbsp;(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">$num_columns</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$fld</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Fields</span><span style="color: #007700">(</span><span style="color: #0000BB">$i</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #0000BB">$rowcount&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br>while&nbsp;(!</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">EOF</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">$num_columns</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$fld</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">value&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\t"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$rowcount</span><span style="color: #007700">++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;increments&nbsp;rowcount<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">MoveNext</span><span style="color: #007700">();<br>}<br><br></span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Close</span><span style="color: #007700">();<br></span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Close</span><span style="color: #007700">();<br><br></span><span style="color: #0000BB">$rs&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>

 </div>
</div>

<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="90814">  
  <a class="name">
  <strong class="user"><em>tsintra at humansoft dot pt</em></strong></a><div class="date" title="2009-05-11 08:18"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90814">
<div class="phpcode"><code><span class="html">
After one week of trying to understand what was wrong with my PHP communication with MS Word, i finally got it working...<br>It seems that if you're running IIS, the COM object are invoked with restricted privileges.<br>If you're having permission problems like not being able to opening or saving a document and you're getting errors like:<br><br> - This command is not available because no document is open<br>or<br> - Command failed<br><br>try this (if you're running IIS):<br><br>- Execute "dcomcnfg"<br>- Open Component Services &gt; Computers &gt; My Computer &gt; DCOM Config<br>- Search for Microsoft Office Word 97-2003 Document (it will be something like this translated to your language, so take a while and search for it)<br>- Right-Click on it and open the properties<br>- Choose "Identity" tab<br>- Normally this is set to "the launching user". You have to change this to "the interactive user" or a admin user of your choice.<br>- Apply these new settings and test your COM application. It should work fine now.<br><br>I hope I save lots and lots of hours of headaches to some of you :)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106337">  
  <a class="name">
  <strong class="user"><em>rogier</em></strong></a><div class="date" title="2011-10-28 10:09"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom106337">
<div class="phpcode"><code><span class="html">
Took me a while to figure this out by trial and error:<br><br>If your frustrated when getting a com-exception like "Error [0x80004002] ..." (with a message nagging you about an unsupported interface), and you're calling a class method through COM that expects a char as an argument, you should NOT call the method with a single-character string.<br><br>The correct way of calling a method like this is to use a VARIANT with a type of VT_UI1.<br><br>COM enabled method definition: <br><br>public bool DoSomething(char arg);<br><br><span class="default">&lt;?php<br><br>$com </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'Some.Class.Name'</span><span class="keyword">);<br><br></span><span class="comment">// This will fail<br></span><span class="default">$var </span><span class="keyword">= </span><span class="string">'a'</span><span class="keyword">;<br></span><span class="default">$com</span><span class="keyword">-&gt;</span><span class="default">DoSomething</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">);<br><br></span><span class="comment">// This works correctly<br></span><span class="default">$var </span><span class="keyword">= new </span><span class="default">VARIANT</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="string">'a'</span><span class="keyword">), </span><span class="default">VT_UI1</span><span class="keyword">);<br></span><span class="default">$com</span><span class="keyword">-&gt;</span><span class="default">DoSomething</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>I hope this helps some people</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114365">  
  <a class="name">
  <strong class="user"><em>Eion Robb</em></strong></a><div class="date" title="2014-02-12 09:59"><strong>6 months ago</strong></div>
  <div class="text" id="Hcom114365">
<div class="phpcode"><code><span class="html">
All the examples here show<br><span class="default">&lt;?php $var </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'Whatever.Something'</span><span class="keyword">) or die(); </span><span class="default">?&gt;<br></span>however the 'or die()' bit is redundant as a fatal 'com_exception' exception will be thrown, killing your script.&nbsp; If you want to handle the 'or' condition you need to catch the exception, eg<br><span class="default">&lt;?php<br></span><span class="keyword">try {<br></span><span class="default">$var </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'Whatever.Something'</span><span class="keyword">);<br>} catch (</span><span class="default">com_exception $e</span><span class="keyword">) {<br> </span><span class="comment">//couldn't load, do something else like register<br></span><span class="default">exec</span><span class="keyword">(</span><span class="string">'regsvr32 /s whatever.dll'</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="93737">  
  <a class="name">
  <strong class="user"><em>z3n at overflow dot biz</em></strong></a><div class="date" title="2009-09-24 08:35"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom93737">
<div class="phpcode"><code><span class="html">
On a query reply using ADODB.Connection object, all my $rs-&gt;Fields['field_name']-&gt;Value returned `variable Object` when inserted into a array, like this:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">for (</span><span class="default">$rl</span><span class="keyword">[</span><span class="default">$v</span><span class="keyword">]=array(),</span><span class="default">_qm</span><span class="keyword">(</span><span class="default">$_query</span><span class="keyword">);!</span><span class="default">$res</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">;</span><span class="default">$res</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">()) {
<br>&nbsp; &nbsp; </span><span class="default">$rl</span><span class="keyword">[</span><span class="default">$v</span><span class="keyword">][]=</span><span class="default">$res</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">]-&gt;</span><span class="default">Value</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>I figured out that converting the value into a INT fixed the issue:
<br>
<br><span class="default">&lt;?php $rl</span><span class="keyword">[</span><span class="default">$v</span><span class="keyword">][]=</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">]-&gt;</span><span class="default">Value</span><span class="keyword">); </span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="61232">  
  <a class="name">
  <strong class="user"><em>paul at completewebservices dot com dot au</em></strong></a><div class="date" title="2006-01-28 03:49"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom61232">
<div class="phpcode"><code><span class="html">
It seems that PHP does not support setting of properties with arguments.&nbsp; This is how I got around the problem:<br><br>&nbsp; &nbsp; &nbsp; &nbsp; // Object with method I want to set<br>&nbsp; &nbsp; &nbsp; &nbsp; $auth = new COM("AUTHXOCX.AuthXOCXCtrl.1");<br><br>&nbsp; &nbsp; &nbsp; &nbsp; // ScriptControl <br>&nbsp; &nbsp; &nbsp; &nbsp; $oScript = new COM("MSScriptControl.ScriptControl");<br>&nbsp; &nbsp; &nbsp; &nbsp; $oScript-&gt;Language = "VBScript";<br>&nbsp; &nbsp; &nbsp; &nbsp; $oScript-&gt;AllowUI = TRUE;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; // Add out object to the control<br>&nbsp; &nbsp; &nbsp; &nbsp; $oScript-&gt;AddObject('auth', $auth, true);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; // Create a VBScript function that allow me to set them<br>&nbsp; &nbsp; &nbsp;&nbsp; $oScript-&gt;AddCode(<br>'Function fixAccess(accessname)<br>&nbsp; &nbsp; auth.AuthDataReferrerEnabled(accessname) = 1<br>&nbsp; &nbsp; auth.AuthDataAuthentiXDBEnabled(accessname) = 0<br>End Function');<br><br>&nbsp; &nbsp; &nbsp; &nbsp; // Execute function<br>&nbsp; &nbsp; &nbsp; &nbsp; $oScript-&gt;Run("fixAccess", $dir);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83698">  
  <a class="name">
  <strong class="user"><em>mbirth at webwriters dot de</em></strong></a><div class="date" title="2008-06-08 03:19"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83698">
<div class="phpcode"><code><span class="html">
Using the DynamicWrapper from <a rel="nofollow" target="_blank">http://freenet-homepage.de/gborn/WSHBazaar/WSHDynaCall.htm</a> and after registering it via "regsvr32 dynwrap.dll", you can easily set output colors to make colorful CLI scripts even on Windows.<br><br><span class="default">&lt;?php<br><br>$dw </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'DynamicWrapper'</span><span class="keyword">);&nbsp; </span><span class="comment">// needs dynwrap.dll (regsvr32 dynwrap.dll)<br><br>// register needed features<br></span><span class="default">$dw</span><span class="keyword">-&gt;</span><span class="default">Register</span><span class="keyword">(</span><span class="string">'kernel32.dll'</span><span class="keyword">, </span><span class="string">'GetStdHandle'</span><span class="keyword">, </span><span class="string">'i=h'</span><span class="keyword">, </span><span class="string">'f=s'</span><span class="keyword">, </span><span class="string">'r=l'</span><span class="keyword">);<br></span><span class="default">$dw</span><span class="keyword">-&gt;</span><span class="default">Register</span><span class="keyword">(</span><span class="string">'kernel32.dll'</span><span class="keyword">, </span><span class="string">'SetConsoleTextAttribute'</span><span class="keyword">, </span><span class="string">'i=hl'</span><span class="keyword">, </span><span class="string">'f=s'</span><span class="keyword">, </span><span class="string">'r=t'</span><span class="keyword">);<br></span><span class="default">$dw</span><span class="keyword">-&gt;</span><span class="default">Register</span><span class="keyword">(</span><span class="string">'kernel32.dll'</span><span class="keyword">, </span><span class="string">'SetConsoleTitle'</span><span class="keyword">, </span><span class="string">'i=s'</span><span class="keyword">, </span><span class="string">'f=s'</span><span class="keyword">, </span><span class="string">'r=l'</span><span class="keyword">);<br><br></span><span class="comment">// get console handle<br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">$dw</span><span class="keyword">-&gt;</span><span class="default">GetStdHandle</span><span class="keyword">(-</span><span class="default">11</span><span class="keyword">);&nbsp; </span><span class="comment">// -11 = STD_OUTPUT_HANDLE<br><br></span><span class="default">?&gt;<br></span><br>After these initialization steps, you can set the console output color using:<br><br><span class="default">&lt;?php<br>$dw</span><span class="keyword">-&gt;</span><span class="default">SetConsoleTextAttribute</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">14</span><span class="keyword">);<br>echo </span><span class="string">'This is yellow text!'</span><span class="keyword">;<br></span><span class="default">$dw</span><span class="keyword">-&gt;</span><span class="default">SetConsoleTextAttribute</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">);<br>echo </span><span class="string">'Back to normal gray!'</span><span class="keyword">;<br></span><span class="default">?&gt;<br></span><br>Using SetConsoleTitle you can even set the title displayed in the console window.<br><br>Color values are 0..7 for dark colors and 8..15 for light colors. Sequence is (black/silver, blue, green, cyan, red, magenta, yellow/brown, white/gray). I also found that if you add 16384 to the value, it should be inverse. 32768 added should get underlined text. But these latter two didn't work for me.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="75914">  
  <a class="name">
  <strong class="user"><em>halfer</em></strong></a><div class="date" title="2007-06-21 05:03"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom75914">
<div class="phpcode"><code><span class="html">
Thanks to paul at completewebservices who added a note earlier; I have used his code to solve a particularly difficult issue with the Crystal 9 runtime component. For some reason, VBA/VBS can pass a native Date type as a parameter to a Crystal Report requiring a date, but in PHP I've tried all manner of strings, unix timestamps, COM variant dates etc and all of these resulted in a com_exception.<br><br>My solution was to employ VBScript to borrow the CDate function, which works correctly. Not the most elegant of solutions, but this parameterised approach is to be preferred to search-n-replacing the RecordSelectionFormula string. Of course if anyone here has an even better approach, do post it here - I am sure it would be of use.<br><br><span class="default">&lt;?php<br></span><span class="comment">// $rptParam is a report parameter object having a type of date<br></span><span class="default">$oScript </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"MSScriptControl.ScriptControl"</span><span class="keyword">);<br></span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">Language </span><span class="keyword">= </span><span class="string">"VBScript"</span><span class="keyword">;<br></span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">AllowUI </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br></span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">AddObject</span><span class="keyword">(</span><span class="string">'rptParam'</span><span class="keyword">, </span><span class="default">$rptParam</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br></span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">AddCode</span><span class="keyword">(</span><span class="string">'Function SetDateParameter(strDate)<br>rptParam.AddCurrentValue(CDate(strDate))<br>End Function'</span><span class="keyword">);<br></span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">Run</span><span class="keyword">(</span><span class="string">"SetDateParameter"</span><span class="keyword">, </span><span class="string">"25 April 2006"</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="55988">  
  <a class="name">
  <strong class="user"><em>jbr at ya-right dot com</em></strong></a><div class="date" title="2005-08-19 01:07"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom55988">
<div class="phpcode"><code><span class="html">
Getting * directory * permissions ( attributes ) with COM<br><br>PHP (5) example...<br><br>&lt;?<br>&nbsp; &nbsp; $dir = 'e:/www/docs/www/docs/junk/';<br><br>&nbsp; &nbsp; define ( 'READ_ONLY', 1 );<br>&nbsp; &nbsp; define ( 'IS_HIDDEN', 2 );<br>&nbsp; &nbsp; define ( 'IS_SYSTEM', 4 );<br><br>&nbsp; &nbsp; $hold = array ();<br><br>&nbsp; &nbsp; $obj = new COM ( 'scripting.filesystemobject' );<br><br>&nbsp; &nbsp; if ( is_object ( $obj ) )<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; $all = $obj-&gt;getfolder ( $dir );<br><br>&nbsp; &nbsp; &nbsp; &nbsp; foreach ( $all-&gt;subfolders AS $directory )<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( substr ( $directory-&gt;name, - 3 ) != 'cnf' )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $hold[$dir . $directory-&gt;name . '/'] =&nbsp; array ( 'read_only' =&gt; ( ( $directory-&gt;Attributes &amp; READ_ONLY ) &lt;&gt; 0 ? 1 : 0 ), 'is_hidden' =&gt; ( ( $directory-&gt;Attributes &amp; IS_HIDDEN ) &lt;&gt; 0 ? 1 : 0 ), 'is_system' =&gt; ( ( $directory-&gt;Attributes &amp; IS_SYSTEM ) &lt;&gt; 0 ? 1 : 0 ) );<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $obj = null;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; else<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; echo 'sorry can not crate object: file_system_object';<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; print_r ( $hold );<br>?&gt;<br><br>To do the same thing for * files * with in the directory named in $dir, change above ( foreach() ) to what is below...<br><br>&nbsp; &nbsp; &nbsp; &nbsp; foreach ( $all-&gt;files AS $file )<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $hold[$file-&gt;name] =&nbsp; array ( 'read_only' =&gt; ( ( $file-&gt;Attributes &amp; READ_ONLY ) &lt;&gt; 0 ? 1 : 0 ), 'is_hidden' =&gt; ( ( $file-&gt;Attributes &amp; IS_HIDDEN ) &lt;&gt; 0 ? 1 : 0 ), 'is_system' =&gt; ( ( $file-&gt;Attributes &amp; IS_SYSTEM ) &lt;&gt; 0 ? 1 : 0 ) );<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br><br>pretty much anything you could think of doing in windows can be done using PHP and COM...<br><br>John</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88694">  
  <a class="name">
  <strong class="user"><em>CLICIU at YAHOO dot com</em></strong></a><div class="date" title="2009-02-03 03:18"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88694">
<div class="phpcode"><code><span class="html">
What's really cool is that you can write anything you like in C#/VB.NET and easily access it via COM in PHP<br>This is a image Rotation Example using C# and PHP<br><br>&lt;form name="form1" method="get" action="#"&gt;<br>&lt;input name="angle" type="text" value="&lt;?echo $_GET["angle"];?&gt;"&gt;<br>&nbsp; &lt;input type="submit" name="Submit" value="Submit"&gt;<br>&lt;/form&gt;<br><br> <br><span class="default">&lt;?php<br></span><span class="keyword">if(!isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">"angle"</span><span class="keyword">]) &amp;&amp; !</span><span class="default">is_Numeric</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">"angle"</span><span class="keyword">]) )<br>{<br>&nbsp; </span><span class="default">$angle</span><span class="keyword">=</span><span class="default">5</span><span class="keyword">;<br>}else{<br>&nbsp; &nbsp; </span><span class="default">$angle</span><span class="keyword">=</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">"angle"</span><span class="keyword">]);<br>}<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $img =new COM("MyImageProcessor.MyImageProcessing");&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">=&nbsp; new </span><span class="default">DOTNET</span><span class="keyword">(</span><span class="string">"MyImageProcessor"</span><span class="keyword">,</span><span class="string">"MyImageProcessing"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">LoadImage</span><span class="keyword">(</span><span class="string">"D:\\htdocs\\TT\\Flower.jpg"</span><span class="keyword">);&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">RotateImage</span><span class="keyword">(</span><span class="default">$angle</span><span class="keyword">);&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">SaveImage</span><span class="keyword">(</span><span class="string">"D:\\htdocs\\TT\\new.jpg"</span><span class="keyword">);&nbsp; <br></span><span class="default">?&gt;<br></span>Otput image:&lt;br&gt;<br>&lt;img src="new.jpg" width="520"/&gt;<br>&lt;br&gt;&lt;br&gt;<br> Original&nbsp;&nbsp; image &lt;br&gt;<br>&lt;img src="Flower.jpg" width="520"/&gt;<br><br>The complete source code PHP and C# : <br><a rel="nofollow" target="_blank">http://www.navioo.com/php/tutorials/PHP_and_NET_876.html</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="88040">  
  <a class="name">
  <strong class="user"><em>james dot m dot love at gmail dot com</em></strong></a><div class="date" title="2009-01-07 03:27"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88040">
<div class="phpcode"><code><span class="html">
If you're using COM to create a DSN Less connection to an MS Access 2007 database, you'll find through Googling that you need to use an updated version of Jet, so the connection string I've found looks like this:
<br>
<br><span class="default">&lt;?php
<br>$databaselocation </span><span class="keyword">= </span><span class="string">"C:\Path\to\db.accdb"</span><span class="keyword">;
<br></span><span class="default">$conn </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'ADODB.Connection'</span><span class="keyword">) or exit(</span><span class="string">'Cannot start ADO.'</span><span class="keyword">);
<br></span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=</span><span class="default">$databaselocation</span><span class="string">"</span><span class="keyword">) or die(</span><span class="string">'Cannot start with Jet'</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>However, on my setup (WinVista, Access 2007, PHP526) I found that it always 'dies' with "Cannot start with Jet", even if the connection was successful ($conn-&gt;State reads "1").
<br>
<br>I figured to just drop the die() command on $conn-&gt;Open(). If something catastrophic happens with the ADO connection then it's own error handling engine passes stack traces, etc back to the console/standard output.
<br>
<br>Therefore, my Open() command looks like this:
<br>
<br><span class="default">&lt;?php
<br>$conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=</span><span class="default">$databaselocation</span><span class="string">"</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87848">  
  <a class="name">
  <strong class="user"><em>casanoteva at yahoo dot com</em></strong></a><div class="date" title="2008-12-26 01:19"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom87848">
<div class="phpcode"><code><span class="html">
Hi, just wanna share to everyone after tried and tested many many times to create report in PDF format from Crystal Report.<br>Finally I can do it without any error.<br> Here is my system; PHP 5.1.6, MSSQL2005 and Crystal Report Server XI RL2<br><br><span class="default">&lt;?php<br><br></span><span class="comment">//- Variables - for your RPT and PDF<br></span><span class="keyword">echo </span><span class="string">"Print Report Test"</span><span class="keyword">;<br></span><span class="default">$my_report </span><span class="keyword">= </span><span class="string">"D:\\Folder1\\SubFolder1\\Report.rpt"</span><span class="keyword">; </span><span class="comment">// <br></span><span class="default">rpt source file<br>$my_pdf </span><span class="keyword">= </span><span class="string">"D:\\Folder1\\SubFolder1\\Report.pdf"</span><span class="keyword">; </span><span class="comment">// RPT export to pdf file<br>//-Create new COM object-depends on your Crystal Report version<br></span><span class="default">$ObjectFactory</span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"CrystalReports115.ObjectFactory.1"</span><span class="keyword">) or die (</span><span class="string">"Error on load"</span><span class="keyword">); </span><span class="comment">// call COM port<br></span><span class="default">$crapp </span><span class="keyword">= </span><span class="default">$ObjectFactory</span><span class="keyword">-&gt; </span><span class="default">CreateObject</span><span class="keyword">(</span><span class="string">"CrystalDesignRunTime.Application"</span><span class="keyword">); </span><span class="comment">// create an instance for Crystal<br></span><span class="default">$creport </span><span class="keyword">= </span><span class="default">$crapp</span><span class="keyword">-&gt;</span><span class="default">OpenReport</span><span class="keyword">(</span><span class="default">$my_report</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// call rpt report<br><br>// to refresh data before<br><br>//- Set database logon info - must have<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">Database</span><span class="keyword">-&gt;</span><span class="default">Tables</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">SetLogOnInfo</span><span class="keyword">(</span><span class="string">"servername"</span><span class="keyword">, </span><span class="string">"DBname"</span><span class="keyword">, </span><span class="string">"user"</span><span class="keyword">, </span><span class="string">"password"</span><span class="keyword">);<br><br></span><span class="comment">//- field prompt or else report will hang - to get through<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">EnableParameterPrompting </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br><br></span><span class="comment">//- DiscardSavedData - to refresh then read records<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">DiscardSavedData</span><span class="keyword">;<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ReadRecords</span><span class="keyword">();<br><br>&nbsp; &nbsp; <br></span><span class="comment">//export to PDF process<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DiskFileName</span><span class="keyword">=</span><span class="default">$my_pdf</span><span class="keyword">; </span><span class="comment">//export to pdf<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">PDFExportAllPages</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">;<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DestinationType</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; </span><span class="comment">// export to file<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">FormatType</span><span class="keyword">=</span><span class="default">31</span><span class="keyword">; </span><span class="comment">// PDF type<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">Export</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br><br></span><span class="comment">//------ Release the variables ------<br></span><span class="default">$creport </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br></span><span class="default">$crapp </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br></span><span class="default">$ObjectFactory </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br><br></span><span class="comment">//------ Embed the report in the webpage ------<br></span><span class="keyword">print </span><span class="string">"&lt;embed src=\"D:\\Folder1\\SubFolder1\\Report.pdf\" width=\"100%\" height=\"100%\"&gt;"<br><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br></span><span class="default">?&gt;<br></span><br> That's all for me, anyway in Crystal Report I have to check DisCardSavedData, Save data with report and AutoSave (1 min) in Option Tab and also in Report Options I have to check save dat with report, too.<br><br>Hope this should be help to anybody<br><br>Casanoteva</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85253">  
  <a class="name">
  <strong class="user"><em>johnno1985 at gmail dot com</em></strong></a><div class="date" title="2008-08-21 11:34"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom85253">
<div class="phpcode"><code><span class="html">
I couldn't find an example anywhere on what I was trying to do.&nbsp; After taking bits from everyone I ended up with something that worked.<br><br>Im using Crystal Reports 10, MS SQL Server 2005, Apache2, and PHP5.<br><br>My report uses an SQL Store Procedure and passes some parameter to get the report data, so our PHP must set the database logon info and pass the parameters.<br><br>Below is the solution I came up with:<br><br><span class="default">&lt;?php<br><br></span><span class="comment">//------&nbsp; Variables ------<br></span><span class="default">$my_report </span><span class="keyword">= </span><span class="string">"C:\\Apache2\htdocs\\test\\MyReport.rpt"</span><span class="keyword">;&nbsp; </span><span class="comment">//This must be the full path to the file<br></span><span class="default">$my_pdf </span><span class="keyword">= </span><span class="string">"C:\\Apache2\htdocs\\test\\MyReport.pdf"</span><span class="keyword">;<br><br></span><span class="comment">//------ Create a new COM Object of Crytal Reports 10 ------<br></span><span class="default">$ObjectFactory</span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"CrystalReports10.ObjectFactory.1"</span><span class="keyword">);<br><br></span><span class="comment">//------ Create a instance of library Application -------<br></span><span class="default">$crapp </span><span class="keyword">= </span><span class="default">$ObjectFactory</span><span class="keyword">-&gt;</span><span class="default">CreateObject</span><span class="keyword">(</span><span class="string">"CrystalDesignRunTime.Application.10"</span><span class="keyword">);<br><br></span><span class="comment">//------ Open your rpt file ------<br></span><span class="default">$creport </span><span class="keyword">= </span><span class="default">$crapp</span><span class="keyword">-&gt;</span><span class="default">OpenReport</span><span class="keyword">(</span><span class="default">$my_report</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br><br></span><span class="comment">//------ Set database logon info ------<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">Database</span><span class="keyword">-&gt;</span><span class="default">Tables</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">SetLogOnInfo</span><span class="keyword">(</span><span class="string">"MYSERVER"</span><span class="keyword">, </span><span class="string">"Database"</span><span class="keyword">, </span><span class="string">"user"</span><span class="keyword">, </span><span class="string">"password"</span><span class="keyword">);<br><br></span><span class="comment">//------ Suppress the Parameter field prompt or else report will hang ------<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">EnableParameterPrompting </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br><br></span><span class="comment">//------ DiscardSavedData make a Refresh in your data -------<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">DiscardSavedData</span><span class="keyword">;<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ReadRecords</span><span class="keyword">();<br><br></span><span class="comment">//------ Pass formula fields --------<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">FormulaFields</span><span class="keyword">-&gt;</span><span class="default">Item</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">Text </span><span class="keyword">= (</span><span class="string">"'My Report Title'"</span><span class="keyword">);<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ParameterFields</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">AddCurrentValue </span><span class="keyword">(</span><span class="string">"FirstParameter"</span><span class="keyword">);<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ParameterFields</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">)-&gt;</span><span class="default">AddCurrentValue </span><span class="keyword">(</span><span class="default">2000</span><span class="keyword">);<br><br></span><span class="comment">//------ Export to PDF -------<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DiskFileName</span><span class="keyword">=</span><span class="default">$my_pdf</span><span class="keyword">;<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">FormatType</span><span class="keyword">=</span><span class="default">31</span><span class="keyword">;<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DestinationType</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;<br></span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">Export</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br><br></span><span class="comment">//------ Release the variables ------<br></span><span class="default">$creport </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br></span><span class="default">$crapp </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br></span><span class="default">$ObjectFactory </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br><br></span><span class="comment">//------ Embed the report in the webpage ------<br></span><span class="keyword">print </span><span class="string">"&lt;embed src=\"MyReport.pdf\" width=\"100%\" height=\"100%\"&gt;"<br><br></span><span class="default">?&gt;<br></span><br>Obviously there's plenty of room for refinement in there, but it works and should get you going on the right track.&nbsp; I also found that during testing, the script was hanging before supressing the parameter prompt. Once this had happened, some exports that had been working earlier stopped completely and wouldn't work again untill I restarted Apache.&nbsp; This might be something worth doing if you keep having issues after a script has hung.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84854">  
  <a class="name">
  <strong class="user"><em>verticka at hotmail dot com</em></strong></a><div class="date" title="2008-08-01 04:38"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84854">
<div class="phpcode"><code><span class="html">
Voila une deuxime fonction pour excel 2007 et le plugin pdf<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">xls2pdf</span><span class="keyword">(</span><span class="default">$doc</span><span class="keyword">,</span><span class="default">$pdf</span><span class="keyword">)<br>{<br><br></span><span class="comment">// Pas de paramétres requis <br></span><span class="default">$empty </span><span class="keyword">= new </span><span class="default">VARIANT</span><span class="keyword">();<br><br></span><span class="comment">/* Supression du pdf si il existe */<br></span><span class="keyword">if(</span><span class="default">file_exists </span><span class="keyword">(</span><span class="default">$pdf</span><span class="keyword">))<br>@</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$pdf</span><span class="keyword">);<br><br></span><span class="comment">/* Démarrage de Word */<br></span><span class="default">$w </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"excel.application"</span><span class="keyword">) or die(</span><span class="string">"Impossible d'instancier l'application Word"</span><span class="keyword">);<br><br></span><span class="comment">/* Test de Word 2007 */<br></span><span class="keyword">if(</span><span class="default">$w</span><span class="keyword">-&gt;</span><span class="default">Version </span><span class="keyword">&gt; </span><span class="default">11</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="comment">/* Amener Word devant */<br>&nbsp; &nbsp; </span><span class="default">$w</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br><br>&nbsp; &nbsp; </span><span class="comment">/* Test du fichier */<br>&nbsp; &nbsp; </span><span class="keyword">if(</span><span class="default">file_exists </span><span class="keyword">(</span><span class="default">$doc</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$w</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$doc</span><span class="keyword">);<br>&nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br><br>&nbsp; &nbsp; </span><span class="comment">/* Quelques commandes */<br>&nbsp; &nbsp; </span><span class="default">$w</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">ExportAsFixedFormat</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$pdf</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="comment">/* Fermeture de word */<br>&nbsp; &nbsp; </span><span class="default">$w</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Close</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br>}&nbsp; &nbsp; <br></span><span class="default">$w</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br><br></span><span class="comment">/* Libération des ressources */<br></span><span class="default">$w </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br>unset(</span><span class="default">$w</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; <br></span><span class="comment">/* Test du fichier */<br></span><span class="keyword">if(</span><span class="default">file_exists </span><span class="keyword">(</span><span class="default">$pdf</span><span class="keyword">))<br>&nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br>else<br>&nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; <br>}<br><br>if(</span><span class="default">xls2pdf</span><span class="keyword">(</span><span class="string">"c:\\test.xls"</span><span class="keyword">,</span><span class="string">"c:\\test.pdf"</span><span class="keyword">))<br>echo </span><span class="string">"ok"</span><span class="keyword">;<br>else<br>echo </span><span class="string">"nok"</span><span class="keyword">;<br></span><span class="default">?&gt;<br></span><br>Pour les options d'exportation :<br><a rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/bb238907.aspx</a><br><br><a rel="nofollow" target="_blank">http://verticka.blogspot.com/</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="83821">  
  <a class="name">
  <strong class="user"><em>mastrboy.servebeer.com</em></strong></a><div class="date" title="2008-06-13 05:03"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83821">
<div class="phpcode"><code><span class="html">
quick wmi query example:<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; $obj </span><span class="keyword">= new </span><span class="default">COM </span><span class="keyword">( </span><span class="string">'winmgmts://localhost/root/CIMV2' </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$wmi_computersystem </span><span class="keyword">=&nbsp; &nbsp;&nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">ExecQuery</span><span class="keyword">(</span><span class="string">"Select * from Win32_ComputerSystem"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$wmi_bios&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">=&nbsp; &nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">ExecQuery</span><span class="keyword">(</span><span class="string">"Select * from Win32_BIOS"</span><span class="keyword">);<br>&nbsp; &nbsp; foreach ( </span><span class="default">$wmi_computersystem </span><span class="keyword">as </span><span class="default">$wmi_call </span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$model </span><span class="keyword">= </span><span class="default">$wmi_call</span><span class="keyword">-&gt;</span><span class="default">Model</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; foreach ( </span><span class="default">$wmi_bios </span><span class="keyword">as </span><span class="default">$wmi_call </span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$serial </span><span class="keyword">= </span><span class="default">$wmi_call</span><span class="keyword">-&gt;</span><span class="default">SerialNumber</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$bios_version </span><span class="keyword">= </span><span class="default">$wmi_call</span><span class="keyword">-&gt;</span><span class="default">SMBIOSBIOSVersion</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; echo </span><span class="string">"Bios version&nbsp;&nbsp; : </span><span class="default">$bios_version</span><span class="string">\n"</span><span class="keyword">.<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"Serial number&nbsp; : </span><span class="default">$serial</span><span class="string">\n"</span><span class="keyword">.<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"Hardware Model : </span><span class="default">$model</span><span class="string">\n"</span><span class="keyword">;<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="81548">  
  <a class="name">
  <strong class="user"><em>amenthes at NOSPAM dot gmail dot com</em></strong></a><div class="date" title="2008-03-03 10:13"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom81548">
<div class="phpcode"><code><span class="html">
If you ever want to save an Excel(.xls) file into the Office Excel 2003 XML format, just use<br><br>$excel-&gt;Workbooks[1]-&gt;SaveAs('new_file_name.xml', 46);<br><br>That's the number you need, 46.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="66424">  
  <a class="name">
  <strong class="user"><em>hwcshirley at gmail dot com</em></strong></a><div class="date" title="2006-05-21 10:59"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom66424">
<div class="phpcode"><code><span class="html">
Reply to: djogopatrao at gmail dot com<br>I have change little bit your code. Its work.<br><br>$COM_Object = "CrystalDesignRunTime.Application";<br>$my_report = "C:\\appserv\\www\\mc\\test.rpt";<br>$my_pdf = "C:\\appserv\www\\mc\\test.pdf";<br><br>$crapp= New COM($COM_Object) or die("Unable to Create Object");<br>$creport = $crapp-&gt;OpenReport($my_report, 1);<br>$creport-&gt;ReadRecords(); // attention!<br><br>$creport-&gt;ExportOptions-&gt;DiskFileName=$my_pdf;<br>$creport-&gt;ExportOptions-&gt;PDFExportAllPages=true;<br>$creport-&gt;ExportOptions-&gt;DestinationType=1; // Export to File<br>$creport-&gt;ExportOptions-&gt;FormatType=31; // Type: PDF<br>$creport-&gt;Export(false);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="64022">  
  <a class="name">
  <strong class="user"><em>djogopatrao at gmail dot com</em></strong></a><div class="date" title="2006-04-05 12:25"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom64022">
<div class="phpcode"><code><span class="html">
My previous notes about Crystal Reports have vanished away, but anyway I was up to correct them.<br><br>The code above connects to COM (beware of the version number! search on the Registry Editor for the correct name to put in $COM_Object), opens a report from a file ($my_report), reload records from database and then exports it to a PDF file ($my_pdf).<br><br>* IMPORTANT * this code, when invoked from the browser (I'm using Apache) AND with a report that connects to a ODBC database, does not work (the problem is specificly the line ReadRecords(), but may arise without it too when data is not saved into the report file).<br><br>But when you run this code by PHP-CLI (that is, by the command line), it works ok! I bug-reported this, but have no answer till now ( give it a vote, if you thing it's important: <a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=36959</a> ).<br><br>Also, exceptions may arise, so put it on a try_catch block.<br><br>--------------------------<br><br>// by dfcp '06 (djogopatrao@gmail.com)<br><br>$COM_Object = "CrystalReports11.ObjectFactory.1";<br>$my_report = "C:\\report.rpt";<br>$my_pdf = "C:\\report.pdf";<br><br>$ObjectFactory= New COM($COM_Object);<br>$crapp = $ObjectFactory-&gt;CreateObject("CrystalDesignRunTime.Application");<br>$creport = $crapp-&gt;OpenReport($my_report, 1);<br>$creport-&gt;ReadRecords(); // attention!<br><br>$creport-&gt;ExportOptions-&gt;DiskFileName=$my_pdf;<br>$creport-&gt;ExportOptions-&gt;PDFExportAllPages=true;<br>$creport-&gt;ExportOptions-&gt;DestinationType=1; // Export to File<br>$creport-&gt;ExportOptions-&gt;FormatType=31; // Type: PDF<br>$creport-&gt;Export(false);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="62599">  
  <a class="name">
  <strong class="user"><em>djogopatrao at gmail dot com</em></strong></a><div class="date" title="2006-03-04 07:27"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom62599">
<div class="phpcode"><code><span class="html">
I found somewhere (<a rel="nofollow" target="_blank">http://www.recrystallize.com/merchant/supportfaq/supportfaq0003.htm</a>) a list relating each version of Crystal Reports to its respective progID - it may help some fellows out there.<br><br>7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Crystal.CRPE.Application<br><br>8.0&nbsp; &nbsp; &nbsp; &nbsp; CrystalRuntime.Application or CrystalRuntime.Application.8<br><br>8.5&nbsp; &nbsp; &nbsp; &nbsp; CrystalRuntime.Application or CrystalRuntime.Application.8.5<br><br>9 (RDC)&nbsp; &nbsp; CrystalRuntime.Application.9<br>9 (RAS)&nbsp; &nbsp; CrystalReports.ObjectFactory.2<br>10 (RDC)&nbsp;&nbsp; CrystalRuntime.Application.11<br>10 (CEE)&nbsp;&nbsp; CrystalReports10.ObjectFactory.1<br><br> <br>XI (RDC)&nbsp;&nbsp; CrystalRuntime.Application.11<br>XI (RAS)&nbsp;&nbsp; CrystalReports11.ObjectFactory.1</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57552">  
  <a class="name">
  <strong class="user"><em>volker at kybs dot de</em></strong></a><div class="date" title="2005-10-07 12:51"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom57552">
<div class="phpcode"><code><span class="html">
To use the windows speech system install the "Speech SDK 5.1 for Windows� applications" from the Microsoft homepage (free download).<br>Then you can do Text2Speech like this:<br><br>$voice = new COM("SAPI.SpVoice");<br>$voice-&gt;Speak("Hello, lets have a conversation");</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57516">  
  <a class="name">
  <strong class="user"><em>sadi at unicornsoftbd dot com</em></strong></a><div class="date" title="2005-10-06 01:56"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom57516">
<div class="phpcode"><code><span class="html">
If your PHP is configured as ISAPI module then the COM object you create in ur php page will use the same memory space as the web server. If your COM object takes too much memory then this may force some COM error as PHP does not handle the memory usage of COM itself. And also Web server doesnt know what do to free COM memory. But if you use PHP as CGI then PHP itself handle the memory usage of COM. Once in a script where i used COM and PHP as ISAPI module i got unknown COM error.But when i used PHP as CGI there was no error. So those who want to use COM object in your application please be careful about it.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="47347">  
  <a class="name">
  <strong class="user"><em>phpguy _from_ toshpro _dot_ com</em></strong></a><div class="date" title="2004-11-12 05:55"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47347">
<div class="phpcode"><code><span class="html">
if you ever need to connect to an access database (on the server, using the IIS or APACHE user account), here is code below that can help to ease the process.&nbsp; It is written like this because we have a MySQL as well as an Access database and need to be able to switch back and forth.&nbsp; The runQuery function will return a 2 dimensional array and can use column names or numbers for the index of the internal arrays.&nbsp; External arrays are always integer-indexed.&nbsp; We also have found issues with Access staying open and growing from 7MB to 2.5GB within two hours, so we open and close it each time we run a query.&nbsp; If it is not a select query it will return TRUE.&nbsp; if it fails with errors, it will return false.<br><br>There is a showErr flag that we mostly only use for MySQL, since you can output MySQL errors without PHP errors.&nbsp; Access doesn't appear to be that friendly.<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">runQuery</span><span class="keyword">(&amp;</span><span class="default">$conn</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$strSQL</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$associative</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$debug</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$showSQL</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$showErr</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {&nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; return </span><span class="default">runMSQuery</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">,</span><span class="default">$strSQL</span><span class="keyword">,</span><span class="default">$associative</span><span class="keyword">,</span><span class="default">$debug</span><span class="keyword">,</span><span class="default">$showSQL</span><span class="keyword">,</span><span class="default">$showErr</span><span class="keyword">); <br>&nbsp; &nbsp; </span><span class="comment">//return runMyQuery($conn,$strSQL,$associative,$debug,$showSQL,$showErr); <br></span><span class="keyword">}<br><br>function </span><span class="default">openMSDB</span><span class="keyword">(</span><span class="default">$dbfile</span><span class="keyword">=</span><span class="string">"c:/path/and/filename.mdb"</span><span class="keyword">) {<br>&nbsp; &nbsp; if (!@</span><span class="default">$conn </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">)) <br>&nbsp; &nbsp; &nbsp; &nbsp; exit(</span><span class="string">"Unable to create an ADODB connection&lt;br&gt;"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$strConn </span><span class="keyword">= </span><span class="string">"DRIVER={Microsoft Access Driver (*.mdb)}; DBQ="</span><span class="keyword">.</span><span class="default">$dbfile</span><span class="keyword">; <br>&nbsp; &nbsp; @</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="default">$strConn</span><span class="keyword">); <br>&nbsp; &nbsp; if(</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">State </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; return </span><span class="default">$conn</span><span class="keyword">;<br>}<br><br>function </span><span class="default">closeMSDB</span><span class="keyword">(&amp;</span><span class="default">$conn</span><span class="keyword">) {<br>&nbsp; &nbsp; @</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">$conn </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br>&nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br>}<br><br>function </span><span class="default">runMSQuery</span><span class="keyword">(&amp;</span><span class="default">$conn</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$strSQL</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$associative</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$debug</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$showSQL</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$showErr</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br>&nbsp; &nbsp; if(!</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">)) if(!</span><span class="default">$conn</span><span class="keyword">=</span><span class="default">openMSDB</span><span class="keyword">()) return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; if( </span><span class="default">$showSQL </span><span class="keyword">|| </span><span class="default">$debug </span><span class="keyword">) echo </span><span class="default">$strSQL</span><span class="keyword">.</span><span class="string">"\n&lt;br&gt;\n"</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$rtn </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; if(</span><span class="default">$debug</span><span class="keyword">) </span><span class="default">$rs </span><span class="keyword">= </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">(</span><span class="default">$strSQL</span><span class="keyword">);<br>&nbsp; &nbsp; else </span><span class="default">$rs </span><span class="keyword">= @</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">(</span><span class="default">$strSQL</span><span class="keyword">);<br><br>&nbsp; &nbsp; if(!</span><span class="default">$rs</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$showErr</span><span class="keyword">) echo </span><span class="string">"Error running SQL.&lt;br&gt;\n"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">closeMSDB</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">; <br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; if (</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">State </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">closeMSDB</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br>&nbsp; &nbsp; } else {&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$rows</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; while(!</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">-&gt;</span><span class="default">count</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$rsf </span><span class="keyword">= </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$associative</span><span class="keyword">) </span><span class="default">$rtn</span><span class="keyword">[</span><span class="default">$rows</span><span class="keyword">][</span><span class="default">$rsf</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">] = </span><span class="default">$rsf</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else </span><span class="default">$rtn</span><span class="keyword">[</span><span class="default">$rows</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">$rsf</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$rows</span><span class="keyword">++;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">State </span><span class="keyword">!= </span><span class="default">0</span><span class="keyword">) </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$rs </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; if(</span><span class="default">$debug</span><span class="keyword">) </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$rtn</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">closeMSDB</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">$rtn</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="40696">  
  <a class="name">
  <strong class="user"><em>flintjt at hotmail dot com</em></strong></a><div class="date" title="2004-03-11 11:45"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom40696">
<div class="phpcode"><code><span class="html">
I have searched for ways to open and read an excel document and I found some information which I thought that I would document.&nbsp; Information on the object model to help with programming COM objects can be found in your MS Office help files, search for VBA*.chm.<br>Also, here is a script that I used to pull a cell from each worksheet, complete w/ variable for pathnames &amp; worksheets.&nbsp; This script also closes excel completely.&nbsp; The coding might be dirty, but it gets the job done.<br>--------copy from here-----------<br>&lt;pre&gt;<br><span class="default">&lt;?PHP<br>$filename </span><span class="keyword">= </span><span class="string">"c:/spreadhseet/test.xls"</span><span class="keyword">;<br></span><span class="default">$sheet1 </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br></span><span class="default">$sheet2 </span><span class="keyword">= </span><span class="string">"sheet2"</span><span class="keyword">;<br></span><span class="default">$excel_app </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Excel.application"</span><span class="keyword">) or Die (</span><span class="string">"Did not connect"</span><span class="keyword">);<br>print </span><span class="string">"Application name: </span><span class="keyword">{</span><span class="default">$excel_app</span><span class="keyword">-&gt;</span><span class="default">Application</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">}</span><span class="string">\n" </span><span class="keyword">; <br>print </span><span class="string">"Loaded version: </span><span class="keyword">{</span><span class="default">$excel_app</span><span class="keyword">-&gt;</span><span class="default">Application</span><span class="keyword">-&gt;</span><span class="default">version</span><span class="keyword">}</span><span class="string">\n"</span><span class="keyword">;<br></span><span class="default">$Workbook </span><span class="keyword">= </span><span class="default">$excel_app</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"</span><span class="default">$filename</span><span class="string">"</span><span class="keyword">) or Die(</span><span class="string">"Did not open </span><span class="default">$filename</span><span class="string"> </span><span class="default">$Workbook</span><span class="string">"</span><span class="keyword">);<br></span><span class="default">$Worksheet </span><span class="keyword">= </span><span class="default">$Workbook</span><span class="keyword">-&gt;</span><span class="default">Worksheets</span><span class="keyword">(</span><span class="default">$sheet1</span><span class="keyword">);<br></span><span class="default">$Worksheet</span><span class="keyword">-&gt;</span><span class="default">activate</span><span class="keyword">;<br></span><span class="default">$excel_cell </span><span class="keyword">= </span><span class="default">$Worksheet</span><span class="keyword">-&gt;</span><span class="default">Range</span><span class="keyword">(</span><span class="string">"C4"</span><span class="keyword">);<br></span><span class="default">$excel_cell</span><span class="keyword">-&gt;</span><span class="default">activate</span><span class="keyword">;<br></span><span class="default">$excel_result </span><span class="keyword">= </span><span class="default">$excel_cell</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;<br>print </span><span class="string">"</span><span class="default">$excel_result</span><span class="string">\n"</span><span class="keyword">;<br></span><span class="default">$Worksheet </span><span class="keyword">= </span><span class="default">$Workbook</span><span class="keyword">-&gt;</span><span class="default">Worksheets</span><span class="keyword">(</span><span class="default">$sheet2</span><span class="keyword">);<br></span><span class="default">$Worksheet</span><span class="keyword">-&gt;</span><span class="default">activate</span><span class="keyword">;<br></span><span class="default">$excel_cell </span><span class="keyword">= </span><span class="default">$Worksheet</span><span class="keyword">-&gt;</span><span class="default">Range</span><span class="keyword">(</span><span class="string">"C4"</span><span class="keyword">);<br></span><span class="default">$excel_cell</span><span class="keyword">-&gt;</span><span class="default">activate</span><span class="keyword">;<br></span><span class="default">$excel_result </span><span class="keyword">= </span><span class="default">$excel_cell</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;<br>print </span><span class="string">"</span><span class="default">$excel_result</span><span class="string">\n"</span><span class="keyword">;<br></span><span class="comment">#To close all instances of excel:<br></span><span class="default">$Workbook</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">;<br>unset(</span><span class="default">$Worksheet</span><span class="keyword">);<br>unset(</span><span class="default">$Workbook</span><span class="keyword">);<br></span><span class="default">$excel_app</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br></span><span class="default">$excel_app</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br>unset(</span><span class="default">$excel_app</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>&lt;/pre&gt;<br>----------------------------------</span>
</code></div>
  </div>
 </div>
  <div class="note" id="20015">  
  <a class="name">
  <strong class="user"><em>Franky at boucheros dot com</em></strong></a><div class="date" title="2002-03-19 06:38"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom20015">
<div class="phpcode"><code><span class="html">
For Access to Ms Access
<br>use another Provider like this:
<br>
<br><span class="default">&lt;?php
<br>$conn </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">) 
<br>or die(</span><span class="string">"Cannot start ADO"</span><span class="keyword">);
<br></span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=./thefile.mdb;"</span><span class="keyword">);
<br></span><span class="default">$rs </span><span class="keyword">= </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Execute</span><span class="keyword">(</span><span class="string">"SELECT * FROM thetable"</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="18460">  
  <a class="name">
  <strong class="user"><em>mstaiger at informatik dot uni-siegen dot de</em></strong></a><div class="date" title="2002-01-23 06:17"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom18460">
<div class="phpcode"><code><span class="html">
The example above (MS Word) is quiet unsatisfying, as I find. Especially since I couldn't find anybody who actually got it running, including myself. 
<br>
<br>You might therefore give this Powerpoint-example a chance:
<br>----------------------------------
<br>#Instantiate a PowerPoint object.
<br>$ppoint = new COM("PowerPoint.application") or die("Unable to instantiate PowerPoint");
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">#Create a new presentation
<br></span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Presentations</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">() or die (</span><span class="string">"Could not create presentation"</span><span class="keyword">);
<br>
<br></span><span class="comment">//Add a slide
<br></span><span class="default">$slide</span><span class="keyword">=</span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Presentations</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Slides</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);
<br>
<br></span><span class="comment">//Get the name of this slide
<br></span><span class="default">$slidename </span><span class="keyword">= </span><span class="default">$slide</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">();
<br>echo</span><span class="string">"&lt;br&gt;slidename : </span><span class="default">$slidename</span><span class="string">"</span><span class="keyword">;
<br>
<br></span><span class="comment">//Change the name of this new slide
<br></span><span class="default">$slide</span><span class="keyword">-&gt;</span><span class="default">Name </span><span class="keyword">= </span><span class="string">"New Slidename"</span><span class="keyword">;
<br></span><span class="default">$slidename </span><span class="keyword">= </span><span class="default">$slide</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">();
<br>echo</span><span class="string">"&lt;br&gt;NEW slidename : </span><span class="default">$slidename</span><span class="string">"</span><span class="keyword">;
<br>
<br></span><span class="comment">//Save the presentation
<br></span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Presentations</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="string">"c:/InetPub/www/test.ppt"</span><span class="keyword">);
<br></span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Presentations</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Close</span><span class="keyword">();
<br>
<br></span><span class="comment">//closing powerpoint
<br></span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();
<br>
<br></span><span class="comment">//free the object
<br></span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();
<br></span><span class="default">$ppoint </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br>-----------------------
<br></span><span class="default">?&gt;
<br></span>
<br>the config is : 
<br>w2k-server/office2k/iis5/php 4.1.1 isapi
<br>
<br>If you happen to run into a working word2k-example, please let me know.
<br>
<br>Marc</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100886">  
  <a class="name">
  <strong class="user"><em>sparrowstail at googlemail dot com</em></strong></a><div class="date" title="2010-11-12 11:35"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100886">
<div class="phpcode"><code><span class="html">
This script reports all Windows drives, drive type, status (if not available), free space and total drive size:
<br>
<br><span class="default">&lt;?php
<br>
<br>&nbsp; &nbsp; $fso </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'Scripting.FileSystemObject'</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$D </span><span class="keyword">= </span><span class="default">$fso</span><span class="keyword">-&gt;</span><span class="default">Drives</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$type </span><span class="keyword">= array(</span><span class="string">"Unknown"</span><span class="keyword">,</span><span class="string">"Removable"</span><span class="keyword">,</span><span class="string">"Fixed"</span><span class="keyword">,</span><span class="string">"Network"</span><span class="keyword">,</span><span class="string">"CD-ROM"</span><span class="keyword">,</span><span class="string">"RAM Disk"</span><span class="keyword">);
<br>&nbsp; &nbsp; foreach(</span><span class="default">$D </span><span class="keyword">as </span><span class="default">$d </span><span class="keyword">){
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dO </span><span class="keyword">= </span><span class="default">$fso</span><span class="keyword">-&gt;</span><span class="default">GetDrive</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">DriveType </span><span class="keyword">== </span><span class="default">3</span><span class="keyword">){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">Sharename</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp;&nbsp; }else if(</span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">IsReady</span><span class="keyword">){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">VolumeName</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">file_size</span><span class="keyword">(</span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">FreeSpace</span><span class="keyword">) . </span><span class="string">" free of: " </span><span class="keyword">. </span><span class="default">file_size</span><span class="keyword">(</span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">TotalSize</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp;&nbsp; }else{
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="string">"[Drive not ready]"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp;&nbsp; } 
<br>&nbsp;&nbsp; echo </span><span class="string">"Drive " </span><span class="keyword">. </span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">DriveLetter </span><span class="keyword">. </span><span class="string">": - " </span><span class="keyword">. </span><span class="default">$type</span><span class="keyword">[</span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">DriveType</span><span class="keyword">] . </span><span class="string">" - " </span><span class="keyword">. </span><span class="default">$n </span><span class="keyword">. </span><span class="string">" - " </span><span class="keyword">. </span><span class="default">$s </span><span class="keyword">. </span><span class="string">"&lt;br&gt;"</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; function </span><span class="default">file_size</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$filesizename </span><span class="keyword">= array(</span><span class="string">" Bytes"</span><span class="keyword">, </span><span class="string">" KB"</span><span class="keyword">, </span><span class="string">" MB"</span><span class="keyword">, </span><span class="string">" GB"</span><span class="keyword">, </span><span class="string">" TB"</span><span class="keyword">, </span><span class="string">" PB"</span><span class="keyword">, </span><span class="string">" EB"</span><span class="keyword">, </span><span class="string">" ZB"</span><span class="keyword">, </span><span class="string">" YB"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; return </span><span class="default">$size </span><span class="keyword">? </span><span class="default">round</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">/</span><span class="default">pow</span><span class="keyword">(</span><span class="default">1024</span><span class="keyword">, (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">log</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">, </span><span class="default">1024</span><span class="keyword">)))), </span><span class="default">2</span><span class="keyword">) . </span><span class="default">$filesizename</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] : </span><span class="string">'0 Bytes'</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; }
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>There are a number of other properties of the drive object which can be called this way - see:
<br>
<br><a rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/ts2t8ybh%28VS.85%29.aspx</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="92453">  
  <a class="name">
  <strong class="user"><em>rupams2002 at yahoo dot com</em></strong></a><div class="date" title="2009-07-24 10:38"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom92453">
<div class="phpcode"><code><span class="html">
If you make a DLL in VB6 and want to access from PHP, here is the example. Only connection method is defined. You need to create rest....<br><br>How to use in PHP<br>DLL refers ProjectName . ClassName <br>$Obj = new COM ('ProjectName.ClassName');<br>$dw-&gt;MsSql_Connect('MachineName', 'DB_NAme');<br><br>If you want to connect Database through DLL then <br><br>Open project in VB6 Class Module : <br>And add this code and compile and make DLL.<br><br>Public Function MsSql_Connect(ByVal DBMachineID As String, ByVal DBName As String) As Boolean<br>&nbsp; &nbsp; Dim LocalCn As New ADODB.Connection<br>&nbsp; &nbsp; Dim conStr As String, DB_UserID As String, DB_Password As String<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; On Error GoTo ErrorHandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; DB_UserID = "DBUserName"<br>&nbsp; &nbsp; DB_Password = "DBPassword"<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set LocalCn = New ADODB.Connection<br>&nbsp; &nbsp; LocalCn.CursorLocation = adUseClient<br><br>&nbsp; &nbsp; conStr = "Provider=SQLOLEDB.1;Password=" &amp; DB_Password &amp; ";Persist Security Info=True;User ID=" &amp; DB_UserID &amp; ";Initial Catalog=" &amp; DBName &amp; ";Data Source=" &amp; DBMachineID &amp; ";"<br>&nbsp; &nbsp; LocalCn.Open conStr<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; DBConnection = conStr<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; MsSql_Connect = True<br>&nbsp; &nbsp; Set LocalCn = Nothing<br>&nbsp; &nbsp; <br>ErrorHandler:<br>&nbsp; &nbsp; If Err.Number &lt;&gt; 0 Then<br>&nbsp; &nbsp; &nbsp;&nbsp; MsSql_Connect = False<br>&nbsp; &nbsp; &nbsp;&nbsp; Set LocalCn = Nothing<br>&nbsp; &nbsp; &nbsp;&nbsp; Err.Raise vbObjectError + 513, App.EXEName, Err.Description<br>&nbsp; &nbsp; End If<br>End Function<br><br>"DBConnection" is a variable you need to Set + Get property in VB6 to keep the connection string alive in DLL.<br><br>Remember :<br>Err.Raise vbObjectError + 513, App.EXEName, Err.Description<br><br>will raise error in PHP, user can see error in browser and stop execution php code.<br><br>If you need any help email me.<br><br>Mohammed Ziaul Hasan [Rupam]<br>rupams2002@yahoo.com<br>Senior Developer<br>Canada</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91574">  
  <a class="name">
  <strong class="user"><em>pavanphp Gudipati</em></strong></a><div class="date" title="2009-06-17 06:49"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91574">
<div class="phpcode"><code><span class="html">
Here I Am describing a Program from which you can connect any exe(software) using COM component. 
<br>pdf2swf is a software for converting PDf to SWF files.
<br>
<br>This is best example for&nbsp; WScript.Shell
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">#code for pdf to swf using pdf2swf software
<br>#this codeworks in windows environment.
<br> 
<br>
<br>## Important Parameters
<br></span><span class="default">$software_path&nbsp; </span><span class="keyword">=</span><span class="string">"C:\\SWFTools\\pdf2swf" </span><span class="keyword">;
<br></span><span class="default">$pdf_path&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">=</span><span class="string">"C:\\SWFTools\\abcd.pdf" </span><span class="keyword">;
<br></span><span class="default">$argument&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="string">"-o"</span><span class="keyword">;
<br></span><span class="default">$swf_output&nbsp; &nbsp;&nbsp; </span><span class="keyword">=</span><span class="string">"C:\\SWFTools\\abcd.swf" </span><span class="keyword">;
<br>
<br> 
<br>
<br></span><span class="comment">#actual code
<br></span><span class="default">$cmd&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=</span><span class="string">" </span><span class="default">$software_path</span><span class="string"> </span><span class="default">$pdf_path</span><span class="string">&nbsp; </span><span class="default">$argument</span><span class="string"> </span><span class="default">$swf_output</span><span class="string">"</span><span class="keyword">;
<br>
<br></span><span class="default">$WshShell&nbsp;&nbsp; </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WScript.Shell"</span><span class="keyword">);
<br></span><span class="default">$oExec&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">$WshShell</span><span class="keyword">-&gt;</span><span class="default">Run</span><span class="keyword">(</span><span class="string">"cmd /C </span><span class="default">$cmd</span><span class="string"> "</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">); 
<br>
<br></span><span class="comment"># 0 for command prompt invisible mode
<br># 3 for visible
<br>
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90162">  
  <a class="name">
  <strong class="user"><em>fernando at digitins dot com dot br</em></strong></a><div class="date" title="2009-04-08 07:30"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90162">
<div class="phpcode"><code><span class="html">
When you save a MS Word document with this:<br><span class="default">&lt;?php<br>$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="string">'myfile.doc'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Your file maybe go to this location:<br>C:\WINDOWS\system32\config\systemprofile\My documents (and not to your script directory)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="56801">  
  <a class="name">
  <strong class="user"><em>deletethis@bjoern(at)syltonline(doot)de</em></strong></a><div class="date" title="2005-09-15 07:36"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom56801">
<div class="phpcode"><code><span class="html">
If you can get the old "TaskScheduler.dll" and register it, it is quite simple to handle and start Windows tasks from PHP.<br>This is extremely useful when you got things to do which must be run in a different user context. Prepare a task with the user and use PHP &amp; Com to build a webinterface for it.<br><br>Here is an example how to start a Windows task:<br><br>&nbsp; function start_task ($taskname) {<br>&nbsp; &nbsp; $SchedObj = new COM("Scheduler.SchedulingAgent.1");<br>&nbsp; &nbsp; foreach ($SchedObj-&gt;Tasks as $task) {<br>&nbsp; &nbsp; &nbsp; if (strtolower( (string) $task) == strtolower( $taskname.".job" )) {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $task-&gt;Run();<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; }<br><br>I'm also working on a class to handle infos, adding and removing of tasks via PHP. If you are interested drop me a line.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="50587">  
  <a class="name">
  <strong class="user"><em>csaba at alum dot mit dot edu</em></strong></a><div class="date" title="2005-03-03 05:21"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom50587">
<div class="phpcode"><code><span class="html">
Getting IE to the foreground<br>If you are using a command line (CLI) version of PHP on a Win32 platform (e.g. XP Pro, SP2), you might want to have output directed to IE (perhaps you'll want to work with the output there) when Popup does not suffice (see my earlier post, below).<br><br>It's easy enough to get an instance of IE using $ie = new COM("InternetExplorer.Application");.&nbsp; The problem is, you don't necessarily see it in the foreground (especially if you already have one open) and who wants to waste keystrokes getting to it?&nbsp; The code below has been working for me (If you want to do other adjustments (e.g. $ie-&gt;Document-&gt;ParentWindow-&gt;resizeTo(800,500); or $ie-&gt;Document-&gt;Body-&gt;bgColor = "yellow";), doing them before the $ie-&gt;Visible = true; line will avoid screen distractions):<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">newIEtoForeground</span><span class="keyword">(</span><span class="default">$title</span><span class="keyword">, </span><span class="default">$evtPrefix</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="comment">// brings new instance of IE to foreground with title $title<br>&nbsp; &nbsp; </span><span class="keyword">if (!</span><span class="default">$extPrefix</span><span class="keyword">) </span><span class="default">$ie </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"InternetExplorer.Application"</span><span class="keyword">);<br>&nbsp; &nbsp; else </span><span class="default">$ie </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"InternetExplorer.Application"</span><span class="keyword">, </span><span class="default">$evtPrefix</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">Navigate2</span><span class="keyword">(</span><span class="string">"about:blank"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$oWSH </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WScript.Shell"</span><span class="keyword">);<br>&nbsp; &nbsp; while (</span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">ReadyState</span><span class="keyword">!=</span><span class="default">4</span><span class="keyword">) </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">10000</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">Document</span><span class="keyword">-&gt;</span><span class="default">Title </span><span class="keyword">= (</span><span class="default">$tmpTitle </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">());&nbsp; </span><span class="comment">//unique title<br>&nbsp; &nbsp; </span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br>&nbsp; &nbsp; while (!</span><span class="default">$oWSH</span><span class="keyword">-&gt;</span><span class="default">AppActivate</span><span class="keyword">(</span><span class="string">"</span><span class="default">$tmpTitle</span><span class="string"> - M"</span><span class="keyword">)) </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">10000</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">Document</span><span class="keyword">-&gt;</span><span class="default">Title </span><span class="keyword">= </span><span class="default">$title</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">Document</span><span class="keyword">-&gt;</span><span class="default">ParentWindow</span><span class="keyword">-&gt;</span><span class="default">opener</span><span class="keyword">=</span><span class="string">"me"</span><span class="keyword">;&nbsp; </span><span class="comment">// allows self.close()<br>&nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">$ie</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>Csaba Gabor from Vienna</span>
</code></div>
  </div>
 </div>
  <div class="note" id="49988">  
  <a class="name">
  <strong class="user"><em>csaba at alum dot mit dot edu</em></strong></a><div class="date" title="2005-02-14 12:22"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom49988">
<div class="phpcode"><code><span class="html">
Basic Windows IO<br>If you are using a command line (CLI) version of PHP on a Win32 platform, you might like to have a simple graphical interface to get input and output.&nbsp; The following gives an illustration for both.<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="comment">// first we get some input<br>&nbsp; &nbsp; </span><span class="default">$oScript </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"MSScriptControl.ScriptControl"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">Language </span><span class="keyword">= </span><span class="string">"VBScript"</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$title </span><span class="keyword">= </span><span class="string">"I/O Demo: Input half"</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$initial </span><span class="keyword">= </span><span class="string">"Change this value"</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$prompt </span><span class="keyword">= </span><span class="string">"Please enter a value"</span><span class="keyword">;<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="default">$code </span><span class="keyword">= &lt;&lt;&lt;EOF<br></span><span class="string">Function getInput()<br>&nbsp; &nbsp; inVal = InputBox("</span><span class="default">$prompt</span><span class="string">", "</span><span class="default">$title</span><span class="string">", "</span><span class="default">$initial</span><span class="string">")<br>&nbsp; &nbsp; getInput = inVal&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'how return values are assigned in VB<br>End Function<br></span><span class="keyword">EOF;<br><br>&nbsp; &nbsp; </span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">AddCode</span><span class="keyword">(</span><span class="default">$code</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$input </span><span class="keyword">= </span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">Eval</span><span class="keyword">(</span><span class="string">"getInput()"</span><span class="keyword">);&nbsp; &nbsp; <br>&nbsp; &nbsp; if (</span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)==</span><span class="string">"NULL"</span><span class="keyword">) </span><span class="default">$input </span><span class="keyword">= </span><span class="string">"Input box was cancelled"</span><span class="keyword">;<br><br>&nbsp; &nbsp; </span><span class="comment">// now we show some output<br>&nbsp; &nbsp; </span><span class="default">$oWSH </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WScript.Shell"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$title </span><span class="keyword">= </span><span class="string">"I/O Demo: Output half"</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$timeout </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// 0 for no timeout<br>&nbsp; &nbsp; </span><span class="default">$style </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">+ </span><span class="default">48</span><span class="keyword">;&nbsp; &nbsp; </span><span class="comment">// buttons to show + alert symbol<br>&nbsp; &nbsp; </span><span class="default">$oWSH</span><span class="keyword">-&gt;</span><span class="default">Popup</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$timeout</span><span class="keyword">, </span><span class="default">$title</span><span class="keyword">, </span><span class="default">$style</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>This is example is overblown for illustrative purposes.&nbsp; The whole input part collapses if the amount of code used is a single statement.&nbsp; So, this would have sufficed:<br>$code = "InputBox(\"$prompt\", \"$title\", \"$initial\")";<br>$input = $oScript-&gt;Eval($code);<br><br>This technique exposes quite a bit of scripting power tied into the Windows operating system and VBScript.&nbsp; However, you should have a really specific reason for using it since VBScript tends to be dog slow when compared to PHP in my tests.&nbsp; Simple IO like this is good, however, and the popup size can be quite large.&nbsp; Furthermore, this could be a viable route to go for accessing WinAPI's.<br><br><a rel="nofollow" target="_blank">http://www.ss64.com/wsh/popup.html</a> shows some documentation for $oWSH-&gt;Popup<br><br>Csaba Gabor from Vienna</span>
</code></div>
  </div>
 </div>
  <div class="note" id="37972">  
  <a class="name">
  <strong class="user"><em>jon at jonroig dot com</em></strong></a><div class="date" title="2003-12-03 12:28"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom37972">
<div class="phpcode"><code><span class="html">
Here's a simple example of printing formatted templates with MS Word.
<br>
<br>To begin with, I've already built my invoice in Word and saved it as an RTF file.
<br>In this case, I'm using "sampleInvoice.php" 
<br>
<br>Fields that will be replaced have been marked as ||CUSTOMER ID|| and so on. 
<br>
<br><span class="default">&lt;?php
<br>$dataText </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br>
<br></span><span class="comment">// open the file
<br></span><span class="keyword">if(!(</span><span class="default">$fp</span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">(</span><span class="string">"C:\wordTest\sampleInvoice.rtf"</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">))) die (</span><span class="string">"Can't open"</span><span class="keyword">);
<br></span><span class="default">$dataText </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">2000000</span><span class="keyword">);
<br></span><span class="default">fclose </span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);
<br>
<br></span><span class="comment">// replace the template fields
<br></span><span class="default">$dataText </span><span class="keyword">= </span><span class="default">str_replace </span><span class="keyword">(</span><span class="string">"||CUSTOMER ID||"</span><span class="keyword">,</span><span class="default">$customerIDValue</span><span class="keyword">, </span><span class="default">$dataText</span><span class="keyword">);
<br>
<br></span><span class="comment">// save the file as an rtf
<br></span><span class="default">$timeStamp </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();
<br></span><span class="default">$saveFile </span><span class="keyword">= </span><span class="string">"C:/wordTemp/"</span><span class="keyword">.</span><span class="default">$timeStamp</span><span class="keyword">.</span><span class="string">"-invoice-"</span><span class="keyword">.</span><span class="default">$customerIDValue</span><span class="keyword">.</span><span class="string">".rtf"</span><span class="keyword">;
<br>if(!(</span><span class="default">$fq</span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">(</span><span class="default">$saveFile</span><span class="keyword">, </span><span class="string">"w+"</span><span class="keyword">))) die (</span><span class="string">"Can't open"</span><span class="keyword">);
<br></span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$fq</span><span class="keyword">, </span><span class="default">$dataText</span><span class="keyword">);
<br></span><span class="default">fclose </span><span class="keyword">(</span><span class="default">$fq</span><span class="keyword">);
<br>
<br></span><span class="comment">// initialize the word components
<br></span><span class="default">$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instantiate Word"</span><span class="keyword">); 
<br>
<br>print </span><span class="string">"Loaded word version (</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="string">)\n"</span><span class="keyword">;
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">visible </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">();
<br>
<br></span><span class="comment">// open the file
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"</span><span class="default">$saveFile</span><span class="string">"</span><span class="keyword">);
<br>
<br></span><span class="comment">// output the file to the default printer
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">PrintOut</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);
<br>
<br></span><span class="comment">// shutdown word
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="37525">  
  <a class="name">
  <strong class="user"><em>drich at nea-online dot net</em></strong></a><div class="date" title="2003-11-18 02:47"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom37525">
<div class="phpcode"><code><span class="html">
Changing Fields (Not FORMFIELDS) In MS Word....
<br>
<br>Searched most of the afternoon for this, as it is something needed here for our projects.&nbsp; Maybe this can help someone else as well.
<br>
<br><span class="default">&lt;?php
<br>$input </span><span class="keyword">= </span><span class="string">"x:\\path\\to\\test.doc"</span><span class="keyword">;
<br></span><span class="default">$word </span><span class="keyword">= @new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instantiate Word"</span><span class="keyword">); 
<br>print </span><span class="string">"Loaded Word, version </span><span class="keyword">{</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="keyword">}</span><span class="string">\n&lt;br&gt;"</span><span class="keyword">;
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br>print </span><span class="string">"Set Word To Visible&lt;br&gt;"</span><span class="keyword">;
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);
<br>print </span><span class="string">"Opened </span><span class="default">$input</span><span class="string">&lt;br&gt;"</span><span class="keyword">;
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Activate</span><span class="keyword">;
<br>print </span><span class="string">"Activated Word&lt;br&gt;"</span><span class="keyword">;
<br>
<br>print </span><span class="string">"Editing Fields&lt;br&gt;"</span><span class="keyword">;
<br></span><span class="default">$Field </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">$fieldData </span><span class="keyword">= </span><span class="default">$Field</span><span class="keyword">-&gt;</span><span class="default">Result</span><span class="keyword">;
<br></span><span class="default">$fieldData</span><span class="keyword">-&gt;</span><span class="default">Text </span><span class="keyword">= </span><span class="string">"Testing"</span><span class="keyword">;
<br>
<br></span><span class="comment">// Print the document.
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Printout</span><span class="keyword">();
<br>
<br></span><span class="comment">// closing word
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();
<br>
<br></span><span class="comment">// free the object
<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();
<br></span><span class="default">$word </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br>
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="36680">  
  <a class="name">
  <strong class="user"><em>Mihael Peternelj; Slovenia</em></strong></a><div class="date" title="2003-10-18 05:22"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom36680">
<div class="phpcode"><code><span class="html">
If you wnat to connect to Access MDB Library you can use this small "progy". It works so, that if someone other accesses the library, it waits for so long to access it again because (as i know) MDB librarys can be accessed only once at the same time.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">mdb</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">, </span><span class="default">$array </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$base </span><span class="keyword">= </span><span class="string">"Base.mdb"</span><span class="keyword">, </span><span class="default">$timelimit </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; </span><span class="default">$r_items </span><span class="keyword">= array();
<br>&nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$time </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();
<br>&nbsp; &nbsp; </span><span class="default">$process </span><span class="keyword">= </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br>&nbsp; &nbsp; while(</span><span class="default">$r </span><span class="keyword">== </span><span class="default">false </span><span class="keyword">&amp;&amp; </span><span class="default">$process </span><span class="keyword">&lt;= </span><span class="default">$timelimit</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$deb </span><span class="keyword">= </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="string">'DRIVER={Microsoft Access Driver (*.mdb)}; Dbq='</span><span class="keyword">. </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">) .</span><span class="string">';'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$process </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">() - </span><span class="default">$time</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; if(</span><span class="default">$process </span><span class="keyword">&gt;= </span><span class="default">$timelimit</span><span class="keyword">) exit(</span><span class="string">"mdbSQL Query Timeout!"</span><span class="keyword">);
<br>&nbsp; &nbsp; if(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">)) == </span><span class="string">"insert" </span><span class="keyword">or </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">)) == </span><span class="string">"update" </span><span class="keyword">or </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">)) == </span><span class="string">"delete"</span><span class="keyword">) return </span><span class="default">true</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$num_fields </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">-&gt;</span><span class="default">count</span><span class="keyword">();
<br>&nbsp; &nbsp; while (!</span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; for(</span><span class="default">$j </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt; </span><span class="default">$num_fields</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">(</span><span class="default">$j</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$array </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) </span><span class="default">$r_items</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">] = </span><span class="default">$key</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else </span><span class="default">$r_items</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$j</span><span class="keyword">] = </span><span class="default">$key</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$i</span><span class="keyword">++;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">(); 
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();
<br>&nbsp; &nbsp; </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();
<br>&nbsp; &nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br>&nbsp; &nbsp; return </span><span class="default">$r_items</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br></span><span class="default">?&gt;
<br></span>
<br>I got the source from the Manual, what i did is that i made it more compatible and user frendly. :)
<br>
<br>I hope it could some day help someone so as it did me...
<br>
<br>Greetings from Slovenia!
<br>
<br>Mihael Peternelj</span>
</code></div>
  </div>
 </div>
  <div class="note" id="35960">  
  <a class="name">
  <strong class="user"><em>admin at CdnDomainRegistry dot ca</em></strong></a><div class="date" title="2003-09-20 03:57"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom35960">
<div class="phpcode"><code><span class="html">
Here's an example/comparison of VBScript vs PHP's COM component to connect to an IIS Webserver.
<br>The examples backup the IIS MetaBase (your server's website(s) configuration) in IIS.
<br>
<br>VBScript:
<br>&nbsp; Dim obj, iFlags 
<br>&nbsp; Set obj = GetObject("IIS://LocalHost") 
<br>&nbsp; ' Backup to next available version number. 
<br>&nbsp; ' Set flags to save the metabase first and 
<br>&nbsp; ' force the backup even if save fails. 
<br>&nbsp; iFlags = (MD_BACKUP_SAVE_FIRST or MD_BACKUP_FORCE_BACKUP)
<br>&nbsp; obj.Backup "MyBackups", MD_BACKUP_NEXT_VERSION, iFlags
<br>&nbsp; ' Note: The above was copied from Microbucks.
<br>&nbsp; ' This is how you would have to do it.
<br>&nbsp; ' i.e. use the actual constant's value.
<br>&nbsp; iFlags = (2 or 4)&nbsp; 
<br>&nbsp; obj.Backup "MyBackups", &amp;HFFFFFFFF, iFlags
<br>
<br>PHP:
<br>&nbsp; <span class="default">&lt;?php
<br>&nbsp; $obj </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"IIS://LocalHost"</span><span class="keyword">)or die(</span><span class="string">"Unable to instantiate IIS"</span><span class="keyword">);&nbsp; 
<br>&nbsp; </span><span class="default">$err </span><span class="keyword">= </span><span class="default">com_invoke </span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">, </span><span class="string">"Backup"</span><span class="keyword">, </span><span class="string">"MyBackups"</span><span class="keyword">, </span><span class="string">"&amp;HFFFFFFFF"</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">|</span><span class="default">4 </span><span class="keyword">);
<br>&nbsp; </span><span class="default">$obj </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br>&nbsp; print </span><span class="string">"err="</span><span class="keyword">.</span><span class="default">$err</span><span class="keyword">; </span><span class="comment">// returns 0 on success
<br>&nbsp; </span><span class="default">?&gt;
<br></span>
<br>Glen</span>
</code></div>
  </div>
 </div>
  <div class="note" id="35954">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2003-09-20 10:49"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom35954">
<div class="phpcode"><code><span class="html">
Example on how to read a registry value:<br><br><span class="default">&lt;?php<br>&nbsp; $shell</span><span class="keyword">= &amp;new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'WScript.Shell'</span><span class="keyword">);<br>&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$shell</span><span class="keyword">-&gt;</span><span class="default">regRead</span><span class="keyword">(</span><span class="string">'HKEY_CURRENT_USER\Environment\TEMP'</span><span class="keyword">));<br></span><span class="default">?&gt;<br></span><br>(outputs string(39) "%USERPROFILE%\Lokale Einstellungen\Temp" on my system)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="34616">  
  <a class="name">
  <strong class="user"><em>EuresMan</em></strong></a><div class="date" title="2003-08-01 03:21"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom34616">
<div class="phpcode"><code><span class="html">
To mstaiger <br>I have encountered the same problem you report.<br>I tried to use the above code for a word document but it doesn't works, although the same code was good if i use it on a excel sheet.<br><br>The solution is explained at the following link :<br><a rel="nofollow" target="_blank">http://www.phpbuilder.net/columns/venkatesan20030501.php3</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="33864">  
  <a class="name">
  <strong class="user"><em>rickardsjoquist at hotmail dot com</em></strong></a><div class="date" title="2003-07-09 10:33"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom33864">
<div class="phpcode"><code><span class="html">
If you want to use a DSN-less connection to a database (access for example) and return the results of a query as a multidimensional array with the fieldnames as identifier try this. Hope it helps someone :-)
<br>--------------------------------------------------------
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">db</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="string">'DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=' </span><span class="keyword">. </span><span class="default">realpath</span><span class="keyword">(</span><span class="string">"relative_path/db.mdb"</span><span class="keyword">));
<br>&nbsp; &nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$num_fields </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">-&gt;</span><span class="default">count</span><span class="keyword">();
<br>&nbsp; &nbsp; while (!</span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for(</span><span class="default">$j </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$num_fields</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">++) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">(</span><span class="default">$j</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$r_items</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">] = </span><span class="default">$key</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$i</span><span class="keyword">++;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">(); 
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();
<br>&nbsp; &nbsp; </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();
<br>&nbsp; &nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br>&nbsp; &nbsp; return </span><span class="default">$r_items</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>--------------------------------------------------------
<br>use it like this:
<br>--------------------------------------------------------
<br><span class="default">&lt;?php
<br>$results </span><span class="keyword">= </span><span class="default">db</span><span class="keyword">(</span><span class="string">"SELECT field_a, field_b FROM table"</span><span class="keyword">);
<br>foreach(</span><span class="default">$result </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$item</span><span class="keyword">) {
<br>&nbsp; &nbsp; echo </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'field_a'</span><span class="keyword">];
<br>&nbsp; &nbsp; echo </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'field_b'</span><span class="keyword">];
<br>}
<br></span><span class="default">?&gt;
<br></span>--------------------------------------------------------
<br>You can also use: print_r($result); if you want the structure of the array to be printed.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="33090">  
  <a class="name">
  <strong class="user"><em>info at sharedprojects dot nl</em></strong></a><div class="date" title="2003-06-16 09:41"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom33090">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php
<br></span><span class="comment">// An other way to connect
<br>// this connect to a ODBC-datasourced added in the 
<br>// ODBC Data Source Administrator under System DSN
<br>
<br></span><span class="default">$odbcname </span><span class="keyword">= </span><span class="string">"northwind"</span><span class="keyword">;
<br></span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"DSN=</span><span class="default">$odbcname</span><span class="string">"</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="27024">  
  <a class="name">
  <strong class="user"><em>eguan1ao_at_yahoo_dot_com</em></strong></a><div class="date" title="2002-11-20 01:35"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom27024">
<div class="phpcode"><code><span class="html">
An example of connecting to a Microsoft Access database, executing an SQL query, and displaying the results in HTML.<br><br><span class="default">&lt;?php<br><br>$db </span><span class="keyword">= </span><span class="string">'C:\\Program Files\\Microsoft Office\\Office\\Samples\\Northwind.mdb'</span><span class="keyword">;<br><br></span><span class="default">$conn </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'ADODB.Connection'</span><span class="keyword">);<br><br></span><span class="comment">// Two ways to connect. Choose one.<br></span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=</span><span class="default">$db</span><span class="string">"</span><span class="keyword">);<br></span><span class="comment">//$conn-&gt;Open("DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=$db");<br><br></span><span class="default">$sql </span><span class="keyword">= </span><span class="string">'SELECT&nbsp;&nbsp; ProductName, QuantityPerUnit, UnitPrice<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; FROM&nbsp; &nbsp;&nbsp; Products<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ORDER BY ProductName'</span><span class="keyword">;<br></span><span class="default">$rs </span><span class="keyword">= </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Execute</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>&lt;table&gt;<br>&lt;tr&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;th&gt;Product Name&lt;/th&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;th&gt;Quantity Per Unit&lt;/th&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;th&gt;Unit Price&lt;/th&gt;<br>&lt;/tr&gt;<br><span class="default">&lt;?php </span><span class="keyword">while (!</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">): </span><span class="default">?&gt;<br></span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;tr&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;<span class="default">&lt;?= $rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'ProductName'</span><span class="keyword">]-&gt;</span><span class="default">Value ?&gt;</span>&lt;/td&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;td&gt;<span class="default">&lt;?= $rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'QuantityPerUnit'</span><span class="keyword">]-&gt;</span><span class="default">Value ?&gt;</span>&lt;/td&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;<span class="default">&lt;?= $rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'UnitPrice'</span><span class="keyword">]-&gt;</span><span class="default">Value ?&gt;</span>&lt;/td&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="default">&lt;?php $rs</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">() </span><span class="default">?&gt;<br>&lt;?php </span><span class="keyword">endwhile </span><span class="default">?&gt;<br></span>&lt;/table&gt;<br><br><span class="default">&lt;?php<br><br>$rs</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br></span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="23841">  
  <a class="name">
  <strong class="user"><em>kmason at avaya dot com</em></strong></a><div class="date" title="2002-07-29 09:56"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom23841">
<div class="phpcode"><code><span class="html">
It should be noted that to run anything that needs to interact with the UI (the word example), one needs to ensure that the process that the Web server is running under can access the UI.&nbsp; For Apache, this is an option in the Services control panel.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="22160">  
  <a class="name">
  <strong class="user"><em>nospam at zamang dot co dot uk</em></strong></a><div class="date" title="2002-06-08 03:20"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom22160">
<div class="phpcode"><code><span class="html">
The above Word example did not work for me when I tried it using Office 2000. I had to install the Office 2000 SR 2 upgrade to get everything working. It seems that the upgrade fixes some problems with permissions that affect PHP and some other applications that use COM.<br><br>David McCormack</span>
</code></div>
  </div>
 </div>
  <div class="note" id="20526">  
  <a class="name">
  <strong class="user"><em>yinon at xacct dot com</em></strong></a><div class="date" title="2002-04-06 12:33"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom20526">
<div class="phpcode"><code><span class="html">
In order to get the Word exaple running, do the following on the server side.<br>Worked for me...<br>1. Click START--&gt;RUN and enter "dcomcnfg"<br>2. In the "Applications" tab, go down to "Microsoft Word Document"<br>3. Click PROPERTIES button<br>4. Go to the "Security" Tab<br>5. Click "Use custom access permissions", and then click EDIT<br>6. Click ADD and then click SHOW USERS<br>7. Highlight the IIS anonymous user account (usually IUSR_&lt;machinename&gt;), click ADD<br>8. Go back to the "Security" tab by hitting OK <br>9. Click "Use custom launch permissions", and the click EDIT<br>10. Click ADD and then click SHOW USERS<br>11. Highlight the IIS anonymous user account (usually IUSR_&lt;machinename&gt;), click ADD<br>12. Hit OK, and then hit APPLY. <br><br>Also, you should look at the "Identity" tab in the Microsoft Word Document PROPERTIES and see that it is set to "Interactive User" <br>&nbsp; <br><br>ALSO, log into the machine AS the IUSR_&lt;machinename&gt; account, start word, and make sure to click through the dialog boxes that Word shows the first time it is run for a certain user.&nbsp; In other words, make sure Word opens cleanly for the IUSR_ user. <br><br>More useful information could be found here:<br><a rel="nofollow" target="_blank">http://www.email-screen.com/support-doc2txt.html</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="47006">  
  <a class="name">
  <strong class="user"><em>sodeh at dana dot ir</em></strong></a><div class="date" title="2004-10-30 03:11"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47006">
<div class="phpcode"><code><span class="html">
for connection to sql server and know the utf-8 code<br>use this method to connect the database<br><br>$db = new COM("ADODB.Connection",NULL, 65001 );</span>
</code></div>
  </div>
 </div>
  <div class="note" id="89911">  
  <a class="name">
  <strong class="user"><em>dpchiesa at hotmail dot com</em></strong></a><div class="date" title="2009-03-27 09:35"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom89911">
<div class="phpcode"><code><span class="html">
Here's a way to create an AES-Encrypted ZIP file in PHP, using DotNetZip via the COM class. <br><br><span class="default">&lt;?php<br></span><span class="keyword">try<br>{<br>&nbsp; </span><span class="default">$fname </span><span class="keyword">= </span><span class="string">"zip-generated-from-php-" </span><span class="keyword">. </span><span class="default">date</span><span class="keyword">(</span><span class="string">'Y-m-d-His'</span><span class="keyword">) . </span><span class="string">".zip"</span><span class="keyword">;<br>&nbsp; </span><span class="default">$zipOutput </span><span class="keyword">= </span><span class="string">"c:\\temp\\" </span><span class="keyword">. </span><span class="default">$fname</span><span class="keyword">;<br>&nbsp; </span><span class="default">$zip </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Ionic.Zip.ZipFile"</span><span class="keyword">);<br>&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">Name </span><span class="keyword">= </span><span class="default">$zipOutput</span><span class="keyword">;<br>&nbsp; </span><span class="default">$dirToZip</span><span class="keyword">= </span><span class="string">"c:\\temp\\psh"</span><span class="keyword">;<br>&nbsp; </span><span class="comment">#$dirToZip= "c:\\dinoch\\webs\\php";<br>&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">Encryption </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br>&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">Password </span><span class="keyword">= </span><span class="string">"AES-Encryption-Is-Secure"</span><span class="keyword">;<br>&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">AddDirectory</span><span class="keyword">(</span><span class="default">$dirToZip</span><span class="keyword">);<br>&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">Save</span><span class="keyword">();<br>&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">Dispose</span><span class="keyword">();<br><br>&nbsp; if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$zipOutput</span><span class="keyword">))<br>&nbsp; {<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Cache-Control: no-cache, must-revalidate'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Type: application/x-zip'</span><span class="keyword">); <br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Disposition: attachment; filename=' </span><span class="keyword">. </span><span class="default">$fname</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Length: ' </span><span class="keyword">. </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$zipOutput</span><span class="keyword">));<br>&nbsp; &nbsp; </span><span class="default">readfile</span><span class="keyword">(</span><span class="default">$zipOutput</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$zipOutput</span><span class="keyword">);<br>&nbsp; }<br>&nbsp; else <br>&nbsp; {<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;html&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&nbsp; &lt;head&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&nbsp; &lt;title&gt;Calling DotNetZip from PHP through COM&lt;/title&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&nbsp; &lt;link rel="stylesheet" href="basic.css"/&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&nbsp; &lt;/head&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;body&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;h2&gt;Whoops!&lt;/h2&gt;' </span><span class="keyword">. </span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;p&gt;The file was not successfully generated.&lt;/p&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;/body&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;/html&gt;'</span><span class="keyword">;<br>&nbsp; } <br>}<br>catch (</span><span class="default">Exception $e</span><span class="keyword">) <br>{<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;html&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&nbsp; &lt;head&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&nbsp; &lt;title&gt;Calling DotNetZip from PHP through COM&lt;/title&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&nbsp; &lt;link rel="stylesheet" href="basic.css"/&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&nbsp; &lt;/head&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;body&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;h2&gt;Whoops!&lt;/h2&gt;' </span><span class="keyword">. </span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;p&gt;The file was not successfully generated.&lt;/p&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;p&gt;Caught exception: '</span><span class="keyword">,&nbsp; </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">(), </span><span class="string">'&lt;/p&gt;'</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;pre&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getTraceAsString</span><span class="keyword">(), </span><span class="string">"\n"</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;/body&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="string">'&lt;/html&gt;'</span><span class="keyword">;<br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88943">  
  <a class="name">
  <strong class="user"><em>pavanphp at sparsh dot net</em></strong></a><div class="date" title="2009-02-14 05:42"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88943">
<div class="phpcode"><code><span class="html">
This is the code for entering Values in MS word through Php Program.<br><br>First : You need to make word file with including Boolmark<br>(Ms word 2003 , Insert -&gt; Bookmark -&gt;Bookmark Name -&gt; add). <br>Example<br>Name : add here bookmark<br> This is something like input as a text box.&nbsp; Here I given 5 fields. <br>Name , TODAYDATE , Company ,project , Features <br><br>Here I opened a word file, and put data into Bookmark fields using PHP. <br><br>Just note : it works in c:/ only. (not sure why), C:/program files may take longer time. (waiting for ...)<br><br><span class="default">&lt;?php<br><br>com_load_typelib</span><span class="keyword">(</span><span class="string">'Word.Application'</span><span class="keyword">);<br><br></span><span class="default">$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instantiate Word"</span><span class="keyword">);<br><br></span><span class="comment">// use like this. Place your's word file in C drive<br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">'C:/reminder_new.doc'</span><span class="keyword">);<br>echo </span><span class="default">$current_date </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"m/d/Y"</span><span class="keyword">);<br><br></span><span class="default">$tim</span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y-m-d"</span><span class="keyword">);<br><br></span><span class="default">$info_array</span><span class="keyword">=array(&nbsp; </span><span class="string">"Name"&nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">"pavan"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"TODAYDATE" </span><span class="keyword">=&gt; </span><span class="string">"</span><span class="default">$tim</span><span class="string">" </span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Company"&nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">"sparsh" </span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"project"&nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">"Myrepc"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Features"&nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">"Auto fill form editor"</span><span class="keyword">) ;<br><br>foreach(</span><span class="default">$info_array </span><span class="keyword">as </span><span class="default">$bookmarkname </span><span class="keyword">=&gt; </span><span class="default">$re</span><span class="keyword">)<br>&nbsp; &nbsp; {<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$objBookmark </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Bookmarks</span><span class="keyword">(</span><span class="default">$bookmarkname</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$range </span><span class="keyword">= </span><span class="default">$objBookmark</span><span class="keyword">-&gt;</span><span class="default">Range</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$range</span><span class="keyword">-&gt;</span><span class="default">Text </span><span class="keyword">= </span><span class="default">$re </span><span class="keyword">;<br><br>&nbsp; &nbsp; }<br><br></span><span class="default">$new_file </span><span class="keyword">= </span><span class="string">"c:/reminder_filled.doc"</span><span class="keyword">;<br><br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="default">$new_file</span><span class="keyword">);<br><br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br><br></span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br></span><span class="default">$word </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="37956">  
  <a class="name">
  <strong class="user"><em>jnv at jnv dot ch</em></strong></a><div class="date" title="2003-12-03 03:42"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom37956">
<div class="phpcode"><code><span class="html">
Be sure you have Word, Excel, .. on your server or it will not work !</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/class.com.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:52:22 GMT -->


</body></html>