<html><!-- Mirrored from php.net/manual/en/function.parse-str.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:51:15 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>parse_str</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.parse-str.html">
 <link rel="shorturl" href="http://php.net/parse-str">
 <link rel="alternate" href="http://php.net/parse-str" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.strings.html">
 <link rel="prev" href="function.ord.html">
 <link rel="next" href="function.print.html">

 <link rel="alternate" href="function.parse-str.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.parse-str.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.parse-str.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.parse-str.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.parse-str.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.parse-str.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.parse-str.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.parse-str.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.parse-str.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.parse-str.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.parse-str.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.text.html">Text Processing</a></li>      <li><a href="book.strings.html">Strings</a></li>      <li><a href="ref.strings.html">String Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.parse-str" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">parse_str</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">parse_str</span> â€” <span class="dc-title">Parses the string into variables</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.parse-str-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><span class="type void">void</span></span> <span class="methodname"><strong>parse_str</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$str</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter reference">&amp;$arr</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   Parses <code class="parameter">str</code> as if it were the query string
   passed via a URL and sets variables in the current scope. 
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    To get the current <em>QUERY_STRING</em>, you may use the variable
    <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER['QUERY_STRING']</a></var></var>.
    Also, you may want to read the section on
    <a href="language.variables.external.html" class="link">variables from external
    sources</a>.
   </p>
  <p></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    The <a href="info.configuration.html#ini.magic-quotes-gpc" class="link">magic_quotes_gpc</a> setting
    affects the output of this function, as <span class="function"><strong>parse_str()</strong></span> uses
    the same mechanism that PHP uses to populate the <var class="varname"><var class="varname"><a href="reserved.variables.get.html" class="classname">$_GET</a></var></var>,
    <var class="varname"><var class="varname"><a href="reserved.variables.post.html" class="classname">$_POST</a></var></var>, etc. variables.
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.parse-str-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">str</code></dt>

     <dd>

      <p class="para">
       The input string.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">arr</code></dt>

     <dd>

      <p class="para">
       If the second parameter <code class="parameter">arr</code> is present,
       variables are stored in this variable as array elements instead.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.parse-str-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   No value is returned.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.parse-str-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-4972">
    <p><strong>Example #1 Using <span class="function"><strong>parse_str()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"first=value&amp;arr[]=foo+bar&amp;arr[]=baz"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">parse_str</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">);<br>echo&nbsp;</span><span style="color: #0000BB">$first</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;value<br></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$arr</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">];&nbsp;</span><span style="color: #FF8000">//&nbsp;foo&nbsp;bar<br></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$arr</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];&nbsp;</span><span style="color: #FF8000">//&nbsp;baz<br><br></span><span style="color: #0000BB">parse_str</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$output</span><span style="color: #007700">);<br>echo&nbsp;</span><span style="color: #0000BB">$output</span><span style="color: #007700">[</span><span style="color: #DD0000">'first'</span><span style="color: #007700">];&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;value<br></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$output</span><span style="color: #007700">[</span><span style="color: #DD0000">'arr'</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">];&nbsp;</span><span style="color: #FF8000">//&nbsp;foo&nbsp;bar<br></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$output</span><span style="color: #007700">[</span><span style="color: #DD0000">'arr'</span><span style="color: #007700">][</span><span style="color: #0000BB">1</span><span style="color: #007700">];&nbsp;</span><span style="color: #FF8000">//&nbsp;baz<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.parse-str-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.parse-url.html" class="function" rel="rdfs-seeAlso">parse_url()</a> - Parse a URL and return its components</span></li>
    <li class="member"><span class="function"><a href="function.pathinfo.html" class="function" rel="rdfs-seeAlso">pathinfo()</a> - Returns information about a file path</span></li>
    <li class="member"><span class="function"><a href="function.http-build-query.html" class="function" rel="rdfs-seeAlso">http_build_query()</a> - Generate URL-encoded query string</span></li>
    <li class="member"><span class="function"><a href="function.get-magic-quotes-gpc.html" class="function" rel="rdfs-seeAlso">get_magic_quotes_gpc()</a> - Gets the current configuration setting of magic_quotes_gpc</span></li>
    <li class="member"><span class="function"><a href="function.urldecode.html" class="function" rel="rdfs-seeAlso">urldecode()</a> - Decodes URL-encoded string</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="82675">  
  <a class="name">
  <strong class="user"><em>sean at getclicky dot com</em></strong></a><div class="date" title="2008-04-21 09:39"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82675">
<div class="phpcode"><code><span class="html">
This function automatically urldecodes values (not mentioned in the docs).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96035">  
  <a class="name">
  <strong class="user"><em>me at bubjavier dot com</em></strong></a><div class="date" title="2010-02-04 02:48"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96035">
<div class="phpcode"><code><span class="html">
be careful using parse_str() without the [array &amp;$arr] parameter, as this may override values of global and existing variables.<br><br><span class="default">&lt;?php<br>$var1 </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br></span><span class="default">parse_str</span><span class="keyword">(</span><span class="string">'var1=one&amp;var2=two'</span><span class="keyword">);<br></span><span class="comment">// $var1 is now 'one'<br></span><span class="default">?&gt;<br></span><br>Also may lead to variable value injection when used with user input data:<br><br><span class="default">&lt;?php<br>$_POST</span><span class="keyword">[</span><span class="string">'range'</span><span class="keyword">] = </span><span class="string">'min=1&amp;max=5&amp;important_var=important_value_no_more'</span><span class="keyword">;<br><br></span><span class="default">$important_var </span><span class="keyword">= </span><span class="string">'important_value'</span><span class="keyword">;<br></span><span class="default">parse_str</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'range'</span><span class="keyword">]);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="54275">  
  <a class="name">
  <strong class="user"><em></em></strong></a><div class="date" title="2005-06-29 05:59"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom54275">
<div class="phpcode"><code><span class="html">
As of PHP 5, you can do the exact opposite with http_build_query(). Just remember to use the optional array output parameter.<br><br>This is a very useful combination if you want to re-use a search string url, but also slightly modify it:<br><br>Example:<br>&lt;?<br>$url1 = "action=search&amp;interest[]=sports&amp;interest[]=music&amp;sort=id";<br>$str = parse_str($url1, $output);<br><br>// Modifying criteria:<br>$output['sort'] = "interest";<br><br>$url2 = http_build_query($output);<br><br>echo "&lt;br&gt;url1: ".$url1;<br>echo "&lt;br&gt;url2: ".$url2;<br>?&gt;<br><br>Results in:<br>url1: action=search&amp;interest[]=sports&amp;interest[]=music&amp;sort=id<br>url2: action=search&amp;interest[0]=sports&amp;interest[1]=music&amp;sort=interest<br><br>(Array indexes are automatically created.)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="70234">  
  <a class="name">
  <strong class="user"><em>Olivier MenguÃ©</em></strong></a><div class="date" title="2006-10-07 02:02"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom70234">
<div class="phpcode"><code><span class="html">
Vladimir: the function is OK in how it deals with &amp;amp;.<br>&amp;amp; must only be used when outputing URLs in HTML/XML data.<br>You should ask yourself why you have &amp;amp; in your URL when you give it to parse_str.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="79154">  
  <a class="name">
  <strong class="user"><em>chris at mcfadyen dot ca</em></strong></a><div class="date" title="2007-11-13 04:02"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom79154">
<div class="phpcode"><code><span class="html">
I shouldn't've posted the original version, as it only worked with the most basic of query strings.<br><br>This function will parse an html-safe query-like url string for variables and php-like ordered and associative arrays.&nbsp; It places them into the global scope as parse_str does and adds minimal slashes for database insertions without the triple-slash problems that magic quotes can produce (the reason I had to write it in the first place).&nbsp; If you don't need the slashes, they're easy enough to remove.<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">parse_query</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// Separate all name-value pairs<br>&nbsp; &nbsp; </span><span class="default">$pairs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; foreach(</span><span class="default">$pairs </span><span class="keyword">as </span><span class="default">$pair</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Pull out the names and the values<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">list(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">$pair</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Decode the variable name and look for arrays<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">list(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$index</span><span class="keyword">) = </span><span class="default">split</span><span class="keyword">(</span><span class="string">'[][]'</span><span class="keyword">, </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Arrays<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if(isset(</span><span class="default">$index</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Declare or add to the global array defined by $name<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">global $</span><span class="default">$name</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!isset($</span><span class="default">$name</span><span class="keyword">)) $</span><span class="default">$name </span><span class="keyword">= array();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Associative array<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if(</span><span class="default">$index </span><span class="keyword">!= </span><span class="string">""</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ${</span><span class="default">$name</span><span class="keyword">}[</span><span class="default">$index</span><span class="keyword">] = </span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Ordered array<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">} else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">array_push</span><span class="keyword">($</span><span class="default">$name</span><span class="keyword">, </span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)));<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Variables<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">} else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Declare or overwrite the global variable defined by $name<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">global $</span><span class="default">$name</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="default">$name </span><span class="keyword">= </span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="56475">  
  <a class="name">
  <strong class="user"><em>avi at amarcus dot com</em></strong></a><div class="date" title="2005-09-03 06:32"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom56475">
<div class="phpcode"><code><span class="html">
If you are trying to preserve a complex array, the function serialize might be better than http_build_query or other methods of making a query string.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="46481">  
  <a class="name">
  <strong class="user"><em>anatilmizun at gmail dot com</em></strong></a><div class="date" title="2004-10-12 04:10"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom46481">
<div class="phpcode"><code><span class="html">
I wrote a pair of functions using parse_str() that will write values in an array to a textfile and vice versa, read those values from the textfile back into the array. Quite useful if you need to store lots of data but don't have access to SQL.<br><br>Save the array by calling cfg_save($filename,$array) and load it back using $array=cfg_load($filename)<br><br><span class="default">&lt;?php<br>$newline</span><span class="keyword">=</span><span class="string">"ï¿½"</span><span class="keyword">;<br><br>function </span><span class="default">cfg_load</span><span class="keyword">(</span><span class="default">$cfgfile</span><span class="keyword">){<br>&nbsp; &nbsp; global </span><span class="default">$newline</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$setting</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; if(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$cfgfile</span><span class="keyword">)){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$setting</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$cfgfile</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ookk</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; while(</span><span class="default">$ook</span><span class="keyword">=</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$setting</span><span class="keyword">)){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">#strip comment<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$commt</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$ook</span><span class="keyword">,</span><span class="string">"##"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$commt</span><span class="keyword">!==</span><span class="default">false</span><span class="keyword">) </span><span class="default">$ook</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$ook</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$commt</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">#append<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if(</span><span class="default">$ook</span><span class="keyword">!=</span><span class="string">""</span><span class="keyword">) </span><span class="default">$ookk</span><span class="keyword">=</span><span class="default">$ookk</span><span class="keyword">.</span><span class="string">"&amp;"</span><span class="keyword">.&nbsp; &nbsp; </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$newline</span><span class="keyword">,</span><span class="string">"\n"</span><span class="keyword">,</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"&amp;"</span><span class="keyword">,</span><span class="string">"%26"</span><span class="keyword">,</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$ook</span><span class="keyword">)));<br>&nbsp; &nbsp; &nbsp; &nbsp; }&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$setting</span><span class="keyword">);&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">parse_str</span><span class="keyword">(</span><span class="default">$ookk</span><span class="keyword">, </span><span class="default">$setting</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$setting</span><span class="keyword">;<br>}<br><br>function </span><span class="default">cfg_save</span><span class="keyword">(</span><span class="default">$cfgfile</span><span class="keyword">,</span><span class="default">$setting</span><span class="keyword">){<br>&nbsp; &nbsp; global </span><span class="default">$intArray</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$intArray</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">2000</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$intArray</span><span class="keyword">[]=</span><span class="default">$i</span><span class="keyword">;<br>&nbsp; &nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$setting</span><span class="keyword">)){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$allkeys</span><span class="keyword">=</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$setting</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$allkeys </span><span class="keyword">as </span><span class="default">$aKey</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">cfg_recurse</span><span class="keyword">(</span><span class="default">$setting</span><span class="keyword">[</span><span class="default">$aKey</span><span class="keyword">], </span><span class="default">$aKey</span><span class="keyword">, </span><span class="default">$outArray</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">$cfgf</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$cfgfile</span><span class="keyword">,</span><span class="string">"w"</span><span class="keyword">);<br>&nbsp; &nbsp; foreach(</span><span class="default">$outArray </span><span class="keyword">as </span><span class="default">$aLine</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$cfgf</span><span class="keyword">,</span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$aLine</span><span class="keyword">).</span><span class="string">"\r\n"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$cfgf</span><span class="keyword">);<br>}<br><br>function </span><span class="default">cfg_recurse</span><span class="keyword">(</span><span class="default">$stuffIn</span><span class="keyword">, </span><span class="default">$keysofar</span><span class="keyword">, &amp;</span><span class="default">$toAppend</span><span class="keyword">){<br>&nbsp; &nbsp; global </span><span class="default">$intArray</span><span class="keyword">, </span><span class="default">$newline</span><span class="keyword">;<br>&nbsp; &nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$stuffIn</span><span class="keyword">)){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$allkeys</span><span class="keyword">=</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$stuffIn</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">$intArray</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$allkeys</span><span class="keyword">))==</span><span class="default">$allkeys</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$nokey</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; else <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$nokey</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$allkeys </span><span class="keyword">as </span><span class="default">$aKey</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">$nokey</span><span class="keyword">) </span><span class="default">$toKey</span><span class="keyword">=</span><span class="default">$aKey</span><span class="keyword">;&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">cfg_recurse</span><span class="keyword">(</span><span class="default">$stuffIn</span><span class="keyword">[</span><span class="default">$aKey</span><span class="keyword">], </span><span class="default">$keysofar</span><span class="keyword">.</span><span class="string">"["</span><span class="keyword">.</span><span class="default">$toKey</span><span class="keyword">.</span><span class="string">"]"</span><span class="keyword">, </span><span class="default">$toAppend</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }else<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$toAppend</span><span class="keyword">[]=</span><span class="default">$keysofar</span><span class="keyword">.</span><span class="string">"="</span><span class="keyword">.</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">,</span><span class="default">$newline</span><span class="keyword">,</span><span class="default">$stuffIn</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;<br></span><br>Note that these functions support nested arrays of unlimited levels ;)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76978">  
  <a class="name">
  <strong class="user"><em>kermodebear at kermodebear dot org</em></strong></a><div class="date" title="2007-08-08 11:09"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76978">
<div class="phpcode"><code><span class="html">
An old post from several years ago mentions that variable names cannot have a dot. They also cannot have a space. Spaces are automatically replaced with an underscore.<br><br>The following:<br>parse_str("My Value=Something", $result);<br><br>Will result in:<br>$result['My_Value'] = 'Something'<br><br>Although I understand why it is done, I still feel that this is unintuitive behavior.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="69254">  
  <a class="name">
  <strong class="user"><em>PEPE_RIVAS at repixel dot net</em></strong></a><div class="date" title="2006-08-28 06:21"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom69254">
<div class="phpcode"><code><span class="html">
CONVERT ANY FORMATTED STRING INTO VARIABLES<br><br>I developed a online payment solution for credit cards using a merchant, and this merchant returns me an answer of the state of the transaction like this:<br><br>estado=1,txnid=5555444-8454445-4455554,monto=100.00<br><br>to have all that data into variables could be fine for me! so i use str_replace(), the problem is this function recognizes each group of variables with the &amp; character... and i have&nbsp; comma separated values... so i replace comma with &amp;<br><br><span class="default">&lt;?php<br>$string </span><span class="keyword">= </span><span class="string">"estado=1,txnid=5555444-8454445-4455554,monto=100.00"</span><span class="keyword">;<br></span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">","</span><span class="keyword">,</span><span class="string">"&amp;"</span><span class="keyword">,</span><span class="default">$string</span><span class="keyword">);<br></span><span class="default">parse_str</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br>echo </span><span class="default">$monto</span><span class="keyword">; </span><span class="comment">// outputs 100.00<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109212">  
  <a class="name">
  <strong class="user"><em>jrgns at jadeit dot co dot za</em></strong></a><div class="date" title="2012-06-27 08:57"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom109212">
<div class="phpcode"><code><span class="html">
The array to be populated does not need to be defined before calling the function:<br><br><span class="default">&lt;?php<br>error_reporting</span><span class="keyword">(</span><span class="default">E_ALL </span><span class="keyword">| </span><span class="default">E_STRICT</span><span class="keyword">);<br></span><span class="default">parse_str</span><span class="keyword">(</span><span class="string">'var=value'</span><span class="keyword">, </span><span class="default">$array</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>This will not produce a notice.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82837">  
  <a class="name">
  <strong class="user"><em>helpmepro1 at gmail dot com</em></strong></a><div class="date" title="2008-04-28 09:09"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82837">
<div class="phpcode"><code><span class="html">
&lt;? <br>//by shimon doodkin<br><br> $url_form=url_to_form($url);<br> echo '&lt;form action="'.$url_form['action'].'" method="get"&gt;';<br> echo $url_form['hidden'];<br> echo '&lt;input name="otherfiled" type="text"&gt;';<br> echo '&lt;input type="submit"&gt;';<br> echo '&lt;/form&gt;';<br><br> function url_to_form($url)<br> {<br>&nbsp; $url=split('\?',$url,2);<br>&nbsp; $action=$url[0];<br>&nbsp; $hidden="";<br>&nbsp; if(isset($url[1]))<br>&nbsp; {<br>&nbsp;&nbsp; $pairs=split('&amp;',$url[1]);<br>&nbsp;&nbsp; foreach($pairs as $pair)<br>&nbsp;&nbsp; {<br>&nbsp; &nbsp; $pair=split('=',$pair,2);<br>&nbsp; &nbsp; $name=$pair[0];<br>&nbsp; &nbsp; if(isset($pair[1]))<br>&nbsp; &nbsp;&nbsp; $value=$pair[1];<br>&nbsp; &nbsp; else<br>&nbsp; &nbsp;&nbsp; $value='';<br>&nbsp; &nbsp; $name=$name;<br>&nbsp; &nbsp; $value=htmlspecialchars($value);<br>&nbsp; &nbsp; if($name!='')<br>&nbsp; &nbsp;&nbsp; $hidden.='&lt;hidden name="'.$name.'" value="'.$value.'"&gt;';<br>&nbsp;&nbsp; }<br>&nbsp; }<br>&nbsp; return array('action'=&gt;$action,'hidden'=&gt;$hidden);<br> }<br><br>?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76792">  
  <a class="name">
  <strong class="user"><em>Evan K</em></strong></a><div class="date" title="2007-07-30 07:43"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76792">
<div class="phpcode"><code><span class="html">
It bears mentioning that the parse_str builtin does NOT process a query string in the CGI standard way, when it comes to duplicate fields.&nbsp; If multiple fields of the same name exist in a query string, every other web processing language would read them into an array, but PHP silently overwrites them:<br><br><span class="default">&lt;?php<br></span><span class="comment"># silently fails to handle multiple values<br></span><span class="default">parse_str</span><span class="keyword">(</span><span class="string">'foo=1&amp;foo=2&amp;foo=3'</span><span class="keyword">);<br><br></span><span class="comment"># the above produces:<br></span><span class="default">$foo </span><span class="keyword">= array(</span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="string">'3'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Instead, PHP uses a non-standards compliant practice of including brackets in fieldnames to achieve the same effect.<br><br><span class="default">&lt;?php<br></span><span class="comment"># bizarre php-specific behavior<br></span><span class="default">parse_str</span><span class="keyword">(</span><span class="string">'foo[]=1&amp;foo[]=2&amp;foo[]=3'</span><span class="keyword">);<br><br></span><span class="comment"># the above produces:<br></span><span class="default">$foo </span><span class="keyword">= array(</span><span class="string">'foo' </span><span class="keyword">=&gt; array(</span><span class="string">'1'</span><span class="keyword">, </span><span class="string">'2'</span><span class="keyword">, </span><span class="string">'3'</span><span class="keyword">) );<br></span><span class="default">?&gt;<br></span><br>This can be confusing for anyone who's used to the CGI standard, so keep it in mind.&nbsp; As an alternative, I use a "proper" querystring parser function:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">proper_parse_str</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br>&nbsp; </span><span class="comment"># result array<br>&nbsp; </span><span class="default">$arr </span><span class="keyword">= array();<br><br>&nbsp; </span><span class="comment"># split on outer delimiter<br>&nbsp; </span><span class="default">$pairs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br><br>&nbsp; </span><span class="comment"># loop through each pair<br>&nbsp; </span><span class="keyword">foreach (</span><span class="default">$pairs </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="comment"># split into name and value<br>&nbsp; &nbsp; </span><span class="keyword">list(</span><span class="default">$name</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment"># if name already exists<br>&nbsp; &nbsp; </span><span class="keyword">if( isset(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">]) ) {<br>&nbsp; &nbsp; &nbsp; </span><span class="comment"># stick multiple values into an array<br>&nbsp; &nbsp; &nbsp; </span><span class="keyword">if( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">]) ) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">][] = </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; else {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = array(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">], </span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="comment"># otherwise, simply stick it in a scalar<br>&nbsp; &nbsp; </span><span class="keyword">else {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; }<br><br>&nbsp; </span><span class="comment"># return result array<br>&nbsp; </span><span class="keyword">return </span><span class="default">$arr</span><span class="keyword">;<br>}<br><br></span><span class="default">$query </span><span class="keyword">= </span><span class="default">proper_parse_str</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'QUERY_STRING'</span><span class="keyword">]);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112568">  
  <a class="name">
  <strong class="user"><em>markc</em></strong></a><div class="date" title="2013-06-30 04:43"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112568">
<div class="phpcode"><code><span class="html">
Beware using parse_str in a function that has vars passed by reference. It seems that parse_str actually creates new vars even if vars of the same name exist. If you pass by ref vars of the same name as those in a query string being parsed new LOCAL vers will be created and you won't get any values passed back to the caller (relates to what Maikel mentioned below)<br><br>An unrealistic example (vaguely related to what I was doing when I found this out)...<br><br>function get_title($query,&amp;$title)<br>{<br>&nbsp; parse_str($query);<br>&nbsp; $title=str_replace("_"," ",$title);<br>}<br><br>$title="foo";<br>$query = "context=something&amp;title=Title_of_Something";<br>get_title($query,$title);<br><br>echo $title .... "foo"</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108642">  
  <a class="name">
  <strong class="user"><em>shagshag</em></strong></a><div class="date" title="2012-05-14 05:51"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108642">
<div class="phpcode"><code><span class="html">
That's not says in the description but max_input_vars directive affects this function. If there are more input variables on the string than specified by this directive, an E_WARNING is issued, and further input variables are truncated from the request.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108435">  
  <a class="name">
  <strong class="user"><em>Benjamin Garcia</em></strong></a><div class="date" title="2012-04-26 09:18"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108435">
<div class="phpcode"><code><span class="html">
function like parse_str, but doesn't convert spaces and dots to underscores in $_GET AND $_POST<br><br>/**<br> * GET and POST input containing dots, etc.<br> */<br>function getRealREQUEST() {<br>&nbsp; &nbsp; $vars = array();<br><br>&nbsp; &nbsp; $input&nbsp; &nbsp; = $_SERVER['REDIRECT_QUERY_STRING'];<br>&nbsp; &nbsp; if(!empty($input)){<br>&nbsp; &nbsp; &nbsp; &nbsp; $pairs&nbsp; &nbsp; = explode("&amp;", $input);<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach ($pairs&nbsp; &nbsp;&nbsp; as $pair) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $nv&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = explode("=", $pair);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = urldecode($nv[0]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $nameSanitize&nbsp; &nbsp; = preg_replace('/([^\[]*)\[.*$/','$1',$name);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $nameMatched&nbsp; &nbsp; = str_replace('.','_',$nameSanitize);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $nameMatched&nbsp; &nbsp; = str_replace(' ','_',$nameMatched);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $vars[$nameSanitize]&nbsp; &nbsp; = $_REQUEST[$nameMatched];<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; $input&nbsp; &nbsp; = file_get_contents("php://input");<br>&nbsp; &nbsp; if(!empty($input)){<br>&nbsp; &nbsp; &nbsp; &nbsp; $pairs&nbsp; &nbsp; = explode("&amp;", $input);<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach ($pairs as $pair) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $nv&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = explode("=", $pair);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = urldecode($nv[0]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $nameSanitize&nbsp; &nbsp; = preg_replace('/([^\[]*)\[.*$/','$1',$name);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $nameMatched&nbsp; &nbsp; = str_replace('.','_',$nameSanitize);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $nameMatched&nbsp; &nbsp; = str_replace(' ','_',$nameMatched);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $vars[$nameSanitize]&nbsp; &nbsp; = $_REQUEST[$nameMatched];<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; return $vars;<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98652">  
  <a class="name">
  <strong class="user"><em>sam dot fullman at verizon dot net</em></strong></a><div class="date" title="2010-06-29 01:28"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98652">
<div class="phpcode"><code><span class="html">
If you're using .htaccess to spoof pages in any type of application, then $QUERY_STRING or $_SERVER['QUERY_STRING'] is going to be blank.&nbsp; Instead, $_SERVER['REDIRECT_QUERY_STRING'] will hold the actual query string passed by user.&nbsp; Use this function to parse this variable.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84165">  
  <a class="name">
  <strong class="user"><em>tobsn at php dot net</em></strong></a><div class="date" title="2008-07-01 11:17"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84165">
<div class="phpcode"><code><span class="html">
just a heads up with the example above:<br>?var[]=123 - the [] has to be urlencoded.<br>var names and var values - both have to be urlencoded!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78882">  
  <a class="name">
  <strong class="user"><em>chris at mcfadyen dot ca</em></strong></a><div class="date" title="2007-10-31 08:48"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78882">
<div class="phpcode"><code><span class="html">
If you wish a version of parse_str sans magic quotes, the following will do the trick:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">parse_query</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$pairs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br><br>&nbsp; &nbsp; foreach(</span><span class="default">$pairs </span><span class="keyword">as </span><span class="default">$pair</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; list(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">$pair</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; global $</span><span class="default">$name</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="default">$name </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76481">  
  <a class="name">
  <strong class="user"><em>Vladimir Kornea</em></strong></a><div class="date" title="2007-07-17 09:04"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76481">
<div class="phpcode"><code><span class="html">
parse_str() is confused by ampersands (&amp;) being encoded as HTML entities (&amp;amp;). This is relevant if you're extracting your query string from an HTML page (scraping). The solution is to run the string through html_entity_decode() before running it through parse_str().<br><br>(Editors: my original comment was a caution whose solution is obvious, but it has resulted in three replies ("so what?" "as intended" and "this is how to fix it"). Please remove the previous four posts dealing with this (69529, 70234, 72745, 74818) and leave just the above summary. This issue is too trivial to warrant the number of comments it has received.)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76477">  
  <a class="name">
  <strong class="user"><em>Vladimir Kornea</em></strong></a><div class="date" title="2007-07-17 08:46"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76477">
<div class="phpcode"><code><span class="html">
parse_str() contained a bug (#39763) in PHP 5.2.0 that caused it to apply magic quotes twice. This bug was marked as fixed in the release notes of PHP 5.2.1, but there were apparently some issues with getting the fix through CVS on time, as our install of PHP 5.2.1 was still affected by it.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="75505">  
  <a class="name">
  <strong class="user"><em>mike dot coley at inbox dot com</em></strong></a><div class="date" title="2007-06-02 12:25"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom75505">
<div class="phpcode"><code><span class="html">
Here is a little function that does the opposite of the parse_str function. It will take an array and build a query string from it.<br><br><span class="default">&lt;?php<br><br></span><span class="comment">/* Converts an array of parameters into a query string to be appended to a URL.<br> *<br> * @return&nbsp; string&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : Query string to append to a URL.<br> * @param&nbsp;&nbsp; array&nbsp; &nbsp; $array&nbsp; &nbsp;&nbsp; : Array of parameters to append to the query string.<br> * @param&nbsp;&nbsp; string&nbsp;&nbsp; $parent&nbsp; &nbsp; : This should be left blank (it is used internally by the function).<br> */<br></span><span class="keyword">function </span><span class="default">append_params</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$parent</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$params </span><span class="keyword">= array();<br>&nbsp; &nbsp; foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$params</span><span class="keyword">[] = </span><span class="default">append_params</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">, (empty(</span><span class="default">$parent</span><span class="keyword">) ? </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">) : </span><span class="default">$parent </span><span class="keyword">. </span><span class="string">'[' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">) . </span><span class="string">']'</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$params</span><span class="keyword">[] = (!empty(</span><span class="default">$parent</span><span class="keyword">) ? </span><span class="default">$parent </span><span class="keyword">. </span><span class="string">'[' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">) . </span><span class="string">']' </span><span class="keyword">: </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">)) . </span><span class="string">'=' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">);<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="default">$sessid </span><span class="keyword">= </span><span class="default">session_id</span><span class="keyword">();<br>&nbsp; &nbsp; if (!empty(</span><span class="default">$parent</span><span class="keyword">) || empty(</span><span class="default">$sessid</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="comment">// Append the session ID to the query string if we have to.<br>&nbsp; &nbsp; </span><span class="default">$sessname </span><span class="keyword">= </span><span class="default">session_name</span><span class="keyword">();<br>&nbsp; &nbsp; if (</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'session.use_cookies'</span><span class="keyword">))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'session.use_only_cookies'</span><span class="keyword">) &amp;&amp; (!isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$sessname</span><span class="keyword">]) || (</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$sessname</span><span class="keyword">] != </span><span class="default">$sessid</span><span class="keyword">)))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$params</span><span class="keyword">[] = </span><span class="default">$sessname </span><span class="keyword">. </span><span class="string">'=' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$sessid</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; elseif (!</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'session.use_only_cookies'</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$params</span><span class="keyword">[] = </span><span class="default">$sessname </span><span class="keyword">. </span><span class="string">'=' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$sessid</span><span class="keyword">);<br><br>&nbsp; &nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">);<br>}<br><br></span><span class="default">?&gt;<br></span><br>Note that the function will also append the session ID to the query string if it needs to be.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73719">  
  <a class="name">
  <strong class="user"><em>php at voodoolabs dot net</em></strong></a><div class="date" title="2007-03-07 12:32"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73719">
<div class="phpcode"><code><span class="html">
This is probably a better solution than below. The first line makes sure the file doesn't exist then the second line directs all requests to a script. No need to output a 200 header with this method either.<br><br>RewriteEngine On<br><br>RewriteCond %{REQUEST_FILENAME} !-f<br>RewriteRule ^ index.php&nbsp; &nbsp; &nbsp; [L]</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73151">  
  <a class="name">
  <strong class="user"><em>lenix.de</em></strong></a><div class="date" title="2007-02-10 04:20"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73151">
<div class="phpcode"><code><span class="html">
if you would like to get a nice url scheme with php/apache and and want to handle all requests in a central php script there's a simple solution/hack:<br><br>create a .htaccess in your "basedir" where you've got your main script (in this example index.php) containing some lines like:<br><br>"ErrorDocument 404 /index.php"<br><br>inside index.php you can now do<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; $virtual_path </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REQUEST_URI'</span><span class="keyword">],<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">strlen</span><span class="keyword">( </span><span class="default">dirname</span><span class="keyword">( </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">] ) ) + </span><span class="default">1<br>&nbsp; &nbsp; </span><span class="keyword">);<br>&nbsp; &nbsp; if( (</span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$virtual_path</span><span class="keyword">, </span><span class="string">'?' </span><span class="keyword">)) !== </span><span class="default">false </span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">parse_str</span><span class="keyword">( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$virtual_path</span><span class="keyword">, </span><span class="default">$pos </span><span class="keyword">+ </span><span class="default">1 </span><span class="keyword">), </span><span class="default">$_GET </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$_REQUEST </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">( </span><span class="default">$_REQUEST</span><span class="keyword">, </span><span class="default">$_GET </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$virtual_path </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$virtual_path</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$pos </span><span class="keyword">);<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="comment">// some code checking for a valid location, etc...<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">( </span><span class="string">'HTTP/1.1 200 OK' </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">( </span><span class="string">'Content-Type: text/plain' </span><span class="keyword">);<br><br>&nbsp; &nbsp; echo </span><span class="default">$virtual_path</span><span class="keyword">.</span><span class="string">"\n\n"</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$_REQUEST </span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>// guido 'lenix' boehm</span>
</code></div>
  </div>
 </div>
  <div class="note" id="72745">  
  <a class="name">
  <strong class="user"><em>jgbreezer at gmail dot com</em></strong></a><div class="date" title="2007-01-31 04:52"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom72745">
<div class="phpcode"><code><span class="html">
Vladimir Kornea wrote on 8 Sep 2006:<br>"This function is confused by ampersands (&amp;) being encoded as HTML entities (&amp;amp;)"<br><br>Well, it would be - it's not supposed to be passed html entities, that's a different encoding scheme. This function does correctly decode url encoded params for you though (with the rawurlencode rather than urlencode, ie '+' is translated to a space).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="69529">  
  <a class="name">
  <strong class="user"><em>Vladimir Kornea</em></strong></a><div class="date" title="2006-09-08 02:15"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom69529">
<div class="phpcode"><code><span class="html">
This function is confused by ampersands (&amp;) being encoded as HTML entities (&amp;amp;).<br><br>$str = "first=value&amp;amp;arr[]=foo+bar&amp;amp;arr[]=baz";<br>parse_str($str, $output);<br>print_r($output);<br><br>Array<br>(<br>&nbsp; &nbsp; [first] =&gt; value<br>&nbsp; &nbsp; [amp;arr] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; foo bar<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; baz<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br>)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="64472">  
  <a class="name">
  <strong class="user"><em>motin at demomusic dot nu</em></strong></a><div class="date" title="2006-04-14 06:13"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom64472">
<div class="phpcode"><code><span class="html">
When you have scripts run through the command-line (like locally via cron), you might want to be able to use _GET and _POST vars. Put this in top of your scheduled task files:<br><br>&lt;?<br>&nbsp; &nbsp; parse_str ($_SERVER['argv'][1], $GLOBALS['_GET']);<br>&nbsp; &nbsp; parse_str ($_SERVER['argv'][2], $GLOBALS['_POST']);<br>?&gt;<br><br>And call your script by:<br><br>/usr/local/bin/php /path/to/script.php "id=45&amp;action=delete" "formsubmitted=true"<br><br>Cheers!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53346">  
  <a class="name">
  <strong class="user"><em>kerosuppi</em></strong></a><div class="date" title="2005-05-29 09:22"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom53346">
<div class="phpcode"><code><span class="html">
This does not work as expected.<br><br><span class="default">&lt;?php<br></span><span class="keyword">class </span><span class="default">someclass<br></span><span class="keyword">{<br>&nbsp; &nbsp; var </span><span class="default">$query_string</span><span class="keyword">;<br>&nbsp; &nbsp; function </span><span class="default">someclass</span><span class="keyword">(</span><span class="default">$a_query_string</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">query_string </span><span class="keyword">= </span><span class="default">$a_query_string</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">parse_str</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">query_string</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; function </span><span class="default">output</span><span class="keyword">()<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">action</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>}<br><br></span><span class="default">$a_class </span><span class="keyword">= new </span><span class="default">someclass</span><span class="keyword">(</span><span class="string">"action=go"</span><span class="keyword">);<br></span><span class="default">$a_class</span><span class="keyword">-&gt;</span><span class="default">output</span><span class="keyword">();<br></span><span class="default">?&gt;<br></span><br>Use this instead.<br><br><span class="default">&lt;?php<br></span><span class="keyword">class </span><span class="default">someclass<br></span><span class="keyword">{<br>&nbsp; &nbsp; var </span><span class="default">$arr</span><span class="keyword">;<br>&nbsp; &nbsp; function </span><span class="default">someclass</span><span class="keyword">(</span><span class="default">$a_query_string</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">parse_str</span><span class="keyword">(</span><span class="default">$a_query_string</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arr</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; function </span><span class="default">output</span><span class="keyword">()<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arr</span><span class="keyword">[</span><span class="string">'action'</span><span class="keyword">];<br>&nbsp; &nbsp; }<br>}<br><br></span><span class="default">$a_class </span><span class="keyword">= new </span><span class="default">someclass</span><span class="keyword">(</span><span class="string">"action=go"</span><span class="keyword">);<br></span><span class="default">$a_class</span><span class="keyword">-&gt;</span><span class="default">output</span><span class="keyword">();<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53175">  
  <a class="name">
  <strong class="user"><em>mortoray at ecircle-ag dot com</em></strong></a><div class="date" title="2005-05-25 12:18"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom53175">
<div class="phpcode"><code><span class="html">
In Kent's solution you may wish to switch "urldecode" into "rawurldecode" if you'd like to get rid of the [annoying] plus '+' converted to space ' ' translation.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="52588">  
  <a class="name">
  <strong class="user"><em>kent at nospam dot ioflux dot com</em></strong></a><div class="date" title="2005-05-06 08:13"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom52588">
<div class="phpcode"><code><span class="html">
You may want to parse the query string into an array. <br><br><span class="default">&lt;?php<br></span><span class="comment">/**<br> * Similar to parse_str. Returns false if the query string or URL is empty. Because we're not parsing to <br> * variables but to array key entries, this function will handle ?[]=1&amp;[]=2 "correctly."<br> *<br> * @return array Similar to the $_GET formatting that PHP does automagically.<br> * @param string $url A query string or URL <br> * @param boolean $qmark Find and strip out everything before the question mark in the string<br>*/<br></span><span class="keyword">function </span><span class="default">parse_query_string</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$qmark</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; if (</span><span class="default">$qmark</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="string">"?"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$pos </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$pos </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; if (empty(</span><span class="default">$url</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$tokens </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"&amp;"</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$urlVars </span><span class="keyword">= array();<br>&nbsp; &nbsp; foreach (</span><span class="default">$tokens </span><span class="keyword">as </span><span class="default">$token</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">string_pair</span><span class="keyword">(</span><span class="default">$token</span><span class="keyword">, </span><span class="string">"="</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^([^\[]*)(\[.*\])$/'</span><span class="keyword">, </span><span class="default">$token</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">parse_query_string_array</span><span class="keyword">(</span><span class="default">$urlVars</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">], </span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$urlVars</span><span class="keyword">[</span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$token</span><span class="keyword">)] = </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$urlVars</span><span class="keyword">;<br>}<br><br></span><span class="comment">/**<br> * Utility function for parse_query_string. Given a result array, a starting key, and a set of keys formatted like "[a][b][c]" <br> * and the final value, updates the result array with the correct PHP array keys.<br> *<br> * @return void<br> * @param array $result A result array to populate from the query string<br> * @param string $k The starting key to populate in $result<br> * @param string $arrayKeys The key list to parse in the form "[][a][what%20ever]"<br> * @param string $value The value to place at the destination array key<br>*/<br></span><span class="keyword">function </span><span class="default">parse_query_string_array</span><span class="keyword">(&amp;</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$k</span><span class="keyword">, </span><span class="default">$arrayKeys</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; if (!</span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">'/\[([^\]]*)\]/'</span><span class="keyword">, </span><span class="default">$arrayKeys</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; if (!isset(</span><span class="default">$result</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">)] = array();<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">$temp </span><span class="keyword">=&amp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">];<br>&nbsp; &nbsp; </span><span class="default">$last </span><span class="keyword">= </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]));<br>&nbsp; &nbsp; foreach (</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] as </span><span class="default">$k</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$k </span><span class="keyword">= </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$k </span><span class="keyword">=== </span><span class="string">""</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$temp</span><span class="keyword">[] = array();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$temp </span><span class="keyword">=&amp; </span><span class="default">$temp</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if (!isset(</span><span class="default">$temp</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$temp</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = array();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$temp </span><span class="keyword">=&amp; </span><span class="default">$temp</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; if (</span><span class="default">$last </span><span class="keyword">=== </span><span class="string">""</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$temp</span><span class="keyword">[] = </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$temp</span><span class="keyword">[</span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$last</span><span class="keyword">)] = </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>}<br><br></span><span class="comment">/**<br>* Breaks a string into a pair for a common parsing function. <br>*<br>* The string passed in is truncated to the left half of the string pair, if any, and the right half, if anything, is returned.<br>*<br>* An example of using this would be:<br>* &lt;code&gt;<br>* $path = "Account.Balance";<br>* $field = string_pair($path);<br>* <br>* $path is "Account"<br>* $field is "Balance"<br>*<br>* $path = "Account";<br>* $field = string_pair($path);<br>*<br>* $path is "Account"<br>* $field is false<br>* &lt;/code&gt;<br>*<br>* @return string The "right" portion of the string is returned if the delimiter is found.<br>* @param string $a A string to break into a pair. The "left" portion of the string is returned here if the delimiter is found.<br>* @param string $delim The characters used to delimit a string pair<br>* @param mixed $default The value to return if the delimiter is not found in the string<br>* @desc <br>*/<br></span><span class="keyword">function </span><span class="default">string_pair</span><span class="keyword">(&amp;</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$delim</span><span class="keyword">=</span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$default</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$delim</span><span class="keyword">);<br>&nbsp; &nbsp; if (</span><span class="default">$n </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$default</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$n</span><span class="keyword">+</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$delim</span><span class="keyword">));<br>&nbsp; &nbsp; </span><span class="default">$a </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$n</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">$result</span><span class="keyword">;<br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="45493">  
  <a class="name">
  <strong class="user"><em>Matt Curtis</em></strong></a><div class="date" title="2004-09-08 08:46"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom45493">
<div class="phpcode"><code><span class="html">
If the querystring contains duplicate keys in the key-value pairs, parse_str will only return the last instance of the value.&nbsp; For example, in the following:<br><br><span class="default">&lt;?php<br>$mystr </span><span class="keyword">= </span><span class="string">"test1=blah&amp;test2=bleh&amp;test1=burp"</span><span class="keyword">;<br></span><span class="default">parse_str</span><span class="keyword">(</span><span class="default">$mystr</span><span class="keyword">, </span><span class="default">$myarray</span><span class="keyword">);<br>echo </span><span class="default">$myarray</span><span class="keyword">[</span><span class="string">'test1'</span><span class="keyword">];<br></span><span class="default">?&gt;<br></span>The value output will be 'burp'.&nbsp; <br><br>I wrote a function that takes a querystring and returns the the key-value pairs as a two-dimensional array so each duplicate key is available:<br><br><span class="default">&lt;?php<br>$str </span><span class="keyword">= </span><span class="string">"test1=blah&amp;test2=bleh&amp;test1=burp"</span><span class="keyword">;<br></span><span class="default">$valsarray </span><span class="keyword">= </span><span class="default">parse_str_ext</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br>echo </span><span class="default">$valsarray</span><span class="keyword">[</span><span class="string">'test1'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">];<br>echo </span><span class="default">$valsarray</span><span class="keyword">[</span><span class="string">'test1'</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">];<br>echo </span><span class="default">$valsarray</span><span class="keyword">[</span><span class="string">'test2'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">];<br><br>function </span><span class="default">parse_str_ext</span><span class="keyword">(</span><span class="default">$toparse</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$returnarray </span><span class="keyword">= array();<br>&nbsp; &nbsp; </span><span class="default">$keyvaluepairs </span><span class="keyword">= </span><span class="default">split</span><span class="keyword">(</span><span class="string">"&amp;"</span><span class="keyword">, </span><span class="default">$toparse</span><span class="keyword">);<br>&nbsp; &nbsp; foreach(</span><span class="default">$keyvaluepairs </span><span class="keyword">as </span><span class="default">$pairval</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$splitpair </span><span class="keyword">= </span><span class="default">split</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$pairval</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$splitpair</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$returnarray</span><span class="keyword">)) </span><span class="default">$returnarray</span><span class="keyword">[</span><span class="default">$splitpair</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = array();<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$returnarray</span><span class="keyword">[</span><span class="default">$splitpair</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]][] = </span><span class="default">$splitpair</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$returnarray</span><span class="keyword">;&nbsp; &nbsp; <br>}<br></span><span class="default">?&gt;<br></span><br>Output will be:<br>blah<br>burp<br>bleh</span>
</code></div>
  </div>
 </div>
  <div class="note" id="43317">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2004-06-17 05:23"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom43317">
<div class="phpcode"><code><span class="html">
Note that variables cannot contain a DOT (.) in PHP. So, DOT will be replaced by underscore. <br>e.g. variables like "variable.something" will be converted into "variable_something".</span>
</code></div>
  </div>
 </div>
  <div class="note" id="41143">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2004-03-31 10:58"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom41143">
<div class="phpcode"><code><span class="html">
The documentation does not appear to mention that parse_str also urldecodes each item in the resulting array.<br><br>There also appears to be a bug in earlier versions of PHP that causes these urldecoded strings to also be escaped.&nbsp; (Certainly I was having problems with %22 being turned into /" on my server, but not on my development box, despite forcing magic quotes off).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74818">  
  <a class="name">
  <strong class="user"><em>Michal Zalewski</em></strong></a><div class="date" title="2007-04-28 11:27"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74818">
<div class="phpcode"><code><span class="html">
Vladimir Kornea:<br>Try use html_entity_decode()<br><br>$str = 'first=value&amp;amp;arr[]=foo+bar&amp;amp;arr[]=baz';<br>parse_str(html_entity_decode($str), $output);<br>print_r($output);<br><br>Array<br>(<br>&nbsp; &nbsp; [first] =&gt; value<br>&nbsp; &nbsp; [arr] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; foo bar<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; baz<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br><br>)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99364">  
  <a class="name">
  <strong class="user"><em>Will Voelcker</em></strong></a><div class="date" title="2010-08-12 11:07"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom99364">
<div class="phpcode"><code><span class="html">
If you need a function that does something similar to parse_str, but doesn't convert spaces and dots to underscores, try something like the following:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">parseQueryString</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$op </span><span class="keyword">= array();
<br>&nbsp; &nbsp; </span><span class="default">$pairs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"&amp;"</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);
<br>&nbsp; &nbsp; foreach (</span><span class="default">$pairs </span><span class="keyword">as </span><span class="default">$pair</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; list(</span><span class="default">$k</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">) = </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">"urldecode"</span><span class="keyword">, </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$pair</span><span class="keyword">));
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$op</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$v</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; return </span><span class="default">$op</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>It may need adapting to handle various edge cases.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.parse-str.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:51:16 GMT -->


</body></html>