<html><!-- Mirrored from php.net/manual/en/function.odbc-execute.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:02:52 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>odbc_execute</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.odbc-execute.html">
 <link rel="shorturl" href="http://php.net/odbc-execute">
 <link rel="alternate" href="http://php.net/odbc-execute" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.uodbc.html">
 <link rel="prev" href="function.odbc-exec.html">
 <link rel="next" href="function.odbc-fetch-array.html">

 <link rel="alternate" href="function.odbc-execute.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.odbc-execute.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.odbc-execute.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.odbc-execute.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.odbc-execute.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.odbc-execute.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.odbc-execute.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.odbc-execute.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.odbc-execute.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.odbc-execute.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.odbc-execute.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.abstract.html">Abstraction Layers</a></li>      <li><a href="book.uodbc.html">ODBC</a></li>      <li><a href="ref.uodbc.html">ODBC Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.odbc-execute" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">odbc_execute</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">odbc_execute</span> â€” <span class="dc-title">Execute a prepared statement</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.odbc-execute-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>odbc_execute</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result_id</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$parameters_array</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   Executes a statement prepared with <span class="function"><a href="function.odbc-prepare.html" class="function">odbc_prepare()</a></span>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.odbc-execute-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">result_id</code></dt>

     <dd>

      <p class="para">
       The result id <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>, from <span class="function"><a href="function.odbc-prepare.html" class="function">odbc_prepare()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">parameters_array</code></dt>

     <dd>

      <p class="para">
       Parameters in <code class="parameter">parameter_array</code> will be
       substituted for placeholders in the prepared statement in order.
       Elements of this array will be converted to strings by calling this
       function.
      </p>
      <p class="para">
       Any parameters in <code class="parameter">parameter_array</code> which
       start and end with single quotes will be taken as the name of a
       file to read and send to the database server as the data for the
       appropriate placeholder.
      </p>
      <span class="simpara">
       If you wish to store a string which actually begins and ends with
       single quotes, you must add a space or other non-single-quote character
       to the beginning or end of the parameter, which will prevent the
       parameter from being taken as a file name. If this is not an option,
       then you must use another mechanism to store the string, such as
       executing the query directly with <span class="function"><a href="function.odbc-exec.html" class="function">odbc_exec()</a></span>).
      </span>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.odbc-execute-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <strong><code>TRUE</code></strong> on success or <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.odbc-execute-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-940">
    <p><strong>Example #1 <span class="function"><strong>odbc_execute()</strong></span> and <span class="function"><a href="function.odbc-prepare.html" class="function">odbc_prepare()</a></span> example</strong></p>
    <div class="example-contents"><p>
     In the following code, <var class="varname"><var class="varname">$success</var></var> will only be
     <strong><code>TRUE</code></strong> if all three parameters to myproc are IN parameters:
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$b&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$c&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$stmt&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">odbc_prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'CALL&nbsp;myproc(?,?,?)'</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$success&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">odbc_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$b</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$c</span><span style="color: #007700">));<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
  <p class="para">
   If you need to call a stored procedure using INOUT or OUT parameters,
   the recommended workaround is to use a native extension for your database
   (for example, <a href="ref.mssql.html" class="link">mssql</a> for MS SQL Server,
   or <a href="ref.mssql.html" class="link">oci8</a> for Oracle).
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.odbc-execute-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   </p><table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>4.2.0</td>
       <td>
        File reading is now subject to <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe mode</a> and
        <a href="ini.core.html#ini.open-basedir" class="link">open-basedir</a> restrictions
        in <code class="parameter">parameters_array</code>.
       </td>
      </tr>

     </tbody>
    
   </table>

  <p></p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.odbc-execute-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.odbc-prepare.html" class="function" rel="rdfs-seeAlso">odbc_prepare()</a> - Prepares a statement for execution</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="63645">  
  <a class="name">
  <strong class="user"><em>mjs at beebo dot org</em></strong></a><div class="date" title="2006-03-27 01:57"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom63645">
<div class="phpcode"><code><span class="html">
Don't miss the part where it says that if your string starts and ends with a single quote, the string is interpreted as a filename!<br><br>This means that you can't do:<br><br>$sth = odbc_prepare($dbh, "INSERT INTO people(name) VALUES(?)");<br>$res = odbc_execute($sth, array($name));<br><br>without checking the value of $name--if $name is, say, '\\'c:\\passwords.txt\\'' the contents of c:\\passwords.txt get inserted into your database as a "name".<br><br>Also, despite what the documentation suggests, there (incredibly) doesn't appear to be any way to escape your single quotes (via experimentation, and from reading the source): if your string starts and ends with a single quote you cannot use odbc_execute to insert it into the database.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110472">  
  <a class="name">
  <strong class="user"><em>Marco Napetti</em></strong></a><div class="date" title="2012-10-25 10:18"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom110472">
<div class="phpcode"><code><span class="html">
To use prepared with select queries, the right way is:<br><span class="default">&lt;?PHP<br><br>$rConnection </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="string">'AS400'</span><span class="keyword">, </span><span class="string">'QSECOFR'</span><span class="keyword">, </span><span class="string">'QSECOFR'</span><span class="keyword">);<br>if(</span><span class="default">$rConnection </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br>&nbsp; &nbsp; throw new </span><span class="default">ErrorException</span><span class="keyword">(</span><span class="default">odbc_errormsg</span><span class="keyword">());<br>}<br><br></span><span class="default">$rResult </span><span class="keyword">= </span><span class="default">odbc_prepare</span><span class="keyword">(</span><span class="default">$rConnection</span><span class="keyword">, </span><span class="string">'SELECT * FROM KMNSH00F WHERE SHTMST &gt; ?'</span><span class="keyword">);<br>if(</span><span class="default">$rResult </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br>&nbsp; &nbsp; throw new </span><span class="default">ErrorException</span><span class="keyword">(</span><span class="default">odbc_errormsg</span><span class="keyword">());<br>}<br><br>if(</span><span class="default">odbc_execute</span><span class="keyword">(</span><span class="default">$rResult</span><span class="keyword">, array(</span><span class="string">'0001-01-01 00:00:00.000000'</span><span class="keyword">)) === </span><span class="default">false</span><span class="keyword">) {<br>&nbsp; &nbsp; throw new </span><span class="default">ErrorException</span><span class="keyword">(</span><span class="default">odbc_errormsg</span><span class="keyword">());<br>}<br><br></span><span class="default">odbc_result_all</span><span class="keyword">(</span><span class="default">$rResult</span><span class="keyword">);<br><br></span><span class="default">odbc_free_result</span><span class="keyword">(</span><span class="default">$rResult</span><span class="keyword">);<br><br></span><span class="default">odbc_close</span><span class="keyword">(</span><span class="default">$rConnection</span><span class="keyword">);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="16694">  
  <a class="name">
  <strong class="user"><em>tcmleung at yahoo dot com</em></strong></a><div class="date" title="2001-11-09 01:22"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom16694">
<div class="phpcode"><code><span class="html">
odbc has a maximum buffer size, that means it only stores and retrieves a limited size of data to/from database each time. The maximum buffer size is 4096 and set in php.ini (odbc.defaultlrl). You can set it to higher value for larger data access.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="15058">  
  <a class="name">
  <strong class="user"><em>sjericson at mindspring dot com</em></strong></a><div class="date" title="2001-08-25 10:43"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom15058">
<div class="phpcode"><code><span class="html">
I don't think odbc_prepare and odbc_execute support output parameters for stored procedures on MSSQL.&nbsp; An example of output parameters for MSSQL is at&nbsp; <a rel="nofollow" target="_blank">http://support.microsoft.com/support/kb/articles/q174/2/23.asp</a>
<br>
<br>Also, my MSSQL driver seems happy only when I use the following incantation:
<br>
<br>...code removed...
<br>$stmt=odbc_prepare($conn_id, "exec my_proc_name ?,?,?"); 
<br>$parms=array("fred","password",5);
<br>if (!odbc_execute($stmt, &amp;$parms)) die("odbc_execute failed");</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106953">  
  <a class="name">
  <strong class="user"><em>alvaro at demogracia dot com</em></strong></a><div class="date" title="2011-12-20 05:16"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom106953">
<div class="phpcode"><code><span class="html">
When odbc_execute() fails it returns FALSE and triggers a warning but it will not necessarily feed odbc_error() and odbc_errormsg().</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90595">  
  <a class="name">
  <strong class="user"><em>anonymous</em></strong></a><div class="date" title="2009-04-29 11:32"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90595">
<div class="phpcode"><code><span class="html">
if you can't use php_mssql module in your environment (suse linux, apache2, php5, FreeTDS, unixODBC) an alternative is to use sql server functions instead of procedures. here is my sample code.
<br>
<br><span class="default">&lt;?php
<br>&nbsp; $connect&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="default">$myDB</span><span class="keyword">, </span><span class="default">$myUser</span><span class="keyword">, </span><span class="default">$myPass</span><span class="keyword">);
<br>
<br>&nbsp; </span><span class="default">$query </span><span class="keyword">= </span><span class="string">"SELECT dbo.&lt;function&gt;(&lt;column&gt;,&lt;text&gt;) alias"</span><span class="keyword">;
<br>
<br>&nbsp; </span><span class="comment">// perform the query
<br>&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">odbc_exec</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">$query</span><span class="keyword">);
<br>
<br>&nbsp; while(</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)) {
<br>&nbsp; &nbsp; </span><span class="default">$Var1&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, &lt;</span><span class="default">column alias</span><span class="keyword">&gt;);
<br>&nbsp; &nbsp; </span><span class="comment">//echo "Var1: " . $Var1 . "&lt;br&gt;";
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; // add additional logic
<br>
<br>&nbsp; </span><span class="keyword">}
<br></span><span class="default">?&gt;
<br></span>
<br>Once I figured this out, my app worked perfectly.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83645">  
  <a class="name">
  <strong class="user"><em>jeroen at pyromanic dot nl</em></strong></a><div class="date" title="2008-06-05 01:05"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83645">
<div class="phpcode"><code><span class="html">
If you want to use stored procedures with MSSQL over ODBC, please read <br><br><a rel="nofollow" target="_blank">http://www.sitepoint.com/article/php-microsoft-sql-server/2</a><br><br>It can you save lots of time ;)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="79058">  
  <a class="name">
  <strong class="user"><em>traynor at uni hyphen hannover dot de</em></strong></a><div class="date" title="2007-11-08 06:09"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom79058">
<div class="phpcode"><code><span class="html">
Obdc_prepare and obdc_execute can only be used as an alternative to odbc_exec in limited circumstances:<br><br>$con = obdc_connect ($dsn, $user, $pass);<br>$sql = "select * from TABLE";<br><br>$result = obdc_exec ($con, $sql); //this line can be replaced as blow<br>//then to see results:<br><br>odbc_result_all ($result);<br>odbc_free_result ($result);<br>odbc_close ($con);<br><br>gives the same result with the middle line as:<br><br>$result = odbc_prepare ($con, $sql);<br>odbc_execute ($result);<br><br>as long as $sql contains a well formed and complete query.<br><br>There is no point in trying to convert this into a parameter query with question marks as placeholders, since code like this will result only in error messages:<br><br>$sql = "select * from TABLE where needle = ?";<br>$result = odbc_prepare ($con, $sql);<br>for ($i = 0; $i &lt; 4; $i++)<br>{<br>&nbsp; odbc_execute ($result, array ($i));<br>&nbsp; // and whatever you want to do with the result<br>&nbsp; // but all you get is "parameter expected" or "count does not match"<br>}<br><br>The lack of documentation for such functions should have been an alarm signal.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="69134">  
  <a class="name">
  <strong class="user"><em>a dot brock at hhv-rheinklang dot de</em></strong></a><div class="date" title="2006-08-24 04:38"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom69134">
<div class="phpcode"><code><span class="html">
I have a solution for the problem with the strings beeing interpreted as filename because of the single quotes:<br><br>Just add a blank to the end of the string:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">odbc_escape_params </span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">) {<br> if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">) or empty(</span><span class="default">$params</span><span class="keyword">)) {<br>&nbsp; return array();<br> }<br> foreach (</span><span class="default">$params </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">) {<br>&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) &gt; </span><span class="default">1 </span><span class="keyword">and </span><span class="default">$val</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">"'" </span><span class="keyword">and </span><span class="default">$val</span><span class="keyword">{</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">} == </span><span class="string">"'"</span><span class="keyword">) {<br>&nbsp;&nbsp; </span><span class="default">$params</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] .= </span><span class="string">' '</span><span class="keyword">;<br>&nbsp; }<br> }<br> return </span><span class="default">$params</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="39749">  
  <a class="name">
  <strong class="user"><em>russell dot brown at removethis dot insignia dot com</em></strong></a><div class="date" title="2004-02-09 12:55"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom39749">
<div class="phpcode"><code><span class="html">
In reply to tcmleung at yahoo dot com (09-Nov-2001), I would add a caveat that I've found, which is that the odbc.defaultlrl/odbc_longreadlen() values may only apply to odbc-&gt;php conversion and not php-&gt;odbc (though this may be database-specific). Hence, if you want to post binary data the 4096 byte limit still stands. So you stand a better chance of being able to post binary data using the quoted filename upload procedure described above, rather than using the prepare... execute method with data held in a php variable.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="24979">  
  <a class="name">
  <strong class="user"><em>svemir_AT_baltok.com</em></strong></a><div class="date" title="2002-09-06 10:45"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom24979">
<div class="phpcode"><code><span class="html">
In reply to cpoirier's note from 04-Mar-2001 03:30:<br><br>Currently, Access 2000 DOES support parametrized queries via ODBC. It still seems to have a problem with Memo and OLE fields, but "normal" types work just fine.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="14243">  
  <a class="name">
  <strong class="user"><em>reaganpr at hotmail dot com</em></strong></a><div class="date" title="2001-07-23 04:50"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom14243">
<div class="phpcode"><code><span class="html">
When running the CGI version of 4.0.6 under windows, I came across this error when trying to call a stored procedure in SQL Server using odbc_execute w/ the parameter array set:
<br>
<br>FATAL:&nbsp; emalloc():&nbsp; Unable to allocate 268675669 bytes
<br>
<br>Scary error, huh? In my case it just meant that SQL Server couldn't find the stored procedure.&nbsp; Totally my fault, but a rather nondescript error message.
<br>
<br>p.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="11722">  
  <a class="name">
  <strong class="user"><em>cpoirier at shelluser dot net</em></strong></a><div class="date" title="2001-03-04 02:30"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom11722">
<div class="phpcode"><code><span class="html">
A quick note in hopes that my pain will save someone else:&nbsp; Microsoft Access ODBC drivers do not support parameterized queries.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="9110">  
  <a class="name">
  <strong class="user"><em>edrenth at thematec dot nl</em></strong></a><div class="date" title="2000-10-17 06:17"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom9110">
<div class="phpcode"><code><span class="html">
When used with parameters and the statement fails, you cannot use different arguments anymore, the same arguments as with the failed statement will be used.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="911">  
  <a class="name">
  <strong class="user"><em>tony dot wood at revolutionltd dot com</em></strong></a><div class="date" title="1999-05-27 04:08"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom911">
<div class="phpcode"><code><span class="html">
For a simple database insert to a database that has no password and $from and $to are predefined variables.
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">/* get connection */
<br></span><span class="default">$conn</span><span class="keyword">=</span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="string">"mydb"</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">);
<br>
<br></span><span class="comment">/* run insert */
<br></span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">odbc_prepare</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="string">"INSERT INTO mytable (jor_from, jor_to) VALUES('</span><span class="default">$from</span><span class="string">', '</span><span class="default">$to</span><span class="string">');" </span><span class="keyword">);
<br>
<br></span><span class="comment">/* check for errors */
<br></span><span class="keyword">if (!</span><span class="default">odbc_execute</span><span class="keyword">(</span><span class="default">$stmt</span><span class="keyword">)) {
<br>&nbsp; &nbsp; </span><span class="comment">/* error&nbsp; */
<br>&nbsp; &nbsp; </span><span class="keyword">echo </span><span class="string">"Whoops"</span><span class="keyword">;
<br>}
<br>
<br></span><span class="comment">/* close connection */
<br></span><span class="default">odbc_close</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115">  
  <a class="name">
  <strong class="user"><em>wntrmute at tampabay dot rr dot com</em></strong></a><div class="date" title="1998-08-15 09:22"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom115">
<div class="phpcode"><code><span class="html">
Solid Issue:
<br>Solid defines CHAR, VARCHAR, LONG VARCHAR, BINARY, VARBINARY, and LONG VARBINARY to be a maximum of 2G in length.&nbsp; However, when creating your tables for use with PHP one should choose LONG VARCHAR or LONG VARBINARY for these kinds of fields if you are planning on storing really large or lengthy data.&nbsp; IE: Data exceeding 64k in length such as GIF/JPG, or really huge text areas.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.odbc-execute.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:02:55 GMT -->


</body></html>