<html><!-- Mirrored from php.net/manual/en/function.ob-end-clean.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:08:35 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>ob_end_clean</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.ob-end-clean.html">
 <link rel="shorturl" href="http://php.net/ob-end-clean">
 <link rel="alternate" href="http://php.net/ob-end-clean" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.outcontrol.html">
 <link rel="prev" href="function.ob-clean.html">
 <link rel="next" href="function.ob-end-flush.html">

 <link rel="alternate" href="function.ob-end-clean.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.ob-end-clean.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.ob-end-clean.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.ob-end-clean.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.ob-end-clean.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.ob-end-clean.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.ob-end-clean.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.ob-end-clean.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.ob-end-clean.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.ob-end-clean.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.ob-end-clean.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></li>      <li><a href="book.outcontrol.html">Output Control</a></li>      <li><a href="ref.outcontrol.html">Output Control Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.ob-end-clean" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">ob_end_clean</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">ob_end_clean</span> â€” <span class="dc-title">Clean (erase) the output buffer and turn off output buffering</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.ob-end-clean-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>ob_end_clean</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="para rdfs-comment">
   This function discards the contents of the topmost output buffer and turns
   off this output buffering. If you want to further process the buffer's
   contents you have to call <span class="function"><a href="function.ob-get-contents.html" class="function">ob_get_contents()</a></span> before
   <span class="function"><strong>ob_end_clean()</strong></span> as the buffer contents are discarded
   when <span class="function"><strong>ob_end_clean()</strong></span> is called.
  </p>
  <p class="para">
   The output buffer must be started by
   <span class="function"><a href="function.ob-start.html" class="function">ob_start()</a></span> with <a href="outcontrol.constants.html#constant.php-output-handler-cleanable" class="link">PHP_OUTPUT_HANDLER_CLEANABLE</a>
   and <a href="outcontrol.constants.html#constant.php-output-handler-removable" class="link">PHP_OUTPUT_HANDLER_REMOVABLE</a>
   flags. Otherwise <span class="function"><strong>ob_end_clean()</strong></span> will not work.
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.ob-end-clean-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <strong><code>TRUE</code></strong> on success or <strong><code>FALSE</code></strong> on failure. Reasons for failure are first that you called the
   function without an active buffer or that for some reason a buffer could
   not be deleted (possible for special buffer).
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-function.ob-end-clean-errors">
  <h3 class="title">Errors/Exceptions</h3>
  <p class="para">
   If the function fails it generates an <strong><code>E_NOTICE</code></strong>.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.ob-end-clean-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   The following example shows an easy way to get rid of all output buffers:
  </p>
  <p class="para">
   </p><div class="example" id="example-484">
    <p><strong>Example #1 <span class="function"><strong>ob_end_clean()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>ob_start</span><span style="color: #007700">();<br>echo&nbsp;</span><span style="color: #DD0000">'Text&nbsp;that&nbsp;won\'t&nbsp;get&nbsp;displayed.'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">ob_end_clean</span><span style="color: #007700">();<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.ob-end-clean-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.ob-start.html" class="function" rel="rdfs-seeAlso">ob_start()</a> - Turn on output buffering</span></li>
    <li class="member"><span class="function"><a href="function.ob-get-contents.html" class="function" rel="rdfs-seeAlso">ob_get_contents()</a> - Return the contents of the output buffer</span></li>
    <li class="member"><span class="function"><a href="function.ob-flush.html" class="function" rel="rdfs-seeAlso">ob_flush()</a> - Flush (send) the output buffer</span></li>
   </ul>
  <p></p>
 </div>
 

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="103817">  
  <a class="name">
  <strong class="user"><em>Sam Yong - hellclanner at live dot com</em></strong></a><div class="date" title="2011-05-04 10:14"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103817">
<div class="phpcode"><code><span class="html">
Take note that if you change zlib output compression setting in between ob_start and ob_end_clean or ob_end_flush, you will get an error: ob_end_flush() failed to delete buffer zlib output compression<br><br>Example:<br><br><span class="default">&lt;?php<br><br>ob_start</span><span class="keyword">();<br><br></span><span class="default">$output </span><span class="keyword">= </span><span class="default">ob_get_contents</span><span class="keyword">();<br><br></span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'zlib.output_compression'</span><span class="keyword">, </span><span class="string">'1'</span><span class="keyword">);<br><br></span><span class="default">ob_end_clean</span><span class="keyword">();<br><br></span><span class="default">?&gt;<br></span><br>ob_end_clean(); in this example will throw the error.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="71092">  
  <a class="name">
  <strong class="user"><em>everling</em></strong></a><div class="date" title="2006-11-11 02:04"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom71092">
<div class="phpcode"><code><span class="html">
Keep in mind that mrfritz379's example (#49800) is just an example. You can achieve that example's result in a more efficient manner without using output buffering functions:<br><br>echo "&lt;p&gt;Search running. Please be patient. . .";<br>$output = "&lt;p&gt;FileList: &lt;/p&gt;\n";<br>if (is_dir($dir)) {<br>&nbsp; $dh = opendir($dir);<br><br>&nbsp; while (($fd = readdir($dh)) != false) {<br>&nbsp; &nbsp; echo " .";<br>&nbsp; &nbsp; $output .= $fd;<br>&nbsp; }<br>}<br>echo "&lt;/br&gt;Search Complete!&lt;/p&gt;\n";<br>echo $output;<br><br> <br> <br> <br><br>In addition to John Smith's comment (#42939), ob_gzhandler() may still set the HTTP header "Content-Encoding" to "gzip" or "deflate" even if you call ob_end_clean(). This will cause a problem in the following situation:<br><br>1. Call ob_gzhandler().<br>2. Echo "Some content";<br>3. Call ob_end_clean().<br>4. Echo "New content";<br><br>In the above case, the browser may receive the "Content-Encoding: gzip" HTTP header and attempts to decompress the uncompressed "New content". The browser will fail.<br><br>In the following situation, this behaviour will go unnoticed:<br><br>1. Call ob_gzhandler().<br>2. Echo "Some content";<br>3. Call ob_end_clean().<br>4. Call ob_gzhandler().<br>5. Echo "New content";<br><br>This is because the second ob_gzhandler() will mask the absence of the first ob_gzhandler().<br><br>A solution would be to write a wrapper, like John Smith did, for the ob_gzhandler().</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85014">  
  <a class="name">
  <strong class="user"><em>tyler @</em></strong></a><div class="date" title="2008-08-10 04:39"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom85014">
<div class="phpcode"><code><span class="html">
In reference to &lt;geoff at spacevs dot com&gt; where he states, "If you call ob_end_clean in a function registered with 'register_shutdown_function', it is too late, any buffers will have already been sent out to the client.", here is a workaround I came up with.<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">ClearBuffer</span><span class="keyword">(</span><span class="default">$Buffer</span><span class="keyword">) {<br>&nbsp; &nbsp; return </span><span class="string">""</span><span class="keyword">;<br>}<br><br>function </span><span class="default">Shutdown</span><span class="keyword">() {<br>&nbsp; &nbsp; </span><span class="default">ob_start</span><span class="keyword">(</span><span class="string">"ClearBuffer"</span><span class="keyword">);<br>}<br><br></span><span class="default">register_shutdown_function</span><span class="keyword">(</span><span class="string">"Shutdown"</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>This will wipe out all the contents of the output buffer as it comes in. Basically its the same as "STDOUT &gt; /dev/null".</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76609">  
  <a class="name">
  <strong class="user"><em>geoff at spacevs dot com</em></strong></a><div class="date" title="2007-07-22 05:47"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76609">
<div class="phpcode"><code><span class="html">
If you call ob_end_clean in a function registered with "register_shutdown_function", it is too late, any buffers will have already been sent out to the client.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="42939">  
  <a class="name">
  <strong class="user"><em>John Smith</em></strong></a><div class="date" title="2004-06-04 04:39"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom42939">
<div class="phpcode"><code><span class="html">
Note that if you started called ob_start with a callback, that callback will still be called even if you discard the OB with ob_end_clean.<br><br>Because there is no way of removing the callback from the OB once you've set it, the only way to stop the callback function from having any effect is to do something like:<br><br><span class="default">&lt;?php<br>$ignore_callback </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br></span><span class="default">ob_start</span><span class="keyword">(</span><span class="string">'my_callback'</span><span class="keyword">);<br>...<br>if(</span><span class="default">$need_to_abort</span><span class="keyword">) {<br>&nbsp;&nbsp; </span><span class="default">$ignore_callback </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br>&nbsp;&nbsp; </span><span class="default">ob_end_clean</span><span class="keyword">();<br>&nbsp;&nbsp; ...<br>}<br><br>function </span><span class="default">my_callback</span><span class="keyword">(&amp;</span><span class="default">$buffer</span><span class="keyword">) {<br>&nbsp; if(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'ignore_callback'</span><span class="keyword">]) {<br>&nbsp; &nbsp;&nbsp; return </span><span class="string">""</span><span class="keyword">;<br>&nbsp; }<br>&nbsp; ...<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="40108">  
  <a class="name">
  <strong class="user"><em>daijoubuNOSP at Mvideotron dot com</em></strong></a><div class="date" title="2004-02-22 01:11"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom40108">
<div class="phpcode"><code><span class="html">
About the previous comment:<br>You can also relay on ETag and simply use time()<br><br><span class="default">&lt;?php<br>$time </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();<br></span><span class="default">$mins </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br>if (isset(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_IF_NONE_MATCH'</span><span class="keyword">]) and </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'"'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_IF_NONE_MATCH'</span><span class="keyword">])+(</span><span class="default">$mins</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">) &gt; </span><span class="default">$time</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'HTTP/1.1 304 Not Modified'</span><span class="keyword">);<br>&nbsp; &nbsp; exit();<br>}<br>else<br>{<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'ETag: "'</span><span class="keyword">.</span><span class="default">$time</span><span class="keyword">.</span><span class="string">'"'</span><span class="keyword">);<br>}<br>echo </span><span class="string">'Caching for '</span><span class="keyword">, </span><span class="default">$mins</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">, </span><span class="string">'secs&lt;br/&gt;'</span><span class="keyword">, </span><span class="default">date</span><span class="keyword">(</span><span class="string">'G:i:s'</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="33484">  
  <a class="name">
  <strong class="user"><em>programmer at bardware dot de</em></strong></a><div class="date" title="2003-06-27 06:32"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom33484">
<div class="phpcode"><code><span class="html">
You might want to prevent your script from executing if the client already has the latest version.<br>You can do it like so:<br><br>ob_start();<br><br>$mtime=filemtime($_SERVER["SCRIPT_FILENAME"])-date("Z");<br>$gmt_mtime = date('D, d M Y H:i:s', $mtime) . ' GMT';<br><br>$headers = getallheaders();<br><br>if(isset($headers["If-Modified-Since"])) {<br>&nbsp; &nbsp; if ($headers["If-Modified-Since"] == $gmt_mtime) {<br>&nbsp; &nbsp; &nbsp; &nbsp; header("HTTP/1.1 304 Not Modified");<br>&nbsp; &nbsp; &nbsp; &nbsp; ob_end_clean();<br>&nbsp; &nbsp; &nbsp; &nbsp; exit;<br>&nbsp; &nbsp; }<br>}<br><br>$size=ob_get_length();<br>header("Last-Modified: ".$gmt_mtime);<br>header("Content-Length: $size");<br>ob_end_flush();<br><br>Instead of checking the If-Modified-Since-Header against the date of the last modification of the script, you can of course query a database or take any other date that is somehow related to the modification of the result of your script.<br><br>You can for instance use this technique to generate images dynamically. If the user indicates he already has a version of the image by the If-Modified-Since-Header, there's no need to generate it and let the server finally discard it because the server only then interpretes the If-Modified-Since-Header.<br>This saves server load and shortens response-times.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="66302">  
  <a class="name">
  <strong class="user"><em>Adam of Fusion Bay</em></strong></a><div class="date" title="2006-05-18 12:38"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom66302">
<div class="phpcode"><code><span class="html">
You may want to be careful about calling ob_end_clean() from within your call-back function. I believe this can produce an endless-loop within PHP.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="49800">  
  <a class="name">
  <strong class="user"><em>mrfritz379</em></strong></a><div class="date" title="2005-02-08 06:14"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom49800">
<div class="phpcode"><code><span class="html">
This may be posted elsewhere, but I haven't seen it.<br>To run a progress indicator while the program is running without outputting the output buffer, the following will work:<br><br>echo "&lt;p&gt;Search running. Please be patient. . .";<br>$output = "&lt;p&gt;FileList: &lt;/p&gt;\n";<br>if (is_dir($dir)) {<br>&nbsp;&nbsp; $dh = opendir($dir);<br><br>&nbsp;&nbsp; while (($fd = readdir($dh)) != false) {<br>&nbsp; &nbsp; &nbsp; echo " .";<br>&nbsp; &nbsp; &nbsp; ob_start();<br>&nbsp; &nbsp; &nbsp; echo $fd;<br>&nbsp; &nbsp; &nbsp; $output .= ob_get_contents();<br>&nbsp; &nbsp; &nbsp; ob_end_clean();<br>&nbsp; &nbsp; }<br>}<br>echo "&lt;/br&gt;Search Complete!&lt;/p&gt;\n";<br>echo $output;<br><br>The program will continue to print the " ." without printing the file list. Then the "Search Complete" message will print followed by the buffered file list.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95773">  
  <a class="name">
  <strong class="user"><em>netom at elte dot hu</em></strong></a><div class="date" title="2010-01-21 04:02"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95773">
<div class="phpcode"><code><span class="html">
Notice that ob_end_clean() does discard headers.<br><br>If you would like to clear the output buffer, but not the headers (because you use firephp for example...), than this is the solution:<br><br><span class="default">&lt;?php<br>&nbsp;&nbsp; </span><span class="keyword">...<br><br>&nbsp; &nbsp; </span><span class="default">$headers </span><span class="keyword">= array();<br>&nbsp; &nbsp; if ( !</span><span class="default">headers_sent</span><span class="keyword">() ) {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$headers </span><span class="keyword">= </span><span class="default">apache_response_headers</span><span class="keyword">();<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="default">ob_end_clean</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">ob_start</span><span class="keyword">();<br><br>&nbsp; &nbsp; if ( !empty( </span><span class="default">$headers </span><span class="keyword">) ) {<br>&nbsp; &nbsp; &nbsp; foreach ( </span><span class="default">$headers </span><span class="keyword">as </span><span class="default">$name </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">( </span><span class="string">"</span><span class="default">$name</span><span class="string">: </span><span class="default">$value</span><span class="string">" </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br><br>&nbsp;&nbsp; ...<br></span><span class="default">?&gt;<br></span><br>I use it in a general exception handler in a web application, where I clear the buffer (but not the debug-info-containing headers), and send a 500 error page with readfile().<br><br>Good PHPing,<br><br>Tamas.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.ob-end-clean.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:08:35 GMT -->


</body></html>