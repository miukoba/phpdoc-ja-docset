<html><!-- Mirrored from php.net/manual/en/function.ldap-get-values-len.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:02:06 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>ldap_get_values_len</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.ldap-get-values-len.html">
 <link rel="shorturl" href="http://php.net/ldap-get-values-len">
 <link rel="alternate" href="http://php.net/ldap-get-values-len" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.ldap.html">
 <link rel="prev" href="function.ldap-get-option.html">
 <link rel="next" href="function.ldap-get-values.html">

 <link rel="alternate" href="function.ldap-get-values-len.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.ldap-get-values-len.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.ldap-get-values-len.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.ldap-get-values-len.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.ldap-get-values-len.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.ldap-get-values-len.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.ldap-get-values-len.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.ldap-get-values-len.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.ldap-get-values-len.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.ldap-get-values-len.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.ldap-get-values-len.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.remote.other.html">Other Services</a></li>      <li><a href="book.ldap.html">LDAP</a></li>      <li><a href="ref.ldap.html">LDAP Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.ldap-get-values-len" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">ldap_get_values_len</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">ldap_get_values_len</span> â€” <span class="dc-title">Get all binary values from a result entry</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.ldap-get-values-len-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>ldap_get_values_len</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$link_identifier</code></span>
   , <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result_entry_identifier</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$attribute</code></span>
   )</div>

  <p class="para rdfs-comment">
   Reads all the values of the attribute in the entry in the result.
  </p>
  <p class="para">
   This function is used exactly like <span class="function"><a href="function.ldap-get-values.html" class="function">ldap_get_values()</a></span>
   except that it handles binary data and not string data.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.ldap-get-values-len-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">link_identifier</code></dt>

     <dd>

      <p class="para">
       An LDAP link identifier, returned by <span class="function"><a href="function.ldap-connect.html" class="function">ldap_connect()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">result_entry_identifier</code></dt>

     <dd>

      <p class="para">
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">attribute</code></dt>

     <dd>

      <p class="para">
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.ldap-get-values-len-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns an array of values for the attribute on success and <strong><code>FALSE</code></strong> on
   error. Individual values are accessed by integer index in the array. The
   first index is 0. The number of values can be found by indexing "count"
   in the resultant array. 
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.ldap-get-values-len-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.ldap-get-values.html" class="function" rel="rdfs-seeAlso">ldap_get_values()</a> - Get all values from a result entry</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="111899">  
  <a class="name">
  <strong class="user"><em>ashwini at majestik dot net</em></strong></a><div class="date" title="2013-04-09 10:52"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111899">
<div class="phpcode"><code><span class="html">
Just a minor update to the note below from "jhgustafsson" regarding the "objectGUID" field... <br><br>Going a step further, sometimes its useful to display this GUID as a String, and Microsoft has a support article and script detailing how to convert objectGUID from Hex to String. That article is here: <a rel="nofollow" target="_blank">http://support.microsoft.com/default.aspx?scid=kb%3Ben-us%3B325649</a><br><br>Below is a PHP function that does the same thing as Microsoft's VB script, it takes input of objectGUID in binary format and returns it formatted as a string (after converting it to Hex as a middle step). This will return the exact "objectGUID" value that is displayed for any Active Directory object in ADUC.<br><br>Example output: 3f79048f-42cd-4c77-8426-835cd9f8a3ad<br><br>function GUIDtoStr($binary_guid) {<br>&nbsp; $hex_guid = unpack("H*hex", $binary_guid); <br>&nbsp; $hex = $hex_guid["hex"];<br>&nbsp; <br>&nbsp; $hex1 = substr($hex, -26, 2) . substr($hex, -28, 2) . substr($hex, -30, 2) . substr($hex, -32, 2);<br>&nbsp; $hex2 = substr($hex, -22, 2) . substr($hex, -24, 2);<br>&nbsp; $hex3 = substr($hex, -18, 2) . substr($hex, -20, 2);<br>&nbsp; $hex4 = substr($hex, -16, 4);<br>&nbsp; $hex5 = substr($hex, -12, 12);<br><br>&nbsp; $guid_str = $hex1 . "-" . $hex2 . "-" . $hex3 . "-" . $hex4 . "-" . $hex5;<br><br>&nbsp; return $guid_str;<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103586">  
  <a class="name">
  <strong class="user"><em>Stav</em></strong></a><div class="date" title="2011-04-21 05:38"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103586">
<div class="phpcode"><code><span class="html">
I had a lot of issues with decoding errors using ldap_get_values_len() and found a of unanswered calls for help on a lot of forums.
<br>
<br>The error message is - Warning: ldap_get_values(): Cannot get the value(s) of attribute Decoding error in xxx.php.
<br>
<br>It appears that this error seems to cover a multitude sins including simple typos in the attribute name.
<br>
<br>After using PHP to list the attributes of a particular record I noticed that the attribute userCertificate wasn't listed simply as userCertificate but userCertificate;binary instead.&nbsp; I wrote this into my code and all was fixed.
<br>
<br>So my code looks as follows.
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (!</span><span class="default">$val </span><span class="keyword">= @</span><span class="default">ldap_get_values_len</span><span class="keyword">(</span><span class="default">$con</span><span class="keyword">, </span><span class="default">$entry</span><span class="keyword">, </span><span class="string">"</span><span class="default">$attribute</span><span class="string">;binary"</span><span class="keyword">))
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; die (</span><span class="string">'Error retrieving value (' </span><span class="keyword">. </span><span class="default">ldap_error</span><span class="keyword">(</span><span class="default">$con</span><span class="keyword">) . </span><span class="string">')'</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>I hope this saves someone the pain I went through trawling Google for an answer.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91251">  
  <a class="name">
  <strong class="user"><em>jhgustafsson at gmail dot com</em></strong></a><div class="date" title="2009-06-02 03:07"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91251">
<div class="phpcode"><code><span class="html">
Tried a couple of different ways to do this but this seems to work best:
<br>
<br><span class="default">&lt;?php
<br>$info </span><span class="keyword">= </span><span class="default">ldap_first_entry</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">,</span><span class="default">$sr</span><span class="keyword">);
<br>
<br></span><span class="comment">// get it binary-safe.
<br></span><span class="default">$bin_guid </span><span class="keyword">= </span><span class="default">ldap_get_values_len</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">,</span><span class="default">$info</span><span class="keyword">,</span><span class="string">"objectguid"</span><span class="keyword">);
<br>
<br></span><span class="comment">// convert to hex, bin2hex failed here for me. Unpack() seems to work though.
<br></span><span class="default">$hex_guid </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"H*hex"</span><span class="keyword">, </span><span class="default">$bin_guid</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90032">  
  <a class="name">
  <strong class="user"><em>alexey_baranov at inbox dot ru</em></strong></a><div class="date" title="2009-04-02 04:26"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90032">
<div class="phpcode"><code><span class="html">
no more need to use ldap_get_values_len (). ldap_get_attributes() works well now.
<br>
<br><span class="default">&lt;?php
<br>$attrs </span><span class="keyword">= </span><span class="default">ldap_get_attributes</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cid</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">re</span><span class="keyword">);
<br></span><span class="default">$hex_Sid</span><span class="keyword">= </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">$attrs</span><span class="keyword">[</span><span class="string">'objectSid'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]); </span><span class="comment">//returns 010500000000000515000000c94d7d363d787b17e77b80109d060000
<br></span><span class="default">$hex_GUID</span><span class="keyword">= </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">$attrs</span><span class="keyword">[</span><span class="string">'objectGUID'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]); </span><span class="comment">//returns 710234bbc2abc148ade8c1f9b4567b24
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73717">  
  <a class="name">
  <strong class="user"><em>derek dot ethier at gmail dot com</em></strong></a><div class="date" title="2007-03-07 11:25"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73717">
<div class="phpcode"><code><span class="html">
One more function to add that complements the bin_to_str_guid function I posted below:<br><br>// This function will convert a string GUID value into a HEX value to search AD.<br>function str_to_hex_guid($str_guid) {<br>&nbsp; &nbsp; $str_guid = str_replace('-', '', $str_guid);<br><br>&nbsp; &nbsp; $octet_str = substr($str_guid, 6, 2);<br>&nbsp; &nbsp; $octet_str .= substr($str_guid, 4, 2);<br>&nbsp; &nbsp; $octet_str .= substr($str_guid, 2, 2);<br>&nbsp; &nbsp; $octet_str .= substr($str_guid, 0, 2);<br>&nbsp; &nbsp; $octet_str .= substr($str_guid, 10, 2);<br>&nbsp; &nbsp; $octet_str .= substr($str_guid, 8, 2);<br>&nbsp; &nbsp; $octet_str .= substr($str_guid, 14, 2);<br>&nbsp; &nbsp; $octet_str .= substr($str_guid, 12, 2);<br>&nbsp; &nbsp; $octet_str .= substr($str_guid, 16, strlen($str_guid));<br><br>&nbsp; &nbsp; return $octet_str;<br>}<br><br>If you want to convert the string GUID back to the HEX format (required if you want to search AD based on the GUID string, make sure you escape the HEX string with double backslashes when searching -- ie. \\AE\\0F\\88...).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="42023">  
  <a class="name">
  <strong class="user"><em>rcrow at NOSPAM dot laptv dot com</em></strong></a><div class="date" title="2004-04-29 05:06"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom42023">
<div class="phpcode"><code><span class="html">
If you are trying to access BINARY DATA, such as ObjectSID within LDAP, you must first get an individual entry, as stated under ldap_get_values() function -- "This call needs a result_entry_identifier, so needs to be preceded by one of the ldap search calls and one of the calls to get an individual entry."<br><br>The following code snippet will get the LDAP objectSID for a specific user.<br><br><span class="default">&lt;?php<br></span><span class="comment">/* Get the binary objectsid entry&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br>/* Be sure that you have included the binary field in your ldap_search.&nbsp; &nbsp; */<br></span><span class="default">$criteria </span><span class="keyword">=&nbsp; </span><span class="string">"samaccountname=</span><span class="default">$ldapUser</span><span class="string">"</span><span class="keyword">;<br></span><span class="default">$justthese </span><span class="keyword">= array(</span><span class="string">"memberOf"</span><span class="keyword">, </span><span class="string">"objectsid"</span><span class="keyword">);<br>&nbsp; &nbsp; <br></span><span class="default">$ldapSearchResult </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ldapConnectionResult</span><span class="keyword">, </span><span class="default">$ldapBase</span><span class="keyword">, </span><span class="default">$criteria</span><span class="keyword">, </span><span class="default">$justthese</span><span class="keyword">);<br>&nbsp; <br>if (</span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ldapConnectionResult</span><span class="keyword">, </span><span class="default">$ldapSearchResult</span><span class="keyword">)){<br>&nbsp; &nbsp;&nbsp; </span><span class="default">$ldapResults </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ldapConnectionResult</span><span class="keyword">, </span><span class="default">$ldapSearchResult</span><span class="keyword">);<br><br>&nbsp;&nbsp; </span><span class="default">$entry </span><span class="keyword">= </span><span class="default">ldap_first_entry</span><span class="keyword">(</span><span class="default">$ldapConnectionResult</span><span class="keyword">, </span><span class="default">$ldapSearchResult</span><span class="keyword">);<br>&nbsp;&nbsp; </span><span class="default">$ldapBinary </span><span class="keyword">= </span><span class="default">ldap_get_values_len </span><span class="keyword">(</span><span class="default">$ldapConnectionResult</span><span class="keyword">, </span><span class="default">$entry</span><span class="keyword">, </span><span class="string">"objectsid"</span><span class="keyword">);<br><br></span><span class="comment">/* your code here */<br>&nbsp; <br></span><span class="keyword">}<br></span><span class="default">?&gt;<br></span><br>You then can use something like bin2hex to put the data in a more usable form.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73198">  
  <a class="name">
  <strong class="user"><em>derek dot ethier at gmail dot com</em></strong></a><div class="date" title="2007-02-12 07:49"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73198">
<div class="phpcode"><code><span class="html">
To elaborate on rcrow's post, if you want to convert the objectSID value to a usable string (from Active Directory) the following function will do the trick (this was borrowed from another section of the manual, just thought I'd add it here):<br><br>// Returns the textual SID<br>function bin_to_str_sid($binsid) {<br>&nbsp; &nbsp; $hex_sid = bin2hex($binsid);<br>&nbsp; &nbsp; $rev = hexdec(substr($hex_sid, 0, 2));<br>&nbsp; &nbsp; $subcount = hexdec(substr($hex_sid, 2, 2));<br>&nbsp; &nbsp; $auth = hexdec(substr($hex_sid, 4, 12));<br>&nbsp; &nbsp; $result&nbsp; &nbsp; = "$rev-$auth";<br><br>&nbsp; &nbsp; for ($x=0;$x &lt; $subcount; $x++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $subauth[$x] = <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hexdec($this-&gt;little_endian(substr($hex_sid, 16 + ($x * 8), 8)));<br>&nbsp; &nbsp; &nbsp; &nbsp; $result .= "-" . $subauth[$x];<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; // Cheat by tacking on the S-<br>&nbsp; &nbsp; return 'S-' . $result;<br>}<br><br>// Converts a little-endian hex-number to one, that 'hexdec' can convert<br>function little_endian($hex) {<br>&nbsp; &nbsp; for ($x = strlen($hex) - 2; $x &gt;= 0; $x = $x - 2) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $result .= substr($hex, $x, 2);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return $result;<br>}<br><br>This function is not related to the ldap_get_values_len function but is still helpful if you want to convert the objectGUID binary value to a string format (converted from some vbscript provided by Richard Mueller):<br><br>// This function will convert a binary value guid into a valid string.<br>function bin_to_str_guid($object_guid) {<br>&nbsp; &nbsp; $hex_guid = bin2hex($object_guid);<br>&nbsp; &nbsp; $hex_guid_to_guid_str = '';<br>&nbsp; &nbsp; for($k = 1; $k &lt;= 4; ++$k) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $hex_guid_to_guid_str .= substr($hex_guid, 8 - 2 * $k, 2);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; $hex_guid_to_guid_str .= '-';<br>&nbsp; &nbsp; for($k = 1; $k &lt;= 2; ++$k) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $hex_guid_to_guid_str .= substr($hex_guid, 12 - 2 * $k, 2);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; $hex_guid_to_guid_str .= '-';<br>&nbsp; &nbsp; for($k = 1; $k &lt;= 2; ++$k) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $hex_guid_to_guid_str .= substr($hex_guid, 16 - 2 * $k, 2);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; $hex_guid_to_guid_str .= '-' . substr($hex_guid, 16, 4);<br>&nbsp; &nbsp; $hex_guid_to_guid_str .= '-' . substr($hex_guid, 20);<br><br>&nbsp; &nbsp; return strtoupper($hex_guid_to_guid_str);<br>}<br><br>Here's an example on how to use both:<br><br>$filter="samaccountname=".$username;<br>$fields=array("objectguid","objectsid");<br><br>//establish the connection and specify the base_dn first. there are a lot of examples in the manual for this<br><br>$sr=ldap_search($this-&gt;_conn,$this-&gt;_base_dn,$filter,$fields);<br>$entries = ldap_get_entries($this-&gt;_conn, $sr);<br><br>if (in_array("objectguid", $fields)) {<br>&nbsp; &nbsp; $entries[0]["objectguid"][0]=<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;bin_to_str_guid($entries[0]["objectguid"][0]);<br>}<br><br>if (in_array("objectsid", $fields)) {<br>&nbsp; &nbsp; $entry = ldap_first_entry($this-&gt;_conn, $sr);<br>&nbsp; &nbsp; $objectsid_binary = ldap_get_values_len($this-&gt;_conn, $entry, "objectsid");<br>&nbsp; &nbsp; $entries[0]["objectsid"][0] = $this-&gt;bin_to_str_sid($objectsid_binary[0]);<br>}<br><br>Hope this helps someone!</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.ldap-get-values-len.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:02:06 GMT -->


</body></html>