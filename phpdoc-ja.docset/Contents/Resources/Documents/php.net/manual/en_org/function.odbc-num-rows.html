<html><!-- Mirrored from php.net/manual/en/function.odbc-num-rows.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:02:59 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>odbc_num_rows</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.odbc-num-rows.html">
 <link rel="shorturl" href="http://php.net/odbc-num-rows">
 <link rel="alternate" href="http://php.net/odbc-num-rows" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.uodbc.html">
 <link rel="prev" href="function.odbc-num-fields.html">
 <link rel="next" href="function.odbc-pconnect.html">

 <link rel="alternate" href="function.odbc-num-rows.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.odbc-num-rows.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.odbc-num-rows.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.odbc-num-rows.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.odbc-num-rows.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.odbc-num-rows.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.odbc-num-rows.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.odbc-num-rows.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.odbc-num-rows.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.odbc-num-rows.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.odbc-num-rows.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.abstract.html">Abstraction Layers</a></li>      <li><a href="book.uodbc.html">ODBC</a></li>      <li><a href="ref.uodbc.html">ODBC Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.odbc-num-rows" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">odbc_num_rows</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">odbc_num_rows</span> — <span class="dc-title">Number of rows in a result</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.odbc-num-rows-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><strong>odbc_num_rows</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result_id</code></span>
   )</div>

  <p class="para rdfs-comment">
   Gets the number of rows in a result. For INSERT, UPDATE and DELETE
   statements <span class="function"><strong>odbc_num_rows()</strong></span> returns the number of rows
   affected.  For a SELECT clause this <em>can</em> be the number
   of rows available.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.odbc-num-rows-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">result_id</code></dt>

     <dd>

      <p class="para">
       The result identifier returned by <span class="function"><a href="function.odbc-exec.html" class="function">odbc_exec()</a></span>.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.odbc-num-rows-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the number of rows in an ODBC result.
   This function will return -1 on error.
  </p>
 </div>

 <div class="refsect1 notes" id="refsect1-function.odbc-num-rows-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    Using <span class="function"><strong>odbc_num_rows()</strong></span> to determine the number of rows
    available after a SELECT will return -1 with many drivers.
   </p>
  <p></p></blockquote>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="111183">  
  <a class="name">
  <strong class="user"><em>Gerd Christian Kunze</em></strong></a><div class="date" title="2013-01-23 12:34"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111183">
<div class="phpcode"><code><span class="html">
odbc_num_rows does return -1 when it shouldn't. 
<br>
<br>i used this code:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">if( </span><span class="default">odbc_num_rows</span><span class="keyword">( </span><span class="default">$Result </span><span class="keyword">) ) {
<br>&nbsp;&nbsp; while( </span><span class="default">false </span><span class="keyword">!== ( </span><span class="default">$Row </span><span class="keyword">= @</span><span class="default">odbc_fetch_array</span><span class="keyword">( </span><span class="default">$Result </span><span class="keyword">) ) ) {
<br>&nbsp; &nbsp;&nbsp; </span><span class="comment">// do something with $Row
<br>&nbsp;&nbsp; </span><span class="keyword">}
<br>}
<br>else {
<br>&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>and it didn't work... obviously
<br>
<br>but this while loop will skip an empty result set anyway, so i use this:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">while( </span><span class="default">false </span><span class="keyword">!== ( </span><span class="default">$Row </span><span class="keyword">= @</span><span class="default">odbc_fetch_array</span><span class="keyword">( </span><span class="default">$Result </span><span class="keyword">) ) ) {
<br>&nbsp; </span><span class="comment">// do something with $Row
<br></span><span class="keyword">}
<br>if( ! </span><span class="default">odbc_num_rows</span><span class="keyword">( </span><span class="default">$Result </span><span class="keyword">) ) {
<br>&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>because after processing the $Result with fetch, odbc_num_rows reports the correct count (false|0..n) ... magic :-)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98836">  
  <a class="name">
  <strong class="user"><em>walt at brookhouse dot co dot uk</em></strong></a><div class="date" title="2010-07-09 02:45"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98836">
<div class="phpcode"><code><span class="html">
The easy way to count the rows in an odbc resultset where the driver returns -1 is to let SQL do the work:<br><br><span class="default">&lt;?php<br><br>&nbsp; &nbsp; $conn </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="string">"dsn"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$rs </span><span class="keyword">= </span><span class="default">odbc_exec</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="string">"SELECT Count(*) AS counter FROM tablename WHERE fieldname='" </span><span class="keyword">. </span><span class="default">$value </span><span class="keyword">. </span><span class="string">"'"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$arr </span><span class="keyword">= </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">);<br>&nbsp; &nbsp; echo </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'counter'</span><span class="keyword">];<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110207">  
  <a class="name">
  <strong class="user"><em>pjavilla at gmail dot com</em></strong></a><div class="date" title="2012-10-01 04:07"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom110207">
<div class="phpcode"><code><span class="html">
When accessing a DB2 database with PHP via the ODBC functions, beware of statements which include references to IBM's LONGDESCRIPTION table (for example, if you were - like myself - digging through IBM's Maximo product). Reading from that table usually requires error suppression, because although it works ODBC will spit out a warning message onscreen.<br><br>When you make it part of another query however, ODBC_NUM_ROWS will always return -1. The solution is to keep any queries to LONGDESCRIPTION in a separate standalone query by itself.<br><br>However, if you run the query though a previewer like Toad for DB2, using LONGDESCRIPTION in a larger query is fine and does show the results. It's just that you have to break the query up and segregate the query to LONGDESCRIPTION on its own if you are writing ODBC queries for PHP.<br><br>Just a quick note for anyone else who found ODBC_NUM_RESULTS normally reliable otherwise but inexplicably always returning -1 under certain circumstances.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87960">  
  <a class="name">
  <strong class="user"><em>jeff at script-xs dot com</em></strong></a><div class="date" title="2009-01-02 11:34"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom87960">
<div class="phpcode"><code><span class="html">
After minutes of frustration, I realized why odbc_num_rows was not returning the number of affected rows on a prepared update query.&nbsp; I'm using ODBC to connect to Microsot SQL Server 2005.
<br>
<br>My corrected code:
<br>
<br><span class="default">&lt;?php
<br>$query </span><span class="keyword">= </span><span class="default">odbc_prepare</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="string">'UPDATE table SET cat = ? WHERE id = 1'</span><span class="keyword">);
<br></span><span class="default">$result </span><span class="keyword">= </span><span class="default">odbc_execute</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">, </span><span class="default">$category</span><span class="keyword">);
<br></span><span class="default">$affected </span><span class="keyword">= </span><span class="default">odbc_num_rows</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>This code works.&nbsp; I was frustrated that odbc_num_rows($result) didn't work as I expected, but instead required me to pass the original prepared query to this function.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83900">  
  <a class="name">
  <strong class="user"><em>sirio3mil at gmail dot com</em></strong></a><div class="date" title="2008-06-17 09:46"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83900">
<div class="phpcode"><code><span class="html">
The diference between functions used here are consierable, for example for one table with 36 columns and 806 rows the time to execute two of those functions are this:<br><br>function using odbc odbc_result_all take 2,6 seconds<br>function using odbc_fetch_row take 0,8 seconds</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74125">  
  <a class="name">
  <strong class="user"><em>voland at digitalshop dot ru</em></strong></a><div class="date" title="2007-03-26 07:50"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74125">
<div class="phpcode"><code><span class="html">
Today we find a BEST way to count number of rows with ODBC! <br><br>function best_odbc_num_rows($r1)&nbsp; {<br><br>ob_start(); // block printing table with results<br><br>(int)$number=odbc_result_all($r1); <br><br>ob_clean(); // block printing table with results<br><br>return $number;<br><br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114332">  
  <a class="name">
  <strong class="user"><em>panchome66 at gmail dot com</em></strong></a><div class="date" title="2014-02-09 09:22"><strong>6 months ago</strong></div>
  <div class="text" id="Hcom114332">
<div class="phpcode"><code><span class="html">
Este codigo se probó en SQL Server 2000, no se probó en otras versiones como 2005 o 2008. Aun asi no se aplica para MySQL, porque no existe la tabla "sysindexes":<br><br>$cnx = odbc_connect("dbSQLEmpresa","Admin","123");<br>if ($cnx)<br>{<br>&nbsp; &nbsp; $rs = odbc_exec($cnx, "SELECT * FROM alumnos");<br>&nbsp; &nbsp; $f = odbc_num_fields($rs);<br>&nbsp; &nbsp; $r = odbc_num_rows($rs);<br>&nbsp; &nbsp; $r = LFRJ_odbc_num_rows($cnx,"alumnos");<br><br>&nbsp; &nbsp; echo "&lt;table border = '1'&gt;";<br>&nbsp; &nbsp; for ($i = 1; $i &lt;= $f; $i++)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; $n = odbc_field_name($rs, $i);<br>&nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;th&gt;", $n, "&lt;/th&gt;";<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; while(odbc_fetch_row($rs))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;tr&gt;";<br>&nbsp; &nbsp; &nbsp; &nbsp; for ($i = 1; $i &lt;= $f; $i++)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $d = odbc_result($rs, $i);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;td&gt;", $d, "&lt;/td&gt;";<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;/tr&gt;";<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; echo "&lt;tr&gt;&lt;td colspan = '" . $f . "'&gt;Campos(" . $f . ") Registros(" . $r . ")&lt;/td&gt;&lt;/tr&gt;";<br>&nbsp; &nbsp; echo "&lt;/table&gt;";<br>}<br>odbc_close($cnx);<br><br>function LFRJ_odbc_num_rows($cnx,$Tabla)&nbsp; <br>{<br>&nbsp; &nbsp; $rs = odbc_exec($cnx, "SELECT rows FROM sysindexes WHERE id = OBJECT_ID('" . $Tabla . "') AND indid &lt; 2;");<br>&nbsp; &nbsp; return odbc_result($rs, 1);<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112468">  
  <a class="name">
  <strong class="user"><em>johnnyboyct-AT-yahoo.com</em></strong></a><div class="date" title="2013-06-19 05:35"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112468">
<div class="phpcode"><code><span class="html">
function best_odbc_num_rows($r1)&nbsp; {<br>&nbsp; &nbsp; ob_start(); // block printing table with results<br>&nbsp; &nbsp; (int)$number=odbc_result_all($r1); <br>&nbsp; &nbsp; ob_clean(); // block printing table with results<br>&nbsp; &nbsp; return $number;<br>}<br><br>Above is the best way to count if you are not using something like IBM Netezza and ODBC and not doing more than 100000ish records, otherwise even this method will run out of memory. <br><br>IBM Netezza and ODBC will give you counts matching the prefetch setting in the odbc.ini file :( the default is 256 so watch out because it is accurate until that number.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97965">  
  <a class="name">
  <strong class="user"><em>chew_baka at hotmail dot com</em></strong></a><div class="date" title="2010-05-18 02:44"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97965">
<div class="phpcode"><code><span class="html">
None of these examples were working for me, so I came up with the following silly procedure that gives me the number of rows.&nbsp; This example is crude, but you should get the idea.<br><br><span class="default">&lt;?php<br>$cxn </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="string">"ODBC_DSN_NAME"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">);<br></span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"SELECT * FROM some_table'"</span><span class="keyword">;<br></span><span class="default">$res </span><span class="keyword">= </span><span class="default">odbc_exec</span><span class="keyword">(</span><span class="default">$cxn</span><span class="keyword">, </span><span class="default">$sql</span><span class="keyword">);<br></span><span class="default">$items </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br> while (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">)) <br>&nbsp;&nbsp; {<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items</span><span class="keyword">++;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; }&nbsp; <br>&nbsp; </span><span class="default">odbc_free_result</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">);<br>&nbsp; echo </span><span class="string">"&lt;br&gt;total No. of rows: </span><span class="default">$items</span><span class="string">"</span><span class="keyword">;<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78857">  
  <a class="name">
  <strong class="user"><em>Nathaniel at comtel dot com dot au</em></strong></a><div class="date" title="2007-10-30 08:57"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78857">
<div class="phpcode"><code><span class="html">
My development computer is running XP sql2005 while the production copy sits on a server 2003R2 sql2000 computer.<br><br>In the course of trying to get this function to work (switching from mssql to odbc) I have discovered that the ODBC driver versions are different between the two OS and that while the newer version (release date 17/2/07) that is able to be installed on 2003 handles this function fine, the older version doesn't.<br><br>Microsoft sites suggest that Vista might also handle it (ie have the newer driver). It also says that there are no plans to release the newer driver in a installable package.<br><br><a rel="nofollow" target="_blank">http://support.microsoft.com/kb/892854</a><br><br>Will hopefully test with the sql2005 on server 2003R2 in the near future to confirm it is the driver helping here.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78522">  
  <a class="name">
  <strong class="user"><em>pmo@raadvst-consetatDOTbe</em></strong></a><div class="date" title="2007-10-16 02:46"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78522">
<div class="phpcode"><code><span class="html">
voland's function is simply great. <br>However, i would recommend the use of ob_end_clean(), to shut down completely the output buffer (can cause weird behaviour).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77736">  
  <a class="name">
  <strong class="user"><em>nielsvandenberge at hotm dot  dot  dot  dot  dot com</em></strong></a><div class="date" title="2007-09-11 05:06"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom77736">
<div class="phpcode"><code><span class="html">
I just tried to use the function best_odbc_num_rows($result) from voland at digitalshop dot ru, but it's not working quite well. After executing the function odbc_result_all(); the resultset has to be resetted again. <br>Resetting it with <br><br>odbc_fetch_row($result, 0); <br><br>is not working for me.<br><br>I think the internal number-value of the odbc_result_all()-function is not resetted, but that's just a guess.<br><br>when I execute the function 3 times with a resultset of 17 rows the values: 17, 34 and 51 are returned.<br><br>His previous function useful_odbc_num_rows($result) works better (for me).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73637">  
  <a class="name">
  <strong class="user"><em>voland at digitalshop dot ru</em></strong></a><div class="date" title="2007-03-05 05:56"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73637">
<div class="phpcode"><code><span class="html">
After a hour for a searching a good alter function of odbc_num_rows... i try to write it by mysels:<br><br>function useful_odbc_num_rows($result){<br><br>&nbsp;&nbsp; $num_rows=0;<br><br>&nbsp;&nbsp; while($temp = odbc_fetch_into($result, &amp;$counter))<br><br>&nbsp;&nbsp; {<br>&nbsp; &nbsp; &nbsp;&nbsp; $num_rows++;<br>&nbsp;&nbsp; }<br><br>@odbc_fetch_row($result, 0);&nbsp;&nbsp; // reset cursor<br><br>&nbsp;&nbsp; return $num_rows;<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73066">  
  <a class="name">
  <strong class="user"><em>dm at personalcomputingsolutions dot co dot uk</em></strong></a><div class="date" title="2007-02-07 01:41"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73066">
<div class="phpcode"><code><span class="html">
function db_get_row($cur, $rownum){<br>if (odbc_fetch_into($cur, $row, $rownum)){<br>&nbsp; &nbsp; &nbsp; &nbsp; return ($row);<br>&nbsp; &nbsp; }else{<br>&nbsp; &nbsp; &nbsp; &nbsp; return (FALSE);<br>}<br><br>$i=1;<br>if (db_get_row($cur,1)){<br>while ($record=db_get_row($cur,$i++)){<br>do stuff<br>}else{<br>tell the user there are no results<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="79505">  
  <a class="name">
  <strong class="user"><em>areznik at survdata dot com</em></strong></a><div class="date" title="2007-11-30 10:04"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom79505">
<div class="phpcode"><code><span class="html">
I could have been noted before in this thread but I couldnt find it on my first search.<br><br>This function (odbc_num_rows) returns -1 when ODBCing to MS SQL and making it hard to get the number of rows in the returned recordset. <br><br>Two workarounds:<br>&nbsp;&nbsp; 1. When you just need to verify that any rows returned from your query you can use select count(*) as cnt from table and then just get $row['cnt']<br>&nbsp;&nbsp; 2. When you need to actually loop through the records this function returns number of rows in the recordset if and only if you include ORDER BY clause in your query statement.<br><br>That sounds a bit annoying but thats the work around when dealing with MS SQL odbc driver I guess.<br><br>It would be beneficial if someone explained how the Order By clause makes the difference.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.odbc-num-rows.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:02:59 GMT -->


</body></html>