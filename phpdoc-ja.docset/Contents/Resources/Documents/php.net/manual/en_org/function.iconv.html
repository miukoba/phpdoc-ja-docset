<html><!-- Mirrored from php.net/manual/en/function.iconv.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:20:02 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>iconv</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.iconv.html">
 <link rel="shorturl" href="http://php.net/iconv">
 <link rel="alternate" href="http://php.net/iconv" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.iconv.html">
 <link rel="prev" href="function.iconv-substr.html">
 <link rel="next" href="function.ob-iconv-handler.html">

 <link rel="alternate" href="function.iconv.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.iconv.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.iconv.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.iconv.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.iconv.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.iconv.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.iconv.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.iconv.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.iconv.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.iconv.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.iconv.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.international.html">Human Language and Character Encoding Support</a></li>      <li><a href="book.iconv.html">iconv</a></li>      <li><a href="ref.iconv.html">iconv Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.iconv" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">iconv</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.5, PHP 5)</p><p class="refpurpose"><span class="refname">iconv</span> — <span class="dc-title">Convert string to requested character encoding</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.iconv-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>iconv</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$in_charset</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$out_charset</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$str</code></span>
   )</div>

  <p class="para rdfs-comment">
   Performs a character set conversion on the string
   <code class="parameter">str</code> from <code class="parameter">in_charset</code>
   to <code class="parameter">out_charset</code>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.iconv-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">in_charset</code></dt>

     <dd>

      <p class="para">
       The input charset.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">out_charset</code></dt>

     <dd>

      <p class="para">
       The output charset.
      </p>
      <p class="para">
       If you append the string <em>//TRANSLIT</em> to
       <code class="parameter">out_charset</code> transliteration is activated. This
       means that when a character can't be represented in the target charset,
       it can be approximated through one or several similarly looking
       characters. If you append the string <em>//IGNORE</em>,
       characters that cannot be represented in the target charset are silently
       discarded. Otherwise, <code class="parameter">str</code> is cut from the first
       illegal character and an <strong><code>E_NOTICE</code></strong> is generated.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">str</code></dt>

     <dd>

      <p class="para">
       The string to be converted.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.iconv-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the converted string or <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.iconv-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-2574">
    <p><strong>Example #1 <span class="function"><strong>iconv()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$text&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"This&nbsp;is&nbsp;the&nbsp;Euro&nbsp;symbol&nbsp;'€'."</span><span style="color: #007700">;<br><br>echo&nbsp;</span><span style="color: #DD0000">'Original&nbsp;:&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$text</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">'TRANSLIT&nbsp;:&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">iconv</span><span style="color: #007700">(</span><span style="color: #DD0000">"UTF-8"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ISO-8859-1//TRANSLIT"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$text</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">'IGNORE&nbsp;&nbsp;&nbsp;:&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">iconv</span><span style="color: #007700">(</span><span style="color: #DD0000">"UTF-8"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ISO-8859-1//IGNORE"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$text</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">'Plain&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">iconv</span><span style="color: #007700">(</span><span style="color: #DD0000">"UTF-8"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"ISO-8859-1"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$text</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>Original : This is the Euro symbol '€'.
TRANSLIT : This is the Euro symbol 'EUR'.
IGNORE   : This is the Euro symbol ''.
Plain    :
Notice: iconv(): Detected an illegal character in input string in .\iconv-example.php on line 7
This is the Euro symbol '
</pre></div>
    </div>
   </div>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="74101">  
  <a class="name">
  <strong class="user"><em>Ritchie</em></strong></a><div class="date" title="2007-03-24 04:11"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74101">
<div class="phpcode"><code><span class="html">
Please note that iconv('UTF-8', 'ASCII//TRANSLIT', ...) doesn't work properly when locale category LC_CTYPE is set to C or POSIX. You must choose another locale otherwise all non-ASCII characters will be replaced with question marks. This is at least true with glibc 2.5.<br><br>Example:<br><span class="default">&lt;?php<br>setlocale</span><span class="keyword">(</span><span class="default">LC_CTYPE</span><span class="keyword">, </span><span class="string">'POSIX'</span><span class="keyword">);<br>echo </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII//TRANSLIT'</span><span class="keyword">, </span><span class="string">"Žluťoučký kůň\n"</span><span class="keyword">);<br></span><span class="comment">// ?lu?ou?k? k??<br><br></span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_CTYPE</span><span class="keyword">, </span><span class="string">'cs_CZ'</span><span class="keyword">);<br>echo </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII//TRANSLIT'</span><span class="keyword">, </span><span class="string">"Žluťoučký kůň\n"</span><span class="keyword">);<br></span><span class="comment">// Zlutoucky kun<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108643">  
  <a class="name">
  <strong class="user"><em>orrd101 at gmail dot com</em></strong></a><div class="date" title="2012-05-14 06:58"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108643">
<div class="phpcode"><code><span class="html">
The "//ignore" option doesn't work with recent versions of the iconv library.&nbsp; So if you're having trouble with that option, you aren't alone.&nbsp; 
<br>
<br>That means you can't currently use this function to filter invalid characters.&nbsp; Instead it silently fails and returns an empty string (or you'll get a notice but only if you have E_NOTICE enabled).
<br>
<br>This has been a known bug with a known solution for at least since 2009 years but no one seems to be willing to fix it (PHP must pass the -c option to iconv).&nbsp; It's still broken as of the latest release 5.4.3. 
<br>
<br>https://bugs.php.net/bug.php?id=48147
<br>https://bugs.php.net/bug.php?id=52211
<br>https://bugs.php.net/bug.php?id=61484
<br>
<br>[UPDATE 15-JUN-2012]
<br>Here's a workaround...
<br>
<br>&nbsp; ini_set('mbstring.substitute_character', "none");
<br>&nbsp; $text= mb_convert_encoding($text, 'UTF-8', 'UTF-8');
<br>
<br>That will strip invalid characters from UTF-8 strings (so that you can insert it into a database, etc.).&nbsp; Instead of "none" you can also use the value 32 if you want it to insert spaces in place of the invalid characters.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105507">  
  <a class="name">
  <strong class="user"><em>daniel dot rhodes at warpasylum dot co dot uk</em></strong></a><div class="date" title="2011-08-23 08:22"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom105507">
<div class="phpcode"><code><span class="html">
Interestingly, setting different target locales results in different, yet appropriate, transliterations. For example:<br><br><span class="default">&lt;?php<br></span><span class="comment">//some German<br></span><span class="default">$utf8_sentence </span><span class="keyword">= </span><span class="string">'Weiß, Goldmann, Göbel, Weiss, Göthe, Goethe und Götz'</span><span class="keyword">;<br><br></span><span class="comment">//UK<br></span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">'en_GB'</span><span class="keyword">);<br><br></span><span class="comment">//transliterate<br></span><span class="default">$trans_sentence </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII//TRANSLIT'</span><span class="keyword">, </span><span class="default">$utf8_sentence</span><span class="keyword">);<br><br></span><span class="comment">//gives [Weiss, Goldmann, Gobel, Weiss, Gothe, Goethe und Gotz]<br>//which is our original string flattened into 7-bit ASCII as<br>//an English speaker would do it (ie. simply remove the umlauts)<br></span><span class="keyword">echo </span><span class="default">$trans_sentence </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br><br></span><span class="comment">//Germany<br></span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">'de_DE'</span><span class="keyword">);<br><br></span><span class="default">$trans_sentence </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII//TRANSLIT'</span><span class="keyword">, </span><span class="default">$utf8_sentence</span><span class="keyword">);<br><br></span><span class="comment">//gives [Weiss, Goldmann, Goebel, Weiss, Goethe, Goethe und Goetz]<br>//which is exactly how a German would transliterate those<br>//umlauted characters if forced to use 7-bit ASCII!<br>//(because really ä = ae, ö = oe and ü = ue)<br></span><span class="keyword">echo </span><span class="default">$trans_sentence </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90330">  
  <a class="name">
  <strong class="user"><em>manuel at kiessling dot net</em></strong></a><div class="date" title="2009-04-16 09:33"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90330">
<div class="phpcode"><code><span class="html">
Like many other people, I have encountered massive problems when using iconv() to convert between encodings (from UTF-8 to ISO-8859-15 in my case), especially on large strings.<br><br>The main problem here is that when your string contains illegal UTF-8 characters, there is no really straight forward way to handle those. iconv() simply (and silently!) terminates the string when encountering the problematic characters (also if using //IGNORE), returning a clipped string. The<br><br><span class="default">&lt;?php<br><br>$newstring </span><span class="keyword">= </span><span class="default">html_entity_decode</span><span class="keyword">(</span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">$oldstring</span><span class="keyword">, </span><span class="default">ENT_QUOTES</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">), </span><span class="default">ENT_QUOTES </span><span class="keyword">, </span><span class="string">'ISO-8859-15'</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>workaround suggested here and elsewhere will also break when encountering illegal characters, at least dropping a useful note ("htmlentities(): Invalid multibyte sequence in argument in...")<br><br>I have found a lot of hints, suggestions and alternative methods (it's scary and in my opinion no good sign how many ways PHP natively provides to convert the encoding of strings), but none of them really worked, except for this one:<br><br><span class="default">&lt;?php<br><br>$newstring </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$oldstring</span><span class="keyword">, </span><span class="string">'ISO-8859-15'</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="94058">  
  <a class="name">
  <strong class="user"><em>annuaireehtp at gmail dot com</em></strong></a><div class="date" title="2009-10-14 04:53"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom94058">
<div class="phpcode"><code><span class="html">
to test different combinations of convertions between charsets (when we don't know the source charset and what is the convenient destination charset) this is an example :
<br>
<br><span class="default">&lt;?php
<br>$tab </span><span class="keyword">= array(</span><span class="string">"UTF-8"</span><span class="keyword">, </span><span class="string">"ASCII"</span><span class="keyword">, </span><span class="string">"Windows-1252"</span><span class="keyword">, </span><span class="string">"ISO-8859-15"</span><span class="keyword">, </span><span class="string">"ISO-8859-1"</span><span class="keyword">, </span><span class="string">"ISO-8859-6"</span><span class="keyword">, </span><span class="string">"CP1256"</span><span class="keyword">);
<br></span><span class="default">$chain </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br>foreach (</span><span class="default">$tab </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$tab </span><span class="keyword">as </span><span class="default">$j</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$chain </span><span class="keyword">.= </span><span class="string">" </span><span class="default">$i$j</span><span class="string"> "</span><span class="keyword">.</span><span class="default">iconv</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">, </span><span class="default">$j</span><span class="keyword">, </span><span class="string">"</span><span class="default">$my_string</span><span class="string">"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; }
<br>
<br>echo </span><span class="default">$chain</span><span class="keyword">;
<br></span><span class="default">?&gt;
<br></span>
<br>then after displaying, you use the $i$j that shows good displaying.
<br>NB: you can add other charsets to $tab&nbsp; to test other cases.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77315">  
  <a class="name">
  <strong class="user"><em>gree:.. (gree 4T grees D0T net)</em></strong></a><div class="date" title="2007-08-24 02:19"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom77315">
<div class="phpcode"><code><span class="html">
In my case, I had to change:<br><span class="default">&lt;?php<br>setlocale</span><span class="keyword">(</span><span class="default">LC_CTYPE</span><span class="keyword">, </span><span class="string">'cs_CZ'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>to <br><span class="default">&lt;?php<br>setlocale</span><span class="keyword">(</span><span class="default">LC_CTYPE</span><span class="keyword">, </span><span class="string">'cs_CZ.UTF-8'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>Otherwise it returns question marks.<br><br>When I asked my linux for locale (by locale command) it returns "cs_CZ.UTF-8", so there is maybe correlation between it.<br><br>iconv (GNU libc) 2.6.1<br>glibc 2.3.6</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86077">  
  <a class="name">
  <strong class="user"><em>Leigh Morresi</em></strong></a><div class="date" title="2008-10-01 11:10"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom86077">
<div class="phpcode"><code><span class="html">
If you are getting question-marks in your iconv output when transliterating, be sure to 'setlocale' to something your system supports.<br><br>Some PHP CMS's will default setlocale to 'C', this can be a problem.<br><br>use the "locale" command to find out a list..<br><br>$ locale -a<br>C<br>en_AU.utf8<br>POSIX<br><br><span class="default">&lt;?php<br>&nbsp; setlocale</span><span class="keyword">(</span><span class="default">LC_CTYPE</span><span class="keyword">, </span><span class="string">'en_AU.utf8'</span><span class="keyword">);<br>&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII//TRANSLIT'</span><span class="keyword">, </span><span class="string">"Côte d'Ivoire"</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="93609">  
  <a class="name">
  <strong class="user"><em>phpmanualspam at netebb dot com</em></strong></a><div class="date" title="2009-09-17 11:53"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom93609">
<div class="phpcode"><code><span class="html">
mirek code, dated 16-May-2008 10:17, added the characters `^~'" to the output.<br>This function will strip out these extra characters:<br><span class="default">&lt;?php<br>setlocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">'en_US.UTF8'</span><span class="keyword">);<br>function </span><span class="default">clearUTF</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$s1 </span><span class="keyword">= @</span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII//TRANSLIT'</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$j </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ch1 </span><span class="keyword">= </span><span class="default">$s1</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ch2 </span><span class="keyword">= @</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">, </span><span class="default">$j</span><span class="keyword">++, </span><span class="default">1</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">strstr</span><span class="keyword">(</span><span class="string">'`^~\'"'</span><span class="keyword">, </span><span class="default">$ch1</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$ch1 </span><span class="keyword">&lt;&gt; </span><span class="default">$ch2</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --</span><span class="default">$j</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$r </span><span class="keyword">.= (</span><span class="default">$ch1</span><span class="keyword">==</span><span class="string">'?'</span><span class="keyword">) ? </span><span class="default">$ch2 </span><span class="keyword">: </span><span class="default">$ch1</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$r</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="81494">  
  <a class="name">
  <strong class="user"><em>berserk220 at mail dot ru</em></strong></a><div class="date" title="2008-02-29 06:44"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom81494">
<div class="phpcode"><code><span class="html">
So, as iconv() does not always work correctly, in most cases, much easier to use htmlentities(). <br>Example: <span class="default">&lt;?php $content</span><span class="keyword">=</span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"incoming.txt"</span><span class="keyword">), </span><span class="default">ENT_QUOTES</span><span class="keyword">, </span><span class="string">"Windows-1252"</span><span class="keyword">);&nbsp; </span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="string">"outbound.txt"</span><span class="keyword">, </span><span class="default">html_entity_decode</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">, </span><span class="default">ENT_QUOTES </span><span class="keyword">, </span><span class="string">"utf-8"</span><span class="keyword">)); </span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="59717">  
  <a class="name">
  <strong class="user"><em>sire at acc dot umu dot se</em></strong></a><div class="date" title="2005-12-14 01:17"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom59717">
<div class="phpcode"><code><span class="html">
If you get this error message: "Notice: iconv(): Detected an illegal character in input string in file.php on line x", and your text or database is likely to contain text copied from Microsoft Word documents, it's very likely that the error is because of the evil 0x96 "long dash" character. MS Word as default converts all double hyphens into this illegal character. The solution is either to convert 0x96 (dash) into the regular 0x2d (hyphen/minus), or to append the //TRANSLIT or //IGNORE parameters (se above).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="59030">  
  <a class="name">
  <strong class="user"><em>nilcolor at gmail dot coom</em></strong></a><div class="date" title="2005-11-24 03:29"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom59030">
<div class="phpcode"><code><span class="html">
Didn't know its a feature or not but its works for me (PHP 5.0.4)<br><br>iconv('', 'UTF-8', $str)<br><br>test it to convert from windows-1251 (stored in DB) to UTF-8 (which i use for web pages).<br>BTW i convert each array i fetch from DB with array_walk_recursive...</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53365">  
  <a class="name">
  <strong class="user"><em>anyean at gmail dot com</em></strong></a><div class="date" title="2005-05-30 03:23"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom53365">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php<br></span><span class="comment">//script from <a rel="nofollow" target="_blank">http://zizi.kxup.com/</a><br>//javascript unesape<br></span><span class="keyword">function </span><span class="default">unescape</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br>&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">rawurldecode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br>&nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">"/(?:%u.{4})|&amp;#x.{4};|&amp;#\d+;|.+/U"</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">);<br>&nbsp; </span><span class="default">$ar </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$ar</span><span class="keyword">);<br>&nbsp; foreach(</span><span class="default">$ar </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$v</span><span class="keyword">) {<br>&nbsp; &nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">) == </span><span class="string">"%u"</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">"UCS-2"</span><span class="keyword">,</span><span class="string">"UTF-8"</span><span class="keyword">,</span><span class="default">pack</span><span class="keyword">(</span><span class="string">"H4"</span><span class="keyword">,</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,-</span><span class="default">4</span><span class="keyword">)));<br>&nbsp; &nbsp; elseif(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">) == </span><span class="string">"&amp;#x"</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">"UCS-2"</span><span class="keyword">,</span><span class="string">"UTF-8"</span><span class="keyword">,</span><span class="default">pack</span><span class="keyword">(</span><span class="string">"H4"</span><span class="keyword">,</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">)));<br>&nbsp; &nbsp; elseif(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">) == </span><span class="string">"&amp;#"</span><span class="keyword">) {<br>echo </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">"UCS-2"</span><span class="keyword">,</span><span class="string">"UTF-8"</span><span class="keyword">,</span><span class="default">pack</span><span class="keyword">(</span><span class="string">"n"</span><span class="keyword">,</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">)));<br>&nbsp; &nbsp; }<br>&nbsp; }<br>&nbsp; return </span><span class="default">join</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">,</span><span class="default">$ar</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112706">  
  <a class="name">
  <strong class="user"><em>jessiedeer  at  hotmail dot com</em></strong></a><div class="date" title="2013-07-15 02:06"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112706">
<div class="phpcode"><code><span class="html">
iconv with //IGNORE works as expected: it will skip the character if this one does not exist in the $out_charset encoding.<br><br>If a character is missing from the $in_charset encoding (eg byte \x81 from CP1252 encoding), then iconv will return an error, whether with //IGNORE or not.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="80838">  
  <a class="name">
  <strong class="user"><em>anton dot vakulchik at gmail dot com</em></strong></a><div class="date" title="2008-02-02 10:40"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80838">
<div class="phpcode"><code><span class="html">
function detectUTF8($string)<br>{<br>&nbsp; &nbsp; &nbsp; &nbsp; return preg_match('%(?:<br>&nbsp; &nbsp; &nbsp; &nbsp; [\xC2-\xDF][\x80-\xBF]&nbsp; &nbsp; &nbsp; &nbsp; # non-overlong 2-byte<br>&nbsp; &nbsp; &nbsp; &nbsp; |\xE0[\xA0-\xBF][\x80-\xBF]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; # excluding overlongs<br>&nbsp; &nbsp; &nbsp; &nbsp; |[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}&nbsp; &nbsp; &nbsp; # straight 3-byte<br>&nbsp; &nbsp; &nbsp; &nbsp; |\xED[\x80-\x9F][\x80-\xBF]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; # excluding surrogates<br>&nbsp; &nbsp; &nbsp; &nbsp; |\xF0[\x90-\xBF][\x80-\xBF]{2}&nbsp; &nbsp; # planes 1-3<br>&nbsp; &nbsp; &nbsp; &nbsp; |[\xF1-\xF3][\x80-\xBF]{3}&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # planes 4-15<br>&nbsp; &nbsp; &nbsp; &nbsp; |\xF4[\x80-\x8F][\x80-\xBF]{2}&nbsp; &nbsp; # plane 16<br>&nbsp; &nbsp; &nbsp; &nbsp; )+%xs', $string);<br>}<br><br>function cp1251_utf8( $sInput )<br>{<br>&nbsp; &nbsp; $sOutput = "";<br><br>&nbsp; &nbsp; for ( $i = 0; $i &lt; strlen( $sInput ); $i++ )<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; $iAscii = ord( $sInput[$i] );<br><br>&nbsp; &nbsp; &nbsp; &nbsp; if ( $iAscii &gt;= 192 &amp;&amp; $iAscii &lt;= 255 )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sOutput .=&nbsp; "&amp;#".( 1040 + ( $iAscii - 192 ) ).";";<br>&nbsp; &nbsp; &nbsp; &nbsp; else if ( $iAscii == 168 )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sOutput .= "&amp;#".( 1025 ).";";<br>&nbsp; &nbsp; &nbsp; &nbsp; else if ( $iAscii == 184 )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sOutput .= "&amp;#".( 1105 ).";";<br>&nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sOutput .= $sInput[$i];<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; return $sOutput;<br>}<br><br>function encoding($string){<br>&nbsp; &nbsp; if (function_exists('iconv')) {&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; if (@!iconv('utf-8', 'cp1251', $string)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $string = iconv('cp1251', 'utf-8', $string);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; return $string;<br>&nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; if (detectUTF8($string)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $string;&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return cp1251_utf8($string);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>}<br>echo encoding($string);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="75762">  
  <a class="name">
  <strong class="user"><em>dead dot screamer at seznam dot cz</em></strong></a><div class="date" title="2007-06-14 09:08"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom75762">
<div class="phpcode"><code><span class="html">
Ritchie's example<br><br>&lt;?<br>setlocale(LC_CTYPE, 'cs_CZ');<br>echo iconv('UTF-8', 'ASCII//TRANSLIT', "Žluťoučký kůň\n");<br>?&gt;<br><br>dasn't output `Zlutoucky kun`, but `Zlutouck'y kun`</span>
</code></div>
  </div>
 </div>
  <div class="note" id="49548">  
  <a class="name">
  <strong class="user"><em>zhawari at hotmail dot com</em></strong></a><div class="date" title="2005-02-01 03:27"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom49548">
<div class="phpcode"><code><span class="html">
Here is how to convert UTF-8 numbers to UCS-2 numbers in hex:<br><br><span class="default">&lt;?php<br> <br></span><span class="keyword">function </span><span class="default">utf8toucs2</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">+=</span><span class="default">2</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp;&nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$substring1 </span><span class="keyword">= </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">];&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$substring2 </span><span class="keyword">= </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">].</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">3</span><span class="keyword">]; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$substring1</span><span class="keyword">) &lt; </span><span class="default">127</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$results </span><span class="keyword">= </span><span class="string">"00"</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$results </span><span class="keyword">= </span><span class="default">dechex</span><span class="keyword">((</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$substring1</span><span class="keyword">)-</span><span class="default">192</span><span class="keyword">)*</span><span class="default">64 </span><span class="keyword">+ (</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$substring2</span><span class="keyword">)-</span><span class="default">128</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$results </span><span class="keyword">&lt; </span><span class="default">1000</span><span class="keyword">) </span><span class="default">$results </span><span class="keyword">= </span><span class="string">"0"</span><span class="keyword">.</span><span class="default">$results</span><span class="keyword">; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$i</span><span class="keyword">+=</span><span class="default">2</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ucs2 </span><span class="keyword">.= </span><span class="default">$results</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$ucs2</span><span class="keyword">;<br>}<br> <br>echo </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">utf8toucs2</span><span class="keyword">(</span><span class="string">"D985D8B1D8AD"</span><span class="keyword">)).</span><span class="string">"\n"</span><span class="keyword">;<br>echo </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">utf8toucs2</span><span class="keyword">(</span><span class="string">"456725"</span><span class="keyword">)).</span><span class="string">"\n"</span><span class="keyword">;<br> <br></span><span class="default">?&gt;<br></span><br>Input:<br>D985D8B1D8AD<br>Output:<br>06450631062D<br><br>Input:<br>456725<br>Output:<br>004500670025</span>
</code></div>
  </div>
 </div>
  <div class="note" id="49171">  
  <a class="name">
  <strong class="user"><em>zhawari at hotmail dot com</em></strong></a><div class="date" title="2005-01-18 03:02"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom49171">
<div class="phpcode"><code><span class="html">
Here is how to convert UCS-2 numbers to UTF-8 numbers in hex:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">ucs2toutf8</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; &nbsp; &nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">+=</span><span class="default">4</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$substring1 </span><span class="keyword">= </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">];
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$substring2 </span><span class="keyword">= </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">].</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">3</span><span class="keyword">];
<br> 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$substring1 </span><span class="keyword">== </span><span class="string">"00"</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$byte1 </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$byte2 </span><span class="keyword">= </span><span class="default">$substring2</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$substring </span><span class="keyword">= </span><span class="default">$substring1</span><span class="keyword">.</span><span class="default">$substring2</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$byte1 </span><span class="keyword">= </span><span class="default">dechex</span><span class="keyword">(</span><span class="default">192</span><span class="keyword">+(</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$substring</span><span class="keyword">)/</span><span class="default">64</span><span class="keyword">));
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$byte2 </span><span class="keyword">= </span><span class="default">dechex</span><span class="keyword">(</span><span class="default">128</span><span class="keyword">+(</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$substring</span><span class="keyword">)%</span><span class="default">64</span><span class="keyword">));
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$utf8 </span><span class="keyword">.= </span><span class="default">$byte1</span><span class="keyword">.</span><span class="default">$byte2</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$utf8</span><span class="keyword">;
<br>}
<br> 
<br>echo </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">ucs2toutf8</span><span class="keyword">(</span><span class="string">"06450631062D0020"</span><span class="keyword">));
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>Input:
<br>06450631062D
<br>Output:
<br>D985D8B1D8AD
<br>
<br>regards,
<br>Ziyad</span>
</code></div>
  </div>
 </div>
  <div class="note" id="43463">  
  <a class="name">
  <strong class="user"><em>ng4rrjanbiah at rediffmail dot com</em></strong></a><div class="date" title="2004-06-22 08:10"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom43463">
<div class="phpcode"><code><span class="html">
Here is a code to convert ISO 8859-1 to UTF-8 and vice versa without using iconv.<br><br><span class="default">&lt;?php<br></span><span class="comment">//Logic from <a rel="nofollow" target="_blank">http://twiki.org/cgi-bin/view/Codev/InternationalisationUTF8</a><br></span><span class="default">$str_iso8859_1 </span><span class="keyword">= </span><span class="string">'foo in ISO 8859-1'</span><span class="keyword">;<br></span><span class="comment">//ISO 8859-1 to UTF-8<br></span><span class="default">$str_utf8 </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/([\x80-\xFF])/e"</span><span class="keyword">, <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"chr(0xC0|ord('\\1')&gt;&gt;6).chr(0x80|ord('\\1')&amp;0x3F)"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str_iso8859_1</span><span class="keyword">);<br></span><span class="comment">//UTF-8 to ISO 8859-1<br></span><span class="default">$str_iso8859_1 </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/([\xC2\xC3])([\x80-\xBF])/e"</span><span class="keyword">, <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"chr(ord('\\1')&lt;&lt;6&amp;0xC0|ord('\\2')&amp;0x3F)"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str_utf8</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>HTH,<br>R. Rajesh Jeba Anbiah</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73749">  
  <a class="name">
  <strong class="user"><em>Georgios Papadakis</em></strong></a><div class="date" title="2007-03-08 12:28"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73749">
<div class="phpcode"><code><span class="html">
Many mail servers don't handle utf-8 correctly as they assume iso-8859-x encodings, so you would want to convert the headers, subject and body of an email prior to sending it out.<br><br>If iconv() and mb_convert_encoding() are missing the following function can be used to convert UTF8 to iso-8859-7 encoding. It discards all characters that are not 2-byte greek characters or single-byte (ascii).<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">conv_utf8_iso8859_7</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$curr_char </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$curr_char </span><span class="keyword">.= </span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; if( ( </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) &amp; (</span><span class="default">128</span><span class="keyword">+</span><span class="default">64</span><span class="keyword">) ) == </span><span class="default">128</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//character end found<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if ( </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$curr_char</span><span class="keyword">) == </span><span class="default">2</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// 2-byte character check for it is greek one and convert<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if&nbsp; &nbsp; &nbsp; (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$curr_char</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])==</span><span class="default">205</span><span class="keyword">) </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">( </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$curr_char</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])+</span><span class="default">16 </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$curr_char</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])==</span><span class="default">206</span><span class="keyword">) </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">( </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$curr_char</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])+</span><span class="default">48 </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$curr_char</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])==</span><span class="default">207</span><span class="keyword">) </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">( </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$curr_char</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])+</span><span class="default">112 </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else ; </span><span class="comment">// non greek 2-byte character, discard character<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">} else ;</span><span class="comment">// n-byte character, n&gt;2, discard character<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$curr_char </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) &lt; </span><span class="default">128</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// character is one byte (ascii)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">$curr_char</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$curr_char </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$out</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101871">  
  <a class="name">
  <strong class="user"><em>ameten</em></strong></a><div class="date" title="2011-01-14 04:17"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101871">
<div class="phpcode"><code><span class="html">
I have used iconv to convert from cp1251 into UTF-8. I spent a day to investigate why a string with Russian capital 'Р' (sounds similar to 'r') at the end cannot be inserted into a database.<br><br>The problem is not in iconv. But 'Р' in cp1251 is chr(208) and 'Р' in UTF-8 is chr(208).chr(106). chr(106) is one of the space symbol which match '\s' in regex. So, it can be taken by a greedy '+' or '*' operator. In that case, you loose 'Р' in your string.<br><br>For example, 'ГР&nbsp;&nbsp; ' (Russian, UTF-8). Function preg_match. Regex is '(.+?)[\s]*'. Then '(.+?)' matches 'Г'.chr(208) and '[\s]*' matches chr(106).'&nbsp;&nbsp; '.<br><br>Although, it is not a bug of iconv, but it looks like it very much. That's why I put this comment here.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112489">  
  <a class="name">
  <strong class="user"><em>jessie at hotmail dot com</em></strong></a><div class="date" title="2013-06-21 09:44"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112489">
<div class="phpcode"><code><span class="html">
Provided that there is no invalid code point in the character chain for the input encoding, the //IGNORE option works as expected. No bug here.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98917">  
  <a class="name">
  <strong class="user"><em>vb (at) bertola.eu</em></strong></a><div class="date" title="2010-07-15 06:35"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98917">
<div class="phpcode"><code><span class="html">
On my system, according to tests, and also as reported by other people elsewhere, you can combine TRANSLIT and IGNORE only by appending<br><br>//IGNORE//TRANSLIT<br><br>strictly in that order, but NOT by appending //TRANSLIT//IGNORE, which would lead to //IGNORE being ignored ( :) ).<br><br>Anyway, it's hard to understand how one could devise a system of passing options that does not allow to couple both options in a neat manner, and also to understand why the default behaviour should be the less useful and most dangerous one (throwing away most of your data at the first unexpected character). Software design FAIL :-/</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111909">  
  <a class="name">
  <strong class="user"><em>admin at iecw dot net</em></strong></a><div class="date" title="2013-04-10 05:39"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111909">
<div class="phpcode"><code><span class="html">
If you want to normalize a filename on Mac OS X, because it is in UTF-8 NFD and you need UTF-8 NFC<br>(See: <a rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Unicode_equivalence#Combining_and_precomposed_characters</a>)<br>you may use:<br><span class="default">&lt;?php<br>$filename_nfc </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">"UTF-8-MAC"</span><span class="keyword">, </span><span class="string">"UTF-8"</span><span class="keyword">, </span><span class="default">$filename_nfd</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111543">  
  <a class="name">
  <strong class="user"><em>miloshio at gmail dot com</em></strong></a><div class="date" title="2013-03-02 08:32"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111543">
<div class="phpcode"><code><span class="html">
Please keep in mind that iconv is not your magic stick by which you can convert anything to your desired encoding sheme.<br><br>Even if there is encoding declaration for text you're about to manipulate in PHP, there is always chances that there are some characters or character sequences that are in wrong encoding scheme and despite that your browser (for example) is displaying text to you properly.<br><br>These are situations with so-called mixed encoding. You have to:<br><br>detect current encoding for your string,<br><br>repair broken encoding sheme (here I'm struggling with different methods and third-party libraries such as forceutf8 on GitHub),<br><br>and in last step you can hope to good conversion results.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95726">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2010-01-18 11:37"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95726">
<div class="phpcode"><code><span class="html">
For text with special characters such as (é) &amp;eacute; which appears at 0xE9 in the ISO-8859-1 and at 0x82 in IBM-850. The correct output character set is 'IBM850' as:<br>('ISO-8859-1', 'IBM850', 'Québec')</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115285">  
  <a class="name">
  <strong class="user"><em>rasmus at mindplay dot dk</em></strong></a><div class="date" title="2014-06-27 11:52"><strong>2 months ago</strong></div>
  <div class="text" id="Hcom115285">
<div class="phpcode"><code><span class="html">
Note an important difference between iconv() and mb_convert_encoding() - if you're working with strings, as opposed to files, you most likely want mb_convert_encoding() and not iconv(), because iconv() will add a byte-order marker to the beginning of (for example) a UTF-32 string when converting from e.g. ISO-8859-1, which can throw off all your subsequent calculations and operations on the resulting string.<br><br>In other words, iconv() appears to be intended for use when converting the contents of files - whereas mb_convert_encoding() is intended for use when juggling strings internally, e.g. strings that aren't being read/written to/from files, but exchanged with some other media.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="94481">  
  <a class="name">
  <strong class="user"><em>Andries Seutens</em></strong></a><div class="date" title="2009-11-07 11:38"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom94481">
<div class="phpcode"><code><span class="html">
When doing transliteration, you have to make sure that your LC_COLLATE is properly set, otherwise the default POSIX will be used.<br><br>To transform "rené" into "rene" we could use the following code snippet:<br><br><span class="default">&lt;?php<br><br>setlocale</span><span class="keyword">(</span><span class="default">LC_CTYPE</span><span class="keyword">, </span><span class="string">'nl_BE.utf8'</span><span class="keyword">);<br><br></span><span class="default">$string </span><span class="keyword">= </span><span class="string">'rené'</span><span class="keyword">;<br></span><span class="default">$string </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII//TRANSLIT'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br><br>echo </span><span class="default">$string</span><span class="keyword">; </span><span class="comment">// outputs rene<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113925">  
  <a class="name">
  <strong class="user"><em>Daniel Klein</em></strong></a><div class="date" title="2013-12-18 05:16"><strong>8 months ago</strong></div>
  <div class="text" id="Hcom113925">
<div class="phpcode"><code><span class="html">
A function to convert UTF-8 to best-fit ASCII. Handles punctuation too. Characters it doesn't understand get converted to '?'.<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">utf8_to_ascii</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) {<br>&nbsp; &nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Includes combinations of characters that present as a single glyph<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">preg_replace_callback</span><span class="keyword">(</span><span class="string">'/\X/u'</span><span class="keyword">, </span><span class="default">__FUNCTION__</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; elseif (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) &amp;&amp; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) == </span><span class="default">1 </span><span class="keyword">&amp;&amp; </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// IGNORE characters that can't be TRANSLITerated to ASCII<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">"UTF-8"</span><span class="keyword">, </span><span class="string">"ASCII//IGNORE//TRANSLIT"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// The documentation says that iconv() returns false on failure but it returns ''<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">$text </span><span class="keyword">=== </span><span class="string">'' </span><span class="keyword">|| !</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="string">'?'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; elseif (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\w/'</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">)) {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// If the text contains any letters...<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\W+/'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);&nbsp;&nbsp; </span><span class="comment">// ...then remove all non-letters<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; else {&nbsp; </span><span class="comment">// $text was not a string<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$text</span><span class="keyword">;<br>}<br><br></span><span class="default">$text </span><span class="keyword">= </span><span class="string">'Française señor café 0123 කොහොමද ශ්‍රී ලංකා&nbsp; hello Žluťoučký kůň '<br></span><span class="keyword">. </span><span class="string">'ÀÁÂ,ÃÄÅ,Æ,ÇÈ,ÉÊË,ÌÍÎ,ÏÐÑ,ÒÓÔ,ÕÖØ,ÙÚÛ,ÜÝ,Þ,'<br></span><span class="keyword">. </span><span class="string">'ß,àáâ,ãäå,æ,çèé,êëì,íîï,ðñò,óôõ,öøù,úûýý,þ,ÿŔŕ '<br></span><span class="keyword">. </span><span class="string">'YA(亚） HE（何） Tra Mỹ'</span><span class="keyword">;<br>print(</span><span class="default">utf8_to_ascii</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">));<br></span><span class="comment">/* prints<br>Francaise senor cafe 0123 ???? ?? ?? hello Zlutoucky kun <br>AAA,AAA,AE,CE,EEE,III,IDN,OOO,OOO,UUU,UY,Th,<br>ss,aaa,aaa,ae,cee,eei,iii,dno,ooo,oou,uuyy,th,yRr <br>YA(?) HE(?) Tra My<br>*/<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91190">  
  <a class="name">
  <strong class="user"><em>martin at front of mind dot co dot uk</em></strong></a><div class="date" title="2009-05-29 03:33"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91190">
<div class="phpcode"><code><span class="html">
For transcoding values in an Excel generated CSV the following seems to work:<br><br><span class="default">&lt;?php <br>$value </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'Windows-1252'</span><span class="keyword">, </span><span class="string">'UTF-8//TRANSLIT'</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113139">  
  <a class="name">
  <strong class="user"><em>jorortega at gmail dot com</em></strong></a><div class="date" title="2013-09-04 03:52"><strong>11 months ago</strong></div>
  <div class="text" id="Hcom113139">
<div class="phpcode"><code><span class="html">
Be aware that iconv in PHP uses system implementations of locales and languages, what works under linux, normally doesn't in windows.<br><br>Also, you may notice that recent versions of linux (debian, ubuntu, centos, etc) the //TRANSLIT option doesn't work. since most distros doesn't include the intl packages (example: php5-intl and icuxx (where xx is a number) in debian) by default. And this because the intl package conflicts with another package needed for international DNS resolution.<br><br>Problem is that configuration is dependent of the sysadmin of the machine where you're hosted, so iconv is pretty much useless by default,&nbsp; depending on what configuration is used by your distro or the machine's admin.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="89075">  
  <a class="name">
  <strong class="user"><em>kikke</em></strong></a><div class="date" title="2009-02-20 04:50"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom89075">
<div class="phpcode"><code><span class="html">
You can use native iconv in Linux via passthru if all else failed.<br>Use the -c parameter to suppress error messages.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88893">  
  <a class="name">
  <strong class="user"><em>admin at studio-gepard dot pl</em></strong></a><div class="date" title="2009-02-12 03:20"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88893">
<div class="phpcode"><code><span class="html">
I noticed that iconv might return not entire string, and no error. It happens when iconv encounters characters it doesn't know how to convert to certain encoding.<br>Simplest way to check how it works is:<br><span class="default">&lt;?php<br>$text</span><span class="keyword">=</span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'utf-8'</span><span class="keyword">,</span><span class="string">'iso-8859-2'</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">);<br></span><span class="default">$text</span><span class="keyword">=</span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'utf-8'</span><span class="keyword">,</span><span class="string">'iso-8859-2'</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>the result will be $text till first encounter of iso-8859-2 -specific char (such as ą / ź which already was converted to ± / Ľ ). It's quite hard to catch this error and brings a lot of trouble. I got it with converting greek alpha into iso-8859-2 (should be &amp;alpha; but causes the error)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112490">  
  <a class="name">
  <strong class="user"><em>jessie at hotmail dot com</em></strong></a><div class="date" title="2013-06-21 10:31"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112490">
<div class="phpcode"><code><span class="html">
Provided that there is no invalid code point in the character chain for the input encoding, the //IGNORE option works as expected. No bug here.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111652">  
  <a class="name">
  <strong class="user"><em>Daniel Klein</em></strong></a><div class="date" title="2013-03-13 12:17"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111652">
<div class="phpcode"><code><span class="html">
You can use 'CP1252' instead of 'Windows-1252':<br><span class="default">&lt;?php<br></span><span class="comment">// These two lines are equivalent<br></span><span class="default">$result </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'Windows-1252'</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br></span><span class="default">$result </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'CP1252'</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>Note: The following code points are not valid in CP1252 and will cause errors.<br>129 (0x81)<br>141 (0x8D)<br>143 (0x8F)<br>144 (0x90)<br>157 (0x9D)<br>Use the following instead:<br><span class="default">&lt;?php<br></span><span class="comment">// Remove invalid code points, convert everything else<br></span><span class="default">$result </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'CP1252'</span><span class="keyword">, </span><span class="string">'UTF-8//IGNORE'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83238">  
  <a class="name">
  <strong class="user"><em>mirek at burkon dot org</em></strong></a><div class="date" title="2008-05-16 03:17"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83238">
<div class="phpcode"><code><span class="html">
If you need to strip as many national characters from UTF-8 as possible and keep the rest of input unchanged (i.e. convert whatever can be converted to ASCII and leave the rest), you can do it like this:<br><br><span class="default">&lt;?php<br>setlocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">'en_US.UTF8'</span><span class="keyword">);<br><br>function </span><span class="default">clearUTF</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$s1 </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII//TRANSLIT'</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">);<br>&nbsp; &nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ch1 </span><span class="keyword">= </span><span class="default">$s1</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ch2 </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="default">$ch1</span><span class="keyword">==</span><span class="string">'?'</span><span class="keyword">?</span><span class="default">$ch2</span><span class="keyword">:</span><span class="default">$ch1</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$r</span><span class="keyword">;<br>}<br><br>echo </span><span class="default">clearUTF</span><span class="keyword">(</span><span class="string">'Šíleně žluťoučký Vašek úpěl olol! This will remain untranslated: ᾡᾧῘઍિ૮'</span><span class="keyword">);<br></span><span class="comment">//outputs Silene zlutoucky Vasek upel olol! This will remain untranslated: ᾡᾧῘઍિ૮<br></span><span class="default">?&gt;<br></span><br>Just remember you HAVE TO set locale to some unicode encoding to make iconv handle //TRANSLIT correctly!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108752">  
  <a class="name">
  <strong class="user"><em>info at ozanakman dot com dot tr</em></strong></a><div class="date" title="2012-05-23 04:02"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108752">
<div class="phpcode"><code><span class="html">
Turkish characters is error with the used set_locale and strftime commands.<br><br>My key example:<br><span class="default">&lt;?php iconv</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">,</span><span class="string">'UTF-8'</span><span class="keyword">,</span><span class="default">strftime</span><span class="keyword">(</span><span class="string">'%d %B %Y %A'</span><span class="keyword">)); </span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="49434">  
  <a class="name">
  <strong class="user"><em>PHANTOm &lt;phantom at nix dot co dot il&gt;</em></strong></a><div class="date" title="2005-01-27 12:49"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom49434">
<div class="phpcode"><code><span class="html">
convert windows-1255 to utf-8 with the following code<br><span class="default">&lt;?php<br>$heb </span><span class="keyword">= </span><span class="string">'put hebrew text here'</span><span class="keyword">;<br></span><span class="default">$utf </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/([\xE0-\xFA])/e"</span><span class="keyword">,</span><span class="string">"chr(215).chr(ord(\${1})-80)"</span><span class="keyword">,</span><span class="default">$heb</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="47784">  
  <a class="name">
  <strong class="user"><em>aissam at yahoo dot com</em></strong></a><div class="date" title="2004-11-29 08:20"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47784">
<div class="phpcode"><code><span class="html">
For those who have troubles in displaying UCS-2 data on browser, here's a simple function that convert ucs2 to html unicode entities :<br><br><span class="default">&lt;?php<br><br> </span><span class="keyword">function </span><span class="default">ucs2html</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$str</span><span class="keyword">=</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">); </span><span class="comment">// if you are reading from file<br>&nbsp; &nbsp; </span><span class="default">$len</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$html</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br>&nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$len</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">+=</span><span class="default">2</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$html</span><span class="keyword">.=</span><span class="string">'&amp;#'</span><span class="keyword">.</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">])).<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%02s"</span><span class="keyword">,</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])))).</span><span class="string">';'</span><span class="keyword">;<br>&nbsp; &nbsp; return(</span><span class="default">$html</span><span class="keyword">);<br> }<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="47428">  
  <a class="name">
  <strong class="user"><em>vitek at 4rome dot ru</em></strong></a><div class="date" title="2004-11-15 11:53"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47428">
<div class="phpcode"><code><span class="html">
On some systems there may be no such function as iconv(); this is due to the following reason: a constant is defined named `iconv` with the value `libiconv`. So, the string PHP_FUNCTION(iconv) transforms to PHP_FUNCTION(libiconv), and you have to call libiconv() function instead of iconv().<br>I had seen this on FreeBSD, but I am sure that was a rather special build.<br>If you'd want not to be dependent on this behaviour, add the following to your script:<br><span class="default">&lt;?php<br></span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'iconv'</span><span class="keyword">) &amp;&amp; </span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'libiconv'</span><span class="keyword">)) {<br>&nbsp; &nbsp; function </span><span class="default">iconv</span><span class="keyword">(</span><span class="default">$input_encoding</span><span class="keyword">, </span><span class="default">$output_encoding</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">libiconv</span><span class="keyword">(</span><span class="default">$input_encoding</span><span class="keyword">, </span><span class="default">$output_encoding</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;<br></span>Thanks to tony2001 at phpclub.net for explaining this behaviour.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113316">  
  <a class="name">
  <strong class="user"><em>chicopeste at gmail dot com</em></strong></a><div class="date" title="2013-09-25 07:45"><strong>11 months ago</strong></div>
  <div class="text" id="Hcom113316">
<div class="phpcode"><code><span class="html">
iconv also support CP850.<br>I used iconv("CP850", "UTF-8//TRANSLIT", $var);<br>to convert from SQL_Latin1_General_CP850_CI_AI to UTF-8.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="48076">  
  <a class="name">
  <strong class="user"><em>SiMM</em></strong></a><div class="date" title="2004-12-10 11:15"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom48076">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php </span><span class="comment">// it's only example
<br></span><span class="keyword">function </span><span class="default">CP1251toUTF8</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">){
<br>&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br>&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">); ++</span><span class="default">$i</span><span class="keyword">){
<br>&nbsp; &nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">});
<br>&nbsp; &nbsp; if (</span><span class="default">$ch </span><span class="keyword">&lt; </span><span class="default">0x80</span><span class="keyword">) </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; else
<br>&nbsp; &nbsp; &nbsp; if (</span><span class="default">$ch </span><span class="keyword">&gt;= </span><span class="default">0xC0</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$ch </span><span class="keyword">&lt; </span><span class="default">0xF0</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD0"</span><span class="keyword">.</span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x90 </span><span class="keyword">+ </span><span class="default">$ch </span><span class="keyword">- </span><span class="default">0xC0</span><span class="keyword">); </span><span class="comment">// &amp;#1040;-&amp;#1071;, &amp;#1072;-&amp;#1087; (A-YA, a-p)
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">else </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD1"</span><span class="keyword">.</span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x80 </span><span class="keyword">+ </span><span class="default">$ch </span><span class="keyword">- </span><span class="default">0xF0</span><span class="keyword">); </span><span class="comment">// &amp;#1088;-&amp;#1103; (r-ya)
<br>&nbsp; &nbsp; &nbsp; </span><span class="keyword">else
<br>&nbsp; &nbsp; &nbsp; &nbsp; switch(</span><span class="default">$ch</span><span class="keyword">){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="default">0xA8</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD0\x81"</span><span class="keyword">; break; </span><span class="comment">// YO
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0xB8</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD1\x91"</span><span class="keyword">; break; </span><span class="comment">// yo
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ukrainian
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0xA1</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD0\x8E"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1038; (U)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0xA2</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD1\x9E"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1118; (u)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0xAA</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD0\x84"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1028; (e)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0xAF</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD0\x87"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1031; (I..)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0xB2</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD0\x86"</span><span class="keyword">; break; </span><span class="comment">// I (I)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0xB3</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD1\x96"</span><span class="keyword">; break; </span><span class="comment">// i (i)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0xBA</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD1\x94"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1108; (e)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0xBF</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD1\x97"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1111; (i..)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // chuvashian
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0x8C</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD3\x90"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1232; (A)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0x8D</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD3\x96"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1238; (E)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0x8E</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD2\xAA"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1194; (SCH)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0x8F</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD3\xB2"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1266; (U)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0x9C</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD3\x91"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1233; (a)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0x9D</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD3\x97"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1239; (e)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0x9E</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD2\xAB"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1195; (sch)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">case </span><span class="default">0x9F</span><span class="keyword">: </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\xD3\xB3"</span><span class="keyword">; break; </span><span class="comment">// &amp;#1267; (u)
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}
<br>&nbsp; }
<br>&nbsp; return </span><span class="default">$out</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="71192">  
  <a class="name">
  <strong class="user"><em>Locoluis</em></strong></a><div class="date" title="2006-11-15 12:36"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom71192">
<div class="phpcode"><code><span class="html">
The following are Microsoft encodings that are based on ISO-8859 but with the addition of those stupid control characters.<br><br>CP1250 is Eastern European (not ISO-8859-2)<br>CP1251 is Cyrillic (not ISO-8859-5)<br>CP1252 is Western European (not ISO-8859-1)<br>CP1253 is Greek (not ISO-8859-7)<br>CP1254 is Turkish (not ISO-8859-9)<br>CP1255 is Hebrew (not ISO-8859-8)<br>CP1256 is Arabic (not ISO-8859-6)<br>CP1257 is Baltic (not ISO-8859-4)<br><br>If you know you're getting input from a Windows machine with those encodings, use one of these as a parameter to iconv.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="47499">  
  <a class="name">
  <strong class="user"><em>nikolai-dot-zujev-at-gmail-dot-com</em></strong></a><div class="date" title="2004-11-18 01:14"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47499">
<div class="phpcode"><code><span class="html">
Here is an example how to convert windows-1251 (windows) or cp1251(Linux/Unix) encoded string to UTF-8 encoding.<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">cp1251_utf8</span><span class="keyword">( </span><span class="default">$sInput </span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$sOutput </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br><br>&nbsp; &nbsp; for ( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">( </span><span class="default">$sInput </span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++ )<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$iAscii </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">( </span><span class="default">$sInput</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] );<br><br>&nbsp; &nbsp; &nbsp; &nbsp; if ( </span><span class="default">$iAscii </span><span class="keyword">&gt;= </span><span class="default">192 </span><span class="keyword">&amp;&amp; </span><span class="default">$iAscii </span><span class="keyword">&lt;= </span><span class="default">255 </span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$sOutput </span><span class="keyword">.=&nbsp; </span><span class="string">"&amp;#"</span><span class="keyword">.( </span><span class="default">1040 </span><span class="keyword">+ ( </span><span class="default">$iAscii </span><span class="keyword">- </span><span class="default">192 </span><span class="keyword">) ).</span><span class="string">";"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; else if ( </span><span class="default">$iAscii </span><span class="keyword">== </span><span class="default">168 </span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$sOutput </span><span class="keyword">.= </span><span class="string">"&amp;#"</span><span class="keyword">.( </span><span class="default">1025 </span><span class="keyword">).</span><span class="string">";"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; else if ( </span><span class="default">$iAscii </span><span class="keyword">== </span><span class="default">184 </span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$sOutput </span><span class="keyword">.= </span><span class="string">"&amp;#"</span><span class="keyword">.( </span><span class="default">1105 </span><span class="keyword">).</span><span class="string">";"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$sOutput </span><span class="keyword">.= </span><span class="default">$sInput</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; return </span><span class="default">$sOutput</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78972">  
  <a class="name">
  <strong class="user"><em>mightye at gmail dot com</em></strong></a><div class="date" title="2007-11-05 05:01"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78972">
<div class="phpcode"><code><span class="html">
To strip bogus characters from your input (such as data from an unsanitized or other source which you can't trust to necessarily give you strings encoded according to their advertised encoding set), use the same character set as both the input and the output, with //IGNORE on the output charcter set.<br><span class="default">&lt;?php<br></span><span class="comment">// assuming '†' is actually UTF8, htmlentities will assume it's iso-8859&nbsp; <br>// since we did not specify in the 3rd argument of htmlentities.<br>// This generates "&amp;acirc;[bad utf-8 character]"<br>// If passed to any libxml, it will generate a fatal error.<br></span><span class="default">$badUTF8 </span><span class="keyword">= </span><span class="default">htmlentities</span><span class="keyword">(</span><span class="string">'†'</span><span class="keyword">);<br><br></span><span class="comment">// iconv() can ignore characters which cannot be encoded in the target character set<br></span><span class="default">$goodUTF8 </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">"utf-8"</span><span class="keyword">, </span><span class="string">"utf-8//IGNORE"</span><span class="keyword">, </span><span class="default">$badUTF8</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>The result of the example does not give you back the dagger character which was the original input (it got lost when htmlentities was misused to encode it incorrectly, though this is common from people not accustomed to dealing with extended character sets), but it does at least give you data which is sane in your target character set.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90054">  
  <a class="name">
  <strong class="user"><em>wulf dot kaiser at mpimf-heidelberg dot mpg dot de</em></strong></a><div class="date" title="2009-04-03 02:57"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90054">
<div class="phpcode"><code><span class="html">
Here a very small but useful way to handle text files before further using them:<br><br><span class="default">&lt;?php<br><br>$in </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="string">"/tmp/myfile.txt"</span><span class="keyword">);<br></span><span class="default">$out </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"/tmp/myfile.txt"</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">);<br><br>foreach (</span><span class="default">$in </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {<br><br>&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">, </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">"UTF-8"</span><span class="keyword">,</span><span class="string">"ISO-8859-1"</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">));}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111584">  
  <a class="name">
  <strong class="user"><em>hello at luka dot io</em></strong></a><div class="date" title="2013-03-06 01:00"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111584">
<div class="phpcode"><code><span class="html">
yet another "fix my horrible data" function, this one should convert windows-1250 entities into iso-8859-2, ready to be iconv()ed into utf8<br><br>to be applied when converting the entire thing from windows-1250 doesn't work<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">w1250_to_iso88592</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="comment">// map based on <a rel="nofollow" target="_blank">http://konfiguracja.c0.pl/iso02vscp1250en.html</a><br><br>&nbsp; &nbsp; </span><span class="default">$map </span><span class="keyword">= array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x8A</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xA9</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x8C</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xA6</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x8D</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xAB</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x8E</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xAE</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x8F</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xAC</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x9C</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xB6</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x9D</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xBB</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xA1</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xB7</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xA5</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xA1</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xBC</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xA5</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x9F</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xBC</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xB9</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xB1</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x9A</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xB9</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xBE</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xB5</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x9E</span><span class="keyword">) =&gt; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xBE</span><span class="keyword">),<br>&nbsp; &nbsp; );<br><br>&nbsp; &nbsp; return </span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$map</span><span class="keyword">);<br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103860">  
  <a class="name">
  <strong class="user"><em>marc at NOSPAM dot leftek dot com</em></strong></a><div class="date" title="2011-05-06 10:02"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103860">
<div class="phpcode"><code><span class="html">
A simple cleaning function [eg: iconv("UTF-8","UTF-8//IGNORE", $s)] may not be enough when receiving UTF8 input that needs to be saved in MySQL.&nbsp; Prior to MySQL v5.5 four byte sequences were not supported so a function is needed to strip these out as well:<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">for(</span><span class="default">$pos</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$strUtf8</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">; </span><span class="default">$pos </span><span class="keyword">&gt;= </span><span class="default">0 </span><span class="keyword">; </span><span class="default">$pos</span><span class="keyword">--){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$strUtf8</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">) &gt; </span><span class="default">0xEF</span><span class="keyword">) </span><span class="default">$strUtf8 </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$strUtf8</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">).</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$strUtf8</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">); <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.iconv.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:20:03 GMT -->


</body></html>