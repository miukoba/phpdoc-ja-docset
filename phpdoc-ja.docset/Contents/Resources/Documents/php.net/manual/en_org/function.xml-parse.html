<html><!-- Mirrored from php.net/manual/en/function.xml-parse.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:04:40 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>xml_parse</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.xml-parse.html">
 <link rel="shorturl" href="http://php.net/xml-parse">
 <link rel="alternate" href="http://php.net/xml-parse" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.xml.html">
 <link rel="prev" href="function.xml-parse-into-struct.html">
 <link rel="next" href="function.xml-parser-create-ns.html">

 <link rel="alternate" href="function.xml-parse.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.xml-parse.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.xml-parse.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.xml-parse.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.xml-parse.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.xml-parse.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.xml-parse.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.xml-parse.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.xml-parse.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.xml-parse.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.xml-parse.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.xml.html">XML Manipulation</a></li>      <li><a href="book.xml.html">XML Parser</a></li>      <li><a href="ref.xml.html">XML Parser Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.xml-parse" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">xml_parse</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">xml_parse</span> â€” <span class="dc-title">Start parsing an XML document</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.xml-parse-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><strong>xml_parse</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$parser</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$is_final</code><span class="initializer"> = false</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>xml_parse()</strong></span> parses an XML document. The handlers for
   the configured events are called as many times as necessary.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.xml-parse-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">parser</code></dt>

     <dd>

      <p class="para">
       A reference to the XML parser to use.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">data</code></dt>

     <dd>

      <p class="para">
       Chunk of data to parse.  A document may be parsed piece-wise by
       calling <span class="function"><strong>xml_parse()</strong></span> several times with new data,
       as long as the <code class="parameter">is_final</code> parameter is set and
       <strong><code>TRUE</code></strong> when the last data is parsed.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">is_final</code></dt>

     <dd>

      <p class="para">
       If set and <strong><code>TRUE</code></strong>, <code class="parameter">data</code> is the last piece of
       data sent in this parse.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.xml-parse-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns 1 on success or 0 on failure.
  </p>
  <p class="para">
   For unsuccessful parses, error information can be retrieved with
   <span class="function"><a href="function.xml-get-error-code.html" class="function">xml_get_error_code()</a></span>,
   <span class="function"><a href="function.xml-error-string.html" class="function">xml_error_string()</a></span>,
   <span class="function"><a href="function.xml-get-current-line-number.html" class="function">xml_get_current_line_number()</a></span>,
   <span class="function"><a href="function.xml-get-current-column-number.html" class="function">xml_get_current_column_number()</a></span> and
   <span class="function"><a href="function.xml-get-current-byte-index.html" class="function">xml_get_current_byte_index()</a></span>.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    Entity errors are reported at the end of the data thus only if
    <code class="parameter">is_final</code> is set and <strong><code>TRUE</code></strong>.
   </p>
  <p></p></blockquote>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="52567">  
  <a class="name">
  <strong class="user"><em>bbellwfu at gmail dot com</em></strong></a><div class="date" title="2005-05-05 02:51"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom52567">
<div class="phpcode"><code><span class="html">
Just improving a little bit on the code examples from tgrabietz and randlem below... everything in one pretty class, plus some checks in place so that the element data doesnt get split up (thanks to flobee on the xml_set_character_data_handler page)<br><br><span class="default">&lt;?php<br><br></span><span class="comment">/* Usage<br> Grab some XML data, either from a file, URL, etc. however you want. Assume storage in $strYourXML;<br><br> $objXML = new xml2Array();<br> $arrOutput = $objXML-&gt;parse($strYourXML);<br> print_r($arrOutput); //print it out, or do whatever!<br>&nbsp; <br>*/<br></span><span class="keyword">class </span><span class="default">xml2Array </span><span class="keyword">{<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; var </span><span class="default">$arrOutput </span><span class="keyword">= array();<br>&nbsp; &nbsp; var </span><span class="default">$resParser</span><span class="keyword">;<br>&nbsp; &nbsp; var </span><span class="default">$strXmlData</span><span class="keyword">;<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function </span><span class="default">parse</span><span class="keyword">(</span><span class="default">$strInputXML</span><span class="keyword">) {<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resParser </span><span class="keyword">= </span><span class="default">xml_parser_create </span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_set_object</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resParser</span><span class="keyword">,</span><span class="default">$this</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_set_element_handler</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resParser</span><span class="keyword">, </span><span class="string">"tagOpen"</span><span class="keyword">, </span><span class="string">"tagClosed"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_set_character_data_handler</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resParser</span><span class="keyword">, </span><span class="string">"tagData"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">strXmlData </span><span class="keyword">= </span><span class="default">xml_parse</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resParser</span><span class="keyword">,</span><span class="default">$strInputXML </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">strXmlData</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; die(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"XML error: %s at line %d"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_error_string</span><span class="keyword">(</span><span class="default">xml_get_error_code</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resParser</span><span class="keyword">)),<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_get_current_line_number</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resParser</span><span class="keyword">)));<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_parser_free</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resParser</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; function </span><span class="default">tagOpen</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">, </span><span class="default">$attrs</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tag</span><span class="keyword">=array(</span><span class="string">"name"</span><span class="keyword">=&gt;</span><span class="default">$name</span><span class="keyword">,</span><span class="string">"attrs"</span><span class="keyword">=&gt;</span><span class="default">$attrs</span><span class="keyword">); <br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">,</span><span class="default">$tag</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function </span><span class="default">tagData</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$tagData</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$tagData</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">][</span><span class="string">'tagData'</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">][</span><span class="string">'tagData'</span><span class="keyword">] .= </span><span class="default">$tagData</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">][</span><span class="string">'tagData'</span><span class="keyword">] = </span><span class="default">$tagData</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp;&nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function </span><span class="default">tagClosed</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">)-</span><span class="default">2</span><span class="keyword">][</span><span class="string">'children'</span><span class="keyword">][] = </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;<br></span><br>Will output something like...<br><br>&lt;snippet&gt;<br>Array<br>(<br>&nbsp; &nbsp; [0] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [name] =&gt; GETMESSAGESRESPONSE<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [attrs] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [children] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [name] =&gt; STATUS<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [attrs] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br><br>&lt;/snippet&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87920">  
  <a class="name">
  <strong class="user"><em>lz_speedy at web dot de</em></strong></a><div class="date" title="2008-12-30 10:20"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom87920">
<div class="phpcode"><code><span class="html">
Best seen xml2array function ever<br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">xml2array</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$get_attributes </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">, </span><span class="default">$priority </span><span class="keyword">= </span><span class="string">'tag'</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$contents </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'xml_parser_create'</span><span class="keyword">))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; return array ();<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">$parser </span><span class="keyword">= </span><span class="default">xml_parser_create</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">);<br>&nbsp; &nbsp; if (!(</span><span class="default">$fp </span><span class="keyword">= @ </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="string">'rb'</span><span class="keyword">)))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; return array ();<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$contents </span><span class="keyword">.= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">8192</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">xml_parser_set_option</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">XML_OPTION_TARGET_ENCODING</span><span class="keyword">, </span><span class="string">"UTF-8"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">xml_parser_set_option</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">XML_OPTION_CASE_FOLDING</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">xml_parser_set_option</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">XML_OPTION_SKIP_WHITE</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">xml_parse_into_struct</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$contents</span><span class="keyword">), </span><span class="default">$xml_values</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">xml_parser_free</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">);<br>&nbsp; &nbsp; if (!</span><span class="default">$xml_values</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; return; </span><span class="comment">//Hmm...<br>&nbsp; &nbsp; </span><span class="default">$xml_array </span><span class="keyword">= array ();<br>&nbsp; &nbsp; </span><span class="default">$parents </span><span class="keyword">= array ();<br>&nbsp; &nbsp; </span><span class="default">$opened_tags </span><span class="keyword">= array ();<br>&nbsp; &nbsp; </span><span class="default">$arr </span><span class="keyword">= array ();<br>&nbsp; &nbsp; </span><span class="default">$current </span><span class="keyword">= &amp; </span><span class="default">$xml_array</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$repeated_tag_index </span><span class="keyword">= array (); <br>&nbsp; &nbsp; foreach (</span><span class="default">$xml_values </span><span class="keyword">as </span><span class="default">$data</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; unset (</span><span class="default">$attributes</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">extract</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= array ();<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$attributes_data </span><span class="keyword">= array ();<br>&nbsp; &nbsp; &nbsp; &nbsp; if (isset (</span><span class="default">$value</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$priority </span><span class="keyword">== </span><span class="string">'tag'</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'value'</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; if (isset (</span><span class="default">$attributes</span><span class="keyword">) and </span><span class="default">$get_attributes</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$attributes </span><span class="keyword">as </span><span class="default">$attr </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$priority </span><span class="keyword">== </span><span class="string">'tag'</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$attributes_data</span><span class="keyword">[</span><span class="default">$attr</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'attr'</span><span class="keyword">][</span><span class="default">$attr</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">; </span><span class="comment">//Set all the attributes in a array called 'attr'<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$type </span><span class="keyword">== </span><span class="string">"open"</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; { <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$parent</span><span class="keyword">[</span><span class="default">$level </span><span class="keyword">-</span><span class="default">1</span><span class="keyword">] = &amp; </span><span class="default">$current</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">) or (!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$tag</span><span class="keyword">, </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">))))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">] = </span><span class="default">$result</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$attributes_data</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_attr'</span><span class="keyword">] = </span><span class="default">$attributes_data</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">] = </span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current </span><span class="keyword">= &amp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isset (</span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">][</span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">]] = </span><span class="default">$result</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">]++;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">] = array (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">],<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">); <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">] = </span><span class="default">2</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isset (</span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_attr'</span><span class="keyword">]))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">][</span><span class="string">'0_attr'</span><span class="keyword">] = </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_attr'</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unset (</span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_attr'</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$last_item_index </span><span class="keyword">= </span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">] - </span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current </span><span class="keyword">= &amp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">][</span><span class="default">$last_item_index</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; elseif (</span><span class="default">$type </span><span class="keyword">== </span><span class="string">"complete"</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!isset (</span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">]))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">] = </span><span class="default">$result</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">] = </span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$priority </span><span class="keyword">== </span><span class="string">'tag' </span><span class="keyword">and </span><span class="default">$attributes_data</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_attr'</span><span class="keyword">] = </span><span class="default">$attributes_data</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isset (</span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]) and </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">]))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">][</span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">]] = </span><span class="default">$result</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$priority </span><span class="keyword">== </span><span class="string">'tag' </span><span class="keyword">and </span><span class="default">$get_attributes </span><span class="keyword">and </span><span class="default">$attributes_data</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">][</span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">] . </span><span class="string">'_attr'</span><span class="keyword">] = </span><span class="default">$attributes_data</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">]++;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">] = array (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">],<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">); <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">] = </span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$priority </span><span class="keyword">== </span><span class="string">'tag' </span><span class="keyword">and </span><span class="default">$get_attributes</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isset (</span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_attr'</span><span class="keyword">]))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">][</span><span class="string">'0_attr'</span><span class="keyword">] = </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_attr'</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unset (</span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_attr'</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$attributes_data</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current</span><span class="keyword">[</span><span class="default">$tag</span><span class="keyword">][</span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">] . </span><span class="string">'_attr'</span><span class="keyword">] = </span><span class="default">$attributes_data</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$repeated_tag_index</span><span class="keyword">[</span><span class="default">$tag </span><span class="keyword">. </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">$level</span><span class="keyword">]++; </span><span class="comment">//0 and 1 index is already taken<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; elseif (</span><span class="default">$type </span><span class="keyword">== </span><span class="string">'close'</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current </span><span class="keyword">= &amp; </span><span class="default">$parent</span><span class="keyword">[</span><span class="default">$level </span><span class="keyword">-</span><span class="default">1</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return (</span><span class="default">$xml_array</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;<br></span><br>Returns a well formed array like the structure of the xml-document<br><br>&lt;root&gt;<br> &lt;child1&gt;<br>&nbsp; &lt;child1child1/&gt;<br> &lt;/child1&gt;<br>&lt;/root&gt;<br><br>create an array like <br>array[root][child1][child1child1]<br><br>lg</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76089">  
  <a class="name">
  <strong class="user"><em>dgrimes at scvl dot com</em></strong></a><div class="date" title="2007-06-29 06:14"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76089">
<div class="phpcode"><code><span class="html">
One note about magic quotes: magic_quotes_runtime needs to be disabled before parsing XML. It can cause strange errors during parsing. Just add the following at the top of your program:<br><br>set_magic_quotes_runtime(0);<br><br>If you need magic quotes you can use stripslashes or save the current magic quotes setting with get_magic_quotes_runtime() then disable and parse your XML and then restore the previous magic quotes setting.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="79790">  
  <a class="name">
  <strong class="user"><em>neoyahuu at yahoo dot com</em></strong></a><div class="date" title="2007-12-12 08:18"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom79790">
<div class="phpcode"><code><span class="html">
Instead of passing a URL, we can pass the XML content to this class (either you
<br> want to use CURL, Socks or fopen to retrieve it first) and instead of using 
<br> array, I'm using separator '|' to identify which data to get (in order to make 
<br> it short to retrieve a complex XML data). Here is my class with built-in fopen 
<br> which you can pass URL or you can pass the content instead :
<br>
<br>p/s : thanks to this great help page.
<br>
<br><span class="default">&lt;?php
<br>
<br></span><span class="keyword">class </span><span class="default">xx_xml </span><span class="keyword">{
<br>
<br>&nbsp; &nbsp; </span><span class="comment">// XML parser variables
<br>&nbsp; &nbsp; </span><span class="keyword">var </span><span class="default">$parser</span><span class="keyword">;
<br>&nbsp; &nbsp; var </span><span class="default">$name</span><span class="keyword">;
<br>&nbsp; &nbsp; var </span><span class="default">$attr</span><span class="keyword">;
<br>&nbsp; &nbsp; var </span><span class="default">$data&nbsp; </span><span class="keyword">= array();
<br>&nbsp; &nbsp; var </span><span class="default">$stack </span><span class="keyword">= array();
<br>&nbsp; &nbsp; var </span><span class="default">$keys</span><span class="keyword">;
<br>&nbsp; &nbsp; var </span><span class="default">$path</span><span class="keyword">;
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="comment">// either you pass url atau contents. 
<br>&nbsp; &nbsp; // Use 'url' or 'contents' for the parameter
<br>&nbsp; &nbsp; </span><span class="keyword">var </span><span class="default">$type</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="comment">// function with the default parameter value
<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">xx_xml</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">=</span><span class="string">'<a rel="nofollow" target="_blank">http://www.example.com</a>'</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">=</span><span class="string">'url'</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">type </span><span class="keyword">= </span><span class="default">$type</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">url&nbsp; </span><span class="keyword">= </span><span class="default">$url</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parse</span><span class="keyword">();
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="comment">// parse XML data
<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">parse</span><span class="keyword">()
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser </span><span class="keyword">= </span><span class="default">xml_parser_create</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_set_object</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_set_element_handler</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser</span><span class="keyword">, </span><span class="string">'startXML'</span><span class="keyword">, </span><span class="string">'endXML'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_set_character_data_handler</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser</span><span class="keyword">, </span><span class="string">'charXML'</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_parser_set_option</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser</span><span class="keyword">, </span><span class="default">XML_OPTION_CASE_FOLDING</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">type </span><span class="keyword">== </span><span class="string">'url'</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// if use type = 'url' now we open the XML with fopen
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (!(</span><span class="default">$fp </span><span class="keyword">= @</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">url</span><span class="keyword">, </span><span class="string">'rb'</span><span class="keyword">))) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">(</span><span class="string">"Cannot open </span><span class="keyword">{</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">url</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while ((</span><span class="default">$data </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">8192</span><span class="keyword">))) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">xml_parse</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">))) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'XML error at line %d column %d'</span><span class="keyword">, 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_get_current_line_number</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser</span><span class="keyword">), 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_get_current_column_number</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser</span><span class="keyword">)));
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; } else if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">type </span><span class="keyword">== </span><span class="string">'contents'</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Now we can pass the contents, maybe if you want 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // to use CURL, SOCK or other method.
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">,</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">url</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$lines </span><span class="keyword">as </span><span class="default">$val</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) == </span><span class="string">''</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">$val </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">xml_parse</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'XML error at line %d column %d'</span><span class="keyword">, 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_get_current_line_number</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser</span><span class="keyword">), 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_get_current_column_number</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parser</span><span class="keyword">)));
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; function </span><span class="default">startXML</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">)&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">stack</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = array();
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$keys </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$total </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">stack</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">stack </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">stack</span><span class="keyword">) &gt; </span><span class="default">1</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$total </span><span class="keyword">== </span><span class="default">$i</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$keys </span><span class="keyword">.= </span><span class="default">$key</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$keys </span><span class="keyword">.= </span><span class="default">$key </span><span class="keyword">. </span><span class="string">'|'</span><span class="keyword">; </span><span class="comment">// The saparator
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$keys </span><span class="keyword">.= </span><span class="default">$key</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$i</span><span class="keyword">++;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$keys</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">))&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$keys</span><span class="keyword">][] = </span><span class="default">$attr</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }&nbsp; &nbsp; else
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$keys</span><span class="keyword">] = </span><span class="default">$attr</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">keys </span><span class="keyword">= </span><span class="default">$keys</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; function </span><span class="default">endXML</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">)&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">end</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">stack</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">key</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">stack</span><span class="keyword">) == </span><span class="default">$name</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">stack</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; function </span><span class="default">charXML</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">)&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) != </span><span class="string">''</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">keys</span><span class="keyword">][</span><span class="string">'data'</span><span class="keyword">][] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">));
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; function </span><span class="default">error</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">)&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"&lt;div align=\"center\"&gt;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;font color=\"red\"&gt;&lt;b&gt;Error: </span><span class="default">$msg</span><span class="string">&lt;/b&gt;&lt;/font&gt;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; exit();
<br>&nbsp; &nbsp; }
<br>}
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>And example of retrieving XML data:
<br>p/s: example use to retrieve weather
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">include_once </span><span class="string">"xx_xml.class.php"</span><span class="keyword">;
<br>
<br></span><span class="comment">// Im using simple curl (the original is in class) to get the contents
<br>
<br></span><span class="default">$pageurl </span><span class="keyword">= </span><span class="string">"<a rel="nofollow" target="_blank">http://xml.weather.yahoo.com/forecastrss?p=MYXX0008&amp;u=c</a>"</span><span class="keyword">;
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$pageurl </span><span class="keyword">);
<br></span><span class="default">$thecontents </span><span class="keyword">= </span><span class="default">curl_exec </span><span class="keyword">( </span><span class="default">$ch </span><span class="keyword">);
<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br></span><span class="comment">// We want to pass only a ready XML content instead of URL
<br>// But if you want to use URL , skip the curl functions above and use this 
<br>// $xx4 = new xx_xml("url here",'url');
<br>
<br></span><span class="default">$xx4 </span><span class="keyword">= new </span><span class="default">xx_xml</span><span class="keyword">(</span><span class="default">$thecontents</span><span class="keyword">,</span><span class="string">'contents'</span><span class="keyword">); 
<br></span><span class="comment">// As you can see, we use saparator '|' instead of long array
<br></span><span class="default">$Code </span><span class="keyword">= </span><span class="default">$xx4</span><span class="keyword">-&gt;</span><span class="default">data </span><span class="keyword">[</span><span class="string">'rss|channel|item|yweather:condition'</span><span class="keyword">][</span><span class="string">'code'</span><span class="keyword">] ;
<br></span><span class="default">$Celcius </span><span class="keyword">= </span><span class="default">$xx4</span><span class="keyword">-&gt;</span><span class="default">data </span><span class="keyword">[</span><span class="string">'rss|channel|item|yweather:condition'</span><span class="keyword">][</span><span class="string">'temp'</span><span class="keyword">] ;
<br></span><span class="default">$Text </span><span class="keyword">= </span><span class="default">$xx4</span><span class="keyword">-&gt;</span><span class="default">data </span><span class="keyword">[</span><span class="string">'rss|channel|item|yweather:condition'</span><span class="keyword">][</span><span class="string">'text'</span><span class="keyword">] ;
<br></span><span class="default">$Cityname </span><span class="keyword">= </span><span class="default">$xx4</span><span class="keyword">-&gt;</span><span class="default">data </span><span class="keyword">[</span><span class="string">'rss|channel|yweather:location'</span><span class="keyword">][</span><span class="string">'city'</span><span class="keyword">] ;
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>Hope this helps.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="45890">  
  <a class="name">
  <strong class="user"><em>tgrabietz at bupnet dot de</em></strong></a><div class="date" title="2004-09-22 08:05"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom45890">
<div class="phpcode"><code><span class="html">
it's like randlem at gmail dot com's great code, without using a "class container" but parsing cdata. The script returns the tree-structure in a single array. <br><br><span class="default">&lt;?php<br>$file </span><span class="keyword">= </span><span class="string">'simple.xml'</span><span class="keyword">;<br></span><span class="default">$stack </span><span class="keyword">= array();<br><br>function </span><span class="default">startTag</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">, </span><span class="default">$attrs</span><span class="keyword">) <br>{<br>&nbsp;&nbsp; global </span><span class="default">$stack</span><span class="keyword">;<br>&nbsp;&nbsp; </span><span class="default">$tag</span><span class="keyword">=array(</span><span class="string">"name"</span><span class="keyword">=&gt;</span><span class="default">$name</span><span class="keyword">,</span><span class="string">"attrs"</span><span class="keyword">=&gt;</span><span class="default">$attrs</span><span class="keyword">);&nbsp;&nbsp; <br>&nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">,</span><span class="default">$tag</span><span class="keyword">);<br>&nbsp; <br>}<br><br>function </span><span class="default">cdata</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$cdata</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; global </span><span class="default">$stack</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">;<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; if(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$cdata</span><span class="keyword">))<br>&nbsp; &nbsp; {&nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$stack</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">][</span><span class="string">'cdata'</span><span class="keyword">]=</span><span class="default">$cdata</span><span class="keyword">;&nbsp; &nbsp; <br>&nbsp; &nbsp; }<br>}<br><br>function </span><span class="default">endTag</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">) <br>{<br>&nbsp;&nbsp; global </span><span class="default">$stack</span><span class="keyword">;&nbsp;&nbsp; <br>&nbsp;&nbsp; </span><span class="default">$stack</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)-</span><span class="default">2</span><span class="keyword">][</span><span class="string">'children'</span><span class="keyword">][] = </span><span class="default">$stack</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">];<br>&nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">);<br>}<br><br></span><span class="default">$xml_parser </span><span class="keyword">= </span><span class="default">xml_parser_create</span><span class="keyword">();<br></span><span class="default">xml_set_element_handler</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">, </span><span class="string">"startTag"</span><span class="keyword">, </span><span class="string">"endTag"</span><span class="keyword">);<br></span><span class="default">xml_set_character_data_handler</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">, </span><span class="string">"cdata"</span><span class="keyword">);<br><br></span><span class="default">$data </span><span class="keyword">= </span><span class="default">xml_parse</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">,</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">));<br>if(!</span><span class="default">$data</span><span class="keyword">) {<br>&nbsp;&nbsp; die(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"XML error: %s at line %d"</span><span class="keyword">,<br></span><span class="default">xml_error_string</span><span class="keyword">(</span><span class="default">xml_get_error_code</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">)),<br></span><span class="default">xml_get_current_line_number</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">)));<br>}<br><br></span><span class="default">xml_parser_free</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">);<br><br>print(</span><span class="string">"&lt;pre&gt;\n"</span><span class="keyword">);<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">);<br>print(</span><span class="string">"&lt;/pre&gt;\n"</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115507">  
  <a class="name">
  <strong class="user"><em>Programmerdude</em></strong></a><div class="date" title="2014-08-06 07:26"><strong>22 days ago</strong></div>
  <div class="text" id="Hcom115507">
<div class="phpcode"><code><span class="html">
Due to restrictions in libxml2 the maximum length of $data is 9.5MB. If you need to process more than 9.5MB you can do so by calling the function multiple times and setting $is_final on the last call.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97556">  
  <a class="name">
  <strong class="user"><em>Ashok dot 893 at gmail dot com</em></strong></a><div class="date" title="2010-04-25 10:52"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97556">
<div class="phpcode"><code><span class="html">
This is very simple way to convert all applicable objects into associative array.&nbsp; This works with not only SimpleXML but any kind of object. The input can be either array or object. This function also takes an options parameter as array of indices to be excluded in the return array. And keep in mind, this returns only the array of non-static and accessible variables of the object since using the function get_object_vars().<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">objectsIntoArray</span><span class="keyword">(</span><span class="default">$arrObjData</span><span class="keyword">, </span><span class="default">$arrSkipIndices </span><span class="keyword">= array())<br>{<br>&nbsp; &nbsp; </span><span class="default">$arrData </span><span class="keyword">= array();<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// if input is object, convert into array<br>&nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$arrObjData</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$arrObjData </span><span class="keyword">= </span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$arrObjData</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$arrObjData</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$arrObjData </span><span class="keyword">as </span><span class="default">$index </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) || </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">objectsIntoArray</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$arrSkipIndices</span><span class="keyword">); </span><span class="comment">// recursive call<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$index</span><span class="keyword">, </span><span class="default">$arrSkipIndices</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$arrData</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$arrData</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>Usage:<br><br><span class="default">&lt;?php<br>$xmlUrl </span><span class="keyword">= </span><span class="string">"feed.xml"</span><span class="keyword">; </span><span class="comment">// XML feed file/URL<br></span><span class="default">$xmlStr </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$xmlUrl</span><span class="keyword">);<br></span><span class="default">$xmlObj </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xmlStr</span><span class="keyword">);<br></span><span class="default">$arrXml </span><span class="keyword">= </span><span class="default">objectsIntoArray</span><span class="keyword">(</span><span class="default">$xmlObj</span><span class="keyword">);<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$arrXml</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76748">  
  <a class="name">
  <strong class="user"><em>joris dot landman at chello dot nl</em></strong></a><div class="date" title="2007-07-28 07:42"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76748">
<div class="phpcode"><code><span class="html">
This page has been a great help! I've adapted the examples below to make a class to parse an X(HT)ML file to a multidimensional array.<br><br>Spaces, tabs, breaks, etc. are included in the array as TEXT_NODE, since in XHTML they may be functional. A function to trim them can easily be added if so desired.<br><br>I've written my class to store multiple tags with the same name. In order to do this I've used nested arrays with the key NODES to store the order in which tags and data were parsed. These NODES arrays can be used as a blueprint to reconstruct the X(HT)ML part of the document in it's entirity, including formatting. (Doctype will have to be added for validity).<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">class </span><span class="default">my_xml_object </span><span class="keyword">{<br><br>&nbsp; &nbsp; var </span><span class="default">$xml_data</span><span class="keyword">; </span><span class="comment"># raw xml data from file<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">parse_xml_file</span><span class="keyword">(</span><span class="default">$my_uri</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_data </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">; </span><span class="comment"># clear previously parsed file and related variables<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$my_uri</span><span class="keyword">) &amp;&amp; </span><span class="default">is_readable</span><span class="keyword">(</span><span class="default">$my_uri</span><span class="keyword">)) { </span><span class="comment"># existing and readable uri?<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$my_file </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$my_uri</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while(</span><span class="default">$my_xml_input </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$my_file</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$my_uri</span><span class="keyword">))) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_data </span><span class="keyword">.= </span><span class="default">$my_xml_input</span><span class="keyword">; </span><span class="comment"># add data to xml_data<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$my_file</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">parse_xml_data</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_data</span><span class="keyword">); </span><span class="comment"># parse data<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">} else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">"supplied argument is not a URI to a (readable) file"</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; var </span><span class="default">$xml_array </span><span class="keyword">= Array(); </span><span class="comment"># xml array from parsed data<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">parse_xml_data</span><span class="keyword">(</span><span class="default">$my_data</span><span class="keyword">) { </span><span class="comment"># adapted from class by randlem@gmail.com, tgrabietz@bupnet.de, bbellwfu@gmail.com, Kyle Bresin - see <a rel="nofollow" target="_blank">http://nl2.php.net/xml_parse</a><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array </span><span class="keyword">= Array(</span><span class="default">0 </span><span class="keyword">=&gt; Array()); </span><span class="comment"># clear previously parsed file and related variables; populate first element<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$my_parser </span><span class="keyword">= </span><span class="default">xml_parser_create</span><span class="keyword">(); </span><span class="comment"># set up parser<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_set_object</span><span class="keyword">(</span><span class="default">$my_parser</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">); </span><span class="comment"># enable parser within object<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_set_element_handler</span><span class="keyword">(</span><span class="default">$my_parser</span><span class="keyword">, </span><span class="string">"xml_tag_open"</span><span class="keyword">, </span><span class="string">"xml_tag_close"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_set_character_data_handler</span><span class="keyword">(</span><span class="default">$my_parser</span><span class="keyword">, </span><span class="string">"xml_tag_data"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">xml_parse</span><span class="keyword">(</span><span class="default">$my_parser</span><span class="keyword">, </span><span class="default">$my_data</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">"data can not be parsed"</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">); </span><span class="comment"># inspect problems #die(sprintf("&lt;br /&gt;\n&lt;b&gt;Error&lt;/b&gt;:&nbsp; %s on line &lt;b&gt;%d&lt;/b&gt;&lt;br /&gt;\n", xml_error_string(xml_get_error_code($my_parser)), xml_get_current_line_number($my_parser)));<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_parser_free</span><span class="keyword">(</span><span class="default">$my_parser</span><span class="keyword">); </span><span class="comment"># free parser<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">; </span><span class="comment"># return xml array<br>&nbsp; &nbsp; </span><span class="keyword">}<br><br>&nbsp; &nbsp; var </span><span class="default">$my_branch </span><span class="keyword">= Array();<br>&nbsp; &nbsp; function </span><span class="default">xml_tag_open</span><span class="keyword">(</span><span class="default">$my_parser</span><span class="keyword">, </span><span class="default">$my_name</span><span class="keyword">, </span><span class="default">$my_attributes</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">my_branch</span><span class="keyword">, </span><span class="default">$my_name</span><span class="keyword">); </span><span class="comment"># add tag name to branch<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">[] = Array(); </span><span class="comment"># nest array in xml array for data<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$my_attributes</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">][</span><span class="string">"ATTRIBUTES"</span><span class="keyword">] = </span><span class="default">$my_attributes</span><span class="keyword">; </span><span class="comment"># nest attributes array<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; function </span><span class="default">xml_tag_data</span><span class="keyword">(</span><span class="default">$my_parser</span><span class="keyword">, </span><span class="default">$my_data</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">my_branch</span><span class="keyword">)][</span><span class="string">"TEXT_NODE"</span><span class="keyword">][] = </span><span class="default">$my_data</span><span class="keyword">; </span><span class="comment"># add data to nested array<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">my_branch</span><span class="keyword">)][</span><span class="string">"NODES"</span><span class="keyword">][] = </span><span class="string">"TEXT_NODE"</span><span class="keyword">; </span><span class="comment"># add text node to nested NODES array<br>&nbsp; &nbsp; </span><span class="keyword">}<br><br>&nbsp; &nbsp; function </span><span class="default">xml_tag_close</span><span class="keyword">(</span><span class="default">$my_parser</span><span class="keyword">, </span><span class="default">$my_name</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">my_branch</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">][</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">my_branch</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">my_branch</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">]][] = </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">]; </span><span class="comment"># nest arrays to follow document structure<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">); </span><span class="comment"># pop off element that was nested<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml_array</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">my_branch</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">][</span><span class="string">"NODES"</span><span class="keyword">][] = </span><span class="default">$my_name</span><span class="keyword">; </span><span class="comment"># add tag node to nested NODES array<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">my_branch</span><span class="keyword">); </span><span class="comment"># update branch<br>&nbsp; &nbsp; </span><span class="keyword">}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="75953">  
  <a class="name">
  <strong class="user"><em>php at b635 dot com</em></strong></a><div class="date" title="2007-06-23 10:17"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom75953">
<div class="phpcode"><code><span class="html">
The suggestions below have been a great help, but there was one thing I really needed...<br><br>I'm parsing Amazon XML data, and I wanted to be able to index into the array using something like:<br><br><span class="default">&lt;?php<br>&nbsp; </span><span class="keyword">print </span><span class="string">"&lt;p&gt;" </span><span class="keyword">. </span><span class="default">$strAXML</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">[</span><span class="default">ITEMLOOKUPRESPONSE</span><span class="keyword">][</span><span class="default">ITEMS</span><span class="keyword">][</span><span class="default">ITEM</span><span class="keyword">][</span><span class="default">SMALLIMAGE</span><span class="keyword">][</span><span class="default">URL</span><span class="keyword">];<br></span><span class="default">?&gt;<br></span><br>To solve this, I had to push all of the open tags onto a separate stack, add any tag data to the tail end of an attributed multi-dimensional array, and then pop the tag name off of the stack once it was closed...<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">class </span><span class="default">xml2array </span><span class="keyword">{<br>&nbsp; <br>&nbsp; var </span><span class="default">$arrOutput </span><span class="keyword">= array();<br>&nbsp; var </span><span class="default">$arrName </span><span class="keyword">= array();<br>&nbsp; var </span><span class="default">$objParser</span><span class="keyword">;<br>&nbsp; var </span><span class="default">$strXmlData</span><span class="keyword">;<br>&nbsp; <br>&nbsp; function </span><span class="default">parse</span><span class="keyword">(</span><span class="default">$strInputXML</span><span class="keyword">) {<br><br>&nbsp; &nbsp; </span><span class="comment">// standard XML parse object setup<br>&nbsp; <br>&nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">objParser </span><span class="keyword">= </span><span class="default">xml_parser_create </span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">xml_set_object</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">objParser</span><span class="keyword">,</span><span class="default">$this</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">xml_set_element_handler</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">objParser</span><span class="keyword">, </span><span class="string">"tagOpen"</span><span class="keyword">, </span><span class="string">"tagClosed"</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="default">xml_set_character_data_handler</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">objParser</span><span class="keyword">, </span><span class="string">"tagData"</span><span class="keyword">);<br>&nbsp; <br>&nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">strXmlData </span><span class="keyword">= </span><span class="default">xml_parse</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">objParser</span><span class="keyword">,</span><span class="default">$strInputXML </span><span class="keyword">);<br>&nbsp; &nbsp; if(!</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">strXmlData</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; die(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"XML error: %s at line %d"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_error_string</span><span class="keyword">(</span><span class="default">xml_get_error_code</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">objParser</span><span class="keyword">)),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">xml_get_current_line_number</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">objParser</span><span class="keyword">)));<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="default">xml_parser_free</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">objParser</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrOutput</span><span class="keyword">;<br>&nbsp; }<br><br>&nbsp; function </span><span class="default">tagOpen</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">, </span><span class="default">$attrs</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="comment">// push the current tag name to an array of still-open tag names<br>&nbsp; &nbsp; </span><span class="default">array_push </span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrName</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="comment">// merge the array of current attributes to the open tag<br>&nbsp; &nbsp; // NOTE: this does not currently handle multiple attributes with the same name<br>&nbsp; &nbsp; // (i.e. it will overwrite them with the last values)<br><br>&nbsp; &nbsp; </span><span class="default">$strEval </span><span class="keyword">= </span><span class="string">"\$this-&gt;arrOutput"</span><span class="keyword">;<br>&nbsp; &nbsp; foreach (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrName </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$strEval </span><span class="keyword">.= </span><span class="string">"[" </span><span class="keyword">. </span><span class="default">$value </span><span class="keyword">. </span><span class="string">"]"</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">$strEval </span><span class="keyword">= </span><span class="default">$strEval </span><span class="keyword">. </span><span class="string">" = array_merge (" </span><span class="keyword">. </span><span class="default">$strEval </span><span class="keyword">. </span><span class="string">",\$attrs);"</span><span class="keyword">;<br><br>&nbsp; &nbsp; eval (</span><span class="default">$strEval</span><span class="keyword">);<br>&nbsp; }<br><br>&nbsp; function </span><span class="default">tagData</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$tagData</span><span class="keyword">) {&nbsp;&nbsp; <br><br>&nbsp; &nbsp; </span><span class="comment">// set the latest open tag equal to the tag data<br><br>&nbsp; &nbsp; </span><span class="default">$strEval </span><span class="keyword">= </span><span class="string">"\$this-&gt;arrOutput"</span><span class="keyword">;<br>&nbsp; &nbsp; foreach (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrName </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$strEval </span><span class="keyword">.= </span><span class="string">"[" </span><span class="keyword">. </span><span class="default">$value </span><span class="keyword">. </span><span class="string">"]"</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="default">$strEval </span><span class="keyword">= </span><span class="default">$strEval </span><span class="keyword">. </span><span class="string">" = \$tagData;"</span><span class="keyword">;<br><br>&nbsp; &nbsp; eval (</span><span class="default">$strEval</span><span class="keyword">);<br>&nbsp; }<br><br>&nbsp; <br>&nbsp; function </span><span class="default">tagClosed</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">) {<br><br>&nbsp; &nbsp; </span><span class="comment">// pop this tag (and any subsequent tags) off the stack of open tag names<br><br>&nbsp; &nbsp; </span><span class="keyword">for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">count </span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrName</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">--) {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$currName </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrName</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; </span><span class="default">array_pop </span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arrName</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; if (</span><span class="default">$currName </span><span class="keyword">== </span><span class="default">$name</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; }<br><br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="63871">  
  <a class="name">
  <strong class="user"><em>james @at@ mercstudio dot Com dot nospam</em></strong></a><div class="date" title="2006-04-02 12:10"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom63871">
<div class="phpcode"><code><span class="html">
hi,<br><br>i've modified bbellwfu at gmail dot com to as below:<br><br>features added:<br>&nbsp; - toXML (convert back array to xml string)<br>&nbsp; - changed name, according to macromedia flash xml concept : children -&gt; childrens, tagdata -&gt; nodevalue, name -&gt; nodename,<br>&nbsp; - added pointer firstchild to childrens[0] (if exists)<br><br>some findings that i would like to share: <br> - &lt;![cdata[my value here]]&gt; (does not work on property value<br> - xml file must be htmlentity based (if not using cdata)<br> - xml line feed on node data seems to be double line feed on windows (still figuring why)<br> - xml line feed on attribute value seems to be ignored...<br><br>here's my code below :)<br><br>class u007xml<br>{<br>&nbsp;&nbsp; var $arrOutput = array();<br>&nbsp;&nbsp; var $resParser;<br>&nbsp;&nbsp; var $strXmlData;<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; <br>&nbsp; &nbsp; function u007xml($tfile = "")<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(trim($tfile) != "") { $this-&gt;loadFile($tfile);}<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function loadFile($tfile)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;thefile = $tfile;<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; $th = file($tfile);<br>&nbsp; &nbsp; &nbsp; &nbsp; $tdata = implode("\n", $th);<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; return $this-&gt;parse($tdata);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp;&nbsp; function parse($strInputXML) <br>&nbsp;&nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;resParser = xml_parser_create ();<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_set_object($this-&gt;resParser,$this);<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_set_element_handler($this-&gt;resParser, "tagOpen", "tagClosed");<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; xml_set_character_data_handler($this-&gt;resParser, "tagData");<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;strXmlData = xml_parse($this-&gt;resParser,$strInputXML );<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; if(!$this-&gt;strXmlData) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; die(sprintf("XML error: %s at line %d",<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_error_string(xml_get_error_code($this-&gt;resParser)),<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_get_current_line_number($this-&gt;resParser)));<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; xml_parser_free($this-&gt;resParser);<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; return $this-&gt;arrOutput;<br>&nbsp;&nbsp; }<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; //called on each xml tree<br>&nbsp;&nbsp; function tagOpen($parser, $name, $attrs) {<br>&nbsp; &nbsp; &nbsp;&nbsp; $tag=array("nodename"=&gt;$name,"attributes"=&gt;$attrs);<br>&nbsp; &nbsp; &nbsp;&nbsp; array_push($this-&gt;arrOutput,$tag);<br>&nbsp;&nbsp; }<br>&nbsp; <br>&nbsp; //called on data for xml<br>&nbsp;&nbsp; function tagData($parser, $tagData) {<br>&nbsp; &nbsp; &nbsp;&nbsp; if(trim($tagData)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset($this-&gt;arrOutput[count($this-&gt;arrOutput)-1]['nodevalue'])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;arrOutput[count($this-&gt;arrOutput)-1]['nodevalue'] .= $this-&gt;parseXMLValue($tagData);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;arrOutput[count($this-&gt;arrOutput)-1]['nodevalue'] = $this-&gt;parseXMLValue($tagData);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br>&nbsp; &nbsp; &nbsp;&nbsp; }<br>&nbsp;&nbsp; }<br>&nbsp; <br>&nbsp; //called when finished parsing<br>&nbsp;&nbsp; function tagClosed($parser, $name) {<br>&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;arrOutput[count($this-&gt;arrOutput)-2]['childrens'][] = $this-&gt;arrOutput[count($this-&gt;arrOutput)-1];<br>&nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp;&nbsp; if(count ($this-&gt;arrOutput[count($this-&gt;arrOutput)-2]['childrens'] ) == 1)<br>&nbsp; &nbsp; &nbsp;&nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;arrOutput[count($this-&gt;arrOutput)-2]['firstchild'] =&amp; $this-&gt;arrOutput[count($this-&gt;arrOutput)-2]['childrens'][0];<br>&nbsp; &nbsp; &nbsp;&nbsp; }<br>&nbsp; &nbsp; &nbsp;&nbsp; array_pop($this-&gt;arrOutput);<br>&nbsp;&nbsp; }<br><br>&nbsp; &nbsp; function toArray()<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; //not used, we can call loadString or loadFile instead...<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function parseXMLValue($tvalue)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; $tvalue = htmlentities($tvalue);<br>&nbsp; &nbsp; &nbsp; &nbsp; return $tvalue;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function toXML($tob = null)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; //return back xml<br>&nbsp; &nbsp; &nbsp; &nbsp; $result = "";<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; if( $tob == null)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tob = $this-&gt;arrOutput;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; if(!isset($tob))<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "XML Array empty...";<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return null;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; for($c = 0; $c &lt; count($tob); $c++)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result .="&lt;" . $tob[$c]["nodename"];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while (list($key, $value) = each($tob[$c]["attributes"]))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result .=" " . $key."=\"" . $this-&gt;parseXMLValue($value) . "\"";<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result .= "&gt;";<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //assign node value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( isset($tob[$c]["nodevalue"]) )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result .= $tob[$c]["nodevalue"];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( count($tob[$c]["childrens"]) &gt; 0 )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result .= "\r\n" . $this-&gt;toXML(&amp;$tob[$c]["childrens"]) . "";<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result .= "&lt;/" . $tob[$c]["nodename"] . "&gt;\r\n";<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; }//end of each array...<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; return $result;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function displayXML()<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; print_r($this-&gt;arrOutput);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function getXML($tob = null)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; return "&lt;?xml version='1.0'?&gt;\r\n" . $this-&gt;toXML($tob);<br>&nbsp; &nbsp; }<br><br>}//end of u007xml class<br><br>//examples below:<br><br>$xx = new u007xml();<br>$xx-&gt;loadFile("xml3.xml");<br><br>//$xx-&gt;displayXML();<br><br>print $xx-&gt;getXML();</span>
</code></div>
  </div>
 </div>
  <div class="note" id="63223">  
  <a class="name">
  <strong class="user"><em>ben at autonomic dot net</em></strong></a><div class="date" title="2006-03-16 05:12"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom63223">
<div class="phpcode"><code><span class="html">
bbellwfu's code does not handle 'text nodes' properly.<br>Consider the innards of a tag like &lt;root&gt;xxx&lt;tag2/&gt;yyy&lt;/root&gt;<br>The 'tagData' for root will be "xxxyyy" and you have lost all information about where "tag2" was in that sequence.<br><br>Quick and dirty hack. <br><br>Replace tagData with this code :<br>&nbsp;&nbsp; function tagData($parser, $tagData) {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $last_element=count($this-&gt;arrOutput)-1;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;arrOutput[$last_element]['children'][] = array("textnode",$tagData);&nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp;&nbsp; }<br><br>What this does is adds 'textnodes' as children of its containing parent, *in the right sequence* (rather like the internet browsers do it). This then lets you do some more sensible secondary work like recursively looking up internal references within the document...</span>
</code></div>
  </div>
 </div>
  <div class="note" id="60909">  
  <a class="name">
  <strong class="user"><em>Kyle Bresin</em></strong></a><div class="date" title="2006-01-19 03:15"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom60909">
<div class="phpcode"><code><span class="html">
Just wanted to note a small bug in bbellwfu's class (which is really great btw).<br><br>It fails to capture any datums which are equal to numerical zero.<br><br>The problem lies in the function tagData, the first if statement should be:<br><br>if(trim($tagData) != '') {</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57369">  
  <a class="name">
  <strong class="user"><em>tim at alloutinteraction dot com</em></strong></a><div class="date" title="2005-10-01 07:29"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom57369">
<div class="phpcode"><code><span class="html">
I wanted to create a really simple XML parser, but I found the array management in xml_parse a bit daunting. So I flattened my XML and parsed it using string matching. It wouldn't be difficult to add xml depth (of 2 plus levels) by modifying the parsedXML array.<br><br>&lt;?<br>// here's the raw html<br>$xmlRaw="&lt;order&gt;Order data&lt;/order&gt;&lt;label&gt;Label data&lt;/label&gt;&lt;control&gt;123&lt;/control&gt;";<br>// here are the xml field names<br>$xmlFieldNames=array("order", "label", "control");<br>// for each xml field...<br>foreach ($xmlFieldNames as $xmlField) {<br>&nbsp; &nbsp; if(strpos($xmlRaw,$xmlField)!==false){<br>&nbsp; &nbsp; &nbsp; &nbsp; // I've broken 1 single line into 4 for display purposes<br>&nbsp; &nbsp; &nbsp; &nbsp; $parsedXML[$xmlField]=substr($xmlRaw,<br>&nbsp; &nbsp; &nbsp; &nbsp; strpos($xmlRaw,"&lt;$xmlField&gt;")+strlen("&lt;$xmlField&gt;"),<br>&nbsp; &nbsp; &nbsp; &nbsp; strpos($xmlRaw,"&lt;/$xmlField&gt;")-strlen("&lt;$xmlField&gt;")<br>&nbsp; &nbsp; &nbsp; &nbsp; -strpos($xmlRaw,"&lt;$xmlField&gt;"));<br>&nbsp; &nbsp; }<br>}<br>print_r($parsedXML);<br>// prints: Array ( [order] =&gt; Order data [label] =&gt; Label data [control] =&gt; 123 )<br><br>?&gt;<br><br>Hope you find this useful (coded it while ill in bed with streaming cold, but felt much better afterwards!)<br><br>Tim (a lazy coder)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="50953">  
  <a class="name">
  <strong class="user"><em>alex dot garcia at noos dot fr</em></strong></a><div class="date" title="2005-03-14 01:47"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom50953">
<div class="phpcode"><code><span class="html">
Here is the inverse function which takes parsed xml array in entry and outputs xml string<br><br>enjoy !<br><br>function getXmlFromArray($root){<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; if(count($root) &gt; 0){<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $curr_name = $root['name'];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $attribs = $root['attrs'];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $curr_childs = $root['children'];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $curr_data = $root['cdata'];<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xml .= '&lt;'.$curr_name;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(count($attribs) &gt; 0){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $i = 1;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach($attribs as $key =&gt; $value){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $curr_attribs .= $key.'="'.$value.'"';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $i++;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($i &lt;= count($attribs)){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $curr_attribs .= ' ';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xml .= ' '.$curr_attribs;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($curr_data != ''){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xml .= '&gt;&lt;![CDATA['.$curr_data.']]&gt;&lt;/'.$curr_name.'&gt;';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(count($curr_childs) &gt; 0){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xml .= '&gt;';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach($curr_childs as $child){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xml .= getXmlFromArray($child);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xml .= '&lt;/'.$curr_name.'&gt;';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xml .= '/&gt;';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; } <br>&nbsp; &nbsp; &nbsp; &nbsp; return $xml;<br>&nbsp; &nbsp; }</span>
</code></div>
  </div>
 </div>
  <div class="note" id="45734">  
  <a class="name">
  <strong class="user"><em>ByK</em></strong></a><div class="date" title="2004-09-16 08:12"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom45734">
<div class="phpcode"><code><span class="html">
modified from yours code. I think it's work!!.<br>class CXml<br>{<br>&nbsp; &nbsp; var $xml_data;<br>&nbsp; &nbsp; var $obj_data;<br>&nbsp; &nbsp; var $pointer;<br><br>&nbsp; &nbsp; function CXml() { }<br>&nbsp;&nbsp; <br>&nbsp; &nbsp; function Set_xml_data( &amp;$xml_data )<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;index = 0;<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;pointer[] = &amp;$this-&gt;obj_data;<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; //strip white space between tags<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;xml_data = eregi_replace("&gt;"."[[:space:]]+"."&lt;","&gt;&lt;",$xml_data);<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;xml_parser = xml_parser_create( "UTF-8" );<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; xml_parser_set_option( $this-&gt;xml_parser, XML_OPTION_CASE_FOLDING, false );<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_set_object( $this-&gt;xml_parser, &amp;$this );<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_set_element_handler( $this-&gt;xml_parser, "_startElement", "_endElement");<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_set_character_data_handler( $this-&gt;xml_parser, "_cData" );<br>&nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; xml_parse( $this-&gt;xml_parser, $this-&gt;xml_data, true );<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_parser_free( $this-&gt;xml_parser );<br>&nbsp; &nbsp; }<br>&nbsp;&nbsp; <br>&nbsp; &nbsp; function _startElement( $parser, $tag, $attributeList )<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach( $attributeList as $name =&gt; $value )<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $value = $this-&gt;_cleanString( $value );<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $object-&gt;$name = $value;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; //replaces the special characters with the underscore (_) in tag name<br>&nbsp; &nbsp; &nbsp; &nbsp; $tag = preg_replace("/[:\-\. ]/", "_", $tag);<br>&nbsp; &nbsp; &nbsp; &nbsp; eval( "\$this-&gt;pointer[\$this-&gt;index]-&gt;" . $tag . "[] = \$object;" );<br>&nbsp; &nbsp; &nbsp; &nbsp; eval( "\$size = sizeof( \$this-&gt;pointer[\$this-&gt;index]-&gt;" . $tag . " );" );<br>&nbsp; &nbsp; &nbsp; &nbsp; eval( "\$this-&gt;pointer[] = &amp;\$this-&gt;pointer[\$this-&gt;index]-&gt;" . $tag . "[\$size-1];" );<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;index++;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; function _endElement( $parser, $tag )<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; array_pop( $this-&gt;pointer );<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;index--;<br>&nbsp; &nbsp; }<br>&nbsp;&nbsp; <br>&nbsp; &nbsp; function _cData( $parser, $data )<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; if (empty($this-&gt;pointer[$this-&gt;index])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (rtrim($data, "\n"))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;pointer[$this-&gt;index] = $data;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;pointer[$this-&gt;index] .= $data;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; function _cleanString( $string )<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; return utf8_decode( trim( $string ) );<br>&nbsp; &nbsp; }<br>}<br><br>$m_xml = new CXml();<br>$xml_data = file_get_contents( $filename );<br><br>$m_xml-&gt;Set_XML_data( $xml_data );<br><br>$newsid = $m_xml-&gt;obj_data-&gt;root[0]-&gt;NewsID[0];</span>
</code></div>
  </div>
 </div>
  <div class="note" id="36899">  
  <a class="name">
  <strong class="user"><em>michelek</em></strong></a><div class="date" title="2003-10-26 10:42"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom36899">
<div class="phpcode"><code><span class="html">
its maybe not better, but me thinks its more stright-forward<br><br>--INPUT:<br><br>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br>&lt;world&gt;<br>&nbsp; &nbsp; &lt;country name="sweden"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;city name="stockholm"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;user&gt;Adam&lt;/user&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;user&gt;Eva&lt;/user&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/city&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;city name="gï¿½teborg"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;user&gt;God&lt;/user&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/city&gt;<br>&nbsp; &nbsp; &lt;/country&gt;<br>&nbsp; &nbsp; &lt;country name="usa"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;city name="new york"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;user&gt;Clinton&lt;/user&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;user&gt;Bush&lt;/user&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/city&gt;<br>&nbsp; &nbsp; &lt;/country&gt;<br>&lt;/world&gt;<br><br>--CODE:<br>&lt;?<br>/**<br> * m_i_h_k_e_l_AT_w_w_DOT_e_e<br> * 26.10.2003<br>**/<br>$filename = "m.m.xml";<br>$xmlC = new XmlC();<br>$xml_data = file_get_contents( $filename );<br><br>$xmlC-&gt;Set_XML_data( $xml_data );<br><br>echo( "&lt;pre&gt;\n" );<br>print_r( $xmlC-&gt;obj_data );<br>echo( "&lt;/pre&gt;\n" );<br><br>class XmlC<br>{<br>&nbsp; var $xml_data;<br>&nbsp; var $obj_data;<br>&nbsp; var $pointer;<br><br>&nbsp; function XmlC()<br>&nbsp; {<br>&nbsp; }<br><br>&nbsp; function Set_xml_data( &amp;$xml_data )<br>&nbsp; {<br>&nbsp; &nbsp; $this-&gt;index = 0;<br>&nbsp; &nbsp; $this-&gt;pointer[] = &amp;$this-&gt;obj_data;<br><br>&nbsp; &nbsp; $this-&gt;xml_data = $xml_data;<br>&nbsp; &nbsp; $this-&gt;xml_parser = xml_parser_create( "UTF-8" );<br><br>&nbsp; &nbsp; xml_parser_set_option( $this-&gt;xml_parser, XML_OPTION_CASE_FOLDING, false );<br>&nbsp; &nbsp; xml_set_object( $this-&gt;xml_parser, &amp;$this );<br>&nbsp; &nbsp; xml_set_element_handler( $this-&gt;xml_parser, "_startElement", "_endElement");<br>&nbsp; &nbsp; xml_set_character_data_handler( $this-&gt;xml_parser, "_cData" );<br><br>&nbsp; &nbsp; xml_parse( $this-&gt;xml_parser, $this-&gt;xml_data, true );<br>&nbsp; &nbsp; xml_parser_free( $this-&gt;xml_parser );<br>&nbsp; }<br><br>&nbsp; function _startElement( $parser, $tag, $attributeList )<br>&nbsp; {<br>&nbsp; &nbsp; foreach( $attributeList as $name =&gt; $value )<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; $value = $this-&gt;_cleanString( $value );<br>&nbsp; &nbsp; &nbsp; $object-&gt;$name = $value;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; eval( "\$this-&gt;pointer[\$this-&gt;index]-&gt;" . $tag . "[] = \$object;" );<br>&nbsp; &nbsp; eval( "\$size = sizeof( \$this-&gt;pointer[\$this-&gt;index]-&gt;" . $tag . " );" );<br>&nbsp; &nbsp; eval( "\$this-&gt;pointer[] = &amp;\$this-&gt;pointer[\$this-&gt;index]-&gt;" . $tag . "[\$size-1];" );<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; $this-&gt;index++;<br>&nbsp; }<br><br>&nbsp; function _endElement( $parser, $tag )<br>&nbsp; {<br>&nbsp; &nbsp; array_pop( $this-&gt;pointer );<br>&nbsp; &nbsp; $this-&gt;index--;<br>&nbsp; }<br><br>&nbsp; function _cData( $parser, $data )<br>&nbsp; {<br>&nbsp; &nbsp; if( trim( $data ) )<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; $this-&gt;pointer[$this-&gt;index] = trim( $data );<br>&nbsp; &nbsp; }<br>&nbsp; }<br><br>&nbsp; function _cleanString( $string )<br>&nbsp; {<br>&nbsp; &nbsp; return utf8_decode( trim( $string ) );<br>&nbsp; }<br><br>}<br>?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="35708">  
  <a class="name">
  <strong class="user"><em>Adam Tylmad</em></strong></a><div class="date" title="2003-09-11 01:11"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom35708">
<div class="phpcode"><code><span class="html">
I've created a parser that returns an 
<br>object based on a xml document.
<br>
<br>example:
<br>&lt;?xml version="1.0" encoding="ISO-8859-1" ?&gt; 
<br>&lt;country name="sweden"&gt;
<br>&nbsp; &nbsp; &lt;city name="stockholm"&gt;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;user&gt;Adam&lt;/user&gt;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;user&gt;Eve&lt;/user&gt;
<br>&nbsp; &nbsp; &lt;/city&gt;
<br>&nbsp; &nbsp; &lt;city name="gï¿½teborg"&gt;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;user&gt;God&lt;/user&gt;
<br>&nbsp; &nbsp; &lt;/city&gt;
<br>&lt;/country&gt;
<br>&lt;country name="usa"&gt;
<br>&nbsp; &nbsp; &lt;city name="new york"&gt;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;user&gt;Clinton&lt;/user&gt;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;user&gt;Bush&lt;/user&gt;
<br>&nbsp; &nbsp; &lt;/city&gt;
<br>&lt;/country&gt;
<br>
<br>generates the following object structure:
<br>[country] =&gt; Array
<br>(
<br>&nbsp; &nbsp; [0] =&gt; stdClass Object
<br>&nbsp; &nbsp; &nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [name] =&gt; sweden
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [city] =&gt; Array
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; stdClass Object
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [name] =&gt; stockholm
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [user] =&gt; Array
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; Adam
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; Eve
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; stdClass Object
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [name] =&gt; gï¿½teborg
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [user] =&gt; God
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br>&nbsp; &nbsp; &nbsp; &nbsp; )
<br>&nbsp; &nbsp; [1] =&gt; stdClass Object
<br>&nbsp; &nbsp; &nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [name] =&gt; usa
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [city] =&gt; stdClass
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [name] =&gt; new york
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [user] =&gt; Array
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; Clinton
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; Bush
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br>&nbsp; &nbsp; &nbsp; &nbsp; )
<br>)
<br>
<br>Here is the code:
<br>
<br>class XMLParser {
<br>&nbsp; &nbsp; var $path;
<br>&nbsp; &nbsp; var $result;
<br>
<br>&nbsp; &nbsp; function XMLParser($encoding, $data) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;path = "\$this-&gt;result";
<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;index = 0;
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; $xml_parser = xml_parser_create($encoding);
<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_set_object($xml_parser, &amp;$this);
<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_set_element_handler($xml_parser, 'startElement', 'endElement');
<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_set_character_data_handler($xml_parser, 'characterData');
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_parse($xml_parser, $data, true);
<br>&nbsp; &nbsp; &nbsp; &nbsp; xml_parser_free($xml_parser);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; function startElement($parser, $tag, $attributeList) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eval("\$vars = get_object_vars(".$this-&gt;path.");");
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;path .= "-&gt;".$tag;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($vars and array_key_exists($tag, $vars)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; eval("\$data = ".$this-&gt;path.";");
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (is_array($data)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $index = sizeof($data);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;path .= "[".$index."]";
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else if (is_object($data)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; eval($this-&gt;path." = array(".$this-&gt;path.");");
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;path .= "[1]";
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eval($this-&gt;path." = null;");
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach($attributeList as $name =&gt; $value)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eval($this-&gt;path."-&gt;".$name. " = '".XMLParser::cleanString($value)."';");
<br>&nbsp; &nbsp; &nbsp; &nbsp; } 
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; function endElement($parser, $tag) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;path = substr($this-&gt;path, 0, strrpos($this-&gt;path, "-&gt;"));
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; function characterData($parser, $data) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; eval($this-&gt;path." = '".trim($data)."';");
<br>&nbsp; &nbsp; }
<br>}
<br>
<br>enjoy! And please make it better if you can ;-)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114623">  
  <a class="name">
  <strong class="user"><em>alejandro dot anv at gmail dot com</em></strong></a><div class="date" title="2014-03-13 01:00"><strong>5 months ago</strong></div>
  <div class="text" id="Hcom114623">
<div class="phpcode"><code><span class="html">
Here is my array2xml function. I made it because I coudn't find a generic recursive function that generates a prety formatted XML from any array.<br><br>Usage:<br><br><span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">xml2array</span><span class="keyword">(</span><span class="string">'rootname'</span><span class="keyword">,</span><span class="default">$myarray</span><span class="keyword">); </span><span class="default">?&gt;<br></span><br>or if you want to specify a spacing character(s) other than TAB:<br><br><span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">xml2array</span><span class="keyword">(</span><span class="string">'rootname'</span><span class="keyword">,</span><span class="default">$myarray</span><span class="keyword">,</span><span class="string">'&nbsp;&nbsp; '</span><span class="keyword">); </span><span class="default">?&gt;<br></span><br>or if you want avoid spacing at all<br><br><span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">xml2array</span><span class="keyword">(</span><span class="string">'rootname'</span><span class="keyword">,</span><span class="default">$myarray</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">); </span><span class="default">?&gt;<br></span><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">array2xml</span><span class="keyword">(</span><span class="default">$nombre</span><span class="keyword">,</span><span class="default">$valor</span><span class="keyword">,</span><span class="default">$tab</span><span class="keyword">=</span><span class="string">"\t"</span><span class="keyword">,</span><span class="default">$nivel</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">){<br><br>if (</span><span class="default">$nivel</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">) </span><span class="default">$r</span><span class="keyword">=</span><span class="string">'&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;'</span><span class="keyword">;<br><br></span><span class="default">$arr</span><span class="keyword">=!</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$nombre</span><span class="keyword">);<br></span><span class="default">$spacing</span><span class="keyword">=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="default">$tab</span><span class="keyword">,</span><span class="default">$nivel</span><span class="keyword">);<br>if (</span><span class="default">$tab</span><span class="keyword">!=</span><span class="string">''</span><span class="keyword">) </span><span class="default">$newline</span><span class="keyword">=</span><span class="string">"\n"</span><span class="keyword">;<br>else </span><span class="default">$newline</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br><br>if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$valor</span><span class="keyword">)){<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$valor</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$r</span><span class="keyword">.=</span><span class="default">$newline</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; </span><span class="comment">//$r.=str_repeat($tab,$nivel);<br>&nbsp; &nbsp; &nbsp; </span><span class="keyword">foreach(</span><span class="default">$valor </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$v</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$arr</span><span class="keyword">) </span><span class="default">$r</span><span class="keyword">.=</span><span class="string">"</span><span class="default">$spacing</span><span class="string">&lt;</span><span class="default">$nombre</span><span class="string">&gt;"</span><span class="keyword">;<br>&nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">))&nbsp; </span><span class="default">$r</span><span class="keyword">.=</span><span class="default">array2xml</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">,</span><span class="default">$v</span><span class="keyword">,</span><span class="default">$tab</span><span class="keyword">,</span><span class="default">$nivel</span><span class="keyword">+</span><span class="default">$arr</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$r</span><span class="keyword">.=</span><span class="string">"</span><span class="default">$spacing</span><span class="string">&lt;</span><span class="default">$k</span><span class="string">&gt;</span><span class="default">$v</span><span class="string">&lt;/</span><span class="default">$k</span><span class="string">&gt;</span><span class="default">$newline</span><span class="string">"</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$arr</span><span class="keyword">) </span><span class="default">$r</span><span class="keyword">.=</span><span class="string">"</span><span class="default">$spacing</span><span class="string">&lt;/</span><span class="default">$nombre</span><span class="string">&gt;</span><span class="default">$newline</span><span class="string">"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }</span><span class="comment">//foreach<br>&nbsp; &nbsp; &nbsp; </span><span class="keyword">}</span><span class="comment">//count<br>&nbsp;&nbsp; </span><span class="keyword">else </span><span class="default">$r</span><span class="keyword">.=</span><span class="string">"</span><span class="default">$spacing</span><span class="string">&lt;</span><span class="default">$nombre</span><span class="string">&gt;&lt;/</span><span class="default">$nombre</span><span class="string">&gt;"</span><span class="keyword">; </span><span class="comment">// it's an empty array<br>&nbsp;&nbsp; </span><span class="keyword">}<br>else {&nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp;&nbsp; if (</span><span class="default">$arr</span><span class="keyword">) </span><span class="default">$r</span><span class="keyword">.=</span><span class="string">"</span><span class="default">$spacing</span><span class="string">&lt;</span><span class="default">$nombre</span><span class="string">&gt;"</span><span class="keyword">;<br>&nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">.=</span><span class="default">$valor</span><span class="keyword">;<br>&nbsp; &nbsp;&nbsp; if (</span><span class="default">$arr</span><span class="keyword">) </span><span class="default">$r</span><span class="keyword">.=</span><span class="string">"&lt;/</span><span class="default">$nombre</span><span class="string">&gt;</span><span class="default">$newline</span><span class="string">"</span><span class="keyword">;<br>&nbsp; &nbsp;&nbsp; }<br><br>return </span><span class="default">$r</span><span class="keyword">;&nbsp;&nbsp; <br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="45700">  
  <a class="name">
  <strong class="user"><em>randlem at gmail dot com</em></strong></a><div class="date" title="2004-09-15 08:43"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom45700">
<div class="phpcode"><code><span class="html">
Here's a handy way to generate a tree that can be can be decended easily.<br><br><span class="default">&lt;?php<br>$file </span><span class="keyword">= </span><span class="string">'xmltest.xml'</span><span class="keyword">;<br><br></span><span class="default">$tag_tree </span><span class="keyword">= array();<br></span><span class="default">$stack </span><span class="keyword">= array();<br><br>class </span><span class="default">tag </span><span class="keyword">{<br>&nbsp; &nbsp; var </span><span class="default">$name</span><span class="keyword">;<br>&nbsp; &nbsp; var </span><span class="default">$attrs</span><span class="keyword">;<br>&nbsp; &nbsp; var </span><span class="default">$children</span><span class="keyword">;<br>&nbsp; &nbsp; function </span><span class="default">tag</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$attrs</span><span class="keyword">, </span><span class="default">$children</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">attrs </span><span class="keyword">= </span><span class="default">$attrs</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">children </span><span class="keyword">= </span><span class="default">$children</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>}<br><br>function </span><span class="default">startTag</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">, </span><span class="default">$attrs</span><span class="keyword">) {<br>&nbsp; &nbsp; global </span><span class="default">$tag_tree</span><span class="keyword">, </span><span class="default">$stack</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$tag </span><span class="keyword">= new </span><span class="default">tag</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">,</span><span class="default">$attrs</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">,</span><span class="default">$tag</span><span class="keyword">);<br>}<br><br>function </span><span class="default">endTag</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">) {<br>&nbsp; &nbsp; global </span><span class="default">$stack</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$stack</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)-</span><span class="default">2</span><span class="keyword">]-&gt;</span><span class="default">children</span><span class="keyword">[] = </span><span class="default">$stack</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">];<br>&nbsp; &nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">);<br>}<br><br></span><span class="default">$xml_parser </span><span class="keyword">= </span><span class="default">xml_parser_create</span><span class="keyword">();<br></span><span class="default">xml_set_element_handler</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">, </span><span class="string">"startTag"</span><span class="keyword">, </span><span class="string">"endTag"</span><span class="keyword">);<br><br></span><span class="default">$data </span><span class="keyword">= </span><span class="default">xml_parse</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">,</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">));<br>if(!</span><span class="default">$data</span><span class="keyword">) {<br>&nbsp; &nbsp; die(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"XML error: %s at line %d"</span><span class="keyword">,<br></span><span class="default">xml_error_string</span><span class="keyword">(</span><span class="default">xml_get_error_code</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">)),<br></span><span class="default">xml_get_current_line_number</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">)));<br>}<br><br></span><span class="default">xml_parser_free</span><span class="keyword">(</span><span class="default">$xml_parser</span><span class="keyword">);<br><br>print(</span><span class="string">"\n"</span><span class="keyword">);<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">);<br>print(</span><span class="string">"\n"</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.xml-parse.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:04:41 GMT -->


</body></html>