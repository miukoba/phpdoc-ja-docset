<html><!-- Mirrored from php.net/manual/en/soapclient.soapclient.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:05:10 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>SoapClient::SoapClient</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="soapclient.soapclient.html">
 <link rel="shorturl" href="soapclient.soapclient.html">
 <link rel="alternate" href="soapclient.soapclient.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="class.soapclient.html">
 <link rel="prev" href="soapclient.soapcall.html">
 <link rel="next" href="class.soapserver.html">

 <link rel="alternate" href="soapclient.soapclient.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/soapclient.soapclient.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/soapclient.soapclient.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/soapclient.soapclient.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/soapclient.soapclient.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/soapclient.soapclient.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/soapclient.soapclient.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/soapclient.soapclient.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/soapclient.soapclient.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/soapclient.soapclient.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/soapclient.soapclient.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.webservice.html">Web Services</a></li>      <li><a href="book.soap.html">SOAP</a></li>      <li><a href="class.soapclient.html">SoapClient</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="soapclient.soapclient" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">SoapClient::SoapClient</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.0.1)</p><p class="refpurpose"><span class="refname">SoapClient::SoapClient</span> â€” <span class="dc-title">SoapClient constructor</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-soapclient.soapclient-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><strong>SoapClient::SoapClient</strong></span>
    ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$wsdl</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   This constructor creates <a href="class.soapclient.html" class="classname">SoapClient</a> objects 
   in <em>WSDL</em> or <em>non-WSDL</em> mode.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-soapclient.soapclient-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">wsdl</code></dt>

     <dd>

      <p class="para">
       URI of the <em>WSDL</em> file or <strong><code>NULL</code></strong> if working in 
       <em>non-WSDL</em> mode.
      </p>
      <blockquote class="note"><p><strong class="note">Note</strong>: 
       </p><p class="para">
        During development, WSDL caching may be disabled by the
        use of the <em>soap.wsdl_cache_ttl</em> <var class="filename">php.ini</var> setting
        otherwise changes made to the WSDL file will have no effect until
        <em>soap.wsdl_cache_ttl</em> is expired. 
       </p>
      <p></p></blockquote>
     </dd>

    
    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       An array of options. If working in WSDL mode, this parameter is optional.
       If working in non-WSDL mode, the <em>location</em> and 
       <em>uri</em> options must be set, where <em>location</em>
       is the URL of the SOAP server to send the request to, and <em>uri</em>
       is the target namespace of the SOAP service.
      </p>
      <p class="para">
       The <em>style</em> and <em>use</em> options only work in
       non-WSDL mode. In WSDL mode, they come from the WSDL file.
      </p>
      <p class="para">
       The <em>soap_version</em> option should be one of either
       <strong><code>SOAP_1_1</code></strong> or <strong><code>SOAP_1_2</code></strong> to
       select SOAP 1.1 or 1.2, respectively. If omitted, 1.1 is used.
      </p>
      <p class="para">
       For HTTP authentication, the <em>login</em> and
       <em>password</em> options can be used to supply credentials. 
       For making an HTTP connection through
       a proxy server, the options <em>proxy_host</em>,
       <em>proxy_port</em>, <em>proxy_login</em>
       and <em>proxy_password</em> are also available.
       For HTTPS client certificate authentication use
       <em>local_cert</em> and <em>passphrase</em> options. An 
       authentication may be supplied in the <em>authentication</em> 
       option. The authentication method may be either 
       <strong><code>SOAP_AUTHENTICATION_BASIC</code></strong> (default) or 
       <strong><code>SOAP_AUTHENTICATION_DIGEST</code></strong>.
      </p>
      <p class="para">
       The <em>compression</em> option allows to use compression
       of HTTP SOAP requests and responses.
      </p>
      <p class="para">
       The <em>encoding</em> option defines internal character 
       encoding. This option does not change the encoding of SOAP requests (it is
       always utf-8), but converts strings into it.
      </p>
      <p class="para">
       The <em>trace</em> option enables tracing of request so faults 
       can be backtraced. This defaults to <strong><code>FALSE</code></strong>
      </p>
      <p class="para">
       The <em>classmap</em> option can be used to map some WSDL 
       types to PHP classes. This option must be an array with WSDL types 
       as keys and names of PHP classes as values.
      </p>
      <p class="para">
       Setting the boolean <em>trace</em> option enables use of the
       methods <a href="soapclient.getlastrequest.html" class="link">
       SoapClient-&gt;__getLastRequest</a>, 
      <a href="soapclient.getlastrequestheaders.html" class="link">
       SoapClient-&gt;__getLastRequestHeaders</a>,
       <a href="soapclient.getlastresponse.html" class="link">
       SoapClient-&gt;__getLastResponse</a> and
       <a href="soapclient.getlastresponseheaders.html" class="link">
       SoapClient-&gt;__getLastResponseHeaders</a>.
      </p>
      <p class="para">
       The <em>exceptions</em> option is a boolean value defining whether
       soap errors throw exceptions of type <a href="soapfault.soapfault.html" class="link">
       SoapFault</a>.
      </p>
      <p class="para">
       The <em>connection_timeout</em> option defines a timeout in seconds 
       for the connection to the SOAP service. This option does not define a timeout
       for services with slow responses. To limit the time to wait for calls to finish the 
       <a href="filesystem.configuration.html#ini.default-socket-timeout" class="link">default_socket_timeout</a> setting
       is available.
      </p>
      <p class="para">
       The <em>typemap</em> option is an array of type mappings.
       Type mapping is an array with keys <em>type_name</em>,
       <em>type_ns</em> (namespace URI), <em>from_xml</em>
       (callback accepting one string parameter) and <em>to_xml</em>
       (callback accepting one object parameter).
      </p>
      <p class="para">
       The <em>cache_wsdl</em> option is one of
       <strong><code>WSDL_CACHE_NONE</code></strong>,
       <strong><code>WSDL_CACHE_DISK</code></strong>,
       <strong><code>WSDL_CACHE_MEMORY</code></strong> or
       <strong><code>WSDL_CACHE_BOTH</code></strong>.
      </p>
      <p class="para">
       The <em>user_agent</em> option specifies string to use in
       <em>User-Agent</em> header.
      </p>
      <p class="para">
       The <em>stream_context</em> option is a <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>
       for <a href="context.html" class="link">context</a>.
      </p>
      <p class="para">
       The <em>features</em> option is a bitmask of
       <strong><code>SOAP_SINGLE_ELEMENT_ARRAYS</code></strong>,
       <strong><code>SOAP_USE_XSI_ARRAY_TYPE</code></strong>,
       <strong><code>SOAP_WAIT_ONE_WAY_CALLS</code></strong>.
      </p>
      <p class="para">
       The <em>keep_alive</em> option is a boolean value defining whether
       to send the <em>Connection: Keep-Alive</em> header or 
       <em>Connection: close</em>.
      </p>
      <p class="para">
       The <em>ssl_method</em> option is one of
       <strong><code>SOAP_SSL_METHOD_TLS</code></strong>,
       <strong><code>SOAP_SSL_METHOD_SSLv2</code></strong>,
       <strong><code>SOAP_SSL_METHOD_SSLv3</code></strong> or
       <strong><code>SOAP_SSL_METHOD_SSLv23</code></strong>.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 errors" id="refsect1-soapclient.soapclient-errors">
  <h3 class="title">Errors/Exceptions</h3>
  <p class="para">
   <span class="methodname"><strong>SoapClient::SoapClient()</strong></span> will generate an
   <strong><code>E_ERROR</code></strong> error if the <em>location</em> and
   <em>uri</em> options aren't provided in non-WSDL mode.
  </p>
  <p class="para">
   A <a href="class.soapfault.html" class="classname">SoapFault</a> exception will be thrown if the
   <code class="parameter">wsdl</code> URI cannot be loaded.
  </p>
 </div>


<div class="refsect1 changelog" id="refsect1-soapclient.soapclient-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   </p><table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.5.0</td>
       <td>
        New <em>ssl_method</em> option.
       </td>
      </tr>

      <tr>
       <td>5.4.0</td>
       <td>
        New <em>keep_alive</em> option.
       </td>
      </tr>

     </tbody>
    
   </table>

  <p></p>
 </div>


 <div class="refsect1 examples" id="refsect1-soapclient.soapclient-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-5436">
    <p><strong>Example #1 <span class="function"><strong>SoapClient::SoapClient()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'soap_version'&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">SOAP_1_2</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'login'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"some_name"</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'password'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"some_password"</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'proxy_host'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'proxy_port'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">8080</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'proxy_host'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'proxy_port'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">8080</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'proxy_login'&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"some_name"</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'proxy_password'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"some_password"</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'local_cert'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"cert_key.pem"</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #0000BB">null</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'location'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"http://localhost/soap.php"</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'uri'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"http://test-uri/"</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #0000BB">null</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'location'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"http://localhost/soap.php"</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'uri'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"http://test-uri/"</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'style'&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">SOAP_DOCUMENT</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'use'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">SOAP_LITERAL</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">$client&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;<br>&nbsp;&nbsp;array(</span><span style="color: #DD0000">'compression'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">SOAP_COMPRESSION_ACCEPT&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">SOAP_COMPRESSION_GZIP</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">$server&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"some.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'encoding'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'ISO-8859-1'</span><span style="color: #007700">));<br><br>class&nbsp;</span><span style="color: #0000BB">MyBook&nbsp;</span><span style="color: #007700">{<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$title</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$author</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #0000BB">$server&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SoapClient</span><span style="color: #007700">(</span><span style="color: #DD0000">"books.wsdl"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'classmap'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'book'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"MyBook"</span><span style="color: #007700">)));<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="97273">  
  <a class="name">
  <strong class="user"><em>bhargav dot khatana at gmail dot com</em></strong></a><div class="date" title="2010-04-11 11:10"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97273">
<div class="phpcode"><code><span class="html">
It took me longer than a week to figure out how to implement WSSE (Web Service Security) headers in native PHP SOAP. There are no much resource available on this, so thought to add this here for community benefit.
<br>
<br>Step1: Create two classes to create a structure for WSSE headers
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">class </span><span class="default">clsWSSEAuth </span><span class="keyword">{
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; private </span><span class="default">$Username</span><span class="keyword">; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; private </span><span class="default">$Password</span><span class="keyword">;&nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Username</span><span class="keyword">=</span><span class="default">$username</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Password</span><span class="keyword">=</span><span class="default">$password</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>}
<br>
<br>class </span><span class="default">clsWSSEToken </span><span class="keyword">{
<br>&nbsp; &nbsp; &nbsp; &nbsp; private </span><span class="default">$UsernameToken</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; function </span><span class="default">__construct </span><span class="keyword">(</span><span class="default">$innerVal</span><span class="keyword">){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">UsernameToken </span><span class="keyword">= </span><span class="default">$innerVal</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>Step2: Create Soap Variables for UserName and Password
<br>
<br><span class="default">&lt;?php
<br>$username </span><span class="keyword">= </span><span class="default">1111</span><span class="keyword">;
<br></span><span class="default">$password </span><span class="keyword">= </span><span class="default">1111</span><span class="keyword">;
<br>
<br></span><span class="comment">//Check with your provider which security name-space they are using.
<br></span><span class="default">$strWSSENS </span><span class="keyword">= </span><span class="string">"<a rel="nofollow" target="_blank">http://schemas.xmlsoap.org/ws/2002/07/secext</a>"</span><span class="keyword">;
<br>
<br></span><span class="default">$objSoapVarUser </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">);
<br></span><span class="default">$objSoapVarPass </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Step3: Create Object for Auth Class and pass in soap var
<br>
<br><span class="default">&lt;?php
<br>$objWSSEAuth </span><span class="keyword">= new </span><span class="default">clsWSSEAuth</span><span class="keyword">(</span><span class="default">$objSoapVarUser</span><span class="keyword">, </span><span class="default">$objSoapVarPass</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Step4: Create SoapVar out of object of Auth class
<br>
<br><span class="default">&lt;?php
<br>$objSoapVarWSSEAuth </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$objWSSEAuth</span><span class="keyword">, </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="string">'UsernameToken'</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Step5: Create object for Token Class
<br>
<br><span class="default">&lt;?php
<br>$objWSSEToken </span><span class="keyword">= new </span><span class="default">clsWSSEToken</span><span class="keyword">(</span><span class="default">$objSoapVarWSSEAuth</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Step6: Create SoapVar out of object of Token class
<br>
<br><span class="default">&lt;?php
<br>$objSoapVarWSSEToken </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$objWSSEToken</span><span class="keyword">, </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="string">'UsernameToken'</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Step7: Create SoapVar for 'Security' node
<br>
<br><span class="default">&lt;?php
<br>$objSoapVarHeaderVal</span><span class="keyword">=new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$objSoapVarWSSEToken</span><span class="keyword">, </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="string">'Security'</span><span class="keyword">, </span><span class="default">$strWSSENS</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Step8: Create header object out of security soapvar
<br>
<br><span class="default">&lt;?php
<br>$objSoapVarWSSEHeader </span><span class="keyword">= new </span><span class="default">SoapHeader</span><span class="keyword">(</span><span class="default">$strWSSENS</span><span class="keyword">, </span><span class="string">'Security'</span><span class="keyword">, </span><span class="default">$objSoapVarHeaderVal</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://abce.com</a>'</span><span class="keyword">);
<br>
<br></span><span class="comment">//Third parameter here makes 'mustUnderstand=1
<br>//Forth parameter generates 'actor="<a rel="nofollow" target="_blank">http://abce.com</a>"'
<br></span><span class="default">?&gt;
<br></span>
<br>Step9: Create object of Soap Client
<br>
<br><span class="default">&lt;?php
<br>$objClient </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$WSDL</span><span class="keyword">, </span><span class="default">$arrOptions</span><span class="keyword">); 
<br></span><span class="default">?&gt;
<br></span>
<br>Step10: Set headers for soapclient object
<br>
<br><span class="default">&lt;?php
<br>$objClient</span><span class="keyword">-&gt;</span><span class="default">__setSoapHeaders</span><span class="keyword">(array(</span><span class="default">$objSoapVarWSSEHeader</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>Step 11: Final call to method
<br>
<br><span class="default">&lt;?php
<br>$objResponse </span><span class="keyword">= </span><span class="default">$objClient</span><span class="keyword">-&gt;</span><span class="default">__soapCall</span><span class="keyword">(</span><span class="default">$strMethod</span><span class="keyword">, </span><span class="default">$requestPayloadString</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114976">  
  <a class="name">
  <strong class="user"><em>Peter</em></strong></a><div class="date" title="2014-05-08 02:18"><strong>3 months ago</strong></div>
  <div class="text" id="Hcom114976">
<div class="phpcode"><code><span class="html">
if you need to use ws-security with a nonce and a timestamp, you can use this :<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">class </span><span class="default">WsseAuthHeader </span><span class="keyword">extends </span><span class="default">SoapHeader </span><span class="keyword">{<br><br>private </span><span class="default">$wss_ns </span><span class="keyword">= </span><span class="string">'<a rel="nofollow" target="_blank">http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd</a>'</span><span class="keyword">;<br>private </span><span class="default">$wsu_ns </span><span class="keyword">= </span><span class="string">'<a rel="nofollow" target="_blank">http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd</a>'</span><span class="keyword">;<br><br>function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pass</span><span class="keyword">) {<br><br>&nbsp; &nbsp; </span><span class="default">$created </span><span class="keyword">= </span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">'Y-m-d\TH:i:s\Z'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$nonce </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">$passdigest </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">( </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">, </span><span class="default">sha1</span><span class="keyword">( </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">, </span><span class="default">$nonce</span><span class="keyword">) . </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'a*'</span><span class="keyword">,</span><span class="default">$created</span><span class="keyword">).&nbsp; </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'a*'</span><span class="keyword">,</span><span class="default">$pass</span><span class="keyword">))));<br><br>&nbsp; &nbsp; </span><span class="default">$auth </span><span class="keyword">= new </span><span class="default">stdClass</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">-&gt;</span><span class="default">Username </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$user</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">-&gt;</span><span class="default">Password </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$pass</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">-&gt;</span><span class="default">Nonce </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$passdigest</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">-&gt;</span><span class="default">Created </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$created</span><span class="keyword">, </span><span class="default">XSD_STRING</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wsu_ns</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">$username_token </span><span class="keyword">= new </span><span class="default">stdClass</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">$username_token</span><span class="keyword">-&gt;</span><span class="default">UsernameToken </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$auth</span><span class="keyword">, </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="string">'UsernameToken'</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">$security_sv </span><span class="keyword">= new </span><span class="default">SoapVar</span><span class="keyword">(<br>&nbsp; &nbsp; &nbsp; &nbsp; new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$username_token</span><span class="keyword">, </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="string">'UsernameToken'</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="string">'Security'</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">wss_ns</span><span class="keyword">, </span><span class="string">'Security'</span><span class="keyword">, </span><span class="default">$security_sv</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>}<br>}<br><br></span><span class="default">?&gt;<br></span><br>and with your SoapClient do :<br><br><span class="default">&lt;?php<br>$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">"<a rel="nofollow" target="_blank">http://host/path</a>"</span><span class="keyword">);<br></span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__setSoapHeaders</span><span class="keyword">(Array(new </span><span class="default">WsseAuthHeader</span><span class="keyword">(</span><span class="string">"user"</span><span class="keyword">, </span><span class="string">"pass"</span><span class="keyword">)));<br></span><span class="default">?&gt;<br></span><br>works for me. based on a stackoverlfow post which only did the username and password, not the nonce and the timestamp</span>
</code></div>
  </div>
 </div>
  <div class="note" id="54657">  
  <a class="name">
  <strong class="user"><em>Jim Plush</em></strong></a><div class="date" title="2005-07-11 12:56"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom54657">
<div class="phpcode"><code><span class="html">
As of version 5.0.4 you can now dynamically change your location even if you're using a wsdl<br><br><span class="default">&lt;?php<br><br>$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">"<a rel="nofollow" target="_blank">http://some.host.net/wsdl/somefile.wsdl</a>"</span><span class="keyword">,array(<br>&nbsp; &nbsp; </span><span class="string">"location" </span><span class="keyword">=&gt; </span><span class="string">'myurl.com'</span><span class="keyword">));<br><br></span><span class="default">?&gt;<br></span><br>notice you can now use the "location" key. <br>This means you can have the same wsdl file not define a location until runtime which is great if you have a development test site or if you distribute your files to other companies. <br>Prior to this change you would have to ship a custom wsdl file to every client you had with their location hardcoded.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103305">  
  <a class="name">
  <strong class="user"><em>simonlang at gmx dot ch</em></strong></a><div class="date" title="2011-04-06 06:35"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103305">
<div class="phpcode"><code><span class="html">
Example for a soap client with HTTP authentication over a proxy:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">new </span><span class="default">SoapClient</span><span class="keyword">(
<br>&nbsp; &nbsp; </span><span class="string">'service.wsdl'</span><span class="keyword">,
<br>&nbsp; &nbsp; array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Stuff for development.
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'trace' </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'exceptions' </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'cache_wsdl' </span><span class="keyword">=&gt; </span><span class="default">WSDL_CACHE_NONE</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'features' </span><span class="keyword">=&gt; </span><span class="default">SOAP_SINGLE_ELEMENT_ARRAYS</span><span class="keyword">,
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Auth credentials for the SOAP request.
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'login' </span><span class="keyword">=&gt; </span><span class="string">'username'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'password' </span><span class="keyword">=&gt; </span><span class="string">'password'</span><span class="keyword">,
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Proxy url.
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'proxy_host' </span><span class="keyword">=&gt; </span><span class="string">'example.com'</span><span class="keyword">, </span><span class="comment">// Do not add the schema here (http or https). It won't work.
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'proxy_port' </span><span class="keyword">=&gt; </span><span class="default">44300</span><span class="keyword">,
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Auth credentials for the proxy.
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'proxy_login' </span><span class="keyword">=&gt; </span><span class="default">NULL</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'proxy_password' </span><span class="keyword">=&gt; </span><span class="default">NULL</span><span class="keyword">,
<br>&nbsp; &nbsp; )
<br>);
<br></span><span class="default">?&gt;
<br></span>
<br>Providing an URL to a WSDL file on the remote server (which as well is protected with HTTP authentication) didn't work. I downloaded the WSDL and stored it on the local server.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73082">  
  <a class="name">
  <strong class="user"><em>lsmith at php dot net</em></strong></a><div class="date" title="2007-02-08 07:20"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73082">
<div class="phpcode"><code><span class="html">
As noted in the bug report <a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=36226,</a> it is considered a feature that sequences with a single element do not come out as arrays. To override this "feature" you can do the following:<br><br>$x = new SoapClient($wsdl, array('features' =&gt;<br>SOAP_SINGLE_ELEMENT_ARRAYS));</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101491">  
  <a class="name">
  <strong class="user"><em>tatupheba at gmail dot com</em></strong></a><div class="date" title="2010-12-20 02:30"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101491">
<div class="phpcode"><code><span class="html">
Hello folks!<br><br>A hint for developers:<br><br>When programming some soap server set the "soap.wsdl_cache_enabled" directive in php.ini file to 0:<br><br>soap.wsdl_cache_enabled=0<br><br>Otherwise it will give a bunch of strange errors saying that your wsdl is incorrect or is missing.<br><br>Doing that will save you from a lot of useless pain.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86004">  
  <a class="name">
  <strong class="user"><em>sniper</em></strong></a><div class="date" title="2008-09-27 11:46"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom86004">
<div class="phpcode"><code><span class="html">
i was looking for a good example and couldnt find one,<br>finally found it somewhere(forgot where) i think this is<br>the best example to make a soap request with multiple params<br>&nbsp;&nbsp; <br>$params-&gt;AWSAccessKeyId = AMAZON_API_KEY;<br>$params-&gt;Request-&gt;SearchIndex = 'Books';<br>$params-&gt;Request-&gt;Keywords = 'php5 oop';<br><br>$amazon = new SoapClient('<a rel="nofollow" target="_blank">http://webservices.amazon.com</a><br>/AWSECommerceService/AWSECommerceService.wsdl');<br>$result = $amazon-&gt;itemSearch($params);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105091">  
  <a class="name">
  <strong class="user"><em>svenr at selfhtml dot org</em></strong></a><div class="date" title="2011-07-27 03:51"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom105091">
<div class="phpcode"><code><span class="html">
The "classmap" option actually is a mapping from the "ComplexType" used within the SOAP to your PHP Classes.<br><br>Do not confuse the XML tag names returned for your request with these ComplexTypes. SOAP allows them to be different.<br><br>I had something like this:<br>...<br>&lt;soapenv:body&gt;<br>&lt;ns1:TagName&gt;<br>&nbsp; &lt;ns1:Content&gt;FooBar&lt;/ns1:Content&gt;<br>&lt;/ns1:TagName&gt;<br>&lt;/soapenv:body&gt;<br><br>TagName is not the key you want to put in your classmap, you have to know the name of the ComplexType this TagName refers to. This info is contained inside the WSDL resource.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="55744">  
  <a class="name">
  <strong class="user"><em>Arjan van Bentem</em></strong></a><div class="date" title="2005-08-11 11:31"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom55744">
<div class="phpcode"><code><span class="html">
When using HTTP basic authentication, PHP will only send the credentials when invoking the service, not when fetching the WSDL. <br><br>To solve this, one needs to fetch the WSDL manually (or using PHP, of course!) and store it on the file system. Obviously, the first parameter for SoapClient(..) then needs to refer to that local copy.<br><br>Alternatively, the user annotations at <a rel="nofollow" target="_blank">http://nl3.php.net/manual/en/ref.soap.php</a> state that one could encode the login and password into the URL as well.<br><br>See <a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=27777</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="88902">  
  <a class="name">
  <strong class="user"><em>jan at bestbytes dot de</em></strong></a><div class="date" title="2009-02-12 07:32"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88902">
<div class="phpcode"><code><span class="html">
You CAN get a wsdl, if basic authentication is required:<br><br><span class="default">&lt;?php <br><br>$login </span><span class="keyword">= </span><span class="string">'bert'</span><span class="keyword">;<br></span><span class="default">$password </span><span class="keyword">= </span><span class="string">'berts password'</span><span class="keyword">;<br><br></span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(<br>&nbsp; &nbsp; </span><span class="string">'<a rel="nofollow" target="_blank">http://</a>' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$login</span><span class="keyword">) . </span><span class="string">':' </span><span class="keyword">. </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">) . </span><span class="string">'@www.server.com/path/to/wsdl'</span><span class="keyword">,<br>&nbsp; &nbsp; array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'login' </span><span class="keyword">=&gt; </span><span class="default">$login</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'password' </span><span class="keyword">=&gt; </span><span class="default">$password<br>&nbsp; &nbsp; </span><span class="keyword">)<br>);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111892">  
  <a class="name">
  <strong class="user"><em>pgl at yoyo dot org</em></strong></a><div class="date" title="2013-04-09 12:21"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111892">
<div class="phpcode"><code><span class="html">
Note that if libxml_disable_entity_loader() has been called, you cannot specify a WSDL file - you'll get an error that PHP "failed to load external entity".<br><br>To resolve this, add<br><br><span class="default">&lt;?php<br>libxml_disable_entity_loader</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Above any calls to instantiate SoapClient.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="56256">  
  <a class="name">
  <strong class="user"><em>jared at ws-db dot com</em></strong></a><div class="date" title="2005-08-28 02:31"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom56256">
<div class="phpcode"><code><span class="html">
If you connect to a SoapServer, that has been created with session persistence, you can access the server's session id via SoapClient-&gt;_cookies[&lt;session_id_name&gt;][0]. This property becomes available after your first client method call.<br><br>I have only tested this with session.use_cookies=1.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98613">  
  <a class="name">
  <strong class="user"><em>marcovtwout at hotmail dot com</em></strong></a><div class="date" title="2010-06-26 06:20"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98613">
<div class="phpcode"><code><span class="html">
Being new to SOAP, I was searching for a while to find out why my message was getting a response in soapUI, but not with my php code. The specific service I was addressing gives a HTTP 202 Accepted on success (no response), but returns a SOAP message on errors.<br><br>Situation:<br>Using an (authenticated) client connection, and a WDSL file, SOAP calls with type "One-Way" don't give a response header, even though a response is expected.<br><br>Solution:<br>When calling the client constructor, set SOAP_WAIT_ONE_WAY_CALLS in the $options['features'].</span>
</code></div>
  </div>
 </div>
  <div class="note" id="71477">  
  <a class="name">
  <strong class="user"><em>matt_schiros at academicsuperstore dot com</em></strong></a><div class="date" title="2006-11-30 12:26"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom71477">
<div class="phpcode"><code><span class="html">
When using classmap to map the SOAP results to a class, the constructor of the object you've mapped to is _not_ called.&nbsp; This applies to the PHP5 __construct() and the PHP4 ClassName() constructors.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98658">  
  <a class="name">
  <strong class="user"><em>marcovtwout at hotmail dot com</em></strong></a><div class="date" title="2010-06-29 08:30"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98658">
<div class="phpcode"><code><span class="html">
If your WSDL file containts a parameter with a base64Binary type, you should not use base64_encode() when passing along your soap vars. When doing the request, the SOAP library automatically base64 encodes your data, so otherwise you'll be encoding it twice.<br><br>WSDL snipplet:<br>&lt;element name="content" type="base64Binary" xmime:expectedContentTypes="*/*"/&gt;<br><br><span class="default">&lt;?php<br>$string </span><span class="keyword">= </span><span class="string">'data_you_want_to_send___like_xml_in_soap'</span><span class="keyword">;<br></span><span class="default">$soap_data </span><span class="keyword">= array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="string">'bar'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; </span><span class="comment">//'content' =&gt; base64_encode($string ) // don't do this<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'content' </span><span class="keyword">=&gt; </span><span class="default">$string </span><span class="comment">//do this<br></span><span class="keyword">);<br></span><span class="default">$response </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">Send</span><span class="keyword">(</span><span class="default">$soap_data</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97029">  
  <a class="name">
  <strong class="user"><em>meltir at meltir dot com</em></strong></a><div class="date" title="2010-03-29 05:59"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97029">
<div class="phpcode"><code><span class="html">
To those fighting with NTLM authenticated proxy servers, here's a solution I'm using atm:
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">/**
<br> * A child of SoapClient with support for ntlm proxy authentication
<br> * 
<br> * @author Meltir &lt;meltir@meltir.com&gt;
<br> *
<br> */
<br></span><span class="keyword">class </span><span class="default">NTLM_SoapClient </span><span class="keyword">extends </span><span class="default">SoapClient </span><span class="keyword">{
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">, </span><span class="default">$options </span><span class="keyword">= array()) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_login'</span><span class="keyword">]) || empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_password'</span><span class="keyword">])) throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Login and password required for NTLM authentication!'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_login </span><span class="keyword">= </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_login'</span><span class="keyword">];
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_password </span><span class="keyword">= </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_password'</span><span class="keyword">];
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_host </span><span class="keyword">= (empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_host'</span><span class="keyword">]) ? </span><span class="string">'localhost' </span><span class="keyword">: </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_host'</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_port </span><span class="keyword">= (empty(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_port'</span><span class="keyword">]) ? </span><span class="default">8080 </span><span class="keyword">: </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'proxy_port'</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="comment">/**
<br>&nbsp; &nbsp;&nbsp; * Call a url using curl with ntlm auth
<br>&nbsp; &nbsp;&nbsp; * 
<br>&nbsp; &nbsp;&nbsp; * @param string $url
<br>&nbsp; &nbsp;&nbsp; * @param string $data
<br>&nbsp; &nbsp;&nbsp; * @return string
<br>&nbsp; &nbsp;&nbsp; * @throws SoapFault on curl connection error
<br>&nbsp; &nbsp;&nbsp; */
<br>&nbsp; &nbsp; </span><span class="keyword">protected function </span><span class="default">callCurl</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$handle&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_FAILONERROR</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, Array(</span><span class="string">"PHP SOAP-NTLM Client"</span><span class="keyword">) );
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_PROXYUSERPWD</span><span class="keyword">,</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_login</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_password</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_PROXY</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_host</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">proxy_port</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_PROXYAUTH</span><span class="keyword">, </span><span class="default">CURLAUTH_NTLM</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$response </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);
<br>&nbsp; &nbsp; if (empty(</span><span class="default">$response</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; throw new </span><span class="default">SoapFault</span><span class="keyword">(</span><span class="string">'CURL error: '</span><span class="keyword">.</span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">),</span><span class="default">curl_errno</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">));
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);
<br>&nbsp; &nbsp; return </span><span class="default">$response</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; public function </span><span class="default">__doRequest</span><span class="keyword">(</span><span class="default">$request</span><span class="keyword">,</span><span class="default">$location</span><span class="keyword">,</span><span class="default">$action</span><span class="keyword">,</span><span class="default">$version</span><span class="keyword">,</span><span class="default">$one_way </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callCurl</span><span class="keyword">(</span><span class="default">$location</span><span class="keyword">,</span><span class="default">$request</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>Requires curl and could be extended, but it works for my simple needs.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114252">  
  <a class="name">
  <strong class="user"><em>michael dot arnauts at gmail dot com</em></strong></a><div class="date" title="2014-01-29 03:53"><strong>6 months ago</strong></div>
  <div class="text" id="Hcom114252">
<div class="phpcode"><code><span class="html">
This doesn't seem to be documented, but when you want to use compression for your outgoing requests, you have to OR with the compression level:<br><br><span class="default">&lt;?php<br> $client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">"some.wsdl"</span><span class="keyword">, <br>&nbsp; array(</span><span class="string">'compression' </span><span class="keyword">=&gt; </span><span class="default">SOAP_COMPRESSION_ACCEPT </span><span class="keyword">| </span><span class="default">SOAP_COMPRESSION_GZIP </span><span class="keyword">| </span><span class="default">9</span><span class="keyword">));<br></span><span class="default">?&gt;<br></span><br>This can be really usefull if you want to send large amounts of data.<br><br>Source: https://bugs.php.net/bug.php?id=36283</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98326">  
  <a class="name">
  <strong class="user"><em>ajcartmell at fonant dot com</em></strong></a><div class="date" title="2010-06-09 03:57"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98326">
<div class="phpcode"><code><span class="html">
There seems to be a problem with specifying empty strings for proxy_host and proxy_port options in recent versions of PHP (from a version later than 5.2.9, and equal to or earlier than 5.2.11).<br><br>Supplying empty string values for proxy_host and proxy_port causes "host not found" type errors: supplying NULL or FALSE works fine.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112970">  
  <a class="name">
  <strong class="user"><em>tolean dot dj at gmail dot com</em></strong></a><div class="date" title="2013-08-13 02:21"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112970">
<div class="phpcode"><code><span class="html">
Here's a function for easier debugging:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">soapDebug</span><span class="keyword">(</span><span class="default">$client</span><span class="keyword">){<br><br>&nbsp; &nbsp; </span><span class="default">$requestHeaders </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__getLastRequestHeaders</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">$request </span><span class="keyword">= </span><span class="default">prettyXml</span><span class="keyword">(</span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__getLastRequest</span><span class="keyword">());<br>&nbsp; &nbsp; </span><span class="default">$responseHeaders </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__getLastResponseHeaders</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="default">$response </span><span class="keyword">= </span><span class="default">prettyXml</span><span class="keyword">(</span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__getLastResponse</span><span class="keyword">());<br><br>&nbsp; &nbsp; echo </span><span class="string">'&lt;code&gt;' </span><span class="keyword">. </span><span class="default">nl2br</span><span class="keyword">(</span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">$requestHeaders</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">)) . </span><span class="string">'&lt;/code&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="default">highlight_string</span><span class="keyword">(</span><span class="default">$request</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) . </span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">;<br><br>&nbsp; &nbsp; echo </span><span class="string">'&lt;code&gt;' </span><span class="keyword">. </span><span class="default">nl2br</span><span class="keyword">(</span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">$responseHeaders</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">)) . </span><span class="string">'&lt;/code&gt;' </span><span class="keyword">. </span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="default">highlight_string</span><span class="keyword">(</span><span class="default">$response</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) . </span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">;<br>}<br><br></span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">null</span><span class="keyword">, array(<br>&nbsp; &nbsp; </span><span class="string">'location' </span><span class="keyword">=&gt; </span><span class="string">'<a rel="nofollow" target="_blank">http://sita.local/_mpay/server.php</a>'</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'uri' </span><span class="keyword">=&gt; </span><span class="string">'<a rel="nofollow" target="_blank">http://sita.local/_mpay/</a>'</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'trace' </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">,<br>));<br><br></span><span class="default">$result </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__soapCall</span><span class="keyword">(</span><span class="string">'getDate'</span><span class="keyword">, array(</span><span class="string">'format' </span><span class="keyword">=&gt; </span><span class="string">'Y-m-d H:i:s'</span><span class="keyword">));<br></span><span class="default">soapDebug</span><span class="keyword">(</span><span class="default">$client</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111682">  
  <a class="name">
  <strong class="user"><em>francesco [at] paladinux [dot] net</em></strong></a><div class="date" title="2013-03-15 08:43"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111682">
<div class="phpcode"><code><span class="html">
Where you have the problem of <br>"looks like we got no XML document SoapClient", really the real problem is the xml code from remote server is not clear (after last tag is possible that you have space or other caracter that the your supplier of service have lost :&nbsp; no one is perfect!)<br>I've read some solution, like here, but you must to know that is possible, that is possible that the remote server don't wrong, and the "surplus" (latin word for added values) is needed.<br>In particolar with axis Java server, is possible that the configuration of server is needed and the "surplus" is one or more attachments...<br>The solution is 3:<br>1) contact your supplier if is possible to remove caracter if is an error (good luck! ;) )<br>2) use another class like nusoap resolve the problem (but has other problem!)<br>3) this technical solution:<br>when call the wsdl be sure that the option trace and exceptions are setted (the first true and the second false)<br><br><span class="default">&lt;?php<br>$SoapClient </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">NULL</span><span class="keyword">, <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array( <br>....<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'trace'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="default">1</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'exceptions'&nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="default">0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">)<br></span><span class="default">?&gt;<br></span>(if you don't do that you can't use the __getLastResponse)<br><br>Now You can do the request and use __getLastResponse() to obtain all the part..<br><span class="default">&lt;?php<br>$result&nbsp; </span><span class="keyword">= </span><span class="default">$SoapClient </span><span class="keyword">-&gt; </span><span class="default">problematicCall</span><span class="keyword">(</span><span class="default">$par</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>After all&nbsp; you obtain a variable like that:<br><br>-----=_Part_9325_126764118.1363377774664<br>Content-Type: text/xml; charset=UTF-8<br>Content-Transfer-Encoding: binary<br>Content-Id: &lt;1C06F7FBA057796C5A6185605F9F93E4&gt;<br><br>&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;...etc &gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;<br><br>&amp;lt;MESSAGGIO&amp;gt;<br>&nbsp; &amp;lt;DA&amp;gt;MI&amp;lt;/DA&amp;gt;<br>&nbsp; &amp;lt;A&amp;gt;PALADINUX&amp;lt;/A&amp;gt;<br>&nbsp; &amp;lt;ID&amp;gt;12345&amp;lt;/ID&amp;gt;<br>&nbsp; &amp;lt;TIPODOC&amp;gt;RC&amp;lt;/TIPODOC&amp;gt;<br>&nbsp; &amp;lt;RISPOSTA&amp;gt;<br>&amp;lt;/MESSAGGIO&amp;gt;<br>&lt;/rxproblematicCallReturn&gt;&lt;/ns1:rxCatalogoMaterialiResponse&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;<br>------=_Part_9325_126764118.1234567890123<br>Content-Type: application/zip<br>Content-Transfer-Encoding: binary<br>Content-Id: &lt;43E91F7E7PALADINUXE07BF041A7BAC9&gt;<br>-------------------------<br><br>Is easy understand if the added part is needed or not!<br>Now you can explode all the part and parse!<br><br>Hope this can help you.See ya in the cyberspace!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83474">  
  <a class="name">
  <strong class="user"><em>Anno v. Heimburg</em></strong></a><div class="date" title="2008-05-27 10:23"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83474">
<div class="phpcode"><code><span class="html">
&gt; When using HTTP basic authentication, PHP will only send<br>&gt; the credentials when invoking the service, not when<br>&gt; fetching the WSDL. <br><br>The same goes for using an SSL client certficate, the SoapClient will only present the certificate on the actual remote call, not when getting the WSDL. The workaround is the same as above. HttpRequest works as expected.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109000">  
  <a class="name">
  <strong class="user"><em>ale dot comp_06 at xox dot ch</em></strong></a><div class="date" title="2012-06-11 07:56"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom109000">
<div class="phpcode"><code><span class="html">
If your service is protected through basic http authentication and you're not using wsdl, you will have to put the login in the SoapClient's option:
<br>
<br><span class="default">&lt;?php
<br>$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(
<br>&nbsp; &nbsp; </span><span class="default">null</span><span class="keyword">,
<br>&nbsp; &nbsp; array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'soap_version' </span><span class="keyword">=&gt; </span><span class="default">SOAP_1_2</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'location' </span><span class="keyword">=&gt; ...
<br>&nbsp; &nbsp; &nbsp; &nbsp; ...,
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'login' </span><span class="keyword">=&gt; </span><span class="string">'username'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'password' </span><span class="keyword">=&gt; </span><span class="string">'*******'</span><span class="keyword">,
<br>&nbsp; &nbsp; )
<br>);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106393">  
  <a class="name">
  <strong class="user"><em>chris at phblock dot atNoSpam</em></strong></a><div class="date" title="2011-11-04 05:57"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom106393">
<div class="phpcode"><code><span class="html">
this is the syntax of typemap (found at <a rel="nofollow" target="_blank">http://svn.php.net/viewvc/php/php-src/trunk/ext/soap/tests/typemap012.phpt?view=markup</a>)<br><span class="default">&lt;?php<br>$options</span><span class="keyword">=Array(<br></span><span class="string">'typemap' </span><span class="keyword">=&gt; array(<br>array(</span><span class="string">"type_ns"&nbsp; </span><span class="keyword">=&gt; </span><span class="string">"<a rel="nofollow" target="_blank">http://schemas.nothing.com</a>"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"type_name" </span><span class="keyword">=&gt; </span><span class="string">"soap"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"to_xml"&nbsp; </span><span class="keyword">=&gt; </span><span class="string">"some_funktion_name"</span><span class="keyword">)<br>));<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105398">  
  <a class="name">
  <strong class="user"><em>Chris Gunawardena</em></strong></a><div class="date" title="2011-08-15 12:56"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom105398">
<div class="phpcode"><code><span class="html">
To monitor SOAP calls in and out of a unix server:<br><br>sudo tcpdump -nn -vv -A -s 0 -i eth0 dst or src host xxx.xxx.xxx.xxx and port 80<br><br>And always use 'cache_wsdl' =&gt; WSDL_CACHE_NONE</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104177">  
  <a class="name">
  <strong class="user"><em>willem dot stuursma at hyves dot nl</em></strong></a><div class="date" title="2011-05-30 02:00"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom104177">
<div class="phpcode"><code><span class="html">
If you want to use classes in a different namespace in your classmap, just use the backslash in the the target class name.<br><br>Example:<br><span class="default">&lt;?php<br>$classmap </span><span class="keyword">= array(</span><span class="string">'result' </span><span class="keyword">=&gt; </span><span class="string">'MyNamespace\\Result'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>You need to specify the backslash twice because it is the escape character in strings.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100292">  
  <a class="name">
  <strong class="user"><em>titan at phpdevshell dot org</em></strong></a><div class="date" title="2010-10-06 06:11"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100292">
<div class="phpcode"><code><span class="html">
It should be noted that if you receive a return error : 'Object reference not set to an instance of an object.'. This could be due to something as simple as passing the incorrect parameters. When you look at this XML:
<br>
<br>&nbsp; &nbsp; &lt;Get xmlns="<a rel="nofollow" target="_blank">http://example.com</a>"&gt;
<br>&nbsp; &nbsp; &nbsp; &lt;request&gt;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;CustomerId&gt;string&lt;/CustomerId&gt;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;From&gt;dateTime&lt;/From&gt;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;To&gt;dateTime&lt;/To&gt;
<br>&nbsp; &nbsp; &nbsp; &lt;/request&gt;
<br>&nbsp; &nbsp; &lt;/Get&gt;
<br>
<br>Your code should look something like this:
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">try {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$options </span><span class="keyword">= array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'soap_version'</span><span class="keyword">=&gt;</span><span class="default">SOAP_1_2</span><span class="keyword">, 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'exceptions'</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'trace'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'cache_wsdl'</span><span class="keyword">=&gt;</span><span class="default">WSDL_CACHE_NONE
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://example.com/doc.asmx?WSDL</a>'</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">);
<br></span><span class="comment">// Note where 'Get' and 'request' tags are in the XML
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$results </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">Get</span><span class="keyword">(array(</span><span class="string">'request'</span><span class="keyword">=&gt;array(</span><span class="string">'CustomerId'</span><span class="keyword">=&gt;</span><span class="string">'1234'</span><span class="keyword">)));
<br>&nbsp; &nbsp; &nbsp; &nbsp; } catch (</span><span class="default">Exception $e</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"&lt;h2&gt;Exception Error!&lt;/h2&gt;"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br></span><span class="default">$results </span><span class="keyword">= </span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">Get</span><span class="keyword">(array(</span><span class="string">'request'</span><span class="keyword">=&gt;array(</span><span class="string">'CustomerId'</span><span class="keyword">=&gt;</span><span class="string">'842115'</span><span class="keyword">)));
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98357">  
  <a class="name">
  <strong class="user"><em>tim at tdinternet dot com</em></strong></a><div class="date" title="2010-06-10 08:05"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98357">
<div class="phpcode"><code><span class="html">
PHP 5.2.11 seems to not be very picky about the correctness of a WSDL.<br><br>Other SOAP clients were complaining about schema and namespace issues, while PHP's SoapClient worked completely fine.&nbsp; Fixing those issues for the other clients however broke PHP's SoapClient to the point where objects being passed to the SOAP method were becoming empty arrays on the server side.<br><br>Lesson learned:&nbsp; some elements were being prefixed with xsd: and others were not -- make absolutely sure your WSDL is correct and consistent (I'm using a tweaked WSDL_Gen.php).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95963">  
  <a class="name">
  <strong class="user"><em>eric dot caron at gmail dot com</em></strong></a><div class="date" title="2010-01-31 01:26"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95963">
<div class="phpcode"><code><span class="html">
Though pointed out by jan at bestbytes, and discussed in bug #27777, one common source of the "Parsing WSDL: Couldn't find &lt;definitions&gt;" error is from trying to access a WSDL that is protected by HTTP authentication. Passing the login/password in the 2nd parameter doesn't always work; so if you encounter this error message and are trying to access a protected WSDL file, try passing the username and password in with the first parameter.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95576">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2010-01-10 06:53"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95576">
<div class="phpcode"><code><span class="html">
I had to struggle with a rather strange behavior when trying to consume standard Parlay X web services with no success. However, I found a remedy to my problem.<br><br>The problem which I faced was about an erroneous invalid HTTP basic authentication request sent to the web service. Although I was sending the right credentials, I was getting an authentication error. It turns out that PHP was sending HTTP requests to another endpoint which is not exposed directly through the web service and that end point does not require authentication. <br><br>My remedy for that issue was by using this simple lines in the example of using sendSms Paraly-X method.<br><br>First, creating a soap client without any HTTP authentication options: <br><br><span class="default">&lt;?php<br>$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$wsdl_url</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br></span><span class="default">?&gt;<br></span><br>The above request will cache the wsdl in the /tmp directory. Immediately after this construction we create another soap client, this time with HTTP authentication options:<br><br><span class="default">&lt;?php<br></span><span class="keyword">try {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$wsdl_url</span><span class="keyword">, array(</span><span class="string">'login' </span><span class="keyword">=&gt; </span><span class="string">"griffin"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'password'&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">"password"</span><span class="keyword">));<br>} catch (</span><span class="default">Exception $e</span><span class="keyword">) {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"Error:sendSms: %s\n"</span><span class="keyword">,</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">__toString</span><span class="keyword">());<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>} <br></span><span class="default">?&gt;<br></span><br>Now it should work without any problem. Without the second call, PHP will call sendSms without credentials resulting in a failed attempt due to missing authentication information. I found this procedure to be the simplest.<br><br>This process should be done every time the cached wsdl expires, or simply a one can increase the time-to-live for the cached wsdl from php.ini</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95085">  
  <a class="name">
  <strong class="user"><em>jon dot gilbert at net-entwicklung dot de</em></strong></a><div class="date" title="2009-12-12 09:55"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95085">
<div class="phpcode"><code><span class="html">
Note that creating a soap client for an invalid URL (you do test what happens, when a service is not available, right?) usually throws an exception which can be caught with try..catch. However, if xdebug is active you will get a fatal error, which obviously cannot be caught.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="94151">  
  <a class="name">
  <strong class="user"><em>sloloem at gmail dot com</em></strong></a><div class="date" title="2009-10-19 01:14"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom94151">
<div class="phpcode"><code><span class="html">
I had an issue figuring out the use of classmap that took me quite a while to figure out.&nbsp; I was assuming the WSDL type the docs were referring to was the name of the element being returned in the SOAP, so like,<br>&lt;ns1:node id="8675309" /&gt;<br><br>and I was wondering why mapping<br>'classmap'=&gt;array('node'=&gt;'MyNode')<br><br>did nothing.<br>That's because in my WSDL I defined node as:<br><br>&lt;xsd:element name="node" type="tns:nodeType" /&gt;<br><br>The classmap I needed was:<br>'classmap'=&gt;array('nodeType'=&gt;'MyNode')<br><br>I was able to find the type names using SoapClient-&gt;__getTypes()<br>Later, I realized where I could look inside the WSDL for the typename I needed.<br><br>I dunno if I missed something painfully obvious but maybe this can clear up some of the docs.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90725">  
  <a class="name">
  <strong class="user"><em>Jon</em></strong></a><div class="date" title="2009-05-06 03:13"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90725">
<div class="phpcode"><code><span class="html">
We've had some problems using SoapClient connecting to an external server via Microsoft ISA (presently v.2006 but this may apply to other versions too). We supply the proxy_host, proxy_port, proxy_login and proxy_password but the ISA server reports the login in its logs as "anonymous".<br><br>Our sysadmin believes this is because PHP is not supplying NTLN information (Windows security protocol) in the correct format (and whether it should work with proprietary proxies is of course another debate). We'd tried "username", "DOMAIN\username" to no effect. The solution is to add an exception in the ISA server for the target hostname/IP; null can then be supplied for proxy_login and proxy_password and the connection should then work as expected.<br><br>On a slightly related note, if you are having problems make sure the port number is supplied as an integer. Some versions of PHP will not use the proxy with SoapClient if the port number is supplied as a string.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86908">  
  <a class="name">
  <strong class="user"><em>info at nicksilvestro dot net</em></strong></a><div class="date" title="2008-11-09 10:40"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom86908">
<div class="phpcode"><code><span class="html">
For anyone having trouble with ArrayOf_xsd_string and getting an error similar to 'No deserializer defined for array type {<a rel="nofollow" target="_blank">http://www.w3.org/2001/XMLSchema}string</a>'<br>Try using the 'features' param, set to SOAP_USE_XSI_ARRAY_TYPE - this makes sure the correct deserializer is used.<br><br>eg, <br><span class="default">&lt;?php<br>$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">"some.wsdl"</span><span class="keyword">, array(</span><span class="string">'features' </span><span class="keyword">=&gt; </span><span class="default">SOAP_USE_XSI_ARRAY_TYPE</span><span class="keyword">));<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85757">  
  <a class="name">
  <strong class="user"><em>taras dot dot dot di at gmail dot com</em></strong></a><div class="date" title="2008-09-16 09:23"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom85757">
<div class="phpcode"><code><span class="html">
This took me a while to figure out.<br><br>As described at the bottom of here: <a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=38703</a><br><br>having xdebug may interfere with the constructor throwing exceptions</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85648">  
  <a class="name">
  <strong class="user"><em>alex on reutone comma com</em></strong></a><div class="date" title="2008-09-10 06:53"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom85648">
<div class="phpcode"><code><span class="html">
To connect PHP SOAP to MS SOAP (CRM/EXCHANGE/...) I have created some classes using the explanation below and in other places.<br>www.reutone.com/heb/articles.php?instance_id=62&amp;actions=show&amp;id=521</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83932">  
  <a class="name">
  <strong class="user"><em>naugtur at gmail dot com</em></strong></a><div class="date" title="2008-06-19 06:48"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83932">
<div class="phpcode"><code><span class="html">
SoapFault exception: [Client] looks like we got no XML document in &lt;document&gt; has been already mentioned to occur when your server outputs something before &lt;?xml ... &gt; tag. <br><br>For all those having problems with that, and no access to the server code:<br>This is how to make a proxy that would clean responses for You<br><br><span class="default">&lt;?php<br></span><span class="comment">/**<br> * Simple class taken from a note by James Ellis [in __doRequest() page of manual]<br> */<br></span><span class="keyword">class </span><span class="default">Proxy_Client </span><span class="keyword">extends </span><span class="default">SoapClient </span><span class="keyword">{<br>&nbsp; &nbsp; protected </span><span class="default">$cacheDocument </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">);<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp;&nbsp; * SetCacheDocument() sets the previously cached document contents<br>&nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; </span><span class="keyword">public function </span><span class="default">SetCacheDocument</span><span class="keyword">(</span><span class="default">$document</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cacheDocument </span><span class="keyword">= </span><span class="default">$document</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp;&nbsp; * __doRequest() overrides the standard SoapClient to handle a local request<br>&nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; </span><span class="keyword">public function </span><span class="default">__doRequest</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cacheDocument</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>}<br><br></span><span class="comment">//put this code in your function or wherever You have all required variables set<br><br></span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$wsdl_url</span><span class="keyword">,</span><span class="default">$settings_array</span><span class="keyword">);<br></span><span class="default">$void</span><span class="keyword">=</span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">$method</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);&nbsp; </span><span class="comment">//call this to get response from server<br>&nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="default">$response_string</span><span class="keyword">=</span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">__getLastResponse</span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; &nbsp; <br></span><span class="comment">//this part removes stuff<br></span><span class="default">$start</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$response_string</span><span class="keyword">,</span><span class="string">'&lt;?xml'</span><span class="keyword">);<br></span><span class="default">$end</span><span class="keyword">=</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$response_string</span><span class="keyword">,</span><span class="string">'&gt;'</span><span class="keyword">);&nbsp; &nbsp; <br></span><span class="default">$response_string</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$response_string</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">,</span><span class="default">$end</span><span class="keyword">-</span><span class="default">$start</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br><br></span><span class="comment">//get your proxy prepared<br></span><span class="default">$proxy </span><span class="keyword">= new </span><span class="default">Proxy_Client</span><span class="keyword">(</span><span class="default">$wsdl_url</span><span class="keyword">,</span><span class="default">$settings_array</span><span class="keyword">);<br></span><span class="comment">//and fill it with the server's response<br></span><span class="default">$proxy</span><span class="keyword">-&gt;</span><span class="default">SetCacheDocument</span><span class="keyword">(</span><span class="default">$response_string</span><span class="keyword">);<br><br></span><span class="default">$and_finally_the_result_is</span><span class="keyword">=</span><span class="default">$proxy</span><span class="keyword">-&gt;</span><span class="default">$method</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br><br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$and_finally_the_result_is</span><span class="keyword">); </span><span class="comment">//this allows You to see what's there<br><br></span><span class="default">?&gt;<br></span><br>$method is the method's name eg. $method='getVersion';<br>$params - typical params for a soap method</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82876">  
  <a class="name">
  <strong class="user"><em>cw at netresearch dot de</em></strong></a><div class="date" title="2008-04-30 01:24"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82876">
<div class="phpcode"><code><span class="html">
The "cache_wsdl" option takes constants like WSDL_CACHE_NONE or WSDL_CACHE_DISK that are listed on the "SOAP constants" page -&gt; /manual/en/soap.constants.php</span>
</code></div>
  </div>
 </div>
  <div class="note" id="80715">  
  <a class="name">
  <strong class="user"><em>james dot ellis at gmail dot com</em></strong></a><div class="date" title="2008-01-29 05:10"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80715">
<div class="phpcode"><code><span class="html">
A note regarding boolean values that may seem obvious on reflection but could be a gotcha for some:<br><br>Seeing a SOAP request example with &lt;SomeBooleanParam&gt;true&lt;/SomeBooleanParam&gt; may lead you to pass in string "true" or "false" as the parameter, which is incorrect - the correct method is to use boolean data types.<br><br><span class="default">&lt;?php<br>$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">,</span><span class="default">$options</span><span class="keyword">);<br></span><span class="default">$method </span><span class="keyword">= </span><span class="string">"DoSomething"</span><span class="keyword">;<br></span><span class="default">$params </span><span class="keyword">= new </span><span class="default">stdClass</span><span class="keyword">;<br><br></span><span class="default">$params</span><span class="keyword">-&gt;</span><span class="default">SomeBooleanParam </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br></span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">$method</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br></span><span class="comment">/**<br> simplified request snippet would be<br> &lt;SomeBooleanParam&gt;true&lt;/SomeBooleanParam&gt;<br>**/<br><br>//this will also be correct, but not for the right reasons:<br></span><span class="default">$params</span><span class="keyword">-&gt;</span><span class="default">SomeBooleanParam </span><span class="keyword">= </span><span class="string">"true"</span><span class="keyword">;<br></span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">$method</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br></span><span class="comment">/**<br> simplified request snippet would be<br> &lt;SomeBooleanParam&gt;true&lt;/SomeBooleanParam&gt;<br>**/<br><br>//this is where you may be wondering what is going on<br></span><span class="default">$params</span><span class="keyword">-&gt;</span><span class="default">SomeBooleanParam </span><span class="keyword">= </span><span class="string">"false"</span><span class="keyword">;<br></span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">$method</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br></span><span class="comment">/**<br> simplified request snippet would be<br> &lt;SomeBooleanParam&gt;true&lt;/SomeBooleanParam&gt;<br>**/<br><br>//you need to do this instead<br></span><span class="default">$params</span><span class="keyword">-&gt;</span><span class="default">SomeBooleanParam </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br></span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">$method</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">);<br></span><span class="comment">/**<br> simplified request snippet would be<br> &lt;SomeBooleanParam&gt;false&lt;/SomeBooleanParam&gt;<br>**/<br></span><span class="default">?&gt;<br></span><br>Hope that helps!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76269">  
  <a class="name">
  <strong class="user"><em>giosh94mhz</em></strong></a><div class="date" title="2007-07-08 11:46"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76269">
<div class="phpcode"><code><span class="html">
Oops!<br><br>I have written the wrong exception message in my last post.<br><br>The correct exception is:<br><br>SoapFault exception: [Client] looks like we got no XML document in &lt;document&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101503">  
  <a class="name">
  <strong class="user"><em>faebu at faebu dot ch</em></strong></a><div class="date" title="2010-12-21 06:58"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101503">
<div class="phpcode"><code><span class="html">
I'm experiencing the same problems when trying to load a WDSL fiel which is protected by basic http authentication, since the parameters login and password are just used for the request but not when reading the wdsl file. I just use the following workaround by downloading the xml file to a non-protected location on my server. Please notice that this doesn't support any kind of caching.
<br>
<br>Hope it helps
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">class </span><span class="default">SoapAuthClient </span><span class="keyword">extends </span><span class="default">SoapClient </span><span class="keyword">{
<br>&nbsp; &nbsp; </span><span class="comment">/**
<br>&nbsp; &nbsp;&nbsp; * Since the PHP SOAP package does not support basic authentication
<br>&nbsp; &nbsp;&nbsp; * this class downloads the WDSL file using the cURL package and
<br>&nbsp; &nbsp;&nbsp; * creates a local copy of the wdsl on your server. 
<br>&nbsp; &nbsp;&nbsp; * Make sure you provide the following additional parameter in the
<br>&nbsp; &nbsp;&nbsp; * $options Array:
<br>&nbsp; &nbsp;&nbsp; * wdsl_local_copy =&gt; true
<br>&nbsp; &nbsp;&nbsp; */
<br>&nbsp; &nbsp;&nbsp; 
<br>&nbsp; &nbsp; </span><span class="keyword">private </span><span class="default">$cache_dir </span><span class="keyword">= </span><span class="string">'/home/example/htdocs/cache/'</span><span class="keyword">;
<br>&nbsp; &nbsp; private </span><span class="default">$cache_url </span><span class="keyword">= </span><span class="string">'<a rel="nofollow" target="_blank">http://www.example.com/cache/</a>'</span><span class="keyword">;
<br>&nbsp; &nbsp;&nbsp; 
<br>&nbsp; &nbsp; function </span><span class="default">SoapAuthClient</span><span class="keyword">(</span><span class="default">$wdsl</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (isset(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'wdsl_local_copy'</span><span class="keyword">]) &amp;&amp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$options</span><span class="keyword">[</span><span class="string">'wdsl_local_copy'</span><span class="keyword">] == </span><span class="default">true </span><span class="keyword">&amp;&amp;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isset(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'login'</span><span class="keyword">]) &amp;&amp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isset(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">])) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">md5</span><span class="keyword">(</span><span class="default">uniqid</span><span class="keyword">()).</span><span class="string">'.xml'</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((</span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cache_dir</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">)) == </span><span class="default">false</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Could not create local WDSL file ('</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cache_dir</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">')'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$credit </span><span class="keyword">= (</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'login'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$wdsl</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPAUTH</span><span class="keyword">, </span><span class="default">CURLAUTH_BASIC</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_USERPWD</span><span class="keyword">, </span><span class="default">$credit</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMEOUT</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FILE</span><span class="keyword">, </span><span class="default">$fp</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ((</span><span class="default">$xml </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">)) === </span><span class="default">false</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//curl_close($ch);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cache_dir</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">));
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$wdsl </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cache_url</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; unset(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'wdsl_local_copy'</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; unset(</span><span class="default">$options</span><span class="keyword">[</span><span class="string">'wdsl_force_local_copy'</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$wdsl</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$wdsl</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cache_dir</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98346">  
  <a class="name">
  <strong class="user"><em>james dot ellis at gmail dot com</em></strong></a><div class="date" title="2010-06-09 07:06"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98346">
<div class="phpcode"><code><span class="html">
I was having troubles getting responses from a Coldfusion SOAP server, with no obvious issues in the SoapClient used.<br><br>Eventually I found that the server was only accepting SOAP 1.1 requests and not 1.2. Not sure if this is&nbsp; a system wide Coldfusion setting but if you hit the same wall, try setting the SoapClient option "soap_version" to the constant SOAP_1_1 (which is the default but mine was defaulting to 1.2 as the client was being reused for another service)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="62471">  
  <a class="name">
  <strong class="user"><em>Marius Mathiesen</em></strong></a><div class="date" title="2006-03-01 04:57"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom62471">
<div class="phpcode"><code><span class="html">
I kept having a problem using an HTTP proxy with SOAP. The proxy_port parameter has to be an integer, ie. "proxy_port"=&gt;"80" won't work, you'll have to use "proxy_port"=&gt;80.<br><br>HTH,<br>Marius</span>
</code></div>
  </div>
 </div>
  <div class="note" id="60004">  
  <a class="name">
  <strong class="user"><em>php at sowen dot de</em></strong></a><div class="date" title="2005-12-22 06:40"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom60004">
<div class="phpcode"><code><span class="html">
If you're using CLI and there are multiple IP addresses available for outgoing SOAP-requests, try this "secret" to set outgoing IP:<br><br>e.g. for local IP 10.1.4.71:<br><br>$opts = array('socket' =&gt; array('bindto' =&gt; '10.1.4.71:0'));<br>$context = stream_context_create($opts);<br>$client&nbsp; = new SoapClient(null, array('location'=&gt;'<a rel="nofollow" target="_blank">http://...</a>','uri' =&gt; '...','stream_context' =&gt; $context));<br><br>You can also set other options for the stream context, please refer to this page:<br><br>Appendix M: <a rel="nofollow" target="_blank">http://www.php.net/manual/en/wrappers.php</a><br><br>Bye,<br>&nbsp;&nbsp; Nils Sowen</span>
</code></div>
  </div>
 </div>
  <div class="note" id="50621">  
  <a class="name">
  <strong class="user"><em>Brian Grayless</em></strong></a><div class="date" title="2005-03-04 02:30"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom50621">
<div class="phpcode"><code><span class="html">
Using a WSDL file is the way to go, however, for my particular application, the LOCATION:PORT needed to be dynamic so that my SOAP clients would be able to call a different service based on the client domain.<br><br>If you are using a WSDL, SoapClient() requires a URL direct to an actual URL and does not let you use a PHP file that outputs the dynamic WSDL XML in its stead. So, I ended up making a separate WSDL for each possible service needed and had to maintain them all if the service description changed.<br><br>Finally, after some fiddling, I was able to create a PHP page with the proper Mime type headers so that I could then trick SoapClient() to think that it was being passed a file with a ".wsdl" extension.<br><br>Example:<br><br><span class="default">&lt;?php<br><br></span><span class="comment">// filename: wsdl.php<br><br></span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Type: application/xml; charset=UTF-8'</span><span class="keyword">);<br></span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Disposition: attachment; filename="filename.wsdl"'</span><span class="keyword">);<br><br></span><span class="default">$wsdl </span><span class="keyword">= </span><span class="string">'path/wsdl_name.wsdl'</span><span class="keyword">;<br><br></span><span class="comment">// read in file<br></span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);<br></span><span class="default">$wsdl_xml </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$wsdl</span><span class="keyword">));<br></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br><br></span><span class="comment">// put code here to replace url and port in xml<br><br></span><span class="keyword">echo </span><span class="default">$wsdl_xml</span><span class="keyword">;<br><br></span><span class="default">?&gt;<br></span><br>Now, in order to make this work, you can't just call a relative path to the file. I believe it has to go through Apache to properly set the mime type headers, etc... So you would use a full "<a rel="nofollow" target="_blank">http://.....</a>" address as the path to the wsdl.php file.<br><br><span class="default">&lt;?php<br><br></span><span class="comment">//... somewhere in your soap client code<br><br></span><span class="default">$wsdl_loc </span><span class="keyword">= </span><span class="string">"<a rel="nofollow" target="_blank">http://yourdomain.com/wsdl.php</a>"</span><span class="keyword">;<br><br></span><span class="default">$soap_client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="default">$wsdl_loc</span><span class="keyword">, </span><span class="default">$client_param_array</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>Another, perhaps not so clean, way of achieving this would be to modify your .htaccess file in the directory where your WSDL file exists to force ".wsdl" files to run through the PHP engine. Add the following to your .htaccess:<br><br>AddType application/x-httpd-php .php .wsdl<br><br>You can then put dynamic PHP code snippets in your *.wsdl files to change whatever values you need to.<br><br>There are pros and cons to each solutions. The Mime solution probably taxes the system more as it has to read the file in every time a soap request is made. The htaccess solution makes it so you have to depend on either a modified .htaccess or Apache conf file.<br><br>Perhaps if you set the "soap.wsdl_cache_enabled", using ini_set(), to 1 (default), the caching will make it so it doesn't read the file every time for the Mime solution.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112549">  
  <a class="name">
  <strong class="user"><em>miguel dot angel dot fuentes dot casanova at gmail dot com</em></strong></a><div class="date" title="2013-06-28 07:39"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112549">
<div class="phpcode"><code><span class="html">
Somebody using SoapClient has sometimes a lot of CLOSE_WAIT states?<br><br>It's in a local connection in a openSuse 11 (x86_64, version 11, patchlevel 2) with Apache 2.2.22 and PHP 5.3.15.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101835">  
  <a class="name">
  <strong class="user"><em>Asaf Meller</em></strong></a><div class="date" title="2011-01-13 05:57"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101835">
<div class="phpcode"><code><span class="html">
a full working php .net soap configuration :
<br>notes
<br>1. web.config on .net server must work with basichttp binding.
<br>2. paramaters to soap functions must be passed as :
<br>array ('parm1_name'=&gt;'parm1_value',
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'parm2_name'=&gt;'parm2_value'...)
<br>
<br><span class="default">&lt;?php
<br>header</span><span class="keyword">(</span><span class="string">'Content-Type: text/plain'</span><span class="keyword">);
<br>
<br>try { 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$options </span><span class="keyword">= array( 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'soap_version'</span><span class="keyword">=&gt;</span><span class="default">SOAP_1_1</span><span class="keyword">, 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'exceptions'</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">, 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'trace'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">, 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'cache_wsdl'</span><span class="keyword">=&gt;</span><span class="default">WSDL_CACHE_NONE 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">); 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$client </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://www.example.com/end_point.wsdl</a>'</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">); 
<br>&nbsp; &nbsp; </span><span class="comment">// Note where 'Get' and 'request' tags are in the XML 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">} catch (</span><span class="default">Exception $e</span><span class="keyword">) { 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"&lt;h2&gt;Exception Error!&lt;/h2&gt;"</span><span class="keyword">; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">(); 
<br>&nbsp; &nbsp; &nbsp; &nbsp; } 
<br>
<br>echo </span><span class="string">'running HelloWorld :'</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br> 
<br> try {
<br>&nbsp;&nbsp; </span><span class="default">$response</span><span class="keyword">=</span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">HelloWorld</span><span class="keyword">();
<br>&nbsp;&nbsp; 
<br>&nbsp;&nbsp; 
<br>} 
<br>catch (</span><span class="default">Exception $e</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; echo </span><span class="string">'Caught exception: '</span><span class="keyword">,&nbsp; </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">(), </span><span class="string">"\n"</span><span class="keyword">;
<br>}
<br>
<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$response</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>good luck !
<br>Asaf.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83718">  
  <a class="name">
  <strong class="user"><em>david at globulebleu dot com</em></strong></a><div class="date" title="2008-06-09 12:44"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83718">
<div class="phpcode"><code><span class="html">
When using classmap option to map the SOAP results to a class, the constructor<br>of the object you've mapped to is not called. <br><br>$client = new SoapClient("url_to_wsdl", <br>&nbsp;&nbsp; array('classmap' =&gt; array('contact' =&gt; "Contact"));<br><br>$params = array("1");<br><br>$contact = $client-&gt;__soapCall("get_contact", $params);<br><br>Expected result:<br><br>A contact object that has properties initialized (i.e. db connections,<br>....).<br><br>Actual result:<br><br>A contact object without the properties.<br><br>Thanks for your help.<br><br>David Georges.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98086">  
  <a class="name">
  <strong class="user"><em>reinaldo at mandic dot com dot br</em></strong></a><div class="date" title="2010-05-25 07:43"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98086">
<div class="phpcode"><code><span class="html">
You need both certificates, privateKey and publicKey on the same file, on local_cert path to work.<br><br># cat publicKey.pem privateKey.pem &gt; key.pem</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/soapclient.soapclient.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:05:11 GMT -->


</body></html>