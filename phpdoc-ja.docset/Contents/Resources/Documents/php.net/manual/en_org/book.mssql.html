<html><!-- Mirrored from php.net/manual/en/book.mssql.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:46:04 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Mssql</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="book.mssql.html">
 <link rel="shorturl" href="http://php.net/mssql">
 <link rel="alternate" href="http://php.net/mssql" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="refs.database.vendors.html">
 <link rel="prev" href="function.msql.html">
 <link rel="next" href="intro.mssql.html">

 <link rel="alternate" href="book.mssql.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/book.mssql.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/book.mssql.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/book.mssql.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/book.mssql.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/book.mssql.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/book.mssql.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/book.mssql.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/book.mssql.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/book.mssql.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/book.mssql.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.vendors.html">Vendor Specific Database Extensions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="book.mssql" class="book">
 
 <h1 class="title">Microsoft SQL Server</h1>
 
 
 
 
 
 
 







 





 


 





<ul class="chunklist chunklist_book"><li><a href="intro.mssql.html">Introduction</a></li><li><a href="mssql.setup.html">Installing/Configuring</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="mssql.requirements.html">Requirements</a></li><li><a href="mssql.installation.html">Installation</a></li><li><a href="mssql.configuration.html">Runtime Configuration</a></li><li><a href="mssql.resources.html">Resource Types</a></li></ul></li><li><a href="mssql.constants.html">Predefined Constants</a></li><li><a href="ref.mssql.html">Mssql Functions</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="function.mssql-bind.html">mssql_bind</a> — Adds a parameter to a stored procedure or a remote stored procedure</li><li><a href="function.mssql-close.html">mssql_close</a> — Close MS SQL Server connection</li><li><a href="function.mssql-connect.html">mssql_connect</a> — Open MS SQL server connection</li><li><a href="function.mssql-data-seek.html">mssql_data_seek</a> — Moves internal row pointer</li><li><a href="function.mssql-execute.html">mssql_execute</a> — Executes a stored procedure on a MS SQL server database</li><li><a href="function.mssql-fetch-array.html">mssql_fetch_array</a> — Fetch a result row as an associative array, a numeric array, or both</li><li><a href="function.mssql-fetch-assoc.html">mssql_fetch_assoc</a> — Returns an associative array of the current row in the result</li><li><a href="function.mssql-fetch-batch.html">mssql_fetch_batch</a> — Returns the next batch of records</li><li><a href="function.mssql-fetch-field.html">mssql_fetch_field</a> — Get field information</li><li><a href="function.mssql-fetch-object.html">mssql_fetch_object</a> — Fetch row as object</li><li><a href="function.mssql-fetch-row.html">mssql_fetch_row</a> — Get row as enumerated array</li><li><a href="function.mssql-field-length.html">mssql_field_length</a> — Get the length of a field</li><li><a href="function.mssql-field-name.html">mssql_field_name</a> — Get the name of a field</li><li><a href="function.mssql-field-seek.html">mssql_field_seek</a> — Seeks to the specified field offset</li><li><a href="function.mssql-field-type.html">mssql_field_type</a> — Gets the type of a field</li><li><a href="function.mssql-free-result.html">mssql_free_result</a> — Free result memory</li><li><a href="function.mssql-free-statement.html">mssql_free_statement</a> — Free statement memory</li><li><a href="function.mssql-get-last-message.html">mssql_get_last_message</a> — Returns the last message from the server</li><li><a href="function.mssql-guid-string.html">mssql_guid_string</a> — Converts a 16 byte binary GUID to a string</li><li><a href="function.mssql-init.html">mssql_init</a> — Initializes a stored procedure or a remote stored procedure</li><li><a href="function.mssql-min-error-severity.html">mssql_min_error_severity</a> — Sets the minimum error severity</li><li><a href="function.mssql-min-message-severity.html">mssql_min_message_severity</a> — Sets the minimum message severity</li><li><a href="function.mssql-next-result.html">mssql_next_result</a> — Move the internal result pointer to the next result</li><li><a href="function.mssql-num-fields.html">mssql_num_fields</a> — Gets the number of fields in result</li><li><a href="function.mssql-num-rows.html">mssql_num_rows</a> — Gets the number of rows in result</li><li><a href="function.mssql-pconnect.html">mssql_pconnect</a> — Open persistent MS SQL connection</li><li><a href="function.mssql-query.html">mssql_query</a> — Send MS SQL query</li><li><a href="function.mssql-result.html">mssql_result</a> — Get result data</li><li><a href="function.mssql-rows-affected.html">mssql_rows_affected</a> — Returns the number of records affected by the query</li><li><a href="function.mssql-select-db.html">mssql_select_db</a> — Select MS SQL database</li></ul></li></ul></div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="92722">  
  <a class="name">
  <strong class="user"><em>exidas at madnes dot eu</em></strong></a><div class="date" title="2009-08-05 12:43"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom92722">
<div class="phpcode"><code><span class="html">
Hi, i was need some short and simple script to list all tables and columns of MSSQL database. There was nothing easy to explain on the net, so i've decided to share my short script, i hope it will help.
<br>
<br><span class="default">&lt;?php
<br>$all </span><span class="keyword">= </span><span class="default">MSSQL_Query</span><span class="keyword">(</span><span class="string">"select TABLE_NAME, COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS order by TABLE_NAME, ORDINAL_POSITION"</span><span class="keyword">);
<br>
<br></span><span class="default">$tables </span><span class="keyword">= array();
<br></span><span class="default">$columns </span><span class="keyword">= array();
<br>
<br>while(</span><span class="default">$fet_tbl </span><span class="keyword">= </span><span class="default">MSSQL_Fetch_Assoc</span><span class="keyword">(</span><span class="default">$all</span><span class="keyword">)) { </span><span class="comment">// PUSH ALL TABLES AND COLUMNS INTO THE ARRAY
<br>
<br>&nbsp; </span><span class="default">$tables</span><span class="keyword">[] = </span><span class="default">$fet_tbl</span><span class="keyword">[</span><span class="default">TABLE_NAME</span><span class="keyword">];
<br>&nbsp; </span><span class="default">$columns</span><span class="keyword">[] = </span><span class="default">$fet_tbl</span><span class="keyword">[</span><span class="default">COLUMN_NAME</span><span class="keyword">];
<br>
<br>}
<br>
<br></span><span class="default">$sltml </span><span class="keyword">= </span><span class="default">array_count_values</span><span class="keyword">(</span><span class="default">$tables</span><span class="keyword">); </span><span class="comment">// HOW MANY COLUMNS ARE IN THE TABLE
<br>
<br></span><span class="keyword">foreach(</span><span class="default">$sltml </span><span class="keyword">as </span><span class="default">$table_name </span><span class="keyword">=&gt; </span><span class="default">$id</span><span class="keyword">) {
<br> 
<br> echo </span><span class="string">"&lt;h2&gt;"</span><span class="keyword">. </span><span class="default">$table_name </span><span class="keyword">.</span><span class="string">" ("</span><span class="keyword">. </span><span class="default">$id </span><span class="keyword">.</span><span class="string">")&lt;/h2&gt;&lt;ol&gt;"</span><span class="keyword">;
<br> 
<br>&nbsp; &nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt;= </span><span class="default">$id</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; echo </span><span class="string">"&lt;li&gt;"</span><span class="keyword">. </span><span class="default">$columns</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] .</span><span class="string">"&lt;/li&gt;"</span><span class="keyword">;
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; echo</span><span class="string">"&lt;/ol&gt;"</span><span class="keyword">;
<br> 
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107056">  
  <a class="name">
  <strong class="user"><em>bryanpiercecap at gmail dot com</em></strong></a><div class="date" title="2012-01-03 10:19"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107056">
<div class="phpcode"><code><span class="html">
Here is version 3.0 of the MSSQL PHP driver.<br>1.1 is severely deprecated. <br><br><a rel="nofollow" target="_blank">http://www.microsoft.com/download/en/details.aspx?id=17308</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="96059">  
  <a class="name">
  <strong class="user"><em>beartenor1</em></strong></a><div class="date" title="2010-02-05 12:18"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96059">
<div class="phpcode"><code><span class="html">
As of October 2009, the new name is "SQL Server Driver for PHP 1.1"<br><br>Go to Microsoft Download Center <a rel="nofollow" target="_blank">http://www.microsoft.com/downloads</a> and search <br>for "SQL Server Driver for PHP" which should take you to the following link:<br><br><a rel="nofollow" target="_blank">http://www.microsoft.com/downloads/details.aspx?displaylang=en</a><br>&amp;FamilyID=ccdf728b-1ea0-48a8-a84a-5052214caad9<br><br>But I wouldn't trust it to stay there. Microsoft has been moving a lot of download links lately.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90669">  
  <a class="name">
  <strong class="user"><em>thanhha dot phan at yahoo dot com</em></strong></a><div class="date" title="2009-05-03 07:03"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90669">
<div class="phpcode"><code><span class="html">
I got a serious problem with Unicode data when working with PHP and MSSQL. I have to say the PHP and MSSQL doesn't seem to be a good combination.<br><br>MSSQL is really complicated to work with since the whole server uses a single character encoding[ucs-2]. In order to store unicode information, the column data types must be specified as one of the national character types, NVARCHAR, NCHAR or NTEXT. <br><br>In order to retrieve data saved in unicode format, M$ suggest users to cast columns to binary data.Unfortunately php_mssql extension doesn't support&nbsp; binary data to be returned in string columns.<br><br>My advice is to use FreeTDS driver [it's just an php extension]. This driver seems to handle unicode data better. I can put and receive unicode with casting or change encoding.<br><br>A good tutorial "Using freeTDS" can be found here<br><br><a rel="nofollow" target="_blank">http://docs.moodle.org/en/Installing_MSSQL_for_PHP</a><br><br>However, freeTDS is not a perfect solution for unicode data. I'm not able to execute stored procedures with mssql_bind, mssql_bind without having my text changed.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100219">  
  <a class="name">
  <strong class="user"><em>vexx at pisem dot net</em></strong></a><div class="date" title="2010-10-02 03:26"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100219">
<div class="phpcode"><code><span class="html">
this function get inserted ident like function mysql_insert_id()
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">mssql_insert_id</span><span class="keyword">() {
<br>&nbsp; &nbsp; </span><span class="default">$id </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$res </span><span class="keyword">= </span><span class="default">mssql_query</span><span class="keyword">(</span><span class="string">"SELECT @@identity AS id"</span><span class="keyword">);
<br>&nbsp; &nbsp; if (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">mysql_fetch_array</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">, </span><span class="default">MYSQL_ASSOC</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$id </span><span class="keyword">= </span><span class="default">$row</span><span class="keyword">[</span><span class="string">"id"</span><span class="keyword">];
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; return </span><span class="default">$id</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="93003">  
  <a class="name">
  <strong class="user"><em>michal dot kocarek at brainbox dot cz</em></strong></a><div class="date" title="2009-08-19 02:05"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom93003">
<div class="phpcode"><code><span class="html">
Microsoft has issued in nearly past Native SQL driver for PHP.<br>This driver works with MSSQL 2000, 2005 and 2008 servers. Driver is issued as PHP extension. Source codes also available.<br><br>The driver supports native conversion to UTF-8, scrollable cursors and other features which this (old) library does not.<br><br>For more information and extension download please see<br><a rel="nofollow" target="_blank">http://www.codeplex.com/SQLSRVPHP</a><br>They have also blog on <a rel="nofollow" target="_blank">http://blogs.msdn.com/sqlphp/</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="89509">  
  <a class="name">
  <strong class="user"><em>AA</em></strong></a><div class="date" title="2009-03-11 12:26"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom89509">
<div class="phpcode"><code><span class="html">
On windows, do not use this for mssql 2005 of later.&nbsp; The methods of access are deprecated.<br><br>Use the Microsoft SQL Server 2005 Driver for PHP instead.<br>Current link is.<br><a rel="nofollow" target="_blank">http://www.microsoft.com/sqlserver/2005/en/us/PHP-Driver.aspx</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="92929">  
  <a class="name">
  <strong class="user"><em>ccsalway at yahoo dot co dot uk</em></strong></a><div class="date" title="2009-08-15 12:02"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom92929">
<div class="phpcode"><code><span class="html">
Im running PHP 5.3 and used the php development ini and when I use the Microsoft SQL for PHP driver, I get the following error:<br><br>[15-Aug-2009 07:48:13] PHP Warning:&nbsp; PHP Startup: sqlsrv: Unable to initialize module<br>Module compiled with module API=20060613<br>PHP&nbsp; &nbsp; compiled with module API=20090626<br>These options need to match<br> in Unknown on line 0</span>
</code></div>
  </div>
 </div>
  <div class="note" id="93355">  
  <a class="name">
  <strong class="user"><em>tummen at jgd dot se</em></strong></a><div class="date" title="2009-09-05 03:28"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom93355">
<div class="phpcode"><code><span class="html">
i struggled with sqlsrv_connect for some time, first i had to get native client 2008 to get it to work, 2005 was not enough.<br><br>then i got som note that dll was compiled with wrong version, so i had to use test version 1.1 istead of 1.0 of the client and pick the version called php_sqlsrv_53_ts_vc6.dll<br><br>but still no success with connect.<br><br>finally i spent 7 hours testing things before i found out:<br><br>$serverName = "(local)"; ERROR for me<br><br>$serverName = "localhost\myinstansofdatabase"; //WOHOOOO</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91261">  
  <a class="name">
  <strong class="user"><em>opc dot three at gmail dot com</em></strong></a><div class="date" title="2009-06-02 08:50"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91261">
<div class="phpcode"><code><span class="html">
After extensive research trying to get PHP on Linux communicating with SQL Server 2005 and 2008 including support for all Unicode, MAX and XML data types I could not find any open source solutions...yes, I spent a lot of time trying to get FreeTDS to work to no avail.<br><br>I found one free solution that runs on Windows which is to use the "SQL Server Driver for PHP" provided by Microsoft (<a rel="nofollow" target="_blank">http://sql2k5php.codeplex.com</a>). The driver relies on the Microsoft Native Client ODBC drivers for SQL Server 2008 (part of the "Microsoft SQL Server 2008 Native Client" which is downloadable from Microsoft) which is why this solution will not work on anything except Windows.<br><br>I did find a solution that works for PHP on Linux but it's not free...use the standard PHP::ODBC lib (free) and the Easysoft ODBC driver for SQL Server (not free, but reasonable by Enterprise standards). You can check out the ODBC driver by going here <a rel="nofollow" target="_blank">http://www.easysoft.com/products/data_access</a> and looking for "Easysoft ODBC-SQL Server Driver"</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100283">  
  <a class="name">
  <strong class="user"><em>jezza at 9000internets dot com</em></strong></a><div class="date" title="2010-10-05 06:02"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100283">
<div class="phpcode"><code><span class="html">
Using the new MS driver I have come across a difference between the array that I get back compared to mssql.
<br>
<br>Example is here (both return types are associative arrays:
<br>
<br>sqlsrv_fetch_array($resource, SQLSRV_FETCH_ASSOC)
<br>"same as" sqlsrv_fetch($resource), as this returns by default an associative array, by default sqlsrv_fetch_array returns both an associative and a numeric array.
<br>
<br>returns...
<br>
<br>array(6) { ["yaxis"]=&gt; object(DateTime)#58 (3) { ["date"]=&gt; string(19) "2010-09-29 00:00:00" ["timezone_type"]=&gt; int(3) ["timezone"]=&gt; string(19) "Australia/Melbourne" } ["xaxis"]=&gt; string(7) "Inbound" ["tt"]=&gt; int(280345) ["ht"]=&gt; int(297219) ["wt"]=&gt; int(16874) ["calls"]=&gt; int(1539) } string(8) ""
<br>
<br>mssql_fetch_assoc($resource)
<br>
<br>returns
<br>
<br>array(6) { ["yaxis"]=&gt; string(19) "2010-09-29 00:00:00" ["xaxis"]=&gt; string(7) "Inbound" ["tt"]=&gt; int(280345) ["ht"]=&gt; int(297219) ["wt"]=&gt; int(16874) ["calls"]=&gt; int(1539) } string(8) ""
<br>
<br>it would be much too difficult to change a large number of applications to compensate for this.
<br>
<br>Found my answer...
<br>add this to your connection objects parameters on instantiation
<br>
<br>"ReturnDatesAsStrings"=&gt;true
<br>
<br>Found it buried in this article: <a rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/ee376928(SQL.90</a>).aspx</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/book.mssql.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:46:05 GMT -->


</body></html>