<html><!-- Mirrored from php.net/manual/en/function.curl-setopt.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:59:23 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>curl_setopt</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.curl-setopt.html">
 <link rel="shorturl" href="http://php.net/curl-setopt">
 <link rel="alternate" href="http://php.net/curl-setopt" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.curl.html">
 <link rel="prev" href="function.curl-setopt-array.html">
 <link rel="next" href="function.curl-share-close.html">

 <link rel="alternate" href="function.curl-setopt.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.curl-setopt.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.curl-setopt.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.curl-setopt.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.curl-setopt.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.curl-setopt.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.curl-setopt.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.curl-setopt.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.curl-setopt.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.curl-setopt.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.curl-setopt.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.remote.other.html">Other Services</a></li>      <li><a href="book.curl.html">cURL</a></li>      <li><a href="ref.curl.html">cURL Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.curl-setopt" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">curl_setopt</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.2, PHP 5)</p><p class="refpurpose"><span class="refname">curl_setopt</span> â€” <span class="dc-title">Set an option for a cURL transfer</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.curl-setopt-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>curl_setopt</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$ch</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$option</code></span>
   , <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$value</code></span>
   )</div>

  <p class="para rdfs-comment">
   Sets an option on the given cURL session handle.
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.curl-setopt-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    <dt>
<code class="parameter">ch</code>
</dt>
<dd>
<p class="para">A cURL handle returned by
<span class="function"><a href="function.curl-init.html" class="function">curl_init()</a></span>.</p></dd>

    
     <dt>
<code class="parameter">option</code></dt>

     <dd>

      <p class="para">
       The <em>CURLOPT_XXX</em> option to set.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">value</code></dt>

     <dd>

      <p class="para">
       The value to be set on <code class="parameter">option</code>.
      </p>
      <p class="para">
       <code class="parameter">value</code> should be a <span class="type"><a href="language.types.boolean.html" class="type bool">bool</a></span> for the
       following values of the <code class="parameter">option</code> parameter:
       </p><table class="doctable informaltable">
        
         <thead>
          <tr>
           <th>Option</th>
           <th>Set <code class="parameter">value</code> to</th>
           <th>Notes</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_AUTOREFERER</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to automatically set the <em>Referer:</em> field in
            requests where it follows a <em>Location:</em> redirect.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_BINARYTRANSFER</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to return the raw output when
            <strong><code>CURLOPT_RETURNTRANSFER</code></strong> is used.
           </td>
           <td style="vertical-align: top;">
            From PHP 5.1.3, this option has no effect: the raw output will
            always be returned when
            <strong><code>CURLOPT_RETURNTRANSFER</code></strong> is used.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_COOKIESESSION</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to mark this as a new cookie "session". It will force libcurl
            to ignore all cookies it is about to load that are "session cookies"
            from the previous session. By default, libcurl always stores and
            loads all cookies, independent if they are session cookies or not.
            Session cookies are cookies without expiry date and they are meant
            to be alive and existing for this "session" only.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_CERTINFO</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to output SSL certification information to <em>STDERR</em>
            on secure transfers.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.19.1. 
            Available since PHP 5.3.2. 
            Requires <strong><code>CURLOPT_VERBOSE</code></strong> to be on to have an effect.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_CONNECT_ONLY</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> tells the library to perform all the required proxy authentication 
            and connection setup, but no data transfer. This option is implemented for 
            HTTP, SMTP and POP3.
           </td>
           <td style="vertical-align: top;">
            Added in 7.15.2.
            Available since PHP 5.5.0.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_CRLF</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to convert Unix newlines to CRLF newlines
            on transfers.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_DNS_USE_GLOBAL_CACHE</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to use a global DNS cache. This option is
            not thread-safe and is enabled by default.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FAILONERROR</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to fail verbosely if the HTTP code returned
            is greater than or equal to 400. The default behavior is to return
            the page normally, ignoring the code.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FILETIME</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to attempt to retrieve the modification
            date of the remote document. This value can be retrieved using
            the <code class="parameter">CURLINFO_FILETIME</code> option with
            <span class="function"><a href="function.curl-getinfo.html" class="function">curl_getinfo()</a></span>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FOLLOWLOCATION</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to follow any
            <em>"Location: "</em> header that the server sends as
            part of the HTTP header (note this is recursive, PHP will follow as
            many <em>"Location: "</em> headers that it is sent,
            unless <strong><code>CURLOPT_MAXREDIRS</code></strong> is set).
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FORBID_REUSE</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to force the connection to explicitly
            close when it has finished processing, and not be pooled for reuse.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FRESH_CONNECT</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to force the use of a new connection
            instead of a cached one.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FTP_USE_EPRT</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to use EPRT (and LPRT) when doing active
            FTP downloads. Use <strong><code>FALSE</code></strong> to disable EPRT and LPRT and use PORT
            only.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FTP_USE_EPSV</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to first try an EPSV command for FTP
            transfers before reverting back to PASV. Set to <strong><code>FALSE</code></strong>
            to disable EPSV.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FTP_CREATE_MISSING_DIRS</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to create missing directories when an FTP operation
            encounters a path that currently doesn't exist.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FTPAPPEND</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to append to the remote file instead of
            overwriting it.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_TCP_NODELAY</code></strong></td>
           <td style="vertical-align: top;">
            Pass a long specifying whether the TCP_NODELAY option is to be set or
            cleared (1 = set, 0 = clear). The option is cleared by default.
           </td>
           <td style="vertical-align: top;">
            Available since PHP 5.2.1 for versions compiled with libcurl 7.11.2 or
            greater.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FTPASCII</code></strong></td>
           <td style="vertical-align: top;">
            An alias of
            <strong><code>CURLOPT_TRANSFERTEXT</code></strong>. Use that instead.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FTPLISTONLY</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to only list the names of an FTP
            directory.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_HEADER</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to include the header in the output.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td><strong><code>CURLINFO_HEADER_OUT</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to track the handle's request string.
           </td>
           <td style="vertical-align: top;">
            Available since PHP 5.1.3. The <strong><code>CURLINFO_</code></strong>
            prefix is intentional.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_HTTPGET</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to reset the HTTP request method to GET.
            Since GET is the default, this is only necessary if the request
            method has been changed.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_HTTPPROXYTUNNEL</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to tunnel through a given HTTP proxy.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_MUTE</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to be completely silent with regards to
            the cURL functions.
           </td>
           <td style="vertical-align: top;">
            Removed in cURL 7.15.5 (You can use CURLOPT_RETURNTRANSFER instead)
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_NETRC</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to scan the <var class="filename">~/.netrc</var>
            file to find a username and password for the remote site that
            a connection is being established with.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_NOBODY</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to exclude the body from the output.
            Request method is then set to HEAD. Changing this to <strong><code>FALSE</code></strong> does
            not change it to GET.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_NOPROGRESS</code></strong></td>
           <td style="vertical-align: top;"><p class="para">
            <strong><code>TRUE</code></strong> to disable the progress meter for cURL transfers.
            </p><blockquote class="note"><p><strong class="note">Note</strong>: 
             </p><p class="para">
              PHP automatically sets this option to <strong><code>TRUE</code></strong>, this should only be
              changed for debugging purposes.
             </p>
            <p></p></blockquote>
            <p></p></td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_NOSIGNAL</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to ignore any cURL function that causes a
            signal to be sent to the PHP process. This is turned on by default
            in multi-threaded SAPIs so timeout options can still be used.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.10.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_POST</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to do a regular HTTP POST. This POST is the
            normal <em>application/x-www-form-urlencoded</em> kind,
            most commonly used by HTML forms.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_PUT</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to HTTP PUT a file. The file to PUT must
            be set with <strong><code>CURLOPT_INFILE</code></strong> and
            <strong><code>CURLOPT_INFILESIZE</code></strong>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_RETURNTRANSFER</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to return the transfer as a string of the
            return value of <span class="function"><a href="function.curl-exec.html" class="function">curl_exec()</a></span> instead of outputting
            it out directly.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SAFE_UPLOAD</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to disable support for the <em>@</em> prefix for
            uploading files in <strong><code>CURLOPT_POSTFIELDS</code></strong>, which
            means that values starting with <em>@</em> can be safely
            passed as fields. <a href="class.curlfile.html" class="classname">CURLFile</a> may be used for
            uploads instead.
           </td>
           <td style="vertical-align: top;">
            Added in PHP 5.5.0 with <strong><code>FALSE</code></strong> as the default value. PHP 5.6.0
            changes the default value to <strong><code>TRUE</code></strong>.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSL_VERIFYPEER</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>FALSE</code></strong> to stop cURL from verifying the peer's
            certificate. Alternate certificates to verify against can be
            specified with the <strong><code>CURLOPT_CAINFO</code></strong> option
            or a certificate directory can be specified with the
            <strong><code>CURLOPT_CAPATH</code></strong> option.
           </td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> by default as of cURL 7.10. Default bundle installed as of
            cURL 7.10.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_TRANSFERTEXT</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to use ASCII mode for FTP transfers.
            For LDAP, it retrieves data in plain text instead of HTML. On
            Windows systems, it will not set <em>STDOUT</em> to binary
            mode.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_UNRESTRICTED_AUTH</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to keep sending the username and password
            when following locations (using
            <strong><code>CURLOPT_FOLLOWLOCATION</code></strong>), even when the
            hostname has changed.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_UPLOAD</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to prepare for an upload.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_VERBOSE</code></strong></td>
           <td style="vertical-align: top;">
            <strong><code>TRUE</code></strong> to output verbose information. Writes
            output to <em>STDERR</em>, or the file specified using
            <strong><code>CURLOPT_STDERR</code></strong>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

         </tbody>
        
       </table>

      <p></p>
      <p class="para">
       <code class="parameter">value</code> should be an <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span> for the
       following values of the <code class="parameter">option</code> parameter:
       </p><table class="doctable informaltable">
        
         <thead>
          <tr>
           <th>Option</th>
           <th>Set <code class="parameter">value</code> to</th>
           <th>Notes</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_BUFFERSIZE</code></strong></td>
           <td style="vertical-align: top;">
            The size of the buffer to use for each read. There is no guarantee
            this request will be fulfilled, however.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.10.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_CLOSEPOLICY</code></strong></td>
           <td style="vertical-align: top;">
            One of the <strong><code>CURLCLOSEPOLICY_*</code></strong> values.
            <blockquote class="note"><p><strong class="note">Note</strong>: 
             </p><p class="para">
              This option is deprecated, as it was never implemented in cURL and
              never had any effect.
             </p>
            <p></p></blockquote>
           </td>
           <td style="vertical-align: top;">
            Removed in PHP 5.6.0.
           </td>
          </tr>

          <tr>
           <td><strong><code>CURLOPT_CONNECTTIMEOUT</code></strong></td>
           <td style="vertical-align: top;">
            The number of seconds to wait while trying to connect. Use 0 to
            wait indefinitely.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_CONNECTTIMEOUT_MS</code></strong></td>
           <td style="vertical-align: top;">
            The number of milliseconds to wait while trying to connect. Use 0 to
            wait indefinitely.
            
            If libcurl is built to use the standard system name resolver, that
            portion of the connect will still use full-second resolution for
            timeouts with a minimum timeout allowed of one second.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.16.2. Available since PHP 5.2.3.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_DNS_CACHE_TIMEOUT</code></strong></td>
           <td style="vertical-align: top;">
            The number of seconds to keep DNS entries in memory. This
            option is set to 120 (2 minutes) by default.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FTPSSLAUTH</code></strong></td>
           <td style="vertical-align: top;">
            The FTP authentication method (when is activated):
            <em>CURLFTPAUTH_SSL</em> (try SSL first),
            <em>CURLFTPAUTH_TLS</em> (try TLS first), or
            <em>CURLFTPAUTH_DEFAULT</em> (let cURL decide).
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.12.2.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_HTTP_VERSION</code></strong></td>
           <td style="vertical-align: top;">
            <code class="parameter">CURL_HTTP_VERSION_NONE</code> (default, lets CURL
            decide which version to use),
            <code class="parameter">CURL_HTTP_VERSION_1_0</code> (forces HTTP/1.0),
            or <code class="parameter">CURL_HTTP_VERSION_1_1</code> (forces HTTP/1.1).
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_HTTPAUTH</code></strong></td>
           <td style="vertical-align: top;">
            <p class="para">
             The HTTP authentication method(s) to use. The options are:
             <code class="parameter">CURLAUTH_BASIC</code>,
             <code class="parameter">CURLAUTH_DIGEST</code>,
             <code class="parameter">CURLAUTH_GSSNEGOTIATE</code>,
             <code class="parameter">CURLAUTH_NTLM</code>,
             <code class="parameter">CURLAUTH_ANY</code>, and
             <code class="parameter">CURLAUTH_ANYSAFE</code>.
            </p>
            <p class="para">
             The bitwise <em>|</em> (or) operator can be used to combine
             more than one method. If this is done, cURL will poll the server to see
             what methods it supports and pick the best one.
            </p>
            <p class="para">
             <code class="parameter">CURLAUTH_ANY</code> is an alias for
             <em>CURLAUTH_BASIC | CURLAUTH_DIGEST | CURLAUTH_GSSNEGOTIATE | CURLAUTH_NTLM</em>.
            </p>
            <p class="para">
             <code class="parameter">CURLAUTH_ANYSAFE</code> is an alias for
             <em>CURLAUTH_DIGEST | CURLAUTH_GSSNEGOTIATE | CURLAUTH_NTLM</em>.
            </p>
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_INFILESIZE</code></strong></td>
           <td style="vertical-align: top;">
            The expected size, in bytes, of the file when uploading a file to
            a remote site. Note that using this option will not stop libcurl
            from sending more data, as exactly what is sent depends on
            <strong><code>CURLOPT_READFUNCTION</code></strong>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_LOW_SPEED_LIMIT</code></strong></td>
           <td style="vertical-align: top;">
            The transfer speed, in bytes per second, that the transfer should be
            below during the count of <strong><code>CURLOPT_LOW_SPEED_TIME</code></strong>
            seconds before PHP considers the transfer too slow and aborts.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_LOW_SPEED_TIME</code></strong></td>
           <td style="vertical-align: top;">
            The number of seconds the transfer speed should be below
            <strong><code>CURLOPT_LOW_SPEED_LIMIT</code></strong> before PHP considers
            the transfer too slow and aborts.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_MAXCONNECTS</code></strong></td>
           <td style="vertical-align: top;">
            The maximum amount of persistent connections that are allowed.
            When the limit is reached,
            <strong><code>CURLOPT_CLOSEPOLICY</code></strong> is used to determine
            which connection to close.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_MAXREDIRS</code></strong></td>
           <td style="vertical-align: top;">
            The maximum amount of HTTP redirections to follow. Use this option
            alongside <strong><code>CURLOPT_FOLLOWLOCATION</code></strong>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_PORT</code></strong></td>
           <td style="vertical-align: top;">
            An alternative port number to connect to.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_PROTOCOLS</code></strong></td>
           <td style="vertical-align: top;">
            <p class="para">
             Bitmask of <strong><code>CURLPROTO_*</code></strong> values. If used, this bitmask 
             limits what protocols libcurl may use in the transfer. This allows you to have
             a libcurl built to support a wide range of protocols but still limit specific
             transfers to only be allowed to use a subset of them. By default libcurl will
             accept all protocols it supports. 
             See also <strong><code>CURLOPT_REDIR_PROTOCOLS</code></strong>.
            </p>
            <p class="para">
             Valid protocol options are: 
             <code class="parameter">CURLPROTO_HTTP</code>,
             <code class="parameter">CURLPROTO_HTTPS</code>,
             <code class="parameter">CURLPROTO_FTP</code>,
             <code class="parameter">CURLPROTO_FTPS</code>,
             <code class="parameter">CURLPROTO_SCP</code>,
             <code class="parameter">CURLPROTO_SFTP</code>,
             <code class="parameter">CURLPROTO_TELNET</code>,
             <code class="parameter">CURLPROTO_LDAP</code>,
             <code class="parameter">CURLPROTO_LDAPS</code>,
             <code class="parameter">CURLPROTO_DICT</code>,
             <code class="parameter">CURLPROTO_FILE</code>,
             <code class="parameter">CURLPROTO_TFTP</code>,
             <code class="parameter">CURLPROTO_ALL</code>
            </p>
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.19.4.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_PROXYAUTH</code></strong></td>
           <td style="vertical-align: top;">
            The HTTP authentication method(s) to use for the proxy connection.
            Use the same bitmasks as described in
            <strong><code>CURLOPT_HTTPAUTH</code></strong>. For proxy authentication,
            only <code class="parameter">CURLAUTH_BASIC</code> and
            <code class="parameter">CURLAUTH_NTLM</code> are currently supported.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.10.7.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_PROXYPORT</code></strong></td>
           <td style="vertical-align: top;">
            The port number of the proxy to connect to. This port number can
            also be set in <strong><code>CURLOPT_PROXY</code></strong>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_PROXYTYPE</code></strong></td>
           <td style="vertical-align: top;">
            Either <code class="parameter">CURLPROXY_HTTP</code> (default) or
            <code class="parameter">CURLPROXY_SOCKS5</code>.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.10.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_REDIR_PROTOCOLS</code></strong></td>
           <td style="vertical-align: top;">
            Bitmask of <strong><code>CURLPROTO_*</code></strong> values. If used, this bitmask
            limits what protocols libcurl may use in a transfer that it follows to in
            a redirect when <strong><code>CURLOPT_FOLLOWLOCATION</code></strong> is enabled.
            This allows you to limit specific transfers to only be allowed to use a subset
            of protocols in redirections. By default libcurl will allow all protocols
            except for FILE and SCP. This is a difference compared to pre-7.19.4 versions
            which unconditionally would follow to all protocols supported. 
            See also <strong><code>CURLOPT_PROTOCOLS</code></strong> for protocol constant values.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.19.4.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_RESUME_FROM</code></strong></td>
           <td style="vertical-align: top;">
            The offset, in bytes, to resume a transfer from.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSL_VERIFYHOST</code></strong></td>
           <td style="vertical-align: top;">
            1 to check the existence of a common name in the
            SSL peer certificate. 2 to check the existence of
            a common name and also verify that it matches the hostname
            provided. In production environments the value of this option
            should be kept at 2 (default value).
           </td>
           <td style="vertical-align: top;">
            Support for value 1 removed in cURL 7.28.1
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSLVERSION</code></strong></td>
           <td style="vertical-align: top;">
            The SSL version (2 or 3) to use. By default PHP will try to determine
            this itself, although in some cases this must be set manually.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_TIMECONDITION</code></strong></td>
           <td style="vertical-align: top;">
            How <strong><code>CURLOPT_TIMEVALUE</code></strong> is treated.
            Use <code class="parameter">CURL_TIMECOND_IFMODSINCE</code> to return the
            page only if it has been modified since the time specified in
            <strong><code>CURLOPT_TIMEVALUE</code></strong>. If it hasn't been modified,
            a <em>"304 Not Modified"</em> header will be returned
            assuming <strong><code>CURLOPT_HEADER</code></strong> is <strong><code>TRUE</code></strong>.
            Use <code class="parameter">CURL_TIMECOND_IFUNMODSINCE</code> for the reverse
            effect. <code class="parameter">CURL_TIMECOND_IFMODSINCE</code> is the
            default.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_TIMEOUT</code></strong></td>
           <td style="vertical-align: top;">
            The maximum number of seconds to allow cURL functions to execute.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_TIMEOUT_MS</code></strong></td>
           <td style="vertical-align: top;">
            The maximum number of milliseconds to allow cURL functions to
            execute.
            
            If libcurl is built to use the standard system name resolver, that
            portion of the connect will still use full-second resolution for
            timeouts with a minimum timeout allowed of one second.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.16.2. Available since PHP 5.2.3.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_TIMEVALUE</code></strong></td>
           <td style="vertical-align: top;">
            The time in seconds since January 1st, 1970. The time will be used
            by <strong><code>CURLOPT_TIMECONDITION</code></strong>. By default,
            <code class="parameter">CURL_TIMECOND_IFMODSINCE</code> is used.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_MAX_RECV_SPEED_LARGE</code></strong></td>
           <td style="vertical-align: top;">
            If a download exceeds this speed (counted in bytes per second) on
            cumulative average during the transfer, the transfer will pause to
            keep the average rate less than or equal to the parameter value.
            Defaults to unlimited speed.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.15.5. Available since PHP 5.4.0.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_MAX_SEND_SPEED_LARGE</code></strong></td>
           <td style="vertical-align: top;">
            If an upload exceeds this speed (counted in bytes per second) on
            cumulative average during the transfer, the transfer will pause to
            keep the average rate less than or equal to the parameter value.
            Defaults to unlimited speed.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.15.5. Available since PHP 5.4.0.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSH_AUTH_TYPES</code></strong></td>
           <td style="vertical-align: top;">
            A bitmask consisting of one or more of 
            <strong><code>CURLSSH_AUTH_PUBLICKEY</code></strong>, 
            <strong><code>CURLSSH_AUTH_PASSWORD</code></strong>, 
            <strong><code>CURLSSH_AUTH_HOST</code></strong>, 
            <strong><code>CURLSSH_AUTH_KEYBOARD</code></strong>. Set to 
            <strong><code>CURLSSH_AUTH_ANY</code></strong> to let libcurl pick one.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.16.1. 
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_IPRESOLVE</code></strong></td>
           <td style="vertical-align: top;">
            Allows an application to select what kind of IP addresses to use when
            resolving host names. This is only interesting when using host names that
            resolve addresses using more than one version of IP, possible values are
            <strong><code>CURL_IPRESOLVE_WHATEVER</code></strong>, 
            <strong><code>CURL_IPRESOLVE_V4</code></strong>, 
            <strong><code>CURL_IPRESOLVE_V6</code></strong>, by default
            <strong><code>CURL_IPRESOLVE_WHATEVER</code></strong>.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.10.8.
           </td>
          </tr>

         </tbody>
        
       </table>

      <p></p>
      <p class="para">
       <code class="parameter">value</code> should be a <span class="type"><a href="language.types.string.html" class="type string">string</a></span> for the
       following values of the <code class="parameter">option</code> parameter:
       </p><table class="doctable informaltable">
        
         <thead>
          <tr>
           <th>Option</th>
           <th>Set <code class="parameter">value</code> to</th>
           <th>Notes</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_CAINFO</code></strong></td>
           <td style="vertical-align: top;">
            The name of a file holding one or more certificates to verify the
            peer with. This only makes sense when used in combination with
            <strong><code>CURLOPT_SSL_VERIFYPEER</code></strong>.
           </td>
           <td style="vertical-align: top;">
            Requires absolute path.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_CAPATH</code></strong></td>
           <td style="vertical-align: top;">
            A directory that holds multiple CA certificates. Use this option
            alongside <strong><code>CURLOPT_SSL_VERIFYPEER</code></strong>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_COOKIE</code></strong></td>
           <td style="vertical-align: top;">
            The contents of the <em>"Cookie: "</em> header to be
            used in the HTTP request.
            Note that multiple cookies are separated with a semicolon followed
            by a space (e.g., "<em>fruit=apple; colour=red</em>")
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_COOKIEFILE</code></strong></td>
           <td style="vertical-align: top;">
            The name of the file containing the cookie data. The cookie file can
            be in Netscape format, or just plain HTTP-style headers dumped into
            a file.
            If the name is an empty string, no cookies are loaded, but cookie
            handling is still enabled.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_COOKIEJAR</code></strong></td>
           <td style="vertical-align: top;">
            The name of a file to save all internal cookies to when the handle is closed, 
            e.g. after a call to curl_close.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_CUSTOMREQUEST</code></strong></td>
           <td style="vertical-align: top;"><p class="para">
            A custom request method to use instead of
            <em>"GET"</em> or <em>"HEAD"</em> when doing
            a HTTP request. This is useful for doing
            <em>"DELETE"</em> or other, more obscure HTTP requests.
            Valid values are things like <em>"GET"</em>,
            <em>"POST"</em>, <em>"CONNECT"</em> and so on;
            i.e. Do not enter a whole HTTP request line here. For instance,
            entering <em>"GET /index.html HTTP/1.0\r\n\r\n"</em>
            would be incorrect.
            </p><blockquote class="note"><p><strong class="note">Note</strong>: 
             </p><p class="para">
              Don't do this without making sure the server supports the custom
              request method first.
             </p>
            <p></p></blockquote>
            <p></p></td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_EGDSOCKET</code></strong></td>
           <td style="vertical-align: top;">
            Like <strong><code>CURLOPT_RANDOM_FILE</code></strong>, except a filename
            to an Entropy Gathering Daemon socket.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_ENCODING</code></strong></td>
           <td style="vertical-align: top;">
            The contents of the <em>"Accept-Encoding: "</em> header.
            This enables decoding of the response. Supported encodings are
            <em>"identity"</em>, <em>"deflate"</em>, and
            <em>"gzip"</em>. If an empty string, <em>""</em>,
            is set, a header containing all supported encoding types is sent.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.10.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FTPPORT</code></strong></td>
           <td style="vertical-align: top;">
            The value which will be used to get the IP address to use
            for the FTP "PORT" instruction. The "PORT" instruction tells
            the remote server to connect to our specified IP address.  The
            string may be a plain IP address, a hostname, a network
            interface name (under Unix), or just a plain '-' to use the
            systems default IP address.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_INTERFACE</code></strong></td>
           <td style="vertical-align: top;">
            The name of the outgoing network interface to use. This can be an
            interface name, an IP address or a host name.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_KEYPASSWD</code></strong></td>
           <td style="vertical-align: top;">
            The password required to use the <strong><code>CURLOPT_SSLKEY</code></strong> 
            or <strong><code>CURLOPT_SSH_PRIVATE_KEYFILE</code></strong> private key. 
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.16.1. 
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_KRB4LEVEL</code></strong></td>
           <td style="vertical-align: top;">
            The KRB4 (Kerberos 4) security level. Any of the following values
            (in order from least to most powerful) are valid:
            <em>"clear"</em>,
            <em>"safe"</em>,
            <em>"confidential"</em>,
            <em>"private".</em>.
            If the string does not match one of these,
            <em>"private"</em> is used. Setting this option to <strong><code>NULL</code></strong>
            will disable KRB4 security. Currently KRB4 security only works
            with FTP transactions.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_POSTFIELDS</code></strong></td>
           <td style="vertical-align: top;">
            <span class="simpara">
             The full data to post in a HTTP "POST" operation.
             To post a file, prepend a filename with <em>@</em> and
             use the full path. The filetype can be explicitly specified by
             following the filename with the type in the format
             '<em>;type=mimetype</em>'. This parameter can either be
             passed as a urlencoded string like '<em>para1=val1&amp;para2=val2&amp;...</em>' 
             or as an array with the field name as key and field data as value.
             If <code class="parameter">value</code> is an array, the
             <em>Content-Type</em> header will be set to
             <em>multipart/form-data</em>.
            </span>
            <span class="simpara">
             As of PHP 5.2.0, <code class="parameter">value</code> must be an array if
             files are passed to this option with the <em>@</em> prefix.
            </span>
            <span class="simpara">
             As of PHP 5.5.0, the <em>@</em> prefix is deprecated and
             files can be sent using <a href="class.curlfile.html" class="classname">CURLFile</a>. The 
             <em>@</em> prefix can be disabled for safe passing of
             values beginning with <em>@</em> by setting the 
             <strong><code>CURLOPT_SAFE_UPLOAD</code></strong> option to <strong><code>TRUE</code></strong>.
            </span>
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_PROXY</code></strong></td>
           <td style="vertical-align: top;">
            The HTTP proxy to tunnel requests through.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_PROXYUSERPWD</code></strong></td>
           <td style="vertical-align: top;">
            A username and password formatted as
            <em>"[username]:[password]"</em> to use for the
            connection to the proxy.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_RANDOM_FILE</code></strong></td>
           <td style="vertical-align: top;">
            A filename to be used to seed the random number generator for SSL.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_RANGE</code></strong></td>
           <td style="vertical-align: top;">
            Range(s) of data to retrieve in the format
            <em>"X-Y"</em> where X or Y are optional. HTTP transfers
            also support several intervals, separated with commas in the format
            <em>"X-Y,N-M"</em>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_REFERER</code></strong></td>
           <td style="vertical-align: top;">
            The contents of the <em>"Referer: "</em> header to be used
            in a HTTP request.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSH_HOST_PUBLIC_KEY_MD5</code></strong></td>
           <td style="vertical-align: top;">
            A string containing 32 hexadecimal digits. The string should be the 
            MD5 checksum of the remote host's public key, and libcurl will reject 
            the connection to the host unless the md5sums match. 
            This option is only for SCP and SFTP transfers.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.17.1. 
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSH_PUBLIC_KEYFILE</code></strong></td>
           <td style="vertical-align: top;">
            The file name for your public key. If not used, libcurl defaults to 
            $HOME/.ssh/id_dsa.pub if the HOME environment variable is set, 
            and just "id_dsa.pub" in the current directory if HOME is not set.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.16.1. 
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSH_PRIVATE_KEYFILE</code></strong></td>
           <td style="vertical-align: top;">
            The file name for your private key. If not used, libcurl defaults to 
            $HOME/.ssh/id_dsa if the HOME environment variable is set, 
            and just "id_dsa" in the current directory if HOME is not set. 
            If the file is password-protected, set the password with 
            <strong><code>CURLOPT_KEYPASSWD</code></strong>.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.16.1. 
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSL_CIPHER_LIST</code></strong></td>
           <td style="vertical-align: top;">
            A list of ciphers to use for SSL. For example,
            <em>RC4-SHA</em> and <em>TLSv1</em> are valid
            cipher lists.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSLCERT</code></strong></td>
           <td style="vertical-align: top;">
            The name of a file containing a PEM formatted certificate.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSLCERTPASSWD</code></strong></td>
           <td style="vertical-align: top;">
            The password required to use the
            <strong><code>CURLOPT_SSLCERT</code></strong> certificate.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSLCERTTYPE</code></strong></td>
           <td style="vertical-align: top;">
            The format of the certificate. Supported formats are
            <em>"PEM"</em> (default), <em>"DER"</em>,
            and <em>"ENG"</em>.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.9.3.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSLENGINE</code></strong></td>
           <td style="vertical-align: top;">
            The identifier for the crypto engine of the private SSL key
            specified in <strong><code>CURLOPT_SSLKEY</code></strong>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSLENGINE_DEFAULT</code></strong></td>
           <td style="vertical-align: top;">
            The identifier for the crypto engine used for asymmetric crypto
            operations.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSLKEY</code></strong></td>
           <td style="vertical-align: top;">
            The name of a file containing a private SSL key.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSLKEYPASSWD</code></strong></td>
           <td style="vertical-align: top;"><p class="para">
            The secret password needed to use the private SSL key specified in
            <strong><code>CURLOPT_SSLKEY</code></strong>.
            </p><blockquote class="note"><p><strong class="note">Note</strong>: 
             </p><p class="para">
              Since this option contains a sensitive password, remember to keep
              the PHP script it is contained within safe.
             </p>
            <p></p></blockquote>
            <p></p></td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SSLKEYTYPE</code></strong></td>
           <td style="vertical-align: top;">
            The key type of the private SSL key specified in
            <strong><code>CURLOPT_SSLKEY</code></strong>. Supported key types are
            <em>"PEM"</em> (default), <em>"DER"</em>,
            and <em>"ENG"</em>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_URL</code></strong></td>
           <td style="vertical-align: top;">
            The URL to fetch. This can also be set when initializing a
            session with <span class="function"><a href="function.curl-init.html" class="function">curl_init()</a></span>.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_USERAGENT</code></strong></td>
           <td style="vertical-align: top;">
            The contents of the <em>"User-Agent: "</em> header to be
            used in a HTTP request.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_USERPWD</code></strong></td>
           <td style="vertical-align: top;">
            A username and password formatted as
            <em>"[username]:[password]"</em> to use for the
            connection.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

         </tbody>
        
       </table>

      <p></p>
      <p class="para">
       <code class="parameter">value</code> should be an array for the
       following values of the <code class="parameter">option</code> parameter:
       </p><table class="doctable informaltable">
        
         <thead>
          <tr>
           <th>Option</th>
           <th>Set <code class="parameter">value</code> to</th>
           <th>Notes</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_HTTP200ALIASES</code></strong></td>
           <td style="vertical-align: top;">
            An array of HTTP 200 responses that will be treated as valid
            responses and not as errors.
           </td>
           <td style="vertical-align: top;">
            Added in cURL 7.10.3.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_HTTPHEADER</code></strong></td>
           <td style="vertical-align: top;">
            An array of HTTP header fields to set, in the format
            <code class="code">
             array('Content-type: text/plain', 'Content-length: 100')
            </code>
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_POSTQUOTE</code></strong></td>
           <td style="vertical-align: top;">
            An array of FTP commands to execute on the server after the FTP
            request has been performed.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_QUOTE</code></strong></td>
           <td style="vertical-align: top;">
            An array of FTP commands to execute on the server prior to the FTP
            request.
           </td>
           <td style="vertical-align: top;">
           </td>
          </tr>

         </tbody>
        
       </table>

      <p></p>
      <p class="para">
       <code class="parameter">value</code> should be a stream resource (using
       <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span>, for example) for the following values of the
       <code class="parameter">option</code> parameter:
       </p><table class="doctable informaltable">
        
         <thead>
          <tr>
           <th>Option</th>
           <th>Set <code class="parameter">value</code> to</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_FILE</code></strong></td>
           <td style="vertical-align: top;">
            The file that the transfer should be written to. The default
            is <em>STDOUT</em> (the browser window).
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_INFILE</code></strong></td>
           <td style="vertical-align: top;">
            The file that the transfer should be read from when uploading.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_STDERR</code></strong></td>
           <td style="vertical-align: top;">
            An alternative location to output errors to instead of
            <em>STDERR</em>.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_WRITEHEADER</code></strong></td>
           <td style="vertical-align: top;">
            The file that the header part of the transfer is written to.
           </td>
          </tr>

         </tbody>
        
       </table>

      <p></p>
      <p class="para">
       <code class="parameter">value</code> should be the name of a valid function or a Closure 
       for the following values of the <code class="parameter">option</code> parameter:
       </p><table class="doctable informaltable">
        
         <thead>
          <tr>
           <th>Option</th>
           <th>Set <code class="parameter">value</code> to</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_HEADERFUNCTION</code></strong></td>
           <td style="vertical-align: top;">
            A callback accepting two parameters.
            The first is the cURL resource, the second is a
            string with the header data to be written. The header data must
            be written when by this callback. Return the number of 
            bytes written.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_PASSWDFUNCTION</code></strong></td>
           <td style="vertical-align: top;">
            A callback accepting three parameters. 
            The first is the cURL resource, the second is a
            string containing a password prompt, and the third is the maximum
            password length. Return the string containing the password.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_PROGRESSFUNCTION</code></strong></td>
           <td style="vertical-align: top;">
            <p class="para">
             A callback accepting five parameters.
             The first is the cURL resource, the second is the total number of
             bytes expected to be downloaded in this transfer, the third is
             the number of bytes downloaded so far, the fourth is the total
             number of bytes expected to be uploaded in this transfer, and the
             fifth is the number of bytes uploaded so far.
            </p>
            <blockquote class="note"><p><strong class="note">Note</strong>: 
             </p><p class="para">
              The callback is only called when the <strong><code>CURLOPT_NOPROGRESS</code></strong>
              option is set to <strong><code>FALSE</code></strong>.
             </p>
            <p></p></blockquote>
            <p class="para">
             Return a non-zero value to abort the transfer. In which case, the
             transfer will set a <strong><code>CURLE_ABORTED_BY_CALLBACK</code></strong>
             error.
            </p>
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_READFUNCTION</code></strong></td>
           <td style="vertical-align: top;">
            A callback accepting three parameters. 
            The first is the cURL resource, the second is a
            stream resource provided to cURL through the option
            <strong><code>CURLOPT_INFILE</code></strong>, and the third is the maximum
            amount of data to be read. The callback must return a string
            with a length equal or smaller than the amount of data requested,
            typically by reading it from the passed stream resource. It should
            return an empty string to signal <em>EOF</em>.
           </td>
          </tr>

          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_WRITEFUNCTION</code></strong></td>
           <td style="vertical-align: top;">
            A callback accepting two parameters. 
            The first is the cURL resource, and the second is a
            string with the data to be written. The data must be saved by
            this callback. It must return the exact number of bytes written 
            or the transfer will be aborted with an error.
           </td>
          </tr>

         </tbody>
        
       </table>

      <p></p>
      <p class="para">
       Other values:
       </p><table class="doctable informaltable">
        
         <thead>
          <tr>
           <th>Option</th>
           <th>Set <code class="parameter">value</code> to</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td style="vertical-align: top;"><strong><code>CURLOPT_SHARE</code></strong></td>
           <td style="vertical-align: top;">
            A result of <span class="function"><a href="function.curl-share-init.html" class="function">curl_share_init()</a></span>. Makes the cURL
            handle to use the data from the shared handle.
           </td>
          </tr>

         </tbody>
        
       </table>

      <p></p>
     </dd>

    
   </dl>

  <p></p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.curl-setopt-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <strong><code>TRUE</code></strong> on success or <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>

 
 <div class="refsect1 changelog" id="refsect1-function.curl-setopt-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   </p><table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.6.0</td>
       <td>
        <strong><code>CURL_SAFE_UPLOAD</code></strong> is now <strong><code>TRUE</code></strong> by default.
       </td>
      </tr>

      <tr>
       <td>5.6.0</td>
       <td>
        Removed <strong><code>CURLOPT_CLOSEPOLICY</code></strong> and associated values.
       </td>
      </tr>

      <tr>
       <td>5.5.0</td>
       <td>
        Added the cURL resource as the first argument to the
        <strong><code>CURLOPT_PROGRESSFUNCTION</code></strong> callback.
       </td>
      </tr>

      <tr>
       <td>5.5.0</td>
       <td>
        Introduced <strong><code>CURLOPT_SHARE</code></strong>.
       </td>
      </tr>

      <tr>
       <td>5.3.0</td>
       <td>
        Introduced <strong><code>CURLOPT_PROGRESSFUNCTION</code></strong>.
       </td>
      </tr>

      <tr>
       <td>5.2.10</td>
       <td>
        Introduced <strong><code>CURLOPT_PROTOCOLS</code></strong>, and
        <strong><code>CURLOPT_REDIR_PROTOCOLS</code></strong>.
       </td>
      </tr>

      <tr>
       <td>5.1.0</td>
       <td>
        Introduced <strong><code>CURLOPT_AUTOREFERER</code></strong>,
        <strong><code>CURLOPT_BINARYTRANSFER</code></strong>,
        <strong><code>CURLOPT_FTPSSLAUTH</code></strong>,
        <strong><code>CURLOPT_PROXYAUTH</code></strong>, and
        <strong><code>CURLOPT_TIMECONDITION</code></strong>.
       </td>
      </tr>

      <tr>
       <td>5.0.0</td>
       <td>
        Introduced <strong><code>CURLOPT_FTP_USE_EPRT</code></strong>,
        <strong><code>CURLOPT_NOSIGNAL</code></strong>,
        <strong><code>CURLOPT_UNRESTRICTED_AUTH</code></strong>,
        <strong><code>CURLOPT_BUFFERSIZE</code></strong>,
        <strong><code>CURLOPT_HTTPAUTH</code></strong>,
        <strong><code>CURLOPT_PROXYPORT</code></strong>,
        <strong><code>CURLOPT_PROXYTYPE</code></strong>,
        <strong><code>CURLOPT_SSLCERTTYPE</code></strong>, and
        <strong><code>CURLOPT_HTTP200ALIASES</code></strong>.
       </td>
      </tr>

     </tbody>
    
   </table>

  <p></p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.curl-setopt-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-4338">
    <p><strong>Example #1 Initializing a new cURL session and fetching a web page</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;create&nbsp;a&nbsp;new&nbsp;cURL&nbsp;resource<br></span><span style="color: #0000BB">$ch&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">curl_init</span><span style="color: #007700">();<br><br></span><span style="color: #FF8000">//&nbsp;set&nbsp;URL&nbsp;and&nbsp;other&nbsp;appropriate&nbsp;options<br></span><span style="color: #0000BB">curl_setopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">CURLOPT_URL</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"http://www.example.com/"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">curl_setopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">CURLOPT_HEADER</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;grab&nbsp;URL&nbsp;and&nbsp;pass&nbsp;it&nbsp;to&nbsp;the&nbsp;browser<br></span><span style="color: #0000BB">curl_exec</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;close&nbsp;cURL&nbsp;resource,&nbsp;and&nbsp;free&nbsp;up&nbsp;system&nbsp;resources<br></span><span style="color: #0000BB">curl_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-4339">
    <p><strong>Example #2 Uploading file</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br></span><span style="color: #FF8000">/*&nbsp;http://localhost/upload.php:<br>print_r($_POST);<br>print_r($_FILES);<br>*/<br><br></span><span style="color: #0000BB">$ch&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">curl_init</span><span style="color: #007700">();<br><br></span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'name'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'Foo'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'file'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'@/home/user/test.png'</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">curl_setopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">CURLOPT_URL</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'http://localhost/upload.php'</span><span style="color: #007700">);<br></span><span style="color: #0000BB">curl_setopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">CURLOPT_POST</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br></span><span style="color: #0000BB">curl_setopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">CURLOPT_POSTFIELDS</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">curl_exec</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>Array
(
    [name] =&gt; Foo
)
Array
(
    [file] =&gt; Array
        (
            [name] =&gt; test.png
            [type] =&gt; image/png
            [tmp_name] =&gt; /tmp/phpcpjNeQ
            [error] =&gt; 0
            [size] =&gt; 279
        )

)

</pre></div>
    </div>
   </div>
  <p></p>
 </div>

 
 <div class="refsect1 notes" id="refsect1-function.curl-setopt-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    Passing an array to <strong><code>CURLOPT_POSTFIELDS</code></strong> will 
    encode the data as <em class="emphasis">multipart/form-data</em>,
    while passing a URL-encoded string will encode the data as
    <em class="emphasis">application/x-www-form-urlencoded</em>.
   </p>
  <p></p></blockquote>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.curl-setopt-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.curl-setopt-array.html" class="function" rel="rdfs-seeAlso">curl_setopt_array()</a> - Set multiple options for a cURL transfer</span></li>
   </ul>
  <p></p>
 </div>

 
</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="110457">  
  <a class="name">
  <strong class="user"><em>rmckay at webaware dot com dot au</em></strong></a><div class="date" title="2012-10-24 12:21"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom110457">
<div class="phpcode"><code><span class="html">
Please everyone, stop setting CURLOPT_SSL_VERIFYPEER to false or 0. If your PHP installation doesn't have an up-to-date CA root certificate bundle, download the one at the curl website and save it on your server:<br><br><a rel="nofollow" target="_blank">http://curl.haxx.se/docs/caextract.html</a><br><br>Then set a path to it in your php.ini file, e.g. on Windows:<br><br>curl.cainfo=c:\php\cacert.pem<br><br>Turning off CURLOPT_SSL_VERIFYPEER allows man in the middle (MITM) attacks, which you don't want!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="66832">  
  <a class="name">
  <strong class="user"><em>Philippe dot Jausions at 11abacus dot com</em></strong></a><div class="date" title="2006-05-30 11:31"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom66832">
<div class="phpcode"><code><span class="html">
Clarification on the callback methods:<br><br>- CURLOPT_HEADERFUNCTION is for handling header lines received *in the response*,<br>- CURLOPT_WRITEFUNCTION is for handling data received *from the response*,<br>- CURLOPT_READFUNCTION is for handling data passed along *in the request*.<br><br>The callback "string" can be any callable function, that includes the array(&amp;$obj, 'someMethodName') format.<br><br> -Philippe</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96056">  
  <a class="name">
  <strong class="user"><em>Ed Cradock</em></strong></a><div class="date" title="2010-02-05 10:47"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96056">
<div class="phpcode"><code><span class="html">
PUT requests are very simple, just make sure to specify a content-length header and set post fields as a string.
<br>
<br>Example:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">doPut</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$fields</span><span class="keyword">)
<br>{
<br>&nbsp;&nbsp; </span><span class="default">$fields </span><span class="keyword">= (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$fields</span><span class="keyword">)) ? </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$fields</span><span class="keyword">) : </span><span class="default">$fields</span><span class="keyword">;
<br>
<br>&nbsp;&nbsp; if(</span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">))
<br>&nbsp;&nbsp; {
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_CUSTOMREQUEST</span><span class="keyword">, </span><span class="string">'PUT'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, array(</span><span class="string">'Content-Length: ' </span><span class="keyword">. </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$fields</span><span class="keyword">)));
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$fields</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$status </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLINFO_HTTP_CODE</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; return (int) </span><span class="default">$status</span><span class="keyword">;
<br>&nbsp;&nbsp; }
<br>&nbsp;&nbsp; else
<br>&nbsp;&nbsp; {
<br>&nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp;&nbsp; }
<br>}
<br>
<br>if(</span><span class="default">doPut</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://example.com/api/a/b/c</a>'</span><span class="keyword">, array(</span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="string">'bar'</span><span class="keyword">)) == </span><span class="default">200</span><span class="keyword">)
<br>&nbsp;&nbsp; </span><span class="comment">// do something
<br></span><span class="keyword">else
<br>&nbsp;&nbsp; </span><span class="comment">// do something else.
<br></span><span class="default">?&gt;
<br></span>
<br>You can grab the request data on the other side with:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">if(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REQUEST_METHOD'</span><span class="keyword">] == </span><span class="string">'PUT'</span><span class="keyword">)
<br>{
<br>&nbsp;&nbsp; </span><span class="default">parse_str</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'php://input'</span><span class="keyword">), </span><span class="default">$requestData</span><span class="keyword">);
<br>
<br>&nbsp;&nbsp; </span><span class="comment">// Array ( [foo] =&gt; bar )
<br>&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$requestData</span><span class="keyword">);
<br>
<br>&nbsp;&nbsp; </span><span class="comment">// Do something with data...
<br></span><span class="keyword">}
<br></span><span class="default">?&gt;
<br></span>
<br>DELETE&nbsp; can be done in exactly the same way.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99082">  
  <a class="name">
  <strong class="user"><em>joeterranova at gmail dot com</em></strong></a><div class="date" title="2010-07-26 12:57"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom99082">
<div class="phpcode"><code><span class="html">
It appears that setting CURLOPT_FILE before setting CURLOPT_RETURNTRANSFER doesn't work, presumably because CURLOPT_FILE depends on CURLOPT_RETURNTRANSFER being set.
<br>
<br>So do this:
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FILE</span><span class="keyword">, </span><span class="default">$fp</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>not this:
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FILE</span><span class="keyword">, </span><span class="default">$fp</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="93686">  
  <a class="name">
  <strong class="user"><em>Chris at PureFormSolutions dot com</em></strong></a><div class="date" title="2009-09-22 03:54"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom93686">
<div class="phpcode"><code><span class="html">
I've found that setting CURLOPT_HTTPHEADER more than once will clear out any headers you've set previously with CURLOPT_HTTPHEADER.<br><br>Consider the following:<br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="comment"># ...<br><br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$cURL</span><span class="keyword">,</span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">,array (<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Content-Type: text/xml; charset=utf-8"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Expect: 100-continue"<br>&nbsp; &nbsp; </span><span class="keyword">));<br><br>&nbsp; &nbsp; </span><span class="comment"># ... do some other stuff ...<br><br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$cURL</span><span class="keyword">,</span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">,array (<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Accept: application/json"<br>&nbsp; &nbsp; </span><span class="keyword">));<br><br>&nbsp; &nbsp; </span><span class="comment"># ...<br></span><span class="default">?&gt;<br></span><br>Both the Content-Type and Expect I set will not be in the outgoing headers, but Accept will.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110442">  
  <a class="name">
  <strong class="user"><em>regan dot corey at gmail dot com</em></strong></a><div class="date" title="2012-10-22 10:22"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom110442">
<div class="phpcode"><code><span class="html">
I spent a couple of days trying to POST a multi-dimensional array of form fields, including a file upload, to a remote server to update a product. Here are the breakthroughs that FINALLY allowed the script to run as desired.<br><br>Firstly, the HTML form used input names like these:<br>&lt;input type="text" name="product[name]" /&gt;<br>&lt;input type="text" name="product[cost]" /&gt;<br>&lt;input type="file" name="product[thumbnail]" /&gt;<br>in conjunction with two other form inputs not part of the product array<br>&lt;input type="text" name="method" value="put" /&gt;<br>&lt;input type="text" name="mode" /&gt;<br><br>I used several cURL options, but the only two (other than URL) that mattered were:<br>curl_setopt($handle, CURLOPT_POST, true);<br>curl_setopt($handle, CURLOPT_POSTFIELDS, $postfields);<br>Pretty standard so far.<br>Note: headers didn't need to be set, cURL automatically sets headers (like content-type: multipart/form-data; content-length...) when you pass an array into CURLOPT_POSTFIELDS.<br>Note: even though this is supposed to be a PUT command through an HTTP POST form, no special PUT options needed to be passed natively through cURL. Options such as<br>curl_setopt($handle, CURLOPT_HTTPHEADER, array('X-HTTP-Method-Override: PUT', 'Content-Length: ' . strlen($fields)));<br>or<br>curl_setopt($handle, CURLOPT_PUT, true);<br>or<br>curl_setopt($handle, CURLOPT_CUSTOMREQUEST, "PUT);<br>were not needed to make the code work.<br><br>The fields I wanted to pass through cURL were arranged into an array something like this:<br>$postfields = array("method" =&gt; $_POST["method"],<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "mode" =&gt; $_POST["mode"],<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "product" =&gt; array("name" =&gt; $_POST["product"], <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "cost" =&gt; $_POST["product"]["cost"], <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "thumbnail" =&gt; "@{$_FILES["thumbnail"]["tmp_name"]};type={$_FILES["thumbnail"]["type"]}")<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br><br>-Notice how the @ precedes the temporary filename, this creates a link so PHP will upload/transfer an actual file instead of just the file name, which would happen if the @ isn't included.<br>-Notice how I forcefully set the mime-type of the file to upload. I was having issues where images filetypes were defaulting to octet-stream instead of image/png or image/jpeg or whatever the type of the selected image.<br><br>I then tried passing $postfields straight into curl_setopt($this-&gt;handle, CURLOPT_POSTFIELDS, $postfields); but it didn't work.<br>I tried using http_build_query($postfields); but that didn't work properly either.<br>In both cases either the file wouldn't be treated as an actual file and the form data wasn't being sent properly. The problem was HTTP's methods of transmitting arrays. While PHP and other languages can figure out how to handle arrays passed via forms, HTTP isn't quite as sofisticated. I had to rewrite the $postfields array like so:<br>$postfields = array("method" =&gt; $_POST["method"],<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "mode" =&gt; $_POST["mode"],<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "product[name]" =&gt; $_POST["product"], <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "product[cost]" =&gt; $_POST["product"]["cost"], <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "product[thumbnail]" =&gt; "@{$_FILES["thumbnail"]["tmp_name"]}");<br>curl_setopt($handle, CURLOPT_POSTFIELDS, $postfields);<br><br>This, without the use of http_build_query, solved all of my problems. Now the receiving host outputs both $_POST and $_FILES vars correctly.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87341">  
  <a class="name">
  <strong class="user"><em>fnjordy at gmail dot com</em></strong></a><div class="date" title="2008-11-30 11:28"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom87341">
<div class="phpcode"><code><span class="html">
Note that CURLOPT_RETURNTRANSFER when used with CURLOPT_WRITEFUNCTION has effectively three settings: default, true, and false.<br><br>default - callbacks will be called as expected.<br>true - content will be returned but callback function will not be called.<br>false - content will be output and callback function will not be called.<br><br>Note that CURLOPT_HEADERFUNCTION callbacks are always called.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104597">  
  <a class="name">
  <strong class="user"><em>Steve Kamerman</em></strong></a><div class="date" title="2011-06-24 11:47"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom104597">
<div class="phpcode"><code><span class="html">
If you want cURL to timeout in less than one second, you can use CURLOPT_TIMEOUT_MS, although there is a bug/"feature"&nbsp; on "Unix-like systems" that causes libcurl to timeout immediately if the value is &lt; 1000 ms with the error "cURL Error (28): Timeout was reached".&nbsp; The explanation for this behavior is:<br><br>"If libcurl is built to use the standard system name resolver, that portion of the transfer will still use full-second resolution for timeouts with a minimum timeout allowed of one second."<br><br>What this means to PHP developers is "You can use this function without testing it first, because you can't tell if libcurl is using the standard system name resolver (but you can be pretty sure it is)"<br><br>The problem is that on (Li|U)nix, when libcurl uses the standard name resolver, a SIGALRM is raised during name resolution which libcurl thinks is the timeout alarm.<br><br>The solution is to disable signals using CURLOPT_NOSIGNAL.&nbsp; Here's an example script that requests itself causing a 10-second delay so you can test timeouts:<br><br><span class="default">&lt;?php<br></span><span class="keyword">if (!isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'foo'</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Client<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://localhost/test/test_timeout.php?foo=bar</a>'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_NOSIGNAL</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMEOUT_MS</span><span class="keyword">, </span><span class="default">200</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$curl_errno </span><span class="keyword">= </span><span class="default">curl_errno</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$curl_error </span><span class="keyword">= </span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$curl_errno </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"cURL Error (</span><span class="default">$curl_errno</span><span class="string">): </span><span class="default">$curl_error</span><span class="string">\n"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Data received: </span><span class="default">$data</span><span class="string">\n"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>} else {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Server<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Done."</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87112">  
  <a class="name">
  <strong class="user"><em>saidk at phirebranding dot com</em></strong></a><div class="date" title="2008-11-19 01:31"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom87112">
<div class="phpcode"><code><span class="html">
Passing in PHP's $_SESSION into your cURL call:
<br>
<br><span class="default">&lt;?php
<br>session_start</span><span class="keyword">();
<br></span><span class="default">$strCookie </span><span class="keyword">= </span><span class="string">'PHPSESSID=' </span><span class="keyword">. </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'PHPSESSID'</span><span class="keyword">] . </span><span class="string">'; path=/'</span><span class="keyword">;
<br></span><span class="default">session_write_close</span><span class="keyword">();
<br>
<br></span><span class="default">$curl_handle </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="string">'enter_external_url_here'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">( </span><span class="default">$curl_handle</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIE</span><span class="keyword">, </span><span class="default">$strCookie </span><span class="keyword">);
<br></span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$curl_handle</span><span class="keyword">);
<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$curl_handle</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>This worked great for me.&nbsp; I was calling pages from the same server and needed to keep the $_SESSION variables.&nbsp; This passes them over.&nbsp; If you want to test, just print_r($_SESSION);
<br>
<br>Enjoy!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109319">  
  <a class="name">
  <strong class="user"><em>adrian at foeder dot de</em></strong></a><div class="date" title="2012-07-06 07:37"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom109319">
<div class="phpcode"><code><span class="html">
if you want to do a GET request with additional body data it will become tricky not to implicitly change the request to a POST, like many notes below correctly state.<br>So to do the analogy of command line's<br><br>curl -XGET '<a rel="nofollow" target="_blank">http://example.org?foo=bar</a>' -d '&lt;baz&gt;some additional data&lt;/baz&gt;'<br><br>in PHP you'll do, besides your other necessary stuff,<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; curl_setopt</span><span class="keyword">(</span><span class="default">$curlHandle</span><span class="keyword">, </span><span class="default">CURLOPT_CUSTOMREQUEST</span><span class="keyword">, </span><span class="string">'GET'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curlHandle</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="string">'&lt;baz&gt;some additional data&lt;/baz&gt;'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>during my experiments, every other "similar" way, like e.g. CURLOPT_HTTPGET, didn't send the additional data or fell into POST.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82418">  
  <a class="name">
  <strong class="user"><em>sgamon at yahoo dot com</em></strong></a><div class="date" title="2008-04-09 05:55"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82418">
<div class="phpcode"><code><span class="html">
If you are doing a POST, and the content length is 1,025 or greater, then curl exploits a feature of http 1.1: 100 (Continue) Status.<br><br>See <a rel="nofollow" target="_blank">http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.2.3</a><br><br>* it adds a header, "Expect: 100-continue".&nbsp; <br>* it then sends the request head, waits for a 100 response code, then sends the content <br><br>Not all web servers support this though.&nbsp; Various errors are returned depending on the server.&nbsp; If this happens to you, suppress the "Expect" header with this command:<br><br><span class="default">&lt;?php<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, array(</span><span class="string">'Expect:'</span><span class="keyword">));<br></span><span class="default">?&gt;<br></span><br>See <a rel="nofollow" target="_blank">http://www.gnegg.ch/2007/02/the-return-of-except-100-continue/</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="80271">  
  <a class="name">
  <strong class="user"><em>jade dot skaggs at gmail dot com</em></strong></a><div class="date" title="2008-01-07 09:48"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80271">
<div class="phpcode"><code><span class="html">
After much struggling, I managed to get a SOAP request requiring HTTP authentication to work.&nbsp; Here's some source that will hopefully be useful to others. 
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="default">&lt;?php
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $credentials </span><span class="keyword">= </span><span class="string">"username:password"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Read the XML to send to the Web Service
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$request_file </span><span class="keyword">= </span><span class="string">"./SampleRequest.xml"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$fh </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$request_file</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$xml_data </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$request_file</span><span class="keyword">));
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="string">"<a rel="nofollow" target="_blank">http://www.example.com/services/calculation</a>"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$page </span><span class="keyword">= </span><span class="string">"/services/calculation"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$headers </span><span class="keyword">= array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"POST "</span><span class="keyword">.</span><span class="default">$page</span><span class="keyword">.</span><span class="string">" HTTP/1.0"</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Content-type: text/xml;charset=\"utf-8\""</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Accept: text/xml"</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Cache-Control: no-cache"</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Pragma: no-cache"</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"SOAPAction: \"run\""</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Content-length: "</span><span class="keyword">.</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$xml_data</span><span class="keyword">),
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Authorization: Basic " </span><span class="keyword">. </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$credentials</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; );
<br>&nbsp; &nbsp; &nbsp;&nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">,</span><span class="default">$url</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMEOUT</span><span class="keyword">, </span><span class="default">60</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, </span><span class="default">$headers</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_USERAGENT</span><span class="keyword">, </span><span class="default">$defined_vars</span><span class="keyword">[</span><span class="string">'HTTP_USER_AGENT'</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Apply the XML to our curl call
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$xml_data</span><span class="keyword">); 
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); 
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">curl_errno</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print </span><span class="string">"Error: " </span><span class="keyword">. </span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Show me the result
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103232">  
  <a class="name">
  <strong class="user"><em>PHP at RHaworth dot net</em></strong></a><div class="date" title="2011-04-02 02:31"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103232">
<div class="phpcode"><code><span class="html">
When CURLOPT_FOLLOWLOCATION and CURLOPT_HEADER are both true and redirect/s have happened then the header returned by curl_exec() will contain all the headers in the redirect chain in the order they were encountered.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96903">  
  <a class="name">
  <strong class="user"><em>anderseta at gmail dot com</em></strong></a><div class="date" title="2010-03-22 02:48"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96903">
<div class="phpcode"><code><span class="html">
If you wish to find the size of the file you are streaming and use it as your header this is how:
<br>
<br><span class="default">&lt;?php
<br>
<br></span><span class="keyword">function </span><span class="default">write_function</span><span class="keyword">(</span><span class="default">$curl_resource</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; if(</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$curl_resource</span><span class="keyword">, </span><span class="default">CURLINFO_SIZE_DOWNLOAD</span><span class="keyword">) &lt;= </span><span class="default">2000</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Expires: 0'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Cache-Control: must-revalidate, post-check=0, pre-check=0'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Pragma: public'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Description: File Transfer'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-Transfer-Encoding: binary"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-Type: "</span><span class="keyword">.</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$curl_resource</span><span class="keyword">, </span><span class="default">CURLINFO_CONTENT_TYPE</span><span class="keyword">).</span><span class="string">""</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-Length: "</span><span class="keyword">.</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$curl_resource</span><span class="keyword">, </span><span class="default">CURLINFO_CONTENT_LENGTH_DOWNLOAD</span><span class="keyword">).</span><span class="string">""</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; print </span><span class="default">$string</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; return </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="string">'8bit'</span><span class="keyword">);
<br>}
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>1440 is the the default number of bytes curl will call the write function (BUFFERSIZE does not affect this, i actually think you can not change this value), so it means the headers are going to be set only one time.
<br>
<br>write_function must return the exact number of bytes of the string, so you can return a value with mb_strlen.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="30906">  
  <a class="name">
  <strong class="user"><em>dweingart at pobox dot com</em></strong></a><div class="date" title="2003-04-02 03:08"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom30906">
<div class="phpcode"><code><span class="html">
If you want to Curl to follow redirects and you would also like Curl to echo back any cookies that are set in the process, use this:
<br>
<br><span class="default">&lt;?php curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">, </span><span class="string">'-'</span><span class="keyword">); </span><span class="default">?&gt;
<br></span>
<br>'-' means stdout
<br>
<br>-dw</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113682">  
  <a class="name">
  <strong class="user"><em>badman</em></strong></a><div class="date" title="2013-11-15 10:36"><strong>9 months ago</strong></div>
  <div class="text" id="Hcom113682">
<div class="phpcode"><code><span class="html">
Many hosters use PHP safe_mode or/and open_basedir, so you can't use CURLOPT_FOLLOWLOCATION. If you try, you see message like this:<br>CURLOPT_FOLLOWLOCATION cannot be activated when safe_mode is enabled or an open_basedir is set in [you script name &amp; path] on line XXX<br><br>First, I try to use zsalab function (<a rel="nofollow" target="_blank">http://us2.php.net/manual/en/function.curl-setopt.php#102121</a>) from this page, but for some reason it did not work properly. So, I wrote my own.<br><br>It can be use instead of curl_exec. If server HTTP response codes is 30x, function will forward the request as long as the response is not different from 30x (for example, 200 Ok). Also you can use POST.<br><br>function curlExec(/* Array */$curlOptions='', /* Array */$curlHeaders='', /* Array */$postFields='')<br>{<br>&nbsp; $newUrl = '';<br>&nbsp; $maxRedirection = 10;<br>&nbsp; do<br>&nbsp; {<br>&nbsp; &nbsp; if ($maxRedirection&lt;1) die('Error: reached the limit of redirections');<br><br>&nbsp; &nbsp; $ch = curl_init();<br>&nbsp; &nbsp; if (!empty($curlOptions)) curl_setopt_array($ch, $curlOptions);<br>&nbsp; &nbsp; if (!empty($curlHeaders)) curl_setopt($ch, CURLOPT_HTTPHEADER, $curlHeaders);<br>&nbsp; &nbsp; if (!empty($postFields))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; curl_setopt($ch, CURLOPT_POST, 1);<br>&nbsp; &nbsp; &nbsp; curl_setopt($ch, CURLOPT_POSTFIELDS, $postFields);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; if (!empty($newUrl)) curl_setopt($ch, CURLOPT_URL, $newUrl); // redirect needed<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; $curlResult = curl_exec($ch);<br>&nbsp; &nbsp; $code = curl_getinfo($ch, CURLINFO_HTTP_CODE);<br><br>&nbsp; &nbsp; if ($code == 301 || $code == 302 || $code == 303 || $code == 307)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; preg_match('/Location:(.*?)\n/', $curlResult, $matches);<br>&nbsp; &nbsp; &nbsp; $newUrl = trim(array_pop($matches));<br>&nbsp; &nbsp; &nbsp; curl_close($ch);<br><br>&nbsp; &nbsp; &nbsp; $maxRedirection--;<br>&nbsp; &nbsp; &nbsp; continue;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; else // no more redirection<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; $code = 0;<br>&nbsp; &nbsp; &nbsp; curl_close($ch);<br>&nbsp; &nbsp; }<br>&nbsp; }<br>&nbsp; while($code);<br>&nbsp; return $curlResult;<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107146">  
  <a class="name">
  <strong class="user"><em>Adam Monsen</em></strong></a><div class="date" title="2012-01-10 04:36"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107146">
<div class="phpcode"><code><span class="html">
CURLOPT_POST must be left unset if you want the Content-Type header set to "multipart/form-data" (e.g., when CURLOPT_POSTFIELDS is an array). If you set CURLOPT_POSTFIELDS to an array and have CURLOPT_POST set to TRUE, Content-Length will be -1 and most sane servers will reject the request. If you set CURLOPT_POSTFIELDS to an array and have CURLOPT_POST set to FALSE, cURL will send a GET request.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95027">  
  <a class="name">
  <strong class="user"><em>Pawel Antczak</em></strong></a><div class="date" title="2009-12-09 12:07"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95027">
<div class="phpcode"><code><span class="html">
Hello. <br>During problems with "CURLOPT_FOLLOWLOCATION cannot be activated when in safe_mode or an open_basedir is set" <br>I was looking for solution. <br>I've found few methods on this page, but none of them was good enough, so I made one.<br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">curl_redirect_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, &amp;</span><span class="default">$redirects</span><span class="keyword">, </span><span class="default">$curlopt_header </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$http_code </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLINFO_HTTP_CODE</span><span class="keyword">);<br>&nbsp; &nbsp; if (</span><span class="default">$http_code </span><span class="keyword">== </span><span class="default">301 </span><span class="keyword">|| </span><span class="default">$http_code </span><span class="keyword">== </span><span class="default">302</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; list(</span><span class="default">$header</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\r\n\r\n"</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$matches </span><span class="keyword">= array();<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/(Location:|URI:)(.*?)\n/'</span><span class="keyword">, </span><span class="default">$header</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url_parsed </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (isset(</span><span class="default">$url_parsed</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$redirects</span><span class="keyword">++;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">curl_redirect_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">$redirects</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; if (</span><span class="default">$curlopt_header</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$data</span><span class="keyword">;<br>&nbsp; &nbsp; else {<br>&nbsp; &nbsp; &nbsp; &nbsp; list(,</span><span class="default">$body</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\r\n\r\n"</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$body</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;<br></span><br>Main issue in existing functions was lack of information, how many redirects was done. <br>This one will count it. <br>First parameter as usual. <br>Second should be already initialized integer, it will be incremented by number of done redirects. <br>You can set CURLOPT_HEADER if You need it.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="93108">  
  <a class="name">
  <strong class="user"><em>rob</em></strong></a><div class="date" title="2009-08-23 09:07"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom93108">
<div class="phpcode"><code><span class="html">
Whats not mentioned in the documentation is that you have to set CURLOPT_COOKIEJAR to a file for the CURL handle to actually use cookies, if it is not set then cookies will not be parsed.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91297">  
  <a class="name">
  <strong class="user"><em>ericbianchetti at gmail dot com</em></strong></a><div class="date" title="2009-06-04 03:06"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91297">
<div class="phpcode"><code><span class="html">
if you need to send a SOAP string that is the CURL you must use :
<br>
<br><span class="default">&lt;?php
<br>$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">XML_POST_URL</span><span class="keyword">); 
<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, array(</span><span class="string">'SOAPAction: ""'</span><span class="keyword">));&nbsp; &nbsp; 
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); 
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYPEER</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">XML_PAYLOAD</span><span class="keyword">); 
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br>
<br></span><span class="default">$output </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); 
<br></span><span class="default">?&gt;
<br></span>
<br>Note : Having based my snipet on Chemo demonstration (oscommerce user know who he is), XML_POST_URL and XML_PAYLOAD where defined as constant with define().
<br>
<br>The point is : at the opposite of .xml , SOAP must send the header 'SOAPAction: ""' that can be a valid URI, an empty string (that is here) or nothing ('SOAPAction: '). The later case baing not accepted by all server, the second one indicating the target is the URI used to post the SOAP.
<br><a rel="nofollow" target="_blank">http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383528</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="81581">  
  <a class="name">
  <strong class="user"><em>c00lways at gmail dot com</em></strong></a><div class="date" title="2008-03-04 01:16"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom81581">
<div class="phpcode"><code><span class="html">
if you would like to send xml request to a server (lets say, making a soap proxy),
<br>you have to set
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, Array(</span><span class="string">"Content-Type: text/xml"</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>makesure you watch for cache issue:
<br>the below code will prevent cache...
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FORBID_REUSE</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FRESH_CONNECT</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>hope it helps ;)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84916">  
  <a class="name">
  <strong class="user"><em>fred at themancan dot com</em></strong></a><div class="date" title="2008-08-05 04:28"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84916">
<div class="phpcode"><code><span class="html">
To find what encoding a given HTTP POST request uses is easy -- passing an array to CURLOPT_POSTFIELDS results in&nbsp; multipart/form-data:
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, array(</span><span class="string">'field1' </span><span class="keyword">=&gt; </span><span class="string">'value'</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>Passing a URL-encoded string will result in application/x-www-form-urlencoded:
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, array(</span><span class="string">'field1=value&amp;field2=value2'</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>I ran across this when integrating with both a warehouse system and an email system; neither would accept multipart/form-data, but both happily accepted application/x-www-form-urlencoded.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77224">  
  <a class="name">
  <strong class="user"><em>andrabr at gmail dot com</em></strong></a><div class="date" title="2007-08-20 02:03"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom77224">
<div class="phpcode"><code><span class="html">
This is very clear in hindsight, but it still cost me several hours:
<br>
<br><span class="default">&lt;?php curl_setopt</span><span class="keyword">(</span><span class="default">$session</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPPROXYTUNNEL</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="default">?&gt;
<br></span>
<br>means that you will tunnel THROUGH the proxy, as in "your communications will go as if the proxy is NOT THERE".
<br>
<br>Why do you care? - Well, if you are trying to use, say, Paros, to debug HTTP between your cURL and the server, with CURLOPT_HTTPPROXYTUNNEL set to TRUE Paros will not see or log your traffic thus defeating the purpose and driving you nuts.
<br>
<br>There are other cases, of course, where this option is extremely useful...</span>
</code></div>
  </div>
 </div>
  <div class="note" id="71313">  
  <a class="name">
  <strong class="user"><em>eion at bigfoot dot com</em></strong></a><div class="date" title="2006-11-21 08:40"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom71313">
<div class="phpcode"><code><span class="html">
If you are trying to use CURLOPT_FOLLOWLOCATION and you get this warning:<br>Warning: curl_setopt() [function.curl-setopt]: CURLOPT_FOLLOWLOCATION cannot be activated when in safe_mode or an open_basedir is set...<br><br>then you will want to read <a rel="nofollow" target="_blank">http://www.php.net/ChangeLog-4.php</a> which says "Disabled CURLOPT_FOLLOWLOCATION in curl when open_basedir or safe_mode are enabled." as of PHP 4.4.4/5.1.5.&nbsp; This is due to the fact that curl is not part of PHP and doesn't know the values of open_basedir or safe_mode, so you could comprimise your webserver operating in safe_mode by redirecting (using header('Location: ...')) to "file://" urls, which curl would have gladly retrieved.<br><br>Until the curl extension is changed in PHP or curl (if it ever will) to deal with "Location:" headers, here is a far from perfect remake of the curl_exec function that I am using.<br><br>Since there's no curl_getopt function equivalent, you'll have to tweak the function to make it work for your specific use.&nbsp; As it is here, it returns the body of the response and not the header.&nbsp; It also doesn't deal with redirection urls with username and passwords in them.<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">curl_redir_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; static </span><span class="default">$curl_loops </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; static </span><span class="default">$curl_max_loops </span><span class="keyword">= </span><span class="default">20</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$curl_loops</span><span class="keyword">++ &gt;= </span><span class="default">$curl_max_loops</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$curl_loops </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; list(</span><span class="default">$header</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n\n"</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$http_code </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLINFO_HTTP_CODE</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$http_code </span><span class="keyword">== </span><span class="default">301 </span><span class="keyword">|| </span><span class="default">$http_code </span><span class="keyword">== </span><span class="default">302</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$matches </span><span class="keyword">= array();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/Location:(.*?)\n/'</span><span class="keyword">, </span><span class="default">$header</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url </span><span class="keyword">= @</span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">)));<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">$url</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//couldn't process the url to redirect to<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$curl_loops </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$data</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$last_url </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLINFO_EFFECTIVE_URL</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">])<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">] = </span><span class="default">$last_url</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">])<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] = </span><span class="default">$last_url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">])<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] = </span><span class="default">$last_url</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_url </span><span class="keyword">= </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">] . </span><span class="string">'://' </span><span class="keyword">. </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] . </span><span class="default">$url</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] . (</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]?</span><span class="string">'?'</span><span class="keyword">.</span><span class="default">$url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]:</span><span class="string">''</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$new_url</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">debug</span><span class="keyword">(</span><span class="string">'Redirecting to'</span><span class="keyword">, </span><span class="default">$new_url</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">curl_redir_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$curl_loops</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$data</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112113">  
  <a class="name">
  <strong class="user"><em>Madcat</em></strong></a><div class="date" title="2013-05-06 03:14"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112113">
<div class="phpcode"><code><span class="html">
If you have a mixture of strings starting with @ (at character) and files in CURLOPT_POSTFIELDS you have a problem (such as posting a tweet with attached media) because curl tries to interpret anything starting with @ as a file.<br><br><span class="default">&lt;?php<br><br>$postfields </span><span class="keyword">= array(<br>&nbsp; &nbsp; </span><span class="string">'upload_file' </span><span class="keyword">=&gt; </span><span class="string">'@file_to_upload.png'</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'upload_text' </span><span class="keyword">=&gt; </span><span class="string">'@text_to_upload'<br></span><span class="keyword">);<br><br></span><span class="default">$curl </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://example.com/upload-test</a>'</span><span class="keyword">);<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$postfields</span><span class="keyword">);<br></span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>To get around this, prepend the text string with the NULL character like so:<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; $postfields </span><span class="keyword">= array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'upload_file' </span><span class="keyword">=&gt; </span><span class="string">'@file_to_upload.png'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'upload_text' </span><span class="keyword">=&gt; </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"\0%s"</span><span class="keyword">, </span><span class="string">'@text_to_upload'</span><span class="keyword">)<br>&nbsp; &nbsp; );<br></span><span class="default">?&gt;<br></span><br>Original source: <a rel="nofollow" target="_blank">http://bit.ly/AntMle</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="60142">  
  <a class="name">
  <strong class="user"><em>Dustin Hawkins</em></strong></a><div class="date" title="2005-12-27 02:24"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom60142">
<div class="phpcode"><code><span class="html">
To further expand upon use of CURLOPT_CAPATH and CURLOPT_CAINFO...<br><br>In my case I wanted to prevent curl from talking to any HTTPS server except my own using a self signed certificate. To do this, you'll need openssl installed and access to the HTTPS Server Certificate (server.crt by default on apache)<br><br>You can then use a command simiar to this to translate your apache certificate into one that curl likes.<br><br>$ openssl x509 -in server.crt -out outcert.pem -text<br><br>Then set CURLOPT_CAINFO equal to the the full path to outcert.pem and turn on CURLOPT_SSL_VERIFYPEER.<br><br>If you want to use the CURLOPT_CAPATH option, you should create a directory for all the valid certificates you have created, then use the c_rehash script that is included with openssl to "prepare" the directory.<br><br>If you dont use the c_rehash utility, curl will ignore any file in the directory you set.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102121">  
  <a class="name">
  <strong class="user"><em>zsalab</em></strong></a><div class="date" title="2011-01-27 05:12"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102121">
<div class="phpcode"><code><span class="html">
Handling redirections with curl if safe_mode or open_basedir is enabled. The function working transparent, no problem with header and returntransfer options. You can handle the max redirection with the optional second argument (the function is set the variable to zero if max redirection exceeded).
<br>Second parameter values:
<br>- maxredirect is null or not set: redirect maximum five time, after raise PHP warning
<br>- maxredirect is greather then zero: no raiser error, but parameter variable set to zero
<br>- maxredirect is less or equal zero: no follow redirections
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">curl_exec_follow</span><span class="keyword">(</span><span class="comment">/*resource*/ </span><span class="default">$ch</span><span class="keyword">, </span><span class="comment">/*int*/ </span><span class="keyword">&amp;</span><span class="default">$maxredirect </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$mr </span><span class="keyword">= </span><span class="default">$maxredirect </span><span class="keyword">=== </span><span class="default">null </span><span class="keyword">? </span><span class="default">5 </span><span class="keyword">: </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$maxredirect</span><span class="keyword">);
<br>&nbsp; &nbsp; if (</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'open_basedir'</span><span class="keyword">) == </span><span class="string">'' </span><span class="keyword">&amp;&amp; </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'safe_mode' </span><span class="keyword">== </span><span class="string">'Off'</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">$mr </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_MAXREDIRS</span><span class="keyword">, </span><span class="default">$mr</span><span class="keyword">);
<br>&nbsp; &nbsp; } else {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$mr </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newurl </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLINFO_EFFECTIVE_URL</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$rch </span><span class="keyword">= </span><span class="default">curl_copy_handle</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$rch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$rch</span><span class="keyword">, </span><span class="default">CURLOPT_NOBODY</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$rch</span><span class="keyword">, </span><span class="default">CURLOPT_FORBID_REUSE</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$rch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$rch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$newurl</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$rch</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">curl_errno</span><span class="keyword">(</span><span class="default">$rch</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$code </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$code </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$rch</span><span class="keyword">, </span><span class="default">CURLINFO_HTTP_CODE</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$code </span><span class="keyword">== </span><span class="default">301 </span><span class="keyword">|| </span><span class="default">$code </span><span class="keyword">== </span><span class="default">302</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/Location:(.*?)\n/'</span><span class="keyword">, </span><span class="default">$header</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newurl </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">));
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$code </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } while (</span><span class="default">$code </span><span class="keyword">&amp;&amp; --</span><span class="default">$mr</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$rch</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">$mr</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$maxredirect </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'Too many redirects. When following redirects, libcurl hit the maximum amount.'</span><span class="keyword">, </span><span class="default">E_USER_WARNING</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$maxredirect </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$newurl</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; return </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97206">  
  <a class="name">
  <strong class="user"><em>julien veneziano</em></strong></a><div class="date" title="2010-04-08 03:56"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97206">
<div class="phpcode"><code><span class="html">
If you need to send deta in a DELETE request, use:<br><br><span class="default">&lt;?php<br>$request_body </span><span class="keyword">= </span><span class="string">'some data'</span><span class="keyword">;<br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://www.example.com</a>'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$request_body</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">); <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_CUSTOMREQUEST</span><span class="keyword">, </span><span class="string">"DELETE"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$response </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$response</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107621">  
  <a class="name">
  <strong class="user"><em>dotpointer at gmail dot com</em></strong></a><div class="date" title="2012-02-22 01:13"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107621">
<div class="phpcode"><code><span class="html">
I noted something when using CURLOPT_POSTFIELDS in combination with arrays from PHP.
<br>
<br>You may supply an array, but there may not be any sub-arrays in this array, as this will give Array-to-string-conversion notice.
<br>
<br>Example:
<br>
<br><span class="default">&lt;?php
<br>$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>
<br></span><span class="comment"># this works
<br></span><span class="default">$data </span><span class="keyword">= array(</span><span class="string">'name' </span><span class="keyword">=&gt; </span><span class="string">'value'</span><span class="keyword">);
<br>
<br></span><span class="comment"># this gives "Notice: Array to string conversion..."
<br></span><span class="default">$data </span><span class="keyword">= array(</span><span class="string">'name' </span><span class="keyword">=&gt; array(</span><span class="string">'subname' </span><span class="keyword">=&gt; </span><span class="string">'subvalue'</span><span class="keyword">));
<br>
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://localhost/test.php</a>'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);
<br>
<br></span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90988">  
  <a class="name">
  <strong class="user"><em>franciscocha at gmail dot com</em></strong></a><div class="date" title="2009-05-19 03:11"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90988">
<div class="phpcode"><code><span class="html">
Example how to connect to FTPES (FTP explicit SSL). This script will connect to any FTPES server and out put the list of directories.
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; $username </span><span class="keyword">= </span><span class="string">'username'</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$password </span><span class="keyword">= </span><span class="string">'password'</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="string">'example.com'</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$ftp_server </span><span class="keyword">= </span><span class="string">"<a rel="nofollow" target="_blank">ftp://</a>" </span><span class="keyword">. </span><span class="default">$username </span><span class="keyword">. </span><span class="string">":" </span><span class="keyword">. </span><span class="default">$password </span><span class="keyword">. </span><span class="string">"@" </span><span class="keyword">. </span><span class="default">$url</span><span class="keyword">;
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; echo </span><span class="string">"Starting CURL.\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>&nbsp; &nbsp; echo </span><span class="string">"Set CURL URL.\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="comment">//curl FTP
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$ftp_server</span><span class="keyword">);
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="comment">//For Debugging
<br>&nbsp; &nbsp; //curl_setopt($ch, CURLOPT_VERBOSE, TRUE);&nbsp; &nbsp; 
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; //SSL Settings
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYPEER</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYHOST</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FTP_SSL</span><span class="keyword">, </span><span class="default">CURLFTPSSL_TRY</span><span class="keyword">);
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="comment">//List FTP files and directories
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FTPLISTONLY</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="comment">//Output to curl_exec
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; echo </span><span class="string">"Executing CURL.\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; echo </span><span class="string">"Closing CURL.\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; echo </span><span class="default">$output </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;
<br>
<br>&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$output</span><span class="keyword">);
<br>&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110417">  
  <a class="name">
  <strong class="user"><em>miloshio at gmail dot com</em></strong></a><div class="date" title="2012-10-20 12:06"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom110417">
<div class="phpcode"><code><span class="html">
Remember: <br><br>- 'Server-side' cookies exists as information even before they were set on browser agent(HTTP COOKIE HEADER),<br>- javascript cookies does NOT exists as information before they were set on browser agent,<br><br>so, if you're trying to save cookies using CURLOPT_COOKIEJAR to a local file, that cookie must be server - side cookie, otherwise you are wasting time, javascript-produced cookies only exists when client browser's JS interpreter set them.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107314">  
  <a class="name">
  <strong class="user"><em>Tim Severien</em></strong></a><div class="date" title="2012-01-30 11:51"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107314">
<div class="phpcode"><code><span class="html">
I've been stuck when using the CURLOPT_CONNECTTIMEOUT_MS constant. In fact, on my PHP version (5.3.1) it's not a number but rather a string. Same thing for CURLOPT_TIMEOUT_MS.<br><br>I got this error: Warning: curl_setopt() expects parameter 2 to be long, string given<br><br>If you are experiencing simular problems, you can replace the constant with the actual number or (re)define the constant.<br><br>CURLOPT_TIMEOUT_MS should be 155<br>CURLOPT_CONNECTTIMEOUT_MS should be 156<br><br>curl_setopt($ch, CURLOPT_CONNECTTIMEOUT_MS, 2500); // error<br>curl_setopt($ch, 156, 2500); // problem solved</span>
</code></div>
  </div>
 </div>
  <div class="note" id="64447">  
  <a class="name">
  <strong class="user"><em>mr at coder dot tv</em></strong></a><div class="date" title="2006-04-14 07:22"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom64447">
<div class="phpcode"><code><span class="html">
Sometimes you can't use CURLOPT_COOKIEJAR and CURLOPT_COOKIEFILE becoz of the server php-settings(They say u may grab any files from server using these options). Here is the solution<br>1)Don't use CURLOPT_FOLLOWLOCATION<br>2)Use curl_setopt($ch, CURLOPT_HEADER, 1)<br>3)Grab from the header cookies like this:<br>preg_match_all('|Set-Cookie: (.*);|U', $content, $results);&nbsp; &nbsp; <br>$cookies = implode(';', $results[1]);<br>4)Set them using curl_setopt($ch, CURLOPT_COOKIE,&nbsp; $cookies);<br><br>Good Luck, Yevgen</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110473">  
  <a class="name">
  <strong class="user"><em>m at mar dot lt</em></strong></a><div class="date" title="2012-10-25 03:06"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom110473">
<div class="phpcode"><code><span class="html">
Be careful when changing CURLOPT_SSL_VERIFYHOST or other options to true (boolean). It may cause insecure behavior [1]
<br>
<br>This is because boolean true casts into integer 1, and CURLOPT_SSL_VERIFYHOST = 1 is not secure behavior.
<br>
<br>The *correct* value here is CURLOPT_SSL_VERIFYHOST = 2. By setting this value equal to 1 the peer certificate must contain a Common Name field, but it doesn't matter what name it says.
<br>
<br>[1] Martin Georgiev and Subodh Iyengar and Suman Jana and Rishita Anubhai and Dan Boneh and Vitaly Shmatikov, The most dangerous code in the world: validating SSL certificates in non-browser software, ACM CCS '12, pp. 38-49, 2012</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85956">  
  <a class="name">
  <strong class="user"><em>OPALA</em></strong></a><div class="date" title="2008-09-26 12:37"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom85956">
<div class="phpcode"><code><span class="html">
To fetch (or submit data to) multiple pages during one session,use this:
<br>
<br><span class="default">&lt;?php
<br>$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYPEER</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIESESSION</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEFILE</span><span class="keyword">, </span><span class="string">"cookiefile"</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">, </span><span class="string">"cookiefile"</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIE</span><span class="keyword">, </span><span class="default">session_name</span><span class="keyword">() . </span><span class="string">'=' </span><span class="keyword">. </span><span class="default">session_id</span><span class="keyword">());
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://example.com/page1.php</a>'</span><span class="keyword">);
<br></span><span class="default">$result1 </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://example.com/page2.php</a>'</span><span class="keyword">);
<br></span><span class="default">$result2 </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82300">  
  <a class="name">
  <strong class="user"><em>john factorial</em></strong></a><div class="date" title="2008-04-04 08:22"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82300">
<div class="phpcode"><code><span class="html">
Clarification for the CURLOPT_NOBODY option: by excluding the body from your request, you're effectively making a HEAD request. Use the CURLOPT_NOBODY option to return only the headers in the remote response.
<br>
<br>Example:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">check_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// get the header
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="default">CURLOPT_NOBODY</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// and *only* get the header
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// get the response as a string from curl_exec(), rather than echoing it
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="default">CURLOPT_FRESH_CONNECT</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// don't use a cached version of the url
<br>&nbsp; &nbsp; </span><span class="keyword">if (!</span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">)) { return </span><span class="default">false</span><span class="keyword">; }
<br>
<br>&nbsp; &nbsp; </span><span class="default">$httpcode </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="default">CURLINFO_HTTP_CODE</span><span class="keyword">);
<br>&nbsp; &nbsp; return (</span><span class="default">$httpcode </span><span class="keyword">&lt; </span><span class="default">400</span><span class="keyword">);
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78046">  
  <a class="name">
  <strong class="user"><em>Ojas Ojasvi</em></strong></a><div class="date" title="2007-09-25 10:52"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78046">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php
<br></span><span class="comment">/*
<br>* Author: Ojas Ojasvi
<br>* Released: September 25, 2007
<br>* Description: An example of the disguise_curl() function in order to grab contents from a website while remaining fully camouflaged by using a fake user agent and fake headers.
<br>*/
<br>
<br></span><span class="default">$url </span><span class="keyword">= </span><span class="string">'<a rel="nofollow" target="_blank">http://www.php.net</a>'</span><span class="keyword">;
<br>
<br></span><span class="comment">// disguises the curl using fake headers and a fake user agent.
<br></span><span class="keyword">function </span><span class="default">disguise_curl</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">)
<br>{
<br>&nbsp; </span><span class="default">$curl </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>
<br>&nbsp; </span><span class="comment">// Setup headers - I used the same headers from Firefox version 2.0.0.6
<br>&nbsp; // below was split up because php.net said the line was too long. :/
<br>&nbsp; </span><span class="default">$header</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"Accept: text/xml,application/xml,application/xhtml+xml,"</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$header</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] .= </span><span class="string">"text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$header</span><span class="keyword">[] = </span><span class="string">"Cache-Control: max-age=0"</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$header</span><span class="keyword">[] = </span><span class="string">"Connection: keep-alive"</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$header</span><span class="keyword">[] = </span><span class="string">"Keep-Alive: 300"</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$header</span><span class="keyword">[] = </span><span class="string">"Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7"</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$header</span><span class="keyword">[] = </span><span class="string">"Accept-Language: en-us,en;q=0.5"</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$header</span><span class="keyword">[] = </span><span class="string">"Pragma: "</span><span class="keyword">; </span><span class="comment">// browsers keep this blank.
<br>
<br>&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);
<br>&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_USERAGENT</span><span class="keyword">, </span><span class="string">'Googlebot/2.1 (+<a rel="nofollow" target="_blank">http://www.google.com/bot.html</a>)'</span><span class="keyword">);
<br>&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, </span><span class="default">$header</span><span class="keyword">);
<br>&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_REFERER</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://www.google.com</a>'</span><span class="keyword">);
<br>&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_ENCODING</span><span class="keyword">, </span><span class="string">'gzip,deflate'</span><span class="keyword">);
<br>&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_AUTOREFERER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_TIMEOUT</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">);
<br>
<br>&nbsp; </span><span class="default">$html </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">); </span><span class="comment">// execute the curl command
<br>&nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">); </span><span class="comment">// close the connection
<br>
<br>&nbsp; </span><span class="keyword">return </span><span class="default">$html</span><span class="keyword">; </span><span class="comment">// and finally, return $html
<br></span><span class="keyword">}
<br>
<br></span><span class="comment">// uses the function and displays the text off the website
<br></span><span class="default">$text </span><span class="keyword">= </span><span class="default">disguise_curl</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);
<br>echo </span><span class="default">$text</span><span class="keyword">;
<br></span><span class="default">?&gt;
<br></span>
<br>Ojas Ojasvi</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74709">  
  <a class="name">
  <strong class="user"><em>rob at infoglobe dot net</em></strong></a><div class="date" title="2007-04-24 09:01"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74709">
<div class="phpcode"><code><span class="html">
Options not included in the above, but that work (Taken from the libcurl.a C documentation)<br><br>CURLOPT_FTP_SSL <br><br>Pass a long using one of the values from below, to make libcurl use your desired level of SSL for the ftp transfer. (Added in 7.11.0) <br><br>CURLFTPSSL_NONE <br><br>Don't attempt to use SSL. <br><br>CURLFTPSSL_TRY <br><br>Try using SSL, proceed as normal otherwise. <br><br>CURLFTPSSL_CONTROL <br><br>Require SSL for the control connection or fail with CURLE_FTP_SSL_FAILED. <br><br>CURLFTPSSL_ALL <br><br>Require SSL for all communication or fail with CURLE_FTP_SSL_FAILED.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="62274">  
  <a class="name">
  <strong class="user"><em>heyrocker at yahoo dot com</em></strong></a><div class="date" title="2006-02-23 01:57"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom62274">
<div class="phpcode"><code><span class="html">
The examples below for HTTP file upload work great, but I wanted to be able to post multiple files through HTTP upload using HTML arrays as specified in example 38.3 at
<br>
<br><a rel="nofollow" target="_blank">http://php.net/features.file-upload</a>
<br>
<br>In this case, you need to set the arrays AND keys in the $post_data, it will not work with just the array names. The following example shows how this works:
<br>
<br><span class="default">&lt;?php
<br>
<br>&nbsp; &nbsp; $post_data </span><span class="keyword">= array();
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$post_data</span><span class="keyword">[</span><span class="string">'pictures[0]'</span><span class="keyword">] = </span><span class="string">"@cat.jpg"</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$post_data</span><span class="keyword">[</span><span class="string">'pictures[1]'</span><span class="keyword">] = </span><span class="string">"@dog.jpg"</span><span class="keyword">;
<br>&nbsp; &nbsp; 
<br>
<br>&nbsp; &nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">"<a rel="nofollow" target="_blank">http://example.com/my_url.php</a>" </span><span class="keyword">); 
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$post_data</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$postResult </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; if (</span><span class="default">curl_errno</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; print </span><span class="string">"</span><span class="default">$postResult</span><span class="string">"</span><span class="keyword">;
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="58074">  
  <a class="name">
  <strong class="user"><em>phpnet at wafflehouse dot de</em></strong></a><div class="date" title="2005-10-23 06:34"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom58074">
<div class="phpcode"><code><span class="html">
Resetting CURLOPT_FILE to STDOUT won't work by calling curl_setopt() with the STDOUT constant or a php://output stream handle (at least I get error messages when trying the code from phpnet at andywaite dot com). Instead, one can simply reset it as a side effect of CURLOPT_RETURNTRANSFER. Just say
<br>
<br><span class="default">&lt;?php curl_setopt</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">curl</span><span class="keyword">,</span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">); </span><span class="default">?&gt;
<br></span>
<br>and following calls to curl_exec() will output to STDOUT again.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109634">  
  <a class="name">
  <strong class="user"><em>qeremy [atta] gmail [dotta] com</em></strong></a><div class="date" title="2012-08-03 08:57"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom109634">
<div class="phpcode"><code><span class="html">
If you are trying to update something on your server and you need to handle this update operation by PUT;<br><br><span class="default">&lt;?php<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_CUSTOMREQUEST</span><span class="keyword">, </span><span class="string">"PUT"</span><span class="keyword">);<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_PUT</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>are "useless" without;<br><br><span class="default">&lt;?php<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, array(</span><span class="string">'X-HTTP-Method-Override: PUT'</span><span class="keyword">));<br></span><span class="default">?&gt;<br></span><br>Example;<br><br>Updating a book data in database identified by "id 1";<br><br>--cURL Part--<br><span class="default">&lt;?php<br>$data </span><span class="keyword">= </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">);<br></span><span class="comment">// or<br></span><span class="default">$data </span><span class="keyword">= </span><span class="default">http_build_query</span><span class="keyword">(array(<br>&nbsp;&nbsp; </span><span class="string">'name'&nbsp; </span><span class="keyword">=&gt; </span><span class="string">'PHP in Action'</span><span class="keyword">,<br>&nbsp;&nbsp; </span><span class="string">'price' </span><span class="keyword">=&gt; </span><span class="default">10.9<br></span><span class="keyword">));<br><br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">"<a rel="nofollow" target="_blank">http://api.localhost/rest/books/1</a>"</span><span class="keyword">);<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br></span><span class="comment">// curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "PUT"); // no need anymore<br>// or<br>// curl_setopt($ch, CURLOPT_PUT, 1); // no need anymore<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, array(</span><span class="string">'X-HTTP-Method-Override: PUT'</span><span class="keyword">));<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br></span><span class="default">$ce </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$ce</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>--API class--<br><span class="default">&lt;?php<br></span><span class="keyword">public function </span><span class="default">putAction</span><span class="keyword">() {<br>&nbsp; &nbsp; echo </span><span class="string">"putAction() -&gt; id: "</span><span class="keyword">. </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getParam</span><span class="keyword">(</span><span class="string">'id'</span><span class="keyword">) .</span><span class="string">"\n"</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="comment">// do stuff with post data<br>&nbsp; &nbsp; </span><span class="keyword">...<br></span><span class="default">?&gt;<br></span><br>--Output--<br>putAction() -&gt; id: 15<br>Array<br>(<br>&nbsp; &nbsp; [name] =&gt; PHP in Action<br>&nbsp; &nbsp; [price] =&gt; 10.9<br>)<br><br>---Keywords--<br>rest, restfull api, restfull put, curl put, curl customrequest put</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91952">  
  <a class="name">
  <strong class="user"><em>xektrum at gmail dot com</em></strong></a><div class="date" title="2009-07-02 09:14"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91952">
<div class="phpcode"><code><span class="html">
As of php 5.3 CURLOPT_PROGRESSFUNCTION its supported here's how:<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">callback</span><span class="keyword">(</span><span class="default">$download_size</span><span class="keyword">, </span><span class="default">$downloaded</span><span class="keyword">, </span><span class="default">$upload_size</span><span class="keyword">, </span><span class="default">$uploaded</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="comment">// do your progress stuff here<br></span><span class="keyword">}<br><br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://www.example.com</a>'</span><span class="keyword">);<br><br></span><span class="comment">// This is required to curl give us some progress<br>// if this is not set to false the progress function never<br>// gets called<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_NOPROGRESS</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br><br></span><span class="comment">// Set up the callback<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_PROGRESSFUNCTION</span><span class="keyword">, </span><span class="string">'callback'</span><span class="keyword">);<br><br></span><span class="comment">// Big buffer less progress info/callbacks<br>// Small buffer more progress info/callbacks<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_BUFFERSIZE</span><span class="keyword">, </span><span class="default">128</span><span class="keyword">);<br><br></span><span class="default">$data </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>Hope this help.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102519">  
  <a class="name">
  <strong class="user"><em>S\</em></strong></a><div class="date" title="2011-02-18 11:04"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102519">
<div class="phpcode"><code><span class="html">
When using CURLOPT_POSTFIELDS with an array as parameter, you have to pay high attention to user input. Unvalidated user input will lead to serious security issues.<br><br><span class="default">&lt;?php<br><br></span><span class="comment">/**<br> * test.php:<br> */<br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://example.com</a>'</span><span class="keyword">);<br><br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, array(<br>&nbsp; &nbsp; </span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'bar'</span><span class="keyword">]<br>));<br><br></span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>Requesting "test.php?bar=@/home/user/test.png" will send "test.png" to example.com. <br>Make sure you remove the leading "@" from user input.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111978">  
  <a class="name">
  <strong class="user"><em>S.F.</em></strong></a><div class="date" title="2013-04-18 06:48"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111978">
<div class="phpcode"><code><span class="html">
I spent a couple of days trying to upload a file using a curl post.
<br>
<br>The problem I ran into was the filename had an '@' in the middle of it.&nbsp; It turned out that at least on my system if I encoded the file path using the quoted_printable_encode() function the upload works.
<br>
<br>I'm posting this in the hopes that it will help someone else, and for my own future reference.
<br>
<br>Code:
<br><span class="default">&lt;?php
<br>
<br>$filepath </span><span class="keyword">= </span><span class="string">'/tmp/test@example.txt'</span><span class="keyword">;
<br></span><span class="default">$postdata</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">] = </span><span class="string">'@' </span><span class="keyword">. </span><span class="default">quoted_printable_encode</span><span class="keyword">(</span><span class="default">$filepath</span><span class="keyword">);
<br>
<br></span><span class="comment">//... supporting code.
<br>
<br></span><span class="default">$result </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br></span><span class="default">?&gt;
<br></span>I'm not exactly sure why this works when escaping the '@' doesn't work but it does for me.
<br>
<br>If anyone can offer insight into why this works or a better way to handle the '@' symbol in a filename when using curl to upload I would love to hear it.
<br>
<br>Thanks</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76219">  
  <a class="name">
  <strong class="user"><em>michael sky</em></strong></a><div class="date" title="2007-07-05 03:09"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76219">
<div class="phpcode"><code><span class="html">
if you are trying to connect to 'https://...' and after that want to work with POST data - that's the way:
<br>
<br><span class="default">&lt;?php
<br>$curl </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYPEER</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_USERAGENT</span><span class="keyword">, </span><span class="string">"Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)"</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEFILE</span><span class="keyword">, </span><span class="string">"cookiefile"</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">, </span><span class="string">"cookiefile"</span><span class="keyword">); </span><span class="comment"># SAME cookiefile
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">"url1"</span><span class="keyword">); </span><span class="comment"># this is where you first time connect - GET method authorization in my case, if you have POST - need to edit code a bit
<br></span><span class="default">$xxx </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);
<br>
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">"url2"</span><span class="keyword">); </span><span class="comment"># this is where you are requesting POST-method form results (working with secure connection using cookies after auth)
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="string">"var1=value&amp;var2=value&amp;var3=value&amp;"</span><span class="keyword">); </span><span class="comment"># form params that'll be used to get form results
<br></span><span class="default">$xxx </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);
<br>
<br></span><span class="default">curl_close </span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);
<br>echo </span><span class="default">$xxx</span><span class="keyword">;
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102260">  
  <a class="name">
  <strong class="user"><em>W at RHaworth dot net</em></strong></a><div class="date" title="2011-02-04 04:22"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102260">
<div class="phpcode"><code><span class="html">
I had problems with the Wikimedia software and sending a POST request where the data was more than 1024 bytes long. I traced this to cURL adding: Expect: 100-continue to the headers.<br><br>I added curl_setopt($ch,CURLOPT_HTTPHEADER,array("Expect:")); and that suppresses the Expect line.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86284">  
  <a class="name">
  <strong class="user"><em>dorphalsig at gmail dot com</em></strong></a><div class="date" title="2008-10-10 02:20"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom86284">
<div class="phpcode"><code><span class="html">
This may not be a surprise for many, but I know I bled my eyes out trying to implement this in php. And when I knew it was this simple, I really felt extremely stupid. So I put this just so google will save somebody some time in the future.
<br>
<br>PHP NTLM AUTH
<br>
<br>Make sure you have the 'curl' extension loaded
<br>now just do...
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">,</span><span class="default">CURLAUTH_NTLM</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">,</span><span class="default">CURLOPT_USERPWD</span><span class="keyword">,</span><span class="string">"</span><span class="default">$username</span><span class="string">:</span><span class="default">$password</span><span class="string">"</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>and just continue to use curl in the ordinary fashion.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84374">  
  <a class="name">
  <strong class="user"><em>ac at an dot y-co dot de</em></strong></a><div class="date" title="2008-07-10 10:08"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84374">
<div class="phpcode"><code><span class="html">
If you want to connect to a server which requires that you identify yourself with a certificate, use following code. Your certificate and servers certificate are signed by an authority whose certificate is in ca.ctr.
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_VERBOSE</span><span class="keyword">, </span><span class="string">'1'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYHOST</span><span class="keyword">, </span><span class="string">'2'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYPEER</span><span class="keyword">, </span><span class="string">'1'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_CAINFO</span><span class="keyword">,&nbsp; </span><span class="default">getcwd</span><span class="keyword">().</span><span class="string">'/cert/ca.crt'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSLCERT</span><span class="keyword">, </span><span class="default">getcwd</span><span class="keyword">().</span><span class="string">'/cert/mycert.pem'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSLCERTPASSWD</span><span class="keyword">, </span><span class="string">'password'</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>If your original certificate is in .pfx format, you have to convert it to .pem using following commands
<br># openssl pkcs12 -in mycert.pfx -out mycert.key
<br># openssl rsa -in mycert.key -out mycert.pem
<br># openssl x509 -in mycert.key &gt;&gt; mycert.pem</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98164">  
  <a class="name">
  <strong class="user"><em>shailesh4all at gmail dot com</em></strong></a><div class="date" title="2010-05-29 03:42"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98164">
<div class="phpcode"><code><span class="html">
Hi,
<br>Anyone who is interested in submitting their information by post to HTTPS site (e.g. payment gateway) where https page needs basic authentication before submitting the information. below code will be helpful. 
<br>
<br><span class="default">&lt;?php
<br>$submit_url </span><span class="keyword">= </span><span class="string">"https://sitename/process.php"</span><span class="keyword">;
<br>
<br></span><span class="default">$curl </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPAUTH</span><span class="keyword">, </span><span class="default">CURLAUTH_BASIC </span><span class="keyword">) ;
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_USERPWD</span><span class="keyword">, </span><span class="string">"username:password"</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_SSLVERSION</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYPEER</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYHOST</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$params </span><span class="keyword">); 
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_USERAGENT</span><span class="keyword">, </span><span class="string">"Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)"</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$submit_url</span><span class="keyword">);
<br>
<br></span><span class="default">$data </span><span class="keyword">= </span><span class="default">split</span><span class="keyword">(</span><span class="string">"text/html"</span><span class="keyword">, </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">) );
<br></span><span class="default">$temp </span><span class="keyword">= </span><span class="default">split</span><span class="keyword">(</span><span class="string">"\r\n"</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) ;
<br>
<br></span><span class="default">$result </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">( </span><span class="default">$temp</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] ) ;
<br>
<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);
<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$curl</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77502">  
  <a class="name">
  <strong class="user"><em>charles at tastik dot net</em></strong></a><div class="date" title="2007-09-01 02:27"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom77502">
<div class="phpcode"><code><span class="html">
FYI,
<br>
<br>Anyone trying to connect to .NET with CURL to send a simple XML post, pay attention to the following. This will save you hours! There is a previous note that I saw either on this page, or somewhere else on this site that explains the correct way to specify the header option is to create an array, then reference the array from the CURLOPT. 
<br>
<br>ie.&nbsp; Do something like this:
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">// Req. HTTP Header Values 
<br> </span><span class="default">$header</span><span class="keyword">[] = </span><span class="string">"Content-type: text/xml"</span><span class="keyword">;
<br>
<br></span><span class="comment">// Target URL
<br> </span><span class="default">$sendTo </span><span class="keyword">= </span><span class="string">"<a rel="nofollow" target="_blank">http://www.example.com</a>"</span><span class="keyword">;
<br>
<br></span><span class="comment">// Post Data
<br> </span><span class="default">$post </span><span class="keyword">= </span><span class="string">"&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;root&gt;\n....etc, etc,"</span><span class="keyword">;
<br>
<br></span><span class="comment">// Create CURL Connection
<br> </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_USERAGENT</span><span class="keyword">, </span><span class="string">'XtraDoh xAgent'</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$sendTo</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMEOUT</span><span class="keyword">, </span><span class="default">900</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_CONNECTIONTIMEOUT</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FAILONERROR</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYHOST</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYPEER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, </span><span class="default">$header</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br> </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$post</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Notice the HTTPHEADER, $header above. I have not been able to get .NET to properly read the HTTP header as specified (in this case as text/xml) when using the following:
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, array(</span><span class="string">'Content-Type'</span><span class="keyword">=&gt;</span><span class="string">'text/xml'</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>Although this may work when working with other PHP, IIS, or even PHP, Apache, it does not (at least in my experience) work with .NET, IIS.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="15603">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2001-09-22 09:52"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom15603">
<div class="phpcode"><code><span class="html">
To make a POST in multipart/form-data mode
<br>
<br>(to upload a file for example) you can use 
<br>
<br><span class="default">&lt;?php curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">,</span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">,</span><span class="default">$post</span><span class="keyword">); </span><span class="default">?&gt;
<br></span>
<br>where $post is an array :
<br>
<br><span class="default">&lt;?php
<br>$post</span><span class="keyword">[</span><span class="string">'key1'</span><span class="keyword">] = </span><span class="string">'data1'</span><span class="keyword">;
<br></span><span class="comment">//&nbsp; like a text field in a POST
<br></span><span class="default">$post</span><span class="keyword">[</span><span class="string">'file1'</span><span class="keyword">] = </span><span class="string">'@filename1' 
<br></span><span class="comment">// upload filename1
<br></span><span class="default">?&gt;
<br></span>
<br>For more informations see the 
<br>
<br>curl_formparse man page.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112326">  
  <a class="name">
  <strong class="user"><em>shiplu at programmer dot net</em></strong></a><div class="date" title="2013-06-01 06:23"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112326">
<div class="phpcode"><code><span class="html">
CURLOPT_POST should be set before CURLOPT_POSTFIELDS. Otherwise you might encounter 411 Length required error.<br><br>Following code generates "411 Length Required" on nginx/1.1.15<br><span class="default">&lt;?php<br>curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$postfields</span><span class="keyword">); <br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>But this one works.<br><br><span class="default">&lt;?php<br>curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$postfields</span><span class="keyword">); <br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="26239">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2002-10-23 12:04"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom26239">
<div class="phpcode"><code><span class="html">
beware that not all cURLlib constants are supported under php :
<br>e.g. CURLOPT_PROGRESSFUNCTION or CURLOPT_WRITEDATA are not supported.
<br>
<br>CURLOPT_WRITEFUNCTION, although undocumented is supported. It takes the name of a user_defined function.
<br>the function should take two arguments (the curl handle, and the inputdata) and return the length of the written data
<br>e.g.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">myPoorProgressFunc</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">){
<br>global </span><span class="default">$fd</span><span class="keyword">;
<br></span><span class="default">$len </span><span class="keyword">= </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fd</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);
<br>print(</span><span class="string">"#"</span><span class="keyword">);
<br>return </span><span class="default">$len</span><span class="keyword">;
<br>}
<br>
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">,</span><span class="default">CURLOPT_WRITEFUNCTION</span><span class="keyword">,</span><span class="string">"myPoorProgressFunc"</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Also be aware that CURLOPT_WRITEFUNCTION&nbsp; does NOT take the CURLOPT_FILE as a parameter! 
<br>in curl lib it would take CURLOPT_WRITEDATA but this is not supported by php; that's why I use "global $fd;" in my exemple function.
<br>
<br>CURLOPT_HEADERFUNCTION works the same, and is guaranteed to receive complete header lines as input! 
<br>
<br>Hope this helps
<br>
<br>Ivan</span>
</code></div>
  </div>
 </div>
  <div class="note" id="11470">  
  <a class="name">
  <strong class="user"><em>fil at rezox dot com</em></strong></a><div class="date" title="2001-02-21 05:50"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom11470">
<div class="phpcode"><code><span class="html">
If you want to connect to a secure server for posting info/reading info, you need to make cURL with the openSSL options. Then the sequence is nearly identical to the previous example (except http_S_://, and possibly add the useragent):
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">,</span><span class="string">"https://example.com"</span><span class="keyword">);
<br></span><span class="comment">//some sites only accept your request if your browser looks legit, so send a useragent profile... 
<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_USERAGENT</span><span class="keyword">, </span><span class="string">"Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)"</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108333">  
  <a class="name">
  <strong class="user"><em>Joey Hewitt</em></strong></a><div class="date" title="2012-04-17 10:52"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108333">
<div class="phpcode"><code><span class="html">
Note that if you put a certificate chain in a PEM file, the certificates need to be ordered so that each certificate is followed by its issuer (i.e., root last.)<br><br>Source: <a rel="nofollow" target="_blank">http://publib.boulder.ibm.com/tividd/td/ITIM/SC32-1493-00/en_US/HTML/im451_config09.htm</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="108195">  
  <a class="name">
  <strong class="user"><em>ellert at _removeme_ vankoperen dot nl</em></strong></a><div class="date" title="2012-04-06 01:41"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108195">
<div class="phpcode"><code><span class="html">
If you are using curl to do a soap request and consistently get the following error back: <br>The server cannot service the request because the media type is unsupported.<br>You are sending the Content-type of soap 1.2 to a 1.1 server.<br>Soap 1.1 needs Content-Type: text/xml;<br>Soap 1.2 should have Content-Type: application/soap+xml;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108162">  
  <a class="name">
  <strong class="user"><em>anonymous</em></strong></a><div class="date" title="2012-04-03 03:55"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108162">
<div class="phpcode"><code><span class="html">
This may be not obvious, but if you specify the CURLOPT_POSTFIELDS and don't specify the CURLOPT_POST - it will still send POST, not GET (as you might think - since GET is default).<br>So the line:<br><br>curl_setopt($ch, CURLOPT_POSTFIELDS, $data);<br><br>is synonym to:<br><br>curl_setopt($ch, CURLOPT_POST, 1);<br>curl_setopt($ch, CURLOPT_POSTFIELDS, $data);<br><br>Even if you set the options like this (in this order):<br><br>curl_setopt($ch, CURLOPT_POST, 0);<br>curl_setopt($ch, CURLOPT_POSTFIELDS, $data);<br><br>it will send POST, since CURLOPT_POSTFIELDS is latter.<br>So if you want GET - make sure you don't have CURLOPT_POSTFIELDS specified somewhere.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107546">  
  <a class="name">
  <strong class="user"><em>v dot tverdun at gmail dot com</em></strong></a><div class="date" title="2012-02-16 04:00"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107546">
<div class="phpcode"><code><span class="html">
Make sure to set keys for array if passing to CURLOPT_POSTFIELDS.<br><br><span class="default">&lt;?php<br></span><span class="comment">//This can cause errors<br></span><span class="default">$data </span><span class="keyword">= array(</span><span class="string">'bar'</span><span class="keyword">);<br><br></span><span class="comment">//Use this instead<br></span><span class="default">$data </span><span class="keyword">= array(</span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="string">'bar'</span><span class="keyword">);<br><br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102264">  
  <a class="name">
  <strong class="user"><em>anon@mouse dot com</em></strong></a><div class="date" title="2011-02-04 10:11"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102264">
<div class="phpcode"><code><span class="html">
If your POST data seems to be disappearing (POST data empty, request is being handled by the server as a GET), try rearranging the order of CURLOPT_POSTFIELDS setting with CURLOPT_NOBODY. CURLOPT_POSTFIELDS has to come AFTER CURLOPT_NOBODY setting because if it comes after it wipes out the Content-Type header that tells your URL target that the request is a POST not a GET. <br><br>Not sure if this is expected behavior but it certainly isn't documented (except on Stackoverflow.com, which is supremely unhelpful - BTW, guys over on stack overflow... once you've figured out a PHP problem, posting the solution here would save everyone extra search time).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99108">  
  <a class="name">
  <strong class="user"><em>sam at def dot reyssi dot net</em></strong></a><div class="date" title="2010-07-28 03:43"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom99108">
<div class="phpcode"><code><span class="html">
Be careful when setting the CURLOPT_POSTFIELDS setting using an array. The array used to set the POST fields must only contain scalar values. Multidimentional arrays or objects lacking a __toString implementation will cause Curl to error.
<br>
<br>If there is a need to send non-scalar values using a POST request, consider serializing them before transmission.
<br>
<br><span class="default">&lt;?php
<br>$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://host.example.com</a>'</span><span class="keyword">);
<br>
<br></span><span class="comment">// Data to post
<br></span><span class="default">$multiDimensional </span><span class="keyword">= array(
<br>&nbsp;&nbsp; </span><span class="string">'name' </span><span class="keyword">= </span><span class="string">'foo'</span><span class="keyword">,
<br>&nbsp;&nbsp; </span><span class="string">'data' </span><span class="keyword">= array(</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">),
<br>&nbsp;&nbsp; </span><span class="string">'value' </span><span class="keyword">= </span><span class="string">'bar'
<br></span><span class="keyword">);
<br>
<br></span><span class="comment">// Will error
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$multiDimensional</span><span class="keyword">);
<br>
<br></span><span class="comment">// Data to post
<br></span><span class="default">$postData </span><span class="keyword">= array(
<br>&nbsp; </span><span class="string">'name' </span><span class="keyword">= </span><span class="string">'foo'</span><span class="keyword">,
<br>&nbsp; </span><span class="string">'data' </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(array(</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)),
<br>&nbsp; </span><span class="string">'value' </span><span class="keyword">= </span><span class="string">'bar'
<br></span><span class="keyword">);
<br>
<br></span><span class="comment">// Will not error
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$postData</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91978">  
  <a class="name">
  <strong class="user"><em>Victor Jerlin</em></strong></a><div class="date" title="2009-07-03 04:12"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91978">
<div class="phpcode"><code><span class="html">
Seems like some options not mentioned on this page, but listed on <a rel="nofollow" target="_blank">http://curl.haxx.se/libcurl/c/curl_easy_setopt.html</a> is actually supported.<br><br>I was happy to see that I could actually use CURLOPT_FTP_CREATE_MISSING_DIRS even from PHP.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114958">  
  <a class="name">
  <strong class="user"><em>maxime dot elomari at gmail dot com</em></strong></a><div class="date" title="2014-05-05 03:52"><strong>3 months ago</strong></div>
  <div class="text" id="Hcom114958">
<div class="phpcode"><code><span class="html">
If you get an error with the error code 35 saying "Unknown SSL protocol error in connection to ...", maybe you are using the wrongs ciphers.<br><br>Try to precise a bunch of ciphers as below:<br><br>$arrayCiphers = array(<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'DHE-RSA-AES256-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'DHE-DSS-AES256-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'AES256-SHA:KRB5-DES-CBC3-MD5',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'KRB5-DES-CBC3-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EDH-RSA-DES-CBC3-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EDH-DSS-DES-CBC3-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'DES-CBC3-SHA:DES-CBC3-MD5',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'DHE-RSA-AES128-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'DHE-DSS-AES128-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'AES128-SHA:RC2-CBC-MD5',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'KRB5-RC4-MD5:KRB5-RC4-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'RC4-SHA:RC4-MD5:RC4-MD5',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'KRB5-DES-CBC-MD5',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'KRB5-DES-CBC-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EDH-RSA-DES-CBC-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EDH-DSS-DES-CBC-SHA:DES-CBC-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'DES-CBC-MD5:EXP-KRB5-RC2-CBC-MD5',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-KRB5-DES-CBC-MD5',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-KRB5-RC2-CBC-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-KRB5-DES-CBC-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-EDH-RSA-DES-CBC-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-EDH-DSS-DES-CBC-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-DES-CBC-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-RC2-CBC-MD5',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-RC2-CBC-MD5',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-KRB5-RC4-MD5',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-KRB5-RC4-SHA',<br>&nbsp; &nbsp; &nbsp; &nbsp; 'EXP-RC4-MD5:EXP-RC4-MD5'<br>);<br><br>curl_setopt($ch, CURLOPT_SSL_CIPHER_LIST, implode(':', $arrayCiphers));<br><br>Worked for me, could work for you!<br><br>P.S: Used with PHP 5.4 and cURL 7.26.0.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114475">  
  <a class="name">
  <strong class="user"><em>Martin K.</em></strong></a><div class="date" title="2014-02-24 05:36"><strong>6 months ago</strong></div>
  <div class="text" id="Hcom114475">
<div class="phpcode"><code><span class="html">
If you only want to enable cookie handling and you don't need to save the cookies for a separate session, just set CURLOPT_COOKIEFILE to an empty string.&nbsp; I was given the advice to use php://memory but that did not seem to have the same effect.<br><br>Although this is stated in the documentation I thought it was worth reiterating since it cause me so much trouble.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113754">  
  <a class="name">
  <strong class="user"><em>etiennez0r at gmail dot com</em></strong></a><div class="date" title="2013-11-26 08:48"><strong>9 months ago</strong></div>
  <div class="text" id="Hcom113754">
<div class="phpcode"><code><span class="html">
// For those having message<br>// SSL connection timeout<br>curl_setopt($ch, CURLOPT_SSLVERSION, 1);<br>// solved for me</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112158">  
  <a class="name">
  <strong class="user"><em>Manasi</em></strong></a><div class="date" title="2013-05-10 05:55"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112158">
<div class="phpcode"><code><span class="html">
CURLAUTH_ANY is not an alias for CURLAUTH_NTLM. I had to specify CURLAUTH_NTLM for a Windows authenticated URL</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111696">  
  <a class="name">
  <strong class="user"><em>xuyan83121 at gmail dot com</em></strong></a><div class="date" title="2013-03-18 05:54"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111696">
<div class="phpcode"><code><span class="html">
when use curl_multi_exec, the CURLOPT_TIMEOUT need curl version newer than 7.21.2.<br>this can be found at curl changelog.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108881">  
  <a class="name">
  <strong class="user"><em>coding query</em></strong></a><div class="date" title="2012-05-31 05:52"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108881">
<div class="phpcode"><code><span class="html">
Sometimes we want to extract the HTML content of the remote website page, this technique is called as HTML scrapper. This article will discuss on how we can extract the HTML content of the remote webpage.
<br>We can achieve HTML scrapper operation in 2 step operation:
<br>Call to Remote Web Page and extract the HTML content.
<br>Match the HTML tags using Regular Expression.
<br>Call to Remote Web Page using PHP:
<br>In PHP there are various ways we can call the remote webpage. But here we will be using CURL to achieve our operation.
<br>
<br><span class="default">&lt;?php
<br>$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br></span><span class="default">$timeout </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">; </span><span class="comment">// set to zero for no timeout
<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);
<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_CONNECTTIMEOUT</span><span class="keyword">, </span><span class="default">$timeout</span><span class="keyword">);
<br></span><span class="default">$file_contents </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br> </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">'/&lt;span&gt;[\\/\\(\\)-:&lt;&gt;\\w\\s]+&lt; \\/span&gt;/'</span><span class="keyword">,</span><span class="default">$file_contents</span><span class="keyword">,</span><span class="default">$htmlContent</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108583">  
  <a class="name">
  <strong class="user"><em>jeffb at nospam dot videx dot com</em></strong></a><div class="date" title="2012-05-08 10:53"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108583">
<div class="phpcode"><code><span class="html">
When trying to pass a multi-dimensional array to CURLOPT_POSTFIELDS, first run it through http_build_query().&nbsp; That will get rid of the Array to String conversion notice.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73742">  
  <a class="name">
  <strong class="user"><em>paczor</em></strong></a><div class="date" title="2007-03-08 06:50"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73742">
<div class="phpcode"><code><span class="html">
How to get rid of response after POST: just add callback function for returned data (CURLOPT_WRITEFUNCTION) and make this function empty.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">curlHeaderCallback</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">$strHeader</span><span class="keyword">) {
<br>}
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_WRITEFUNCTION</span><span class="keyword">, </span><span class="string">'curlHeaderCallback'</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104387">  
  <a class="name">
  <strong class="user"><em>m dot ghadam at gmail dot com</em></strong></a><div class="date" title="2011-06-13 02:02"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom104387">
<div class="phpcode"><code><span class="html">
When you set ($ch, curlopt_post, 1) , after you have posted your data with curl_exec , you need to set ($ch, curlopt_post, 0), Otherwise all your subsequent requests seems as a post with no postdata and some reverse proxy servers send 500 or 403 error for these case ( access denied or forbidden )!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102090">  
  <a class="name">
  <strong class="user"><em>gskluzacek at gmail dot com</em></strong></a><div class="date" title="2011-01-26 01:42"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102090">
<div class="phpcode"><code><span class="html">
FYI... unless you specifically set the user agent, no user agent will be sent in your request as there is no default value like some of the other options.<br><br>As others have said, not sending a user agent may cause you to not&nbsp; get the results that you expected, e.g., 0 byte length content, different content, etc.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101231">  
  <a class="name">
  <strong class="user"><em>john dot david dot steele at gmail dot com</em></strong></a><div class="date" title="2010-12-03 01:03"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101231">
<div class="phpcode"><code><span class="html">
A note on the way Curl posts files...<br><br><span class="default">&lt;?php<br>&nbsp; curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, array(</span><span class="string">'file' </span><span class="keyword">=&gt; </span><span class="string">'@/path/to/file.ext'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>will post the FULL PATH of the file in the filename field:<br><br>Content-Disposition: form-data; name="file"; filename="/path/to/file.ext"<br><br>Whereas typical browser behavior only sends the filename:<br><br>Content-Disposition: form-data; name="file"; filename="file.ext"<br><br>Workaround: <br><span class="default">&lt;?php<br>&nbsp; curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, array(</span><span class="string">'file' </span><span class="keyword">=&gt; </span><span class="string">'@file.ext'</span><span class="keyword">);<br>&nbsp; </span><span class="default">$cwd </span><span class="keyword">= </span><span class="default">getcwd</span><span class="keyword">();<br>&nbsp; </span><span class="default">chdir</span><span class="keyword">(</span><span class="string">'/path/to/'</span><span class="keyword">);<br>&nbsp; </span><span class="default">$receivedData </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br>&nbsp; </span><span class="default">chdir</span><span class="keyword">(</span><span class="default">$cwd</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101139">  
  <a class="name">
  <strong class="user"><em>scy-phpmanual at scytale dot name</em></strong></a><div class="date" title="2010-11-29 04:01"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101139">
<div class="phpcode"><code><span class="html">
In order to reset CURLOPT_HTTPHEADER, set it to array(). The cURL C API says you should set it to NULL, but that doesnâ€™t work in the PHP wrapper.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100716">  
  <a class="name">
  <strong class="user"><em>prohfesor at gmail dot com</em></strong></a><div class="date" title="2010-11-02 01:30"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100716">
<div class="phpcode"><code><span class="html">
This function helps to parse netscape cookie file, generated by cURL into cookie array:
<br>
<br><span class="default">&lt;?php
<br>&nbsp; </span><span class="keyword">function </span><span class="default">_curl_parse_cookiefile</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$aCookies </span><span class="keyword">= array();
<br>&nbsp; &nbsp; </span><span class="default">$aLines </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);
<br>&nbsp; &nbsp; foreach(</span><span class="default">$aLines </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">){
<br>&nbsp; &nbsp; &nbsp; if(</span><span class="string">'#'</span><span class="keyword">==</span><span class="default">$line</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">})
<br>&nbsp; &nbsp; &nbsp; &nbsp; continue;
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$arr </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\t"</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; if(isset(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">]) &amp;&amp; isset(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">]))
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aCookies</span><span class="keyword">[</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">]] = </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">];
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; return </span><span class="default">$aCookies</span><span class="keyword">; 
<br>&nbsp; }
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100083">  
  <a class="name">
  <strong class="user"><em>kavih7 at yahoo dot com</em></strong></a><div class="date" title="2010-09-23 08:59"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100083">
<div class="phpcode"><code><span class="html">
When POSTing with cURL, my POSTs were magically being converted to GETs and I debugged it until finding the issue. I was setting the CURLOPT_MUTE option. Not sure why this conflicts, since the documentation doesn't specify as such. Anyways, if your $_POST is empty, make sure you aren't setting CURLOPT_MUTE.<br><br>Cheers!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57005">  
  <a class="name">
  <strong class="user"><em>ROXORT at TGNOOB dot FR</em></strong></a><div class="date" title="2005-09-21 07:09"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom57005">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php
<br></span><span class="comment">/*
<br>&nbsp; Here is a script that is usefull to :
<br>&nbsp; - login to a POST form,
<br>&nbsp; - store a session cookie,
<br>&nbsp; - download a file once logged in.
<br>*/
<br>
<br>// INIT CURL
<br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>
<br></span><span class="comment">// SET URL FOR THE POST FORM LOGIN
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://www.example.com/Members/Login.php</a>'</span><span class="keyword">);
<br>
<br></span><span class="comment">// ENABLE HTTP POST
<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>
<br></span><span class="comment">// SET POST PARAMETERS : FORM VALUES FOR EACH FIELD
<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="string">'fieldname1=fieldvalue1&amp;fieldname2=fieldvalue2'</span><span class="keyword">);
<br>
<br></span><span class="comment">// IMITATE CLASSIC BROWSER'S BEHAVIOUR : HANDLE COOKIES
<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">, </span><span class="string">'cookie.txt'</span><span class="keyword">);
<br>
<br></span><span class="comment"># Setting CURLOPT_RETURNTRANSFER variable to 1 will force cURL
<br># not to print out the results of its query.
<br># Instead, it will return the results as a string return value
<br># from curl_exec() instead of the usual true/false.
<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>
<br></span><span class="comment">// EXECUTE 1st REQUEST (FORM LOGIN)
<br></span><span class="default">$store </span><span class="keyword">= </span><span class="default">curl_exec </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br></span><span class="comment">// SET FILE TO DOWNLOAD
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://www.example.com/Members/Downloads/AnnualReport.pdf</a>'</span><span class="keyword">);
<br>
<br></span><span class="comment">// EXECUTE 2nd REQUEST (FILE DOWNLOAD)
<br></span><span class="default">$content </span><span class="keyword">= </span><span class="default">curl_exec </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br></span><span class="comment">// CLOSE CURL
<br></span><span class="default">curl_close </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); 
<br>
<br></span><span class="comment">/*
<br>&nbsp; At this point you can do do whatever you want
<br>&nbsp; with the downloaded file stored in $content :
<br>&nbsp; display it, save it as file, and so on.
<br>*/
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98751">  
  <a class="name">
  <strong class="user"><em>patryk at do dot not dot spam dot com</em></strong></a><div class="date" title="2010-07-05 05:33"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98751">
<div class="phpcode"><code><span class="html">
CURLOPT_HTTPPROXYTUNNEL means curl will use CONNECT method of the HTTP protocol to make a tunnel through a proxy, which is most likely not the one you want to do.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98491">  
  <a class="name">
  <strong class="user"><em>JScott jscott401 at gmail dot com</em></strong></a><div class="date" title="2010-06-18 07:29"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98491">
<div class="phpcode"><code><span class="html">
Some additional notes for curlopt_writefunction. I struggled with this at first because it really isn't documented very well.<br><br>When you write a callback function and use it with curlopt_writefunction it will be called MULTIPLE times. Your function MUST return the ammount of data written to it each time. It is very picky about this. Here is a snippet from my code that may help you<br><br><span class="default">&lt;?php<br>curl_setopt</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">curl_handle</span><span class="keyword">, </span><span class="default">CURLOPT_WRITEFUNCTION</span><span class="keyword">, array(</span><span class="default">$this</span><span class="keyword">, </span><span class="string">"receiveResponse"</span><span class="keyword">));<br><br></span><span class="comment">// later on in the class I wrote my receive Response method<br><br></span><span class="keyword">private function </span><span class="default">receiveResponse</span><span class="keyword">(</span><span class="default">$curlHandle</span><span class="keyword">,</span><span class="default">$xmldata</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">responseString </span><span class="keyword">= </span><span class="default">$xmldata</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">responseXML </span><span class="keyword">.=&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">responseString</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">length </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$xmldata</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">size </span><span class="keyword">+= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">length</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">length</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br></span><span class="default">?&gt;<br></span><br>Now I did this for a class. If you aren't doing OOP then you will obviously need to modify this for your own use.<br><br>CURL calls your script MULTIPLE times because the data will not always be sent all at once. Were talking internet here so its broken up into packets. You need to take your data and concatenate it all together until it is all written. I was about to pull my damn hair out because I would get broken chunks of XML back from the server and at random lengths. I finally figured out what was going on. Hope this helps</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53445">  
  <a class="name">
  <strong class="user"><em>michaeledwards.com</em></strong></a><div class="date" title="2005-06-01 02:57"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom53445">
<div class="phpcode"><code><span class="html">
Problems can occur if you mix CURLOPT_URL with a 'Host:' header in CURLOPT_HEADERS on redirects because cURL will combine the host you explicitly stated in the 'Host:' header with the host from the Location: header of the redirect response. 
<br>
<br>In short, don't do this:
<br>
<br><span class="default">&lt;?php
<br>$host </span><span class="keyword">= </span><span class="string">"www.example.com"</span><span class="keyword">;
<br></span><span class="default">$url </span><span class="keyword">= </span><span class="string">"<a rel="nofollow" target="_blank">http://</a></span><span class="default">$host</span><span class="string">/"</span><span class="keyword">;
<br>
<br></span><span class="default">$headers </span><span class="keyword">= array(</span><span class="string">"Host: </span><span class="default">$host</span><span class="string">"</span><span class="keyword">);
<br>
<br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, </span><span class="default">$headers</span><span class="keyword">);
<br>
<br>Do </span><span class="default">this instead</span><span class="keyword">:
<br>
<br></span><span class="default">$host </span><span class="keyword">= </span><span class="string">"www.example.com"</span><span class="keyword">;
<br></span><span class="default">$url </span><span class="keyword">= </span><span class="string">"<a rel="nofollow" target="_blank">http://</a></span><span class="default">$host</span><span class="string">/"</span><span class="keyword">;
<br>
<br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97591">  
  <a class="name">
  <strong class="user"><em>obones_remove_me at free dot fr</em></strong></a><div class="date" title="2010-04-27 03:27"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97591">
<div class="phpcode"><code><span class="html">
For those of you wondering how to specify the content-type for a file uploaded via curl, the syntax is as follows:<br><br><span class="default">&lt;?php<br><br>$data </span><span class="keyword">= array(</span><span class="string">'file' </span><span class="keyword">=&gt; </span><span class="string">'@/home/user/test.png;type=image/png'</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>Simply adding a semicolon with the type= at the end.<br>Note that this has been reported not to work in all versions of PHP and I have done the following tests:<br><br>5.2.6 (libcurl 7.18.2) : Does not work<br>5.2.13 (libcurl 7.20.0) : Works just fine<br><br>So it might be worth updating your installation of PHP and/or libcurl if you want to be able to use this syntax</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97383">  
  <a class="name">
  <strong class="user"><em>clint at fewbar dot com</em></strong></a><div class="date" title="2010-04-16 02:56"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97383">
<div class="phpcode"><code><span class="html">
If you have turned on conditional gets on a curl handle, and then for a subsequent request, you don't have a good setting for CURLOPT_TIMEVALUE , you can disable If-Modified-Since checking with:<br><br><span class="default">&lt;?php<br><br>$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$foo</span><span class="keyword">);<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMEVALUE</span><span class="keyword">, </span><span class="default">filemtime</span><span class="keyword">(</span><span class="default">$foo_path</span><span class="keyword">));<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMECONDITION</span><span class="keyword">, </span><span class="default">CURLOPT_TIMECOND_IFMODIFIEDSINCE</span><span class="keyword">);<br></span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br></span><span class="comment">// Reuse same curl handle<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$bar</span><span class="keyword">);<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMEVALUE</span><span class="keyword">, </span><span class="default">null</span><span class="keyword">); </span><span class="comment">// don't know mtime<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMECONDITION</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">); </span><span class="comment">// set it to 0, turns it off<br></span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="93630">  
  <a class="name">
  <strong class="user"><em>Stan van de Burgt</em></strong></a><div class="date" title="2009-09-19 02:41"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom93630">
<div class="phpcode"><code><span class="html">
If you get a "failed creating formpost data" upon curl_exec() when POSTing a form, check if one of the field values starts with the @ character.<br><br>Took me an hour or so to find out as I wanted to post a @reply tweet to twitter which typically start with @screenname.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="93351">  
  <a class="name">
  <strong class="user"><em>Tyranoweb</em></strong></a><div class="date" title="2009-09-04 02:42"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom93351">
<div class="phpcode"><code><span class="html">
There is a function to send POST data in page with five parameters :
<br>
<br>$post must be an array
<br>$page is the page where POST datas will be send.
<br>$n must be true to continue if they are php redirection (Location: )
<br>$session must be define true if you want to use cookies 
<br>$referer must be a link to get a wrong referer or only to have a referer.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">curl_data_post</span><span class="keyword">(</span><span class="default">$post</span><span class="keyword">, </span><span class="default">$page</span><span class="keyword">, </span><span class="default">$n</span><span class="keyword">, </span><span class="default">$session</span><span class="keyword">, </span><span class="default">$referer</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$post</span><span class="keyword">))
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$DATA_POST </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$page</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$n</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$session</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEFILE</span><span class="keyword">, </span><span class="string">'cookiefile.txt'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">, </span><span class="string">'cookiefile.txt'</span><span class="keyword">); 
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$referer</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">, </span><span class="default">CURLOPT_REFERER</span><span class="keyword">, </span><span class="default">$referer</span><span class="keyword">); 
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$post</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$data </span><span class="keyword">== </span><span class="default">false</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo</span><span class="string">'Warning : ' </span><span class="keyword">. </span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; else
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$DATA_POST</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$data</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; }
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115501">  
  <a class="name">
  <strong class="user"><em>White Gandalf</em></strong></a><div class="date" title="2014-08-05 04:38"><strong>22 days ago</strong></div>
  <div class="text" id="Hcom115501">
<div class="phpcode"><code><span class="html">
to complement shiplu's&nbsp; comment on the neccessary option sequence of CURLOPT_POST before CURLOPT_POSTFIELDS:<br><br>The crux is not some error on nginx, but that nothing at all will be send over the line by curl. Parameters set by a "CURLOPT_POSTFIELDS" option setting will be completely ignored, as long as no "CURLOPT_POST" has been encountered beforehand: Neigther the Content-Type header will be set/generated accordingly nor Content-Length nor any data will be send in the body.<br><br>When using curl_setopt_array, the sequence in the array matters as well.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="92235">  
  <a class="name">
  <strong class="user"><em>mikeseth at gmail dot com</em></strong></a><div class="date" title="2009-07-15 02:32"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom92235">
<div class="phpcode"><code><span class="html">
When using CURLOPT_FILE, pass it the file handle that is open for write only (eg fopen('blahblah', 'w+')). If you also open the file for reading (eg fopen('blahblah', 'rw')), curl will fail with error 23.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91510">  
  <a class="name">
  <strong class="user"><em>Andrew</em></strong></a><div class="date" title="2009-06-14 04:56"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91510">
<div class="phpcode"><code><span class="html">
I noticed that if you want to get current cookie file after curl_exec() - you need to close current curl handle (like it said in manual), but if you want cookies to be dumped to file after any curl_exec (without curl_close) you can:
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">#call it normally
<br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(); 
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">); 
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEFILE</span><span class="keyword">, </span><span class="string">"cookiefile"</span><span class="keyword">); 
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">, </span><span class="string">"cookiefile"</span><span class="keyword">); 
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); 
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://www.example.com/</a>'</span><span class="keyword">); 
<br></span><span class="default">$result1 </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); 
<br>
<br></span><span class="comment">#and then&nbsp; make a temp copy
<br></span><span class="default">$ch_temp</span><span class="keyword">=</span><span class="default">curl_copy_handle</span><span class="keyword">(</span><span class="default">ch</span><span class="keyword">);
<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br></span><span class="default">$ch</span><span class="keyword">=</span><span class="default">$ch_temp</span><span class="keyword">;
<br></span><span class="default">?&gt;
<br></span>
<br>Only this way, if you close $ch_temp - cookies wont be dumped.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115153">  
  <a class="name">
  <strong class="user"><em>Simeon Anastasov</em></strong></a><div class="date" title="2014-06-04 01:46"><strong>2 months ago</strong></div>
  <div class="text" id="Hcom115153">
<div class="phpcode"><code><span class="html">
One note of importance when you open several cURL handles simultaneously: If you want to share cookies via cookie-jar file among all your handles - be sure to curl_close() one before using the cookie-jar file from the other. <br><br>It appears that during cURL handler execution the cookies are kept in some sort of handler specific internal session storage and only upon explicit curl_close() call or interpreter exit garbage collection these cookies are actually flushed to the file on the hard disk ( I guess for performance reasons ). <br><br>I hope this note will save you couple of hours debugging :)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115131">  
  <a class="name">
  <strong class="user"><em>oleg dot nucer at gmail dot com</em></strong></a><div class="date" title="2014-06-01 05:56"><strong>2 months ago</strong></div>
  <div class="text" id="Hcom115131">
<div class="phpcode"><code><span class="html">
The @ char will not work in CURLOPT_POSTFIELDS since PHP 5.5! There is nothing about it in stupid Russian version of docs. I've spend few hours trying to find the problme in my code before read the English manual))</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114850">  
  <a class="name">
  <strong class="user"><em>gabriel dot rota at gmail dot com</em></strong></a><div class="date" title="2014-04-14 04:22"><strong>4 months ago</strong></div>
  <div class="text" id="Hcom114850">
<div class="phpcode"><code><span class="html">
php curl pass through proxy handle: big file, https, autentication<br><br><span class="default">&lt;?php<br></span><span class="comment">/*<br> * curl-pass-through-proxy.php<br> * <br> * Copyright 2014 Gabriel Rota &lt;gabriel.rota@gmail.com&gt;<br> * <br> * propose: php curl pass through proxy handle: big file, https, autentication<br> * example: curl-pass-through-proxy.php?url=precise/ubuntu-12.04.4-desktop-i386.iso<br> * limitation: don't work on binary if is enabled in php.ini the ;output_handler = ob_gzhandler<br> * licence: BSD<br> * <br> */<br><br>&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="string">"<a rel="nofollow" target="_blank">http://releases.ubuntu.com/</a>" </span><span class="keyword">. </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">"url"</span><span class="keyword">]; </span><span class="comment">// NOTE: this example don't use https<br>&nbsp; </span><span class="default">$credentials </span><span class="keyword">= </span><span class="string">"user:pwd"</span><span class="keyword">;<br>&nbsp; </span><span class="default">$headers </span><span class="keyword">= array(<br>&nbsp; &nbsp; </span><span class="string">"GET "</span><span class="keyword">.</span><span class="default">$url</span><span class="keyword">.</span><span class="string">" HTTP/1.1"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"Content-type: text/xml"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"Cache-Control: no-cache"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"Pragma: no-cache"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"Authorization: Basic " </span><span class="keyword">. </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$credentials</span><span class="keyword">)<br>&nbsp; );<br><br>&nbsp; global </span><span class="default">$filename</span><span class="keyword">; </span><span class="comment">// used in fn_CURLOPT_HEADERFUNCTION setting download filename<br>&nbsp; </span><span class="default">$filename </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">)+</span><span class="default">1</span><span class="keyword">); </span><span class="comment">// find last /<br><br>&nbsp; </span><span class="keyword">function </span><span class="default">fn_CURLOPT_WRITEFUNCTION</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">){<br>&nbsp; &nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br>&nbsp; &nbsp; echo( </span><span class="default">$str </span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">$len</span><span class="keyword">;<br>&nbsp; }<br><br>&nbsp; function </span><span class="default">fn_CURLOPT_HEADERFUNCTION</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">){ <br>&nbsp; &nbsp; global </span><span class="default">$filename</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">( </span><span class="default">$str </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="comment">//~ error_log("curl-pass-through-proxy:fn_CURLOPT_HEADERFUNCTION:str:".$str.PHP_EOL, 3, "/tmp/curl-pass-through-proxy.log");<br>&nbsp; &nbsp; </span><span class="keyword">if ( </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">"application/x-iso9660-image"</span><span class="keyword">) !== </span><span class="default">false </span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">( </span><span class="string">"Content-Disposition: attachment; filename=\"</span><span class="default">$filename</span><span class="string">\"" </span><span class="keyword">); </span><span class="comment">// set download filename<br>&nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; return </span><span class="default">$len</span><span class="keyword">;<br>&nbsp; }<br><br>&nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(); </span><span class="comment">// init curl resource<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">,</span><span class="default">$url</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">); </span><span class="comment">// a true curl_exec return content<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMEOUT</span><span class="keyword">, </span><span class="default">600</span><span class="keyword">); </span><span class="comment">// 60 second<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, </span><span class="default">$headers</span><span class="keyword">); </span><span class="comment">// login $url<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_USERAGENT</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_USER_AGENT'</span><span class="keyword">]);<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYHOST</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">); </span><span class="comment">// don't check certificate<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYPEER</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">); </span><span class="comment">// don't check certificate<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">); </span><span class="comment">// true Return the HTTP headers in string, no good with CURLOPT_HEADERFUNCTION<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_BUFFERSIZE</span><span class="keyword">, </span><span class="default">8192</span><span class="keyword">); </span><span class="comment">// 8192 8k<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADERFUNCTION</span><span class="keyword">, </span><span class="string">"fn_CURLOPT_HEADERFUNCTION"</span><span class="keyword">); </span><span class="comment">// handle received headers<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_WRITEFUNCTION</span><span class="keyword">, </span><span class="string">'fn_CURLOPT_WRITEFUNCTION'</span><span class="keyword">); </span><span class="comment">// callad every CURLOPT_BUFFERSIZE<br><br>&nbsp; &nbsp; </span><span class="keyword">if ( ! </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">) ) {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">error_log</span><span class="keyword">( </span><span class="string">"curl-pass-through-proxy:Error:"</span><span class="keyword">.</span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">).</span><span class="default">PHP_EOL</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="string">"/tmp/curl-pass-through-proxy.log" </span><span class="keyword">);<br>&nbsp; &nbsp; }<br><br>&nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); </span><span class="comment">// close curl resource<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="89770">  
  <a class="name">
  <strong class="user"><em>ashooner - - gmail , com</em></strong></a><div class="date" title="2009-03-22 03:28"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom89770">
<div class="phpcode"><code><span class="html">
When passing CURLOPT_POSTFIELDS a url-encoded string in order to use Content-Type: application/x-www-form-urlencoded, you can pass a string directly:<br><span class="default">&lt;?php<br>curl_setopt</span><span class="keyword">(</span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="string">'field1=value&amp;field2=value2'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>rather than passing the string in an array, as in fred at themancan dot com's example.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114571">  
  <a class="name">
  <strong class="user"><em>lachlan at radelaide dot net</em></strong></a><div class="date" title="2014-03-07 12:29"><strong>5 months ago</strong></div>
  <div class="text" id="Hcom114571">
<div class="phpcode"><code><span class="html">
For those using CURLAUTH_NTLM, it may come to no surprise&nbsp; that NTLM request will fail if you have set CURLOPT_FORBID_REUSE to true.<br><br>This is because NTLM authorisation is connect-based, not request-based. If the connection is not kept alive and re-used, cURL can never complete the request.<br><br>You may notice this if you get a 401 status code or max out the number of redirects.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114497">  
  <a class="name">
  <strong class="user"><em>Martin K.</em></strong></a><div class="date" title="2014-02-27 05:31"><strong>6 months ago</strong></div>
  <div class="text" id="Hcom114497">
<div class="phpcode"><code><span class="html">
If you need to read page contents in between file downloads, while still using the same curl handle, you'll probably need this code:<br><span class="default">&lt;?php<br>&nbsp; &nbsp; curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_FILE</span><span class="keyword">, </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'php://stdout'</span><span class="keyword">,</span><span class="string">'w'</span><span class="keyword">));&nbsp;&nbsp; </span><span class="comment">// 'php://output' didn't work for me<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);&nbsp; </span><span class="comment">// using CURLOPT_FILE sets this to false automatically<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88538">  
  <a class="name">
  <strong class="user"><em>urkle at outoforder dot cc</em></strong></a><div class="date" title="2009-01-28 06:49"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88538">
<div class="phpcode"><code><span class="html">
To send a post as a different content-type (ie.. application/json or text/xml) add this setopt call
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">,array(</span><span class="string">'Content-Type: application/json'</span><span class="keyword">));
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114063">  
  <a class="name">
  <strong class="user"><em>Joan</em></strong></a><div class="date" title="2014-01-08 07:59"><strong>7 months ago</strong></div>
  <div class="text" id="Hcom114063">
<div class="phpcode"><code><span class="html">
Using CURLOPT_NOPROXY to avoid using the proxy for some urls is very convenient.<br>For example when the page is trying to look for itself.<br>The parameter can be found at least in version 5.5.7, (probably earlier)<br>Unfortunately it's not present on debian wheezy (5.4.4) but it will be on jessie (it's already there)<br><br>A related bug: https://bugs.php.net/bug.php?id=53543</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113029">  
  <a class="name">
  <strong class="user"><em>mfuhrman at enetarch dot net</em></strong></a><div class="date" title="2013-08-20 11:20"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom113029">
<div class="phpcode"><code><span class="html">
Here is an example of sending JSON data as via POST.<br><br>index.php<br>------<br>$data = array<br>(<br>&nbsp; "command" =&gt; "isInstalled", <br>&nbsp; "params" =&gt; Array<br>&nbsp; (<br>&nbsp; &nbsp; "1" =&gt; "3",<br>&nbsp; &nbsp; "2" =&gt; "4",<br>&nbsp; )<br>);<br><br>$data_string = "json=" . json_encode($data) . "&amp;";<br>$ch = curl_init("<a rel="nofollow" target="_blank">http://localhose/parrot.php</a>");<br>curl_setopt($ch, CURLOPT_POST, true);<br>curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);<br>curl_setopt($ch, CURLOPT_POSTFIELDS, $data_string);<br>$results = curl_exec($ch);<br><br>print ($results);<br>?&gt;<br>=====<br><br>parrot.php<br>------<br>&lt;?<br>print_r ($_REQUEST);<br>?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85044">  
  <a class="name">
  <strong class="user"><em>w dot danford at electronics-software dot com</em></strong></a><div class="date" title="2008-08-12 10:12"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom85044">
<div class="phpcode"><code><span class="html">
Just a small detail I too easily overlooked.<br><span class="default">&lt;?php<br></span><span class="comment">/*&nbsp; If you set:&nbsp; */<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br></span><span class="comment">/* then you must have the data: */<br></span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$PostData</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>I found with only the CURLOPT_POST set (from copy, paste editing of course) cookies were not getting sent with CURLOPT_COOKIE.&nbsp; Just something subtle to watch out for.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83937">  
  <a class="name">
  <strong class="user"><em>Salil Kothadia</em></strong></a><div class="date" title="2008-06-19 09:02"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83937">
<div class="phpcode"><code><span class="html">
In PHP5, for the "CURLOPT_POSTFIELDS" option, we can use:<br><br><span class="default">&lt;?php<br>$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="default">$URI</span><span class="keyword">);<br></span><span class="default">$Post </span><span class="keyword">= </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$PostData</span><span class="keyword">);<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$Post</span><span class="keyword">);<br></span><span class="default">$Output </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111975">  
  <a class="name">
  <strong class="user"><em>dardyole at hotmail dot com</em></strong></a><div class="date" title="2013-04-18 04:29"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111975">
<div class="phpcode"><code><span class="html">
Another note addressing the issues with servers that have open_basedir and safe mode turned on. Such an issue spawns the following E_WARNING:<br><br>Warning: curl_setopt() [function.curl-setopt]: CURLOPT_FOLLOWLOCATION cannot be activated when safe_mode is enabled or an open_basedir is set<br><br>After looking through the notes, most of the proposed manual implementations were kind of clunky and in some cases just didn't work at all. Most importantly (in my case), was the behaviour of the 302 Header. Anyway, here's the code I ended up using which has worked well for me in all cases so far, it even addresses the issue that caused FOLLOWLOCATION to be turned off in some cases :)<br><br>EDIT: Unfortunately the code itself is deemed "too long" for PHP's note system. I've uploaded it to a few paste sites below so hopefully the links will live for a while at least.<br><br><a rel="nofollow" target="_blank">http://pastebin.com/aaJtPy1j</a><br><a rel="nofollow" target="_blank">http://pastie.org/7646116</a><br><br>Use it as a replacement for curl_exec. For example:<br><br><span class="default">&lt;?php<br>$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="string">"<a rel="nofollow" target="_blank">http://php.net</a>"</span><span class="keyword">);<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">curl_exec_follow</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">9001</span><span class="keyword">));<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="81161">  
  <a class="name">
  <strong class="user"><em>mavook at gmail dot com</em></strong></a><div class="date" title="2008-02-15 10:26"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom81161">
<div class="phpcode"><code><span class="html">
If you try to upload file to a server, you need do CURLOPT_POST first and then fill CURLOPT_POSTFIELDS.
<br>
<br><span class="default">&lt;?php
<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$postvars</span><span class="keyword">);
<br></span><span class="comment">// ^^ This will post multipart/form-data
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="26797">  
  <a class="name">
  <strong class="user"><em>yann dot corno at free dot fr</em></strong></a><div class="date" title="2002-11-13 04:19"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom26797">
<div class="phpcode"><code><span class="html">
About the CURLOPT_HTTPHEADER option, it took me some time to figure out how to format the so-called 'Array'. It fact, it is a list of strings. If Curl was already defining a header item, yours will replace it. Here is an example to change the Content Type in a POST:
<br>
<br><span class="default">&lt;?php curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, Array(</span><span class="string">"Content-Type: text/xml"</span><span class="keyword">)); </span><span class="default">?&gt;
<br></span>
<br>Yann</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110162">  
  <a class="name">
  <strong class="user"><em>juozaspo at gmail dot com</em></strong></a><div class="date" title="2012-09-25 08:47"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom110162">
<div class="phpcode"><code><span class="html">
I've created an example that gets the file on url passed to script and outputs it to the browser. <br><br><span class="default">&lt;?php<br></span><span class="comment">//get the file (e.g. image) and output it to the browser<br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(); </span><span class="comment">//open curl handle<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'url'</span><span class="keyword">]); </span><span class="comment">//set an url<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">//do not output directly, use variable<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_BINARYTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">//do a binary transfer<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FAILONERROR</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">//stop if an error occurred<br></span><span class="default">$file</span><span class="keyword">=</span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); </span><span class="comment">//store the content in variable<br></span><span class="keyword">if(!</span><span class="default">curl_errno</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">))<br>{<br>&nbsp; &nbsp; </span><span class="comment">//send out headers and output<br>&nbsp; &nbsp; </span><span class="default">header </span><span class="keyword">(</span><span class="string">"Content-type: "</span><span class="keyword">.</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLINFO_CONTENT_TYPE</span><span class="keyword">).</span><span class="string">""</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">header </span><span class="keyword">(</span><span class="string">"Content-Length: "</span><span class="keyword">.</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLINFO_CONTENT_LENGTH_DOWNLOAD</span><span class="keyword">).</span><span class="string">""</span><span class="keyword">);<br>&nbsp; &nbsp; echo </span><span class="default">$file</span><span class="keyword">;<br>} else echo </span><span class="string">'Curl error: ' </span><span class="keyword">. </span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); </span><span class="comment">//close curl handle<br></span><span class="default">?&gt;<br></span><br>p.s. Make sure that there're no new lines before and after code or script may not work.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="75525">  
  <a class="name">
  <strong class="user"><em>ashw1 - at - no spam - post - dot - cz</em></strong></a><div class="date" title="2007-06-03 04:51"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom75525">
<div class="phpcode"><code><span class="html">
In case you wonder how come, that cookies don't work under Windows, I've googled for some answers, and here is the result: Under WIN you need to input absolute path of the cookie file.
<br>
<br>This piece of code solves it:
<br>
<br><span class="default">&lt;?php
<br>
<br></span><span class="keyword">if (</span><span class="default">$cookies </span><span class="keyword">!= </span><span class="string">''</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">PHP_OS</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">) == </span><span class="string">'WIN'</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {</span><span class="default">$cookies </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">getcwd</span><span class="keyword">().</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$cookies</span><span class="keyword">);}
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">, </span><span class="default">$cookies</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEFILE</span><span class="keyword">, </span><span class="default">$cookies</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108137">  
  <a class="name">
  <strong class="user"><em>mw+php dot net at lw-systems dot de</em></strong></a><div class="date" title="2012-03-31 06:45"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108137">
<div class="phpcode"><code><span class="html">
The description of the use of the CURLOPT_POSTFIELDS option should be emphasize, that using POST with HTTP/1.1 with cURL implies the use of a "Expect: 100-continue" header. Some web servers will not understand the handling of chunked transfer of post data.<br><br>To disable this behavior one must disable the use of the "Expect:" header with<br><br>&nbsp; &nbsp; curl_setopt($ch, CURLOPT_HTTPHEADER,array("Expect:"));</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73871">  
  <a class="name">
  <strong class="user"><em>alfredoaguirre dot v at gmail dot com</em></strong></a><div class="date" title="2007-03-13 04:26"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73871">
<div class="phpcode"><code><span class="html">
Seems that CURLOPT_RETURNTRANSFER Option set to TRUE, returns a "1" when the transaction returns a blank page.<br><br>I think is for eliminate the FALSE to can be with a blank page as return</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107739">  
  <a class="name">
  <strong class="user"><em>dotpointer at gmail dot com</em></strong></a><div class="date" title="2012-03-01 08:48"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107739">
<div class="phpcode"><code><span class="html">
About CURLOPT_COOKIEJAR and CURLOPT_COOKIEFILE, and which / how to use.
<br>
<br>- CURLOPT_COOKIEJAR is used when cURL is reading cookie data from disk.
<br>
<br>- CURLOPT_COOKIEFILE is used when cURL is writing the cookie data to disk.
<br>
<br>So you need to specify both (and set the same file location on both) when working with sessions for example.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107667">  
  <a class="name">
  <strong class="user"><em>wonderfish+php at gmail dot com</em></strong></a><div class="date" title="2012-02-25 12:22"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107667">
<div class="phpcode"><code><span class="html">
As of at least PHP 5.3.9, if you are continuing to use a cURL session handle after downloading a file and closing the file handle, you will need to change CURLOPT_FILE back to stdout, and cannot count simply on a side effect of CURLOPT_RETURNTRANSFER to do so, even if you are setting it.&nbsp; For example:
<br>
<br><span class="default">&lt;?php
<br>$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br></span><span class="default">$fh </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/path/to/stored/file/example_file.dat'</span><span class="keyword">, </span><span class="string">'w'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FILE</span><span class="keyword">, </span><span class="default">$fh</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://example.com/example_file.dat</a>'</span><span class="keyword">);
<br></span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br></span><span class="default">fflush</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);
<br></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);
<br>
<br></span><span class="comment">//must reset cURL file handle. Not doing so will cause a warning to be
<br>//thrown and for cURL to default to output regardless
<br>//for our example, we'll set return transfer.
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FILE</span><span class="keyword">, </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'php://stdout'</span><span class="keyword">, </span><span class="string">'w'</span><span class="keyword">));
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">'<a rel="nofollow" target="_blank">http://example.org/index.html</a>'</span><span class="keyword">);
<br></span><span class="default">$html </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); </span><span class="comment">//this will now work
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="17640">  
  <a class="name">
  <strong class="user"><em>bvwj at swbell dot net</em></strong></a><div class="date" title="2001-12-18 01:35"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom17640">
<div class="phpcode"><code><span class="html">
To collect cookies recieved with a request, set CURLOPT_COOKIEJAR "cookieFileName".&nbsp; Then use CURLOPT_COOKIEFILE "cookieFileName" to recall them in subsequent transactions.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106891">  
  <a class="name">
  <strong class="user"><em>chsa at ten dot ch</em></strong></a><div class="date" title="2011-12-16 01:39"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom106891">
<div class="phpcode"><code><span class="html">
Sending a post file upload across a squid proxy, the request was rejected by the proxy. In the error page returned it provided among other possible causes:"Expect:" feature is being asked from a HTTP/one.zero.<br>Solution: Add the option <span class="default">&lt;?php curl_setopt</span><span class="keyword">(</span><span class="default">$cl</span><span class="keyword">,</span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">,array(</span><span class="string">"Expect:"</span><span class="keyword">)); </span><span class="default">?&gt;</span>. This will remove the expect http header.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="69115">  
  <a class="name">
  <strong class="user"><em>php at miggy dot org</em></strong></a><div class="date" title="2006-08-23 10:35"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom69115">
<div class="phpcode"><code><span class="html">
Note that if you want to use a proxy and use it as a _cache_, you'll have to do:
<br>
<br><span class="default">&lt;?php curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, array(</span><span class="string">"Pragma: "</span><span class="keyword">)); </span><span class="default">?&gt;
<br></span>
<br>else by default Curl puts a "Pragma: no-cache" header in and thus force cache misses for all requests.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102793">  
  <a class="name">
  <strong class="user"><em>support at lostair dot com</em></strong></a><div class="date" title="2011-03-07 03:26"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102793">
<div class="phpcode"><code><span class="html">
Force Curl Request To Go To A Particular IP Address
<br>
<br>Yes, there is a method of passing an IP address to curl.&nbsp; Excellent for services with multiple IP addresses and also to take DNS out of the equation for testing/debugging.
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">fetch_page</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$host_ip </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>
<br>&nbsp; &nbsp; &nbsp; if (!</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$host_ip</span><span class="keyword">))
<br>&nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$urldata </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//&nbsp; Ensure we have the query too, if there is any...
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (!empty(</span><span class="default">$urldata</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]))
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$urldata</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] .= </span><span class="string">"?"</span><span class="keyword">.</span><span class="default">$urldata</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">];
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//&nbsp; Specify the host (name) we want to fetch...
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$headers </span><span class="keyword">= array(</span><span class="string">"Host: "</span><span class="keyword">.</span><span class="default">$urldata</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HTTPHEADER</span><span class="keyword">, </span><span class="default">$headers</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//&nbsp; create the connecting url (with the hostname replaced by IP)
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">$urldata</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">].</span><span class="string">"://"</span><span class="keyword">.</span><span class="default">$host_ip</span><span class="keyword">.</span><span class="default">$urldata</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">];
<br>&nbsp; &nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">,&nbsp; </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">,&nbsp; </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">curl_exec </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">curl_close </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; return </span><span class="default">$result</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="62020">  
  <a class="name">
  <strong class="user"><em>petelu $ post dot sk</em></strong></a><div class="date" title="2006-02-17 04:19"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom62020">
<div class="phpcode"><code><span class="html">
load https:// or&nbsp; <a rel="nofollow" target="_blank">http://example.com/exam.php&nbsp;</a> 
<br>with&nbsp; POST&nbsp; data (name=alex&amp;year=18) and apply COOKIEs
<br>
<br><span class="default">&lt;?php
<br>$sessions </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$sessions</span><span class="keyword">,</span><span class="default">CURLOPT_URL</span><span class="keyword">,</span><span class="string">'<a rel="nofollow" target="_blank">http://example.com/exam.php</a>'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$sessions</span><span class="keyword">, </span><span class="default">CURLOPT_POST</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$sessions</span><span class="keyword">,</span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">,</span><span class="string">'name=alex&amp;year=18'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$sessions</span><span class="keyword">,</span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">,
<br></span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">).</span><span class="string">'/cookie.txt'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$sessions</span><span class="keyword">,</span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$sessions</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER </span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$sessions</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">$my_load_page </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sessions</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="11132">  
  <a class="name">
  <strong class="user"><em>bvr at xs4all dot nl</em></strong></a><div class="date" title="2001-02-07 07:09"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom11132">
<div class="phpcode"><code><span class="html">
If you'd like to include extra headers in your POST request, you can accomplish this by setting the following option:
<br>
<br>CURLOPT_HTTPHEADER
<br>
<br>This is similar to the CURL -H command line switch.
<br>
<br>Thanks to Daniel Stenberg for pointing out this usefull feature!
<br>
<br>Note: this option was first supported in PHP version 4.03 .</span>
</code></div>
  </div>
 </div>
  <div class="note" id="61395">  
  <a class="name">
  <strong class="user"><em>luca dot manzo at bbsitalia dot com</em></strong></a><div class="date" title="2006-02-02 03:55"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom61395">
<div class="phpcode"><code><span class="html">
If you're getting trouble with cookie handling in curl: 
<br>
<br>- curl manages tranparently cookies in a single curl session
<br>- the option 
<br><span class="default">&lt;?php curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">, </span><span class="string">"/tmp/cookieFileName"</span><span class="keyword">); </span><span class="default">?&gt;
<br></span>
<br>makes curl to store the cookies in a file at the and of the curl session
<br>
<br>- the option 
<br><span class="default">&lt;?php curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEFILE</span><span class="keyword">, </span><span class="string">"/tmp/cookieFileName"</span><span class="keyword">); </span><span class="default">?&gt;
<br></span>
<br>makes curl to use the given file as source for the cookies to send to the server. 
<br>
<br>so to handle correctly cookies between different curl session, the you have to do something like this:
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; &nbsp;&nbsp; $ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(); 
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">); 
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">, </span><span class="default">COOKIE_FILE_PATH</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEFILE</span><span class="keyword">, </span><span class="default">COOKIE_FILE_PATH</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); 
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">curl_exec </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;
<br></span><span class="default">?&gt;
<br></span>
<br>in particular this is NECESSARY if you are using PEAR_SOAP libraries to build a webservice client over https and the remote server need to establish a session cookie. in fact each soap message is sent using a different curl session!!
<br>
<br>I hope this can help someone
<br>Luca</span>
</code></div>
  </div>
 </div>
  <div class="note" id="59993">  
  <a class="name">
  <strong class="user"><em>skyogre __at__ yandex __dot__ ru</em></strong></a><div class="date" title="2005-12-22 02:13"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom59993">
<div class="phpcode"><code><span class="html">
There is really a problem of transmitting $_POST data with curl in php 4+ at least.<br>I improved the encoding function by Alejandro Moreno to work properly with mulltidimensional arrays.<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">data_encode</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$keyprefix </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">, </span><span class="default">$keypostfix </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">) {<br>&nbsp; </span><span class="default">assert</span><span class="keyword">( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) );<br>&nbsp; </span><span class="default">$vars</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">;<br>&nbsp; foreach(</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) </span><span class="default">$vars </span><span class="keyword">.= </span><span class="default">data_encode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$keyprefix</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="default">$keypostfix</span><span class="keyword">.</span><span class="default">urlencode</span><span class="keyword">(</span><span class="string">"["</span><span class="keyword">), </span><span class="default">urlencode</span><span class="keyword">(</span><span class="string">"]"</span><span class="keyword">));<br>&nbsp; &nbsp; else </span><span class="default">$vars </span><span class="keyword">.= </span><span class="default">$keyprefix</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="default">$keypostfix</span><span class="keyword">.</span><span class="string">"="</span><span class="keyword">.</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">).</span><span class="string">"&amp;"</span><span class="keyword">;<br>&nbsp; }<br>&nbsp; return </span><span class="default">$vars</span><span class="keyword">;<br>}<br><br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">data_encode</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">) );<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53636">  
  <a class="name">
  <strong class="user"><em>phpnet at andywaite dot com</em></strong></a><div class="date" title="2005-06-07 02:08"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom53636">
<div class="phpcode"><code><span class="html">
After setting CURLOPT_FILE, you may want want to revert back to the normal behaviour of displaying the results. This can be achieved using:
<br>
<br><span class="default">&lt;?php
<br>$fp </span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">(</span><span class="string">"php://output"</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">) or die(</span><span class="string">"Unable to open stdout for writing.\n"</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FILE</span><span class="keyword">, </span><span class="default">$fp</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="52844">  
  <a class="name">
  <strong class="user"><em>samlowry at e-baka dot net</em></strong></a><div class="date" title="2005-05-14 06:09"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom52844">
<div class="phpcode"><code><span class="html">
About CURLOPT_ENCODING:
<br>added in curl in 7.10 - Oct 1 2002
<br>In 7.10.5 - May 19 2003 syntax was chnaged:
<br>"setting CURLOPT_ENCODING to "" automaticly enables all supported encodings"</span>
</code></div>
  </div>
 </div>
  <div class="note" id="52675">  
  <a class="name">
  <strong class="user"><em>ikendra at yken dot nospam dot org</em></strong></a><div class="date" title="2005-05-09 09:26"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom52675">
<div class="phpcode"><code><span class="html">
Using cURL, I needed to call a third-party script which was returning binary data as attachment to pass on retrieved data again as attachment.
<br>
<br>Problem was that the third-party script occassionally returned HTTP errors and I wanted to avoid passing on zero-length attachment in such case.
<br>
<br>Combination of using CURLOPT_FAILONERROR and CURLOPT_HEADERFUNCTION callback helped to process the third-party script HTTP errors neatly:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">curlHeaderCallback</span><span class="keyword">(</span><span class="default">$resURL</span><span class="keyword">, </span><span class="default">$strHeader</span><span class="keyword">) {
<br>&nbsp; &nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^HTTP/i'</span><span class="keyword">, </span><span class="default">$strHeader</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="default">$strHeader</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Disposition: attachment; filename="file-name.zip"'</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; return </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$strHeader</span><span class="keyword">);
<br>}
<br>
<br></span><span class="default">$strURL </span><span class="keyword">= </span><span class="string">'<a rel="nofollow" target="_blank">http://www.example.com/script-whichs-dumps-binary-attachment.php</a>'</span><span class="keyword">;
<br>
<br></span><span class="default">$resURL </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$resURL</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$strURL</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$resURL</span><span class="keyword">, </span><span class="default">CURLOPT_BINARYTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$resURL</span><span class="keyword">, </span><span class="default">CURLOPT_HEADERFUNCTION</span><span class="keyword">, </span><span class="string">'curlHeaderCallback'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$resURL</span><span class="keyword">, </span><span class="default">CURLOPT_FAILONERROR</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>
<br></span><span class="default">curl_exec </span><span class="keyword">(</span><span class="default">$resURL</span><span class="keyword">);
<br>
<br></span><span class="default">$intReturnCode </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$resURL</span><span class="keyword">, </span><span class="default">CURLINFO_HTTP_CODE</span><span class="keyword">);
<br></span><span class="default">curl_close </span><span class="keyword">(</span><span class="default">$resURL</span><span class="keyword">);
<br>
<br>if (</span><span class="default">$intReturnCode </span><span class="keyword">!= </span><span class="default">200</span><span class="keyword">) {
<br>&nbsp; &nbsp; print </span><span class="string">'was error: ' </span><span class="keyword">. </span><span class="default">$intReturnCode</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97493">  
  <a class="name">
  <strong class="user"><em>sjungwirth at google mail dot com</em></strong></a><div class="date" title="2010-04-22 03:11"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97493">
<div class="phpcode"><code><span class="html">
I couldn't find a way to force a curl request to go to a particular IP address, but you can do it with fsockopen:
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; $ip </span><span class="keyword">= </span><span class="string">'123.45.67.89'</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fsockopen</span><span class="keyword">(</span><span class="default">$ip</span><span class="keyword">, </span><span class="default">80</span><span class="keyword">, </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br>&nbsp; &nbsp; if (!</span><span class="default">$fp</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"</span><span class="default">$errstr</span><span class="string"> (</span><span class="default">$errno</span><span class="string">)&lt;br /&gt;\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; } else {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="string">"GET /path/to/the/file.ext HTTP/1.1\r\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"Host: www.exampl.com\r\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"Connection: Close\r\n\r\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$out</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">.= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">128</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br></span><span class="default">?&gt;
<br></span>I needed it to test the response from a set of servers behind a load balancer.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96313">  
  <a class="name">
  <strong class="user"><em>starosielec at googlemail dot com</em></strong></a><div class="date" title="2010-02-19 03:07"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96313">
<div class="phpcode"><code><span class="html">
You can use also use object methods as callback functions. This is usefull if your curl ressource is part of an object handling transfers.
<br>Instead of curl_setopt($curl, CURLOPT_WRITEFUNCTION, "curl_handler_recv") you can use array($object, "method") as value for callback options.
<br>
<br>For example:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">class </span><span class="default">downloader </span><span class="keyword">{
<br>&nbsp; &nbsp; private </span><span class="default">$curl</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; function </span><span class="default">__construct</span><span class="keyword">() {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">curl </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">curl</span><span class="keyword">, </span><span class="default">CURLOPT_WRITEFUNCTION</span><span class="keyword">, array(</span><span class="default">$this</span><span class="keyword">, </span><span class="string">"curl_handler_recv"</span><span class="keyword">));
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp;&nbsp; function </span><span class="default">curl_handler_recv</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; </span><span class="comment">//...
<br>&nbsp; &nbsp;&nbsp; </span><span class="keyword">}
<br>&nbsp;&nbsp; </span><span class="comment">//... 
<br></span><span class="keyword">}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="92522">  
  <a class="name">
  <strong class="user"><em>Sylvain R</em></strong></a><div class="date" title="2009-07-28 03:05"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom92522">
<div class="phpcode"><code><span class="html">
When you are using CURLOPT_FILE to download directly into a file you must close the file handler after the curl_close() otherwise the file will be incomplete and you will not be able to use it until the end of the execution of the php process.
<br>
<br><span class="default">&lt;?php
<br>
<br>$fh </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/tmp/foo'</span><span class="keyword">, </span><span class="string">'w'</span><span class="keyword">);
<br></span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://example.com/foo</a>'</span><span class="keyword">);
<br></span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FILE</span><span class="keyword">, </span><span class="default">$fh</span><span class="keyword">);
<br></span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br></span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br></span><span class="comment"># at this point your file is not complete and corrupted
<br>
<br></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);
<br>
<br></span><span class="comment"># now you can use your file;
<br>
<br></span><span class="default">read_file</span><span class="keyword">(</span><span class="string">'/tmp/foo'</span><span class="keyword">);
<br>
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="42201">  
  <a class="name">
  <strong class="user"><em>ron at ttvavanti dot nl</em></strong></a><div class="date" title="2004-05-07 08:00"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom42201">
<div class="phpcode"><code><span class="html">
If you specify a CAINFO, note that the file must be in PEM format! (If not, it won't work).<br>Using Openssl you can use: <br>openssl x509 -in &lt;cert&gt; -inform d -outform PEM -out cert.pem <br>To create a pem formatted certificate from a binary certificate (the one you get if you download the ca somewhere).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="41256">  
  <a class="name">
  <strong class="user"><em>Jakub Horky &lt;jakub dot php at horky dot net&gt;</em></strong></a><div class="date" title="2004-04-04 01:20"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom41256">
<div class="phpcode"><code><span class="html">
A bit more documentation (without minimum version numbers):<br><br>- CURLOPT_WRITEFUNCTION<br>- CURLOPT_HEADERFUNCTION<br>&nbsp; Pass a function which will be called to write data or headers respectively. The callback function prototype:<br><br>long write_callback (resource ch, string data)<br><br>The ch argument is CURL session handle. The data argument is data received. Note that its size is variable. When writing data, as much data as possible will be returned in all invokes. When writing headers, exactly one complete header line is returned for better parsing.<br>The function must return number of bytes actually taken care of. If that amount differs from the amount passed to this function, an error will occur.<br><br>- CURLOPT_READFUNCTION<br>&nbsp; Pass a function which will be called to read data. The callback function prototype:<br><br>string read_callback (resource ch, resource fd, long length)<br><br>The ch argument is CURL session handle. The fd argument is file descriptor passed to CURL by CURLOPT_INFILE option. The length argument is maximum length which can be returned.<br>The function must return string containing the data which were read. If length of the data is more than maximum length, it will be truncated to maximum length. Returning anything else than a string means an EOF.<br><br>[Note: there is more callbacks implemented in current cURL library but they aren't unfortunately implemented in php curl interface yet.]</span>
</code></div>
  </div>
 </div>
  <div class="note" id="37530">  
  <a class="name">
  <strong class="user"><em>tim dot php at ebw dot ca</em></strong></a><div class="date" title="2003-11-18 06:18"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom37530">
<div class="phpcode"><code><span class="html">
The page <a rel="nofollow" target="_blank">http://curl.haxx.se/libcurl/c/curl_easy_setopt.html</a> at the cURL site has a list of all the CURLOPTS, including many not mentioned here. Also see <a rel="nofollow" target="_blank">http://curl.haxx.se/libcurl/php/examples/</a> for cURL examples in PHP.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84902">  
  <a class="name">
  <strong class="user"><em>jID</em></strong></a><div class="date" title="2008-08-05 04:56"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84902">
<div class="phpcode"><code><span class="html">
if you use<br><span class="default">&lt;?php<br>curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_INTERFACE</span><span class="keyword">, </span><span class="string">"XXX.XXX.XXX.XXX"</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>to specify IP adress for request, sometimes you need to get list of all your IP's.<br><br>ifconfig command will output something like:<br><br>rl0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500<br>&nbsp; &nbsp; options=8&lt;VLAN_MTU&gt;<br>&nbsp; &nbsp; inet 82.146.XXX.XXX netmask 0xffffffff broadcast 82.146.XXX.XXX<br>&nbsp; &nbsp; inet 78.24.XXX.XXX netmask 0xffffffff broadcast 78.24.XXX.XXX<br>&nbsp; &nbsp; inet 82.146.XXX.XXX netmask 0xffffffff broadcast 82.146.XXX.XXX<br>&nbsp; &nbsp; inet 82.146.XXX.XXX netmask 0xffffffff broadcast 82.146.XXX.XXX<br>&nbsp; &nbsp; inet 82.146.XXX.XXX netmask 0xffffffff broadcast 82.146.XXX.XXX<br>&nbsp; &nbsp; inet 78.24.XXX.XXX netmask 0xffffffff broadcast 78.24.XXX.XXX<br>&nbsp; &nbsp; inet 78.24.XXX.XXX netmask 0xffffffff broadcast 78.24.XXX.XXX<br>&nbsp; &nbsp; ether XX:XX:XX:XX:XX:XX<br>&nbsp; &nbsp; media: Ethernet autoselect (100baseTX &lt;full-duplex&gt;)<br>&nbsp; &nbsp; status: active<br>lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 16384<br>tun0: flags=8051&lt;UP,POINTOPOINT,RUNNING,MULTICAST&gt; mtu 1500<br>&nbsp; &nbsp; Opened by PID 564<br>tun1: flags=8051&lt;UP,POINTOPOINT,RUNNING,MULTICAST&gt; mtu 1500<br>&nbsp; &nbsp; Opened by PID 565<br>&nbsp; &nbsp; Opened by PID 565<br><br>My solution for FreeBSD 6 and PHP 5 was:<br><span class="default">&lt;?php<br>&nbsp; ob_start</span><span class="keyword">();<br>&nbsp; </span><span class="default">$ips</span><span class="keyword">=array();<br>&nbsp; </span><span class="default">$ifconfig</span><span class="keyword">=</span><span class="default">system</span><span class="keyword">(</span><span class="string">"ifconfig"</span><span class="keyword">);<br>&nbsp; echo </span><span class="default">$ifconfig</span><span class="keyword">;<br>&nbsp; </span><span class="default">$ifconfig</span><span class="keyword">=</span><span class="default">ob_get_contents</span><span class="keyword">();<br>&nbsp; </span><span class="default">ob_end_clean</span><span class="keyword">();<br>&nbsp; </span><span class="default">$ifconfig</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="default">chr</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">), </span><span class="default">$ifconfig</span><span class="keyword">);<br>&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$ifconfig</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; </span><span class="default">$t</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">, </span><span class="default">$ifconfig</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br>&nbsp; &nbsp; if (</span><span class="default">$t</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]==</span><span class="string">"\tinet"</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$ips</span><span class="keyword">, </span><span class="default">$t</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br>&nbsp; &nbsp; }&nbsp; &nbsp;&nbsp; <br>&nbsp; }<br>&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$ips</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; echo </span><span class="default">$ips</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="string">"\n"</span><span class="keyword">;<br>&nbsp; }<br></span><span class="default">?&gt;<br></span><br>You will get list of IP adresses in $ips array, like:<br>82.146.XXX.XXX<br>78.24.XXX.XXX<br>82.146.XXX.XXX<br>82.146.XXX.XXX<br>82.146.XXX.XXX<br>78.24.XXX.XXX<br>78.24.XXX.XXX</span>
</code></div>
  </div>
 </div>
  <div class="note" id="33773">  
  <a class="name">
  <strong class="user"><em>eric at imap dot ch</em></strong></a><div class="date" title="2003-07-07 09:38"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom33773">
<div class="phpcode"><code><span class="html">
I managed to use curl to retrieve information from severs on ports other than 80 or 443 (for https) on some installations but not on all. 
<br>If you get an "CURLE_COULDNT_CONNECT /* 7 */" error, try adding the port : (for example)
<br>
<br><span class="default">&lt;?php curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_PORT</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SERVER_PORT'</span><span class="keyword">]); </span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84277">  
  <a class="name">
  <strong class="user"><em>nick at glype dot com</em></strong></a><div class="date" title="2008-07-07 09:18"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84277">
<div class="phpcode"><code><span class="html">
Although CURLOPT_CLOSEPOLICY and the applicable choices are valid constants, setting this option with curl_setopt() always returns false. A quick google search suggests the option is deprecated and/or never worked.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="32040">  
  <a class="name">
  <strong class="user"><em>me</em></strong></a><div class="date" title="2003-05-14 09:36"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom32040">
<div class="phpcode"><code><span class="html">
Just a reminder: When setting your CURLOPT_POSTFIELDS remember to replace the spaces in your values with %20</span>
</code></div>
  </div>
 </div>
  <div class="note" id="24709">  
  <a class="name">
  <strong class="user"><em>paul at zgtec dot com</em></strong></a><div class="date" title="2002-08-26 02:31"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom24709">
<div class="phpcode"><code><span class="html">
To make a POST in multipart/form-data mode 
<br>this worked for me, the " \n" at the end of the variables was very important on my OS X server.
<br>
<br><span class="default">&lt;?php
<br>
<br>$file </span><span class="keyword">= </span><span class="string">"file_to_upload.txt"</span><span class="keyword">;
<br></span><span class="default">$submit_url </span><span class="keyword">= </span><span class="string">"<a rel="nofollow" target="_blank">http://www.example.com/upload_page.php</a>"</span><span class="keyword">;
<br>
<br></span><span class="default">$formvars </span><span class="keyword">= array(</span><span class="string">"cc"</span><span class="keyword">=&gt;</span><span class="string">"us \n"</span><span class="keyword">);
<br></span><span class="default">$formvars</span><span class="keyword">[</span><span class="default">variable_1</span><span class="keyword">] = </span><span class="string">"bla bla \n"</span><span class="keyword">;
<br></span><span class="default">$formvars</span><span class="keyword">[</span><span class="default">variable_2</span><span class="keyword">] = </span><span class="string">"bla bla \n"</span><span class="keyword">;
<br></span><span class="default">$formvars</span><span class="keyword">[</span><span class="default">variable_3</span><span class="keyword">] = </span><span class="string">"bla bla \n"</span><span class="keyword">;
<br></span><span class="default">$formvars</span><span class="keyword">[</span><span class="default">variable_4</span><span class="keyword">] = </span><span class="string">"bla bla \n"</span><span class="keyword">;
<br></span><span class="default">$formvars</span><span class="keyword">[</span><span class="default">upfile</span><span class="keyword">] = </span><span class="string">"@</span><span class="default">$file</span><span class="string">"</span><span class="keyword">; </span><span class="comment">// "@" causes cURL to send as file and not string (I believe) 
<br>
<br>&nbsp; &nbsp; // init curl handle
<br>&nbsp; &nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="default">$submit_url</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEJAR</span><span class="keyword">, </span><span class="string">"my_cookies.txt"</span><span class="keyword">);&nbsp; </span><span class="comment">//initiates cookie file if needed
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_COOKIEFILE</span><span class="keyword">, </span><span class="string">"my_cookies.txt"</span><span class="keyword">);&nbsp; </span><span class="comment">// Uses cookies from previous session if exist
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_REFERER</span><span class="keyword">, </span><span class="string">"<a rel="nofollow" target="_blank">http://www.example.net</a>"</span><span class="keyword">);&nbsp; </span><span class="comment">//if server needs to think this post came from elsewhere
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_VERBOSE</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">); </span><span class="comment">// follow redirects recursively
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_POSTFIELDS</span><span class="keyword">, </span><span class="default">$formvars</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; </span><span class="comment">// perform post
<br>&nbsp; &nbsp; </span><span class="keyword">echo </span><span class="default">$pnp_result_page </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">curl_close </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="75711">  
  <a class="name">
  <strong class="user"><em>mcbreen at gmail dot com</em></strong></a><div class="date" title="2007-06-12 02:35"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom75711">
<div class="phpcode"><code><span class="html">
If you are getting the following error:
<br>
<br>SSL: certificate subject name 'example.com' does not match target host name 'example.net'
<br>
<br>Then you can set the following option to get around it:
<br>
<br><span class="default">&lt;?php curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_SSL_VERIFYHOST</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">); </span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="75693">  
  <a class="name">
  <strong class="user"><em>vincent at ludden dot nl</em></strong></a><div class="date" title="2007-06-12 01:55"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom75693">
<div class="phpcode"><code><span class="html">
Please note that the CURLOPT_INTERFACE setting only accepts IP addresses and hostnames of the local machine. It is not meant to send a URL to a specific IP address.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="10692">  
  <a class="name">
  <strong class="user"><em>dan dot polansky at seznam dot cz</em></strong></a><div class="date" title="2001-01-17 02:31"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom10692">
<div class="phpcode"><code><span class="html">
I used to download www pages to my script and one of the pages was different in MS explorer and different, when I downloaded it. Namely, information, I was really interested in was missing. That was because the server on the other bank of the river was looking at who is downloading the page. Everything got fixed when I pretended I was MSIE. It is done with curl. Here is a function, that you may use in similar situation
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">download_pretending</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">$user_agent</span><span class="keyword">) {
<br>&nbsp;&nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();
<br>&nbsp;&nbsp; </span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);
<br>&nbsp;&nbsp; </span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_USERAGENT</span><span class="keyword">, </span><span class="default">$user_agent</span><span class="keyword">);
<br>&nbsp;&nbsp; </span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br>&nbsp;&nbsp; </span><span class="default">curl_setopt </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">curl_exec </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); 
<br>&nbsp;&nbsp; </span><span class="default">curl_close </span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);
<br>&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57988">  
  <a class="name">
  <strong class="user"><em>webmaster () stauceni.com</em></strong></a><div class="date" title="2005-10-20 01:42"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom57988">
<div class="phpcode"><code><span class="html">
A little mistake, that took a half-day to fix it:<br>When specifing CURLOPT_COOKIEFILE or CURLOPT_COOKIEJAR options, don't forget to "chmod 777" that directory where cookie-file must be created.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="56086">  
  <a class="name">
  <strong class="user"><em>mcknight at chek dot com</em></strong></a><div class="date" title="2005-08-22 08:10"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom56086">
<div class="phpcode"><code><span class="html">
when specifing the file for either CURLOPT_COOKIEFILE or CURLOPT_COOKIEJAR you may need to use the full file path instead of just the relative path.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85275">  
  <a class="name">
  <strong class="user"><em>George</em></strong></a><div class="date" title="2008-08-22 05:14"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom85275">
<div class="phpcode"><code><span class="html">
If you set CURLOPT_RESUME_FROM to resume the file, and then reuse the same Curl handle to download another file, you must reset the resume status by calling curl_setopt( $ch, CURLOPT_RESUME_FROM, 0 ). It will not reset, and will apply to all subsequent transfers even if the URL is the same.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="20410">  
  <a class="name">
  <strong class="user"><em>tychay at alumni dot caltech dot edu</em></strong></a><div class="date" title="2002-04-03 01:14"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom20410">
<div class="phpcode"><code><span class="html">
CURLOPT_HTTPHEADER is NOT like the -H command line switch. The command line switch adds or replaces headers (much like the header() line in PHP, but for HTTP clients instead of servers), but the curl extension will eliminate the headers cURL sends by default.<br><br>For instance, your Authorization, Host, Referer, Pragma, and Accept headers which are normally written by default or by other CURLOPT_*'s.<br><br>Also, it might seem intuitive that this should accept an array hash of header-&gt;values, but this is not the case. It accepts an array of strings of the format "Header: Value", much like the -H command-line switch.<br><br>Hope this helps,<br><br>terry</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.curl-setopt.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:59:24 GMT -->


</body></html>