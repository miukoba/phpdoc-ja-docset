<html><!-- Mirrored from php.net/manual/en/function.mhash.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:16:55 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>mhash</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.mhash.html">
 <link rel="shorturl" href="http://php.net/mhash">
 <link rel="alternate" href="http://php.net/mhash" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.mhash.html">
 <link rel="prev" href="function.mhash-keygen-s2k.html">
 <link rel="next" href="book.openssl.html">

 <link rel="alternate" href="function.mhash.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.mhash.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.mhash.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.mhash.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.mhash.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.mhash.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.mhash.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.mhash.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.mhash.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.mhash.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.mhash.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.crypto.html">Cryptography Extensions</a></li>      <li><a href="book.mhash.html">Mhash</a></li>      <li><a href="ref.mhash.html">Mhash Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.mhash" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mhash</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mhash</span> â€” <span class="dc-title">Computes hash</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.mhash-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>mhash</strong></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$hash</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$key</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>mhash()</strong></span> applies a hash function specified by
   <code class="parameter">hash</code> to the <code class="parameter">data</code>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mhash-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">hash</code></dt>

     <dd>

      <p class="para">
       The hash ID. One of the <strong><code>MHASH_hashname</code></strong> constants.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">data</code></dt>

     <dd>

      <p class="para">
       The user input, as a string.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">key</code></dt>

     <dd>

      <p class="para">
       If specified, the function will return the resulting HMAC instead.
       HMAC is keyed hashing for message authentication, or simply a message
       digest that depends on the specified key. Not all algorithms 
       supported in mhash can be used in HMAC mode.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mhash-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the resulting hash (also called digest) or HMAC as a string, or
   <strong><code>FALSE</code></strong> on error.
  </p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="115236">  
  <a class="name">
  <strong class="user"><em>jeremy s</em></strong></a><div class="date" title="2014-06-18 04:39"><strong>2 months ago</strong></div>
  <div class="text" id="Hcom115236">
<div class="phpcode"><code><span class="html">
Here is how to compute a NTLM hash:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">ntlm_hash</span><span class="keyword">(</span><span class="default">$txt</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$txt </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'UTF-16LE'</span><span class="keyword">, </span><span class="default">$txt</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$md4 </span><span class="keyword">= </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">mhash</span><span class="keyword">(</span><span class="default">MHASH_MD4</span><span class="keyword">, </span><span class="default">$txt</span><span class="keyword">));<br><br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">$md4</span><span class="keyword">);<br>}<br><br>echo </span><span class="default">ntlm_hash</span><span class="keyword">(</span><span class="string">'ClearTextPasswd'</span><span class="keyword">);<br>echo </span><span class="string">"\n"</span><span class="keyword">;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109249">  
  <a class="name">
  <strong class="user"><em>holdoffhunger at gmail dot com</em></strong></a><div class="date" title="2012-06-29 11:52"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom109249">
<div class="phpcode"><code><span class="html">
The MHash function here lists one disclaimer at the top when providing a key to the mhash function : "Not all algorithms supported in mhash can be used in HMAC mode."&nbsp; So, what algorithms blow up and what do fine when it comes to doing keyed, HMAC hashing?&nbsp; The destructive ones are: Adler32, CRC32, CRC32B, and GOST.&nbsp; These are the first four, predefined constants listed with the MHash Application Package: <a rel="nofollow" target="_blank">http://www.php.net/manual/en/mhash.constants.php</a> .&nbsp; Providing one of these algorithms with an HMAC key (of string-length greater than one) creates the following error message: "Warning: mhash() [function.mhash]: mhash initialization failed in [(folder-location)] on line 181".&nbsp; If you really want to use these algorithms in creating your HMAC hashes, the function Hash_hmac() from the HASH-Message Digest Framework package is capable of doing that perfectly.<br><br>Again, that is if the string length is greater than one.&nbsp; Why string length greater than one?&nbsp; Well, if the key value is blank, it is ignored as a parameter altogether.&nbsp; So, if you feed the mhash function an algorithm that is not compatible with HMAC hashing and an HMAC key that's blank (""), it will work the same as if it had received no HMAC key at all.&nbsp; This is different from the way the Hash_hmac() function of the HASH-MDF works.&nbsp; In the case of the Hash_hmac() function, feeding a blank HMAC key will use that blank key in generating the HMAC hash.&nbsp; Even with functions that can do HMAC hashing, like MD5 or SHA1, if the MHash() is given a blank HMAC key, it will ignore the key and just return the results of standard, non-HMAC hashing.&nbsp; It's probably not wise to use a blank HMAC key anyway, but it's good to know that the hashing algorithm changes altogether if the provided HMAC key is blank.<br><br>Some sample code to demonstrate :<br><br><span class="default">&lt;?php<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Author: holdoffhunger@gmail.com<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; // Preset Data<br>&nbsp; &nbsp; &nbsp; &nbsp; // ---------------------------------------------------<br><br>&nbsp; &nbsp; </span><span class="default">$string_to_hash </span><span class="keyword">= </span><span class="string">"The hash_hmac() function better to use for these purposes."</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$blank_hmac_key </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// MHash - Hashing With and Without HMAC Parameter<br>&nbsp; &nbsp; &nbsp; &nbsp; // ---------------------------------------------------<br><br>&nbsp; &nbsp; </span><span class="default">$mhash_result_with_hmac_parameter </span><span class="keyword">= </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">mhash</span><span class="keyword">(</span><span class="default">MHASH_CRC32</span><span class="keyword">, </span><span class="default">$string_to_hash</span><span class="keyword">, </span><span class="default">$blank_hmac_key</span><span class="keyword">));<br>&nbsp; &nbsp; </span><span class="default">$mhash_result_without_hmac_parameter </span><span class="keyword">= </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">mhash</span><span class="keyword">(</span><span class="default">MHASH_CRC32</span><span class="keyword">, </span><span class="default">$string_to_hash</span><span class="keyword">));<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// MHash - Hashing With and Without HMAC Parameter<br>&nbsp; &nbsp; &nbsp; &nbsp; // ---------------------------------------------------<br><br>&nbsp; &nbsp; </span><span class="default">$hash_result_with_hmac_parameter </span><span class="keyword">= </span><span class="default">hash_hmac</span><span class="keyword">(</span><span class="string">"crc32"</span><span class="keyword">, </span><span class="default">$string_to_hash</span><span class="keyword">, </span><span class="default">$blank_hmac_key</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$hash_result_without_hmac_parameter </span><span class="keyword">= </span><span class="default">hash</span><span class="keyword">(</span><span class="string">"crc32"</span><span class="keyword">, </span><span class="default">$string_to_hash</span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Print Results<br>&nbsp; &nbsp; &nbsp; &nbsp; // ---------------------------------------------------<br><br>&nbsp; &nbsp; </span><span class="keyword">print(</span><span class="string">"MHASH (CRC32 Algorithm) With Blank HMAC Key: </span><span class="default">$mhash_result_with_hmac_parameter</span><span class="string"> .&lt;br&gt;"</span><span class="keyword">);<br>&nbsp; &nbsp; print(</span><span class="string">"MHASH (CRC32 Algorithm) Without HMAC Processing: </span><span class="default">$mhash_result_without_hmac_parameter</span><span class="string"> .&lt;br&gt;&lt;br&gt;"</span><span class="keyword">);<br><br>&nbsp; &nbsp; print(</span><span class="string">"HASH (CRC32 Algorithm) With Blank HMAC Key: </span><span class="default">$hash_result_with_hmac_parameter</span><span class="string"> .&lt;br&gt;"</span><span class="keyword">);<br>&nbsp; &nbsp; print(</span><span class="string">"HASH (CRC32 Algorithm) Without HMAC Processing: </span><span class="default">$hash_result_without_hmac_parameter</span><span class="string"> ."</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>&nbsp; &nbsp; Results :<br>&nbsp; &nbsp; ...................................<br><br>MHASH (CRC32 Algorithm) With Blank HMAC Key: f665c094 .<br>MHASH (CRC32 Algorithm) Without HMAC Processing: f665c094 .<br><br>HASH (CRC32 Algorithm) With Blank HMAC Key: 3041f4f8 .<br>HASH (CRC32 Algorithm) Without HMAC Processing: f665c094 .</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109227">  
  <a class="name">
  <strong class="user"><em>holdoffhunger at gmail dot com</em></strong></a><div class="date" title="2012-06-27 07:27"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom109227">
<div class="phpcode"><code><span class="html">
Both cryptography packages, the MHash and the HASH Message Digest Framework, have the same algorithms, and yet, they both sometimes to produce wildly different results from each other when applying the same algorithm to the same piece of data.&nbsp; The SHA-x algorithms, as designed by the NSA, all seem to have concrete standards for producing their hash values, so they have similar results.&nbsp; Even the two MD5 implementations produce identical results, and the same goes for Gost, RipeMD, CRC32, Whirlpool, Snefru256 (known as 'Snefru256' in MHash and simply 'Snefru' in HASH-MDF), and Tiger (the three-round versions in HASH-MDF to simply 'Tigerx' in MHash).<br><br>However, the algorithms CRC32B and Adler32 each produce different results when called from either MHash or HASH-MDF, possibly because they are hashing algorithms designed to be checksums rather than something that can produce a string as a unique identifier for a particular piece of information.&nbsp; For that reason, if you ever publish the hash results with the data you're putting out publicly, it's probably wise to indicate whether it's the MHash or HASH-MDF implementation of the algorithm.&nbsp; Otherwise, the hash value won't provide much use as a unique identifier for the particular piece of data or for the file.<br><br>Some example code to better explain what I mean :<br><br><span class="default">&lt;?php<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Author: holdoffhunger@gmail.com<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; // SHA-1 Hashing<br>&nbsp; &nbsp; &nbsp; &nbsp; // ---------------------------------------------------<br><br>&nbsp; &nbsp; </span><span class="default">$mhash_sha1_results </span><span class="keyword">= </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">mhash</span><span class="keyword">(</span><span class="default">MHASH_SHA1</span><span class="keyword">, </span><span class="string">"secret"</span><span class="keyword">));<br>&nbsp; &nbsp; </span><span class="default">$hash_mdf_sha1_results </span><span class="keyword">= </span><span class="default">hash</span><span class="keyword">(</span><span class="string">"sha1"</span><span class="keyword">, </span><span class="string">"secret"</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);<br><br>&nbsp; &nbsp; print(</span><span class="string">"MHash SHA-1: </span><span class="default">$mhash_sha1_results</span><span class="string"> .&lt;br&gt;"</span><span class="keyword">);<br>&nbsp; &nbsp; print(</span><span class="string">"HASH-MDF SHA-1: </span><span class="default">$hash_mdf_sha1_results</span><span class="string"> .&lt;br&gt;&lt;br&gt;"</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Whirlpool Hashing<br>&nbsp; &nbsp; &nbsp; &nbsp; // ---------------------------------------------------<br><br>&nbsp; &nbsp; </span><span class="default">$mhash_whirlpool_results </span><span class="keyword">= </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">mhash</span><span class="keyword">(</span><span class="default">MHASH_WHIRLPOOL</span><span class="keyword">, </span><span class="string">"secret"</span><span class="keyword">));<br>&nbsp; &nbsp; </span><span class="default">$hash_mdf_whirlpool_results </span><span class="keyword">= </span><span class="default">hash</span><span class="keyword">(</span><span class="string">"whirlpool"</span><span class="keyword">, </span><span class="string">"secret"</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);<br><br>&nbsp; &nbsp; print(</span><span class="string">"MHash Whirlpool: </span><span class="default">$mhash_whirlpool_results</span><span class="string"> .&lt;br&gt;"</span><span class="keyword">);<br>&nbsp; &nbsp; print(</span><span class="string">"HASH-MDF Whirlpool: </span><span class="default">$hash_mdf_whirlpool_results</span><span class="string"> .&lt;br&gt;&lt;br&gt;"</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// CRC32B Hashing<br>&nbsp; &nbsp; &nbsp; &nbsp; // ---------------------------------------------------<br><br>&nbsp; &nbsp; </span><span class="default">$mhash_crc32b_results </span><span class="keyword">= </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">mhash</span><span class="keyword">(</span><span class="default">MHASH_CRC32B</span><span class="keyword">, </span><span class="string">"secret"</span><span class="keyword">));<br>&nbsp; &nbsp; </span><span class="default">$hash_mdf_crc32b_results </span><span class="keyword">= </span><span class="default">hash</span><span class="keyword">(</span><span class="string">"crc32b"</span><span class="keyword">, </span><span class="string">"secret"</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);<br><br>&nbsp; &nbsp; print(</span><span class="string">"MHash CRC32B: </span><span class="default">$mhash_crc32b_results</span><span class="string"> .&lt;br&gt;"</span><span class="keyword">);<br>&nbsp; &nbsp; print(</span><span class="string">"HASH-MDF CRC32B: </span><span class="default">$hash_mdf_crc32b_results</span><span class="string"> .&lt;br&gt;&lt;br&gt;"</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Adler32 Hashing<br>&nbsp; &nbsp; &nbsp; &nbsp; // ---------------------------------------------------<br><br>&nbsp; &nbsp; </span><span class="default">$mhash_adler32_results </span><span class="keyword">= </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">mhash</span><span class="keyword">(</span><span class="default">MHASH_ADLER32</span><span class="keyword">, </span><span class="string">"secret"</span><span class="keyword">));<br>&nbsp; &nbsp; </span><span class="default">$hash_mdf_adler32_results </span><span class="keyword">= </span><span class="default">hash</span><span class="keyword">(</span><span class="string">"adler32"</span><span class="keyword">, </span><span class="string">"secret"</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);<br><br>&nbsp; &nbsp; print(</span><span class="string">"MHash Adler32: </span><span class="default">$mhash_adler32_results</span><span class="string"> .&lt;br&gt;"</span><span class="keyword">);<br>&nbsp; &nbsp; print(</span><span class="string">"HASH-MDF Adler32: </span><span class="default">$hash_mdf_adler32_results</span><span class="string"> .&lt;br&gt;&lt;br&gt;"</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>&nbsp; &nbsp; Expected Results :<br>&nbsp; &nbsp; ........................<br><br>MHash SHA-1: e5e9fa1ba31ecd1ae84f75caaa474f3a663f05f4 .<br>HASH-MDF SHA-1: e5e9fa1ba31ecd1ae84f75caaa474f3a663f05f4 .<br><br>MHash Whirlpool: e061b87a674ae3880e159ab55ed35d<br>6c5e8a6aefac6ab08304a50588018d<br>377b28639bb15fdeedf006d57e45f7<br>b4298e6dfefceaf7c92c826a708fe6d<br>1156eb3 .<br><br>HASH-MDF Whirlpool: e061b87a674ae3880e159ab55ed35d<br>6c5e8a6aefac6ab08304a50588018d<br>377b28639bb15fdeedf006d57e45f7<br>b4298e6dfefceaf7c92c826a708fe6d<br>1156eb3 .<br><br>MHash CRC32B: e5e8a25c .<br>HASH-MDF CRC32B: 5ca2e8e5 .<br><br>MHash Adler32: 8702d108 .<br>HASH-MDF Adler32: 08d10287 .</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88335">  
  <a class="name">
  <strong class="user"><em>hm2k at php dot net</em></strong></a><div class="date" title="2009-01-20 07:16"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88335">
<div class="phpcode"><code><span class="html">
mhash support now appears in the Pear PHP_Compat package, for support without building PHP with mhash.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53571">  
  <a class="name">
  <strong class="user"><em>marcel446 at yahoo dot com</em></strong></a><div class="date" title="2005-06-06 04:15"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom53571">
<div class="phpcode"><code><span class="html">
Just in case you did not observe, the function of Lance is independent of hash fuction used to get HMAC , so if one use sha1() function from php instead md5() will get sha1 HMAC.<br>Just try .<br>Thanks again Lance</span>
</code></div>
  </div>
 </div>
  <div class="note" id="51086">  
  <a class="name">
  <strong class="user"><em>robbie [at] averill [dot] co [dot] nz</em></strong></a><div class="date" title="2005-03-18 05:17"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom51086">
<div class="phpcode"><code><span class="html">
This confused me a bit when I first read the documetation for mhash. The functions that accept a hash accept them as an INTEGER not a STRING. In this case, MHASH_MD5 = 1. It is a constant, not a string.<br><br>Just thought I'd point that out, so if anyone is confused they can read that. That's the use of mhash_get_hash_name(). You input the constant (which is an integer) and it returns the hash name.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="47076">  
  <a class="name">
  <strong class="user"><em>fernan at ispwest dot com</em></strong></a><div class="date" title="2004-11-02 12:03"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47076">
<div class="phpcode"><code><span class="html">
Thanks a lot to Lance for showing how to create mhash without installing the perl extension for mhash.<br><br>I have been asking my webhosting administrator to recompile Perl with mhash extension, but do not want to do it. As a result, our company can't get credit card authorization because they require fingerprint which uses the function mhash. Now, it's working fine.<br><br>Thanks a lot, Lance.....<br><br>Fernan</span>
</code></div>
  </div>
 </div>
  <div class="note" id="43762">  
  <a class="name">
  <strong class="user"><em>jerry d0t wilborn at fast d0t net</em></strong></a><div class="date" title="2004-07-02 09:36"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom43762">
<div class="phpcode"><code><span class="html">
in responce to lance's post:<br><br>the function comes back with a hex representation of the hmac, if you wish to convert to what mhash returns natively (binary) use:&nbsp; pack("H*", hmac(variables...));</span>
</code></div>
  </div>
 </div>
  <div class="note" id="33872">  
  <a class="name">
  <strong class="user"><em>lance_rushing at hot* spamfree *mail dot com</em></strong></a><div class="date" title="2003-07-09 05:02"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom33872">
<div class="phpcode"><code><span class="html">
Don't forget php has two built in hashing algorithms:<br><br>md5(), and sha1()<br><br>So if you are using: mhash(MHASH_MD5, $str) or mhash(MHASH_SHA1, $str) you could use md5($str) or sha1($str).<br><br>** But remember that md5() and sha1() produce HEX output while mhash() produces a BIN output.&nbsp; So:<br><br>md5($str) == bin2hex(mhash(MHASH_MD5, $str))<br>sha1($str) == bin2hex(mhash(MHASH_SHA1, $str))<br><br>AND<br><br>pack("H*", md5($str)) == mhash(MHASH_MD5, $str)<br>pack("H*", sha1($str)) == mhash(MHASH_SHA1, $str)<br><br>(Just remember to pack() or bin2hex() your output to get the output you need)<br><br>-Lance</span>
</code></div>
  </div>
 </div>
  <div class="note" id="27225">  
  <a class="name">
  <strong class="user"><em>lance_rushing at hot* spamfree *mail dot com</em></strong></a><div class="date" title="2002-11-27 08:36"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom27225">
<div class="phpcode"><code><span class="html">
Want to Create a md5 HMAC, but don't have hmash installed?<br><br>Use this:<br><br>function hmac ($key, $data)<br>{<br>&nbsp; &nbsp; // RFC 2104 HMAC implementation for php.<br>&nbsp; &nbsp; // Creates an md5 HMAC.<br>&nbsp; &nbsp; // Eliminates the need to install mhash to compute a HMAC<br>&nbsp; &nbsp; // Hacked by Lance Rushing<br><br>&nbsp; &nbsp; $b = 64; // byte length for md5<br>&nbsp; &nbsp; if (strlen($key) &gt; $b) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $key = pack("H*",md5($key));<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; $key&nbsp; = str_pad($key, $b, chr(0x00));<br>&nbsp; &nbsp; $ipad = str_pad('', $b, chr(0x36));<br>&nbsp; &nbsp; $opad = str_pad('', $b, chr(0x5c));<br>&nbsp; &nbsp; $k_ipad = $key ^ $ipad ;<br>&nbsp; &nbsp; $k_opad = $key ^ $opad;<br><br>&nbsp; &nbsp; return md5($k_opad&nbsp; . pack("H*",md5($k_ipad . $data)));<br>}<br><br>-----<br>To test:<br>Run this on a server _with_ mhash installed:<br><br>$key = 'Jefe';<br>$data = "what do ya want for nothing?";<br>echo hmac($key, $data);<br>echo "&amp;lt;br&amp;gt;\n";<br>echo bin2hex (mhash(MHASH_MD5, $data, $key));<br><br>should produce:<br><br>750c783e6ab0b503eaa86e310a5db738<br>750c783e6ab0b503eaa86e310a5db738<br><br>Happy hashing.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="17843">  
  <a class="name">
  <strong class="user"><em>luc at 2113 dot ch</em></strong></a><div class="date" title="2001-12-28 05:42"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom17843">
<div class="phpcode"><code><span class="html">
Netscape messaging / directory server 4+ uses SHA-1 
<br>to store password in the ldap database (slapd).
<br>The password is first SHA-1 hashed then base64 encoded:
<br>
<br>$pwd = "secret";
<br>$hash = "{SHA}".base64_encode( mHash(MHASH_SHA1, $pwd));
<br>echo "Hash: ". $hash ;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="17385">  
  <a class="name">
  <strong class="user"><em>paulj at 5emedia dot net</em></strong></a><div class="date" title="2001-12-06 10:02"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom17385">
<div class="phpcode"><code><span class="html">
Many digest algorithms (especially MD5) are less secure if you are hashing data that is smaller than the algorithm's output.&nbsp; I recommend either hashing a secret key/salt with the original data to increase it's security.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="72746">  
  <a class="name">
  <strong class="user"><em>numien(at)deathwyrm(dot)com</em></strong></a><div class="date" title="2007-01-31 05:21"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom72746">
<div class="phpcode"><code><span class="html">
---Quote---<br>pack("H*", md5($str)) == mhash(MHASH_MD5, $str)<br>pack("H*", sha1($str)) == mhash(MHASH_SHA1, $str)<br>---/Quote---<br><br>That's an awfully inefficient way of doing things. You can just put ", true" after md5 or sha1 to get binary output instead of having it convert it to hex then back.<br><br>Easier way:<br>md5($str, true) == mhash(MHASH_MD5, $str)<br>sha1($str, true) == mhash(MHASH_SHA1, $str)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="24598">  
  <a class="name">
  <strong class="user"><em>shimon_d at hotmail dot com</em></strong></a><div class="date" title="2002-08-22 12:05"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom24598">
<div class="phpcode"><code><span class="html">
password security:<br>when you hash passwords to save them in cookie , url ,etc' my sugsession is to hash them with date <br>becouse of evry body can view server log or any other loged info and reuse the hash<br><br>ie.: to re call a url eg. admin.php?user=root&amp;passhash=5rft346tert<br>in this example the password keepped in secret but what stopping me to reuse the url<br><br>hash("secret") // bad security<br>hash("secret".date("Ymg")) // better security<br>// the hash good only for today</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.mhash.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:16:56 GMT -->


</body></html>