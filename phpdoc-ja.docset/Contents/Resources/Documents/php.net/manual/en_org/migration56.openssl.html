<html><!-- Mirrored from php.net/manual/en/migration56.openssl.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:55:02 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>OpenSSL changes in PHP 5.6.x</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="migration56.openssl.html">
 <link rel="shorturl" href="migration56.openssl.html">
 <link rel="alternate" href="migration56.openssl.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="migration56.html">
 <link rel="prev" href="migration56.new-functions.html">
 <link rel="next" href="migration56.extensions.html">

 <link rel="alternate" href="migration56.openssl.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/migration56.openssl.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/migration56.openssl.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/migration56.openssl.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/migration56.openssl.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/migration56.openssl.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/migration56.openssl.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/migration56.openssl.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/migration56.openssl.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/migration56.openssl.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/migration56.openssl.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="appendices.html">Appendices</a></li>      <li><a href="migration56.html">Migrating from PHP 5.5.x to PHP 5.6.x</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="migration56.openssl" class="sect1">
 <h2 class="title">OpenSSL changes in PHP 5.6.x</h2>

 <div class="sect2" id="migration56.openssl.peer-verification">
  <h3 class="title">Stream wrappers now verify peer certificates and host names by default when using SSL/TLS</h3>

  
   <p class="para">
    All encrypted client streams now enable peer verification by default. By
    default, this will use OpenSSL's default CA bundle to verify the peer
    certificate. In most cases, no changes will need to be made to communicate
    with servers with valid SSL certificates, as distributors generally
    configure OpenSSL to use known good CA bundles.
   </p>
   
   <p class="para">
    The default CA bundle may be overridden on a global basis by setting
    either the openssl.cafile or openssl.capath configuration setting, or on a
    per request basis by using the
    <a href="context.ssl.html#context.ssl.cafile" class="link"><code class="parameter">cafile</code></a> or
    <a href="context.ssl.html#context.ssl.capath" class="link"><code class="parameter">capath</code></a>
    context options.
   </p>

   <p class="para">
    While not recommended in general, it is possible to disable peer
    certificate verification for a request by setting the
    <a href="context.ssl.html#context.ssl.verify-peer" class="link"><code class="parameter">verify_peer</code></a>
    context option to <strong><code>FALSE</code></strong>, and to disable peer name validation by setting
    the
    <code class="parameter">verify_peer_name</code>
    
    context option to <strong><code>FALSE</code></strong>.
   </p>

 </div>

 <div class="sect2" id="migration56.openssl.fingerprint">
  <h3 class="title">Certificate fingerprints</h3>

  <p class="para">
   Support has been added for extracting and verifying certificate
   fingerprints. <span class="function"><a href="function.openssl-x509-fingerprint.html" class="function">openssl_x509_fingerprint()</a></span> has been added
   to extract a fingerprint from an X.509 certificate, and two
   <a href="context.ssl.html" class="link">SSL stream context</a> options have been
   added: <em>capture_peer_cert</em> to capture the peer's X.509
   certificate, and <em>peer_fingerprint</em> to assert that the
   peer's certificate should match the given fingerprint.
  </p>
 </div>

 <div class="sect2" id="migration56.openssl.ciphers">
  <h3 class="title">Default ciphers updated</h3>

  <p class="para">
   The default ciphers used by PHP have been updated to a more secure list
   based on the
   <a href="https://wiki.mozilla.org/Security/Server_Side_TLS#Recommended_Ciphersuite" class="link external">»&nbsp;Mozilla cipher recommendations</a>,
   with two additional exclusions: anonymous Diffie-Hellman ciphers, and RC4.
  </p>

  <p class="para">
   This list can be accessed via the new
   <strong><code>OPENSSL_DEFAULT_STREAM_CIPHERS</code></strong> constant, and can be
   overridden (as in previous PHP versions) by setting the
   <a href="context.ssl.html#context.ssl.ciphers" class="link"><code class="parameter">ciphers</code></a>
   context option.
  </p>
 </div>

 <div class="sect2" id="migration56.openssl.tls-compression">
  <h3 class="title">Compression disabled by default</h3>

  <p class="para">
   SSL/TLS compression has been disabled by default to mitigate the CRIME
   attack. PHP 5.4.13 added a
   <a href="context.ssl.html#context.ssl.disable-compression" class="link"><code class="parameter">disable_compression</code></a>
   context option to allow compression to be disabled: this is now set to
   <strong><code>TRUE</code></strong> (that is, compression is disabled) by default.
  </p>
 </div>

 <div class="sect2" id="migration56.openssl.honor-cipher-order">
  <h3 class="title">Allow servers to prefer their cipher order</h3>

  <p class="para">
   The <code class="parameter">honor_cipher_order</code> SSL context option has been
   added to allow encrypted stream servers to mitigate BEAST vulnerabilities
   by preferring the server's ciphers to the client's.
  </p>
 </div>

 <div class="sect2" id="migration56.openssl.metadata">
  <h3 class="title">Access the negotiated protocol and cipher</h3>

  <p class="para">
   The protocol and cipher that were negotiated for an encrypted stream can
   now be accessed via <span class="function"><a href="function.stream-get-meta-data.html" class="function">stream_get_meta_data()</a></span> or
   <span class="function"><a href="function.stream-context-get-options.html" class="function">stream_context_get_options()</a></span> when the
   <code class="parameter">capture_session_meta</code> SSL context option is set to
   <strong><code>TRUE</code></strong>.
  </p>

  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$ctx&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_context_create</span><span style="color: #007700">([</span><span style="color: #DD0000">'ssl'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'capture_session_meta'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">TRUE<br></span><span style="color: #007700">]]);<br>&nbsp;<br></span><span style="color: #0000BB">$html&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'https://google.com/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">FALSE</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$ctx</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$meta&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_context_get_options</span><span style="color: #007700">(</span><span style="color: #0000BB">$ctx</span><span style="color: #007700">)[</span><span style="color: #DD0000">'ssl'</span><span style="color: #007700">][</span><span style="color: #DD0000">'session_meta'</span><span style="color: #007700">];<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$meta</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <p class="para">The above example will output:</p>
   <div class="example-contents screen">
<div class="cdata"><pre>array(4) {
  ["protocol"]=&gt;
  string(5) "TLSv1"
  ["cipher_name"]=&gt;
  string(20) "ECDHE-RSA-AES128-SHA"
  ["cipher_bits"]=&gt;
  int(128)
  ["cipher_version"]=&gt;
  string(11) "TLSv1/SSLv3"
}
</pre></div>
   </div>
  </div>
 </div>

 <div class="sect2" id="migration56.openssl.forward-secrecy">
  <h3 class="title">New options for perfect forward secrecy in encrypted stream servers</h3>

  <p class="para">
   Encrypted client streams already support perfect forward secrecy, as it is
   generally controlled by the server. PHP encrypted server streams using
   certificates capable of perfect forward secrecy do not need to take any
   additional action to enable PFS; however a number of new SSL context options
   have been added to allow more control over PFS and deal with any
   compatibility issues that may arise. 
  </p>

  <dl>

   
    <dt>
<code class="parameter">ecdh_curve</code></dt>

    <dd>

     <p class="para">
      This option allows the selection of a specific curve for use with ECDH
      ciphers. If not specified, <em>prime256v1</em> will be used.
     </p>
    </dd>

   
   
    <dt>
<code class="parameter">dh_param</code></dt>

    <dd>

     <p class="para">
      A path to a file containing parametrs for Diffie-Hellman key exchange,
      such as that created by the following command:
     </p>
     <div class="example-contents">
<div class="shellcode"><pre class="shellcode">openssl dhparam -out /path/to/my/certs/dh-2048.pem 2048</pre>
</div>
     </div>

    </dd>

   
   
    <dt>
<code class="parameter">single_dh_use</code></dt>

    <dd>

     <p class="para">
      If set to <strong><code>TRUE</code></strong>, a new key pair will be created when using
      Diffie-Hellman parameters, thereby improving forward secrecy.
     </p>
    </dd>

   
   
    <dt>
<code class="parameter">single_ecdh_use</code></dt>

    <dd>

     <p class="para">
      If set to <strong><code>TRUE</code></strong>, a new key pair will always be generated when ECDH
      cipher suites are negotiated. This improves forward secrecy.
     </p>
    </dd>

   
  </dl>

 </div>

 <div class="sect2" id="migration56.openssl.crypto-method">
  <h3 class="title">SSL/TLS version selection</h3>

  <p class="para">
   It is now possible to select specific versions of SSL and TLS via the
   <code class="parameter">crypto_method</code> SSL context option or by specifying a
   specific transport when creating a stream wrapper (for example, by calling
   <span class="function"><a href="function.stream-socket-client.html" class="function">stream_socket_client()</a></span> or
   <span class="function"><a href="function.stream-socket-server.html" class="function">stream_socket_server()</a></span>).
  </p>

  <p class="para">
   The <code class="parameter">crypto_method</code> SSL context option accepts a
   bitmask enumerating the protocols that are permitted, as does the
   <code class="parameter">crypto_type</code> of
   <span class="function"><a href="function.stream-socket-enable-crypto.html" class="function">stream_socket_enable_crypto()</a></span>.
   
  </p>

  <table class="segmentedlist">
   <caption><strong>Selected protocol versions and corresponding options</strong></caption>
   <thead><tr><th>Protocol(s)</th>
   <th>Client flag</th>
   <th>Server flag</th>
   <th>Transport</th>
   </tr></thead><tbody><tr class="seglistitem">
    <td class="seg">Any TLS or SSL version</td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_ANY_CLIENT</code></strong></td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_ANY_SERVER</code></strong></td>
    <td class="seg"><em>ssl://</em></td>
   </tr>
   <tr class="seglistitem">
    <td class="seg">Any TLS version</td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_TLS_CLIENT</code></strong></td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_TLS_SERVER</code></strong></td>
    <td class="seg"><em>tls://</em></td>
   </tr>
   <tr class="seglistitem">
    <td class="seg">TLS 1.0</td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_TLSv_1_0_CLIENT</code></strong></td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_TLSv_1_0_SERVER</code></strong></td>
    <td class="seg"><em>tlsv1.0://</em></td>
   </tr>
   <tr class="seglistitem">
    <td class="seg">TLS 1.1</td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_TLSv_1_1_CLIENT</code></strong></td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_TLSv_1_1_SERVER</code></strong></td>
    <td class="seg"><em>tlsv1.1://</em></td>
   </tr>
   <tr class="seglistitem">
    <td class="seg">TLS 1.2</td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_TLSv_1_2_CLIENT</code></strong></td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_TLSv_1_2_SERVER</code></strong></td>
    <td class="seg"><em>tlsv1.2://</em></td>
   </tr>
   <tr class="seglistitem">
    <td class="seg">SSL 3</td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_SSLv3_CLIENT</code></strong></td>
    <td class="seg"><strong><code>STREAM_CRYPTO_METHOD_SSLv3_SERVER</code></strong></td>
    <td class="seg"><em>sslv3://</em></td>
   </tr>
  </tbody></table>

  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br></span><span style="color: #FF8000">//&nbsp;Requiring&nbsp;TLS&nbsp;1.0&nbsp;or&nbsp;better&nbsp;when&nbsp;using&nbsp;file_get_contents():<br></span><span style="color: #0000BB">$ctx&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_context_create</span><span style="color: #007700">([<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'ssl'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'crypto_method'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">STREAM_CRYPTO_METHOD_TLS_CLIENT</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;],<br>]);<br></span><span style="color: #0000BB">$html&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'https://google.com/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$ctx</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;Requiring&nbsp;TLS&nbsp;1.1&nbsp;or&nbsp;1.2:<br></span><span style="color: #0000BB">$ctx&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_context_create</span><span style="color: #007700">([<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'ssl'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'crypto_method'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">STREAM_CRYPTO_METHOD_TLSv_1_1_CLIENT&nbsp;</span><span style="color: #007700">|<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">STREAM_CRYPTO_METHOD_TLSv_1_2_CLIENT</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;],<br>]);<br></span><span style="color: #0000BB">$html&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'https://google.com/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$ctx</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;Connecting&nbsp;using&nbsp;the&nbsp;tlsv1.2://&nbsp;stream&nbsp;socket&nbsp;transport.<br></span><span style="color: #0000BB">$sock&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_socket_client</span><span style="color: #007700">(</span><span style="color: #DD0000">'tlsv1.2://google.com:443/'</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div>

 <div class="sect2" id="migration56.openssl.default-certificate-paths">
  <h3 class="title"><span class="function"><a href="function.openssl-get-cert-locations.html" class="function">openssl_get_cert_locations()</a></span> added</h3>

  <p class="para">
   The <span class="function"><a href="function.openssl-get-cert-locations.html" class="function">openssl_get_cert_locations()</a></span> function has been
   added: it returns the default locations PHP will search when looking for
   CA bundles.
  </p>

  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">openssl_get_cert_locations</span><span style="color: #007700">());<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <p class="para">The above example will output:</p>
   <div class="example-contents screen">
<div class="cdata"><pre>array(8) {
  ["default_cert_file"]=&gt;
  string(21) "/etc/pki/tls/cert.pem"
  ["default_cert_file_env"]=&gt;
  string(13) "SSL_CERT_FILE"
  ["default_cert_dir"]=&gt;
  string(18) "/etc/pki/tls/certs"
  ["default_cert_dir_env"]=&gt;
  string(12) "SSL_CERT_DIR"
  ["default_private_dir"]=&gt;
  string(20) "/etc/pki/tls/private"
  ["default_default_cert_area"]=&gt;
  string(12) "/etc/pki/tls"
  ["ini_cafile"]=&gt;
  string(0) ""
  ["ini_capath"]=&gt;
  string(0) ""
}
</pre></div>
   </div>
  </div>
 </div>

 <div class="sect2" id="migration56.openssl.spki">
  <h3 class="title">SPKI support</h3>

  <p class="para">
   Support has been added for generating, extracting and verifying signed
   public key and challenges (SPKAC). <span class="function"><a href="function.openssl-spki-new.html" class="function">openssl_spki_new()</a></span>,
   <span class="function"><a href="function.openssl-spki-verify.html" class="function">openssl_spki_verify()</a></span>,
   <span class="function"><a href="function.openssl-spki-export-challenge.html" class="function">openssl_spki_export_challenge()</a></span>, and
   <span class="function"><a href="function.openssl-spki-export.html" class="function">openssl_spki_export()</a></span> have been added to create, verify
   export PEM public key and associated challenge from SPKAC's generated from
   a <em>KeyGen</em> HTML5 element.
  </p>

  <dl>

   
    <dt>
<code class="parameter">openssl_spki_new</code></dt>

    <dd>

     <p class="para">
      Generates a new SPKAC using private key, challenge string and hashing
      algorithm.
     </p>

     <div class="informalexample">
      <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$pkey&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_pkey_new</span><span style="color: #007700">();<br></span><span style="color: #0000BB">openssl_pkey_export</span><span style="color: #007700">(</span><span style="color: #0000BB">$pkey</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'secret&nbsp;passphrase'</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$spkac&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_spki_new</span><span style="color: #007700">(</span><span style="color: #0000BB">$pkey</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'challenge&nbsp;string'</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
      </div>

      <p class="para">The above example will output:</p>
      <div class="example-contents screen">
<div class="cdata"><pre>SPKAC=MIIBXjCByDCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEA3L0IfUijj7+A8CPC8EmhcdNoe5fUAog7OrBdhn7EkxFButUp40P7+LiYiygYG1TmoI/a5EgsLU3s9twEz3hmgY9mYIqb/rb+SF8qlD/K6KVyUORC7Wlz1Df4L8O3DuRGzx6/+3jIW6cPBpfgH1sVuYS1vDBsP/gMMIxwTsKJ4P0CAwEAARYkYjViMzYxMTktNjY5YS00ZDljLWEyYzctMGZjNGFhMjVlMmE2MA0GCSqGSIb3DQEBAwUAA4GBAF7hu0ifzmjonhAak2FhhBRsKFDzXdKIkrWxVNe8e0bZzMrWOxFM/rqBgeH3/gtOUDRS5Fnzyq425UsTYbjfiKzxGeCYCQJb1KJ2V5Ij/mIJHZr53WYEXHQTNMGR8RPm7IxwVXVSHIgAfXsXZ9IXNbFbcaLRiSTr9/N4U+MXUWL7
</pre></div>
      </div>
     </div>
    </dd>

   

   
    <dt>
<code class="parameter">openssl_spki_verify</code></dt>

    <dd>

     <p class="para">
      Verifies provided SPKAC.
     </p>

     <div class="informalexample">
      <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$pkey&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_pkey_new</span><span style="color: #007700">();<br></span><span style="color: #0000BB">openssl_pkey_export</span><span style="color: #007700">(</span><span style="color: #0000BB">$pkey</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'secret&nbsp;passphrase'</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$spkac&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_spki_new</span><span style="color: #007700">(</span><span style="color: #0000BB">$pkey</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'challenge&nbsp;string'</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">openssl_spki_verify</span><span style="color: #007700">(</span><span style="color: #0000BB">$spkac</span><span style="color: #007700">));<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
      </div>

     </div>
    </dd>

   

   
    <dt>
<code class="parameter">openssl_spki_export_challenge</code></dt>

    <dd>

     <p class="para">
      Exports associated challenge from provided SPKAC.
     </p>

     <div class="informalexample">
      <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$pkey&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_pkey_new</span><span style="color: #007700">();<br></span><span style="color: #0000BB">openssl_pkey_export</span><span style="color: #007700">(</span><span style="color: #0000BB">$pkey</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'secret&nbsp;passphrase'</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$spkac&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_spki_new</span><span style="color: #007700">(</span><span style="color: #0000BB">$pkey</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'challenge&nbsp;string'</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$challenge&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_spki_export_challenge</span><span style="color: #007700">(</span><span style="color: #0000BB">$spkac</span><span style="color: #007700">):<br>echo&nbsp;</span><span style="color: #0000BB">$challenge</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
      </div>

      <p class="para">The above example will output:</p>
      <div class="example-contents screen">
<div class="cdata"><pre>challenge string
</pre></div>
      </div>
     </div>
    </dd>

   

   
    <dt>
<code class="parameter">openssl_spki_export</code></dt>

    <dd>

     <p class="para">
      Exports the PEM formatted RSA public key from SPKAC.
     </p>

     <div class="informalexample">
      <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$pkey&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_pkey_new</span><span style="color: #007700">();<br></span><span style="color: #0000BB">openssl_pkey_export</span><span style="color: #007700">(</span><span style="color: #0000BB">$pkey</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'secret&nbsp;passphrase'</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$spkac&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">openssl_spki_new</span><span style="color: #007700">(</span><span style="color: #0000BB">$pkey</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'challenge&nbsp;string'</span><span style="color: #007700">);<br>echo&nbsp;</span><span style="color: #0000BB">openssl_spki_export</span><span style="color: #007700">(</span><span style="color: #0000BB">$spkac</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
      </div>

      <p class="para">The above example will output:</p>
      <div class="example-contents screen">
<div class="cdata"><pre>-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDcvQh9SKOPv4DwI8LwSaFx02h7
l9QCiDs6sF2GfsSTEUG61SnjQ/v4uJiLKBgbVOagj9rkSCwtTez23ATPeGaBj2Zg
ipv+tv5IXyqUP8ropXJQ5ELtbXPUN/gvw7cO5EbPHr/7eMhbpw8Gl+AfWxW5hLW8
MGw/+AwwjHBOwong/QIDAQAB
-----END PUBLIC KEY-----
</pre></div>
      </div>
     </div>
    </dd>

   
  </dl>

 </div>
</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div>
 <div class="note">There are no user contributed notes for this page.</div></section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/migration56.openssl.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:55:03 GMT -->


</body></html>