<html><!-- Mirrored from php.net/manual/en/migration51.references.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:55:31 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Changes in reference handling</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="migration51.references.html">
 <link rel="shorturl" href="migration51.references.html">
 <link rel="alternate" href="migration51.references.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="migration51.html">
 <link rel="prev" href="migration51.changes.html">
 <link rel="next" href="migration51.reading.html">

 <link rel="alternate" href="migration51.references.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/migration51.references.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/migration51.references.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/migration51.references.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/migration51.references.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/migration51.references.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/migration51.references.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/migration51.references.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/migration51.references.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/migration51.references.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/migration51.references.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="appendices.html">Appendices</a></li>      <li><a href="migration51.html">Migrating from PHP 5.0.x to PHP 5.1.x</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="migration51.references" class="section">
  <h2 class="title">Changes in reference handling</h2>
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     <a href="migration51.references.html#migration51.references-overview" class="link">Overview</a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="migration51.references.html#migration51.references-fails" class="link">Code that worked under PHP
      4.3.x, but now fails</a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="migration51.references.html#migration51.references-error" class="link">Code that worked under PHP
      4.3.x, but now throws an error</a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="migration51.references.html#migration51.references-works" class="link">Code that failed under PHP
      4.3.x, but now works</a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="migration51.references.html#migration51.references-didnotwork" class="link">Code that
      should have worked under PHP 5.0.x</a>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="migration51.references.html#migration51.references-warnings" class="link">Warnings that came and
      went</a>
    </p>
   </li>
  </ul>

  <div class="section" id="migration51.references-overview">
   <h2 class="title">Overview</h2>
   <p class="para">
    From the PHP script writer's point of view, the change most likely to
    impact legacy code is in the way that references are handled in all PHP
    versions post-dating the PHP 4.4.0 release.
   </p>
   <p class="para">
    Until and including PHP 4.3, it was possible to send, assign or return
    variables by reference that should really be returned by value, such as
    a constant, a temporary value (e.g. the result of an expression), or the
    result of a function that had itself been returned by value, as here:
   </p>
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$foo&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"123"</span><span style="color: #007700">;<br><br>function&nbsp;</span><span style="color: #0000BB">return_value</span><span style="color: #007700">()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$foo</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$foo</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #0000BB">$bar&nbsp;</span><span style="color: #007700">=&nbsp;&amp;</span><span style="color: #0000BB">return_value</span><span style="color: #007700">();<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <p class="para">
    Although this code would usually work as expected under PHP 4.3, in the
    general case the result is undefined. The Zend Engine could not act
    correctly on these values as references. This bug could and did lead to
    various hard-to-reproduce memory corruption problems, particularly
    where the code base was large.
   </p>
   <p class="para">
    In PHP 4.4.0, PHP 5.0.4 and all subsequent PHP releases, the Engine was
    fixed to 'know' when the reference operation is being used on a value
    that should not be referenced. The actual value is now used in such
    cases, and a warning is emitted. The warning takes the form of an
    <strong><code>E_NOTICE</code></strong> in PHP 4.4.0 and up, and
    <strong><code>E_STRICT</code></strong> in PHP 5.0.4 and up.
   </p>
   <p class="para">
    Code that could potentially produce memory corruption can no longer do
    so. However, some legacy code might work differently as a result.
   </p>
  </div>

  <div class="section" id="migration51.references-fails">
   <h2 class="title">Code that worked under PHP 4.3, but now fails</h2>
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">func</span><span style="color: #007700">(&amp;</span><span style="color: #0000BB">$arraykey</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$arraykey</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;function&nbsp;returns&nbsp;by&nbsp;value!<br></span><span style="color: #007700">}<br><br></span><span style="color: #0000BB">$array&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'a'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'b'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'c'</span><span style="color: #007700">);<br>foreach&nbsp;(</span><span style="color: #0000BB">array_keys</span><span style="color: #007700">(</span><span style="color: #0000BB">$array</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$key</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">=&nbsp;&amp;</span><span style="color: #0000BB">func</span><span style="color: #007700">(</span><span style="color: #0000BB">$array</span><span style="color: #007700">[</span><span style="color: #0000BB">$key</span><span style="color: #007700">]);<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$z</span><span style="color: #007700">[]&nbsp;=&amp;&nbsp;</span><span style="color: #0000BB">$y</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$z</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;<br></span>&lt;</span>
</code></div>
    </div>

    <p class="para">
     Running the above script under any version of PHP that pre-dates the
     reference fix would produce this output:
    </p>
    <div class="example-contents screen">
<div class="cdata"><pre>array(3) {
  [0]=&gt;
  &amp;string(1) "a"
  [1]=&gt;
  &amp;string(1) "b"
  [2]=&gt;
  &amp;string(1) "c"
}
</pre></div>
    </div>
    <p class="para">
     Following the reference fix, the same code would result in:
    </p>
    <div class="example-contents screen">
<div class="cdata"><pre>array(3) {
  [0]=&gt;
  &amp;string(1) "c"
  [1]=&gt;
  &amp;string(1) "c"
  [2]=&gt;
  &amp;string(1) "c"
}
</pre></div>
    </div>
   </div>
   <p class="para">
    This is because, following the changes, <em>func()</em>
    assigns by value. The value of <var class="varname"><var class="varname">$y</var></var> is re-assigned,
    and reference-binding is preserved from <var class="varname"><var class="varname">$z</var></var>. Prior to
    the fix, the value was assigned by reference, leading <var class="varname"><var class="varname">$y</var></var>
    to be re-bound on each assignment. The attempt to bind to a temporary
    value by reference was the cause of the memory corruption.
   </p>
   <p class="para">
    Such code can be made to work identically in both the pre-fix and the
    post-fix PHP versions. The signature of <em>func()</em> can
    be altered to return by reference, or the reference assignment can be
    removed from the result of <em>func()</em>.
   </p>
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">func</span><span style="color: #007700">()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">'function&nbsp;return'</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'original&nbsp;value'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">=&amp;&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">=&nbsp;&amp;</span><span style="color: #0000BB">func</span><span style="color: #007700">();<br>echo&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <p class="para">
    In PHP 4.3 <var class="varname"><var class="varname">$x</var></var> would be 'original value', whereas after
    the changes it would be 'function return' - remember that where the
    function does not return by reference, the reference assignment is
    converted to a regular assignment. Again, this can be brought to a common
    base, either by forcing <em>func()</em> to return by reference
    or by eliminating the by-reference assignment.
   </p>
  </div>

  <div class="section" id="migration51.references-error">
   <h2 class="title">Code that worked under PHP 4.3.x, but now throws an error</h2>
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">Foo&nbsp;</span><span style="color: #007700">{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">getThis</span><span style="color: #007700">()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">destroyThis</span><span style="color: #007700">()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$baz&nbsp;</span><span style="color: #007700">=&amp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getThis</span><span style="color: #007700">();<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br></span><span style="color: #0000BB">$bar&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Foo</span><span style="color: #007700">();<br></span><span style="color: #0000BB">$bar</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">destroyThis</span><span style="color: #007700">();<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$bar</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <p class="para">
    In PHP 5.0.3, <var class="varname"><var class="varname">$bar</var></var> evaluated to <strong><code>NULL</code></strong>
    instead of returning an object. That happened because
    <em>getThis()</em> returns by value, but the value here is
    assigned by reference. Although it now works in the expected way, this is
    actually invalid code which will throw an <strong><code>E_NOTICE</code></strong>
    under PHP 4.4 or an <strong><code>E_STRICT</code></strong> under PHP 5.0.4 and up.
   </p>
  </div>

  <div class="section" id="migration51.references-works">
   <h2 class="title">Code that failed under PHP 4.3.x, but now works</h2>
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">function&nbsp;&amp;</span><span style="color: #0000BB">f</span><span style="color: #007700">()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"foo"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$x</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$x</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;return(</span><span style="color: #0000BB">$a</span><span style="color: #007700">);<br>}<br><br>for&nbsp;(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$h&nbsp;</span><span style="color: #007700">=&nbsp;&amp;</span><span style="color: #0000BB">f</span><span style="color: #007700">();<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <p class="para">
     In PHP 4.3 the third call to <span class="function"><a href="function.var-dump.html" class="function">var_dump()</a></span> produces
     <strong><code>NULL</code></strong>, due to the memory corruption caused by
     returning an uninitialized value by reference. This is valid code
     in PHP 5.0.4 and up, but threw errors in earlier releases of PHP.
    </p>
   </div>
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$arr&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'a1'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'alfa'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'ok'</span><span style="color: #007700">));<br></span><span style="color: #0000BB">$arr&nbsp;</span><span style="color: #007700">=&amp;&nbsp;</span><span style="color: #0000BB">$arr</span><span style="color: #007700">[</span><span style="color: #DD0000">'a1'</span><span style="color: #007700">];<br>echo&nbsp;</span><span style="color: #DD0000">'-'</span><span style="color: #007700">.</span><span style="color: #0000BB">$arr</span><span style="color: #007700">[</span><span style="color: #DD0000">'alfa'</span><span style="color: #007700">].</span><span style="color: #DD0000">"-\n"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <p class="para">
     Until PHP 5.0.5, it wasn't possible to assign an array element by
     reference in this way. It now is.
    </p>
   </div>
  </div>

  <div class="section" id="migration51.references-didnotwork">
   <h2 class="title">Code that <em>should have worked</em> under PHP 5.0.x</h2>
   <p class="para">
    There are a couple of instances of bugs reported under PHP 5.0 prior to
    the reference fixes which now 'work'. However, in both cases errors are
    thrown by PHP 5.1.x, because the code was invalid in the first place.
    Returning values by reference using <em>self::</em> now works
    in the general case but throws an <strong><code>E_STRICT</code></strong> warning,
    and although your mileage may vary when assigning by reference to an
    overloaded object, you will still see an <strong><code>E_ERROR</code></strong>
    when you try it, even where the assignment itself appears to work.
   </p>
  </div>

  <div class="section" id="migration51.references-warnings">
   <h2 class="title">Warnings that came and went</h2>
   <p class="para">
    Nested calls to functions returning by reference are valid code under both
    PHP 4.3.x and PHP 5.1.x, but threw an unwarranted
    <strong><code>E_NOTICE</code></strong> or <strong><code>E_STRICT</code></strong> under the
    intervening PHP releases.
   </p>
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">function&nbsp;&amp;&nbsp;</span><span style="color: #0000BB">foo</span><span style="color: #007700">()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'ok'</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$var</span><span style="color: #007700">;<br>}<br><br>function&nbsp;&amp;&nbsp;</span><span style="color: #0000BB">bar</span><span style="color: #007700">()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">foo</span><span style="color: #007700">();<br>}<br><br></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&amp;&nbsp;</span><span style="color: #0000BB">bar</span><span style="color: #007700">();<br>echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$a</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </div>
 </div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div>
 <div class="note">There are no user contributed notes for this page.</div></section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/migration51.references.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:55:32 GMT -->


</body></html>