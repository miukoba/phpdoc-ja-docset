<html><!-- Mirrored from php.net/manual/en/ref.datetime.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:46:43 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Date/Time Functions</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="ref.datetime.html">
 <link rel="shorturl" href="http://php.net/datetime">
 <link rel="alternate" href="http://php.net/datetime" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="book.datetime.html">
 <link rel="prev" href="dateperiod.construct.html">
 <link rel="next" href="function.checkdate.html">

 <link rel="alternate" href="ref.datetime.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/ref.datetime.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/ref.datetime.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/ref.datetime.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/ref.datetime.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/ref.datetime.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/ref.datetime.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/ref.datetime.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/ref.datetime.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/ref.datetime.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/ref.datetime.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.calendar.html">Date and Time Related Extensions</a></li>      <li><a href="book.datetime.html">Date/Time</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="ref.datetime" class="reference">
 <h1 class="title">Date/Time Functions</h1>

 






















































































































































































































































  









































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.checkdate.html">checkdate</a> — Validate a Gregorian date</li><li><a href="function.date-add.html">date_add</a> — Alias of DateTime::add</li><li><a href="function.date-create-from-format.html">date_create_from_format</a> — Alias of DateTime::createFromFormat</li><li><a href="function.date-create-immutable-from-format.html">date_create_immutable_from_format</a> — Alias of DateTimeImmutable::createFromFormat</li><li><a href="function.date-create-immutable.html">date_create_immutable</a> — Alias of DateTimeImmutable::__construct</li><li><a href="function.date-create.html">date_create</a> — Alias of DateTime::__construct</li><li><a href="function.date-date-set.html">date_date_set</a> — Alias of DateTime::setDate</li><li><a href="function.date-default-timezone-get.html">date_default_timezone_get</a> — Gets the default timezone used by all date/time functions in a script</li><li><a href="function.date-default-timezone-set.html">date_default_timezone_set</a> — Sets the default timezone used by all date/time functions in a script</li><li><a href="function.date-diff.html">date_diff</a> — Alias of DateTime::diff</li><li><a href="function.date-format.html">date_format</a> — Alias of DateTime::format</li><li><a href="function.date-get-last-errors.html">date_get_last_errors</a> — Alias of DateTime::getLastErrors</li><li><a href="function.date-interval-create-from-date-string.html">date_interval_create_from_date_string</a> — Alias of DateInterval::createFromDateString</li><li><a href="function.date-interval-format.html">date_interval_format</a> — Alias of DateInterval::format</li><li><a href="function.date-isodate-set.html">date_isodate_set</a> — Alias of DateTime::setISODate</li><li><a href="function.date-modify.html">date_modify</a> — Alias of DateTime::modify</li><li><a href="function.date-offset-get.html">date_offset_get</a> — Alias of DateTime::getOffset</li><li><a href="function.date-parse-from-format.html">date_parse_from_format</a> — Get info about given date formatted according to the specified format</li><li><a href="function.date-parse.html">date_parse</a> — Returns associative array with detailed info about given date</li><li><a href="function.date-sub.html">date_sub</a> — Alias of DateTime::sub</li><li><a href="function.date-sun-info.html">date_sun_info</a> — Returns an array with information about sunset/sunrise and twilight begin/end</li><li><a href="function.date-sunrise.html">date_sunrise</a> — Returns time of sunrise for a given day and location</li><li><a href="function.date-sunset.html">date_sunset</a> — Returns time of sunset for a given day and location</li><li><a href="function.date-time-set.html">date_time_set</a> — Alias of DateTime::setTime</li><li><a href="function.date-timestamp-get.html">date_timestamp_get</a> — Alias of DateTime::getTimestamp</li><li><a href="function.date-timestamp-set.html">date_timestamp_set</a> — Alias of DateTime::setTimestamp</li><li><a href="function.date-timezone-get.html">date_timezone_get</a> — Alias of DateTime::getTimezone</li><li><a href="function.date-timezone-set.html">date_timezone_set</a> — Alias of DateTime::setTimezone</li><li><a href="function.date.html">date</a> — Format a local time/date</li><li><a href="function.getdate.html">getdate</a> — Get date/time information</li><li><a href="function.gettimeofday.html">gettimeofday</a> — Get current time</li><li><a href="function.gmdate.html">gmdate</a> — Format a GMT/UTC date/time</li><li><a href="function.gmmktime.html">gmmktime</a> — Get Unix timestamp for a GMT date</li><li><a href="function.gmstrftime.html">gmstrftime</a> — Format a GMT/UTC time/date according to locale settings</li><li><a href="function.idate.html">idate</a> — Format a local time/date as integer</li><li><a href="function.localtime.html">localtime</a> — Get the local time</li><li><a href="function.microtime.html">microtime</a> — Return current Unix timestamp with microseconds</li><li><a href="function.mktime.html">mktime</a> — Get Unix timestamp for a date</li><li><a href="function.strftime.html">strftime</a> — Format a local time/date according to locale settings</li><li><a href="function.strptime.html">strptime</a> — Parse a time/date generated with strftime</li><li><a href="function.strtotime.html">strtotime</a> — Parse about any English textual datetime description into a Unix timestamp</li><li><a href="function.time.html">time</a> — Return current Unix timestamp</li><li><a href="function.timezone-abbreviations-list.html">timezone_abbreviations_list</a> — Alias of DateTimeZone::listAbbreviations</li><li><a href="function.timezone-identifiers-list.html">timezone_identifiers_list</a> — Alias of DateTimeZone::listIdentifiers</li><li><a href="function.timezone-location-get.html">timezone_location_get</a> — Alias of DateTimeZone::getLocation</li><li><a href="function.timezone-name-from-abbr.html">timezone_name_from_abbr</a> — Returns the timezone name from abbreviation</li><li><a href="function.timezone-name-get.html">timezone_name_get</a> — Alias of DateTimeZone::getName</li><li><a href="function.timezone-offset-get.html">timezone_offset_get</a> — Alias of DateTimeZone::getOffset</li><li><a href="function.timezone-open.html">timezone_open</a> — Alias of DateTimeZone::__construct</li><li><a href="function.timezone-transitions-get.html">timezone_transitions_get</a> — Alias of DateTimeZone::getTransitions</li><li><a href="function.timezone-version-get.html">timezone_version_get</a> — Gets the version of the timezonedb</li></ul>
</div>

<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="78570">  
  <a class="name">
  <strong class="user"><em>koch.ro</em></strong></a><div class="date" title="2007-10-17 12:42"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78570">
<div class="phpcode"><code><span class="html">
Not really elegant, but tells you, if your installed timezonedb is the most recent:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">class </span><span class="default">TestDateTimeTimezonedbVersion </span><span class="keyword">extends </span><span class="default">PHPUnit_Framework_TestCase
<br></span><span class="keyword">{
<br>&nbsp; &nbsp; public function </span><span class="default">testTimezonedbIsMostRecent</span><span class="keyword">()
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">ini_set</span><span class="keyword">( </span><span class="string">'date.timezone'</span><span class="keyword">, </span><span class="string">'Europe/Berlin' </span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">ob_start</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">phpinfo</span><span class="keyword">(</span><span class="default">INFO_MODULES</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">ob_get_contents</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">ob_end_clean</span><span class="keyword">(); 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$start </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$info</span><span class="keyword">, </span><span class="string">'Timezone Database Version' </span><span class="keyword">) + </span><span class="default">29</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">( </span><span class="default">FALSE </span><span class="keyword">!== </span><span class="default">$start</span><span class="keyword">, </span><span class="string">'Seems there is no timezone DB installed' </span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$end&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$info</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$start </span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$installedVersion </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$info</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">, </span><span class="default">$end </span><span class="keyword">- </span><span class="default">$start </span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">exec</span><span class="keyword">( </span><span class="string">'pecl remote-info timezonedb'</span><span class="keyword">, &amp;</span><span class="default">$output </span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$availableVersion </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$output</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">], </span><span class="default">12 </span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">( </span><span class="default">$availableVersion</span><span class="keyword">, </span><span class="default">$installedVersion</span><span class="keyword">, 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'The installed timezonedb is not actual. Installed: '</span><span class="keyword">.</span><span class="default">$installedVersion
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">.</span><span class="string">' available: '</span><span class="keyword">.</span><span class="default">$availableVersion
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57251">  
  <a class="name">
  <strong class="user"><em>andreencinas at yahoo dot com dot br</em></strong></a><div class="date" title="2005-09-28 05:08"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom57251">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//function like dateDiff Microsoft
<br>&nbsp; &nbsp; &nbsp;&nbsp; //not error in year Bissesto
<br>
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">dateDiff</span><span class="keyword">(</span><span class="default">$interval</span><span class="keyword">,</span><span class="default">$dateTimeBegin</span><span class="keyword">,</span><span class="default">$dateTimeEnd</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Parse about any English textual datetime
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //$dateTimeBegin, $dateTimeEnd
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dateTimeBegin</span><span class="keyword">=</span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$dateTimeBegin</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$dateTimeBegin </span><span class="keyword">=== -</span><span class="default">1</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(</span><span class="string">"..begin date Invalid"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dateTimeEnd</span><span class="keyword">=</span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$dateTimeEnd</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$dateTimeEnd </span><span class="keyword">=== -</span><span class="default">1</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(</span><span class="string">"..end date Invalid"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dif</span><span class="keyword">=</span><span class="default">$dateTimeEnd </span><span class="keyword">- </span><span class="default">$dateTimeBegin</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch(</span><span class="default">$interval</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">"s"</span><span class="keyword">:</span><span class="comment">//seconds
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return(</span><span class="default">$dif</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">"n"</span><span class="keyword">:</span><span class="comment">//minutes
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$dif</span><span class="keyword">/</span><span class="default">60</span><span class="keyword">)); </span><span class="comment">//60s=1m
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">case </span><span class="string">"h"</span><span class="keyword">:</span><span class="comment">//hours
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$dif</span><span class="keyword">/</span><span class="default">3600</span><span class="keyword">)); </span><span class="comment">//3600s=1h
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">case </span><span class="string">"d"</span><span class="keyword">:</span><span class="comment">//days
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$dif</span><span class="keyword">/</span><span class="default">86400</span><span class="keyword">)); </span><span class="comment">//86400s=1d
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">case </span><span class="string">"ww"</span><span class="keyword">:</span><span class="comment">//Week
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$dif</span><span class="keyword">/</span><span class="default">604800</span><span class="keyword">)); </span><span class="comment">//604800s=1week=1semana
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">case </span><span class="string">"m"</span><span class="keyword">: </span><span class="comment">//similar result "m" dateDiff Microsoft
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$monthBegin</span><span class="keyword">=(</span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">,</span><span class="default">$dateTimeBegin</span><span class="keyword">)*</span><span class="default">12</span><span class="keyword">)+
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">date</span><span class="keyword">(</span><span class="string">"n"</span><span class="keyword">,</span><span class="default">$dateTimeBegin</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$monthEnd</span><span class="keyword">=(</span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">,</span><span class="default">$dateTimeEnd</span><span class="keyword">)*</span><span class="default">12</span><span class="keyword">)+
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">date</span><span class="keyword">(</span><span class="string">"n"</span><span class="keyword">,</span><span class="default">$dateTimeEnd</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$monthDiff</span><span class="keyword">=</span><span class="default">$monthEnd</span><span class="keyword">-</span><span class="default">$monthBegin</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(</span><span class="default">$monthDiff</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">"yyyy"</span><span class="keyword">: </span><span class="comment">//similar result "yyyy" dateDiff Microsoft
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return(</span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">,</span><span class="default">$dateTimeEnd</span><span class="keyword">) - </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">,</span><span class="default">$dateTimeBegin</span><span class="keyword">));
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$dif</span><span class="keyword">/</span><span class="default">86400</span><span class="keyword">)); </span><span class="comment">//86400s=1d
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}
<br>
<br>&nbsp; &nbsp; &nbsp;&nbsp; }
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="10582">  
  <a class="name">
  <strong class="user"><em>th at definitynet dot com</em></strong></a><div class="date" title="2001-01-11 11:00"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom10582">
<div class="phpcode"><code><span class="html">
I had some problems with dates between mySQL and PHP.&nbsp; PHP had all these great date functions but I wanted to store a usable value in my database tables. In this case I was using TIMESTAMP(14)&nbsp; &lt;or 'YYYYMMDDHHMMSS'&gt;. 
<br>This is perhaps the easiest way I have found to pull the PHP usable UNIX Datestamp from my mySQL datestamp stored in the tables:
<br>
<br>Use the mySQL UNIX_TIMESTAMP() function in your SQL definition string. i.e.
<br>
<br>$sql= "SELECT field1, field2, UNIX_TIMESTAMP(field3) as your_date
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM your_table
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE field1 = '$value'";
<br>
<br>The query will return a temp table with coulms "field1" "Field2" "your_date"
<br>
<br>The "your_date" will be formatted in a UNIX TIMESTAMP!&nbsp; Now you can use the PHP date() function to spew out nice date formats.
<br>
<br>Sample using above $sql:
<br>20010111002747&nbsp; = Date Stored on mySQL table (TIMESTAMP(14))
<br>979172867&nbsp; = value returned as your_date in sql stmt (UNIX_TIMESTAMP)
<br>
<br>if we use $newdate = date("F jS, Y -- g:ia", $row["your_date"]);
<br>&nbsp;&nbsp; --(after fetching our array from the sql results of course)--
<br>
<br>echo "$newdate";&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; --Will produce:
<br>January 11th, 2001 -- 12:27am
<br>
<br>Hope this helps someone out there!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="72384">  
  <a class="name">
  <strong class="user"><em>bgold at matrix-consultants dot com</em></strong></a><div class="date" title="2007-01-16 05:08"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom72384">
<div class="phpcode"><code><span class="html">
When debugging code that stores date/time values in a database, you may find yourself wanting to know the date/time that corresponds to a given unix timestamp, or the timestamp for a given date &amp; time.
<br>
<br>The following script will do the conversion either way.&nbsp; If you give it a numeric timestamp, it will display the corresponding date and time.&nbsp; If you give it a date and time (in almost any standard format), it will display the timestamp.
<br>
<br>All conversions are done for your locale/time zone.
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">while (</span><span class="default">true</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Read a line from standard in.
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">echo </span><span class="string">"enter time to convert: "</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$inline </span><span class="keyword">= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">STDIN</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$inline </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$inline</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$inline </span><span class="keyword">== </span><span class="string">"" </span><span class="keyword">|| </span><span class="default">$inline </span><span class="keyword">== </span><span class="string">"."</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// See if the line is a date.
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$inline</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$pos </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// not a date, should be an integer.
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$date </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"m/d/Y G:i:s"</span><span class="keyword">, </span><span class="default">$inline</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"int2date: </span><span class="default">$inline</span><span class="string"> -&gt; </span><span class="default">$date</span><span class="string">\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$itime </span><span class="keyword">= </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$inline</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"date2int: </span><span class="default">$inline</span><span class="string"> -&gt; </span><span class="default">$itime</span><span class="string">\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="18643">  
  <a class="name">
  <strong class="user"><em>php-contrib at i-ps dot nospam dot net</em></strong></a><div class="date" title="2002-01-30 06:07"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom18643">
<div class="phpcode"><code><span class="html">
Someone may find this info of some use:<br><br>Rules for calculating a leap year:<br><br>1) If the year divides by 4, it is a leap year (1988, 1992, 1996 are leap years)<br>2) Unless it divides by 100, in which case it isn't (1900 divides by 4, but was not a leap year)<br>3) Unless it divides by 400, in which case it is actually a leap year afterall (So 2000 was a leap year).<br><br>In practical terms, to work out the number of days in X years, multiply X by 365.2425, rounding DOWN to the last whole number, should give you the number of days.<br><br>The result will never be more than one whole day inaccurate, as opposed to multiplying by 365, which, over more years, will create a larger and larger deficit.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="28121">  
  <a class="name">
  <strong class="user"><em>brighn (a) yahoo (.) com</em></strong></a><div class="date" title="2003-01-02 09:46"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom28121">
<div class="phpcode"><code><span class="html">
I needed a function that determined the last Sunday of the month. Since it's made for the website's "next meeting" announcement, it goes based on the system clock; also, if today is between Sunday and the end of the month, it figures out the last Sunday of *next* month. lastsunday() takes no arguments and returns the date as a string in the form "January 26, 2003". I could probably have streamlined this quite a bit, but at least it's transparent code. =)
<br>
<br><span class="default">&lt;?php
<br>&nbsp; </span><span class="comment">/* The two functions calculate when the next meeting will
<br>&nbsp; &nbsp;&nbsp; be, based on the assumption that the meeting will be on
<br>&nbsp; &nbsp;&nbsp; the last Sunday of the month. */&nbsp; 
<br>
<br>&nbsp; </span><span class="keyword">function </span><span class="default">getlast</span><span class="keyword">(</span><span class="default">$mon</span><span class="keyword">, </span><span class="default">$year</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$daysinmonth </span><span class="keyword">= array(</span><span class="default">31</span><span class="keyword">, </span><span class="default">28</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$days </span><span class="keyword">= </span><span class="default">$daysinmonth</span><span class="keyword">[</span><span class="default">$mon</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">];
<br>&nbsp; &nbsp; if (</span><span class="default">$mon </span><span class="keyword">== </span><span class="default">2 </span><span class="keyword">&amp;&amp; (</span><span class="default">$year </span><span class="keyword">% </span><span class="default">4</span><span class="keyword">) == </span><span class="default">0 </span><span class="keyword">&amp;&amp; ((</span><span class="default">$year </span><span class="keyword">% </span><span class="default">100</span><span class="keyword">) != </span><span class="default">0 </span><span class="keyword">||
<br>&nbsp; &nbsp; (</span><span class="default">$year </span><span class="keyword">% </span><span class="default">400</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">)) </span><span class="default">$days</span><span class="keyword">++;
<br>&nbsp; &nbsp; if (</span><span class="default">$mon </span><span class="keyword">== </span><span class="default">2 </span><span class="keyword">&amp;&amp; (</span><span class="default">$year </span><span class="keyword">% </span><span class="default">4</span><span class="keyword">) == </span><span class="default">0 </span><span class="keyword">&amp;&amp; (</span><span class="default">$year </span><span class="keyword">% </span><span class="default">1000</span><span class="keyword">) != </span><span class="default">0</span><span class="keyword">) </span><span class="default">$days</span><span class="keyword">++;
<br>&nbsp; &nbsp; </span><span class="default">$lastday </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$mon</span><span class="keyword">,</span><span class="default">$days</span><span class="keyword">,</span><span class="default">$year</span><span class="keyword">));
<br>&nbsp; &nbsp; </span><span class="default">$wday </span><span class="keyword">= </span><span class="default">$lastday</span><span class="keyword">[</span><span class="string">'wday'</span><span class="keyword">];
<br>&nbsp; &nbsp; return </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$mon</span><span class="keyword">,</span><span class="default">$days</span><span class="keyword">-</span><span class="default">$wday</span><span class="keyword">,</span><span class="default">$year</span><span class="keyword">));
<br>&nbsp; }
<br>
<br>&nbsp; function </span><span class="default">lastsunday</span><span class="keyword">() {
<br>&nbsp; &nbsp; </span><span class="default">$today </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">();
<br>&nbsp; &nbsp; </span><span class="default">$mon </span><span class="keyword">= </span><span class="default">$today</span><span class="keyword">[</span><span class="string">'mon'</span><span class="keyword">];
<br>&nbsp; &nbsp; </span><span class="default">$year </span><span class="keyword">= </span><span class="default">$today</span><span class="keyword">[</span><span class="string">'year'</span><span class="keyword">];
<br>&nbsp; &nbsp; </span><span class="default">$mday </span><span class="keyword">= </span><span class="default">$today</span><span class="keyword">[</span><span class="string">'mday'</span><span class="keyword">];
<br>&nbsp; &nbsp; </span><span class="default">$lastsun </span><span class="keyword">= </span><span class="default">getlast</span><span class="keyword">(</span><span class="default">$mon</span><span class="keyword">, </span><span class="default">$year</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$sunday </span><span class="keyword">= </span><span class="default">$lastsun</span><span class="keyword">[</span><span class="string">'mday'</span><span class="keyword">];
<br>&nbsp; &nbsp; if (</span><span class="default">$sunday </span><span class="keyword">&lt; </span><span class="default">$mday</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$mon</span><span class="keyword">++;
<br>&nbsp; &nbsp; &nbsp; if (</span><span class="default">$mon </span><span class="keyword">= </span><span class="default">13</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$mon </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$year</span><span class="keyword">++;
<br>&nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$lastsun </span><span class="keyword">= </span><span class="default">getlast</span><span class="keyword">(</span><span class="default">$mon</span><span class="keyword">, </span><span class="default">$year</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$sunday </span><span class="keyword">= </span><span class="default">$lastsun</span><span class="keyword">[</span><span class="string">'mday'</span><span class="keyword">];
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="default">$nextmeeting </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$mon</span><span class="keyword">,</span><span class="default">$sunday</span><span class="keyword">,</span><span class="default">$year</span><span class="keyword">));
<br>&nbsp; &nbsp; </span><span class="default">$month </span><span class="keyword">= </span><span class="default">$nextmeeting</span><span class="keyword">[</span><span class="string">'month'</span><span class="keyword">];
<br>&nbsp; &nbsp; </span><span class="default">$mday </span><span class="keyword">= </span><span class="default">$nextmeeting</span><span class="keyword">[</span><span class="string">'mday'</span><span class="keyword">];
<br>&nbsp; &nbsp; </span><span class="default">$year </span><span class="keyword">= </span><span class="default">$nextmeeting</span><span class="keyword">[</span><span class="string">'year'</span><span class="keyword">];
<br>&nbsp; &nbsp; return </span><span class="string">"</span><span class="default">$month</span><span class="string"> </span><span class="default">$mday</span><span class="string">, </span><span class="default">$year</span><span class="string">"</span><span class="keyword">;
<br>&nbsp; }
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53670">  
  <a class="name">
  <strong class="user"><em>daniel at globalnetstudios dot com</em></strong></a><div class="date" title="2005-06-08 11:49"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom53670">
<div class="phpcode"><code><span class="html">
This dateDiff() function can take in just about any timestamp, including UNIX timestamps and anything that is accepted by strtotime(). It returns an array with the ability to split the result a couple different ways. I built this function to suffice any datediff needs I had. Hope it helps others too.<br><br><span class="default">&lt;?php<br>&nbsp; </span><span class="comment">/********* dateDiff() function **********<br>&nbsp;&nbsp; * returns Array of Int values for difference between two dates<br>&nbsp;&nbsp; * $date1 &gt; $date2 --&gt; positive integers are returned<br>&nbsp;&nbsp; * $date1 &lt; $date2 --&gt; negative integers are returned<br>&nbsp;&nbsp; *<br>&nbsp;&nbsp; * $split recognizes the following:<br>&nbsp;&nbsp; *&nbsp;&nbsp; 'yw' = splits up years, weeks and days (default)<br>&nbsp;&nbsp; *&nbsp;&nbsp; 'y'&nbsp; = splits up years and days<br>&nbsp;&nbsp; *&nbsp;&nbsp; 'w'&nbsp; = splits up weeks and days<br>&nbsp;&nbsp; *&nbsp;&nbsp; 'd'&nbsp; = total days<br>&nbsp;&nbsp; *<br>&nbsp;&nbsp; * examples:<br>&nbsp;&nbsp; *&nbsp;&nbsp; $dif1 = dateDiff() or dateDiff('yw')<br>&nbsp;&nbsp; *&nbsp;&nbsp; $dif2 = dateDiff('y')<br>&nbsp;&nbsp; *&nbsp;&nbsp; $dif3 = dateDiff('w')<br>&nbsp;&nbsp; *&nbsp;&nbsp; $dif4 = dateDiff('d')<br>&nbsp;&nbsp; *<br>&nbsp;&nbsp; * assuming dateDiff returned 853 days, the above<br>&nbsp;&nbsp; * examples would have a print_r output of:<br>&nbsp;&nbsp; *&nbsp;&nbsp; $dif1 == Array( [y] =&gt; 2 [w] =&gt; 17 [d] =&gt; 4 )<br>&nbsp;&nbsp; *&nbsp;&nbsp; $dif2 == Array( [y] =&gt; 2 [d] =&gt; 123 )<br>&nbsp;&nbsp; *&nbsp;&nbsp; $dif3 == Array( [w] =&gt; 121 [d] =&gt; 6 )<br>&nbsp;&nbsp; *&nbsp;&nbsp; $dif4 == Array( [d] =&gt; 847 )<br>&nbsp;&nbsp; *<br>&nbsp;&nbsp; * note: [h] (hours), [m] (minutes), [s] (seconds) are always returned as elements of the Array<br>&nbsp;&nbsp; */<br>&nbsp; </span><span class="keyword">function </span><span class="default">dateDiff</span><span class="keyword">(</span><span class="default">$dt1</span><span class="keyword">, </span><span class="default">$dt2</span><span class="keyword">, </span><span class="default">$split</span><span class="keyword">=</span><span class="string">'yw'</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$date1 </span><span class="keyword">= (</span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$dt1</span><span class="keyword">) != -</span><span class="default">1</span><span class="keyword">) ? </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$dt1</span><span class="keyword">) : </span><span class="default">$dt1</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$date2 </span><span class="keyword">= (</span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$dt2</span><span class="keyword">) != -</span><span class="default">1</span><span class="keyword">) ? </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$dt2</span><span class="keyword">) : </span><span class="default">$dt2</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$dtDiff </span><span class="keyword">= </span><span class="default">$date1 </span><span class="keyword">- </span><span class="default">$date2</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$totalDays </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$dtDiff</span><span class="keyword">/(</span><span class="default">24</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">));<br>&nbsp; &nbsp; </span><span class="default">$totalSecs </span><span class="keyword">= </span><span class="default">$dtDiff</span><span class="keyword">-(</span><span class="default">$totalDays</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'h'</span><span class="keyword">] = </span><span class="default">$h </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$totalSecs</span><span class="keyword">/(</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">));<br>&nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'m'</span><span class="keyword">] = </span><span class="default">$m </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">((</span><span class="default">$totalSecs</span><span class="keyword">-(</span><span class="default">$h</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">))/</span><span class="default">60</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'s'</span><span class="keyword">] = </span><span class="default">$totalSecs</span><span class="keyword">-(</span><span class="default">$h</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">)-(</span><span class="default">$m</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="comment">// set up array as necessary<br>&nbsp; &nbsp; </span><span class="keyword">switch(</span><span class="default">$split</span><span class="keyword">) {<br>&nbsp; &nbsp; case </span><span class="string">'yw'</span><span class="keyword">: </span><span class="comment"># split years-weeks-days<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'y'</span><span class="keyword">] = </span><span class="default">$y </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$totalDays</span><span class="keyword">/</span><span class="default">365</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'w'</span><span class="keyword">] = </span><span class="default">$w </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">((</span><span class="default">$totalDays</span><span class="keyword">-(</span><span class="default">$y</span><span class="keyword">*</span><span class="default">365</span><span class="keyword">))/</span><span class="default">7</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'d'</span><span class="keyword">] = </span><span class="default">$totalDays</span><span class="keyword">-(</span><span class="default">$y</span><span class="keyword">*</span><span class="default">365</span><span class="keyword">)-(</span><span class="default">$w</span><span class="keyword">*</span><span class="default">7</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; case </span><span class="string">'y'</span><span class="keyword">: </span><span class="comment"># split years-days<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'y'</span><span class="keyword">] = </span><span class="default">$y </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$totalDays</span><span class="keyword">/</span><span class="default">365</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'d'</span><span class="keyword">] = </span><span class="default">$totalDays</span><span class="keyword">-(</span><span class="default">$y</span><span class="keyword">*</span><span class="default">365</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; case </span><span class="string">'w'</span><span class="keyword">: </span><span class="comment"># split weeks-days<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'w'</span><span class="keyword">] = </span><span class="default">$w </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$totalDays</span><span class="keyword">/</span><span class="default">7</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'d'</span><span class="keyword">] = </span><span class="default">$totalDays</span><span class="keyword">-(</span><span class="default">$w</span><span class="keyword">*</span><span class="default">7</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; case </span><span class="string">'d'</span><span class="keyword">: </span><span class="comment"># don't split -- total days<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$dif</span><span class="keyword">[</span><span class="string">'d'</span><span class="keyword">] = </span><span class="default">$totalDays</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; default:<br>&nbsp; &nbsp; &nbsp; die(</span><span class="string">"Error in dateDiff(). Unrecognized \$split parameter. Valid values are 'yw', 'y', 'w', 'd'. Default is 'yw'."</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$dif</span><span class="keyword">;<br>&nbsp; }<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53587">  
  <a class="name">
  <strong class="user"><em>mail at completeideas dot com</em></strong></a><div class="date" title="2005-06-06 01:55"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom53587">
<div class="phpcode"><code><span class="html">
For those who are using pre MYSQL 4.1.1, you can use:<br><br>TO_DAYS([Date Value 1])-TO_DAYS([Date Value 2])<br><br>For the same result as:<br><br>DATEDIFF([Date Value 1],[Date Value 2])</span>
</code></div>
  </div>
 </div>
  <div class="note" id="46427">  
  <a class="name">
  <strong class="user"><em>mincklerstraat at softhome dot net</em></strong></a><div class="date" title="2004-10-11 01:43"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom46427">
<div class="phpcode"><code><span class="html">
Before you get too advanced using date functions, be sure also to see the calendar functions at <a rel="nofollow" target="_blank">http://www.php.net/manual/en/ref.calendar.php</a> .</span>
</code></div>
  </div>
 </div>
  <div class="note" id="39424">  
  <a class="name">
  <strong class="user"><em>php at sarge dot ch</em></strong></a><div class="date" title="2004-01-28 04:58"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom39424">
<div class="phpcode"><code><span class="html">
Additional thisone here (didn't test it yet but should work :D):<br><br><span class="default">&lt;?php<br></span><span class="comment">/**<br> * Calculates the Difference between two timestamps<br> *<br> * @param integer $start_timestamp<br> * @param integer $end_timestamp<br> * @param integer $unit (default 0)<br> * @return string<br> * @access public<br> */<br></span><span class="keyword">function </span><span class="default">dateDifference</span><span class="keyword">(</span><span class="default">$start_timestamp</span><span class="keyword">,</span><span class="default">$end_timestamp</span><span class="keyword">,</span><span class="default">$unit</span><span class="keyword">= </span><span class="default">0</span><span class="keyword">){<br>&nbsp; </span><span class="default">$days_seconds_star</span><span class="keyword">= (</span><span class="default">23 </span><span class="keyword">* </span><span class="default">56 </span><span class="keyword">* </span><span class="default">60</span><span class="keyword">) + </span><span class="default">4.091</span><span class="keyword">; </span><span class="comment">// Star Day<br>&nbsp; </span><span class="default">$days_seconds_sun</span><span class="keyword">= </span><span class="default">24 </span><span class="keyword">* </span><span class="default">60 </span><span class="keyword">* </span><span class="default">60</span><span class="keyword">; </span><span class="comment">// Sun Day<br>&nbsp; </span><span class="default">$difference_seconds</span><span class="keyword">= </span><span class="default">$end_timestamp </span><span class="keyword">- </span><span class="default">$start_timestamp</span><span class="keyword">;<br>&nbsp; switch(</span><span class="default">$unit</span><span class="keyword">){<br>&nbsp; &nbsp; case </span><span class="default">3</span><span class="keyword">: </span><span class="comment">// Days<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$difference_days</span><span class="keyword">= </span><span class="default">round</span><span class="keyword">((</span><span class="default">$difference_seconds </span><span class="keyword">/ </span><span class="default">$days_seconds_sun</span><span class="keyword">),</span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; return </span><span class="string">'approx. '</span><span class="keyword">.</span><span class="default">$difference_hours</span><span class="keyword">.</span><span class="string">' Days'</span><span class="keyword">;<br>&nbsp; &nbsp; case </span><span class="default">2</span><span class="keyword">: </span><span class="comment">// Hours<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$difference_hours</span><span class="keyword">= </span><span class="default">round</span><span class="keyword">((</span><span class="default">$difference_seconds </span><span class="keyword">/ </span><span class="default">3600</span><span class="keyword">),</span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; return </span><span class="string">'approx. '</span><span class="keyword">.</span><span class="default">$difference_hours</span><span class="keyword">.</span><span class="string">' Hours'</span><span class="keyword">;<br>&nbsp; &nbsp; break;<br>&nbsp; &nbsp; case </span><span class="default">1</span><span class="keyword">: </span><span class="comment">// Minutes<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$difference_minutes</span><span class="keyword">= </span><span class="default">round</span><span class="keyword">((</span><span class="default">$difference_seconds </span><span class="keyword">/ </span><span class="default">60</span><span class="keyword">),</span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; return </span><span class="string">'approx. '</span><span class="keyword">.</span><span class="default">$difference_minutes</span><span class="keyword">.</span><span class="string">' Minutes'</span><span class="keyword">;<br>&nbsp; &nbsp; break;<br>&nbsp; &nbsp; default: </span><span class="comment">// Seconds<br>&nbsp; &nbsp; &nbsp; </span><span class="keyword">if(</span><span class="default">$difference_seconds </span><span class="keyword">&gt; </span><span class="default">1</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$difference_seconds</span><span class="keyword">.</span><span class="string">' Seconds'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; else{<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$difference_seconds</span><span class="keyword">.</span><span class="string">' Second'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="38427">  
  <a class="name">
  <strong class="user"><em>php at elmegil dot net</em></strong></a><div class="date" title="2003-12-20 10:40"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom38427">
<div class="phpcode"><code><span class="html">
A much easier way to do days diff is to use Julian Days from the Calendar functions:<br><br>$start = gregoriantojd($smon, $sday, $syear);<br>$end = gregoriantojd($emon, $eday, $eyear);<br>$daysdiff = $end - $start;<br><br>You can see the obvious ways to wrap a function around that.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="30468">  
  <a class="name">
  <strong class="user"><em>garyc at earthling dot net</em></strong></a><div class="date" title="2003-03-18 08:08"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom30468">
<div class="phpcode"><code><span class="html">
I needed to calculate the week number from a given date and vice versa, where the week starts with a Monday and the first week of a year may begin the year before, if the year begins in the middle of the week (Tue-Sun). This is the way weekly magazines calculate their issue numbers.
<br>
<br>Here are two functions that do exactly that:
<br>
<br>Hope somebody finds this useful.
<br>
<br>Gary
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">/*&nbsp; w e e k n u m b e r&nbsp; -------------------------------------- //
<br>weeknumber returns a week number from a given date (&gt;1970, &lt;2030)
<br>Wed, 2003-01-01 is in week 1
<br>Mon, 2003-01-06 is in week 2
<br>Wed, 2003-12-31 is in week 53, next years first week
<br>Be careful, there are years with 53 weeks.
<br>// ------------------------------------------------------------ */ 
<br>
<br></span><span class="keyword">function </span><span class="default">weeknumber </span><span class="keyword">(</span><span class="default">$y</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">, </span><span class="default">$d</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$wn </span><span class="keyword">= </span><span class="default">strftime</span><span class="keyword">(</span><span class="string">"%W"</span><span class="keyword">,</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$m</span><span class="keyword">,</span><span class="default">$d</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">));
<br>&nbsp; &nbsp; </span><span class="default">$wn </span><span class="keyword">+= </span><span class="default">0</span><span class="keyword">; </span><span class="comment"># wn might be a string value
<br>&nbsp; &nbsp; </span><span class="default">$firstdayofyear </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">));
<br>&nbsp; &nbsp; if (</span><span class="default">$firstdayofyear</span><span class="keyword">[</span><span class="string">"wday"</span><span class="keyword">] != </span><span class="default">1</span><span class="keyword">)&nbsp; &nbsp; </span><span class="comment"># if 1/1 is not a Monday, add 1
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$wn </span><span class="keyword">+= </span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; return (</span><span class="default">$wn</span><span class="keyword">);
<br>}&nbsp; &nbsp; </span><span class="comment"># function weeknumber
<br>
<br>/*&nbsp; d a t e f r o m w e e k&nbsp; ---------------------------------- //
<br>From a weeknumber, calculates the corresponding date
<br>Input: Year, weeknumber and day offset
<br>Output: Exact date in an associative (named) array
<br>2003, 12, 0: 2003-03-17 (a Monday)
<br>1995,&nbsp; 53, 2: 1995-12-xx
<br>...
<br>// ------------------------------------------------------------ */ 
<br>
<br></span><span class="keyword">function </span><span class="default">datefromweek </span><span class="keyword">(</span><span class="default">$y</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$o</span><span class="keyword">) {
<br>
<br>&nbsp; &nbsp; </span><span class="default">$days </span><span class="keyword">= (</span><span class="default">$w </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">) * </span><span class="default">7 </span><span class="keyword">+ </span><span class="default">$o</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="default">$firstdayofyear </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">));
<br>&nbsp; &nbsp; if (</span><span class="default">$firstdayofyear</span><span class="keyword">[</span><span class="string">"wday"</span><span class="keyword">] == </span><span class="default">0</span><span class="keyword">) </span><span class="default">$firstdayofyear</span><span class="keyword">[</span><span class="string">"wday"</span><span class="keyword">] += </span><span class="default">7</span><span class="keyword">; 
<br></span><span class="comment"># in getdate, Sunday is 0 instead of 7
<br>&nbsp; &nbsp; </span><span class="default">$firstmonday </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">-</span><span class="default">$firstdayofyear</span><span class="keyword">[</span><span class="string">"wday"</span><span class="keyword">]+</span><span class="default">1</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">));
<br>&nbsp; &nbsp; </span><span class="default">$calcdate </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$firstmonday</span><span class="keyword">[</span><span class="string">"mon"</span><span class="keyword">], </span><span class="default">$firstmonday</span><span class="keyword">[</span><span class="string">"mday"</span><span class="keyword">]+</span><span class="default">$days</span><span class="keyword">,</span><span class="default">$firstmonday</span><span class="keyword">[</span><span class="string">"year"</span><span class="keyword">]));
<br>
<br>&nbsp; &nbsp; </span><span class="default">$date</span><span class="keyword">[</span><span class="string">"year"</span><span class="keyword">] = </span><span class="default">$calcdate</span><span class="keyword">[</span><span class="string">"year"</span><span class="keyword">];
<br>&nbsp; &nbsp; </span><span class="default">$date</span><span class="keyword">[</span><span class="string">"month"</span><span class="keyword">] = </span><span class="default">$calcdate</span><span class="keyword">[</span><span class="string">"mon"</span><span class="keyword">];
<br>&nbsp; &nbsp; </span><span class="default">$date</span><span class="keyword">[</span><span class="string">"day"</span><span class="keyword">] = </span><span class="default">$calcdate</span><span class="keyword">[</span><span class="string">"mday"</span><span class="keyword">];
<br>
<br>&nbsp; &nbsp; return (</span><span class="default">$date</span><span class="keyword">);
<br>
<br>}&nbsp; &nbsp; </span><span class="comment"># function datefromweek
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="23866">  
  <a class="name">
  <strong class="user"><em>nightowl at NOS-PA-M dot uk2 dot net</em></strong></a><div class="date" title="2002-07-30 10:59"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom23866">
<div class="phpcode"><code><span class="html">
I wanted to find all records in my database which match the current week (for a call-back function). I made up this function to find the start and end of the current week : 
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">week</span><span class="keyword">(</span><span class="default">$curtime</span><span class="keyword">) {
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$date_array </span><span class="keyword">= </span><span class="default">getdate </span><span class="keyword">(</span><span class="default">time</span><span class="keyword">());
<br>&nbsp; &nbsp; </span><span class="default">$numdays </span><span class="keyword">= </span><span class="default">$date_array</span><span class="keyword">[</span><span class="string">"wday"</span><span class="keyword">];
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$startdate </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y-m-d"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">() - (</span><span class="default">$numdays </span><span class="keyword">* </span><span class="default">24</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">));
<br>&nbsp; &nbsp; </span><span class="default">$enddate </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y-m-d"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">() + ((</span><span class="default">7 </span><span class="keyword">- </span><span class="default">$numdays</span><span class="keyword">) * </span><span class="default">24</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">));
<br>
<br>&nbsp; &nbsp; </span><span class="default">$week</span><span class="keyword">[</span><span class="string">'start'</span><span class="keyword">] = </span><span class="default">$startdate</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$week</span><span class="keyword">[</span><span class="string">'end'</span><span class="keyword">] = </span><span class="default">$enddate</span><span class="keyword">;
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; return </span><span class="default">$week</span><span class="keyword">;
<br>&nbsp; &nbsp; 
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="81908">  
  <a class="name">
  <strong class="user"><em>Robb_Bean at gmx dot nospam dot net</em></strong></a><div class="date" title="2008-03-18 03:47"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom81908">
<div class="phpcode"><code><span class="html">
With PHP 5.1 and 5.2 the languages datetime support has changed. Although these functions should guess your local timezone settings, they may fail if using a default configuration in a "pre-5.1 way", which means setting no timezone for PHP. In the case PHP could not get a timezone it emits a E_STRICT warning. Note that this affects _all_ datetime functions and keep it in mind when porting software from previous versions to 5.1 or later! It may also confuse your error handling (this is the way I noticed that things have changed, since these changes are not documentated _here_).<br><br>References:<br><br><a rel="nofollow" target="_blank">http://www.php.net/manual/de/migration51.datetime.php</a><br><a rel="nofollow" target="_blank">http://www.php.net/manual/de/migration52.datetime.php</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="78761">  
  <a class="name">
  <strong class="user"><em>venoel at rin dot ru</em></strong></a><div class="date" title="2007-10-26 03:33"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78761">
<div class="phpcode"><code><span class="html">
May be useful for somebody. This function takes on daylight saving time
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">Function </span><span class="default">DateDiff</span><span class="keyword">(</span><span class="default">$date1</span><span class="keyword">,</span><span class="default">$date2</span><span class="keyword">) {
<br>&nbsp; </span><span class="default">$timedifference</span><span class="keyword">=</span><span class="default">$date2</span><span class="keyword">-</span><span class="default">$date1</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$corr</span><span class="keyword">=</span><span class="default">date</span><span class="keyword">(</span><span class="string">"I"</span><span class="keyword">,</span><span class="default">$date2</span><span class="keyword">)-</span><span class="default">date</span><span class="keyword">(</span><span class="string">"I"</span><span class="keyword">,</span><span class="default">$date1</span><span class="keyword">);
<br>&nbsp; </span><span class="default">$timedifference</span><span class="keyword">+=</span><span class="default">$corr</span><span class="keyword">;
<br>&nbsp; return </span><span class="default">$timedifference</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>Example:
<br>
<br><span class="default">&lt;?php
<br>$d1</span><span class="keyword">=</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">,</span><span class="default">28</span><span class="keyword">,</span><span class="default">2007</span><span class="keyword">);
<br></span><span class="default">$d2</span><span class="keyword">=</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">4</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">,</span><span class="default">28</span><span class="keyword">,</span><span class="default">2007</span><span class="keyword">);
<br></span><span class="default">$period</span><span class="keyword">=</span><span class="default">DateDiff</span><span class="keyword">(</span><span class="default">$d1</span><span class="keyword">,</span><span class="default">$d2</span><span class="keyword">);
<br></span><span class="default">printf</span><span class="keyword">(</span><span class="string">"&lt;br&gt;%s"</span><span class="keyword">,</span><span class="default">date</span><span class="keyword">(</span><span class="string">"I d.m.Y H:i"</span><span class="keyword">,</span><span class="default">$d1</span><span class="keyword">));
<br></span><span class="default">printf</span><span class="keyword">(</span><span class="string">"&lt;br&gt;%u hour"</span><span class="keyword">,</span><span class="default">$period</span><span class="keyword">/</span><span class="default">3600</span><span class="keyword">);
<br></span><span class="default">printf</span><span class="keyword">(</span><span class="string">"&lt;br&gt;%s"</span><span class="keyword">,</span><span class="default">date</span><span class="keyword">(</span><span class="string">"I d.m.Y H:i"</span><span class="keyword">,</span><span class="default">$d2</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>Getting 2 hour instead 3.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73285">  
  <a class="name">
  <strong class="user"><em>Leopoldo A dot  Oducado (poducado at comfsm dot fm)</em></strong></a><div class="date" title="2007-02-15 07:50"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73285">
<div class="phpcode"><code><span class="html">
Here is my function to count the number days, weeks, months, and year. I tried it below 1970 and it works.<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">datecal</span><span class="keyword">(</span><span class="default">$date</span><span class="keyword">,</span><span class="default">$return_value</span><span class="keyword">)<br>{<br></span><span class="default">$date </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$date</span><span class="keyword">);<br></span><span class="default">$month_begin </span><span class="keyword">= </span><span class="default">$date</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br></span><span class="default">$month_begin_date </span><span class="keyword">= </span><span class="default">$date</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br></span><span class="default">$year1 </span><span class="keyword">= </span><span class="default">$date</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br></span><span class="default">$month_end </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"n"</span><span class="keyword">);<br></span><span class="default">$month_end_date </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"j"</span><span class="keyword">);<br></span><span class="default">$year2 </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">);<br></span><span class="default">$days_old </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br></span><span class="default">$years_old </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br></span><span class="default">$months_old </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>if(</span><span class="default">$month_begin</span><span class="keyword">==</span><span class="default">12</span><span class="keyword">)<br>{<br>&nbsp; </span><span class="default">$month </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br>&nbsp; </span><span class="default">$year </span><span class="keyword">= </span><span class="default">$year1</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;<br>}<br>else<br>{<br>&nbsp; </span><span class="default">$month </span><span class="keyword">= </span><span class="default">$month_begin</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;<br>&nbsp; </span><span class="default">$year </span><span class="keyword">= </span><span class="default">$year1</span><span class="keyword">;<br>}<br></span><span class="default">$begin_plus_days </span><span class="keyword">= </span><span class="default">cal_days_in_month</span><span class="keyword">(</span><span class="default">CAL_GREGORIAN</span><span class="keyword">, </span><span class="default">$month_begin</span><span class="keyword">, </span><span class="default">$year1</span><span class="keyword">) - </span><span class="default">$month_begin_date</span><span class="keyword">;<br></span><span class="default">$end_minus_days </span><span class="keyword">= </span><span class="default">cal_days_in_month</span><span class="keyword">(</span><span class="default">CAL_GREGORIAN</span><span class="keyword">, </span><span class="default">$month_end</span><span class="keyword">, </span><span class="default">$year2</span><span class="keyword">) - </span><span class="default">$month_end_date</span><span class="keyword">;<br>while (</span><span class="default">$year </span><span class="keyword">&lt;= </span><span class="default">$year2</span><span class="keyword">) <br>{&nbsp; &nbsp; <br>&nbsp; &nbsp;&nbsp; if(</span><span class="default">$year </span><span class="keyword">== </span><span class="default">$year2</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$days_old </span><span class="keyword">= </span><span class="default">$days_old </span><span class="keyword">+ </span><span class="default">cal_days_in_month</span><span class="keyword">(</span><span class="default">CAL_GREGORIAN</span><span class="keyword">, </span><span class="default">$month</span><span class="keyword">, </span><span class="default">$year</span><span class="keyword">);&nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; if(</span><span class="default">$month </span><span class="keyword">&lt; </span><span class="default">$month_end</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; { <br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$months_old </span><span class="keyword">= </span><span class="default">$months_old </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$month </span><span class="keyword">= </span><span class="default">$month </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elseif (</span><span class="default">$month</span><span class="keyword">==</span><span class="default">$month_end </span><span class="keyword">and </span><span class="default">$month_end_date </span><span class="keyword">&gt;= </span><span class="default">$month_begin_date</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { <br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$year </span><span class="keyword">= </span><span class="default">$year2</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; {&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$year </span><span class="keyword">= </span><span class="default">$year2</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; else<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp;&nbsp; </span><span class="default">$days_old </span><span class="keyword">= </span><span class="default">$days_old </span><span class="keyword">+ </span><span class="default">cal_days_in_month</span><span class="keyword">(</span><span class="default">CAL_GREGORIAN</span><span class="keyword">, </span><span class="default">$month</span><span class="keyword">, </span><span class="default">$year</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$month </span><span class="keyword">&lt;= </span><span class="default">11</span><span class="keyword">) <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$month </span><span class="keyword">= </span><span class="default">$month </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$months_old </span><span class="keyword">= </span><span class="default">$months_old </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$month </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; <br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$year </span><span class="keyword">= </span><span class="default">$year </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$months_old </span><span class="keyword">= </span><span class="default">$months_old </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }&nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; }<br>}<br></span><span class="default">$days_old </span><span class="keyword">= (</span><span class="default">$days_old </span><span class="keyword">+ </span><span class="default">$begin_plus_days</span><span class="keyword">) - </span><span class="default">$end_minus_days</span><span class="keyword">;<br>if(</span><span class="default">$return_value </span><span class="keyword">== </span><span class="string">"d"</span><span class="keyword">)<br>&nbsp; { return </span><span class="default">$days_old</span><span class="keyword">; }<br>elseif (</span><span class="default">$return_value </span><span class="keyword">== </span><span class="string">"w"</span><span class="keyword">)<br>&nbsp; { return </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$days_old</span><span class="keyword">/</span><span class="default">7</span><span class="keyword">); }<br>elseif (</span><span class="default">$return_value </span><span class="keyword">== </span><span class="string">"m"</span><span class="keyword">)<br>&nbsp; { return </span><span class="default">$months_old</span><span class="keyword">; }<br>elseif (</span><span class="default">$return_value </span><span class="keyword">== </span><span class="string">"y"</span><span class="keyword">)<br>&nbsp; { return </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$months_old</span><span class="keyword">/</span><span class="default">12</span><span class="keyword">); }<br>}<br><br>echo </span><span class="default">datecal</span><span class="keyword">(</span><span class="string">"08/13/1975"</span><span class="keyword">,</span><span class="string">"m"</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57207">  
  <a class="name">
  <strong class="user"><em>glashio at xs4all dot nl</em></strong></a><div class="date" title="2005-09-27 12:46"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom57207">
<div class="phpcode"><code><span class="html">
Calculate Sum BusinessDays (Mon till Fri) between two date's :<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">businessdays</span><span class="keyword">(</span><span class="default">$begin</span><span class="keyword">, </span><span class="default">$end</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$rbegin </span><span class="keyword">= </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$begin</span><span class="keyword">) ? </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">strval</span><span class="keyword">(</span><span class="default">$begin</span><span class="keyword">)) : </span><span class="default">$begin</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$rend </span><span class="keyword">= </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$end</span><span class="keyword">) ? </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">strval</span><span class="keyword">(</span><span class="default">$end</span><span class="keyword">)) : </span><span class="default">$end</span><span class="keyword">;<br>&nbsp; &nbsp; if (</span><span class="default">$rbegin </span><span class="keyword">&lt; </span><span class="default">0 </span><span class="keyword">|| </span><span class="default">$rend </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">0</span><span class="keyword">;<br><br>&nbsp; &nbsp; </span><span class="default">$begin </span><span class="keyword">= </span><span class="default">workday</span><span class="keyword">(</span><span class="default">$rbegin</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$end </span><span class="keyword">= </span><span class="default">workday</span><span class="keyword">(</span><span class="default">$rend</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);<br><br>&nbsp; &nbsp; if (</span><span class="default">$end </span><span class="keyword">&lt; </span><span class="default">$begin</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$end </span><span class="keyword">= </span><span class="default">$begin</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$begin </span><span class="keyword">= </span><span class="default">$end</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="default">$difftime </span><span class="keyword">= </span><span class="default">$end </span><span class="keyword">- </span><span class="default">$begin</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$diffdays </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$difftime </span><span class="keyword">/ (</span><span class="default">24 </span><span class="keyword">* </span><span class="default">60 </span><span class="keyword">* </span><span class="default">60</span><span class="keyword">)) + </span><span class="default">1</span><span class="keyword">;<br><br>&nbsp; &nbsp; if (</span><span class="default">$diffdays </span><span class="keyword">&lt; </span><span class="default">7</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$abegin </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">$rbegin</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aend </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">$rend</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$diffdays </span><span class="keyword">== </span><span class="default">1 </span><span class="keyword">&amp;&amp; (</span><span class="default">$astart</span><span class="keyword">[</span><span class="string">'wday'</span><span class="keyword">] == </span><span class="default">0 </span><span class="keyword">|| </span><span class="default">$astart</span><span class="keyword">[</span><span class="string">'wday'</span><span class="keyword">] == </span><span class="default">6</span><span class="keyword">) &amp;&amp; (</span><span class="default">$aend</span><span class="keyword">[</span><span class="string">'wday'</span><span class="keyword">] == </span><span class="default">0 </span><span class="keyword">|| </span><span class="default">$aend</span><span class="keyword">[</span><span class="string">'wday'</span><span class="keyword">] == </span><span class="default">6</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$abegin </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">$begin</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$aend </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">$end</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$weekends </span><span class="keyword">= (</span><span class="default">$aend</span><span class="keyword">[</span><span class="string">'wday'</span><span class="keyword">] &lt; </span><span class="default">$abegin</span><span class="keyword">[</span><span class="string">'wday'</span><span class="keyword">]) ? </span><span class="default">1 </span><span class="keyword">: </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; } else<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$weekends </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$diffdays </span><span class="keyword">/ </span><span class="default">7</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">$diffdays </span><span class="keyword">- (</span><span class="default">$weekends </span><span class="keyword">* </span><span class="default">2</span><span class="keyword">);<br>}<br><br>function </span><span class="default">workday</span><span class="keyword">(</span><span class="default">$date</span><span class="keyword">, </span><span class="default">$begindate </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$adate </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">$date</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$day </span><span class="keyword">= </span><span class="default">24 </span><span class="keyword">* </span><span class="default">60 </span><span class="keyword">* </span><span class="default">60</span><span class="keyword">;<br>&nbsp; &nbsp; if (</span><span class="default">$adate</span><span class="keyword">[</span><span class="string">'wday'</span><span class="keyword">] == </span><span class="default">0</span><span class="keyword">) </span><span class="comment">// Sunday<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$date </span><span class="keyword">+= </span><span class="default">$begindate </span><span class="keyword">? </span><span class="default">$day </span><span class="keyword">: -(</span><span class="default">$day </span><span class="keyword">* </span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; elseif (</span><span class="default">$adate</span><span class="keyword">[</span><span class="string">'wday'</span><span class="keyword">] == </span><span class="default">6</span><span class="keyword">) </span><span class="comment">// Saterday<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$date </span><span class="keyword">+= </span><span class="default">$begindate </span><span class="keyword">? </span><span class="default">$day </span><span class="keyword">* </span><span class="default">2 </span><span class="keyword">: -</span><span class="default">$day</span><span class="keyword">;<br>&nbsp; &nbsp; return </span><span class="default">$date</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105397">  
  <a class="name">
  <strong class="user"><em>Hans</em></strong></a><div class="date" title="2011-08-15 12:19"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom105397">
<div class="phpcode"><code><span class="html">
I needed a way to display an announcement on a shopping site, that would warn users that orders placed between a certain date range, would not be shipped until after a certain date.<br><br>I created this simple date detection code to display the notice on certain pages. You can just copy the code and save it to a file on the site and include it anywhere you need to perform a function, or display a notice.<br><br><span class="default">&lt;?php<br></span><span class="comment">/*<br>&nbsp; &nbsp; Code to show a message only for a certain time frame.<br>&nbsp; &nbsp; This is a simple include file that can be used to display a message<br>&nbsp; &nbsp; on any pages that use it.<br>&nbsp; &nbsp; Simply us a standard include instruction to this file on the page/s where <br>&nbsp; &nbsp; you want the notice to appear.<br>&nbsp; &nbsp; Written by Hans Kiesouw - hans at wotworx dot com<br>*/<br><br></span><span class="default">$start </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">'30-07-2011'</span><span class="keyword">); </span><span class="comment">// DD-MM-YYYY<br></span><span class="default">$endDate</span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">'07-08-2011'</span><span class="keyword">); </span><span class="comment">// DD-MM-YYYY<br></span><span class="default">$curdate </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="default">date</span><span class="keyword">(</span><span class="string">'d-m-Y'</span><span class="keyword">));<br><br>if (</span><span class="default">$start </span><span class="keyword">&lt;= </span><span class="default">$curdate </span><span class="keyword">&amp;&amp; </span><span class="default">$curdate </span><span class="keyword">&lt;= </span><span class="default">$endDate</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="comment">/*<br>&nbsp; &nbsp; The message below will appear if the current date is between the start and <br>&nbsp; &nbsp; endDate - used standards HTML to ensure that any code will not be <br>&nbsp; &nbsp; escaped by PHP. You can use any code here to wish to execute for the <br>&nbsp; &nbsp; date range.<br>&nbsp; &nbsp; */<br>&nbsp; &nbsp; </span><span class="default">?&gt;<br></span>&nbsp; &nbsp; <br>&nbsp; &nbsp; &lt;p&gt;&lt;strong&gt;&lt;font color="#FF0000"&gt;Please Note: Any orders placed between July 30th and August 7th will only be shipped on August 8th. We apologize for any inconvenience and thank you for your order.&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;<br> <span class="default">&lt;?php&nbsp; <br> </span><span class="comment">// don't forget this last bit, it ends the if statement!<br></span><span class="keyword">} <br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="81452">  
  <a class="name">
  <strong class="user"><em>sagar</em></strong></a><div class="date" title="2008-02-28 08:53"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom81452">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php
<br></span><span class="comment">####################################
<br># Provide week number and get start_timestamp and end_timestamp
<br>#####################################
<br>
<br>// this week number will come from the timeshare form
<br> </span><span class="default">$week </span><span class="keyword">= </span><span class="default">51</span><span class="keyword">;
<br>
<br></span><span class="default">$times </span><span class="keyword">= </span><span class="default">get_start_and_end_date_from_week</span><span class="keyword">(</span><span class="default">$week</span><span class="keyword">);
<br></span><span class="default">$start_time </span><span class="keyword">= </span><span class="default">$times</span><span class="keyword">[</span><span class="string">'start_timestamp'</span><span class="keyword">];
<br></span><span class="default">$end_time </span><span class="keyword">= </span><span class="default">$times</span><span class="keyword">[</span><span class="string">'end_timestamp'</span><span class="keyword">];
<br>
<br>function </span><span class="default">get_start_and_end_date_from_week </span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">) 
<br>{
<br>&nbsp; &nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">());
<br>&nbsp; &nbsp; </span><span class="default">$o </span><span class="keyword">= </span><span class="default">6</span><span class="keyword">; </span><span class="comment">// week starts from sunday by default
<br>
<br>&nbsp; &nbsp; </span><span class="default">$days </span><span class="keyword">= (</span><span class="default">$w </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">) * </span><span class="default">7 </span><span class="keyword">+ </span><span class="default">$o</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="default">$firstdayofyear </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">));
<br>&nbsp; &nbsp; if (</span><span class="default">$firstdayofyear</span><span class="keyword">[</span><span class="string">"wday"</span><span class="keyword">] == </span><span class="default">0</span><span class="keyword">) </span><span class="default">$firstdayofyear</span><span class="keyword">[</span><span class="string">"wday"</span><span class="keyword">] += </span><span class="default">7</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="comment"># in getdate, Sunday is 0 instead of 7
<br>&nbsp; &nbsp; </span><span class="default">$firstmonday </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">-</span><span class="default">$firstdayofyear</span><span class="keyword">[</span><span class="string">"wday"</span><span class="keyword">]+</span><span class="default">1</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">));
<br>&nbsp; &nbsp; </span><span class="default">$calcdate </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$firstmonday</span><span class="keyword">[</span><span class="string">"mon"</span><span class="keyword">], </span><span class="default">$firstmonday</span><span class="keyword">[</span><span class="string">"mday"</span><span class="keyword">]+</span><span class="default">$days</span><span class="keyword">,</span><span class="default">$firstmonday</span><span class="keyword">[</span><span class="string">"year"</span><span class="keyword">]));
<br>
<br>&nbsp; &nbsp; </span><span class="default">$sday </span><span class="keyword">= </span><span class="default">$calcdate</span><span class="keyword">[</span><span class="string">"mday"</span><span class="keyword">];
<br>&nbsp; &nbsp; </span><span class="default">$smonth </span><span class="keyword">= </span><span class="default">$calcdate</span><span class="keyword">[</span><span class="string">"mon"</span><span class="keyword">];
<br>&nbsp; &nbsp; </span><span class="default">$syear </span><span class="keyword">= </span><span class="default">$calcdate</span><span class="keyword">[</span><span class="string">"year"</span><span class="keyword">];
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$timestamp</span><span class="keyword">[</span><span class="string">'start_timestamp'</span><span class="keyword">] =&nbsp; </span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$smonth</span><span class="keyword">, </span><span class="default">$sday</span><span class="keyword">, </span><span class="default">$syear</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$timestamp</span><span class="keyword">[</span><span class="string">'end_timestamp'</span><span class="keyword">] =&nbsp; </span><span class="default">$timestamp</span><span class="keyword">[</span><span class="string">'start_timestamp'</span><span class="keyword">] + (</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">7</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; return </span><span class="default">$timestamp</span><span class="keyword">;
<br>
<br>}&nbsp; &nbsp; </span><span class="comment"># function datefromweek
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78025">  
  <a class="name">
  <strong class="user"><em>aquatakat at telus dot net</em></strong></a><div class="date" title="2007-09-24 01:25"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78025">
<div class="phpcode"><code><span class="html">
I wrote a simple script to format a duration in seconds. Give the function some value in seconds and it will return an array.<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">format_duration</span><span class="keyword">(</span><span class="default">$seconds</span><span class="keyword">) {<br><br>&nbsp; &nbsp; </span><span class="default">$periods </span><span class="keyword">= array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'centuries' </span><span class="keyword">=&gt; </span><span class="default">3155692600</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'decades' </span><span class="keyword">=&gt; </span><span class="default">315569260</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'years' </span><span class="keyword">=&gt; </span><span class="default">31556926</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'months' </span><span class="keyword">=&gt; </span><span class="default">2629743</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'weeks' </span><span class="keyword">=&gt; </span><span class="default">604800</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'days' </span><span class="keyword">=&gt; </span><span class="default">86400</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'hours' </span><span class="keyword">=&gt; </span><span class="default">3600</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'minutes' </span><span class="keyword">=&gt; </span><span class="default">60</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'seconds' </span><span class="keyword">=&gt; </span><span class="default">1<br>&nbsp; &nbsp; </span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">$durations </span><span class="keyword">= array();<br><br>&nbsp; &nbsp; foreach (</span><span class="default">$periods </span><span class="keyword">as </span><span class="default">$period </span><span class="keyword">=&gt; </span><span class="default">$seconds_in_period</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$seconds </span><span class="keyword">&gt;= </span><span class="default">$seconds_in_period</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$durations</span><span class="keyword">[</span><span class="default">$period</span><span class="keyword">] = </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$seconds </span><span class="keyword">/ </span><span class="default">$seconds_in_period</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$seconds </span><span class="keyword">-= </span><span class="default">$durations</span><span class="keyword">[</span><span class="default">$period</span><span class="keyword">] * </span><span class="default">$seconds_in_period</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; return </span><span class="default">$durations</span><span class="keyword">;<br><br>}<br><br>echo </span><span class="default">format_duration</span><span class="keyword">(</span><span class="default">864</span><span class="keyword">);<br><br></span><span class="comment">/*<br>[minutes] =&gt; 14<br>[seconds] =&gt; 24<br>*/<br><br></span><span class="keyword">echo </span><span class="default">format_duration</span><span class="keyword">(</span><span class="default">3600</span><span class="keyword">);<br><br></span><span class="comment">/*<br>[hours] =&gt; 1<br>*/<br><br></span><span class="keyword">echo </span><span class="default">format_duration</span><span class="keyword">(</span><span class="default">11111111</span><span class="keyword">);<br><br></span><span class="comment">/*<br>[months] =&gt; 4<br>[days] =&gt; 6<br>[hours] =&gt; 20<br>[minutes] =&gt; 28<br>[seconds] =&gt; 59<br>*/<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77638">  
  <a class="name">
  <strong class="user"><em>Darren Edwards</em></strong></a><div class="date" title="2007-09-06 08:54"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom77638">
<div class="phpcode"><code><span class="html">
I was looking for a solution where I could return the number of days, hours, Minutes and seconds between two entries in a table.<br>DATE_DIFF is not running on my mysql server as my provider uses mysql version 4.0.25<br>Solution was to use to days and std time functions to calculate the difference in one call.<br>The fields stored in the table(report_table) are <br>time(00:00:00),<br>date(0000-00-00) and record(enum) which tells the app the type of log stored. EG start or end of a report.<br><br>SELECT <br>(TO_DAYS( `end`.`date` ) - TO_DAYS( `start`.`date` )) <br>- <br>( second( `end`.`time` ) + (minute( `end`.`time` )*60) + (hour( `end`.`time` )*3600) <br>&lt;<br> second( `start`.`time` ) + (minute( `start`.`time` )*60) + (hour( `start`.`time` )*3600)) <br>AS `days` , <br>SEC_TO_TIME( <br>(second( `end`.`time` ) + (minute( `end`.`time` )*60) + (hour( `end`.`time` )*3600) )<br>-<br>(second( `start`.`time` ) + (minute( `start`.`time` )*60) + (hour( `start`.`time` )*3600) )<br> ) AS `hms`,<br>`start`.`time` as `start`,<br>`end`.`time`&nbsp; as `end`<br><br>FROM `report_table` AS `start` , `report_table` AS `end` <br>AND `start`.`record` = 'Report Begin'<br>AND `end`.`record` = 'Report End'<br>LIMIT 1 <br><br>If there is no end of report then it will not return a result, as you would expect.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="41495">  
  <a class="name">
  <strong class="user"><em>nickaubert at america's biggest isp dot com</em></strong></a><div class="date" title="2004-04-12 01:13"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom41495">
<div class="phpcode"><code><span class="html">
I ran into an issue using a function that loops through an array of dates where the keys to the array are the Unix timestamp for midnight for each date.&nbsp; The loop starts at the first timestamp, then incremented by adding 86400 seconds (ie. 60 x 60 x 24).&nbsp; However, Daylight Saving Time threw off the accuracy of this loop, since certain days have a duration other than 86400 seconds.&nbsp; I worked around it by adding a couple of lines to force the timestamp to midnight at each interval.<br><br><span class="default">&lt;?php<br>&nbsp; $ONE_DAY </span><span class="keyword">= </span><span class="default">90000</span><span class="keyword">;&nbsp;&nbsp; </span><span class="comment">// can't use 86400 because some days have one hour more or less<br>&nbsp; </span><span class="keyword">for ( </span><span class="default">$each_timestamp </span><span class="keyword">= </span><span class="default">$start_time </span><span class="keyword">; </span><span class="default">$each_timestamp </span><span class="keyword">&lt;= </span><span class="default">$end_time </span><span class="keyword">; </span><span class="default">$each_timestamp </span><span class="keyword">+=&nbsp; </span><span class="default">$ONE_DAY</span><span class="keyword">) {<br><br>&nbsp; &nbsp; </span><span class="comment">/*&nbsp; force midnight to compensate for daylight saving time&nbsp; */<br>&nbsp; &nbsp; </span><span class="default">$this_timestamp_array </span><span class="keyword">= </span><span class="default">getdate</span><span class="keyword">( </span><span class="default">$each_timestamp </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$each_timestamp </span><span class="keyword">= </span><span class="default">mktime </span><span class="keyword">( </span><span class="default">0 </span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">, </span><span class="default">$this_timestamp_array</span><span class="keyword">[</span><span class="default">mon</span><span class="keyword">] , </span><span class="default">$this_timestamp_array</span><span class="keyword">[</span><span class="default">mday</span><span class="keyword">] , </span><span class="default">$this_timestamp_array</span><span class="keyword">[</span><span class="default">year</span><span class="keyword">] );<br><br>&nbsp; &nbsp;&nbsp; </span><span class="comment">// do some stuff...<br>&nbsp; </span><span class="keyword">}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90989">  
  <a class="name">
  <strong class="user"><em>luck dot lil dot leprechaun at gmail dot com</em></strong></a><div class="date" title="2009-05-19 03:53"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90989">
<div class="phpcode"><code><span class="html">
This is an easily extendable and pretty way to output human-readable date differences such as "1 day 2 hours ago", "6 months ago", "3 years 7 months 14 days 1 hour 4 minutes 16 seconds" etc etc.
<br>Change "$levels = 2;" to whatever you want. A value of 1 will limit to only one number in the result ("3 days ago"). A value of 3 would result in up to three ("3 days 1 hour 2 minutes ago")
<br>
<br>It can be used in the following ways:
<br>echo compare_dates($start_date,$end_date);
<br>echo compare_dates($end_date,$start_date);
<br>echo compare_dates($start_date); //end date will be assumed as time();
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">compare_dates</span><span class="keyword">(</span><span class="default">$date1</span><span class="keyword">, </span><span class="default">$date2 </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">())
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; </span><span class="default">$blocks </span><span class="keyword">= array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="string">'name'</span><span class="keyword">=&gt;</span><span class="string">'year'</span><span class="keyword">,</span><span class="string">'amount'&nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; </span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">365&nbsp; &nbsp; </span><span class="keyword">),
<br>&nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="string">'name'</span><span class="keyword">=&gt;</span><span class="string">'month'</span><span class="keyword">,</span><span class="string">'amount'&nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; </span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">31&nbsp; &nbsp; </span><span class="keyword">),
<br>&nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="string">'name'</span><span class="keyword">=&gt;</span><span class="string">'week'</span><span class="keyword">,</span><span class="string">'amount'&nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; </span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">*</span><span class="default">7&nbsp; &nbsp; </span><span class="keyword">),
<br>&nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="string">'name'</span><span class="keyword">=&gt;</span><span class="string">'day'</span><span class="keyword">,</span><span class="string">'amount'&nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; </span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24&nbsp; &nbsp; </span><span class="keyword">),
<br>&nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="string">'name'</span><span class="keyword">=&gt;</span><span class="string">'hour'</span><span class="keyword">,</span><span class="string">'amount'&nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; </span><span class="default">60</span><span class="keyword">*</span><span class="default">60&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">),
<br>&nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="string">'name'</span><span class="keyword">=&gt;</span><span class="string">'minute'</span><span class="keyword">,</span><span class="string">'amount'&nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; </span><span class="default">60&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">),
<br>&nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="string">'name'</span><span class="keyword">=&gt;</span><span class="string">'second'</span><span class="keyword">,</span><span class="string">'amount'&nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; </span><span class="default">1&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; );
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$diff </span><span class="keyword">= </span><span class="default">abs</span><span class="keyword">(</span><span class="default">$date1</span><span class="keyword">-</span><span class="default">$date2</span><span class="keyword">);
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$levels </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$current_level </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= array();
<br>&nbsp; &nbsp; foreach(</span><span class="default">$blocks </span><span class="keyword">as </span><span class="default">$block</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$current_level </span><span class="keyword">&gt; </span><span class="default">$levels</span><span class="keyword">) {break;}
<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$diff</span><span class="keyword">/</span><span class="default">$block</span><span class="keyword">[</span><span class="string">'amount'</span><span class="keyword">] &gt;= </span><span class="default">1</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$amount </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$diff</span><span class="keyword">/</span><span class="default">$block</span><span class="keyword">[</span><span class="string">'amount'</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$amount</span><span class="keyword">&gt;</span><span class="default">1</span><span class="keyword">) {</span><span class="default">$plural</span><span class="keyword">=</span><span class="string">'s'</span><span class="keyword">;} else {</span><span class="default">$plural</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;}
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result</span><span class="keyword">[] = </span><span class="default">$amount</span><span class="keyword">.</span><span class="string">' '</span><span class="keyword">.</span><span class="default">$block</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">].</span><span class="default">$plural</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$diff </span><span class="keyword">-= </span><span class="default">$amount</span><span class="keyword">*</span><span class="default">$block</span><span class="keyword">[</span><span class="string">'amount'</span><span class="keyword">];
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$current_level</span><span class="keyword">++;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">,</span><span class="default">$result</span><span class="keyword">).</span><span class="string">' ago'</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br></span><span class="default">?&gt;
<br></span>
<br>[EDIT BY danbrown AT php DOT net: Contains a bugfix supplied by (jorge AT dontspam DOT com) on 22-OCT-2009.]</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78981">  
  <a class="name">
  <strong class="user"><em>stoicnluv at gmail dot com</em></strong></a><div class="date" title="2007-11-05 03:14"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78981">
<div class="phpcode"><code><span class="html">
A better and accurate function to calculate the difference between 2 dates. Takes leap years and DST into consideration. Accepts string date or timestamp as arguments.<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">date_diff</span><span class="keyword">(</span><span class="default">$d1</span><span class="keyword">, </span><span class="default">$d2</span><span class="keyword">){<br>&nbsp; &nbsp; </span><span class="default">$d1 </span><span class="keyword">= (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$d1</span><span class="keyword">) ? </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$d1</span><span class="keyword">) : </span><span class="default">$d1</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$d2 </span><span class="keyword">= (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$d2</span><span class="keyword">) ? </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$d2</span><span class="keyword">) : </span><span class="default">$d2</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">$diff_secs </span><span class="keyword">= </span><span class="default">abs</span><span class="keyword">(</span><span class="default">$d1 </span><span class="keyword">- </span><span class="default">$d2</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$base_year </span><span class="keyword">= </span><span class="default">min</span><span class="keyword">(</span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">, </span><span class="default">$d1</span><span class="keyword">), </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">, </span><span class="default">$d2</span><span class="keyword">));<br><br>&nbsp; &nbsp; </span><span class="default">$diff </span><span class="keyword">= </span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$diff_secs</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">$base_year</span><span class="keyword">);<br>&nbsp; &nbsp; return array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"years" </span><span class="keyword">=&gt; </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">, </span><span class="default">$diff</span><span class="keyword">) - </span><span class="default">$base_year</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"months_total" </span><span class="keyword">=&gt; (</span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">, </span><span class="default">$diff</span><span class="keyword">) - </span><span class="default">$base_year</span><span class="keyword">) * </span><span class="default">12 </span><span class="keyword">+ </span><span class="default">date</span><span class="keyword">(</span><span class="string">"n"</span><span class="keyword">, </span><span class="default">$diff</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"months" </span><span class="keyword">=&gt; </span><span class="default">date</span><span class="keyword">(</span><span class="string">"n"</span><span class="keyword">, </span><span class="default">$diff</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"days_total" </span><span class="keyword">=&gt; </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$diff_secs </span><span class="keyword">/ (</span><span class="default">3600 </span><span class="keyword">* </span><span class="default">24</span><span class="keyword">)),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"days" </span><span class="keyword">=&gt; </span><span class="default">date</span><span class="keyword">(</span><span class="string">"j"</span><span class="keyword">, </span><span class="default">$diff</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"hours_total" </span><span class="keyword">=&gt; </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$diff_secs </span><span class="keyword">/ </span><span class="default">3600</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"hours" </span><span class="keyword">=&gt; </span><span class="default">date</span><span class="keyword">(</span><span class="string">"G"</span><span class="keyword">, </span><span class="default">$diff</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"minutes_total" </span><span class="keyword">=&gt; </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$diff_secs </span><span class="keyword">/ </span><span class="default">60</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"minutes" </span><span class="keyword">=&gt; (int) </span><span class="default">date</span><span class="keyword">(</span><span class="string">"i"</span><span class="keyword">, </span><span class="default">$diff</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"seconds_total" </span><span class="keyword">=&gt; </span><span class="default">$diff_secs</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"seconds" </span><span class="keyword">=&gt; (int) </span><span class="default">date</span><span class="keyword">(</span><span class="string">"s"</span><span class="keyword">, </span><span class="default">$diff</span><span class="keyword">)<br>&nbsp; &nbsp; );<br>}<br><br></span><span class="default">$a </span><span class="keyword">= </span><span class="default">date_diff</span><span class="keyword">(</span><span class="string">"2006-11-01"</span><span class="keyword">, </span><span class="string">"2007-11-01"</span><span class="keyword">);<br><br>echo </span><span class="string">"&lt;pre&gt;"</span><span class="keyword">;<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br>echo </span><span class="string">"&lt;/pre&gt;"</span><span class="keyword">;<br></span><span class="default">?&gt;<br></span><br>This example will output (if your timezone uses US DST):<br><br>Array<br>(<br>&nbsp; &nbsp; [years] =&gt; 0<br>&nbsp; &nbsp; [months_total] =&gt; 11<br>&nbsp; &nbsp; [months] =&gt; 11<br>&nbsp; &nbsp; [days_total] =&gt; 364<br>&nbsp; &nbsp; [days] =&gt; 30<br>&nbsp; &nbsp; [hours_total] =&gt; 8759<br>&nbsp; &nbsp; [hours] =&gt; 23<br>&nbsp; &nbsp; [minutes_total] =&gt; 525540<br>&nbsp; &nbsp; [minutes] =&gt; 0<br>&nbsp; &nbsp; [seconds_total] =&gt; 31532400<br>&nbsp; &nbsp; [seconds] =&gt; 0<br>)<br><br>As you can see, the result is not exactly 1 year (less 1 hour) since Nov 1, 2006 is not DST while Nov 1, 2007 is DST.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/ref.datetime.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:46:43 GMT -->


</body></html>