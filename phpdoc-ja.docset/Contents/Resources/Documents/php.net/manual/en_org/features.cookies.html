<html><!-- Mirrored from php.net/manual/en/features.cookies.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:21:01 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Cookies</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="features.cookies.html">
 <link rel="shorturl" href="http://php.net/cookies">
 <link rel="alternate" href="http://php.net/cookies" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="features.html">
 <link rel="prev" href="features.http-auth.html">
 <link rel="next" href="features.sessions.html">

 <link rel="alternate" href="features.cookies.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/features.cookies.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/features.cookies.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/features.cookies.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/features.cookies.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/features.cookies.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/features.cookies.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/features.cookies.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/features.cookies.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/features.cookies.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/features.cookies.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="features.html">Features</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="features.cookies" class="chapter">
  <h1>Cookies</h1>


  <p class="para">
   PHP transparently supports <acronym title="Hypertext Transfer Protocol">HTTP</acronym> cookies.  Cookies are a mechanism for
   storing data in the remote browser and thus tracking or identifying return
   users.  You can set cookies using the <span class="function"><a href="function.setcookie.html" class="function">setcookie()</a></span> or
   <span class="function"><a href="function.setrawcookie.html" class="function">setrawcookie()</a></span>
   function.  Cookies are part of the <acronym title="Hypertext Transfer Protocol">HTTP</acronym> header, so
   <span class="function"><a href="function.setcookie.html" class="function">setcookie()</a></span> must be called before any output is sent to
   the browser.  This is the same limitation that <span class="function"><a href="function.header.html" class="function">header()</a></span>
   has. You can use the <a href="ref.outcontrol.html" class="link">output buffering
   functions</a> to delay the script output until you have decided whether
   or not to set any cookies or send any headers.
  </p>

  <p class="para">
   Any cookies sent to you from the client will automatically be included into
   a <var class="varname"><var class="varname"><a href="reserved.variables.cookies.html" class="classname">$_COOKIE</a></var></var> auto-global
   array if <a href="ini.core.html#ini.variables-order" class="link">variables_order</a>
   contains "C". If you wish to assign multiple values to a single
   cookie, just add <em>[]</em> to the cookie name.
  </p>

  <p class="para">
   Depending on <a href="ini.core.html#ini.register-globals" class="link">register_globals</a>,
   regular PHP variables can be created from cookies. However it's not
   recommended to rely on them as this feature is often turned off for the
   sake of security.
   <var class="varname"><var class="varname">$HTTP_COOKIE_VARS</var></var> is also set in earlier versions of PHP
   when the <a href="ini.core.html#ini.track-vars" class="link">track_vars</a> configuration 
   variable is set. (This setting is always on since PHP 4.0.3.)
  </p>

  <p class="para">
   For more details, including notes on browser bugs, see the
   <span class="function"><a href="function.setcookie.html" class="function">setcookie()</a></span> and <span class="function"><a href="function.setrawcookie.html" class="function">setrawcookie()</a></span>
   function.
  </p>

 </div>

<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="90764">  
  <a class="name">
  <strong class="user"><em>Henry</em></strong></a><div class="date" title="2009-05-08 07:15"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90764">
<div class="phpcode"><code><span class="html">
It is better to note not to attach your cookies to and IP and block the IP if it is different as some people use Portable Browsers which will remember the cookies.&nbsp; It is better to show a login screen instead if the IP does not correspond to the session cookie's IP.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="36058">  
  <a class="name">
  <strong class="user"><em>myfirstname at braincell dot cx</em></strong></a><div class="date" title="2003-09-24 08:47"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom36058">
<div class="phpcode"><code><span class="html">
[Editor's note: Wilson's comment has been deleted since it didn't contain much useful information, but this note is preserved although its reference is lost]
<br>
<br>Just a general comment on Wilton's code snippet: It's generally considered very bad practice to store usernames and/or passwords in cookies, whether or not they're obsfucated.&nbsp; Many spyware programs make a point of stealing cookie contents.
<br>
<br>A much better solution would be to either use the PHP built in session handler or create something similar using your own cookie-based session ID.&nbsp; This session ID could be tied to the source IP address or can be timed out as required but since the ID can be expired separately from the authentication criteria the authentication itself is not compromised.
<br>
<br>Stuart Livings</span>
</code></div>
  </div>
 </div>
  <div class="note" id="71256">  
  <a class="name">
  <strong class="user"><em>ingen at stocken.ws</em></strong></a><div class="date" title="2006-11-19 12:26"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom71256">
<div class="phpcode"><code><span class="html">
If you want a secured session not tied to the client IP you can use the valid-for-one-query method below, but to safeguard against a scenario where the legitimate user clicks twice, you can use a shutdown function (register_shutdown_function)*.<br><br>It will check to see if the script terminated prematurely (connection_aborted), and reset the valid session ID. That way, it's still valid when the user makes the second request. If the script ends properly, the new session ID will be used instead.<br><br>Now, since you can't set a cookie from the shutdown function (after output has been sent), the cookie should contain both the previous valid session ID and the new one. Then the server script will determine (on the next request) which one to use.<br><br>:: Pseudo example:<br>:: <br>:: [Start of script:]<br>:: <br>:: 1. Get the session ID(s) from cookie<br>:: 2. If one of the session ID's is still valid (that is, if there's a storage associated with it - in DB, file or whatever)<br>::&nbsp; ____2.1. Open the session<br>:: 3. Generate a new session ID<br>:: 4. Save the new session ID with the one just used in cookie<br>:: 5. Register shutdown function<br>:: <br>:: [End of script (shutdown function):]<br>:: <br>:: 1. If script ended prematurely<br>:: ____1.1. Save session data using the old Session ID<br>:: 2. Else<br>:: ____2.1. Save session data using the new Session ID<br>:: ____2.2. Make sure the old session ID is added to a list of ID's (used for the purpose described below)<br>:: ____2.3. Trash the old session storage<br><br>There's still the possibility of some deviant network sniffer catching the session cookie as it's sent to the client, and using it before the client gets the chance to. Thus, successfully hijacking the session. <br><br>If an old session ID is used, we must assume the session has been hijacked. Then the client could be asked to input his/her password before data is sent back. Now, since we have to assume that only the legitimate user has the password we won't send back any data until a password is sent from one request.<br><br>And finally, (as a sidenote) we could obscure the login details (if the client has support for javascript) by catching the form as it is sent, take the current timestamp and add it to the form in a dynamically generated hidden form object, replace the password field with a new password that is the MD5 (or similar) of the timestamp and the real password. On the serverside, the script will take the timestamp, look at the user's real password and make the proper MD5. If they match, good, if not, got him! (This will of course only work when we have a user with a session that's previously logged in, since we know what password (s)he's supposed to have.) If the user credentials are saved as md5(username+password), simply ask for both the username and password, md5 them and then md5 the timestamp and the user cred. <br><br>---<br><br>If you need a javascript for md5: <a rel="nofollow" target="_blank">http://pajhome.org.uk/crypt/md5/md5src.html</a><br><br>---<br><br>* You could use session_set_save_handler and make sure the session ID is generated in the open function. I haven't done that so I can't make any comments on it yet.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112000">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2013-04-20 10:56"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112000">
<div class="phpcode"><code><span class="html">
Your note is too short. Trying to test the notes system? Save us the trouble of deleting your test, and don't. It works.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="50288">  
  <a class="name">
  <strong class="user"><em>mega-squall at caramail dot com</em></strong></a><div class="date" title="2005-02-23 01:04"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom50288">
<div class="phpcode"><code><span class="html">
I found a solution for protecting session ID without tying them to client's IP. Each session ID gives access for only ONE querry. On the next querry, another session ID is generated and stored. If somebody hacks the cookie (or the session ID), the first one of the user and the pirate that will use the cookie will get the second disconnected, because the session ID has been used.<br><br>If the user gets disconnected, he will reconnect : as my policy is not to have more than one session ID for each user (sessions entries have a UNIQUE key on the collomn in which is stored user login), every entries for that user gets wiped, a new session ID is generated and stored on users dirve : the pirate gets disconnected. This lets the pirate usually just a few seconds to act. The slower visitors are browsing, the longer is the time pirates get for hacking. Also, if users forget to explicitly end their sessions .... some of my users set timeout longer than 20 minutes !<br><br>IMPORTANT NOTE : This disables the ability of using the back button if you send the session ID via POST or GET.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57560">  
  <a class="name">
  <strong class="user"><em>bmorency at jbmlogic dot com</em></strong></a><div class="date" title="2005-10-07 05:14"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom57560">
<div class="phpcode"><code><span class="html">
In response to the solution posted in the comment below, there are some practical issues with this solution that must be kept in mind and handled by your code. I developed an application using a similar "use-it-once" key to manage sessions and it worked great but we got some complaints about legitimate users getting logged out without reasons. Turns out the problem was not tentative highjacking, it was&nbsp; either:<br><br>A- Users double click on links or make 2 clicks very fast. The same key is sent for the 2 clicks because the new key from the first click didn't get to the browser on time for the second one but the session on the server did trash the key for the new one. Thus, the second click causes a termination of the session. (install the LiveHttpHeaders extension on firefox and look at the headers sent when you click twice very fast, you'll see the same cookie sent on both and the new cookie getting back from the server too late).<br><br>B- For any given reason, the server experiences a slow down and the response with the new key (which has replaced the old one on the server) is not returned to the browser fast enough. The user gets tired of waiting and clicks somewhere else. He gets logged out because this second click send the old key which won't match the one you have on your server.<br><br>Our solution was to set up a grace period where the old key was still valid (the current key and the previous key were both kept at all times, we used 15 seconds as a grace period where the old key could still be used). This has the drawback of increasing the window of time for a person to highjack the session but if you tie the validity of the old key to an IP address and/or user agent string, you still get pretty good session security with very very few undesired session termination.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="61454">  
  <a class="name">
  <strong class="user"><em>kalla_durga at gmail dot com</em></strong></a><div class="date" title="2006-02-03 12:10"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom61454">
<div class="phpcode"><code><span class="html">
In response to the solution posted in the comment below, there are some practical issues with this solution that must be kept in mind and handled by your code. I developed an application using a similar "use-it-once" key to manage sessions and it worked great but we got some complaints about legitimate users getting logged out without reasons. Turns out the problem was not tentative highjacking, it was&nbsp; either:<br><br>A- Users double click on links or make 2 clicks very fast. The same key is sent for the 2 clicks because the new key from the first click didn't get to the browser on time for the second one but the session on the server did trash the key for the new one. Thus, the second click causes a termination of the session. (install the LiveHttpHeaders extension on firefox and look at the headers sent when you click twice very fast, you'll see the same cookie sent on both and the new cookie getting back from the server too late).<br><br>B- For any given reason, the server experiences a slow down and the response with the new key (which has replaced the old one on the server) is not returned to the browser fast enough. The user gets tired of waiting and clicks somewhere else. He gets logged out because this second click send the old key which won't match the one you have on your server.<br><br>Our solution was to set up a grace period where the old key was still valid (the current key and the previous key were both kept at all times, we used 15 seconds as a grace period where the old key could still be used). This has the drawback of increasing the window of time for a person to highjack the session but if you tie the validity of the old key to an IP address and/or user agent string, you still get pretty good session security with very very few undesired session termination.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112017">  
  <a class="name">
  <strong class="user"><em>meetyashah at gmail dot com</em></strong></a><div class="date" title="2013-04-22 11:53"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112017">
<div class="phpcode"><code><span class="html">
PAGE 1<br><br><span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">"first"</span><span class="keyword">]; </span><span class="default">?&gt;<br></span><br>PAGE 2<br><br><span class="default">&lt;?php </span><span class="keyword">if(isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">"first"</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">"first"</span><span class="keyword">];}<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; if(isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">"second"</span><span class="keyword">])){<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">"second"</span><span class="keyword">];&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; if(isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">"third"</span><span class="keyword">])){<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">"third"</span><span class="keyword">];&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/features.cookies.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:21:01 GMT -->


</body></html>