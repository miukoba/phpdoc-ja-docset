<html><!-- Mirrored from php.net/manual/en/ref.pdo-sqlite.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:57:42 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>SQLite (PDO)</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="ref.pdo-sqlite.html">
 <link rel="shorturl" href="http://php.net/pdo-sqlite">
 <link rel="alternate" href="http://php.net/pdo-sqlite" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="pdo.drivers.html">
 <link rel="prev" href="pdo.pgsqllobunlink.html">
 <link rel="next" href="ref.pdo-sqlite.connection.html">

 <link rel="alternate" href="ref.pdo-sqlite.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/ref.pdo-sqlite.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/ref.pdo-sqlite.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/ref.pdo-sqlite.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/ref.pdo-sqlite.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/ref.pdo-sqlite.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/ref.pdo-sqlite.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/ref.pdo-sqlite.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/ref.pdo-sqlite.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/ref.pdo-sqlite.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/ref.pdo-sqlite.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.abstract.html">Abstraction Layers</a></li>      <li><a href="book.pdo.html">PDO</a></li>      <li><a href="pdo.drivers.html">PDO Drivers</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="ref.pdo-sqlite" class="reference">
  
  <h1 class="title">SQLite Functions (PDO_SQLITE)</h1>
  
  <div class="partintro">

   <div class="section" id="pdo-sqlite.intro">
   <h2 class="title">Introduction</h2>
    <p class="para">
     PDO_SQLITE is a driver that implements the <a href="intro.pdo.html" class="link">PHP
     Data Objects (PDO) interface</a> to enable access to SQLite 3 databases.
    </p>
    <p class="para">
     In PHP 5.1, the <a href="ref.sqlite.html" class="link">SQLite</a> extension also
     provides a driver for SQLite 2 databases; while it is not technically a
     part of the PDO_SQLITE driver, it behaves similarly, so it is
     documented alongside it.  The SQLite 2 driver for PDO is provided
     primarily to make it easier to import legacy SQLite 2 database files into
     an application that uses the faster, more efficient SQLite 3 driver.  As
     a result, the SQLite 2 driver is not as feature-rich as the SQLite 3
     driver.
    </p>
    <blockquote class="note"><p><strong class="note">Note</strong>: 
     </p><p class="para">
      PDO_SQLITE allows using strings apart from streams together with
      <strong><code>PDO::PARAM_LOB</code></strong>.
     </p>
    <p></p></blockquote>
   </div>

   

<div class="section" id="ref.pdo-sqlite.installation">
 <h2 class="title">Installation</h2>
 <p class="para">
  The PDO_SQLITE PDO driver is enabled by default. To disable,
  <strong class="option configure">--without-pdo-sqlite[=DIR]</strong>
 may be used, 
  where the optional <em>[=DIR]</em> is the sqlite base install directory.
 </p>
</div>




  </div>

  

 













 <h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="ref.pdo-sqlite.connection.html">PDO_SQLITE DSN</a> — Connecting to SQLite databases</li><li><a href="pdo.sqlitecreateaggregate.html">PDO::sqliteCreateAggregate</a> — Registers an aggregating User Defined Function for use in SQL statements</li><li><a href="pdo.sqlitecreatefunction.html">PDO::sqliteCreateFunction</a> — Registers a User Defined Function for use in SQL statements</li></ul>
</div>

<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="110595">  
  <a class="name">
  <strong class="user"><em>nospam8715 at dririan dot com</em></strong></a><div class="date" title="2012-11-10 09:22"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom110595">
<div class="phpcode"><code><span class="html">
Instead of compiling an old version of SQLite to create a database using an older database format that the version of SQLite bundled with PDO can handle, you can (much more easily) just run the query "PRAGMA legacy_file_format = TRUE;" BEFORE creating the database (if you have an existing database, run ".dump" from the sqlite shell on your database, run the sqlite shell on a new database, run the PRAGMA, then paste the contents of the .dump). That will ensure SQLite creates a database readable by SQLite 3.0 and later.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74139">  
  <a class="name">
  <strong class="user"><em>gopal at gopalarathnam dot com</em></strong></a><div class="date" title="2007-03-27 02:36"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74139">
<div class="phpcode"><code><span class="html">
If you get an error reporting "invalid resource" when trying to query the database table and looping through it, the version of the SQLite extension compiled in to PHP might be incompatible with the version that had created the database (like SQLite 2.x vs 3.x).<br><br>The database open itself might be successful, failing only when querying.<br><br>$dbh = new PDO('sqlite:/tmp/foo.db'); // success<br>foreach ($dbh-&gt;query('SELECT * FROM bar') as $row) // prints invalid resource<br>&nbsp; &nbsp; // ...</span>
</code></div>
  </div>
 </div>
  <div class="note" id="67937">  
  <a class="name">
  <strong class="user"><em>Duffalo</em></strong></a><div class="date" title="2006-07-06 04:41"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom67937">
<div class="phpcode"><code><span class="html">
Note that as of the date of this post, PDO_SQLITE will not interact with database files created with the current version of the SQLite console application, sqlite-3.3.6.<br><br>It is currently necessary to obtain version 3.2.8, available from <a rel="nofollow" target="_blank">http://www.sqlite.org/</a> but only by entering the URI manually, as there is no link. Go to <a rel="nofollow" target="_blank">http://www.sqlite.org/download.html</a> and find the URI of the version you're looking for, then make the appropriate version number substitution.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57356">  
  <a class="name">
  <strong class="user"><em>aidan at php dot net</em></strong></a><div class="date" title="2005-10-01 02:36"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom57356">
<div class="phpcode"><code><span class="html">
If you receive an error while trying to write to a sqlite database (update, delete, drop):<br><br>Warning: PDO::query() [function.query]: SQLSTATE[HY000]: General error: 1 unable to open database<br><br>The folder that houses the database file must be writeable.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115031">  
  <a class="name">
  <strong class="user"><em>tris dot php at tfconsulting dot com dot au</em></strong></a><div class="date" title="2014-05-15 04:34"><strong>3 months ago</strong></div>
  <div class="text" id="Hcom115031">
<div class="phpcode"><code><span class="html">
After wrestling with "General error: 5 database is locked" errors for a highly concurrent project I finally wrapped the PDO transaction code with a semaphore.&nbsp; No errors since...<br><br>Obviously only works if all processes use the subclass and wrap database modifying statements in beginTransaction() .. commit().&nbsp; The same could be achieved with flock() if semaphore is not available on your system but will be slower.<br><br><span class="default">&lt;?php<br></span><span class="keyword">class </span><span class="default">SQLitePDO </span><span class="keyword">extends </span><span class="default">PDO </span><span class="keyword">{<br>&nbsp; &nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$filename </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="string">'sqlite:' </span><span class="keyword">. </span><span class="default">$filename</span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">ftok</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sem </span><span class="keyword">= </span><span class="default">sem_get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; function </span><span class="default">beginTransaction</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">sem_acquire</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sem</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">beginTransaction</span><span class="keyword">();<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; function </span><span class="default">commit</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$success </span><span class="keyword">= </span><span class="default">parent</span><span class="keyword">::</span><span class="default">commit</span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">sem_release</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sem</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$success</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; function </span><span class="default">rollBack</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$success </span><span class="keyword">= </span><span class="default">parent</span><span class="keyword">::</span><span class="default">rollBack</span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">sem_release</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sem</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$success</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="68780">  
  <a class="name">
  <strong class="user"><em>gmac63 at charter dot net</em></strong></a><div class="date" title="2006-08-10 07:38"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom68780">
<div class="phpcode"><code><span class="html">
Issue:<br>Error: SQLSTATE[HY000]: General error: 1 unsupported file format <br><br>Resolution:<br>To solve this (and/or many issues) involving this type of error, I assumed the error to be generated from php. Well, it was to an extent. The sqlite pdo code offered the solution:<br><br>I researched the error by grep'ing the php source code and found the error string to come from php-5.1.4/ext/pdo_sqlite/sqlite/src/prepare.c, lines 265:278 :<br><br>/*<br> ** file_format==1&nbsp; &nbsp; Version 3.0.0.<br> ** file_format==2&nbsp; &nbsp; Version 3.1.3.<br> ** file_format==3&nbsp; &nbsp; Version 3.1.4.<br> **<br> ** Version 3.0 can only use files with file_format==1. Version 3.1.3<br> ** can read and write files with file_format==1 or file_format==2.<br> ** Version 3.1.4 can read and write file formats 1, 2 and 3.<br> */<br> if( meta[1]&gt;3 ){<br>&nbsp;&nbsp; sqlite3BtreeCloseCursor(curMain);<br>&nbsp;&nbsp; sqlite3SetString(pzErrMsg, "unsupported file format", (char*)0);<br>&nbsp;&nbsp; return SQLITE_ERROR;<br> }<br><br>This is interesting as I am running SQLite version 3.3.5 which the databases were created in. I see that the SQLite PDO source in the php source is :<br>&nbsp; &nbsp; &nbsp; # cat ext/pdo_sqlite/sqlite/VERSION<br>&nbsp; &nbsp; &nbsp;&nbsp; 3.2.8<br><br>My solution was then to find a version of sqlite that was =&lt; 3.1.4. I found source for 3.1.3, compiled, recreated my database using that version (NOTE: the databases are unsupported between 3.1.x and 3.2.x versions of SQLite). Once I did this it worked.<br><br>Also as a side note, to get SQLite compiled as a PDO, I had to:<br><br>1) configure with<br>...<br>--enable-pdo=shared \<br>--with-sqlite=shared \<br>--with-pdo-sqlite=shared<br>--with-zlib<br>... \<br>'make &amp;&amp; make install' if configure is successful.<br><br>2) Make sure the pdo libs were copied/installed to the correct directory. On my installation it was /usr/local/include/php/ext/pdo/<br><br>3) Make these changes in my php.ini:<br>&nbsp; - change ' extension_dir = "./" ' to ' extension_dir="/usr/local/include/php/ext/pdo/" '<br>&nbsp; - add/edit in this order:<br>&nbsp; &nbsp; &nbsp; extension=pdo.so<br>&nbsp; &nbsp; &nbsp; extension=pdo_sqlite.so<br>&nbsp; &nbsp; &nbsp; extension=sqlite.so<br><br>4) test php with : 'php -m' at the command line and solve any issues from there. Mostly php.ini config issues. Also restart the http service!</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/ref.pdo-sqlite.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:57:42 GMT -->


</body></html>