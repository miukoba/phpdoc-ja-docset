<html><!-- Mirrored from php.net/manual/en/function.mysql-num-rows.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:57:57 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>mysql_num_rows</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.mysql-num-rows.html">
 <link rel="shorturl" href="http://php.net/mysql-num-rows">
 <link rel="alternate" href="http://php.net/mysql-num-rows" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.mysql.html">
 <link rel="prev" href="function.mysql-num-fields.html">
 <link rel="next" href="function.mysql-pconnect.html">

 <link rel="alternate" href="function.mysql-num-rows.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.mysql-num-rows.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.mysql-num-rows.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.mysql-num-rows.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.mysql-num-rows.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.mysql-num-rows.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.mysql-num-rows.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.mysql-num-rows.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.mysql-num-rows.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.mysql-num-rows.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.mysql-num-rows.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.vendors.html">Vendor Specific Database Extensions</a></li>      <li><a href="set.mysqlinfo.html">MySQL</a></li>      <li><a href="book.mysql.html">Mysql</a></li>      <li><a href="ref.mysql.html">MySQL Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.mysql-num-rows" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysql_num_rows</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mysql_num_rows</span> â€” <span class="dc-title">Get number of rows in result</span></p>

 </div>

 <div id="function.mysql-num-rows-refsynopsisdiv">
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">This extension is deprecated as of PHP 5.5.0, and will be removed in the future.
Instead, the <a href="book.mysqli.html" class="link">MySQLi</a> or <a href="ref.pdo-mysql.html" class="link">PDO_MySQL</a> extension should be used.
See also <a href="mysqlinfo.api.choosing.html" class="link">MySQL: choosing an API</a> guide and
<a href="faq.databases.html#faq.databases.mysql.deprecated" class="link">related FAQ</a> for more information. 
Alternatives to this function include:</p>
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli-result.num-rows.html" class="function">mysqli_num_rows()</a></span></li>
    <li class="member"><span class="function"><a href="mysqli-stmt.num-rows.html" class="function">mysqli_stmt_num_rows()</a></span></li>
    <li class="member"><span class="methodname"><a href="pdostatement.rowcount.html" class="methodname">PDOStatement::rowCount()</a></span></li>
   </ul>
  </div>
 </div>

 <div class="refsect1 description" id="refsect1-function.mysql-num-rows-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><strong>mysql_num_rows</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result</code></span>
   )</div>

  <p class="para rdfs-comment">
   Retrieves the number of rows from a result set. This command is only valid 
   for statements like SELECT or SHOW that return an actual result set. 
   To retrieve the number of rows affected by a INSERT, UPDATE, REPLACE or 
   DELETE query, use <span class="function"><a href="function.mysql-affected-rows.html" class="function">mysql_affected_rows()</a></span>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mysql-num-rows-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    <dt>
<code class="parameter">
result</code></dt>
<dd>
<p class="para">The result <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span> that
is being evaluated. This result comes from a call to
<span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span>.</p></dd>

   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysql-num-rows-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   The number of rows in a result set on success or <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mysql-num-rows-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-1686">
    <p><strong>Example #1 <span class="function"><strong>mysql_num_rows()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"mysql_user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"mysql_password"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">mysql_select_db</span><span style="color: #007700">(</span><span style="color: #DD0000">"database"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;*&nbsp;FROM&nbsp;table1"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$num_rows&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_num_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br><br>echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$num_rows</span><span style="color: #DD0000">&nbsp;Rows\n"</span><span style="color: #007700">;<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mysql-num-rows-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    If you use <span class="function"><a href="function.mysql-unbuffered-query.html" class="function">mysql_unbuffered_query()</a></span>, 
    <span class="function"><strong>mysql_num_rows()</strong></span> will not return the 
    correct value until all the rows in the result set have been 
    retrieved.
   </p>
  <p></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    For backward compatibility, the following
deprecated alias may be used: 
    <span class="function"><strong>mysql_numrows()</strong></span>
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysql-num-rows-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mysql-affected-rows.html" class="function" rel="rdfs-seeAlso">mysql_affected_rows()</a> - Get number of affected rows in previous MySQL operation</span></li>
    <li class="member"><span class="function"><a href="function.mysql-connect.html" class="function" rel="rdfs-seeAlso">mysql_connect()</a> - Open a connection to a MySQL Server</span></li>
    <li class="member"><span class="function"><a href="function.mysql-data-seek.html" class="function" rel="rdfs-seeAlso">mysql_data_seek()</a> - Move internal result pointer</span></li>
    <li class="member"><span class="function"><a href="function.mysql-select-db.html" class="function" rel="rdfs-seeAlso">mysql_select_db()</a> - Select a MySQL database</span></li>
    <li class="member"><span class="function"><a href="function.mysql-query.html" class="function" rel="rdfs-seeAlso">mysql_query()</a> - Send a MySQL query</span></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="18191">  
  <a class="name">
  <strong class="user"><em>tac at smokescreen dot org</em></strong></a><div class="date" title="2002-01-13 11:58"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom18191">
<div class="phpcode"><code><span class="html">
MySQL 4.0 supports a fabulous new feature that allows you to get the number of rows that would have been returned if the query did not have a LIMIT clause.&nbsp; To use it, you need to add SQL_CALC_FOUND_ROWS to the query, e.g.<br><br>$sql = "Select SQL_CALC_FOUND_ROWS * from table where state='CA' limit 50";<br>$result = mysql_query($sql);<br><br>$sql = "Select FOUND_ROWS()";<br>$count_result = mysql_query($sql);<br><br>You now have the total number of rows in table that match the criteria.&nbsp; This is great for knowing the total number of records when browsing through a list.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="49487">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2005-01-29 05:18"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom49487">
<div class="phpcode"><code><span class="html">
In response to oran at trifeed dot com:<br><br>You are only experiencing this behaviour because you have not given your FOUND_ROWS() result an alias:<br><br>$qry = mysql_query ( 'SELECT FOUND_ROWS() AS total' );<br>$rst = mysql_fetch_array ( $qry, MYSQL_ASSOC );<br>echo $rst['total'];<br><br>Sean :)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83469">  
  <a class="name">
  <strong class="user"><em>timo</em></strong></a><div class="date" title="2008-05-27 09:03"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83469">
<div class="phpcode"><code><span class="html">
&lt;?<br>$strQuery="SELECT * FROM `tabel`";<br>$strResult = mysql_query($strQuery);<br>$Aantalvelden = mysql_num_fields($strResult);<br>$Aantalrijen=mysql_num_rows($strResult);<br><br>echo "&lt;table border='1'&gt;&lt;tr&gt;";<br>for($ikolom=0;$ikolom&lt;$Aantalvelden;$ikolom++){<br>$strVeldnaam = mysql_field_name($strResult,$ikolom);<br>echo "&lt;td&gt;$strVeldnaam&lt;/td&gt;" ;<br>}<br>echo "&lt;/tr&gt;";<br><br>for($ir=0;$irij&lt;$Aantalrijen;$irij++){<br>echo "&lt;tr&gt;";<br>for($ikolom=0;$ikolom&lt;$Aantalvelden;$ikolom++){<br>$strKolomwaarde = mysql_result($strResult,$irij,$ikolom);<br>echo "&lt;td&gt;$strKolomwaarde&lt;/td&gt;";<br>}<br>}<br>echo "&lt;/table&gt;";<br>?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="48219">  
  <a class="name">
  <strong class="user"><em>oran at trifeed dot com</em></strong></a><div class="date" title="2004-12-15 09:06"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom48219">
<div class="phpcode"><code><span class="html">
For me <br><br>SELECT SQL_CALC_FOUND_ROWS together with<br>SELECT FOUND_ROWS()<br><br>Only worked with the following syntax:<br>$result = @mysql_query($query);<br>$resultTotal = @mysql_query("SELECT FOUND_ROWS()");<br>$res=&nbsp; &nbsp; mysql_fetch_array($resultTotal);<br>echo $res['FOUND_ROWS()'];<br><br>hope it helped<br><br>oran<br><a rel="nofollow" target="_blank">http://www.trifeed.com</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="47521">  
  <a class="name">
  <strong class="user"><em>pjoe444 at yahoo dot com</em></strong></a><div class="date" title="2004-11-18 03:38"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47521">
<div class="phpcode"><code><span class="html">
Re my last entry:<br><br>This seems the best workaround to get an 'ordinary' loop going, with possibility of altering output according to row number<br>(eg laying out a schedule)<br><br>$rowno=mysql_num_rows($result);<br><br>for ($i=0; $i&lt;mysql_num_rows($result); $i++) {<br>$row = mysql_fetch_assoc($result);<br><br>print "&lt;div class=\"showing\"&gt;";<br>print "&lt;b&gt;".$row['timeon']."-".$row['timeoff']."&lt;/b&gt; ".$row['event']."&lt;br /&gt;;<br>if ($i!=$rowno-1) {<br>&nbsp; &nbsp; print "other-html-within-sched-here&lt;/div&gt;"; <br>&nbsp; &nbsp; }&nbsp; <br>else print "end-last-entry-html-here&lt;/div&gt;"; <br>}&nbsp; //close loop</span>
</code></div>
  </div>
 </div>
  <div class="note" id="29699">  
  <a class="name">
  <strong class="user"><em>aaronp123 att yahoo dott comm</em></strong></a><div class="date" title="2003-02-21 05:40"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom29699">
<div class="phpcode"><code><span class="html">
I may indeed be the only one ever to encounter this - however if you have a myisam table with one row, and you search with valid table and column name for a result where you might expect 0 rows, you will not get 0, you will get 1, which is the myisam optimised response when a table has 0 or one rows.&nbsp; Under "5.2.4 How MySQL Optimises WHERE Clauses" it reads:<br><br>*Early detection of invalid constant expressions. MySQL quickly detects that some SELECT statements are impossible and returns no rows. <br><br>and<br><br>*All constant tables are read first, before any other tables in the query. A constant table is: <br>1) An empty table or a table with 1 row. <br>2) A table that is used with a WHERE clause on a UNIQUE index, or a PRIMARY KEY, where all index parts are used with constant expressions and the index parts are defined as NOT NULL. <br><br>Hopefully this will keep someone from staying up all night with 1146 errors, unless I am completely mistaken in thinking I have this figured out.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76463">  
  <a class="name">
  <strong class="user"><em>Typer85 at gmail dot com</em></strong></a><div class="date" title="2007-07-16 11:44"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76463">
<div class="phpcode"><code><span class="html">
A note on the following usage; that suggest to use several MySQL Functions to get the number of Table Records.<br><br>You may be familiar with following:<br><br><span class="default">&lt;?php<br><br>$sqlQuery </span><span class="keyword">= </span><span class="string">'Select SQL_CALC_FOUND_ROWS `MyField` From `MyTable` Limit 1;'</span><span class="keyword">; <br><br></span><span class="default">$sqlQuery_1 </span><span class="keyword">= </span><span class="string">'Select FOUND_ROWS( );'</span><span class="keyword">;<br><br></span><span class="default">?&gt;<br></span><br>I omitted the actual connection to MySQL and the execution of the query, but you get the idea.<br><br>I did some tests and on a fairly high traffic web site, one that executes several queries quite often and found that using this combination of MySQL Functions can actually result in wrong results.<br><br>For example, assume I have two queries to get the number of Table Records in two different Tables. So in essence, we are executing 4 queries ( 2 queries for each Table ).<br><br>If two different requests come in through PHP, your going to run into problems. Note than when I mean request, I mean two different clients requesting your PHP page.<br><br>---------------<br>Request 1:<br>---------------<br><br>Execute: SQL_CALC_FOUND_ROWS On Table 1<br><br>---------------<br>Request 2:<br>---------------<br><br>Execute: SQL_CALC_FOUND_ROWS On Table 2<br><br>---------------<br>Request 1:<br>---------------<br><br>Execute: Select FOUND_ROWS( )<br><br>At this point, you see the race condition that occurred. While Request 1 was being executed, Request 2 came in.<br><br>At this point Request 1 will return the number of Table Records in Table 2 and not Table 1 as expected!<br><br>Why? Because MySQL does not differ between requests. Each query is in a queue waiting its turn. As soon as its turn comes in it will be executed my MySQL.<br><br>The MySQL Function Select FOUND_ROWS( ) will return the result of the last SQL_CALC_FOUND_ROWS!<br><br>Keep in mind.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96845">  
  <a class="name">
  <strong class="user"><em>Typer85 at gmail dot com</em></strong></a><div class="date" title="2010-03-18 11:20"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96845">
<div class="phpcode"><code><span class="html">
Actually I am a little ashamed to be saying this, but I stand corrected about a rather old note I posted on 17-Jul-2007 06:44.<br><br>Using SQL_CALC_FOUND_ROWS and FOUND_ROWS( ) will NOT trigger a race condition on MySQL, as that would pretty much defy their entire purpose.<br><br>The results for their usage is actually unique per connection session as it is impossible for processes to share anything in PHP. As far as PHP is concerned, each request represents a new connection to MySQL as each request is isolated to its own process.<br><br>To simulate this, create the following script:<br><br><span class="default">&lt;?php<br><br>$Handle </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">( </span><span class="string">"localhost" </span><span class="keyword">, </span><span class="string">"root" </span><span class="keyword">, </span><span class="string">"" </span><span class="keyword">);<br></span><span class="default">mysql_select_db</span><span class="keyword">( </span><span class="string">"lls" </span><span class="keyword">);<br><br>if( isset( </span><span class="default">$_GET</span><span class="keyword">[ </span><span class="string">'Sleep' </span><span class="keyword">] ) ) {<br>&nbsp; &nbsp; </span><span class="default">mysql_query</span><span class="keyword">( </span><span class="string">"SELECT SQL_CALC_FOUND_ROWS `bid` From `blocks` Limit 1" </span><span class="keyword">);<br>} else {<br>&nbsp; &nbsp; </span><span class="default">mysql_query</span><span class="keyword">( </span><span class="string">"SELECT SQL_CALC_FOUND_ROWS `aid` From `access` Limit 1" </span><span class="keyword">);<br>}<br><br>if( isset( </span><span class="default">$_GET</span><span class="keyword">[ </span><span class="string">'Sleep' </span><span class="keyword">] ) ) {<br>&nbsp; &nbsp; </span><span class="default">sleep</span><span class="keyword">( </span><span class="default">10 </span><span class="keyword">); </span><span class="comment">// Simulate another HTTP request coming in.<br>&nbsp; &nbsp; </span><span class="default">$Result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">( </span><span class="string">"SELECT FOUND_ROWS( )" </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">mysql_fetch_array</span><span class="keyword">( </span><span class="default">$Result </span><span class="keyword">) );<br>}<br><br></span><span class="default">mysql_close</span><span class="keyword">( );<br><br></span><span class="default">?&gt;<br></span><br>Set the connection and query information for something that matches your environment.<br><br>Run the script once with the Sleep query string and once again without it. Its important to run them both at the same time. Use Apache ab or something similar, or even easier, just open two browser tabs. For example:<br><br><a rel="nofollow" target="_blank">http://localhost/Script.php?Sleep=10</a><br><a rel="nofollow" target="_blank">http://localhost/Script.php</a><br><br>If a race condition existed, the results of the first instance of the script would equal the results of the second instance of the script.<br><br>For example, the second instance of the script will execute the following SQL query:<br><br><span class="default">&lt;?php<br><br>mysql_query</span><span class="keyword">( </span><span class="string">"SELECT SQL_CALC_FOUND_ROWS `aid` From `access` Limit 1" </span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>This happens while the first instance of the script is sleeping. If a race condition existed, when the first instance of the script wakes up, the result of the FOUND_ROWS( ) it executes should be the number of rows in the SQL query the second instance of the script executed.<br><br>But when you run them, this is not the case. The first instance of the script returns the number of rows of its OWN query, which is:<br><br><span class="default">&lt;?php<br><br>mysql_query</span><span class="keyword">( </span><span class="string">"SELECT SQL_CALC_FOUND_ROWS `bid` From `blocks` Limit 1" </span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>So it turns out NO race condition exists, and every solution presented to combat this "issue" are pretty much not needed.<br><br>Good Luck,</span>
</code></div>
  </div>
 </div>
  <div class="note" id="50166">  
  <a class="name">
  <strong class="user"><em>dzver at abv dot bg</em></strong></a><div class="date" title="2005-02-20 05:00"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom50166">
<div class="phpcode"><code><span class="html">
It is faster to run second query "select count(...) from ... ", than adding SQL_CALC_FOUND_ROWS to your first query, and then using select FOUND_ROWS() + mysql_num_rows().</span>
</code></div>
  </div>
 </div>
  <div class="note" id="47520">  
  <a class="name">
  <strong class="user"><em>pjoe444 at yahoo dot com</em></strong></a><div class="date" title="2004-11-18 02:24"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47520">
<div class="phpcode"><code><span class="html">
A pity there seems no way of getting the CURRENT&nbsp; row number that's under iteration in a typical loop, <br>such as:<br>while ($row = mysql_fetch_assoc($result)) { }<br><br>After all there is an array of row arrays, as signified by<br>mysql_num_rows($result):<br><br>Say this gives "40 rows" : it would be useful to know when the iteration is on row 39.<br><br>The nearest seems to be "data seek":but it connects directly to a<br>row number eg (from mysql_data_seek page)<br><br>for ($i = mysql_num_rows($result) - 1; $i &gt;= 0; $i--) {<br>&nbsp;&nbsp; if (!mysql_data_seek($result, $i)) {<br>&nbsp; &nbsp; &nbsp;&nbsp; echo "Cannot seek to row $i: " . mysql_error() . "\n";<br>&nbsp; &nbsp; &nbsp;&nbsp; continue;<br>&nbsp;&nbsp; }<br><br>= it still wouldn't solve knowing what row number you're on in an ordinary loop.<br><br>One reason for this situation is the php fetch (fetch-a-single-row) construction, without any reasonable FOR loop possibility with row numbers.<br><br>Suggestion:<br>$Rows[$i] possibility where<br>$i would be the row number<br><br>$Rows[$row[], $row[], $row[].....]<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp;&nbsp; etc<br><br>-- the excellent retrieval WITHIN a row ( $row[$i] ),<br>while certainly more important,&nbsp; is not matched by <br>similar possibilities for rows themselves.<br><br>and Count($result) doesnt work of course, $result being a <br>mere ticket-identifier...<br><br>Peter T</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83647">  
  <a class="name">
  <strong class="user"><em>Tom Fejfar</em></strong></a><div class="date" title="2008-06-05 01:56"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83647">
<div class="phpcode"><code><span class="html">
Improvement to chrisdberry82 at gmail dot com's code:<br><br><span class="default">&lt;?php<br>$sql </span><span class="keyword">= </span><span class="string">"<br>SELECT SQL_CALC_FOUND_ROWS <br>&nbsp; '0', z.id<br>FROM <br>&nbsp; zoom AS z <br>LIMIT <br>&nbsp; 0,6 <br>UNION <br>&nbsp; SELECT <br>&nbsp; &nbsp; '1', FOUND_ROWS() <br>ORDER BY `0` DESC , RAND()"</span><span class="keyword">;<br></span><span class="default">?&gt;<br></span><br>You can see, that you can even ORDER the final result anyway you like ;)<br>Then you can fetch the result like this:<br><span class="default">&lt;?php<br>$res </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br></span><span class="default">$count </span><span class="keyword">= </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">); <br>while(</span><span class="default">$row </span><span class="keyword">= </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">)){<br> unset(</span><span class="default">$row</span><span class="keyword">[</span><span class="string">"0"</span><span class="keyword">]); </span><span class="comment">//get rid of the "sorting col"<br> </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">); </span><span class="comment">//or whatever ;)<br></span><span class="keyword">}<br>echo </span><span class="default">$count</span><span class="keyword">[</span><span class="string">"id"</span><span class="keyword">]; </span><span class="comment">// the total number of rows<br></span><span class="default">?&gt;<br></span><br>And you got rid of the lousy IFs ;)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="47144">  
  <a class="name">
  <strong class="user"><em>sam at liddicott dot com</em></strong></a><div class="date" title="2004-11-04 05:40"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom47144">
<div class="phpcode"><code><span class="html">
Some user comments on this page, and some resources including the FAQ at :<br><br><a rel="nofollow" target="_blank">http://www.faqts.com/knowledge_base/view.phtml/aid/114/fid/12</a> suggest using count(*) to count the number of rows<br><br>This is not a particularly universal solution, and those who read these comments on this page should also be aware that <br><br>select count(*) may not give correct results if you are using "group by" or "having" in your query, as count(*) is an agregate function and resets eachtime a group-by column changes.<br><br>select sum(..) ... left join .. group by ... having ...<br><br>can be an alternative to sub-selects in mysql 3, and such queries cannot have the select fields replaced by count(*) to give good results, it just doesn't work.<br><br>Sam</span>
</code></div>
  </div>
 </div>
  <div class="note" id="12780">  
  <a class="name">
  <strong class="user"><em>philip at cornado dot c()m</em></strong></a><div class="date" title="2001-05-06 11:37"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom12780">
<div class="phpcode"><code><span class="html">
Regarding SQL count(), see this faq :
<br>* <a rel="nofollow" target="_blank">http://www.faqts.com/knowledge_base/view.phtml/aid/114/fid/12</a>
<br>Note: If you already have a $result, use mysql_num_rows() on it otherwise use SQL count().&nbsp; Don't SELECT data just for a count.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="58697">  
  <a class="name">
  <strong class="user"><em>simon_nuttall at hotmail dot com</em></strong></a><div class="date" title="2005-11-12 07:36"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom58697">
<div class="phpcode"><code><span class="html">
Object oriented version of wil1488 at gmail dot com's comment for counting table rows:<br><span class="default">&lt;?php<br>$result </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"SELECT COUNT(*) as TOTALFOUND from table"</span><span class="keyword">);<br></span><span class="default">$row_array</span><span class="keyword">=</span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">fetch_array</span><span class="keyword">(</span><span class="default">MYSQLI_ASSOC</span><span class="keyword">);<br>print(</span><span class="default">$row_array</span><span class="keyword">[</span><span class="string">'TOTALFOUND'</span><span class="keyword">]); <br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103032">  
  <a class="name">
  <strong class="user"><em>mauriciocramos at gmail dot com</em></strong></a><div class="date" title="2011-03-21 12:43"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103032">
<div class="phpcode"><code><span class="html">
When mysql.trace_mode = On, SELECT FOUND_ROWS() allway returns 0.&nbsp; It looks like a bug.<br><br>In detail:<br><br>If you have a table with 5 rows and issue:<br><br>SELECT SQL_CALC_FOUND_ROWS * FROM table LIMIT 1;<br><br>mysql_num_rows() returns 1 as expected.<br><br>If you issue "SELECT FOUND_ROWS()" just in sequence, in the same connection resource, it allways returns 0 rather than expected 5.<br><br>Just switch mysql.trace_mode to Off and things will work.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53416">  
  <a class="name">
  <strong class="user"><em>wil1488 at gmail dot com</em></strong></a><div class="date" title="2005-05-31 07:53"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom53416">
<div class="phpcode"><code><span class="html">
To use SQL COUNT function, without select the source...<br><br>see an example:<br><br>&lt;?<br>//MAKE THE CONNECTION WITH DATABASE<br><br>$my_table = mysql_query("SELECT COUNT(*) as TOTALFOUND from table", $link); //EXECUTE SQL CODE<br>Note: will return the total on TOTALFOUND<br><br>print (mysql_result($my_table,0,"TOTALFOUND")); //use the field camp to get the total from your SQL query!<br>?&gt;<br><br>Thanks, good luck.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85654">  
  <a class="name">
  <strong class="user"><em>gtaylor at sonic dot net</em></strong></a><div class="date" title="2008-09-10 12:18"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom85654">
<div class="phpcode"><code><span class="html">
In preventing the race condition for the SQL_CALC_FOUND_ROWS and FOUND_ROWS() operations, it can become complicated and somewhat kludgy to include the FOUND_ROWS() result in the actual result set, especially for complex queries and/or result ordering. The query gets more complex, you may have trouble isolating/excluding the FOUND_ROWS() result, and mysql_num_rows() will return the number of actual results + 1, all of which makes your code messier and harder to read. However, the race condition is real and must be dealt with.<br><br>A alternative and cleaner method is to explicitly lock the table using a WRITE lock (preventing other processes from reading/writing to the table). The downsides I can see are a performance hit, and your mysql user must have lock permissions.<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="comment">// excuse the use of mysqli instead of mysql<br><br>&nbsp; &nbsp; </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"LOCK TABLE t WRITE"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$results </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"SELECT id FROM t LIMIT 0,10"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$totalNumResults </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"SELECT FOUND_ROWS()"</span><span class="keyword">)-&gt;</span><span class="default">fetch_row</span><span class="keyword">());<br>&nbsp; &nbsp; </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"UNLOCK TABLES"</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Now you may iterate through the results just like any other result set.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77222">  
  <a class="name">
  <strong class="user"><em>deaggi at deaggi dot net</em></strong></a><div class="date" title="2007-08-20 12:45"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom77222">
<div class="phpcode"><code><span class="html">
In Reply to the last post: This may not always work correctly, as $object-&gt;doesExist would contain a result, not a boolean value. A better way (using the same method) would be using a cast: <br><br><span class="default">&lt;?php<br></span><span class="keyword">class </span><span class="default">Object </span><span class="keyword">{<br>&nbsp; var </span><span class="default">$doesExist </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br><br>&nbsp; [...]<br>&nbsp; function </span><span class="default">load</span><span class="keyword">() {<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">'...'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">doesExist </span><span class="keyword">= (bool) (</span><span class="default">$res </span><span class="keyword">= </span><span class="default">mysql_fetch_array</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">))<br>&nbsp; &nbsp; [...]<br>&nbsp; }<br>}<br></span><span class="default">?&gt;<br></span><br>johannes</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83424">  
  <a class="name">
  <strong class="user"><em>chrisdberry82 at gmail dot com</em></strong></a><div class="date" title="2008-05-25 10:46"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom83424">
<div class="phpcode"><code><span class="html">
The following code can wrap it all up in a single query so you don't have to worry about multiple client requests:<br><br>$stmtMain = $mysqli-&gt;prepare("SELECT SQL_CALC_FOUND_ROWS jobid,title FROM tbljobs <br>&nbsp; &nbsp; LIMIT ?, ? UNION SELECT FOUND_ROWS(),'!!IgnoreCount!!';")<br><br>Then iterate through the results with something like:<br><br>while ($stmtMain-&gt;fetch() &amp;&amp; $strResultTitle !="!!IgnoreCount!!") {&nbsp; <br>//do stuff<br>}<br>($strResultSector == '!!IgnoreCount!!')? $intTotal = $intResultCount : 1;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77208">  
  <a class="name">
  <strong class="user"><em>webmaster  dasourcerer  net</em></strong></a><div class="date" title="2007-08-20 05:42"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom77208">
<div class="phpcode"><code><span class="html">
In one of my applications, I had to let an object know wether it exists in the database or not. I found a cheap solution w/o the usage of mysql_num_rows():<br><br><span class="default">&lt;?php<br></span><span class="keyword">class </span><span class="default">Object </span><span class="keyword">{<br>&nbsp; var </span><span class="default">$doesExist </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br><br>&nbsp; [...]<br>&nbsp; function </span><span class="default">load</span><span class="keyword">() {<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">'...'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">doesExist </span><span class="keyword">= (</span><span class="default">$res </span><span class="keyword">= </span><span class="default">mysql_fetch_array</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">))<br>&nbsp; &nbsp; [...]<br>&nbsp; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="59509">  
  <a class="name">
  <strong class="user"><em>Jonas</em></strong></a><div class="date" title="2005-12-08 01:55"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom59509">
<div class="phpcode"><code><span class="html">
A small tip concerning SQL_CALC_FOUND_ROWS and FOUND_ROWS()<br><br>Remember that you can us "AS" when working with mysql_fetch_assoc.<br><br>$sql="<br>&nbsp; &nbsp; SELECT<br>&nbsp; &nbsp; &nbsp; &nbsp; FOUND_ROWS() AS `found_rows`;<br>";<br>$result = mysql_query($sql);<br>$myrow = mysql_fetch_assoc($result);<br>$row_count = $myrow['found_rows'];<br><br>echo $row_count;</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.mysql-num-rows.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:57:57 GMT -->


</body></html>