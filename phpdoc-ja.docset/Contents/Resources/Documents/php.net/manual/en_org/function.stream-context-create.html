<html><!-- Mirrored from php.net/manual/en/function.stream-context-create.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:28:50 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>stream_context_create</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.stream-context-create.html">
 <link rel="shorturl" href="http://php.net/stream-context-create">
 <link rel="alternate" href="http://php.net/stream-context-create" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.stream.html">
 <link rel="prev" href="function.stream-bucket-prepend.html">
 <link rel="next" href="function.stream-context-get-default.html">

 <link rel="alternate" href="function.stream-context-create.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.stream-context-create.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.stream-context-create.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.stream-context-create.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.stream-context-create.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.stream-context-create.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.stream-context-create.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.stream-context-create.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.stream-context-create.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.stream-context-create.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.stream-context-create.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.other.html">Other Basic Extensions</a></li>      <li><a href="book.stream.html">Streams</a></li>      <li><a href="ref.stream.html">Stream Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.stream-context-create" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">stream_context_create</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5)</p><p class="refpurpose"><span class="refname">stream_context_create</span> â€” <span class="dc-title">Creates a stream context</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.stream-context-create-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>stream_context_create</strong></span>
    ([ <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$params</code></span>
  ]] )</div>

  <p class="para rdfs-comment">
   Creates and returns a stream context with any options supplied in
   <code class="parameter">options</code> preset.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.stream-context-create-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       Must be an associative array of associative arrays in the format
       <em>$arr['wrapper']['option'] = $value</em>.
      </p>
      <p class="para">
       Default to an empty array.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">params</code></dt>

     <dd>

      <p class="para">
       Must be an associative array in the format
       <em>$arr['parameter'] = $value</em>.
       Refer to <a href="context.html" class="link">context parameters</a> for
       a listing of standard stream parameters.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.stream-context-create-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   A stream context <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.stream-context-create-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   </p><table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.0</td>
       <td>
        Added the optional <code class="parameter">params</code> argument.
       </td>
      </tr>

     </tbody>
    
   </table>

  <p></p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.stream-context-create-examples">
  <h3 class="title">Examples</h3>
  <div class="example" id="example-4135">
   <p><strong>Example #1 Using <span class="function"><strong>stream_context_create()</strong></span></strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$opts&nbsp;</span><span style="color: #007700">=&nbsp;array(<br>&nbsp;&nbsp;</span><span style="color: #DD0000">'http'</span><span style="color: #007700">=&gt;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'method'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"GET"</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'header'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"Accept-language:&nbsp;en\r\n"&nbsp;</span><span style="color: #007700">.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"Cookie:&nbsp;foo=bar\r\n"<br>&nbsp;&nbsp;</span><span style="color: #007700">)<br>);<br><br></span><span style="color: #0000BB">$context&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_context_create</span><span style="color: #007700">(</span><span style="color: #0000BB">$opts</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;Sends&nbsp;an&nbsp;http&nbsp;request&nbsp;to&nbsp;www.example.com<br>&nbsp;&nbsp;&nbsp;with&nbsp;additional&nbsp;headers&nbsp;shown&nbsp;above&nbsp;*/<br></span><span style="color: #0000BB">$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://www.example.com'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'r'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$context</span><span style="color: #007700">);<br></span><span style="color: #0000BB">fpassthru</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.stream-context-create-seealso">
  <h3 class="title">See Also</h3>
  <ul class="simplelist">
   <li class="member"><span class="function"><a href="function.stream-context-set-option.html" class="function" rel="rdfs-seeAlso">stream_context_set_option()</a> - Sets an option for a stream/wrapper/context</span></li>
   <li class="member">Listing of supported wrappers (<a href="wrappers.html" class="xref">Supported Protocols and Wrappers</a>)</li>
   <li class="member">Context options (<a href="context.html" class="xref">Context options and parameters</a>)</li>
  </ul>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="89080">  
  <a class="name">
  <strong class="user"><em>rlintern at gmail dot com</em></strong></a><div class="date" title="2009-02-20 09:56"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom89080">
<div class="phpcode"><code><span class="html">
I found the following code worked for me for POSTing some binary data to a remote server. I am putting it here since I could not find a quick solution to this by 'googling' or looking through this documentation. <br><br>Disclaimer:&nbsp; I have no idea if this a 'good' solution, since I'm new to PHP, but it may just suit your needs as it did mine.&nbsp; I am assuming bad things will happen with very large files since the entire file is read into $fileContents. <br><br>I am using PHP 5.2.8.<br><br>&nbsp;&nbsp; $fileHandle = fopen("someImage.jpg", "rb");<br>&nbsp;&nbsp; $fileContents = stream_get_contents($fileHandle);<br>&nbsp;&nbsp; fclose($fileHandle);<br><br>&nbsp;&nbsp; $params = array(<br>&nbsp; &nbsp; &nbsp; 'http' =&gt; array<br>&nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'method' =&gt; 'POST',<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'header'=&gt;"Content-Type: multipart/form-data\r\n",<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'content' =&gt; $fileContents<br>&nbsp; &nbsp; &nbsp; )<br>&nbsp;&nbsp; );<br>&nbsp;&nbsp; $url = "<a rel="nofollow" target="_blank">http://somesite.somecompany.com?someParam=someValue</a>";<br>&nbsp;&nbsp; $ctx = stream_context_create($params);<br>&nbsp;&nbsp; $fp = fopen($url, 'rb', false, $ctx);<br><br>&nbsp;&nbsp; $response = stream_get_contents($fp);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74795">  
  <a class="name">
  <strong class="user"><em>jrubenstein at gmail dot com</em></strong></a><div class="date" title="2007-04-27 09:36"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74795">
<div class="phpcode"><code><span class="html">
Something to keep in mind when creating SSL streams (using https://):<br><br><span class="default">&lt;?php<br>$context </span><span class="keyword">= </span><span class="default">context_create_stream</span><span class="keyword">(</span><span class="default">$context_options</span><span class="keyword">)<br></span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'https://url'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$context</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>One would think - the proper way to create a stream options array, would be as follows: <br><br><span class="default">&lt;?php<br>$context_options </span><span class="keyword">= array (<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'https' </span><span class="keyword">=&gt; array (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'method' </span><span class="keyword">=&gt; </span><span class="string">'POST'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt; </span><span class="string">"Content-type: application/x-www-form-urlencoded\r\n"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">"Content-Length: " </span><span class="keyword">. </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) . </span><span class="string">"\r\n"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'content' </span><span class="keyword">=&gt; </span><span class="default">$data<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; );<br></span><span class="default">?&gt;<br></span><br>THAT IS THE WRONG WAY!!!<br>Take notice to the 3rd line: 'https' =&gt; array (<br><br>The CORRECT way, is as follows:<br><br><span class="default">&lt;?php<br>$context_options </span><span class="keyword">= array (<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'method' </span><span class="keyword">=&gt; </span><span class="string">'POST'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt; </span><span class="string">"Content-type: application/x-www-form-urlencoded\r\n"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">"Content-Length: " </span><span class="keyword">. </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) . </span><span class="string">"\r\n"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'content' </span><span class="keyword">=&gt; </span><span class="default">$data<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; );<br></span><span class="default">?&gt;<br></span><br>Notice, the NEW 3rd line: 'http' =&gt; array (<br><br>Now - keep this in mind - I spent several hours trying to trouble shoot my issue, when I finally stumbled upon this non-documented issue.<br><br>The complete code to post to a secure page is as follows:<br><br><span class="default">&lt;?php<br>$data </span><span class="keyword">= array (</span><span class="string">'foo' </span><span class="keyword">=&gt; </span><span class="string">'bar'</span><span class="keyword">, </span><span class="string">'bar' </span><span class="keyword">=&gt; </span><span class="string">'baz'</span><span class="keyword">);<br></span><span class="default">$data </span><span class="keyword">= </span><span class="default">http_build_query</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br><br></span><span class="default">$context_options </span><span class="keyword">= array (<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'method' </span><span class="keyword">=&gt; </span><span class="string">'POST'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt; </span><span class="string">"Content-type: application/x-www-form-urlencoded\r\n"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">"Content-Length: " </span><span class="keyword">. </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) . </span><span class="string">"\r\n"</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'content' </span><span class="keyword">=&gt; </span><span class="default">$data<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; );<br><br></span><span class="default">$context </span><span class="keyword">= </span><span class="default">context_create_stream</span><span class="keyword">(</span><span class="default">$context_options</span><span class="keyword">)<br></span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'https://url'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$context</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110158">  
  <a class="name">
  <strong class="user"><em>louis dot huppenbauer at gmail dot com</em></strong></a><div class="date" title="2012-09-25 06:04"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom110158">
<div class="phpcode"><code><span class="html">
When using the https protocol you'll have to make sure to set the right context options to use the full "power" of the ssl/tls encryption.<br><br><span class="default">&lt;?php<br>$url </span><span class="keyword">= </span><span class="string">'https://secure.example.com/test/1'</span><span class="keyword">;<br></span><span class="default">$contextOptions </span><span class="keyword">= array(<br>&nbsp; &nbsp; </span><span class="string">'ssl' </span><span class="keyword">=&gt; array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'verify_peer'&nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'cafile'&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="default">__DIR__ </span><span class="keyword">. </span><span class="string">'/cacert.pem'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'verify_depth'&nbsp; </span><span class="keyword">=&gt; </span><span class="default">5</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'CN_match'&nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">'secure.example.com'<br>&nbsp; &nbsp; </span><span class="keyword">)<br>);<br></span><span class="default">$sslContext </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$contextOptions</span><span class="keyword">);<br></span><span class="default">$result </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$sslContext</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>More information about those context options can be found at <a rel="nofollow" target="_blank">http://php.net/manual/en/context.ssl.php</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="75211">  
  <a class="name">
  <strong class="user"><em>davep at atomicdroplet dot com</em></strong></a><div class="date" title="2007-05-17 04:02"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom75211">
<div class="phpcode"><code><span class="html">
In addition to the context options mentioned above (appendix N), lower down context options for sockets can be found in appendix P - <a rel="nofollow" target="_blank">http://www.php.net/manual/en/transports.php</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="100559">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2010-10-22 10:45"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100559">
<div class="phpcode"><code><span class="html">
If you are trying to set a custom http header on php 5.2.x, try this:
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">// build header and set it the usual way
<br></span><span class="default">$authenticationHeader </span><span class="keyword">= </span><span class="default">$headername </span><span class="keyword">. </span><span class="string">': ' </span><span class="keyword">. </span><span class="default">$headervalue</span><span class="keyword">;
<br></span><span class="default">$opts </span><span class="keyword">= array(
<br>&nbsp; &nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'header'&nbsp; </span><span class="keyword">=&gt; </span><span class="default">$authenticationHeader
<br>&nbsp; &nbsp; </span><span class="keyword">)
<br>);
<br></span><span class="comment">// workaround for php bug where http headers don't get sent in php 5.2
<br></span><span class="keyword">if(</span><span class="default">version_compare</span><span class="keyword">(</span><span class="default">PHP_VERSION</span><span class="keyword">, </span><span class="string">'5.3.0'</span><span class="keyword">) == -</span><span class="default">1</span><span class="keyword">){
<br>&nbsp; &nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'user_agent'</span><span class="keyword">, </span><span class="string">'PHP-SOAP/' </span><span class="keyword">. </span><span class="default">PHP_VERSION </span><span class="keyword">. </span><span class="string">"\r\n" </span><span class="keyword">. </span><span class="default">$authenticationHeader</span><span class="keyword">);
<br>}
<br>
<br></span><span class="default">$context&nbsp; </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);
<br>
<br></span><span class="comment">// now use context for soap call or whatever...
<br></span><span class="default">?&gt;
<br></span>
<br>this is the only option that worked for me.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111032">  
  <a class="name">
  <strong class="user"><em>Ben J</em></strong></a><div class="date" title="2013-01-08 03:28"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111032">
<div class="phpcode"><code><span class="html">
I spent a good five hours trying to figure this out, so hopefully it will save someone else some time.
<br>
<br>When you are trying to download a file via ftp through an HTTP proxy note that the following will not be enough:
<br><span class="default">&lt;?php
<br>$opts </span><span class="keyword">= array(</span><span class="string">'ftp' </span><span class="keyword">=&gt; array(
<br>&nbsp; &nbsp; </span><span class="string">'proxy' </span><span class="keyword">=&gt; </span><span class="string">'tcp://vbinprst10:8080'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'request_fulluri'</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'header' </span><span class="keyword">=&gt; array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Proxy-Authorization: Basic </span><span class="default">$auth</span><span class="string">"
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">)
<br>&nbsp; &nbsp; )
<br>);
<br></span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);
<br></span><span class="default">$s </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"<a rel="nofollow" target="_blank">ftp://anonymous:anonymous@ftp.example.org</a>"</span><span class="keyword">,</span><span class="default">false</span><span class="keyword">,</span><span class="default">$context</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Your proxy will respond that authentication is required. You may scratch your head and think "but I'm providing authentication!"
<br>
<br>The issue is that the 'header' value is only applicable to http connections. So to authenticate on a proxy, you first have to pull a file from HTTP, before the context is valid for using on FTP.
<br><span class="default">&lt;?php
<br>$opts </span><span class="keyword">= array(</span><span class="string">'ftp' </span><span class="keyword">=&gt; array(
<br>&nbsp; &nbsp; </span><span class="string">'proxy' </span><span class="keyword">=&gt; </span><span class="string">'tcp://vbinprst10:8080'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'request_fulluri'</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'header' </span><span class="keyword">=&gt; array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Proxy-Authorization: Basic </span><span class="default">$auth</span><span class="string">"
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">)
<br>&nbsp; &nbsp; ),
<br>&nbsp; &nbsp; </span><span class="string">'http' </span><span class="keyword">=&gt; array(
<br>&nbsp; &nbsp; </span><span class="string">'proxy' </span><span class="keyword">=&gt; </span><span class="string">'tcp://vbinprst10:8080'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'request_fulluri'</span><span class="keyword">=&gt;</span><span class="default">true</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'header' </span><span class="keyword">=&gt; array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Proxy-Authorization: Basic </span><span class="default">$auth</span><span class="string">"
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">)
<br>&nbsp; &nbsp; )
<br>);
<br></span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);
<br></span><span class="default">$s </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"<a rel="nofollow" target="_blank">http://www.example.com</a>"</span><span class="keyword">,</span><span class="default">false</span><span class="keyword">,</span><span class="default">$context</span><span class="keyword">);
<br></span><span class="default">$s </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"<a rel="nofollow" target="_blank">ftp://anonymous:anonymous@ftp.example.org</a>"</span><span class="keyword">,</span><span class="default">false</span><span class="keyword">,</span><span class="default">$context</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>It's a bit roundabout, but it works. Note that the 'header' val in the ftp array is redundant, but I kept it in anyway.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="72317">  
  <a class="name">
  <strong class="user"><em>php at charlesconsulting dot com</em></strong></a><div class="date" title="2007-01-13 07:14"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom72317">
<div class="phpcode"><code><span class="html">
Here's an example of retrieving a page which requests a username and password using the basic authorization scheme.&nbsp; This calls the w3.org web page validator for a password protected page.<br>//$fileurl contains page to validate<br>$validateurl="<a rel="nofollow" target="_blank">http://validator.w3.org/check?uri=$fileurl</a>";<br><br>$cred = sprintf('Authorization: Basic %s',<br>&nbsp; &nbsp; base64_encode('username:password') );<br>$opts = array(<br>&nbsp; &nbsp; 'http'=&gt;array(<br>&nbsp; &nbsp; 'method'=&gt;'GET',<br>&nbsp; &nbsp; 'header'=&gt;$cred) <br>);<br>$ctx = stream_context_create($opts);<br><br>$validate=file_get_contents($validateurl,false,$ctx);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90927">  
  <a class="name">
  <strong class="user"><em>Brian Gottier</em></strong></a><div class="date" title="2009-05-16 12:13"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90927">
<div class="phpcode"><code><span class="html">
In some cases, set a header option as an array, and not a string, depending on server configuration.
<br>
<br><span class="default">&lt;?php
<br>$opts </span><span class="keyword">= array(
<br>&nbsp; </span><span class="string">'http'</span><span class="keyword">=&gt; array(
<br>&nbsp; &nbsp; </span><span class="string">'method'</span><span class="keyword">=&gt;&nbsp;&nbsp; </span><span class="string">"GET"</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt;&nbsp; &nbsp; array( </span><span class="string">"Cookie: foo="</span><span class="default">bar</span><span class="string">"l ),
<br>&nbsp; &nbsp; 'user_agent'=&gt;&nbsp; &nbsp; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_USER_AGENT']
<br>&nbsp; )
<br>);
<br>?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99353">  
  <a class="name">
  <strong class="user"><em>contact (at) thepointsolution.com</em></strong></a><div class="date" title="2010-08-12 05:29"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom99353">
<div class="phpcode"><code><span class="html">
I big NOTE that i hope will help some one. Something that is not mentioned in the documentation, is that when php is compiled --with-curlwrappers,
<br>
<br>So, instead of:
<br>
<br><span class="default">&lt;?php
<br>$opts </span><span class="keyword">= array(
<br>&nbsp; </span><span class="string">'http'</span><span class="keyword">=&gt;array(
<br>&nbsp; &nbsp; </span><span class="string">'method'</span><span class="keyword">=&gt;</span><span class="string">"GET"</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt;</span><span class="string">"Accept-language: en\r\n" </span><span class="keyword">.
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Cookie: foo=bar\r\n"
<br>&nbsp; </span><span class="keyword">)
<br>);
<br>
<br></span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>You would setup the header this way: 
<br>
<br><span class="default">&lt;?php
<br>$opts </span><span class="keyword">= array(
<br>&nbsp; </span><span class="string">'http'</span><span class="keyword">=&gt;array(
<br>&nbsp; &nbsp; </span><span class="string">'method'</span><span class="keyword">=&gt;</span><span class="string">"GET"</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt;array(</span><span class="string">"Accept-language: en"</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"Cookie: foo=bar"</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"Custom-Header: value"</span><span class="keyword">)
<br>&nbsp; )
<br>);
<br>
<br></span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>This will work.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="59583">  
  <a class="name">
  <strong class="user"><em>net_navard at yahoo dot com</em></strong></a><div class="date" title="2005-12-09 10:38"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom59583">
<div class="phpcode"><code><span class="html">
Hi,you can create an array of parameters(what it's called a stream context),which can be transmitted each time you read or write a stream through a socket.In the below example:<br><br>$opts =array('http'=&gt;arra('method'=&gt;"GET",<br>'header'=&gt;"Accept-language:en\r\n"."Cookie: foo=bar\r\n");<br><br>What you're actually doing is create a set of parameters(the protocol to be used,the request method,additional http headers and a cookie) which will be used each time you open a socket connection to request www.example.com.This saves a lot of time if you want to use these parameters (called a stream context) whenever you include them when making a request to www.example.com,instead of having to specify them over and over again.<br>Using the previous example,say you want to create a stream context,which sends a "Content-Type" http header and utilize it when making a request to www.example.com.Take a look:<br><br>$opts = array('http'=&gt;array('method'=&gt;"GET",<br>'header'=&gt;"Content-Type: text/xml; charset=utf-8");<br><br>$context = stream_context_create($opts);<br>$fp = fopen('<a rel="nofollow" target="_blank">http://www.example.com</a>','r',false,$context);<br>fpassthru($fp);<br>fclose($fp);<br><br>Now,when you make a request to www.example.com,the above http header will be included within the socket and transmitted to the server.Best of luck for you friends,Hossein</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74431">  
  <a class="name">
  <strong class="user"><em>chris dot vigelius at gmx dot net</em></strong></a><div class="date" title="2007-04-11 05:34"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74431">
<div class="phpcode"><code><span class="html">
It seems that the authorization example given below by"php at charlesconsulting dot com" does NOT work with PHP 5.2.1, since the 'header' option will be simply ignored if it is not an array (but a string).<br><br>The following works:<br>$url = '<a rel="nofollow" target="_blank">http://protectedstuff.com</a>';<br>$auth = base64_encode('user:password');<br>$header = array("Authorization: Basic $auth");<br>$opts = array( 'http' =&gt; array ('method'=&gt;'GET',<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'header'=&gt;$header));<br>$ctx = stream_context_create($opts);<br>file_get_contents($url,false,$ctx);<br><br>See also <a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=41051</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="92586">  
  <a class="name">
  <strong class="user"><em>mathieu dot laurent at gmail dot com</em></strong></a><div class="date" title="2009-07-30 06:15"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom92586">
<div class="phpcode"><code><span class="html">
Connection via Proxy<br><br><span class="default">&lt;?php<br><br>$opts </span><span class="keyword">= array(</span><span class="string">'http' </span><span class="keyword">=&gt; array(</span><span class="string">'proxy' </span><span class="keyword">=&gt; </span><span class="string">'tcp://127.0.0.1:8080'</span><span class="keyword">, </span><span class="string">'request_fulluri' </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">));<br></span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br><br></span><span class="default">$data </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://www.php.net</a>'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$context</span><span class="keyword">);<br><br>echo </span><span class="default">$data</span><span class="keyword">;<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="72017">  
  <a class="name">
  <strong class="user"><em>sp0n9e at gmail dot com</em></strong></a><div class="date" title="2006-12-28 10:18"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom72017">
<div class="phpcode"><code><span class="html">
Here's a very simple way to do posts easily without need of cURL or writing an http request by hand using the tcp:// wrapper.&nbsp; I like using contexts just because of their ubiquity and the lack of an optional library such as cURL (though one of the more popular libraries).<br><br><span class="default">&lt;?php<br><br>$options </span><span class="keyword">= array(<br>&nbsp; </span><span class="string">'http'</span><span class="keyword">=&gt;array(<br>&nbsp; &nbsp; </span><span class="string">'method'</span><span class="keyword">=&gt;</span><span class="string">"POST"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'header'</span><span class="keyword">=&gt;<br>&nbsp; &nbsp; &nbsp; </span><span class="string">"Accept-language: en\r\n"</span><span class="keyword">.<br>&nbsp; &nbsp; &nbsp; </span><span class="string">"Content-type: application/x-www-form-urlencoded\r\n"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'content'</span><span class="keyword">=&gt;</span><span class="default">http_build_query</span><span class="keyword">(array(</span><span class="string">'foo'</span><span class="keyword">=&gt;</span><span class="string">'bar'</span><span class="keyword">))<br>));<br><br></span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(</span><span class="default">$options</span><span class="keyword">);<br><br></span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'<a rel="nofollow" target="_blank">http://www.example.com/</a>'</span><span class="keyword">,</span><span class="default">false</span><span class="keyword">,</span><span class="default">$context</span><span class="keyword">);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.stream-context-create.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:28:54 GMT -->


</body></html>