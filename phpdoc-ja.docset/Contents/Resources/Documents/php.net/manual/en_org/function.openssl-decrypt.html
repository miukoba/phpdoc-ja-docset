<html><!-- Mirrored from php.net/manual/en/function.openssl-decrypt.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:05:22 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>openssl_decrypt</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.openssl-decrypt.html">
 <link rel="shorturl" href="http://php.net/openssl-decrypt">
 <link rel="alternate" href="http://php.net/openssl-decrypt" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.openssl.html">
 <link rel="prev" href="function.openssl-csr-sign.html">
 <link rel="next" href="function.openssl-dh-compute-key.html">

 <link rel="alternate" href="function.openssl-decrypt.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.openssl-decrypt.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.openssl-decrypt.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.openssl-decrypt.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.openssl-decrypt.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.openssl-decrypt.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.openssl-decrypt.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.openssl-decrypt.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.openssl-decrypt.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.openssl-decrypt.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.openssl-decrypt.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.crypto.html">Cryptography Extensions</a></li>      <li><a href="book.openssl.html">OpenSSL</a></li>      <li><a href="ref.openssl.html">OpenSSL Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.openssl-decrypt" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">openssl_decrypt</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.3.0)</p><p class="refpurpose"><span class="refname">openssl_decrypt</span> â€” <span class="dc-title">Decrypts data</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.openssl-decrypt-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>openssl_decrypt</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$method</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$password</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$iv</code><span class="initializer"> = ""</span></span>
  ]] )</div>

  <p class="para rdfs-comment">
   Takes a raw or base64 encoded string and decrypts it using a given method and key.
  </p>

  <div class="warning"><strong class="warning">Warning</strong><p class="simpara">This function is
currently not documented; only its argument list is available.
</p></div>

 </div>


 <div class="refsect1 parameters" id="refsect1-function.openssl-decrypt-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">data</code></dt>

     <dd>

      <p class="para">
       The data.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">method</code></dt>

     <dd>

      <p class="para">
       The cipher method.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">password</code></dt>

     <dd>

      <p class="para">
       The password.
      </p>
     </dd>

    
    
      <dt>
<code class="parameter">options</code></dt>

      <dd>

       <p class="para">
        <code class="parameter">options</code> can be one of
        <strong><code>OPENSSL_RAW_DATA</code></strong>,
        <strong><code>OPENSSL_ZERO_PADDING</code></strong>.
       </p>
      </dd>

    
    
     <dt>
<code class="parameter">iv</code></dt>

     <dd>

      <p class="para">
       A non-NULL Initialization Vector. 
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.openssl-decrypt-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   The decrypted string on success or <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-function.openssl-decrypt-errors">
  <h3 class="title">Errors/Exceptions</h3>
  <p class="para">
   Emits an <strong><code>E_WARNING</code></strong> level error if an unknown cipher algorithm
   is passed via the <code class="parameter">method</code> parameter.
  </p>
  <p class="para">
   Emits an <strong><code>E_WARNING</code></strong> level error if an empty value is passed
   in via the <code class="parameter">iv</code> parameter.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.openssl-decrypt-changelog">
  <h3 class="title">Changelog</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>Version</th>
      <th>Description</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>5.3.3</td>
      <td>
       The <code class="parameter">iv</code> parameter was added.
      </td>
     </tr>

     <tr>
      <td>5.4.0</td>
      <td>
       The <code class="parameter">raw_output</code> was changed to <code class="parameter">options</code>.
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 seealso" id="refsect1-function.openssl-decrypt-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.openssl-encrypt.html" class="function" rel="rdfs-seeAlso">openssl_encrypt()</a> - Encrypts data</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="107210">  
  <a class="name">
  <strong class="user"><em>nbari at dalmp dot com</em></strong></a><div class="date" title="2012-01-15 03:52"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107210">
<div class="phpcode"><code><span class="html">
There are cases where you need to send data in a secure way within an 'un-secure' connection, a&nbsp; typically scenario of this, is a site with out SSL (no https).<br><br>For this cases you can use the GibberishAES javascript library, this library will encrypt your data before it is submitted using CBC AES encryption mode, and it is fully compatible with a standar like OpenSSL.<br><br>Example:<br><br>When displaying a form, you can set a hidden field containing a token, the one is stored on the server via sessions and is going to be used as the 'password' for encrypting the data on the user side, in help with the GibberishAES library.<br><br>In Javascript (user side): <br>// GibberishAES.enc(string, password)<br>// Defaults to 256 bit encryption<br>GibberishAES.enc("Made with Gibberish\n", "password");<br>// Outputs: "U2FsdGVkX1+21O5RB08bavFTq7Yq/gChmXrO3f00tvJaT55A5pPvqw0zFVnHSW1o"<br><br>Later when the user submits the data, you will need to decrypt the data, for that you could use the class below and use it like this:<br><br><span class="default">&lt;?php<br>sqAES</span><span class="keyword">::</span><span class="default">decrypt</span><span class="keyword">(</span><span class="string">'password'</span><span class="keyword">, </span><span class="string">'U2FsdGVkX1+21O5RB08bavFTq7Yq/gChmXrO3f00tvJaT55A5pPvqw0zFVnHSW1o'</span><span class="keyword">); <br></span><span class="default">?&gt;<br></span><br>That will return&nbsp; the same result, that openssl would return from this command line :<br><br>echo "U2FsdGVkX1+21O5RB08bavFTq7Yq/gChmXrO3f00tvJaT55A5pPvqw0zFVnHSW1o" | openssl enc -d -aes-256-cbc -a -k password<br><br>This class currently only encrypts/decrypts AES256 but can be easily modified to feed your needs, right now it is fully compatible withe the&nbsp; GibberishAES library, so you could decrypt all your users data and also send encrypted data back to the user in a secure way, all this thanks to the openssl-decrypt/openssl-encrypt functions.<br><br><span class="default">&lt;?php <br><br></span><span class="keyword">class </span><span class="default">sqAES </span><span class="keyword">{<br><br>&nbsp; </span><span class="comment">/**<br>&nbsp;&nbsp; * decrypt AES 256<br>&nbsp;&nbsp; *<br>&nbsp;&nbsp; * @param string $password<br>&nbsp;&nbsp; * @param data $edata<br>&nbsp;&nbsp; * @return dencrypted data<br>&nbsp;&nbsp; */<br>&nbsp; </span><span class="keyword">public static function </span><span class="default">decrypt</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">, </span><span class="default">$edata</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">base64_decode</span><span class="keyword">(</span><span class="default">$edata</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$salt </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$ct </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">16</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp;&nbsp; * From https://github.com/mdp/gibberish-aes<br>&nbsp; &nbsp;&nbsp; *<br>&nbsp; &nbsp;&nbsp; * Number of rounds depends on the size of the AES in use<br>&nbsp; &nbsp;&nbsp; * 3 rounds for 256<br>&nbsp; &nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; 2 rounds for the key, 1 for the IV<br>&nbsp; &nbsp;&nbsp; * 2 rounds for 128<br>&nbsp; &nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; 1 round for the key, 1 round for the IV<br>&nbsp; &nbsp;&nbsp; * 3 rounds for 192 since it's not evenly divided by 128 bits<br>&nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; </span><span class="default">$rounds </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$data00 </span><span class="keyword">= </span><span class="default">$password</span><span class="keyword">.</span><span class="default">$salt</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$md5_hash </span><span class="keyword">= array();<br>&nbsp; &nbsp; </span><span class="default">$md5_hash</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$data00</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$md5_hash</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br>&nbsp; &nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$rounds</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$md5_hash</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$md5_hash</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">].</span><span class="default">$data00</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">.= </span><span class="default">$md5_hash</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$iv&nbsp; </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">,</span><span class="default">16</span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; return </span><span class="default">openssl_decrypt</span><span class="keyword">(</span><span class="default">$ct</span><span class="keyword">, </span><span class="string">'aes-256-cbc'</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">, </span><span class="default">$iv</span><span class="keyword">);<br>&nbsp; }<br><br>&nbsp; </span><span class="comment">/**<br>&nbsp;&nbsp; * crypt AES 256<br>&nbsp;&nbsp; *<br>&nbsp;&nbsp; * @param string $password<br>&nbsp;&nbsp; * @param data $data<br>&nbsp;&nbsp; * @return base64 encrypted data<br>&nbsp;&nbsp; */<br>&nbsp; </span><span class="keyword">public static function </span><span class="default">crypt</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="comment">// Set a random salt<br>&nbsp; &nbsp; </span><span class="default">$salt </span><span class="keyword">= </span><span class="default">openssl_random_pseudo_bytes</span><span class="keyword">(</span><span class="default">8</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">$salted </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$dx </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="comment">// Salt the key(32) and iv(16) = 48<br>&nbsp; &nbsp; </span><span class="keyword">while (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$salted</span><span class="keyword">) &lt; </span><span class="default">48</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$dx </span><span class="keyword">= </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$dx</span><span class="keyword">.</span><span class="default">$password</span><span class="keyword">.</span><span class="default">$salt</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$salted </span><span class="keyword">.= </span><span class="default">$dx</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$salted</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$iv&nbsp; </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$salted</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">,</span><span class="default">16</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">$encrypted_data </span><span class="keyword">= </span><span class="default">openssl_encrypt</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="string">'aes-256-cbc'</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">, </span><span class="default">$iv</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="string">'Salted__' </span><span class="keyword">. </span><span class="default">$salt </span><span class="keyword">. </span><span class="default">$encrypted_data</span><span class="keyword">);<br>&nbsp; }<br><br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111832">  
  <a class="name">
  <strong class="user"><em>ittasks at gmail dot com</em></strong></a><div class="date" title="2013-04-03 12:02"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111832">
<div class="phpcode"><code><span class="html">
in case that hosting do not provide openssl_encrypt decrypt functions - it could be mimiced via commad prompt executions&nbsp; <br>this functions will check is if openssl is installed and try to use it by default<br><br>function sslPrm()<br>{<br> return array("your_password","IV (optional)","aes-128-cbc");<br>}<br>function sslEnc($msg)<br>{<br>&nbsp; list ($pass, $iv, $method)=sslPrm();<br>&nbsp; if(function_exists('openssl_encrypt'))<br>&nbsp; &nbsp;&nbsp; return urlencode(openssl_encrypt(urlencode($msg), $method, $pass, false, $iv));<br>&nbsp; else<br>&nbsp; &nbsp;&nbsp; return urlencode(exec("echo \"".urlencode($msg)."\" | openssl enc -".urlencode($method)." -base64 -nosalt -K ".bin2hex($pass)." -iv ".bin2hex($iv)));<br>}<br>function sslDec($msg)<br>{<br>&nbsp; list ($pass, $iv, $method)=sslPrm();<br>&nbsp; if(function_exists('openssl_decrypt'))<br>&nbsp; &nbsp;&nbsp; return trim(urldecode(openssl_decrypt(urldecode($msg), $method, $pass, false, $iv)));<br>&nbsp; else<br>&nbsp; &nbsp;&nbsp; return trim(urldecode(exec("echo \"".urldecode($msg)."\" | openssl enc -".$method." -d -base64 -nosalt -K ".bin2hex($pass)." -iv ".bin2hex($iv))));<br>}<br><br>//example of usage:<br>$r= sslEnc("This is encryption/decryption test!");<br>echo "&lt;br&gt;\n".$r.":".sslDec($r);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114878">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2014-04-19 04:33"><strong>4 months ago</strong></div>
  <div class="text" id="Hcom114878">
<div class="phpcode"><code><span class="html">
If your using windows os, do not use the text inside the "file previewer" pane, as this is a truncated version of the actual encrypted string.<br><br>Instead, you need to open the file directly and use the contents there.<br><br>The error message I had been getting was:<br>"error:0606506D:digital envelope routines:EVP_DecryptFinal_ex:wrong final block length"</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.openssl-decrypt.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:05:22 GMT -->


</body></html>