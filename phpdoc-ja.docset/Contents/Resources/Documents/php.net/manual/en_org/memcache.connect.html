<html><!-- Mirrored from php.net/manual/en/memcache.connect.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:45:00 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Memcache::connect</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="memcache.connect.html">
 <link rel="shorturl" href="memcache.connect.html">
 <link rel="alternate" href="memcache.connect.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="class.memcache.html">
 <link rel="prev" href="memcache.close.html">
 <link rel="next" href="memcache.decrement.html">

 <link rel="alternate" href="memcache.connect.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/memcache.connect.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/memcache.connect.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/memcache.connect.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/memcache.connect.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/memcache.connect.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/memcache.connect.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/memcache.connect.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/memcache.connect.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/memcache.connect.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/memcache.connect.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.remote.other.html">Other Services</a></li>      <li><a href="book.memcache.html">Memcache</a></li>      <li><a href="class.memcache.html">Memcache</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="memcache.connect" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Memcache::connect</h1>
  <p class="verinfo">(PECL memcache &gt;= 0.2.0)</p><p class="refpurpose"><span class="refname">Memcache::connect</span> â€” <span class="dc-title">Open memcached server connection</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-memcache.connect-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>Memcache::connect</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$host</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$port</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$timeout</code></span>
  ]] )</div>


  <p class="para rdfs-comment">
   <span class="function"><strong>Memcache::connect()</strong></span> establishes a connection to the
   memcached server.
   The connection, which was opened using
   <span class="function"><strong>Memcache::connect()</strong></span> will be automatically closed at the
   end of script execution. Also you can close it with
   <span class="function"><a href="memcache.close.html" class="function">Memcache::close()</a></span>.
   Also you can use <span class="function"><strong>memcache_connect()</strong></span> function.
  </p>
 
 </div>

 
 <div class="refsect1 parameters" id="refsect1-memcache.connect-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">host</code></dt>

     <dd>

      <p class="para">
       Point to the host where memcached is listening for connections. This parameter
       may also specify other transports like <em>unix:///path/to/memcached.sock</em>
       to use UNIX domain sockets, in this case <code class="parameter">port</code> must also
       be set to <em>0</em>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">port</code></dt>

     <dd>

      <p class="para">
       Point to the port where memcached is listening for connections. Set this
       parameter to <em>0</em> when using UNIX domain sockets.
      </p>
      <p class="para">
        Please note: <code class="parameter">port</code> defaults to
        <a href="memcache.ini.html#ini.memcache.default-port" class="link">memcache.default_port</a>
        if not specified. For this reason it is wise to specify the port
        explicitly in this method call.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">timeout</code></dt>

     <dd>

      <p class="para">
       Value in seconds which will be used for connecting to the daemon. Think
       twice before changing the default value of 1 second - you can lose all
       the advantages of caching if your connection is too slow.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-memcache.connect-notes">
  <h3 class="title">Notes</h3>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">
    When the <code class="parameter">port</code> is unspecified, this method defaults to the
    value set of the PHP ini directive
    <a href="memcache.ini.html#ini.memcache.default-port" class="link">memcache.default_port</a>
    If this value was changed elsewhere in your application it might lead to
    unexpected results: for this reason it is wise to always specify the port
    explicitly in this method call.
   </p>
  </div>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-memcache.connect-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <strong><code>TRUE</code></strong> on success or <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-memcache.connect-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-4524">
    <p><strong>Example #1 <span class="function"><strong>Memcache::connect()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br></span><span style="color: #FF8000">/*&nbsp;procedural&nbsp;API&nbsp;*/<br><br></span><span style="color: #0000BB">$memcache_obj&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">memcache_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;OO&nbsp;API&nbsp;*/<br><br></span><span style="color: #0000BB">$memcache&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Memcache</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$memcache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 seealso" id="refsect1-memcache.connect-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="memcache.pconnect.html" class="function" rel="rdfs-seeAlso">Memcache::pconnect()</a> - Open memcached server persistent connection</span></li>
    <li class="member"><span class="function"><a href="memcache.close.html" class="function" rel="rdfs-seeAlso">Memcache::close()</a> - Close memcached server connection</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="69405">  
  <a class="name">
  <strong class="user"><em>chrisn at allipo dot com</em></strong></a><div class="date" title="2006-09-05 01:39"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom69405">
<div class="phpcode"><code><span class="html">
The behavior of Memcache::connect() is to always reinitialize the pool from scratch regardless of any previous calls to addServer().
<br>
<br>E.g.
<br>
<br><span class="default">&lt;?php
<br>$mmc </span><span class="keyword">= new </span><span class="default">Memcache</span><span class="keyword">()
<br></span><span class="default">$mmc</span><span class="keyword">-&gt;</span><span class="default">addServer</span><span class="keyword">(</span><span class="string">'node1'</span><span class="keyword">, </span><span class="default">11211</span><span class="keyword">);
<br></span><span class="default">$mmc</span><span class="keyword">-&gt;</span><span class="default">addServer</span><span class="keyword">(</span><span class="string">'node2'</span><span class="keyword">, </span><span class="default">11211</span><span class="keyword">);
<br></span><span class="default">$mmc</span><span class="keyword">-&gt;</span><span class="default">addServer</span><span class="keyword">(</span><span class="string">'node3'</span><span class="keyword">, </span><span class="default">11211</span><span class="keyword">);
<br>
<br></span><span class="default">$mmc</span><span class="keyword">-&gt;</span><span class="default">connect</span><span class="keyword">(</span><span class="string">'node1'</span><span class="keyword">, </span><span class="default">11211</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>The last connect() call clears out the pool and then add and connect node1:11211 making it the only server.
<br>
<br>If you want a pool of memcache servers, do not use the connect() function.
<br>
<br>If you only want a single memcache server then there is no need to use the addServer() function.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103928">  
  <a class="name">
  <strong class="user"><em>djbrd</em></strong></a><div class="date" title="2011-05-11 11:48"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103928">
<div class="phpcode"><code><span class="html">
To suppress (or handle) the warning and notice thrown by a failed attempt to connect, you can use a custom error handler function, like this:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">myErrorHandler</span><span class="keyword">(</span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">$errfile</span><span class="keyword">, </span><span class="default">$errline</span><span class="keyword">)
<br>{
<br>
<br>&nbsp; &nbsp; if (</span><span class="default">E_WARNING </span><span class="keyword">=== </span><span class="default">$errno</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">Log</span><span class="keyword">(</span><span class="string">"PHP Warning: </span><span class="default">$errstr</span><span class="string">, </span><span class="default">$errfile</span><span class="string">, </span><span class="default">$errline</span><span class="string">"</span><span class="keyword">, </span><span class="default">Logging</span><span class="keyword">::</span><span class="default">WARN</span><span class="keyword">); 
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; if (</span><span class="default">E_NOTICE </span><span class="keyword">=== </span><span class="default">$errno</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">Log</span><span class="keyword">(</span><span class="string">"PHP Notic: </span><span class="default">$errstr</span><span class="string">, </span><span class="default">$errfile</span><span class="string">, </span><span class="default">$errline</span><span class="string">"</span><span class="keyword">, </span><span class="default">Logging</span><span class="keyword">::</span><span class="default">NOTICE</span><span class="keyword">); 
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;
<br>&nbsp; &nbsp; }&nbsp; &nbsp; 
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>}
<br>
<br></span><span class="default">set_error_handler</span><span class="keyword">(</span><span class="string">'myErrorHandler'</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106786">  
  <a class="name">
  <strong class="user"><em>tom at all dash community dot de</em></strong></a><div class="date" title="2011-12-06 07:52"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom106786">
<div class="phpcode"><code><span class="html">
There is a not-so-obvious way to check whether or not a MemCache-Server is available.<br><br>Using ($memCache-&gt;connect() == false) will wait for a timeout if it can't connect. If you got a high-traffic site this may not be an option. So when the server is down, you may want to avoid waiting for this timeout on every request and instead try to reconnect only once every X seconds.<br><br>If so, this code may help:<br><br><span class="default">&lt;?php<br>$memCache </span><span class="keyword">= new \</span><span class="default">Memcache</span><span class="keyword">();<br></span><span class="default">$memCache</span><span class="keyword">-&gt;</span><span class="default">addServer</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">);<br></span><span class="default">$stats </span><span class="keyword">= @</span><span class="default">$memCache</span><span class="keyword">-&gt;</span><span class="default">getExtendedStats</span><span class="keyword">();<br></span><span class="default">$available </span><span class="keyword">= (bool) </span><span class="default">$stats</span><span class="keyword">[</span><span class="string">"</span><span class="default">$host</span><span class="string">:</span><span class="default">$port</span><span class="string">"</span><span class="keyword">];<br>if (</span><span class="default">$available </span><span class="keyword">&amp;&amp; @</span><span class="default">$memCache</span><span class="keyword">-&gt;</span><span class="default">connect</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">))<br>&nbsp; &nbsp; </span><span class="comment">// MemCache is there<br></span><span class="keyword">else<br>&nbsp; &nbsp; </span><span class="comment">// go on without MemCache<br></span><span class="default">?&gt;<br></span><br>The result of getExtendedStats() is an array. The information is cached and maintained by MemCache itself. If the server is not available, the result will be FALSE.<br><br>Even if the result is not false, the server may still not be available. Thus you need to check for connect() != false too, but only if the first check returns TRUE, thus avoiding the 1 second timeout in most cases.<br>Both getExtendedStats() and connect() issue notices/warnings if the server is not there. Thus you have to mute both calls.<br><br>Do NOT use getServerStatus() for this purpose: the result is cached on server-start and will not recognize when the connection to the server is lost (or reestablished) in between.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114989">  
  <a class="name">
  <strong class="user"><em>webysther at gmail dot com</em></strong></a><div class="date" title="2014-05-10 04:28"><strong>3 months ago</strong></div>
  <div class="text" id="Hcom114989">
<div class="phpcode"><code><span class="html">
In describing the timeout there is a statement that is not completely correct, increase the timeout does not necessarily preclude or unfeasible memcache, only allows the system to wait for more concurrent connections, which is a large minority of the number of connections, this causes several problems and could simply be corrected if the timeout was increased and perform some tests. <br>To prove the concept and show that the connection does not wait if the server goes down:<br><br><span class="default">&lt;?PHP<br><br></span><span class="keyword">while ( ++</span><span class="default">$loop </span><span class="keyword">&lt; </span><span class="default">10000 </span><span class="keyword">) {<br>&nbsp; &nbsp; try {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$memcache </span><span class="keyword">= new </span><span class="default">Memcache</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; @</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">pconnect</span><span class="keyword">( </span><span class="string">"127.0.0.1" </span><span class="keyword">, </span><span class="default">11211 </span><span class="keyword">, </span><span class="default">30 </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$loopset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$loopget </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; while ( ++</span><span class="default">$loopset </span><span class="keyword">&lt; </span><span class="default">50 </span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( @</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">( </span><span class="string">"foo" </span><span class="keyword">, </span><span class="string">"bar" </span><span class="keyword">) === </span><span class="default">false </span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Fail!" </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; while ( ++</span><span class="default">$loopget </span><span class="keyword">&lt; </span><span class="default">500 </span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( @</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">( </span><span class="string">"foo" </span><span class="keyword">) === </span><span class="default">false </span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Fail!" </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; if ( </span><span class="default">$loop </span><span class="keyword">% </span><span class="default">100 </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Try: " </span><span class="keyword">. </span><span class="default">$loop </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; } catch ( </span><span class="default">Exception $e </span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Fail: " </span><span class="keyword">. </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">() . </span><span class="default">PHP_EOL</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>}<br><br></span><span class="default">?&gt;<br></span><br>Replace with an invalid host and test the timeout will not make a difference! It serves only for connections to the socket that are occupied.<br><br>More detail about troubleshooting timeouts in memcached google code.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99461">  
  <a class="name">
  <strong class="user"><em>geoffrey dot hoffman at gmail dot com</em></strong></a><div class="date" title="2010-08-18 12:32"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom99461">
<div class="phpcode"><code><span class="html">
If memcached is working, calling memcache_connect( ) returns an Object instance, not a boolean. If memcached is not working, calling memcache_connect( ) throws a notice AND a warning (and returns false as expected). <br><br><span class="default">&lt;?php<br></span><span class="comment">/* memcache is running */<br></span><span class="default">$test1 </span><span class="keyword">= </span><span class="default">memcache_connect</span><span class="keyword">(</span><span class="string">'127.0.0.1'</span><span class="keyword">,</span><span class="default">11211</span><span class="keyword">);<br>echo </span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$test1</span><span class="keyword">);<br></span><span class="comment">// object<br></span><span class="keyword">echo </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$test1</span><span class="keyword">);<br></span><span class="comment">// Memcache<br><br>/* memcached is stopped */<br></span><span class="default">$test2 </span><span class="keyword">= </span><span class="default">memcache_connect</span><span class="keyword">(</span><span class="string">'127.0.0.1'</span><span class="keyword">,</span><span class="default">11211</span><span class="keyword">);<br><br></span><span class="comment">/*<br>Notice: memcache_connect(): Server 127.0.0.1 (tcp 11211) failed with: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.<br> (10060) in C:\Program Files\Support Tools\- on line 1<br><br>Warning: memcache_connect(): Can't connect to 127.0.0.1:11211, A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.<br> (10060) in C:\Program Files\Support Tools\- on line 1<br>*/<br><br></span><span class="keyword">echo </span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$test2</span><span class="keyword">);<br></span><span class="comment">// boolean<br></span><span class="keyword">echo </span><span class="default">$test2</span><span class="keyword">===</span><span class="default">false</span><span class="keyword">;<br></span><span class="comment">// 1<br></span><span class="default">?&gt;<br></span><br>There appears to be no way to check whether memcached is actually running without resorting to error suppression:<br><br><span class="default">&lt;?php<br>$test3 </span><span class="keyword">= @</span><span class="default">memcache_connect</span><span class="keyword">(</span><span class="string">'127.0.0.1'</span><span class="keyword">,</span><span class="default">11211</span><span class="keyword">);<br>if( </span><span class="default">$test3</span><span class="keyword">===</span><span class="default">false </span><span class="keyword">){<br>&nbsp;&nbsp; </span><span class="comment">// memcached is _probably_ not running<br></span><span class="keyword">}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/memcache.connect.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:45:00 GMT -->


</body></html>