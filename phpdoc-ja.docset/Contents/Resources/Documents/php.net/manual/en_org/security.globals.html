<html><!-- Mirrored from php.net/manual/en/security.globals.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:20:55 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Using Register Globals</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="security.globals.html">
 <link rel="shorturl" href="security.globals.html">
 <link rel="alternate" href="security.globals.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="security.html">
 <link rel="prev" href="security.errors.html">
 <link rel="next" href="security.variables.html">

 <link rel="alternate" href="security.globals.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/security.globals.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/security.globals.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/security.globals.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/security.globals.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/security.globals.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/security.globals.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/security.globals.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/security.globals.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/security.globals.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/security.globals.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="security.html">Security</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="security.globals" class="chapter">
   <h1>Using Register Globals</h1>

   <div class="warning"><strong class="warning">Warning</strong><p class="simpara">This feature has been
<em class="emphasis">DEPRECATED</em> as of PHP 5.3.0 and <em class="emphasis">REMOVED</em>
as of PHP 5.4.0.</p></div>
   <p class="para">
    Perhaps the most controversial change in <acronym title="PHP: Hypertext Preprocessor">PHP</acronym> is when the default value
    for the <acronym title="PHP: Hypertext Preprocessor">PHP</acronym> directive <a href="ini.core.html#ini.register-globals" class="link">
    register_globals</a> went from ON to OFF in <acronym title="PHP: Hypertext Preprocessor">PHP</acronym> 
    <a href="http://www.php.net/releases/4_2_0.php" class="link external">»&nbsp;4.2.0</a>.  Reliance on this
    directive was quite common and many people didn't even know it existed
    and assumed it's just how <acronym title="PHP: Hypertext Preprocessor">PHP</acronym> works.  This page will explain how one can
    write insecure code with this directive but keep in mind that the
    directive itself isn't insecure but rather it's the misuse of it.
   </p>
   <p class="para">
    When on, register_globals will inject your scripts with all
    sorts of variables, like request variables from <acronym title="Hyper Text Markup Language">HTML</acronym> forms.  This
    coupled with the fact that <acronym title="PHP: Hypertext Preprocessor">PHP</acronym> doesn't require variable initialization
    means writing insecure code is that much easier.  It was a difficult
    decision, but the <acronym title="PHP: Hypertext Preprocessor">PHP</acronym> community decided to disable this directive by 
    default.  When on, people use variables yet really don't know for sure
    where they come from and can only assume.  Internal variables that are
    defined in the script itself get mixed up with request data sent by
    users and disabling register_globals changes this.  Let's demonstrate
    with an example misuse of register_globals: 
   </p>
   <p class="para">
    </p><div class="example" id="example-361">
     <p><strong>Example #1 Example misuse with register_globals = on</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;define&nbsp;$authorized&nbsp;=&nbsp;true&nbsp;only&nbsp;if&nbsp;user&nbsp;is&nbsp;authenticated<br></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">authenticated_user</span><span style="color: #007700">())&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$authorized&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #FF8000">//&nbsp;Because&nbsp;we&nbsp;didn't&nbsp;first&nbsp;initialize&nbsp;$authorized&nbsp;as&nbsp;false,&nbsp;this&nbsp;might&nbsp;be<br>//&nbsp;defined&nbsp;through&nbsp;register_globals,&nbsp;like&nbsp;from&nbsp;GET&nbsp;auth.php?authorized=1<br>//&nbsp;So,&nbsp;anyone&nbsp;can&nbsp;be&nbsp;seen&nbsp;as&nbsp;authenticated!<br></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$authorized</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;</span><span style="color: #DD0000">"/highly/sensitive/data.php"</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   <p></p>
   <p class="para">
    When register_globals = on, our logic above may be compromised.  When
    off, <var class="varname"><var class="varname">$authorized</var></var> can't be set via request so it'll
    be fine, although it really is generally a good programming practice to
    initialize variables first.  For example, in our example above we might
    have first done <em>$authorized = false</em>.  Doing this
    first means our above code would work with register_globals on or off as
    users by default would be unauthorized.
   </p>
   <p class="para">
    Another example is that of <a href="ref.session.html" class="link">sessions</a>.
    When register_globals = on, we could also use
    <var class="varname"><var class="varname">$username</var></var> in our example below but again you must
    realize that <var class="varname"><var class="varname">$username</var></var> could also come from other
    means, such as GET (through the <acronym title="Uniform Resource Locator">URL</acronym>).
   </p>
   <p class="para">
    </p><div class="example" id="example-362">
     <p><strong>Example #2 Example use of sessions with register_globals on or off</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;We&nbsp;wouldn't&nbsp;know&nbsp;where&nbsp;$username&nbsp;came&nbsp;from&nbsp;but&nbsp;do&nbsp;know&nbsp;$_SESSION&nbsp;is<br>//&nbsp;for&nbsp;session&nbsp;data<br></span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">]))&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Hello&nbsp;&lt;b&gt;</span><span style="color: #007700">{</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">]}</span><span style="color: #DD0000">&lt;/b&gt;"</span><span style="color: #007700">;<br><br>}&nbsp;else&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Hello&nbsp;&lt;b&gt;Guest&lt;/b&gt;&lt;br&nbsp;/&gt;"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Would&nbsp;you&nbsp;like&nbsp;to&nbsp;login?"</span><span style="color: #007700">;<br><br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   <p></p>
   <p class="para">
    It's even possible to take preventative measures to warn when forging is
    being attempted. If you know ahead of time exactly where a variable
    should be coming from, you can check to see if the submitted data is
    coming from an inappropriate kind of submission.  While it doesn't
    guarantee that data has not been forged, it does require an attacker to
    guess the right kind of forging.  If you don't care where the request
    data comes from, you can use <var class="varname"><var class="varname"><a href="reserved.variables.request.html" class="classname">$_REQUEST</a></var></var> as it contains
    a mix of GET, POST and COOKIE data.  See also the manual section on
    using <a href="language.variables.external.html" class="link">variables from external
    sources</a>.
   </p>
   <p class="para">
    </p><div class="example" id="example-363">
     <p><strong>Example #3 Detecting simple variable poisoning</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">'MAGIC_COOKIE'</span><span style="color: #007700">]))&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;MAGIC_COOKIE&nbsp;comes&nbsp;from&nbsp;a&nbsp;cookie.<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Be&nbsp;sure&nbsp;to&nbsp;validate&nbsp;the&nbsp;cookie&nbsp;data!<br><br></span><span style="color: #007700">}&nbsp;elseif&nbsp;(isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'MAGIC_COOKIE'</span><span style="color: #007700">])&nbsp;||&nbsp;isset(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'MAGIC_COOKIE'</span><span style="color: #007700">]))&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">mail</span><span style="color: #007700">(</span><span style="color: #DD0000">"admin@example.com"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Possible&nbsp;breakin&nbsp;attempt"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'REMOTE_ADDR'</span><span style="color: #007700">]);<br>&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Security&nbsp;violation,&nbsp;admin&nbsp;has&nbsp;been&nbsp;alerted."</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;exit;<br><br>}&nbsp;else&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;MAGIC_COOKIE&nbsp;isn't&nbsp;set&nbsp;through&nbsp;this&nbsp;REQUEST<br><br></span><span style="color: #007700">}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   <p></p>
   <p class="para">
    Of course, simply turning off register_globals does not mean your code
    is secure.  For every piece of data that is submitted, it should also be
    checked in other ways.  Always validate your user data and initialize
    your variables!  To check for uninitialized variables you may turn up
    <span class="function"><a href="function.error-reporting.html" class="function">error_reporting()</a></span> to show
    <strong><code>E_NOTICE</code></strong> level errors.
   </p>
   <p class="para">
    For information about emulating register_globals being On or Off, see this <a href="faq.misc.html#faq.misc.registerglobals" class="link">FAQ</a>.
   </p>

   <blockquote class="note"><p><strong class="note">Note</strong>: <strong>Superglobals: availability note
</strong><br></p><p class="para">Superglobal arrays such as <var class="varname"><var class="varname"><a href="reserved.variables.get.html" class="classname">$_GET</a></var></var>,
<var class="varname"><var class="varname"><a href="reserved.variables.post.html" class="classname">$_POST</a></var></var>, and <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER</a></var></var>, etc. are available
as of PHP 4.1.0. For more information, read the manual section on
<a href="language.variables.predefined.html" class="link">superglobals</a></p><p></p></blockquote>

  </div>

<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="89787">  
  <a class="name">
  <strong class="user"><em>lester burlap</em></strong></a><div class="date" title="2009-03-23 09:00"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom89787">
<div class="phpcode"><code><span class="html">
It would make this whole issue a lot less confusing for less-experienced PHP programmers if you just explained:<br><br>- $myVariable no longer works by default<br>- $_GET['myVariable'] works just fine<br><br>I'm embarrassed to say it's taken me six months since my ISP upgraded to PHP5 figure this out.&nbsp; I've completely rewritten scripts to stop using GET variables altogether.<br><br>I'm dumb.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113106">  
  <a class="name">
  <strong class="user"><em>elitescripts2000 at yahoo dot com</em></strong></a><div class="date" title="2013-08-30 04:23"><strong>11 months ago</strong></div>
  <div class="text" id="Hcom113106">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php<br><br></span><span class="comment">/* Forces all GET and POST globals to register and be magically quoted.<br> * This forced register_globals and magic_quotes_gpc both act as if<br> * they were turned ON even if turned off in your php.ini file.<br> *<br> * Reason behind forcing register_globals and magic_quotes is for legacy<br> * PHP scripts that need to run with PHP 5.4 and higher.&nbsp; PHP 5.4+ no longer<br> * support register_globals and magic_quotes, which breaks legacy PHP code.<br> *<br> * This is used as a workaround, while you upgrade your PHP code, yet still<br> * allows you to run in a PHP 5.4+ environment.<br> *<br> * Licenced under the GPLv2. Matt Kukowski Sept. 2013<br> */<br><br></span><span class="keyword">if (! isset(</span><span class="default">$PXM_REG_GLOB</span><span class="keyword">)) {<br><br>&nbsp; </span><span class="default">$PXM_REG_GLOB </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br><br>&nbsp; if (! </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'register_globals'</span><span class="keyword">)) {<br>&nbsp; &nbsp; foreach (</span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">, </span><span class="default">$_POST</span><span class="keyword">) as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; global $</span><span class="default">$key</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; $</span><span class="default">$key </span><span class="keyword">= (</span><span class="default">get_magic_quotes_gpc</span><span class="keyword">()) ? </span><span class="default">$val </span><span class="keyword">: </span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; }<br>&nbsp; if (! </span><span class="default">get_magic_quotes_gpc</span><span class="keyword">()) {<br>&nbsp; &nbsp; foreach (</span><span class="default">$_POST </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) </span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br>&nbsp; &nbsp; foreach (</span><span class="default">$_GET </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)&nbsp; </span><span class="default">$_GET</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]&nbsp; = </span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br>&nbsp; }<br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88209">  
  <a class="name">
  <strong class="user"><em>claude dot pache at gmail dot com</em></strong></a><div class="date" title="2009-01-15 05:52"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88209">
<div class="phpcode"><code><span class="html">
Beware that all the solutions given in the comments below for emulating register_global being off are bogus, because they can destroy predefined variables you should not unset. For example, suppose that you have<br><br><span class="default">&lt;?php $_GET</span><span class="keyword">[</span><span class="string">'_COOKIE'</span><span class="keyword">] == </span><span class="string">'foo'</span><span class="keyword">; </span><span class="default">?&gt;<br></span><br>Then the simplistic solutions of the previous comments let you lose all the cookies registered in the superglobal "$_COOKIE"! (Note that in this situation, even with register_global set to "on", PHP is smart enough to not mess predefined variables such as&nbsp; $_COOKIE.)<br><br>A proper solution for emulating register_global being off is given in the FAQ, as stated in the documentation above.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82213">  
  <a class="name">
  <strong class="user"><em>Ruquay K Calloway</em></strong></a><div class="date" title="2008-04-01 05:59"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82213">
<div class="phpcode"><code><span class="html">
While we all appreciate the many helpful posts to get rid of register_globals, maybe you're one of those who just loves it.&nbsp; More likely, your boss says you just have to live with it because he thinks it's a great feature.<br><br>No problem, just call (below defined):<br><br><span class="default">&lt;?php register_globals</span><span class="keyword">(); </span><span class="default">?&gt;<br></span><br>anywhere, as often as you want.&nbsp; Or update your scripts!<br><br><span class="default">&lt;?php<br></span><span class="comment">/**<br> * function to emulate the register_globals setting in PHP<br> * for all of those diehard fans of possibly harmful PHP settings :-)<br> * @author Ruquay K Calloway<br> * @param string $order order in which to register the globals, e.g. 'egpcs' for default<br> */<br></span><span class="keyword">function </span><span class="default">register_globals</span><span class="keyword">(</span><span class="default">$order </span><span class="keyword">= </span><span class="string">'egpcs'</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="comment">// define a subroutine<br>&nbsp; &nbsp; </span><span class="keyword">if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'register_global_array'</span><span class="keyword">))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; function </span><span class="default">register_global_array</span><span class="keyword">(array </span><span class="default">$superglobal</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$superglobal </span><span class="keyword">as </span><span class="default">$varname </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; global $</span><span class="default">$varname</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="default">$varname </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="default">$order </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\r\n"</span><span class="keyword">, </span><span class="default">trim</span><span class="keyword">(</span><span class="default">chunk_split</span><span class="keyword">(</span><span class="default">$order</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">)));<br>&nbsp; &nbsp; foreach(</span><span class="default">$order </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; switch(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'e'</span><span class="keyword">:&nbsp; &nbsp; </span><span class="default">register_global_array</span><span class="keyword">(</span><span class="default">$_ENV</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'g'</span><span class="keyword">:&nbsp; &nbsp; </span><span class="default">register_global_array</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'p'</span><span class="keyword">:&nbsp; &nbsp; </span><span class="default">register_global_array</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'c'</span><span class="keyword">:&nbsp; &nbsp; </span><span class="default">register_global_array</span><span class="keyword">(</span><span class="default">$_COOKIE</span><span class="keyword">);&nbsp; &nbsp; break;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'s'</span><span class="keyword">:&nbsp; &nbsp; </span><span class="default">register_global_array</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">);&nbsp; &nbsp; break;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84444">  
  <a class="name">
  <strong class="user"><em>moore at hs-furtwangen dot de</em></strong></a><div class="date" title="2008-07-14 01:19"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84444">
<div class="phpcode"><code><span class="html">
I had a look at the post from Dice, in which he suggested the function unregister_globals(). It didn't seem to work - only tested php 4.4.8 and 5.2.1 - so I made some tweaking to get it running. (I had to use $GLOBALS due to the fact that $$name won't work with superglobals).<br><br><span class="default">&lt;?php<br></span><span class="comment">//Undo register_globals<br></span><span class="keyword">function </span><span class="default">unregister_globals</span><span class="keyword">() {<br>&nbsp; &nbsp; if (</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'register_globals'</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$array </span><span class="keyword">= array(</span><span class="string">'_REQUEST'</span><span class="keyword">, </span><span class="string">'_FILES'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(isset(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$value</span><span class="keyword">])){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$value</span><span class="keyword">] as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$var</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isset(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) &amp;&amp; </span><span class="default">$var </span><span class="keyword">=== </span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//echo 'found '.$key.' = '.$var.' in $'.$value."\n";&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">unset(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;<br></span><br>The echo was for debuging, thought it might come in handy.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115632">  
  <a class="name">
  <strong class="user"><em>arman_y_92 at yahoo dot com</em></strong></a><div class="date" title="2014-08-28 02:44"><strong>36 minutes ago</strong></div>
  <div class="text" id="Hcom115632">
<div class="phpcode"><code><span class="html">
To all those fans of this insecure functionality (which I'm glad is now turned off by default) , you can just use extract() to achieve a similar goal more securely (unless you overwrite local variables with $_GET or $_POST data).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82542">  
  <a class="name">
  <strong class="user"><em>Dice</em></strong></a><div class="date" title="2008-04-15 09:46"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82542">
<div class="phpcode"><code><span class="html">
To expand on the nice bit of code Mike Willbanks wrote and Alexander tidied up, I turned the whole thing in a function that removes all the globals added by register_globals so it can be implemented in an included functions.php and doesn't litter the main pages too much.<br><br><span class="default">&lt;?php<br></span><span class="comment">//Undo register_globals<br></span><span class="keyword">function </span><span class="default">unregister_globals</span><span class="keyword">() {<br>&nbsp; &nbsp; if (</span><span class="default">ini_get</span><span class="keyword">(</span><span class="default">register_globals</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$array </span><span class="keyword">= array(</span><span class="string">'_REQUEST'</span><span class="keyword">, </span><span class="string">'_SESSION'</span><span class="keyword">, </span><span class="string">'_SERVER'</span><span class="keyword">, </span><span class="string">'_ENV'</span><span class="keyword">, </span><span class="string">'_FILES'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$value</span><span class="keyword">] as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$var</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$var </span><span class="keyword">=== </span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unset(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/security.globals.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:20:56 GMT -->


</body></html>