<html><!-- Mirrored from php.net/manual/en/function.create-function.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:09:08 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>create_function</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.create-function.html">
 <link rel="shorturl" href="http://php.net/create-function">
 <link rel="alternate" href="http://php.net/create-function" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.funchand.html">
 <link rel="prev" href="function.call-user-func.html">
 <link rel="next" href="function.forward-static-call-array.html">

 <link rel="alternate" href="function.create-function.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.create-function.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.create-function.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.create-function.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.create-function.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.create-function.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.create-function.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.create-function.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.create-function.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.create-function.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.create-function.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></li>      <li><a href="book.funchand.html">Function Handling</a></li>      <li><a href="ref.funchand.html">Function handling Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.create-function" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">create_function</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.1, PHP 5)</p><p class="refpurpose"><span class="refname">create_function</span> â€” <span class="dc-title">Create an anonymous (lambda-style) function</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.create-function-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>create_function</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$args</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$code</code></span>
   )</div>

  <p class="para rdfs-comment">
   Creates an anonymous function from the parameters passed, and
   returns a unique name for it.
  </p>
  <div class="caution"><strong class="caution">Caution</strong>
   <p class="para">
    This function internally performs an <span class="function"><a href="function.eval.html" class="function">eval()</a></span> and as such has the
    same security issues as <span class="function"><a href="function.eval.html" class="function">eval()</a></span>. Additionally it has bad performance
    and memory usage characteristics.
   </p>
   <p class="para">
    If you are using PHP 5.3.0 or newer a native
    <a href="functions.anonymous.html" class="link">anonymous function</a> should be used instead.
   </p>
  </div>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.create-function-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   Usually these parameters will be passed as single quote delimited strings.
   The reason for using single quoted strings, is to protect the variable
   names from parsing, otherwise, if you use double quotes there will be a
   need to escape the variable names, e.g. <em>\$avar</em>.
   </p><dl>

    
     <dt>
<code class="parameter">args</code></dt>

     <dd>

      <p class="para">
       The function arguments.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">code</code></dt>

     <dd>

      <p class="para">
       The function code.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.create-function-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns a unique function name as a string, or <strong><code>FALSE</code></strong> on error.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.create-function-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-5221">
    <p><strong>Example #1 
     Creating an anonymous function with <span class="function"><strong>create_function()</strong></span>
    </strong></p>
    <div class="example-contents"><p>
     You can use this function, to (for example) create a function from
     information gathered at run time:
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$newfunc&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'$a,$b'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'return&nbsp;"ln($a)&nbsp;+&nbsp;ln($b)&nbsp;=&nbsp;"&nbsp;.&nbsp;log($a&nbsp;*&nbsp;$b);'</span><span style="color: #007700">);<br>echo&nbsp;</span><span style="color: #DD0000">"New&nbsp;anonymous&nbsp;function:&nbsp;</span><span style="color: #0000BB">$newfunc</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #0000BB">$newfunc</span><span style="color: #007700">(</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">M_E</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br></span><span style="color: #FF8000">//&nbsp;outputs<br>//&nbsp;New&nbsp;anonymous&nbsp;function:&nbsp;lambda_1<br>//&nbsp;ln(2)&nbsp;+&nbsp;ln(2.718281828459)&nbsp;=&nbsp;1.6931471805599<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
  <p class="para">
   Or, perhaps to have general handler function that can apply a set
   of operations to a list of parameters:
  </p>
  <p class="para">
   </p><div class="example" id="example-5222">
    <p><strong>Example #2 
     Making a general processing function with
     <span class="function"><strong>create_function()</strong></span>
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">process</span><span style="color: #007700">(</span><span style="color: #0000BB">$var1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$var2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$farr</span><span style="color: #007700">)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$farr&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$f</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$f</span><span style="color: #007700">(</span><span style="color: #0000BB">$var1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$var2</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br></span><span style="color: #FF8000">//&nbsp;create&nbsp;a&nbsp;bunch&nbsp;of&nbsp;math&nbsp;functions<br></span><span style="color: #0000BB">$f1&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'if&nbsp;($a&nbsp;&gt;=0)&nbsp;{return&nbsp;"b*a^2&nbsp;=&nbsp;".$b*sqrt($a);}&nbsp;else&nbsp;{return&nbsp;false;}'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$f2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"return&nbsp;\"min(b^2+a,&nbsp;a^2,b)&nbsp;=&nbsp;\".min(\$a*\$a+\$b,\$b*\$b+\$a);"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$f3&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'if&nbsp;($a&nbsp;&gt;&nbsp;0&nbsp;&amp;&amp;&nbsp;$b&nbsp;!=&nbsp;0)&nbsp;{return&nbsp;"ln(a)/b&nbsp;=&nbsp;".log($a)/$b;&nbsp;}&nbsp;else&nbsp;{&nbsp;return&nbsp;false;&nbsp;}'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$farr&nbsp;</span><span style="color: #007700">=&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'$x,$y'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'return&nbsp;"some&nbsp;trig:&nbsp;".(sin($x)&nbsp;+&nbsp;$x*cos($y));'</span><span style="color: #007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'$x,$y'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'return&nbsp;"a&nbsp;hypotenuse:&nbsp;".sqrt($x*$x&nbsp;+&nbsp;$y*$y);'</span><span style="color: #007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'$a,$b'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$f1</span><span style="color: #007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'$a,$b'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$f2</span><span style="color: #007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'$a,$b'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$f3</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;);<br><br>echo&nbsp;</span><span style="color: #DD0000">"\nUsing&nbsp;the&nbsp;first&nbsp;array&nbsp;of&nbsp;anonymous&nbsp;functions\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">"parameters:&nbsp;2.3445,&nbsp;M_PI\n"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">process</span><span style="color: #007700">(</span><span style="color: #0000BB">2.3445</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">M_PI</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$farr</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;now&nbsp;make&nbsp;a&nbsp;bunch&nbsp;of&nbsp;string&nbsp;processing&nbsp;functions<br></span><span style="color: #0000BB">$garr&nbsp;</span><span style="color: #007700">=&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'$b,$a'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'if&nbsp;(strncmp($a,&nbsp;$b,&nbsp;3)&nbsp;==&nbsp;0)&nbsp;return&nbsp;"**&nbsp;\"$a\"&nbsp;'</span><span style="color: #007700">.<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'and&nbsp;\"$b\"\n**&nbsp;Look&nbsp;the&nbsp;same&nbsp;to&nbsp;me!&nbsp;(looking&nbsp;at&nbsp;the&nbsp;first&nbsp;3&nbsp;chars)";'</span><span style="color: #007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'$a,$b'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">';&nbsp;return&nbsp;"CRCs:&nbsp;"&nbsp;.&nbsp;crc32($a)&nbsp;.&nbsp;",&nbsp;".crc32($b);'</span><span style="color: #007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'$a,$b'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">';&nbsp;return&nbsp;"similar(a,b)&nbsp;=&nbsp;"&nbsp;.&nbsp;similar_text($a,&nbsp;$b,&nbsp;&amp;$p)&nbsp;.&nbsp;"($p%)";'</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;);<br>echo&nbsp;</span><span style="color: #DD0000">"\nUsing&nbsp;the&nbsp;second&nbsp;array&nbsp;of&nbsp;anonymous&nbsp;functions\n"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">process</span><span style="color: #007700">(</span><span style="color: #DD0000">"Twas&nbsp;brilling&nbsp;and&nbsp;the&nbsp;slithy&nbsp;toves"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Twas&nbsp;the&nbsp;night"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$garr</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>Using the first array of anonymous functions
parameters: 2.3445, M_PI
some trig: -1.6291725057799
a hypotenuse: 3.9199852871011
b*a^2 = 4.8103313314525
min(b^2+a, a^2,b) = 8.6382729035898
ln(a)/b = 0.27122299212594

Using the second array of anonymous functions
** "Twas the night" and "Twas brilling and the slithy toves"
** Look the same to me! (looking at the first 3 chars)
CRCs: -725381282, 342550513
similar(a,b) = 11(45.833333333333%)
</pre></div>
    </div>
   </div>
  <p></p>
  <p class="para">
   But perhaps the most common use for of lambda-style (anonymous) functions
   is to create callback functions, for example when using
   <span class="function"><a href="function.array-walk.html" class="function">array_walk()</a></span> or <span class="function"><a href="function.usort.html" class="function">usort()</a></span>
  </p>
  <p class="para">
   </p><div class="example" id="example-5223">
    <p><strong>Example #3 Using anonymous functions as callback functions</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$av&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"the&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"a&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"that&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"this&nbsp;"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">array_walk</span><span style="color: #007700">(</span><span style="color: #0000BB">$av</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'&amp;$v,$k'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'$v&nbsp;=&nbsp;$v&nbsp;.&nbsp;"mango";'</span><span style="color: #007700">));<br></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$av</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>Array
(
  [0] =&gt; the mango
  [1] =&gt; a mango
  [2] =&gt; that mango
  [3] =&gt; this mango
)
</pre></div>
    </div>
    <div class="example-contents"><p>
     an array of strings ordered from shorter to longer
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$sv&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"small"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"larger"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"a&nbsp;big&nbsp;string"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"it&nbsp;is&nbsp;a&nbsp;string&nbsp;thing"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$sv</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>Array
(
  [0] =&gt; small
  [1] =&gt; larger
  [2] =&gt; a big string
  [3] =&gt; it is a string thing
)
</pre></div>
    </div>
    <div class="example-contents"><p>
     sort it from longer to shorter
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>usort</span><span style="color: #007700">(</span><span style="color: #0000BB">$sv</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">create_function</span><span style="color: #007700">(</span><span style="color: #DD0000">'$a,$b'</span><span style="color: #007700">,</span><span style="color: #DD0000">'return&nbsp;strlen($b)&nbsp;-&nbsp;strlen($a);'</span><span style="color: #007700">));<br></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$sv</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>Array
(
  [0] =&gt; it is a string thing
  [1] =&gt; a big string
  [2] =&gt; larger
  [3] =&gt; small
)
</pre></div>
    </div>
   </div>
  <p></p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.create-function-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><a href="functions.anonymous.html" class="link">Anonymous functions</a></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="70691">  
  <a class="name">
  <strong class="user"><em>Dan D</em></strong></a><div class="date" title="2006-10-23 07:22"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom70691">
<div class="phpcode"><code><span class="html">
Beware when using anonymous functions in PHP as you would in languages like Python, Ruby, Lisp or Javascript.&nbsp; As was stated previously, the allocated memory is never released; they are not objects in PHP -- they are just dynamically named global functions -- so they don't have scope and are not subject to garbage collection.<br><br>So, if you're developing anything remotely reusable (OO or otherwise), I would avoid them like the plague.&nbsp; They're slow, inefficient and there's no telling if your implementation will end up in a large loop.&nbsp; Mine ended up in an iteration over ~1 million records and quickly exhasted my 500MB-per-process limit.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112616">  
  <a class="name">
  <strong class="user"><em>CertaiN</em></strong></a><div class="date" title="2013-07-04 07:10"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112616">
<div class="phpcode"><code><span class="html">
Wrapper for create_function, avoiding memory leaks.<br>This is mainly for older than PHP 5.3 .<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">create_lambda</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">) {<br>&nbsp; &nbsp; static </span><span class="default">$list </span><span class="keyword">= array();<br>&nbsp; &nbsp; </span><span class="default">$hash </span><span class="keyword">= </span><span class="default">md5</span><span class="keyword">(</span><span class="string">"</span><span class="keyword">{</span><span class="default">$args</span><span class="keyword">}</span><span class="string">\0</span><span class="keyword">{</span><span class="default">$code</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">);<br>&nbsp; &nbsp; if (!isset(</span><span class="default">$list</span><span class="keyword">[</span><span class="default">$hash</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$list</span><span class="keyword">[</span><span class="default">$hash</span><span class="keyword">] = </span><span class="default">create_function</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$list</span><span class="keyword">[</span><span class="default">$hash</span><span class="keyword">];<br>}</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103080">  
  <a class="name">
  <strong class="user"><em>Dave H</em></strong></a><div class="date" title="2011-03-24 06:47"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103080">
<div class="phpcode"><code><span class="html">
The following function is very useful for creating an alias of a user function. 
<br>For built-in functions, it is less useful because default values are not available, so function aliases for built-in functions must have all parameters supplied, whether optional or not.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">create_function_alias</span><span class="keyword">(</span><span class="default">$function_name</span><span class="keyword">, </span><span class="default">$alias_name</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; if(</span><span class="default">function_exists</span><span class="keyword">(</span><span class="default">$alias_name</span><span class="keyword">))
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$rf </span><span class="keyword">= new </span><span class="default">ReflectionFunction</span><span class="keyword">(</span><span class="default">$function_name</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$fproto </span><span class="keyword">= </span><span class="default">$alias_name</span><span class="keyword">.</span><span class="string">'('</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$fcall </span><span class="keyword">= </span><span class="default">$function_name</span><span class="keyword">.</span><span class="string">'('</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$need_comma </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; foreach(</span><span class="default">$rf</span><span class="keyword">-&gt;</span><span class="default">getParameters</span><span class="keyword">() as </span><span class="default">$param</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$need_comma</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$fproto </span><span class="keyword">.= </span><span class="string">','</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$fcall </span><span class="keyword">.= </span><span class="string">','</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$fproto </span><span class="keyword">.= </span><span class="string">'$'</span><span class="keyword">.</span><span class="default">$param</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$fcall </span><span class="keyword">.= </span><span class="string">'$'</span><span class="keyword">.</span><span class="default">$param</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">();
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$param</span><span class="keyword">-&gt;</span><span class="default">isOptional</span><span class="keyword">() &amp;&amp; </span><span class="default">$param</span><span class="keyword">-&gt;</span><span class="default">isDefaultValueAvailable</span><span class="keyword">())
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">$param</span><span class="keyword">-&gt;</span><span class="default">getDefaultValue</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">))
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="string">"'</span><span class="default">$val</span><span class="string">'"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$fproto </span><span class="keyword">.= </span><span class="string">' = '</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$need_comma </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="default">$fproto </span><span class="keyword">.= </span><span class="string">')'</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$fcall </span><span class="keyword">.= </span><span class="string">')'</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="string">"function </span><span class="default">$fproto</span><span class="string">"</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$f </span><span class="keyword">.= </span><span class="string">'{return '</span><span class="keyword">.</span><span class="default">$fcall</span><span class="keyword">.</span><span class="string">';}'</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; eval(</span><span class="default">$f</span><span class="keyword">);
<br>&nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115179">  
  <a class="name">
  <strong class="user"><em>kexianbin at diyism dot com</em></strong></a><div class="date" title="2014-06-10 04:52"><strong>2 months ago</strong></div>
  <div class="text" id="Hcom115179">
<div class="phpcode"><code><span class="html">
I use this create_closure() in my work to seperate callbacks into Classes:<br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">create_closure</span><span class="keyword">(</span><span class="default">$fun</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">, </span><span class="default">$uses</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {</span><span class="default">$params</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">.</span><span class="string">','</span><span class="keyword">.</span><span class="default">$uses</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$str_params</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$params </span><span class="keyword">as </span><span class="default">$v</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span><span class="default">$v</span><span class="keyword">=</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">, </span><span class="string">' &amp;$'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$str_params</span><span class="keyword">.=</span><span class="string">'\''</span><span class="keyword">.</span><span class="default">$v</span><span class="keyword">.</span><span class="string">'\'=&gt;&amp;$'</span><span class="keyword">.</span><span class="default">$v</span><span class="keyword">.</span><span class="string">', '</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="string">"return function(</span><span class="keyword">{</span><span class="default">$args</span><span class="keyword">}</span><span class="string">) use (</span><span class="keyword">{</span><span class="default">$uses</span><span class="keyword">}</span><span class="string">) {</span><span class="keyword">{</span><span class="default">$fun</span><span class="keyword">}</span><span class="string">(array(</span><span class="keyword">{</span><span class="default">$str_params</span><span class="keyword">}</span><span class="string">));};"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br></span><span class="default">?&gt;<br></span><br>example:<br><span class="default">&lt;?php<br>$loop</span><span class="keyword">-&gt;</span><span class="default">addPeriodicTimer</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, eval(</span><span class="default">create_closure</span><span class="keyword">(</span><span class="string">'pop_message'</span><span class="keyword">, </span><span class="string">'$timer'</span><span class="keyword">, </span><span class="string">'$cache_key, $n, &amp;$response, &amp;$redis_client'</span><span class="keyword">)));<br><br>function </span><span class="default">pop_message</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {</span><span class="default">extract</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">, </span><span class="default">EXTR_REFS</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$redis_client</span><span class="keyword">-&gt;</span><span class="default">ZRANGE</span><span class="keyword">(</span><span class="default">$cache_key</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$n</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;</span><span class="default">then</span><span class="keyword">(</span><span class="comment">//normal<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function(</span><span class="default">$data</span><span class="keyword">) use (</span><span class="default">$cache_key</span><span class="keyword">, </span><span class="default">$n</span><span class="keyword">, &amp;</span><span class="default">$timer</span><span class="keyword">, &amp;</span><span class="default">$response</span><span class="keyword">, &amp;</span><span class="default">$redis_client</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {</span><span class="comment">//...<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">},<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//exception<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function (</span><span class="default">$e</span><span class="keyword">) use (&amp;</span><span class="default">$timer</span><span class="keyword">, &amp;</span><span class="default">$response</span><span class="keyword">, &amp;</span><span class="default">$redis_client</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {</span><span class="comment">//...<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113275">  
  <a class="name">
  <strong class="user"><em>CertaiN</em></strong></a><div class="date" title="2013-09-19 11:49"><strong>11 months ago</strong></div>
  <div class="text" id="Hcom113275">
<div class="phpcode"><code><span class="html">
Best wapper:<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">create_lambda</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">) {<br>&nbsp; &nbsp; static </span><span class="default">$func</span><span class="keyword">;<br>&nbsp; &nbsp; if (!isset(</span><span class="default">$func</span><span class="keyword">[</span><span class="default">$args</span><span class="keyword">][</span><span class="default">$code</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$func</span><span class="keyword">[</span><span class="default">$args</span><span class="keyword">][</span><span class="default">$code</span><span class="keyword">] = </span><span class="default">create_function</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$func</span><span class="keyword">[</span><span class="default">$args</span><span class="keyword">][</span><span class="default">$code</span><span class="keyword">];<br>}</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113150">  
  <a class="name">
  <strong class="user"><em>ionix at NOSPAM dot post dot com</em></strong></a><div class="date" title="2013-09-05 04:56"><strong>11 months ago</strong></div>
  <div class="text" id="Hcom113150">
<div class="phpcode"><code><span class="html">
I experimented a bit in creating a lambda function using a variable amount of arguments. While I couldn't find an efficient way to create a random bit of code, I was able to get it to behave as a front end for existing functions (as well as user-defined of course).<br><br>The code required me to use the dreaded eval() function to get it to use a variable amount of parameters, so be sure that all input is thoroughly cleaned if derived from the user.<br><br><span class="default">&lt;?php<br><br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">run_function</span><span class="keyword">( </span><span class="default">$function </span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Get Arguments, Unset Exisitng Parameter<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$params </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; &nbsp; unset( </span><span class="default">$params</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] );<br><br>&nbsp; &nbsp; &nbsp; &nbsp; if( ( </span><span class="default">$count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">( </span><span class="default">$params </span><span class="keyword">) ) &gt; </span><span class="default">0 </span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$args </span><span class="keyword">= </span><span class="string">'$a'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$inc </span><span class="keyword">= </span><span class="string">'b'</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Create Argument String - Formats as '$a, $b, $c' Per Number of Arguments<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">for( </span><span class="default">$x </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$count</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++ )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$args </span><span class="keyword">.= </span><span class="string">', $' </span><span class="keyword">. </span><span class="default">$inc</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$inc</span><span class="keyword">++;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Create Lambda Function and Format Paramters<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$lambda </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">( </span><span class="default">$args</span><span class="keyword">, </span><span class="string">'return ' </span><span class="keyword">. </span><span class="default">$function </span><span class="keyword">. </span><span class="string">'(' </span><span class="keyword">. </span><span class="default">$args </span><span class="keyword">. </span><span class="string">');' </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$params </span><span class="keyword">= </span><span class="string">"'" </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'\', \''</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">) . </span><span class="string">"'"</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Build and Evaluate Function with Parameters<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$eval </span><span class="keyword">= </span><span class="string">'$return = $lambda(' </span><span class="keyword">. </span><span class="default">$params </span><span class="keyword">. </span><span class="string">');'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eval(</span><span class="default">$eval</span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$return</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br></span><span class="default">?&gt;<br></span><br>For most applications you would be better off calling the function normally. Perhaps this little proof of concept may find some use if adapted to work by someone who requires it.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113065">  
  <a class="name">
  <strong class="user"><em>CertaiN</em></strong></a><div class="date" title="2013-08-25 06:20"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom113065">
<div class="phpcode"><code><span class="html">
How to save memory-space:<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">create_lambda</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">) {<br>&nbsp; &nbsp; static </span><span class="default">$list </span><span class="keyword">= array();<br>&nbsp; &nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="string">"</span><span class="keyword">{</span><span class="default">$args</span><span class="keyword">}</span><span class="string">\0</span><span class="keyword">{</span><span class="default">$code</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">;<br>&nbsp; &nbsp; if (!isset(</span><span class="default">$list</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$list</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">create_function</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$list</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br>}</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99933">  
  <a class="name">
  <strong class="user"><em>phenno7 [a_t] yahoo dot com</em></strong></a><div class="date" title="2010-09-15 01:53"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom99933">
<div class="phpcode"><code><span class="html">
The function takes as arguments the tree array, the category id on which i want the retrieval, and the depth level for which i would like the subcategories ids returned.
<br>
<br>this saves me a LOT of time on large adjacency list trees.
<br>
<br><span class="default">&lt;?php
<br>$ctg_tree </span><span class="keyword">= array(
<br></span><span class="string">'1'</span><span class="keyword">=&gt;array(</span><span class="string">'parent_id'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'children'</span><span class="keyword">=&gt;array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'2'</span><span class="keyword">=&gt;array(</span><span class="string">'parent_id'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'children'</span><span class="keyword">=&gt;array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'3'</span><span class="keyword">=&gt;array(</span><span class="string">'parent_id'</span><span class="keyword">=&gt;</span><span class="default">2</span><span class="keyword">))),
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'4'</span><span class="keyword">=&gt;array(</span><span class="string">'parent_id'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'children'</span><span class="keyword">=&gt;array(
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'5'</span><span class="keyword">=&gt;array(</span><span class="string">'parent_id'</span><span class="keyword">=&gt;</span><span class="default">4</span><span class="keyword">),
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'6'</span><span class="keyword">=&gt;array(</span><span class="string">'parent_id'</span><span class="keyword">=&gt;</span><span class="default">4</span><span class="keyword">))))));
<br>
<br>function </span><span class="default">getSubCategories</span><span class="keyword">(</span><span class="default">$ctg_tree</span><span class="keyword">, </span><span class="default">$id</span><span class="keyword">, </span><span class="default">$level </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$getBranchIds </span><span class="keyword">=
<br></span><span class="default">create_function</span><span class="keyword">(
<br></span><span class="string">'$tree, $ctg_id, $level = null, $arr = null,'</span><span class="keyword">.
<br></span><span class="string">' $push = false, $getBranchIds'</span><span class="keyword">,</span><span class="string">'
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!$arr) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $arr = array();
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(intval($level) &amp;&amp; $push){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $level--;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach($tree as $key=&gt;$ctg) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($push) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $arr[] = $key;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($ctg_id == $key) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $start = true;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $push = true;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>if(count($ctg[\'children\']) &amp;&amp; (intval($level) || $level === null)) {
<br>$getBranchIds(
<br>$ctg[\'children\'],$ctg_id,$level,&amp;$arr,$push,$getBranchIds
<br>);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($start) return $arr;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $arr;'</span><span class="keyword">);
<br>
<br>return </span><span class="default">$getBranchIds</span><span class="keyword">(
<br></span><span class="default">$ctg_tree</span><span class="keyword">, </span><span class="default">$id</span><span class="keyword">, </span><span class="default">$level</span><span class="keyword">, </span><span class="default">null</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">, </span><span class="default">$getBranchIds
<br></span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>
<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">getSubCategories</span><span class="keyword">(</span><span class="default">$ctg_tree</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>Array
<br>(
<br>&nbsp; &nbsp; [0] =&gt; 5
<br>&nbsp; &nbsp; [1] =&gt; 6
<br>)
<br>
<br>print_r(getSubCategories($ctg_tree, 1, 1));
<br>
<br>Array
<br>(
<br>&nbsp; &nbsp; [0] =&gt; 2
<br>&nbsp; &nbsp; [1] =&gt; 4
<br>)
<br>
<br><span class="default">&lt;?php
<br>print_r</span><span class="keyword">(</span><span class="default">getSubCategories</span><span class="keyword">(</span><span class="default">$ctg_tree</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>Array
<br>(
<br>&nbsp; &nbsp; [0] =&gt; 2
<br>&nbsp; &nbsp; [1] =&gt; 3
<br>&nbsp; &nbsp; [2] =&gt; 4
<br>&nbsp; &nbsp; [3] =&gt; 5
<br>&nbsp; &nbsp; [4] =&gt; 6
<br>)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99721">  
  <a class="name">
  <strong class="user"><em>Its Will</em></strong></a><div class="date" title="2010-09-01 08:27"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom99721">
<div class="phpcode"><code><span class="html">
If you create a function that will only be used from an object context (i.e. you want a dynamic method that can then call methods from the original object, still maintaining access to the object's runtime values) then you can use the following functions I have created (ob_lambda_func and ob_lambda) to enable the dynamic function to easily call *public* methods on the object, in their runtime contexts:
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">/* the OB Lambda functions allow a lambda function to call a method from its callee's object */
<br></span><span class="keyword">if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'ob_lambda_func'</span><span class="keyword">)){
<br>function </span><span class="default">ob_lambda_func</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">) {
<br>&nbsp;&nbsp; if((</span><span class="default">phpversion</span><span class="keyword">()+</span><span class="default">0</span><span class="keyword">)&lt;</span><span class="default">5.1 </span><span class="keyword">|| (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">phpversion</span><span class="keyword">(),</span><span class="default">2</span><span class="keyword">)+</span><span class="default">0</span><span class="keyword">)&lt;</span><span class="default">1.1</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp;&nbsp; die(</span><span class="string">"\nError: This script requires PHP v5.1.1+!\n"</span><span class="keyword">);
<br>&nbsp;&nbsp; </span><span class="default">$bt</span><span class="keyword">=</span><span class="default">debug_backtrace</span><span class="keyword">();
<br>&nbsp;&nbsp; foreach(</span><span class="default">$bt </span><span class="keyword">as </span><span class="default">$xsp</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp;&nbsp; if(isset(</span><span class="default">$xsp</span><span class="keyword">[</span><span class="string">'object'</span><span class="keyword">])) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">method_exists</span><span class="keyword">(</span><span class="default">$xsp</span><span class="keyword">[</span><span class="string">'object'</span><span class="keyword">], </span><span class="default">$method</span><span class="keyword">)) continue;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">call_user_func_array</span><span class="keyword">(array(</span><span class="default">$xsp</span><span class="keyword">[</span><span class="string">'object'</span><span class="keyword">], </span><span class="default">$method</span><span class="keyword">), </span><span class="default">$args</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp;&nbsp; }
<br>&nbsp;&nbsp; }
<br>&nbsp;&nbsp; if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">))
<br>&nbsp; &nbsp; &nbsp;&nbsp; die(</span><span class="string">"\nOB: Internal Error! (</span><span class="default">$method</span><span class="string">)"</span><span class="keyword">);
<br>&nbsp;&nbsp; return </span><span class="default">call_user_func_array</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">);
<br>}}
<br>if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'ob_lambda'</span><span class="keyword">)){
<br>function </span><span class="default">ob_lambda</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">) {
<br>&nbsp;&nbsp; return </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">,</span><span class="string">'$args=func_get_args(); return ob_lambda_func('</span><span class="keyword">.</span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">).</span><span class="string">',$args);'</span><span class="keyword">);
<br>}}
<br>
<br></span><span class="comment">/* Usage:
<br> *&nbsp;&nbsp; For each callable method, store the results of ob_lambda('method_name')
<br> *&nbsp;&nbsp; When a lambda function you call wants to access one of these methods,
<br> *&nbsp; &nbsp; you need to pass it the result of ob_lambda for that method, the easiest
<br> *&nbsp; &nbsp; way is to have one of the lambda functions arguments accept the result
<br> *&nbsp; &nbsp; &nbsp;&nbsp; i.e.:&nbsp; $myFunc=ob_lambda('myMethod');
<br> *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $lf1=create_function('$func', '$func( ... args ... )');
<br> *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $lf1($myFunc);
<br> *&nbsp; &nbsp; because create_function prepends a \0 to the function name, it is difficult
<br> *&nbsp; &nbsp; to pass the result of ob_lambda to the target function without using an argument
<br> */
<br>/* here is an example -- lambda function Foo::test can call Foo::Bar and Foo::Baz, and these&nbsp; */
<br></span><span class="keyword">class </span><span class="default">Foo </span><span class="keyword">{
<br>&nbsp; &nbsp; private </span><span class="default">$bar</span><span class="keyword">, </span><span class="default">$baz</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">;
<br>&nbsp; &nbsp; private </span><span class="default">$runtimeValue</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;
<br>&nbsp; &nbsp; function </span><span class="default">__construct</span><span class="keyword">() {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">runtimeValue</span><span class="keyword">=</span><span class="default">rand</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bar</span><span class="keyword">=</span><span class="default">ob_lambda</span><span class="keyword">(</span><span class="string">'Bar'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">baz</span><span class="keyword">=</span><span class="default">ob_lambda</span><span class="keyword">(</span><span class="string">'Baz'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">=</span><span class="default">create_function</span><span class="keyword">(
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'$bar, $baz'</span><span class="keyword">,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'$bar("Hello, World!"); $baz();'
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; function </span><span class="default">Test</span><span class="keyword">() {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$fn</span><span class="keyword">=</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$fn</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bar</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">baz</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; function </span><span class="default">Bar</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"</span><span class="default">$a</span><span class="string">: Bar (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">runtimeValue</span><span class="string">)\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; function </span><span class="default">Baz</span><span class="keyword">() {
<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"and another! Baz (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">runtimeValue</span><span class="string">)\n"</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>}
<br>
<br></span><span class="default">$foo</span><span class="keyword">=new </span><span class="default">Foo</span><span class="keyword">();
<br></span><span class="comment">// Foo::Bar("Testing Other Method"); &lt;-- this causes fatal error
<br>//&nbsp; (using $this when not in object context)
<br></span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">Test</span><span class="keyword">();
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>This snippet (with test) shows how the lambda function $foo-&gt;test can call Foo::Bar and Foo::Baz without an explicit reference to the original object. The methods are run from their object context, and so can access the runtime-modified variable $foo-&gt;runtimeValue, which is set to a random number on construction.
<br>The function definition for $foo-&gt;test is the following:
<br>function ($bar, $baz) {
<br>&nbsp; &nbsp; $bar("Hello, World!");
<br>&nbsp; &nbsp; $baz;
<br>}
<br>As you can see, it is clean and simple, with no obvious artifacts from the use of OB Lambda
<br>
<br>The expected output should be:
<br>Hello, World!: Bar (440048505)
<br>and another! Baz (440048505)
<br>
<br>Or any other random number in place of 440048505
<br>Make sure, before you change your code, that your target server has PHP 5.1.1+, or these functions won't work and will return an error!
<br>Hope this helps anyone as much as it has me! :)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98939">  
  <a class="name">
  <strong class="user"><em>julius _email _me _at grantzau _dot _com</em></strong></a><div class="date" title="2010-07-16 09:59"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98939">
<div class="phpcode"><code><span class="html">
To avoid memory problems, when creating a dynamic function within loops, register it as a global variable, and check if it has already been set;
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">global </span><span class="default">$my_func</span><span class="keyword">;
<br>if (!isset(</span><span class="default">$my_func</span><span class="keyword">))
<br>{
<br>&nbsp; &nbsp; </span><span class="default">$my_func </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">);
<br>}
<br>
<br></span><span class="default">$my_func</span><span class="keyword">();
<br></span><span class="default">?&gt;
<br></span>
<br>That way you don't end up creating the same function twice (or a couple of million of times, as it happened to me...)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96321">  
  <a class="name">
  <strong class="user"><em>v dot churakov at i2d dot ru</em></strong></a><div class="date" title="2010-02-20 04:56"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96321">
<div class="phpcode"><code><span class="html">
&lt;?<br><br>function is_function( &amp;$mixed )<br>{<br>&nbsp; &nbsp; if ( is_object( $mixed ) ) {<br>&nbsp; &nbsp; &nbsp; &nbsp; return ( $mixed instanceof Closure );<br>&nbsp; &nbsp; } elseif( is_string( $mixed ) ) {<br>&nbsp; &nbsp; &nbsp; &nbsp; return function_exists( $mixed );<br>&nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; }<br>}<br><br>function myfunc(){}<br><br>$test = 123;<br>echo&nbsp; is_function( $test ); //will return false<br><br>$test = 'isset';<br>echo&nbsp; is_function( $test ); //will return false... it's not work with reserved :( ...<br><br>$test = 'myfunc';<br>echo&nbsp; is_function( $test ); //will return true<br><br>$test = create_function( '', 'echo 123;' );<br>echo&nbsp; is_function( $test ); //will return true<br><br>$test = function () { echo 123; };<br>echo&nbsp; is_function( $test ); //will return true<br><br>?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91949">  
  <a class="name">
  <strong class="user"><em>edgar at goodforall dot eu</em></strong></a><div class="date" title="2009-07-02 07:45"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91949">
<div class="phpcode"><code><span class="html">
Just a little toy I thought up, I would like to share. Creates an anonymous function, which let you use a class&nbsp; as a function.<br><br>In php 5.3 there is support for real functors&nbsp; (trough __invoke):<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">createFunctor</span><span class="keyword">(</span><span class="default">$className</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$content </span><span class="keyword">= </span><span class="string">"<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; static \$class;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!\$class){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \$class = new </span><span class="default">$className</span><span class="string">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return \$class-&gt;run(\$args);<br>&nbsp; &nbsp; &nbsp; &nbsp; "</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$args'</span><span class="keyword">, </span><span class="default">$content</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$f</span><span class="keyword">;<br><br>}<br>class </span><span class="default">test </span><span class="keyword">{<br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">run</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print </span><span class="default">$args</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>}<br></span><span class="default">$test </span><span class="keyword">= </span><span class="default">createFunctor</span><span class="keyword">(</span><span class="string">'test'</span><span class="keyword">);<br></span><span class="default">$test</span><span class="keyword">(</span><span class="string">'hello world'</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85890">  
  <a class="name">
  <strong class="user"><em>Stefan Scheld</em></strong></a><div class="date" title="2008-09-23 07:48"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom85890">
<div class="phpcode"><code><span class="html">
Workaround is as follows:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">class </span><span class="default">Foo </span><span class="keyword">{
<br>&nbsp; &nbsp; function </span><span class="default">setHandler</span><span class="keyword">(</span><span class="default">$handlerName</span><span class="keyword">, </span><span class="default">$handlerCode</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handlerFunctions</span><span class="keyword">[</span><span class="default">$handlerName</span><span class="keyword">] = </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'&amp;$self, $dataArr'</span><span class="keyword">, </span><span class="default">$handlerCode</span><span class="keyword">);
<br></span><span class="comment">// NOTE: $this not allowed here, using $self as replacement
<br>&nbsp; &nbsp; </span><span class="keyword">}
<br>
<br>&nbsp; &nbsp; function </span><span class="default">executeHandler</span><span class="keyword">(</span><span class="default">$handlerName</span><span class="keyword">, </span><span class="default">$dataArr</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handlerFunctions</span><span class="keyword">[</span><span class="default">$handlerName</span><span class="keyword">]) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handlerFunctions</span><span class="keyword">[</span><span class="default">$handlerName</span><span class="keyword">](&amp;</span><span class="default">$this</span><span class="keyword">, </span><span class="default">$dataArr</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp;&nbsp; }
<br>
<br>&nbsp; &nbsp; function </span><span class="default">getConstantInfo</span><span class="keyword">(</span><span class="default">$what</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; return(</span><span class="default">$what</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>}
<br>
<br></span><span class="default">$bla </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">;
<br>
<br></span><span class="default">$bla</span><span class="keyword">-&gt;</span><span class="default">setHandler</span><span class="keyword">(</span><span class="string">"load"</span><span class="keyword">, </span><span class="string">'echo($self-&gt;getConstantInfo("name")."\n");'</span><span class="keyword">);
<br></span><span class="default">$bla</span><span class="keyword">-&gt;</span><span class="default">executeHandler</span><span class="keyword">(</span><span class="string">"load"</span><span class="keyword">, array(</span><span class="string">"foo" </span><span class="keyword">=&gt; </span><span class="string">"bar"</span><span class="keyword">));
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85391">  
  <a class="name">
  <strong class="user"><em>neo at nowhere dot com</em></strong></a><div class="date" title="2008-08-28 01:56"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom85391">
<div class="phpcode"><code><span class="html">
In response to kkaiser at revolution-records dot net's note, even tho PHP will allow you to use <br>&lt;?<br>$myfunc = create_function('$this', $code);<br>?&gt;<br>You can NOT use a reference to "$this" inside of the anonymous function, as PHP will complain that you are using a reference to "$this" in a non-object context.<br><br>Currently, I have not found a work-around for this...</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84955">  
  <a class="name">
  <strong class="user"><em>Alan FUNG</em></strong></a><div class="date" title="2008-08-07 12:24"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84955">
<div class="phpcode"><code><span class="html">
$f = create_function('','echo "function defined by create_function";');<br>$f();<br><br>result:<br>function defined by create_function<br><br>You may define no return in function body while you are using create_function.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="80904">  
  <a class="name">
  <strong class="user"><em>Rene Saarsoo</em></strong></a><div class="date" title="2008-02-06 02:31"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80904">
<div class="phpcode"><code><span class="html">
Here has been some discussion about the "memory leak" create_function() can create.<br><br>What create_function() actually does, is creating an ordinary function with name chr(0).lambda_n where n is some number:<br><br><span class="default">&lt;?php<br>$f </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="string">'return 1;'</span><span class="keyword">);<br><br>function </span><span class="default">lambda_1</span><span class="keyword">() { return </span><span class="default">2</span><span class="keyword">; }<br><br></span><span class="default">$g </span><span class="keyword">= </span><span class="string">"lambda_1"</span><span class="keyword">;<br>echo </span><span class="default">$g</span><span class="keyword">(); </span><span class="comment">// outputs: 2<br><br></span><span class="default">$h </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">).</span><span class="string">"lambda_1"</span><span class="keyword">;<br>echo </span><span class="default">$h</span><span class="keyword">(); </span><span class="comment">// outputs: 1<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77177">  
  <a class="name">
  <strong class="user"><em>TSE-WebDesign</em></strong></a><div class="date" title="2007-08-18 09:55"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom77177">
<div class="phpcode"><code><span class="html">
Here's how to call a runtime-created function from another runtime-created function:<br><span class="default">&lt;?php<br>&nbsp; &nbsp; &nbsp; &nbsp; $get_func </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$func'</span><span class="keyword">, </span><span class="string">'return substr($func,1);'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$get_value </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$index'</span><span class="keyword">,</span><span class="string">'return pow($index,$index);'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$another_func </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$a'</span><span class="keyword">, </span><span class="string">'$func="\x00"."'</span><span class="keyword">.</span><span class="default">$get_func</span><span class="keyword">(</span><span class="default">$get_value</span><span class="keyword">).</span><span class="string">'";return $func($a);'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$another_func</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">); </span><span class="comment"># result is 4<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74492">  
  <a class="name">
  <strong class="user"><em>kkaiser at revolution-records dot net</em></strong></a><div class="date" title="2007-04-13 01:10"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74492">
<div class="phpcode"><code><span class="html">
In the process of migrating a PHP4 codebase to PHP5, I ran into a peculiar problem. In the library, every class was derived from a generic class called 'class_container'. 'class_container' contained an array called runtime_functions and a method called class_function that was as follows:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">class_function</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">,</span><span class="default">$params</span><span class="keyword">,</span><span class="default">$code</span><span class="keyword">) {
<br>
<br>&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">runtime_functions</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">create_function</span><span class="keyword">(</span><span class="default">$params</span><span class="keyword">,</span><span class="default">$code</span><span class="keyword">);
<br>
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>In a subclass of class_container, there was a function that utilized class_function() to store some custom lambda functions that were self-referential:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">myfunc</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">,</span><span class="default">$code</span><span class="keyword">) {
<br>
<br>&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">class_function</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">,</span><span class="string">'$theobj'</span><span class="keyword">,</span><span class="string">'$this=&amp;$theobj;'</span><span class="keyword">.</span><span class="default">$code</span><span class="keyword">);
<br>
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>In PHP4, this worked just fine. The idea was to write blocks of code at the subclass level, such as "echo $this-&gt;id;", then simply $MYOBJ-&gt;myfunc("go","echo $this-&gt;id;"); and later call it like $MYOBJ-&gt;runtime_functions["go"]();
<br>
<br>It essentially worked exactly like binding anonymous functions to objects in Javascript.
<br>
<br>Note how the "$this" keyword had to be manually redefined for the $code block to work.
<br>
<br>In PHP5, however, you can't redeclare $this without getting a fatal error, so the code had to be updated to:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">myfunc</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">,</span><span class="default">$code</span><span class="keyword">) {
<br>
<br>&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">class_function</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">,</span><span class="string">'$this'</span><span class="keyword">,</span><span class="default">$code</span><span class="keyword">);
<br>
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>Apparently create_function() allows you to set $this via a function argument, allowing you to bind anonymous functions to instantiated objects. Thought it might be useful to somebody.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="70194">  
  <a class="name">
  <strong class="user"><em>Phlyst</em></strong></a><div class="date" title="2006-10-06 05:10"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom70194">
<div class="phpcode"><code><span class="html">
In reply to info at adaniels dot nl:<br><br>You may not be able to use __FUNCTION__ in a lambda (thanks for pointing it out; I was having that problem just now), but you can use $GLOBALS to work around it if you're assigning the function to a variable. I reimplemented array_walk_recursive() in PHP4 like this:<br><br><span class="default">&lt;?php<br>$array_walk_recursive </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'&amp;$array, $callback'</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'foreach($array as $element) {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(is_array($element)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $funky = $GLOBALS["array_walk_recursive"];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $funky($element, $callback);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $callback($element);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }'</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="69951">  
  <a class="name">
  <strong class="user"><em>Josh J</em></strong></a><div class="date" title="2006-09-27 12:45"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom69951">
<div class="phpcode"><code><span class="html">
In regards to the recursion issue by info at adaniels dot nl<br><br>Anon function recursion by referencing the function variable in the correct scope.<br><span class="default">&lt;?php<br>$fn2 </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$a'</span><span class="keyword">, </span><span class="string">'echo $a; if ($a &lt; 10) call_user_func($GLOBALS["fn2"], ++$a);'</span><span class="keyword">);<br></span><span class="default">$fn2</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="65964">  
  <a class="name">
  <strong class="user"><em>info at adaniels dot nl</em></strong></a><div class="date" title="2006-05-10 03:42"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom65964">
<div class="phpcode"><code><span class="html">
Note that using __FUNCTION__ in a an anonymous function, will always result '__lambda_func'.<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; $fn </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="string">'echo __FUNCTION__;'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$fn</span><span class="keyword">();<br>&nbsp; &nbsp; </span><span class="comment">// Result: __lambda_func<br>&nbsp; &nbsp; </span><span class="keyword">echo </span><span class="default">$fn</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="comment">// Result: Âºlambda_2 (the actual first character cannot be displayed)<br></span><span class="default">?&gt;<br></span><br>This means that a anonymous function can't be used recursively. The following code (recursively counting to 10) results in an error:<br><span class="default">&lt;?php<br>&nbsp; &nbsp; $fn2 </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$a'</span><span class="keyword">, </span><span class="string">'echo $a; if ($a &lt; 10) call_user_func(__FUNCTION__, $a++);'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$fn2</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="comment">// Warning: call_user_func(__lambda_func) [function.call-user-func]: First argument is expected to be a valid callback in T:/test/test.php(21) : runtime-created function on line 1<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="62577">  
  <a class="name">
  <strong class="user"><em>josh at janrain dot com</em></strong></a><div class="date" title="2006-03-03 10:21"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom62577">
<div class="phpcode"><code><span class="html">
Beware! This is merely a convenience function that generates a unique name for a regular function. It is *not* a closure or even an anonymous function. It is just a regular function that gets named for you.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="60913">  
  <a class="name">
  <strong class="user"><em>Joshua E Cook</em></strong></a><div class="date" title="2006-01-19 04:43"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom60913">
<div class="phpcode"><code><span class="html">
Functions created by create_function() cannot return a value by reference.&nbsp; The function below creates a function that can.&nbsp; The arguments are the same as create_function().&nbsp; Note that these arguments are passed, unmodified, to eval(), so be sure that data passed in is sanitized.<br><br><span class="default">&lt;?php<br></span><span class="comment">/** <br> * create_ref_function<br> * Create an anonymous (lambda-style) function<br> * which returns a reference<br> * see <a rel="nofollow" target="_blank">http://php.net/create_function</a><br> */<br></span><span class="keyword">function<br></span><span class="default">create_ref_function</span><span class="keyword">( </span><span class="default">$args</span><span class="keyword">, </span><span class="default">$code </span><span class="keyword">)<br>{<br>&nbsp; &nbsp; static </span><span class="default">$n </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br><br>&nbsp; &nbsp; </span><span class="default">$functionName </span><span class="keyword">= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'ref_lambda_%d'</span><span class="keyword">,++</span><span class="default">$n</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="default">$declaration </span><span class="keyword">= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'function &amp;%s(%s) {%s}'</span><span class="keyword">,</span><span class="default">$functionName</span><span class="keyword">,</span><span class="default">$args</span><span class="keyword">,</span><span class="default">$body</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; eval(</span><span class="default">$declaration</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; return </span><span class="default">$functionName</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="60260">  
  <a class="name">
  <strong class="user"><em>boards at gmail dot com</em></strong></a><div class="date" title="2005-12-31 11:18"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom60260">
<div class="phpcode"><code><span class="html">
If you were checking to see if a function is made properly, this would be a better way of checking:<br><br><span class="default">&lt;?php<br>$fnc </span><span class="keyword">= @</span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$arg1,$arg2,$arg3'</span><span class="keyword">, </span><span class="string">'return true;'</span><span class="keyword">);<br></span><span class="comment"># make that function whatever you want<br></span><span class="keyword">if (empty(</span><span class="default">$fnc</span><span class="keyword">)) {<br>&nbsp; die(</span><span class="string">'Could not create function $fnc.'</span><span class="keyword">);<br>}<br><br></span><span class="comment"># although, the follow will NOT work<br></span><span class="keyword">if (empty(</span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$arg'</span><span class="keyword">, </span><span class="string">'return $arg;'</span><span class="keyword">))) {<br>&nbsp; die(</span><span class="string">'Could not create anonymous function.'</span><span class="keyword">);<br>}<br></span><span class="comment"># you would get an error regarding not being able to use a<br># return value in writeable context (i.e. a return value is <br># a const in C, and the function empty() doesn't use a<br># const void* parameter<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="51864">  
  <a class="name">
  <strong class="user"><em>david [at] davelee.com.au</em></strong></a><div class="date" title="2005-04-13 02:15"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom51864">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php
<br></span><span class="comment"># dynamically create html helper functions which take the args
<br># $string_contents, $optional_hash_of_options
<br># and return the contents wrapped in a tag
<br>&nbsp; &nbsp; 
<br></span><span class="default">$html_funcs </span><span class="keyword">= Array(
<br>&nbsp; &nbsp; </span><span class="string">'table'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'tr'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'th'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'td'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'div'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'span'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'pre'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'strong'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">'em'
<br></span><span class="keyword">);
<br></span><span class="default">$args </span><span class="keyword">= </span><span class="string">'$html, $options=Array()'</span><span class="keyword">;
<br></span><span class="default">$code </span><span class="keyword">= </span><span class="string">'
<br>&nbsp; $o = ""; 
<br>&nbsp; foreach ($options as $a =&gt; $b) {
<br>&nbsp; &nbsp; $o .= " $a=\"$b\"";
<br>&nbsp; }
<br>&nbsp; return "&lt;$tag$o&gt;$html&lt;/$tag&gt;";
<br>'</span><span class="keyword">;
<br>foreach (</span><span class="default">$html_funcs </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$tag</span><span class="keyword">) {
<br>&nbsp; &nbsp; ${</span><span class="default">$tag</span><span class="keyword">} = </span><span class="default">create_function</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">, </span><span class="string">"\$tag = '</span><span class="default">$tag</span><span class="string">'; </span><span class="default">$code</span><span class="string">"</span><span class="keyword">);
<br>}
<br>
<br></span><span class="comment"># usage example:
<br>
<br></span><span class="keyword">print </span><span class="default">$table</span><span class="keyword">(
<br>&nbsp; </span><span class="default">$tr</span><span class="keyword">(</span><span class="default">$th</span><span class="keyword">(</span><span class="string">'heading'</span><span class="keyword">).</span><span class="default">$td</span><span class="keyword">(</span><span class="string">'this is the cell content'</span><span class="keyword">)),
<br>&nbsp; Array(</span><span class="string">'style'</span><span class="keyword">=&gt;</span><span class="string">'border: 1px solid silver;'</span><span class="keyword">)
<br>);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="40611">  
  <a class="name">
  <strong class="user"><em>MagicalTux at FF.ST</em></strong></a><div class="date" title="2004-03-09 10:25"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom40611">
<div class="phpcode"><code><span class="html">
neo at gothic-chat d0t de wrote :<br>Beware of memory-leaks, the garbage-collection seems to 'oversee' dynamically created functions!<br><br>Not really...<br><br>In fact, PHP can not "unassign" functions. So if you create a function, it won't be deleted until the end of the script, even if you unset the variable containing its name.<br><br>If you need to change a part of a function everytime you run a loop, think of a way to make a more general function or try using eval :) (functions are made to be re-used. If you need to run your own piece of code once, eval is much better).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="39217">  
  <a class="name">
  <strong class="user"><em>neo at gothic-chat d0t de</em></strong></a><div class="date" title="2004-01-20 08:54"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom39217">
<div class="phpcode"><code><span class="html">
Beware of memory-leaks, the garbage-collection seems to 'oversee' dynamically created functions!<br><br>I used a function like this to replace special characters in links with their htmlentities:<br><span class="default">&lt;?php<br>$text </span><span class="keyword">= </span><span class="default">preg_replace_callback </span><span class="keyword">(<br>&nbsp; &nbsp; </span><span class="string">"/(&lt;(frame src|a href|form action)=\")([^\"]+)(\"[^&gt;]*&gt;)/i"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="default">create_function </span><span class="keyword">(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'$matches'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'return $matches[1] . htmlentities ($matches[3]) . $matches[4];'<br>&nbsp; &nbsp; </span><span class="keyword">),<br>&nbsp; &nbsp; </span><span class="default">$text</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>After 1000 calls, the process used about 5MB more than before. In my situation this boosted up the memory-size of one PHP-process up to over 100MB!<br><br>In such cases, better store the function in a global variable.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="34845">  
  <a class="name">
  <strong class="user"><em>nospam at fiderallalla dot de</em></strong></a><div class="date" title="2003-08-08 06:39"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom34845">
<div class="phpcode"><code><span class="html">
Sometimes it may be useful to create functions in a dynamic environment 
<br>(f. e. in a daemon-like php script).
<br>
<br>Normally declaring a function must be done once, which results in the problem, 
<br>that in this special case modifying a function wouldn't have an effect until the script is reloaded. 
<br>
<br>Maybe this code snipplet is useful 4 u.
<br>
<br>File: "functions.inc"
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">test</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {
<br>&nbsp; &nbsp; echo </span><span class="default">$str</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>Dynamic FunctionHandler:
<br>
<br><span class="default">&lt;?php
<br>$FileName </span><span class="keyword">= </span><span class="string">"functions.inc"</span><span class="keyword">;
<br></span><span class="default">$FileHandle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$FileName</span><span class="keyword">,</span><span class="string">"r"</span><span class="keyword">);
<br></span><span class="default">$FileContent </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$FileHandle</span><span class="keyword">,</span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$FileName</span><span class="keyword">));
<br></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$FileHandle</span><span class="keyword">);
<br>
<br></span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">"#function\ ?([a-zA-Z0-9-_]*)\ ?\((.*?)\)\ ?\{(.*?)\}#mixse"</span><span class="keyword">,</span><span class="default">$FileContent</span><span class="keyword">,</span><span class="default">$Matches</span><span class="keyword">);
<br>if ( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$Matches</span><span class="keyword">) &amp;&amp; isset(</span><span class="default">$Matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) &amp;&amp; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$Matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) &gt; </span><span class="default">0&nbsp; </span><span class="keyword">) {
<br>&nbsp; &nbsp;&nbsp; foreach ( </span><span class="default">$Matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val </span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="default">$Matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">create_function</span><span class="keyword">(</span><span class="default">$Matches</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">],</span><span class="default">$Matches</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">]);
<br>&nbsp; &nbsp; }
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>The Test:
<br><span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$test</span><span class="keyword">(</span><span class="string">"test"</span><span class="keyword">); </span><span class="default">?&gt;
<br></span>.. will echo "test";
<br>
<br>Hans Kuhlen</span>
</code></div>
  </div>
 </div>
  <div class="note" id="30886">  
  <a class="name">
  <strong class="user"><em>DB on music_ml at yahoo dot com dot ar</em></strong></a><div class="date" title="2003-04-02 04:58"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom30886">
<div class="phpcode"><code><span class="html">
[EDIT by danbrown AT php DOT net: Combined user-corrected post with previous (incorrect) post.]
<br>
<br>You can't refer to a class variable from an anonymous function inside a class method using $this.&nbsp; Anonymous functions don't inherit the method scope.&nbsp; You'll have to do this:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">class </span><span class="default">AnyClass </span><span class="keyword">{
<br> 
<br> var </span><span class="default">$classVar </span><span class="keyword">= </span><span class="string">'some regular expression pattern'</span><span class="keyword">;
<br>
<br> function </span><span class="default">classMethod</span><span class="keyword">() {
<br>
<br>&nbsp;&nbsp; </span><span class="default">$_anonymFunc </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">( </span><span class="string">'$arg1, $arg2'</span><span class="keyword">, </span><span class="string">'if ( eregi($arg2, $arg1) ) { return true; } else { return false; } ' </span><span class="keyword">);
<br>
<br>&nbsp;&nbsp; </span><span class="default">$willWork </span><span class="keyword">= </span><span class="default">$_anonymFunc</span><span class="keyword">(</span><span class="string">'some string'</span><span class="keyword">, </span><span class="default">$classVar</span><span class="keyword">);
<br> 
<br> }
<br>
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="14322">  
  <a class="name">
  <strong class="user"><em>ben-php at bacarisse dot btinternet dot co dot uk</em></strong></a><div class="date" title="2001-07-26 01:33"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom14322">
<div class="phpcode"><code><span class="html">
A nice technique for building complex search patterns on lists, files or whatever is to build function combining functions like this:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">_not_</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">) {
<br>&nbsp; return </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$x'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">"return !</span><span class="default">$f</span><span class="string">(\$x);"</span><span class="keyword">);
<br>}
<br>
<br>function </span><span class="default">_and_</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">$g</span><span class="keyword">) {
<br>&nbsp; return </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$x'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">"return </span><span class="default">$f</span><span class="string">(\$x) &amp;&amp; </span><span class="default">$g</span><span class="string">(\$x);"</span><span class="keyword">);
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>(similarly for _or_ and others...).&nbsp; Once you've built your matching primitives you can then build more complex matches into your script.
<br>
<br>Unfortunately, as explained in (closed) bug #10721, the function names returned by create_function have a null byte at the front and this causes a parse error.
<br>
<br>You can fix the definition like this:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">_not_</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">) {
<br>&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; return </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$x'</span><span class="keyword">,
<br>&nbsp; &nbsp; </span><span class="string">"return !call_user_func(chr(0).'</span><span class="default">$f</span><span class="string">', \$x)"</span><span class="keyword">);
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>The expression that re-builds the function name avoid the null being literally in the parsed string.&nbsp; If there is a better fix, please let me know.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="13841">  
  <a class="name">
  <strong class="user"><em>x-empt[a_t]ispep.cx</em></strong></a><div class="date" title="2001-07-05 11:41"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom13841">
<div class="phpcode"><code><span class="html">
Create_function enables the ability to change the scope of functions.&nbsp; You might have a class where it needs to define a GLOBAL function.&nbsp; This is possible, like:
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">class </span><span class="default">blah </span><span class="keyword">{
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; function </span><span class="default">blah</span><span class="keyword">() {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$z</span><span class="keyword">=</span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$arg1string'</span><span class="keyword">,</span><span class="string">'return "function-z-".$arg1string;'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'z'</span><span class="keyword">]=</span><span class="default">$z</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$blah_object</span><span class="keyword">=new </span><span class="default">blah</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result</span><span class="keyword">=</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'z'</span><span class="keyword">](</span><span class="string">'Argument 1 String'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$result</span><span class="keyword">;
<br></span><span class="default">?&gt;
<br></span>
<br>Making a function escape it's defined scope can be useful in many situations.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="12673">  
  <a class="name">
  <strong class="user"><em>maxim at maxim dot cx</em></strong></a><div class="date" title="2001-04-27 03:26"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom12673">
<div class="phpcode"><code><span class="html">
for those who want to assign it's own name to a function consider this code:
<br>
<br><span class="default">&lt;?php
<br>$fname </span><span class="keyword">= </span><span class="string">'hello'</span><span class="keyword">;
<br>
<br></span><span class="default">$func </span><span class="keyword">= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'
<br>&nbsp; &nbsp; function %s($v="") {
<br>&nbsp; &nbsp; &nbsp; &nbsp; Return "$v&lt;BR&gt;";
<br>&nbsp; &nbsp; }
<br>'</span><span class="keyword">,
<br></span><span class="default">$fname
<br></span><span class="keyword">);
<br>
<br>eval(</span><span class="default">$func</span><span class="keyword">);
<br>echo </span><span class="default">$fname</span><span class="keyword">(</span><span class="string">'Please print it.... please....'</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>what it does is, 
<br>: Creats a function as a string;
<br>: Replaces the function name with $fname value;
<br>: Converts the string into a REAL php code with eval()
<br>: Calls the function using the variable function as declared before ($fname);
<br>
<br>Simple, isn't it?
<br>
<br>Can work well as an abstraction layer for portability and/or compatibility purposes
<br>
<br>Maxim Maletsky
<br>maxim@maxim.cx // PHPBeginner.com</span>
</code></div>
  </div>
 </div>
  <div class="note" id="11434">  
  <a class="name">
  <strong class="user"><em>mrben at free dot fr</em></strong></a><div class="date" title="2001-02-20 08:33"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom11434">
<div class="phpcode"><code><span class="html">
Here is another tricky but usefull techynote, good for adding "plugin" to a existing class :
<br>
<br><span class="default">&lt;?php
<br>
<br></span><span class="keyword">class </span><span class="default">Hoge </span><span class="keyword">{
<br>&nbsp; &nbsp; var </span><span class="default">$lamda</span><span class="keyword">;
<br>&nbsp; &nbsp; var </span><span class="default">$text</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; function </span><span class="default">set</span><span class="keyword">(</span><span class="default">$lamda</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">lamda </span><span class="keyword">= </span><span class="default">$lamda</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; function </span><span class="default">callLamda</span><span class="keyword">()
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">lamda</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$func</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; function </span><span class="default">get</span><span class="keyword">()
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">text</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>}
<br>
<br></span><span class="default">$newfunc </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'&amp;$class'</span><span class="keyword">, </span><span class="string">'echo $class-&gt;get();' </span><span class="keyword">);
<br>
<br></span><span class="default">$h </span><span class="keyword">= new </span><span class="default">Hoge</span><span class="keyword">;
<br></span><span class="default">$h</span><span class="keyword">-&gt;</span><span class="default">text </span><span class="keyword">= </span><span class="string">"Hi there !"</span><span class="keyword">;
<br></span><span class="default">$h</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="default">$newfunc</span><span class="keyword">);
<br></span><span class="default">$h</span><span class="keyword">-&gt;</span><span class="default">callLamda</span><span class="keyword">();
<br>
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="10113">  
  <a class="name">
  <strong class="user"><em>koyama at hoge dot org</em></strong></a><div class="date" title="2000-12-14 04:22"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom10113">
<div class="phpcode"><code><span class="html">
How do you use function which is created by create_function() as class method?
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">class </span><span class="default">Hoge </span><span class="keyword">{
<br>&nbsp; var </span><span class="default">$lamda</span><span class="keyword">;
<br>&nbsp; function </span><span class="default">set</span><span class="keyword">(</span><span class="default">$lamda</span><span class="keyword">) {
<br>&nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">lamda </span><span class="keyword">= </span><span class="default">$lamda</span><span class="keyword">;
<br>&nbsp; }
<br>&nbsp; function </span><span class="default">callLamda</span><span class="keyword">() {
<br>&nbsp; &nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">lamda</span><span class="keyword">;
<br>&nbsp; &nbsp; return </span><span class="default">$func</span><span class="keyword">();
<br>&nbsp; }
<br>}
<br>
<br></span><span class="default">$newfunc </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="string">'echo "hoge&lt;br&gt;\n";'</span><span class="keyword">);
<br>
<br></span><span class="default">$h </span><span class="keyword">= new </span><span class="default">Hoge</span><span class="keyword">;
<br></span><span class="default">$h</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">( </span><span class="default">$newfunc </span><span class="keyword">);
<br></span><span class="default">$h</span><span class="keyword">-&gt;</span><span class="default">callLamda</span><span class="keyword">();
<br></span><span class="default">?&gt;
<br></span>
<br>It works fine. :-)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113363">  
  <a class="name">
  <strong class="user"><em>coleyeder at gmail dot com</em></strong></a><div class="date" title="2013-10-01 04:29"><strong>10 months ago</strong></div>
  <div class="text" id="Hcom113363">
<div class="phpcode"><code><span class="html">
Default values works:<br><br><span class="default">&lt;?php<br><br>$f </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$a,$b=3'</span><span class="keyword">, </span><span class="string">'var_dump($a, $b);'</span><span class="keyword">);<br></span><span class="default">$f</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br><br></span><span class="comment">// output:<br><br>// int(1)<br>// int(3)<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109197">  
  <a class="name">
  <strong class="user"><em>kak dot serpom dot po dot yaitsam at gmail dot com</em></strong></a><div class="date" title="2012-06-27 12:17"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom109197">
<div class="phpcode"><code><span class="html">
Try this to boost performance of your scripts (increase maxCacheSize):
<br>
<br><span class="default">&lt;?php
<br>runkit_function_copy</span><span class="keyword">(</span><span class="string">'create_function'</span><span class="keyword">, </span><span class="string">'create_function_native'</span><span class="keyword">);
<br></span><span class="default">runkit_function_redefine</span><span class="keyword">(</span><span class="string">'create_function'</span><span class="keyword">, </span><span class="string">'$arg,$body'</span><span class="keyword">, </span><span class="string">'return __create_function($arg,$body);'</span><span class="keyword">);
<br>
<br>function </span><span class="default">__create_function</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">, </span><span class="default">$body</span><span class="keyword">) {
<br>&nbsp; &nbsp; static </span><span class="default">$cache </span><span class="keyword">= array();
<br>&nbsp; &nbsp; static </span><span class="default">$maxCacheSize </span><span class="keyword">= </span><span class="default">64</span><span class="keyword">;
<br>&nbsp; &nbsp; static </span><span class="default">$sorter</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; if (</span><span class="default">$sorter </span><span class="keyword">=== </span><span class="default">NULL</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$sorter </span><span class="keyword">= function(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">hits </span><span class="keyword">== </span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">hits</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">0</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return (</span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">hits </span><span class="keyword">&lt; </span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">hits</span><span class="keyword">) ? </span><span class="default">1 </span><span class="keyword">: -</span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; };
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; </span><span class="default">$crc </span><span class="keyword">= </span><span class="default">crc32</span><span class="keyword">(</span><span class="default">$arg </span><span class="keyword">. </span><span class="string">"\\x00" </span><span class="keyword">. </span><span class="default">$body</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; if (isset(</span><span class="default">$cache</span><span class="keyword">[</span><span class="default">$crc</span><span class="keyword">])) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; ++</span><span class="default">$cache</span><span class="keyword">[</span><span class="default">$crc</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">];
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$cache</span><span class="keyword">[</span><span class="default">$crc</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">];
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; if (</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$cache</span><span class="keyword">) &gt;= </span><span class="default">$maxCacheSize</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">uasort</span><span class="keyword">(</span><span class="default">$cache</span><span class="keyword">, </span><span class="default">$sorter</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$cache</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; </span><span class="default">$cache</span><span class="keyword">[</span><span class="default">$crc</span><span class="keyword">] = array(</span><span class="default">$cb </span><span class="keyword">= eval(</span><span class="string">'return function('</span><span class="keyword">.</span><span class="default">$arg</span><span class="keyword">.</span><span class="string">'){'</span><span class="keyword">.</span><span class="default">$body</span><span class="keyword">.</span><span class="string">'};'</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">);
<br>&nbsp; &nbsp; return </span><span class="default">$cb</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77209">  
  <a class="name">
  <strong class="user"><em>colin dot mckinnon at gmail dot com</em></strong></a><div class="date" title="2007-08-20 05:51"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom77209">
<div class="phpcode"><code><span class="html">
In response to koyama at hoge dot org (14-Dec-2000):
<br>
<br>This does NOT create a new method - try adding this at the end:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="default">$h</span><span class="keyword">-&gt;</span><span class="default">lamda</span><span class="keyword">)) {
<br>&nbsp;&nbsp; print </span><span class="string">"Its a function\n"</span><span class="keyword">;
<br>} else {
<br>&nbsp;&nbsp; print </span><span class="string">"No it isnt"</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>It creates a function which $h-&gt;lamda points to.
<br>
<br>Under PHP4 you could simply add an argument $this which meant it *behaved* like a method (though it existed in global scope) but with PHP5, you can't have a variable named $this in a function (which is rather irksome).
<br>
<br>(and methinks the ant-bot challenge is taking the mickey - min(three, four)?&nbsp; !).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108889">  
  <a class="name">
  <strong class="user"><em>131 dot php at cloudyks dot org</em></strong></a><div class="date" title="2012-06-01 10:54"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108889">
<div class="phpcode"><code><span class="html">
For those who want to create closure with create_function, don't bother, you can't.
<br>Use create_closure instead :p
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">//same thing as create_function, but returns a closure..( 5.4)
<br></span><span class="keyword">function </span><span class="default">create_closure</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">, </span><span class="default">$body</span><span class="keyword">){
<br>&nbsp; return eval(</span><span class="string">"return function(</span><span class="default">$args</span><span class="string">){ </span><span class="keyword">{</span><span class="default">$body</span><span class="keyword">}</span><span class="string">&nbsp; };"</span><span class="keyword">);
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.create-function.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:09:08 GMT -->


</body></html>