<html><!-- Mirrored from php.net/manual/en/function.mssql-fetch-array.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:02:21 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>mssql_fetch_array</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.mssql-fetch-array.html">
 <link rel="shorturl" href="http://php.net/mssql-fetch-array">
 <link rel="alternate" href="http://php.net/mssql-fetch-array" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.mssql.html">
 <link rel="prev" href="function.mssql-execute.html">
 <link rel="next" href="function.mssql-fetch-assoc.html">

 <link rel="alternate" href="function.mssql-fetch-array.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.mssql-fetch-array.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.mssql-fetch-array.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.mssql-fetch-array.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.mssql-fetch-array.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.mssql-fetch-array.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.mssql-fetch-array.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.mssql-fetch-array.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.mssql-fetch-array.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.mssql-fetch-array.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.mssql-fetch-array.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.vendors.html">Vendor Specific Database Extensions</a></li>      <li><a href="book.mssql.html">Mssql</a></li>      <li><a href="ref.mssql.html">Mssql Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.mssql-fetch-array" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mssql_fetch_array</h1>
  <p class="verinfo">(PHP 4, PHP 5, PECL odbtp &gt;= 1.1.1)</p><p class="refpurpose"><span class="refname">mssql_fetch_array</span> — <span class="dc-title">Fetch a result row as an associative array, a numeric array, or both</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.mssql-fetch-array-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>mssql_fetch_array</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$result_type</code><span class="initializer"> = MSSQL_BOTH</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>mssql_fetch_array()</strong></span> is an extended version of
   <span class="function"><a href="function.mssql-fetch-row.html" class="function">mssql_fetch_row()</a></span>.  In addition to storing the
   data in the numeric indices of the result array, it also stores
   the data in associative indices, using the field names as keys.
  </p>
  <p class="para">
   An important thing to note is that using
   <span class="function"><strong>mssql_fetch_array()</strong></span> is NOT significantly
   slower than using <span class="function"><a href="function.mssql-fetch-row.html" class="function">mssql_fetch_row()</a></span>, while it
   provides a significant added value.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mssql-fetch-array-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">result</code></dt>

     <dd>

      <p class="para">
       The result resource that is being evaluated. This result comes from a
       call to <span class="function"><a href="function.mssql-query.html" class="function">mssql_query()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">result_type</code></dt>

     <dd>

      <p class="para">
       The type of array that is to be fetched. It's a constant and can take
       the following values: <strong><code>MSSQL_ASSOC</code></strong>, 
       <strong><code>MSSQL_NUM</code></strong>, and
       <strong><code>MSSQL_BOTH</code></strong>.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mssql-fetch-array-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns an array that corresponds to the fetched row, or <strong><code>FALSE</code></strong> if there
   are no more rows.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mssql-fetch-array-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-1607">
    <p><strong>Example #1 <span class="function"><strong>mssql_fetch_array()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;Send&nbsp;a&nbsp;select&nbsp;query&nbsp;to&nbsp;MSSQL<br></span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mssql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;[username],&nbsp;[name]&nbsp;FROM&nbsp;[php].[dbo].[userlist]'</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;Check&nbsp;if&nbsp;there&nbsp;were&nbsp;any&nbsp;records<br></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">mssql_num_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'No&nbsp;records&nbsp;found'</span><span style="color: #007700">;<br>}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;The&nbsp;following&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;code&nbsp;below:<br>&nbsp;&nbsp;&nbsp;&nbsp;//<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;while&nbsp;($row&nbsp;=&nbsp;mssql_fetch_row($query))&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">while&nbsp;(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mssql_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">MSSQL_NUM</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br>}<br><br></span><span style="color: #FF8000">//&nbsp;Free&nbsp;the&nbsp;query&nbsp;result<br></span><span style="color: #0000BB">mssql_free_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mssql-fetch-array-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">Field names returned by this function
are <em class="emphasis">case-sensitive</em>.</span></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">This function sets NULL fields to
the PHP <strong><code>NULL</code></strong> value.</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mssql-fetch-array-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mssql-fetch-row.html" class="function" rel="rdfs-seeAlso">mssql_fetch_row()</a> - Get row as enumerated array</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="22062">  
  <a class="name">
  <strong class="user"><em>ask at manniac dot de</em></strong></a><div class="date" title="2002-06-05 06:13"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom22062">
<div class="phpcode"><code><span class="html">
It seems that this function creates arrays wich keys can not be longer than 30 chars. So when you're having a DB-field like "this_is_a_very_long_db_field_name"<br>its array-key is cut off after 30 chars and you will have to access the value with<br>rs["this_is_a_very_long_db_field_n"]</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77156">  
  <a class="name">
  <strong class="user"><em>blood - demon at gmx dot net</em></strong></a><div class="date" title="2007-08-17 02:22"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom77156">
<div class="phpcode"><code><span class="html">
Note that if you fetch varchar fields larger than 255 letters the result will be cut off at 255 letters. <br><br>To prevent this you have to do a CONVERT(TEXT,data_field) for this fields in your select clause.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="39302">  
  <a class="name">
  <strong class="user"><em>hackajar matt yahoo trot com</em></strong></a><div class="date" title="2004-01-23 03:11"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom39302">
<div class="phpcode"><code><span class="html">
from php-dev mailing list article - <br>#26012 [Bgs]: mssql_fetch_array <br><br>"Previously mssql data was always rtrimed, however that's wrong because it modifies the original data. This caused a problem for people who needed those trailing space. Ultimately, the job of database extension is to fetch the data as is (like other db extensions already do) and not to mangle it in any way."<br><br>moving from &lt;4.3.4 to a higher version you will have this now:<br><br>$query = "Select dumb_spaces from dbo.table where weak_sause = 'true'";<br>$result = mssql_query($query) or die("Spicy Sause! Query = $query");<br><br>while($line = mssql_fetch_array($result, MSSQL_ASSOC) {<br>&nbsp; &nbsp;&nbsp; foreach($line as $bs_trim) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Trim whitespace from end of query<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $bs_trim = rtrim($bs_trim);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "Clean!".$bs_trim;<br>&nbsp; &nbsp;&nbsp; }<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="28514">  
  <a class="name">
  <strong class="user"><em>flatcable2000 at yahoo dot com</em></strong></a><div class="date" title="2003-01-15 09:22"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom28514">
<div class="phpcode"><code><span class="html">
Apparently php 4.0.6 does not support the second parameter. When used the error sounds<br>"Wrong parameter count for mssql_fetch_array"</span>
</code></div>
  </div>
 </div>
  <div class="note" id="28370">  
  <a class="name">
  <strong class="user"><em>shaver at qspeed dot com</em></strong></a><div class="date" title="2003-01-10 02:08"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom28370">
<div class="phpcode"><code><span class="html">
Note that the second parameter is the same as the msql version of this function (<a rel="nofollow" target="_blank">http://www.php.net/manual/en/function.msql-fetch-array.php</a>) with the constants (MSQL_ASSOC, MSQL_NUM, and MSQL_BOTH) changing to MSSQL_.
<br>
<br>Also note that if you don't specify this parameter you'll get both the numbers and column names, which can cause some frustration.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84556">  
  <a class="name">
  <strong class="user"><em>php at bricology dot com</em></strong></a><div class="date" title="2008-07-18 09:08"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84556">
<div class="phpcode"><code><span class="html">
I just spent a few hours trying to get ntext data with this function, CASTing and CONVERTing every which way, and scouring the 'net. Nothing worked, I just got a NULL.<br><br>Then on a whim I tried it with mssql_fetch_row instead, and that DOES work.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="80076">  
  <a class="name">
  <strong class="user"><em>chu61 dot tw at gmail dot com</em></strong></a><div class="date" title="2007-12-27 05:20"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80076">
<div class="phpcode"><code><span class="html">
To write Unicode (nvarchar) to SQL2000/2005 use PHP
<br>用PHP在SQL Server 存取Unicode資料
<br>----------------------------------------------
<br>
<br>Let's assume, we have following data table, that allows us to store unicode values (using UCS-2 encoding):
<br>
<br>&nbsp; &nbsp; create table mytable&nbsp; &nbsp; (
<br>&nbsp; &nbsp; &nbsp; &nbsp; myfield nvarchar (100) null
<br>&nbsp; &nbsp; );
<br>
<br>Below is the code to work with:
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; $link </span><span class="keyword">= </span><span class="default">mssql_connect</span><span class="keyword">(</span><span class="string">'dbhost'</span><span class="keyword">, </span><span class="string">'username'</span><span class="keyword">, </span><span class="string">'password'</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">mssql_select_db</span><span class="keyword">(</span><span class="string">'database'</span><span class="keyword">, </span><span class="default">$link</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; </span><span class="comment">// sending data to database
<br>&nbsp; &nbsp; </span><span class="default">$utf8 </span><span class="keyword">= </span><span class="string">'some unicode UTF-8 data'</span><span class="keyword">;&nbsp; </span><span class="comment">// some Greek text for example ;)
<br>&nbsp; &nbsp; </span><span class="default">$ucs2 </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'UCS-2LE'</span><span class="keyword">, </span><span class="default">$utf8</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; </span><span class="comment">// converting UCS-2 string into "binary" hexadecimal form
<br>&nbsp; &nbsp; </span><span class="default">$arr </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'H*hex'</span><span class="keyword">, </span><span class="default">$ucs2</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$hex </span><span class="keyword">= </span><span class="string">"0x</span><span class="keyword">{</span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'hex'</span><span class="keyword">]}</span><span class="string">"</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="comment">// IMPORTANT!
<br>&nbsp; &nbsp; // please note that value must be passed without apostrophes
<br>&nbsp; &nbsp; // it should be "... values(0x0123456789ABCEF) ...", not "... values('0x0123456789ABCEF') ..."
<br>&nbsp; &nbsp; </span><span class="default">mssql_query</span><span class="keyword">(</span><span class="string">"insert into mytable (myfield) values (</span><span class="keyword">{</span><span class="default">$hex</span><span class="keyword">}</span><span class="string">)"</span><span class="keyword">, </span><span class="default">$link</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; </span><span class="comment">// retrieving data from database
<br>&nbsp; &nbsp; // IMPORTANT!
<br>&nbsp; &nbsp; // please note that "varbinary" expects number of bytes
<br>&nbsp; &nbsp; // in this example it must be 200 (bytes), while size of field is 100 (UCS-2 chars)
<br>
<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mssql_query</span><span class="keyword">(</span><span class="string">"select convert(varbinary(200), myfield) from mytable"</span><span class="keyword">, </span><span class="default">$link</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; while ((</span><span class="default">$row </span><span class="keyword">= </span><span class="default">mssql_fetch_array</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">MSSQL_BOTH</span><span class="keyword">))) 
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// we get data in UCS-2
<br>&nbsp; &nbsp; &nbsp; &nbsp; // I use UTF-8 in my project, so I encode it back
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">echo(</span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UCS-2LE'</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="default">$row</span><span class="keyword">[</span><span class="string">'myfield'</span><span class="keyword">]));
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; </span><span class="default">mssql_free_result</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">mssql_close</span><span class="keyword">(</span><span class="default">$link</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="76217">  
  <a class="name">
  <strong class="user"><em>Bryan</em></strong></a><div class="date" title="2007-07-05 09:05"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom76217">
<div class="phpcode"><code><span class="html">
Calling this function with the option second parameter is causing a "Wrong parameter count" message. If you run into this problem, you can get the same effect by calling different functions:<br><br>mssql_fetch_array: MSSQL_BOTH<br>mssql_fetch_assoc: MSSQL_ASSOC<br>mssql_fetch_row: MSSQL_NUM</span>
</code></div>
  </div>
 </div>
  <div class="note" id="54497">  
  <a class="name">
  <strong class="user"><em>gillis dot phpmanual at no-spam-for-megillis dot fi</em></strong></a><div class="date" title="2005-07-06 01:19"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom54497">
<div class="phpcode"><code><span class="html">
Allthough probably obvious to people who have used the functions available to other databases it during writing is not present in this entry that result type can be entered as MSSQL_ASSOC or MSSQL_NUM, and the default value when nothing entered being MSSQL_BOTH<br><br>//Gillis Danielsen</span>
</code></div>
  </div>
 </div>
  <div class="note" id="46870">  
  <a class="name">
  <strong class="user"><em>archwisp at gmail dot com</em></strong></a><div class="date" title="2004-10-26 07:44"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom46870">
<div class="phpcode"><code><span class="html">
In response to my last post:<br><br>After further testing, it appears as though the null column bug only affects windows installations. On my linux installation using freetds-0.61.2, the function behaves properly. It must exist either in the php_mssql.dll or the Microsoft connection libraries. And since I use this functionality through ASP as well (which uses the Microsoft connection libraries), it would lead me to believe that it's an issue within the php_mssql.dll.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="46854">  
  <a class="name">
  <strong class="user"><em>archwisp at gmail dot com</em></strong></a><div class="date" title="2004-10-25 02:28"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom46854">
<div class="phpcode"><code><span class="html">
[Editor's Note: NULLs *are* distinguishable from 0.&nbsp; See the manual section on comparison operators. ]<br><br>microsoft sql 2000 server<br>php running on windows 2000<br><br>Using the $row = mssql_fetch_array($result)<br><br>A null value will return 0, this is a problem if you are using 0 and some identifier for a value.&nbsp; you should convert all nulls to something like -1 or "NO VALUE"<br><br>******<br><br>After extensive testing, the above statements both seem to be true. You *can* distinguish between 0 and null values in PHP; however, the mssql_fetch_array function does not set null colums to the php NULL value. <br><br>if ($row['Null_Column'] === 0) { print('pass'); }<br><br>A null column passes the above test. Seems to be a bug in the function.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="40189">  
  <a class="name">
  <strong class="user"><em>Derek Ethier</em></strong></a><div class="date" title="2004-02-24 03:06"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom40189">
<div class="phpcode"><code><span class="html">
The array_walk function is also useful for stripping the whitespace returned in an mssql_query.<br><br>function modify_field(&amp;$array) {<br>&nbsp; &nbsp; $array = trim($array);<br>}<br><br>$query = "select * from dbo.table where value = '0'";<br>$result = mssql_query($query) or die;<br><br>while ($row = mssql_fetch_array($result)) {<br>&nbsp; &nbsp; // This will call the above function.<br>&nbsp; &nbsp; array_walk($row, 'modify_field'); <br>&nbsp; &nbsp; array_push($eventresults, $row);<br>}<br><br>An added benefit is that you can expand the modify_field function to handled unexpected returned column data.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="33422">  
  <a class="name">
  <strong class="user"><em>herriedm at yahoo dot com</em></strong></a><div class="date" title="2003-06-25 09:21"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom33422">
<div class="phpcode"><code><span class="html">
[Editor's Note: NULLs *are* distinguishable from 0.&nbsp; See the manual section on comparison operators. ]
<br>
<br>microsoft sql 2000 server
<br>php running on windows 2000
<br>
<br>Using the $row = mssql_fetch_array($result)
<br>
<br>A null value will return 0, this is a problem if you are using 0 and some identifier for a value.&nbsp; you should convert all nulls to something like -1 or "NO VALUE"</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57938">  
  <a class="name">
  <strong class="user"><em>admin at talente dot ro</em></strong></a><div class="date" title="2005-10-19 08:36"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom57938">
<div class="phpcode"><code><span class="html">
There is any option like skip or go next ! I am using a while clause inside:<br>&nbsp; While ($row=mysql_fetch_array($result))<br>&nbsp; &nbsp; while ($row["Brand_name"]=$gr){<br>&nbsp; &nbsp;&nbsp; ....<br>So I am printing different TD from classes and when I finish cycling the fields I want to "skip" to next record !</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.mssql-fetch-array.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:02:21 GMT -->


</body></html>