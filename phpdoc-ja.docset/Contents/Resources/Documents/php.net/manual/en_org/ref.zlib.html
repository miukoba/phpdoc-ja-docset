<html><!-- Mirrored from php.net/manual/en/ref.zlib.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:44:57 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Zlib Functions</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="ref.zlib.html">
 <link rel="shorturl" href="http://php.net/zlib">
 <link rel="alternate" href="http://php.net/zlib" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="book.zlib.html">
 <link rel="prev" href="zlib.examples.html">
 <link rel="next" href="function.gzclose.html">

 <link rel="alternate" href="ref.zlib.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/ref.zlib.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/ref.zlib.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/ref.zlib.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/ref.zlib.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/ref.zlib.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/ref.zlib.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/ref.zlib.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/ref.zlib.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/ref.zlib.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/ref.zlib.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.compression.html">Compression and Archive Extensions</a></li>      <li><a href="book.zlib.html">Zlib</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="ref.zlib" class="reference">
 <h1 class="title">Zlib Functions</h1>

 






























































































































 






 













<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.gzclose.html">gzclose</a> — Close an open gz-file pointer</li><li><a href="function.gzcompress.html">gzcompress</a> — Compress a string</li><li><a href="function.gzdecode.html">gzdecode</a> — Decodes a gzip compressed string</li><li><a href="function.gzdeflate.html">gzdeflate</a> — Deflate a string</li><li><a href="function.gzencode.html">gzencode</a> — Create a gzip compressed string</li><li><a href="function.gzeof.html">gzeof</a> — Test for EOF on a gz-file pointer</li><li><a href="function.gzfile.html">gzfile</a> — Read entire gz-file into an array</li><li><a href="function.gzgetc.html">gzgetc</a> — Get character from gz-file pointer</li><li><a href="function.gzgets.html">gzgets</a> — Get line from file pointer</li><li><a href="function.gzgetss.html">gzgetss</a> — Get line from gz-file pointer and strip HTML tags</li><li><a href="function.gzinflate.html">gzinflate</a> — Inflate a deflated string</li><li><a href="function.gzopen.html">gzopen</a> — Open gz-file</li><li><a href="function.gzpassthru.html">gzpassthru</a> — Output all remaining data on a gz-file pointer</li><li><a href="function.gzputs.html">gzputs</a> — Alias of gzwrite</li><li><a href="function.gzread.html">gzread</a> — Binary-safe gz-file read</li><li><a href="function.gzrewind.html">gzrewind</a> — Rewind the position of a gz-file pointer</li><li><a href="function.gzseek.html">gzseek</a> — Seek on a gz-file pointer</li><li><a href="function.gztell.html">gztell</a> — Tell gz-file pointer read/write position</li><li><a href="function.gzuncompress.html">gzuncompress</a> — Uncompress a compressed string</li><li><a href="function.gzwrite.html">gzwrite</a> — Binary-safe gz-file write</li><li><a href="function.readgzfile.html">readgzfile</a> — Output a gz-file</li><li><a href="function.zlib-decode.html">zlib_decode</a> — Uncompress any raw/gzip/zlib encoded data</li><li><a href="function.zlib-encode.html">zlib_encode</a> — Compress data with the specified encoding</li><li><a href="function.zlib-get-coding-type.html">zlib_get_coding_type</a> — Returns the coding type used for output compression</li></ul>
</div>

<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="75995">  
  <a class="name">
  <strong class="user"><em>Brian</em></strong></a><div class="date" title="2007-06-25 11:58"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom75995">
<div class="phpcode"><code><span class="html">
If you have zlib.output_compression set to on when your script starts (in php.ini or via apache directive), then you disable it at runtime using ini_set() before producing output, your output will still be buffered!&nbsp; Even if you call ob_implicit_flush().<br><br>If you want unbuffered output, you must disable zlib.output_compression before your script starts (as well as mod_gzip of course, if you have both installed).<br><br>This behaviour experienced on Server: Apache/1.3.33 (Debian GNU/Linux) mod_gzip/1.3.26.1a PHP/4.3.10-18</span>
</code></div>
  </div>
 </div>
  <div class="note" id="68454">  
  <a class="name">
  <strong class="user"><em>anzenews at volja dot net</em></strong></a><div class="date" title="2006-07-27 06:59"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom68454">
<div class="phpcode"><code><span class="html">
php at seven dot net dot nz: <br>Have you been using register_shutdown_function() that outputs something? If yes, some of the output was not encoded and IE6 is less than forgiving about that. In my case it was reloading the page and sometimes showing a blank page. So IE6 does get invalid stream, bug is not bogus, only description is not good enough. <br><br>jpleveille at webgraphe dot com:<br>In PHP 4.4.2 register_shutdown_function() DOES output whatever you wish, but it is not encoded with the rest of the document. Which is even worse as you get a bug that is difficult / impossible to track down.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="67942">  
  <a class="name">
  <strong class="user"><em>php at seven dot net dot nz</em></strong></a><div class="date" title="2006-07-07 01:49"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom67942">
<div class="phpcode"><code><span class="html">
zlib.output_compression has caused problems for me in IE 6, when pages are sometimes not displayed. This could be difficult to track down and PHP have no intention of fixing it, so hopefully you find this note in a search if it happens to you.<br><br><a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=38026</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="66472">  
  <a class="name">
  <strong class="user"><em>Arne dot Heizmann at csr dot com</em></strong></a><div class="date" title="2006-05-23 10:34"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom66472">
<div class="phpcode"><code><span class="html">
PHP Version 5.1.4 here. What Bob said is correct even in this version (newest at the time of writing). You can't enable zlib.output_compression via ini_set(). You have to use php.ini.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82310">  
  <a class="name">
  <strong class="user"><em>Robin Skoglund</em></strong></a><div class="date" title="2008-04-04 04:39"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82310">
<div class="phpcode"><code><span class="html">
ini_set('zlib.output_compression', 'On') doesn't work<br><br>It says that zlib.output_compression is PHP_INI_ALL changable, but in my case at least, this is not true. When using ini_set('zlib.output_compression', 'On') runtime, phpinfo() states that zlib.output_compression is enabled, yet there is no compression.<br><br>Since I don't want to enable zlib.ouput_compression for all sites in php.ini, my solution was to enable it in apache conf (.htaccess should work as well) with the line:<br>php_flag zlib.output_compression on<br><br>Just spent hours figuring this out, so I hope it helps other people.<br><br>Btw, I'm using Apache/2.2.4 (Ubuntu) PHP/5.2.3-1ubuntu6.3.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="56216">  
  <a class="name">
  <strong class="user"><em>djmaze(AT)dragonflycms(.)org</em></strong></a><div class="date" title="2005-08-27 08:27"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom56216">
<div class="phpcode"><code><span class="html">
If you need to compress data and send it as "Content-disposition: attachment" and on-the-fly to the client due to the size for example (40Mb) here's a dirty trick using ob_gzhandler()<br><br>Keep in mind that $str is the content to output.<br><br>When you start the output call<br><br><span class="default">&lt;?php<br></span><span class="keyword">echo </span><span class="default">ob_gzhandler</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">PHP_OUTPUT_HANDLER_START</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Then to output any further content<br><br><span class="default">&lt;?php<br></span><span class="keyword">echo </span><span class="default">ob_gzhandler</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">PHP_OUTPUT_HANDLER_CONT</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>And to close the output<br><br><span class="default">&lt;?php<br></span><span class="keyword">echo </span><span class="default">ob_gzhandler</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="default">PHP_OUTPUT_HANDLER_END</span><span class="keyword">);<br>exit;<br></span><span class="default">?&gt;<br></span><br>Only tested on Apache 1.3.33 with PHP 5.0.4</span>
</code></div>
  </div>
 </div>
  <div class="note" id="56917">  
  <a class="name">
  <strong class="user"><em>Bob</em></strong></a><div class="date" title="2005-09-19 06:45"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom56917">
<div class="phpcode"><code><span class="html">
Contrary to what the documentation says, I've been unable to get zlib.output_compression to work via ini_set() (Even though I put it at the very beginning of the file before any output was sent) as of php 4.3.11.&nbsp; While it does get set to true, it will not actually do anything. Which means if you don't set this via php.ini or Apache configuration it's a no-go. I have to use ob_start("ob_gzhandler"); instead.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="54412">  
  <a class="name">
  <strong class="user"><em>ghassler at speakeasy dot net</em></strong></a><div class="date" title="2005-07-03 09:45"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom54412">
<div class="phpcode"><code><span class="html">
I tested all the compression levels against a 22k page and here are the results I got (in bytes):<br><br>off = 22549<br>1 = 4297<br>2 = 4279<br>3 = 4264<br>4 = 4117<br>5 = 4097<br>6 = 4063<br>7 = 4011<br>8 = 3998<br>9 = 3996<br><br>Looks like the best bets for zlib.output_compression_level is 1 or 5.&nbsp; The default of 6 is probably OK too.&nbsp; Don't know what the CPU usage difference is between them all though.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="53722">  
  <a class="name">
  <strong class="user"><em>jpleveille at webgraphe dot com</em></strong></a><div class="date" title="2005-06-10 06:08"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom53722">
<div class="phpcode"><code><span class="html">
register_shutdown_function() (<a rel="nofollow" target="_blank">http://www.php.net/register_shutdown_function</a>) won't output anything if you use zlib.output_compression.<br><br>Shutdown function is called after closing all opened output buffers thus, for example, its output will not be compressed if zlib.output_compression is enabled.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="46366">  
  <a class="name">
  <strong class="user"><em>admin_at_commandline_dot_ch</em></strong></a><div class="date" title="2004-10-08 05:32"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom46366">
<div class="phpcode"><code><span class="html">
My gzip function.<br><br>This function read, compress and writhe only small chunks at one time, this way you can compress big files without memory problems...<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">gzip</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">, </span><span class="default">$level </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">, </span><span class="default">$dst </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">){<br>&nbsp; &nbsp; if(</span><span class="default">$dst </span><span class="keyword">== </span><span class="default">false</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$dst </span><span class="keyword">= </span><span class="default">$src</span><span class="keyword">.</span><span class="string">".gz"</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; if(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">)){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$filesize </span><span class="keyword">= </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$src_handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">)){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$dst_handle </span><span class="keyword">= </span><span class="default">gzopen</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">, </span><span class="string">"w</span><span class="default">$level</span><span class="string">"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while(!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$src_handle</span><span class="keyword">)){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$chunk </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$src_handle</span><span class="keyword">, </span><span class="default">2048</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">gzwrite</span><span class="keyword">(</span><span class="default">$dst_handle</span><span class="keyword">, </span><span class="default">$chunk</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$src_handle</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">gzclose</span><span class="keyword">(</span><span class="default">$dst_handle</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="string">"</span><span class="default">$dst</span><span class="string"> already exists"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="string">"</span><span class="default">$src</span><span class="string"> doesn't exist"</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="44059">  
  <a class="name">
  <strong class="user"><em>gem at rellim dot com</em></strong></a><div class="date" title="2004-07-13 08:03"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom44059">
<div class="phpcode"><code><span class="html">
Run, do not walk, run, to add this to your Apache config file:<br><br>php_flag zlib.output_compression On<br>php_value zlib.output_compression_level 5<br><br>I just tried this and achieved 10x and 15x speed inprovement on<br>some mature php pages.&nbsp; Pages I have been seating over to make 5% gains on.&nbsp; I use microtime() on critical pages to help me track page speed and that confirms the speed improvement.&nbsp; The php page takes a timestamp at the beginning and end, then logs the page duration.&nbsp; So any IP transmission effects are not included.&nbsp; There is<br>a clear subjective difference to the user.<br><br>The test system was PHP 4.3.6, Apache 2.0.49 over Linux 2.4.<br>As always YMMV.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="42540">  
  <a class="name">
  <strong class="user"><em>ec10 at gmx dot net</em></strong></a><div class="date" title="2004-05-20 11:38"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom42540">
<div class="phpcode"><code><span class="html">
/**<br> * @return bool<br> * @param string $in<br> * @param string $out<br> * @param string $param = "1"<br> * @desc compressing the file with the zlib-extension<br>*/<br>function gzip ($in, $out, $param="1")<br>{<br>&nbsp; &nbsp; if (!file_exists ($in) || !is_readable ($in))<br>&nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; if ((!file_exists ($out) &amp;&amp; !is_writable (dirname ($out)) || (file_exists($out) &amp;&amp; !is_writable($out)) ))<br>&nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; $in_file = fopen ($in, "rb");<br>&nbsp; &nbsp; if (!$out_file = gzopen ($out, "wb".$param)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; while (!feof ($in_file)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $buffer = fgets ($in_file, 4096);<br>&nbsp; &nbsp; &nbsp; &nbsp; gzwrite ($out_file, $buffer, 4096);<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; fclose ($in_file);<br>&nbsp; &nbsp; gzclose ($out_file);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; return true;<br>}<br><br>/**<br> * @return bool<br> * @param string $in<br> * @param string $out<br> * @desc uncompressing the file with the zlib-extension<br>*/<br>function gunzip ($in, $out)<br>{<br>&nbsp; &nbsp; if (!file_exists ($in) || !is_readable ($in))<br>&nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; if ((!file_exists ($out) &amp;&amp; !is_writable (dirname ($out)) || (file_exists($out) &amp;&amp; !is_writable($out)) ))<br>&nbsp; &nbsp; &nbsp; &nbsp; return false;<br><br>&nbsp; &nbsp; $in_file = gzopen ($in, "rb");<br>&nbsp; &nbsp; $out_file = fopen ($out, "wb");<br><br>&nbsp; &nbsp; while (!gzeof ($in_file)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $buffer = gzread ($in_file, 4096);<br>&nbsp; &nbsp; &nbsp; &nbsp; fwrite ($out_file, $buffer, 4096);<br>&nbsp; &nbsp; }<br> <br>&nbsp; &nbsp; gzclose ($in_file);<br>&nbsp; &nbsp; fclose ($out_file);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; return true;<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="37482">  
  <a class="name">
  <strong class="user"><em>thivierr at telus dot net</em></strong></a><div class="date" title="2003-11-17 04:02"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom37482">
<div class="phpcode"><code><span class="html">
I found the absolute easiest way to read a gzip file is as follows:<br><br>echo file_get_contents("compress.zlib:///myphp/test.txt.gz");<br><br>To create a gzip file:<br>file_put_contents("compress.zlib:///myphp/test.txt.gz","Put this in the file\r\n");<br><br>Things to note about this:<br>-The best prefix to use is "compress.zlib", not "zlib"<br>-If you wish to specify a path starting in the root path, you actually end up with three slashes.&nbsp; The above path corresponds to "/myphp/test.txt" on unix, and "c:\myphp\test.txt" on Windows (if C: is the current drive).&nbsp; I tested it just on Windows.<br>-Compression and decompression both use the same prefix of "compress.zlib://" (plus one more slash to get a root dir).<br>-I'm using 5.0, so I'm not 100% sure which behaviour started in which version.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="32441">  
  <a class="name">
  <strong class="user"><em>chris at mad-teaparty dot com</em></strong></a><div class="date" title="2003-05-27 05:10"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom32441">
<div class="phpcode"><code><span class="html">
Nice function. I did it the other way round:<br><br>function uncompress($srcName, $dstName) {<br>&nbsp;&nbsp; $zp = gzopen($srcName, "r");<br>&nbsp;&nbsp; while(!gzeof($zp))<br>&nbsp; &nbsp; &nbsp; &nbsp; $string .= gzread($zp, 4096);<br>&nbsp;&nbsp; gzclose($zp);<br><br>&nbsp;&nbsp; $fp = fopen($dstName, "w");<br>&nbsp;&nbsp; fwrite($fp, $string, strlen($string));<br>&nbsp;&nbsp; fclose($fp);<br>}<br><br>uncompress("./myfile.txt.gz", "./myfile.txt");<br><br>A shorter approach would be:<br><br>function uncompress($srcName, $dstName) {<br>&nbsp; $string = implode("", gzfile($srcName));<br>&nbsp; $fp = fopen($dstName, "w");<br>&nbsp; fwrite($fp, $string, strlen($string));<br>&nbsp; fclose($fp);<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="43181">  
  <a class="name">
  <strong class="user"><em>zigazou at free dot fr</em></strong></a><div class="date" title="2004-06-12 03:44"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom43181">
<div class="phpcode"><code><span class="html">
If you use "zlib.output_compression = On" in your php.ini file, and activates output buffering (ob_start), don't output this header :<br>header('Content-Length: '.ob_get_length());<br><br>This is because ob_get_length() will return the uncompressed size while zlib will compress the output. Thus your browser will get confused waiting for extra data that will never come.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="42946">  
  <a class="name">
  <strong class="user"><em>xorinox at tiscali dot ch</em></strong></a><div class="date" title="2004-06-04 07:52"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom42946">
<div class="phpcode"><code><span class="html">
Have a look to this extended version :)<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">compress</span><span class="keyword">( </span><span class="default">$srcFileName</span><span class="keyword">, </span><span class="default">$dstFileName </span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="comment">// getting file content<br>&nbsp; &nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">( </span><span class="default">$srcFileName</span><span class="keyword">, </span><span class="string">"r" </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">fread </span><span class="keyword">( </span><span class="default">$fp</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">( </span><span class="default">$srcFileName </span><span class="keyword">) );<br>&nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">( </span><span class="default">$fp </span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// writing compressed file<br>&nbsp; &nbsp; </span><span class="default">$zp </span><span class="keyword">= </span><span class="default">gzopen</span><span class="keyword">( </span><span class="default">$dstFileName</span><span class="keyword">, </span><span class="string">"w9" </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">gzwrite</span><span class="keyword">( </span><span class="default">$zp</span><span class="keyword">, </span><span class="default">$data </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">gzclose</span><span class="keyword">( </span><span class="default">$zp </span><span class="keyword">);<br>}<br><br>function </span><span class="default">uncompress</span><span class="keyword">( </span><span class="default">$srcFileName</span><span class="keyword">, </span><span class="default">$dstFileName</span><span class="keyword">, </span><span class="default">$fileSize </span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="comment">// getting content of the compressed file<br>&nbsp; &nbsp; </span><span class="default">$zp </span><span class="keyword">= </span><span class="default">gzopen</span><span class="keyword">( </span><span class="default">$srcFileName</span><span class="keyword">, </span><span class="string">"r" </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">fread </span><span class="keyword">( </span><span class="default">$zp</span><span class="keyword">, </span><span class="default">$fileSize </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">gzclose</span><span class="keyword">( </span><span class="default">$zp </span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// writing uncompressed file<br>&nbsp; &nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">( </span><span class="default">$dstFileName</span><span class="keyword">, </span><span class="string">"w" </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">fwrite</span><span class="keyword">( </span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$data </span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">( </span><span class="default">$fp </span><span class="keyword">);<br>}<br><br></span><span class="default">compress</span><span class="keyword">( </span><span class="string">"tmp/supportkonzept.rtf"</span><span class="keyword">, </span><span class="string">"tmp/_supportkonzept.rtf.gz" </span><span class="keyword">);<br></span><span class="default">uncompress</span><span class="keyword">( </span><span class="string">"tmp/_supportkonzept.rtf.gz"</span><span class="keyword">, </span><span class="string">"tmp/_supportkonzept.rtf"</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">( </span><span class="string">"tmp/supportkonzept.rtf" </span><span class="keyword">) );<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="42374">  
  <a class="name">
  <strong class="user"><em>spam at wildpeaks dot com</em></strong></a><div class="date" title="2004-05-13 07:04"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom42374">
<div class="phpcode"><code><span class="html">
For decompressing, i modified a function posted earlier (that way $string doesn't have a big size that may be beyond the memory limit if the gzipped file is big) :<br><br>function file_ungzip($fromFile, $toFile) {<br>&nbsp; &nbsp; $zp = @gzopen($fromFile, "r");<br>&nbsp; &nbsp; $fp = @fopen($toFile, "w");<br>&nbsp; &nbsp; while(!@gzeof($zp)) {$string = @gzread($zp, 4096); @fwrite($fp, $string, strlen($string));}<br>&nbsp; &nbsp; @gzclose($zp);<br>&nbsp; &nbsp; @fclose($fp);<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="29412">  
  <a class="name">
  <strong class="user"><em>mlevy at rgj dot com</em></strong></a><div class="date" title="2003-02-12 02:06"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom29412">
<div class="phpcode"><code><span class="html">
If you turn zlib.output_compression_level on, be advised that you shouldn't try to flush() the output in your scripts. PHP will add the gzip header but send the output uncompressed, which plays havoc with Mozilla. IE seems to handle it, though.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="12522">  
  <a class="name">
  <strong class="user"><em>monte at ispi dot net</em></strong></a><div class="date" title="2001-04-18 06:02"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom12522">
<div class="phpcode"><code><span class="html">
An alternate way to handle gzip compression is to let the mod_gzip module of apache handle it. This seems to contradict the tutorial on phpbuilder.com saying that it won't compress php (or any dynamic) output, but mod_gzip as of version 1.3.17.1a works well for me.
<br>
<br>Here is an example of an httpd.conf setup:
<br>
<br>&lt;IfModule mod_gzip.c&gt;
<br>mod_gzip_on&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Yes
<br>mod_gzip_dechunk&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Yes
<br>mod_gzip_minimum_file_size&nbsp; 300
<br>mod_gzip_maximum_file_size&nbsp; 0
<br>mod_gzip_maximum_inmem_size 100000
<br>mod_gzip_keep_workfiles&nbsp; &nbsp;&nbsp; No
<br>mod_gzip_temp_dir&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; /tmp
<br>mod_gzip_item_include&nbsp; &nbsp; &nbsp;&nbsp; file \.html$
<br>mod_gzip_item_include&nbsp; &nbsp; &nbsp;&nbsp; file \.jsp$
<br>mod_gzip_item_include&nbsp; &nbsp; &nbsp;&nbsp; file \.php$
<br>mod_gzip_item_include&nbsp; &nbsp; &nbsp;&nbsp; file \.pl$
<br>mod_gzip_item_include&nbsp; &nbsp; &nbsp;&nbsp; mime ^text/.*
<br>mod_gzip_item_include&nbsp; &nbsp; &nbsp;&nbsp; mime ^application/x-httpd-php
<br>mod_gzip_item_include&nbsp; &nbsp; &nbsp;&nbsp; mime ^httpd/unix-directory$
<br>mod_gzip_item_include&nbsp; &nbsp; &nbsp;&nbsp; handler ^perl-script$
<br>mod_gzip_item_include&nbsp; &nbsp; &nbsp;&nbsp; handler ^server-status$
<br>mod_gzip_item_include&nbsp; &nbsp; &nbsp;&nbsp; handler ^server-info$
<br>mod_gzip_item_exclude&nbsp; &nbsp; &nbsp;&nbsp; mime ^image/.*
<br>&lt;/IfModule&gt;
<br>
<br>This will automatically compress all output of your files with the .php extention or the x-httpd-php mime type. Be sure to have dechunk set to Yes.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/ref.zlib.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:44:57 GMT -->


</body></html>