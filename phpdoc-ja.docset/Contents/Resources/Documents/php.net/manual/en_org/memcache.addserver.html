<html><!-- Mirrored from php.net/manual/en/memcache.addserver.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:44:59 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Memcache::addServer</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="memcache.addserver.html">
 <link rel="shorturl" href="memcache.addserver.html">
 <link rel="alternate" href="memcache.addserver.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="class.memcache.html">
 <link rel="prev" href="memcache.add.html">
 <link rel="next" href="memcache.close.html">

 <link rel="alternate" href="memcache.addserver.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/memcache.addserver.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/memcache.addserver.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/memcache.addserver.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/memcache.addserver.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/memcache.addserver.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/memcache.addserver.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/memcache.addserver.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/memcache.addserver.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/memcache.addserver.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/memcache.addserver.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.remote.other.html">Other Services</a></li>      <li><a href="book.memcache.html">Memcache</a></li>      <li><a href="class.memcache.html">Memcache</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="memcache.addserver" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Memcache::addServer</h1>
  <p class="verinfo">(PECL memcache &gt;= 2.0.0)</p><p class="refpurpose"><span class="refname">Memcache::addServer</span> â€” <span class="dc-title">Add a memcached server to connection pool</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-memcache.addserver-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>Memcache::addServer</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$host</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$port</code><span class="initializer"> = 11211</span></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$persistent</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$weight</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$timeout</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$retry_interval</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$status</code></span>
   [, <span class="methodparam"><span class="type"><a href="language.types.callable.html" class="type callable">callable</a></span> <code class="parameter">$failure_callback</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$timeoutms</code></span>
  ]]]]]]]] )</div>

  
  <p class="para rdfs-comment">
   <span class="function"><strong>Memcache::addServer()</strong></span> adds a server to the connection pool. 
   You can also use the <span class="function"><strong>memcache_add_server()</strong></span> function.
  </p>
  
  <p class="para">
   When using this method (as opposed to <span class="function"><a href="memcache.connect.html" class="function">Memcache::connect()</a></span> and 
   <span class="function"><a href="memcache.pconnect.html" class="function">Memcache::pconnect()</a></span>) the network connection is not established 
   until actually needed. Thus there is no overhead in adding a large number of servers 
   to the pool, even though they might not all be used.
  </p>
  
  <p class="para">
   Failover may occur at any stage in any of the methods, as long as other 
   servers are available the request the user won't notice. Any kind of 
   socket or Memcached server level errors (except out-of-memory) may trigger 
   the failover. Normal client errors such as adding an existing key will not 
   trigger a failover.
  </p>

  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    This function has been added to Memcache version 2.0.0.
   </p>
  <p></p></blockquote>

 </div>


 <div class="refsect1 parameters" id="refsect1-memcache.addserver-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">host</code></dt>

     <dd>

      <p class="para">
       Point to the host where memcached is listening for connections. This parameter
       may also specify other transports like <em>unix:///path/to/memcached.sock</em>
       to use UNIX domain sockets, in this case <code class="parameter">port</code> must also
       be set to <em>0</em>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">port</code></dt>

     <dd>

      <p class="para">
       Point to the port where memcached is listening for connections.
       Set this
       parameter to <em>0</em> when using UNIX domain sockets.
      </p>
      <p class="para">
       Please note: <code class="parameter">port</code> defaults to
       <a href="memcache.ini.html#ini.memcache.default-port" class="link">memcache.default_port</a>
       if not specified. For this reason it is wise to specify the port
       explicitly in this method call.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">persistent</code></dt>

     <dd>

      <p class="para">
       Controls the use of a persistent connection. Default to <strong><code>TRUE</code></strong>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">weight</code></dt>

     <dd>

      <p class="para">
       Number of buckets to create for this server which in turn control its
       probability of it being selected. The probability is relative to the
       total weight of all servers.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">timeout</code></dt>

     <dd>

      <p class="para">
       Value in seconds which will be used for connecting to the daemon. Think
       twice before changing the default value of 1 second - you can lose all
       the advantages of caching if your connection is too slow.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">retry_interval</code></dt>

     <dd>

      <p class="para">
       Controls how often a failed server will be retried, the default value
       is 15 seconds. Setting this parameter to -1 disables automatic retry. 
       Neither this nor the <code class="parameter">persistent</code> parameter has any 
       effect when the extension is loaded dynamically via <span class="function"><a href="function.dl.html" class="function">dl()</a></span>.
      </p>
      <p class="para">
       Each failed connection struct has its own timeout and before it has expired 
       the struct will be skipped when selecting backends to serve a request. Once 
       expired the connection will be successfully reconnected or marked as failed 
       for another <code class="parameter">retry_interval</code> seconds. The typical 
       effect is that each web server child will retry the connection about every
       <code class="parameter">retry_interval</code> seconds when serving a page.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">status</code></dt>

     <dd>

      <p class="para">
       Controls if the server should be flagged as online. Setting this parameter
       to <strong><code>FALSE</code></strong> and <code class="parameter">retry_interval</code> to -1 allows a failed 
       server to be kept in the pool so as not to affect the key distribution 
       algorithm. Requests for this server will then failover or fail immediately 
       depending on the <code class="parameter">memcache.allow_failover</code> setting.
       Default to <strong><code>TRUE</code></strong>, meaning the server should be considered online.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">failure_callback</code></dt>

     <dd>

      <p class="para">
       Allows the user to specify a callback function to run upon encountering an 
       error. The callback is run before failover is attempted. The function takes 
       two parameters, the hostname and port of the failed server.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">timeoutms</code></dt>

     <dd>

      <p class="para">
       
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-memcache.addserver-notes">
  <h3 class="title">Notes</h3>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">
    When the <code class="parameter">port</code> is unspecified, this method defaults to the
    value set of the PHP ini directive
    <a href="memcache.ini.html#ini.memcache.default-port" class="link">memcache.default_port</a>
    If this value was changed elsewhere in your application it might lead to
    unexpected results: for this reason it is wise to always specify the port
    explicitly in this method call.
   </p>
  </div>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-memcache.addserver-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <strong><code>TRUE</code></strong> on success or <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>


<div class="refsect1 examples" id="refsect1-memcache.addserver-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-4522">
    <p><strong>Example #1 <span class="function"><strong>Memcache::addServer()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br></span><span style="color: #FF8000">/*&nbsp;OO&nbsp;API&nbsp;*/<br><br></span><span style="color: #0000BB">$memcache&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Memcache</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$memcache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addServer</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$memcache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addServer</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host2'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&nbsp;procedural&nbsp;API&nbsp;*/<br><br></span><span style="color: #0000BB">$memcache_obj&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">memcache_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br></span><span style="color: #0000BB">memcache_add_server</span><span style="color: #007700">(</span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'memcache_host2'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 seealso" id="refsect1-memcache.addserver-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="memcache.connect.html" class="function" rel="rdfs-seeAlso">Memcache::connect()</a> - Open memcached server connection</span></li>
    <li class="member"><span class="function"><a href="memcache.pconnect.html" class="function" rel="rdfs-seeAlso">Memcache::pconnect()</a> - Open memcached server persistent connection</span></li>
    <li class="member"><span class="function"><a href="memcache.close.html" class="function" rel="rdfs-seeAlso">Memcache::close()</a> - Close memcached server connection</span></li>
    <li class="member"><span class="function"><a href="memcache.setserverparams.html" class="function" rel="rdfs-seeAlso">Memcache::setServerParams()</a> - Changes server parameters and status at runtime</span></li>
    <li class="member"><span class="function"><a href="memcache.getserverstatus.html" class="function" rel="rdfs-seeAlso">Memcache::getServerStatus()</a> - Returns server status</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="105728">  
  <a class="name">
  <strong class="user"><em>enno dot rehling at gmail dot com</em></strong></a><div class="date" title="2011-09-09 04:11"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom105728">
<div class="phpcode"><code><span class="html">
The $timeoutms argument can be used to specify the timeout in milliseconds, but isn't available in all versions. For example, it exists in php_memcache 2.2.6, but not in 3.0.4. In 2.2.6, if you specify it, then it overrides $timeout.<br><br>Caveat emptor: If $timeoutms is not specified, it defaults to the value of memcache.default_timeout_ms in php.ini, which defaults to 1000 if not set. This also overrides $timeout, which has the curious effect that $timeout is always ignored in php_memcache 2.2.6 (either in favor of $timeoutms, memcache.default_timeout_ms or the value 1000, in that order of priority).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104484">  
  <a class="name">
  <strong class="user"><em>rstaveley at seseit dot com</em></strong></a><div class="date" title="2011-06-17 04:06"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom104484">
<div class="phpcode"><code><span class="html">
The Memcache client library is responsible for picking the right server to set/get data. That's why addServer is what you want to use rather than connect, when you have more than one Memcache server. A subsequent set/get will then connect on demand to the appropriate instance as needs be. Disconnection to whatever servers were connected to happening when you close or your script terminates.<br><br>Memcache instances added to your Memcache object via addServer should be added in the same order in your application to ensure that the same server is picked for use with the same key. <br><br>A client library may be implemented to run a CRC on the key and do a modulus over the number of instances in the list to select an instance from the list for the set/get. This ensures that data is spread nicely across the nodes. <br><br>That all works nicely behind the scenes for you in your PHP code, as long as you add your list of Memcache instances in a consistent manner with addServer.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96084">  
  <a class="name">
  <strong class="user"><em>iwind dot liu at gmail dot com</em></strong></a><div class="date" title="2010-02-08 12:14"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96084">
<div class="phpcode"><code><span class="html">
The weight of the server must be greater than 0.
<br>
<br>If there is no memcached server to use, and you try to set/add variables, the apache will be crashed, with the error message "[notice] child pid 18725 exit signal Segmentation fault (11)" in error_log file.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113527">  
  <a class="name">
  <strong class="user"><em>joewynn dot nz+phpnet at gmail dot com</em></strong></a><div class="date" title="2013-10-25 10:12"><strong>10 months ago</strong></div>
  <div class="text" id="Hcom113527">
<div class="phpcode"><code><span class="html">
Note that this method will always return TRUE because a connection is not actually made at call time. See this bug report for more information: https://bugs.php.net/bug.php?id=58193</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103801">  
  <a class="name">
  <strong class="user"><em>eu at serbannistor dot ro</em></strong></a><div class="date" title="2011-05-04 06:30"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103801">
<div class="phpcode"><code><span class="html">
Actually if you have two memcached servers from which one of them is on localhost, and the other is on a remote machine you can communicate with both even if you specify the loopback address for the local one.<br><br><span class="default">&lt;?php<br>$memcache_obj </span><span class="keyword">= </span><span class="default">memcache_connect</span><span class="keyword">(</span><span class="string">"127.0.0.1"</span><span class="keyword">, </span><span class="default">11211</span><span class="keyword">);<br></span><span class="default">memcache_add_server</span><span class="keyword">(</span><span class="default">$memcache_obj</span><span class="keyword">, </span><span class="string">"memcache_remote_host"</span><span class="keyword">);<br></span><span class="default">$memcache_obj</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="string">'var_key'</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">());<br></span><span class="default">?&gt;<br></span><br>This WILL communicate with both hosts but however there are two aspects that must be taken into account:<br>1. the communication will be done through different network interfaces with the two hosts. It will use the loopback interface for the "127.0.0.1" host (lo in my case on Linux) and the external interface for the "memcache_remote_host" (eth0 in my case). Only if you want to use the same network interface to communicate with both hosts you must use the external IPs of both machines (and all communication will go out through the eth0 interface).<br>2. the connection with the two hosts will be established differently because of how memcache_connect() and memcache_add_server() work. Therefore the memcache_connect() will initiate the connection to localhost through the loopback interface when it is called, while memcache_add_server() will just add the second server to the pool, but it will not send any package through the network until it's absolutely needed (for example when a memcache_set() command is issued).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82984">  
  <a class="name">
  <strong class="user"><em>Jean-Baptiste Quenot</em></strong></a><div class="date" title="2008-05-05 01:08"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82984">
<div class="phpcode"><code><span class="html">
The default value for the "weight" argument is 1</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/memcache.addserver.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:45:00 GMT -->


</body></html>