<html><!-- Mirrored from php.net/manual/en/sdodasrel.examples.one-table.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:56:09 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>One-table examples</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="sdodasrel.examples.one-table.html">
 <link rel="shorturl" href="sdodasrel.examples.one-table.html">
 <link rel="alternate" href="sdodasrel.examples.one-table.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="sdodasrel.examples.html">
 <link rel="prev" href="sdodasrel.metadata.html">
 <link rel="next" href="sdodasrel.examples.two-table.html">

 <link rel="alternate" href="sdodasrel.examples.one-table.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/sdodasrel.examples.one-table.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/sdodasrel.examples.one-table.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/sdodasrel.examples.one-table.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/sdodasrel.examples.one-table.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/sdodasrel.examples.one-table.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/sdodasrel.examples.one-table.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/sdodasrel.examples.one-table.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/sdodasrel.examples.one-table.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/sdodasrel.examples.one-table.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/sdodasrel.examples.one-table.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.xml.html">XML Manipulation</a></li>      <li><a href="book.sdodasrel.html">SDO-DAS-Relational</a></li>      <li><a href="sdodasrel.examples.html">Examples</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="sdodasrel.examples.one-table" class="section">
  <h2 class="title">One-table examples</h2>
  <p class="para">
   The following set of examples all use the Relational DAS to work with 
   a data graph containing just one application data object, a single 
   company and the data just to be found the company table. These examples 
   do not exercise the power of SDO or the Relational DAS and of course 
   the same result could be achieved more economically with direct SQL 
   statements but they are intended to illustrate how to work with the 
   Relational DAS.
  </p>

  <p class="para">
   For this very simple scenario it would be possible to simplify the 
   database metadata to include just the company table - if that were done
   the second and third arguments to the constructor and the column 
   specifier used in the query example would become optional.
  </p>

  <p class="para">
   </p><div class="example" id="example-5554">
    <p><strong>Example #1 Creating a data object</strong></p>
    <div class="example-contents"><p>
     The simplest example is that of creating a single data object and 
     writing it to the database. In this example a single company object 
     is created, its name is set to 'Acme', and the Relational DAS is 
     called to write the changes to the database. The company name is 
     set here using the property name method. See the
     <a href="sdo.examples.html" class="link">Examples</a>
     section on the SDO extension for other ways of accessing the 
     properties of an object.
    </p></div>

    <div class="example-contents"><p>
     Data objects can only be created when you have a data object to 
     start with, however. It is for that reason that the first call 
     to the Relational DAS here is to obtain a root object. This is 
     in effect how to ask for an empty data graph - the special root 
     object is the true root of the tree. The company data object is 
     then created with a call to
     <span class="function"><strong>createDataObject()</strong></span>
     on the root object. This creates the company data object and inserts 
     it in the graph by inserting into a multi-valued containment property 
     on the root object called 'company'.
    </p></div>
    <div class="example-contents"><p>
     When the Relational DAS is called to apply the changes a simple 
     insert statement 'INSERT INTO company (name) VALUES ("Acme");' 
     will be constructed and executed. The auto-generated primary key 
     will be set into the data object and the change summary will be reset, 
     so that it would be possible to continue working with the same data 
     object, modify it, and apply the newer changes a second time.
    </p></div>
                      
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'SDO/DAS/Relational.php'</span><span style="color: #007700">;<br>require_once&nbsp;</span><span style="color: #DD0000">'company_metadata.inc.php'</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Construct&nbsp;the&nbsp;DAS&nbsp;with&nbsp;the&nbsp;metadata<br>***************************************************************/<br></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SDO_DAS_Relational&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$database_metadata</span><span style="color: #007700">,</span><span style="color: #DD0000">'company'</span><span style="color: #007700">,</span><span style="color: #0000BB">$SDO_containment_metadata</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Obtain&nbsp;a&nbsp;root&nbsp;object&nbsp;and&nbsp;create&nbsp;a&nbsp;company&nbsp;object&nbsp;underneath.<br>*&nbsp;Make&nbsp;a&nbsp;simple&nbsp;change&nbsp;to&nbsp;the&nbsp;data&nbsp;object.&nbsp;<br>***************************************************************/<br></span><span style="color: #0000BB">$root&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$das&nbsp;&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">createRootDataObject</span><span style="color: #007700">();<br></span><span style="color: #0000BB">$acme&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$root&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">createDataObject</span><span style="color: #007700">(</span><span style="color: #DD0000">'company'</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$acme</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"Acme"</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Get&nbsp;a&nbsp;database&nbsp;connection&nbsp;and&nbsp;write&nbsp;the&nbsp;object&nbsp;to&nbsp;the&nbsp;database<br>***************************************************************/<br></span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO_DSN</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_USER</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_PASSWORD</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">-&gt;&nbsp;</span><span style="color: #0000BB">applyChanges</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$root</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>

  <p class="para">
   </p><div class="example" id="example-5555">
    <p><strong>Example #2 Retrieving a data object</strong></p>
    <div class="example-contents"><p>
     In this example a single data object is retrieved from the database 
     - or possibly more than one if there is more than one company 
     called 'Acme'. For each company returned, the
     <var class="varname"><var class="varname">name</var></var>
     and
     <var class="varname"><var class="varname">id</var></var>
     properties are echoed.
    </p></div>
    <div class="example-contents"><p>
     In this example the third argument to
     <span class="function"><strong>executeQuery()</strong></span>,
     the column specifier is needed as there are other tables in the 
     metadata with column names of
     <var class="varname"><var class="varname">name</var></var>
     and
     <var class="varname"><var class="varname">id</var></var>.
     If there were no possible ambiguity it could be omitted.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'SDO/DAS/Relational.php'</span><span style="color: #007700">;<br>require_once&nbsp;</span><span style="color: #DD0000">'company_metadata.inc.php'</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Construct&nbsp;the&nbsp;DAS&nbsp;with&nbsp;the&nbsp;metadata<br>***************************************************************/<br></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SDO_DAS_Relational&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$database_metadata</span><span style="color: #007700">,</span><span style="color: #DD0000">'company'</span><span style="color: #007700">,</span><span style="color: #0000BB">$SDO_containment_metadata</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Get&nbsp;a&nbsp;database&nbsp;connection<br>***************************************************************/<br></span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO_DSN</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_USER</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_PASSWORD</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Issue&nbsp;a&nbsp;query&nbsp;to&nbsp;obtain&nbsp;a&nbsp;company&nbsp;object&nbsp;-&nbsp;possibly&nbsp;more&nbsp;if&nbsp;they&nbsp;exist<br>***************************************************************/<br></span><span style="color: #0000BB">$root&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$das</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">executeQuery</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'select&nbsp;name,&nbsp;id&nbsp;from&nbsp;company&nbsp;where&nbsp;name="Acme"'</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span style="color: #DD0000">'company.name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'company.id'</span><span style="color: #007700">)&nbsp;);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Echo&nbsp;name&nbsp;and&nbsp;id&nbsp;<br>***************************************************************/<br></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$root</span><span style="color: #007700">[</span><span style="color: #DD0000">'company'</span><span style="color: #007700">]&nbsp;as&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Company&nbsp;obtained&nbsp;from&nbsp;the&nbsp;database&nbsp;has&nbsp;name&nbsp;=&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;<br>&nbsp;&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"&nbsp;and&nbsp;id&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">[</span><span style="color: #DD0000">'id'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>

  <p class="para">
   </p><div class="example" id="example-5556">
    <p><strong>Example #3 Updating a data object</strong></p>
    <div class="example-contents"><p>
     This example combines the previous two, in the sense that in order 
     to be updated the object must first be retrieved. The application 
     code reverses the company name (so 'Acme' becomes 'emcA') and then the
     changes are written back to the database in the same way that they 
     were when the object was created. Because the query searches for 
     the name both ways round the program can be run repeatedly to find 
     the company and reverse its name each time.
    </p></div>
    <div class="example-contents"><p>
     In this example the same instance of the Relational DAS is reused 
     for the
     <span class="function"><strong>applyChanges()</strong></span>,
     as is the PDO database handle. This is quite alright; it also 
     alright to allow the previous instances to be garbage collected 
     and to obtain new instances. No state data regarding the graph 
     is held the Relational DAS once it has returned a data graph to 
     the application. All necessary data is either within the graph itself, 
     or can be reconstructed from the metadata.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'SDO/DAS/Relational.php'</span><span style="color: #007700">;<br>require_once&nbsp;</span><span style="color: #DD0000">'company_metadata.inc.php'</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Construct&nbsp;the&nbsp;DAS&nbsp;with&nbsp;the&nbsp;metadata<br>***************************************************************/<br></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SDO_DAS_Relational&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$database_metadata</span><span style="color: #007700">,</span><span style="color: #DD0000">'company'</span><span style="color: #007700">,</span><span style="color: #0000BB">$SDO_containment_metadata</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Get&nbsp;a&nbsp;database&nbsp;connection<br>***************************************************************/<br></span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO_DSN</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_USER</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_PASSWORD</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Issue&nbsp;a&nbsp;query&nbsp;to&nbsp;obtain&nbsp;a&nbsp;company&nbsp;object&nbsp;-&nbsp;possibly&nbsp;more&nbsp;if&nbsp;they&nbsp;exist<br>***************************************************************/<br></span><span style="color: #0000BB">$root&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$das</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">executeQuery</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,<br>&nbsp;&nbsp;</span><span style="color: #DD0000">'select&nbsp;name,&nbsp;id&nbsp;from&nbsp;company&nbsp;where&nbsp;name="Acme"&nbsp;or&nbsp;name="emcA"'</span><span style="color: #007700">,<br>&nbsp;&nbsp;array(</span><span style="color: #DD0000">'company.name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'company.id'</span><span style="color: #007700">)&nbsp;);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Alter&nbsp;the&nbsp;name&nbsp;of&nbsp;just&nbsp;the&nbsp;first&nbsp;company<br>***************************************************************/<br></span><span style="color: #0000BB">$company&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$root</span><span style="color: #007700">[</span><span style="color: #DD0000">'company'</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br>echo&nbsp;</span><span style="color: #DD0000">"obtained&nbsp;a&nbsp;company&nbsp;with&nbsp;name&nbsp;of&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strrev</span><span style="color: #007700">(</span><span style="color: #0000BB">$company</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Write&nbsp;the&nbsp;change&nbsp;back<br>***************************************************************/<br></span><span style="color: #0000BB">$das</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">applyChanges</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,</span><span style="color: #0000BB">$root</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>

  <p class="para">
   </p><div class="example" id="example-5557">
    <p><strong>Example #4 Deleting a data object</strong></p>
    <div class="example-contents"><p>
     Any companies called 'Acme' or its reverse 'emcA' are retrieved.
     They are then all deleted from the graph with unset.
    </p></div>

    <div class="example-contents"><p>
     In this example they are all deleted in one go by unsetting the 
     containing property (the property defining the containment 
     relationship). It is also possible to delete them individually.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'SDO/DAS/Relational.php'</span><span style="color: #007700">;<br>require_once&nbsp;</span><span style="color: #DD0000">'company_metadata.inc.php'</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Construct&nbsp;the&nbsp;DAS&nbsp;with&nbsp;the&nbsp;metadata<br>***************************************************************/<br></span><span style="color: #0000BB">$das&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SDO_DAS_Relational&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$database_metadata</span><span style="color: #007700">,</span><span style="color: #DD0000">'company'</span><span style="color: #007700">,</span><span style="color: #0000BB">$SDO_containment_metadata</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Get&nbsp;a&nbsp;database&nbsp;connection<br>***************************************************************/<br></span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO_DSN</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_USER</span><span style="color: #007700">,</span><span style="color: #0000BB">DATABASE_PASSWORD</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Issue&nbsp;a&nbsp;query&nbsp;to&nbsp;obtain&nbsp;a&nbsp;company&nbsp;object&nbsp;-&nbsp;possibly&nbsp;more&nbsp;if&nbsp;they&nbsp;exist<br>***************************************************************/<br></span><span style="color: #0000BB">$root&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$das</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">executeQuery</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,<br>&nbsp;&nbsp;</span><span style="color: #DD0000">'select&nbsp;name,&nbsp;id&nbsp;from&nbsp;company&nbsp;where&nbsp;name="Acme"&nbsp;or&nbsp;name="emcA"'</span><span style="color: #007700">,<br>&nbsp;&nbsp;array(</span><span style="color: #DD0000">'company.name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'company.id'</span><span style="color: #007700">)&nbsp;);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Delete&nbsp;any&nbsp;companies&nbsp;found&nbsp;from&nbsp;the&nbsp;data&nbsp;graph<br>***************************************************************/<br></span><span style="color: #007700">unset(</span><span style="color: #0000BB">$root</span><span style="color: #007700">[</span><span style="color: #DD0000">'company'</span><span style="color: #007700">]);<br><br></span><span style="color: #FF8000">/**************************************************************<br>*&nbsp;Write&nbsp;the&nbsp;change(s)&nbsp;back<br>***************************************************************/<br></span><span style="color: #0000BB">$das</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">applyChanges</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">,</span><span style="color: #0000BB">$root</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>

 </div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div>
 <div class="note">There are no user contributed notes for this page.</div></section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/sdodasrel.examples.one-table.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:56:09 GMT -->


</body></html>