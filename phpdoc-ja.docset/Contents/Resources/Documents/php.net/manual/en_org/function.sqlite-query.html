<html><!-- Mirrored from php.net/manual/en/function.sqlite-query.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 17:00:40 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>sqlite_query</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.sqlite-query.html">
 <link rel="shorturl" href="http://php.net/sqlite-query">
 <link rel="alternate" href="http://php.net/sqlite-query" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.sqlite.html">
 <link rel="prev" href="function.sqlite-prev.html">
 <link rel="next" href="function.sqlite-rewind.html">

 <link rel="alternate" href="function.sqlite-query.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.sqlite-query.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.sqlite-query.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.sqlite-query.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.sqlite-query.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.sqlite-query.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.sqlite-query.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.sqlite-query.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.sqlite-query.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.sqlite-query.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.sqlite-query.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.vendors.html">Vendor Specific Database Extensions</a></li>      <li><a href="book.sqlite.html">SQLite</a></li>      <li><a href="ref.sqlite.html">SQLite Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.sqlite-query" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">sqlite_query</h1>
  <h1 class="refname">SQLiteDatabase::query</h1>
  <p class="verinfo">(PHP 5 &lt; 5.4.0, PECL sqlite &gt;= 1.0.0)</p><p class="refpurpose"><span class="refname">sqlite_query</span> -- <span class="refname">SQLiteDatabase::query</span> â€” <span class="dc-title">Executes a query against a given database and returns a result handle</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.sqlite-query-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>sqlite_query</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$dbhandle</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$result_type</code><span class="initializer"> = SQLITE_BOTH</span></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter reference">&amp;$error_msg</code></span>
  ]] )</div>

  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>sqlite_query</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>
   , <span class="methodparam"><span class="type">resource</span> <code class="parameter">$dbhandle</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$result_type</code><span class="initializer"> = SQLITE_BOTH</span></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter reference">&amp;$error_msg</code></span>
  ]] )</div>

  <p class="para rdfs-comment">Object oriented style (method):</p>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type"><span class="type SQLiteResult">SQLiteResult</span></span> <span class="methodname"><strong>SQLiteDatabase::query</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$result_type</code><span class="initializer"> = SQLITE_BOTH</span></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter reference">&amp;$error_msg</code></span>
  ]] )</div>

  <p class="para rdfs-comment">
   Executes an SQL statement given by the <code class="parameter">query</code> against
   a given database handle.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.sqlite-query-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">dbhandle</code></dt>

     <dd>

      <p class="para">
       The SQLite Database resource; returned from
       <span class="function"><a href="function.sqlite-open.html" class="function">sqlite_open()</a></span> when used procedurally. This parameter
       is not required when using the object-oriented method.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">query</code></dt>

     <dd>

      <p class="para">
       The query to be executed.
      </p>
      <p class="para">
       Data inside the query should be <a href="function.sqlite-escape-string.html" class="link">properly escaped</a>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">result_type</code></dt>

     <dd>

      <p class="para">The optional <code class="parameter">result_type</code>
parameter accepts a constant and determines how the returned array will be
indexed. Using <strong><code>SQLITE_ASSOC</code></strong> will return only associative
indices (named fields) while <strong><code>SQLITE_NUM</code></strong> will return
only numerical indices (ordinal field numbers). <strong><code>SQLITE_BOTH</code></strong>
will return both associative and numerical indices.
<strong><code>SQLITE_BOTH</code></strong> is the default for this function.</p>
     </dd>

    
    
     <dt>
<code class="parameter">error_msg</code></dt>

     <dd>

      <p class="para">
       The specified variable will be filled if an error occurs. This is
       specially important because SQL syntax errors can't be fetched using
       the <span class="function"><a href="function.sqlite-last-error.html" class="function">sqlite_last_error()</a></span> function.
      </p>
     </dd>

    

   </dl>

  <p></p>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">Two alternative syntaxes are
supported for compatibility with other database extensions (such as MySQL).
The preferred form is the first, where the <code class="parameter">dbhandle</code>
parameter is the first parameter to the function.</span></p></blockquote>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.sqlite-query-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   This function will return a result handle or <strong><code>FALSE</code></strong> on failure.
   For queries that return rows, the result handle can then be used with
   functions such as <span class="function"><a href="function.sqlite-fetch-array.html" class="function">sqlite_fetch_array()</a></span> and
   <span class="function"><a href="function.sqlite-seek.html" class="function">sqlite_seek()</a></span>.
  </p>
  <p class="para">
   Regardless of the query type, this function will return <strong><code>FALSE</code></strong> if the
   query failed.
  </p>
  <p class="para">
   <span class="function"><strong>sqlite_query()</strong></span> returns a buffered, seekable result
   handle.  This is useful for reasonably small queries where you need to
   be able to randomly access the rows.  Buffered result handles will
   allocate memory to hold the entire result and will not return until it
   has been fetched.  If you only need sequential access to the data, it is
   recommended that you use the much higher performance
   <span class="function"><a href="function.sqlite-unbuffered-query.html" class="function">sqlite_unbuffered_query()</a></span> instead.
  </p>
 </div>


<div class="refsect1 changelog" id="refsect1-function.sqlite-query-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   </p><table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.1.0</td>
       <td>
        Added the <code class="parameter">error_msg</code> parameter
       </td>
      </tr>

     </tbody>
    
   </table>

  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.sqlite-query-notes">
  <h3 class="title">Notes</h3>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="simpara">
    SQLite <em class="emphasis">will</em> execute multiple queries separated by
    semicolons, so you can use it to execute a batch of SQL that you have
    loaded from a file or have embedded in a script. However, this works only
    when the result of the function is not used - if it is used, 
    only the first SQL statement would be executed. Function
    <span class="function"><a href="function.sqlite-exec.html" class="function">sqlite_exec()</a></span> will always execute multiple SQL 
    statements.
   </p>
   <p class="simpara">
    When executing multiple queries, the return value of this function
    will be <strong><code>FALSE</code></strong> if there was an error, but undefined otherwise (it might
    be <strong><code>TRUE</code></strong> for success or it might return a result handle).
   </p>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.sqlite-query-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.sqlite-unbuffered-query.html" class="function" rel="rdfs-seeAlso">sqlite_unbuffered_query()</a> - Execute a query that does not prefetch and buffer all data</span></li>
    <li class="member"><span class="function"><a href="function.sqlite-array-query.html" class="function" rel="rdfs-seeAlso">sqlite_array_query()</a> - Execute a query against a given database and returns an array</span></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="80874">  
  <a class="name">
  <strong class="user"><em>helmakil at gmail dot com</em></strong></a><div class="date" title="2008-02-05 01:58"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80874">
<div class="phpcode"><code><span class="html">
I suppose this could be useful for users attempting to use a sqlite database for the first time.<br><span class="default">&lt;?php<br>$database </span><span class="keyword">= new </span><span class="default">SQLiteDatabase</span><span class="keyword">(</span><span class="default">$yourfile</span><span class="keyword">, </span><span class="default">0666</span><span class="keyword">, </span><span class="default">$error</span><span class="keyword">);<br>if (!</span><span class="default">$database</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$error </span><span class="keyword">= (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$yourfile</span><span class="keyword">)) ? </span><span class="string">"Impossible to open, check permissions" </span><span class="keyword">: </span><span class="string">"Impossible to create, check permissions"</span><span class="keyword">;<br>&nbsp; &nbsp; die(</span><span class="default">$error</span><span class="keyword">);<br>}<br></span><span class="default">$query </span><span class="keyword">= </span><span class="default">$database</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"SELECT name FROM sqlite_master WHERE type='table'"</span><span class="keyword">, </span><span class="default">SQLITE_ASSOC</span><span class="keyword">, </span><span class="default">$query_error</span><span class="keyword">); </span><span class="comment">#Lists all tables<br></span><span class="keyword">if (</span><span class="default">$query_error</span><span class="keyword">)<br>&nbsp; &nbsp; die(</span><span class="string">"Error: </span><span class="default">$query_error</span><span class="string">"</span><span class="keyword">); </span><span class="comment">#This means that most probably we catch a syntax error<br></span><span class="keyword">if (!</span><span class="default">$query</span><span class="keyword">)<br>&nbsp; &nbsp; die(</span><span class="string">"Impossible to execute query."</span><span class="keyword">) </span><span class="comment">#As reported above, this means that the db owner is different from the web server's one, but we did not commit any syntax mistake.<br></span><span class="keyword">print </span><span class="default">$query</span><span class="keyword">-&gt;</span><span class="default">numRows</span><span class="keyword">();<br>while (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">$query</span><span class="keyword">-&gt;</span><span class="default">fetch</span><span class="keyword">())<br>&nbsp; &nbsp; print(</span><span class="default">$row</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">].</span><span class="string">"\n"</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>i suppose that the example above is also useful because it will list all the tables created, giving also comprehension of what appens when managing a sqlite database in OO mode.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107192">  
  <a class="name">
  <strong class="user"><em>glenn at byte-consult dot be</em></strong></a><div class="date" title="2012-01-13 05:16"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107192">
<div class="phpcode"><code><span class="html">
Not a lot of examples on using the oo style of using sqlite files.&nbsp; Maybe this helps someone trying to figure out all the names of the tables inside an sqlite file.<br><br><span class="default">&lt;?php<br><br></span><span class="comment">/* Just extend the class, add our method */<br></span><span class="keyword">class </span><span class="default">MySQLiteDatabase </span><span class="keyword">extends </span><span class="default">SQLiteDatabase </span><span class="keyword">{<br><br>&nbsp;&nbsp; </span><span class="comment">/* A neat way to see which tables are inside a valid sqlite file */<br>&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">getTables</span><span class="keyword">()&nbsp; {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$tables</span><span class="keyword">=array();<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$q </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"SELECT name FROM sqlite_master WHERE type='table' ORDER BY name"</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$q</span><span class="keyword">-&gt;</span><span class="default">fetchAll</span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$result </span><span class="keyword">as </span><span class="default">$tot_table</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tables</span><span class="keyword">[]=</span><span class="default">$tot_table</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; return(</span><span class="default">$tables</span><span class="keyword">);<br>&nbsp;&nbsp; }<br>}<br><br></span><span class="comment">/* a sqlite file */<br></span><span class="default">$database</span><span class="keyword">=</span><span class="string">"BLAHBLAH.sqlite"</span><span class="keyword">;<br><br>if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$database</span><span class="keyword">)) {<br>&nbsp;&nbsp; </span><span class="default">$db </span><span class="keyword">= new </span><span class="default">MySQLiteDatabase</span><span class="keyword">(</span><span class="default">$database</span><span class="keyword">, </span><span class="default">0666</span><span class="keyword">, </span><span class="default">$err</span><span class="keyword">);<br>&nbsp;&nbsp; if (</span><span class="default">$err</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">$err</span><span class="keyword">);<br>&nbsp;&nbsp; } else {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">getTables</span><span class="keyword">());<br>&nbsp;&nbsp; }<br>}<br><br></span><span class="comment">/* this sqlite db had 2 tables:<br>&nbsp;&nbsp; Array<br>&nbsp;&nbsp; (<br>&nbsp;&nbsp; [0] =&gt; Account<br>&nbsp;&nbsp; [1] =&gt; Device<br>&nbsp;&nbsp; )<br><br> */<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="92714">  
  <a class="name">
  <strong class="user"><em>bruce at causal dot com</em></strong></a><div class="date" title="2009-08-04 11:11"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom92714">
<div class="phpcode"><code><span class="html">
In follow up to Csaba Gabor's function (see below) that allows for multi-statement queries to be executed via sqlite_query() this alternative implementation avoids a problem with Csaba's version (which prevents multi-statement constructs like CREATE TRIGGER from being parsed correctly).<br><span class="default">&lt;?php <br></span><span class="keyword">function </span><span class="default">sqlite_query_multi </span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">, </span><span class="default">$query</span><span class="keyword">) { <br> </span><span class="comment">//<br> // sqlite_query() rewritten to support concatenated SQL statements.<br> //<br> // This method works around the sqlite_query() deficiency by splitting<br> // queries into two parts; the first part comprising all the statements<br> // except the last one (executed via sqlite_exec) and then the last<br> // statement (executed via sqlite_query).<br> //<br> // This allows the result of the last SELECT statement in a multi-statement<br> // query to be accessed regardless of the SQL statements that came before it. <br> // It also allows execution of arbitrary multi-statement programs regardless<br> // whether the result is needed, subject to the following constraint:<br> //<br> // This method requires that the last statement in a multi-statement query<br> // is a valid "stand-alone" SQL statement. If it is not (eg, the "END;" of<br> // a multi-statement construct such as CREATE TRIGGER) append an additional<br> // ";" (ie, a NULL statement). Normally this should not be needed because<br> // almost all the multi-statement constructs I can think of should have a<br> // stand-alone statement following them (ie, to makes use of the construct).<br> //<br>&nbsp; &nbsp; </span><span class="default">$pattern </span><span class="keyword">= </span><span class="string">'/^(.*;)(.*;)/s'</span><span class="keyword">;<br>&nbsp; &nbsp; if ( </span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$query</span><span class="keyword">,</span><span class="default">$match</span><span class="keyword">) ) { <br>&nbsp; &nbsp;&nbsp; </span><span class="comment">// multi-statement query<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">sqlite_exec</span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">,</span><span class="default">$match</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">sqlite_query</span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">,</span><span class="default">$match</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br>&nbsp; &nbsp; } else { <br>&nbsp; &nbsp;&nbsp; </span><span class="comment">// single-statement query<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">sqlite_query</span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">,</span><span class="default">$query</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return (@</span><span class="default">$result</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="58208">  
  <a class="name">
  <strong class="user"><em>jason at fatpipeinc dot com</em></strong></a><div class="date" title="2005-10-27 07:32"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom58208">
<div class="phpcode"><code><span class="html">
Correction:<br><br>sqlite_query will return NULL if the web server cannot write to the sqlite database file.<br><br>(please correct the previous post and delete this one)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="58108">  
  <a class="name">
  <strong class="user"><em>jason at fatpipeinc dot com</em></strong></a><div class="date" title="2005-10-24 09:35"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom58108">
<div class="phpcode"><code><span class="html">
sqlite_open will return NULL if the web server cannot write to the sqlite database file.<br><br>I saw the following message in my web server error log:<br><br>PHP Warning:&nbsp; sqlite_query(): (null) ...<br><br>It turns out that the sqlite database file was owned by a user other than the one the web server was running as.&nbsp; In my case, it was a Linux system running Apache (which was running under the context of user apache).&nbsp; The sqlite database file was owned by root.&nbsp; I changed ownership of the file to user apache and now it works!&nbsp; The sqlite_open call now returns a valid result handle.<br><br>Jason Aeschilman</span>
</code></div>
  </div>
 </div>
  <div class="note" id="46268">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2004-10-05 01:54"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom46268">
<div class="phpcode"><code><span class="html">
While reading the manual at sqlite.org, I can answer for the quotes in strings. You should put two quote to get one. <br><br>insert into atable values ( '5 O''Clock');</span>
</code></div>
  </div>
 </div>
  <div class="note" id="42027">  
  <a class="name">
  <strong class="user"><em>csaba at alum dot mit dot edu</em></strong></a><div class="date" title="2004-04-29 06:41"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom42027">
<div class="phpcode"><code><span class="html">
The function below allows you to submit multiple queries in one shot to a SQLITE database, and will return whatever you would get for the final query.<br><br>function sqlite_query_multi ($db, $query) {<br>&nbsp; &nbsp; // submit multiple queries (separated by ;) to $db<br>&nbsp; &nbsp; // and return the result from the last one<br>&nbsp; &nbsp; $multiSQL = "/('[^']*'|\"[^\"]*\"|[^;'\"])*;/";<br>&nbsp; &nbsp; preg_match_all ($multiSQL, "$query;", $aSQL);<br>&nbsp; &nbsp; for ($i=sizeof($aSQL=$aSQL[0]);$i--;)<br>&nbsp; &nbsp; if (!($trim=trim(substr($aSQL[$i],0,-1))))<br>&nbsp; &nbsp; &nbsp; &nbsp; unset ($aSQL[$i]);<br>&nbsp; &nbsp; &nbsp; &nbsp; else $aSQL[$i] = "$trim;";<br>&nbsp; &nbsp; foreach ($aSQL as $i =&gt; $sql)<br>&nbsp; &nbsp; $dbRes = sqlite_query ($db, $sql);<br>&nbsp; &nbsp; return (@$dbRes);<br>}<br><br>The section below illustrates the above function:<br><br>$db = sqlite_open(":memory:", 0666, $sqliteerror);<br>$query = &lt;&lt;&lt;EOD<br>CREATE TABLE foo (bar INTEGER PRIMARY KEY, baz TEXT);<br>INSERT INTO foo VALUES (Null, 'Hi');<br>INSERT INTO foo VALUES (Null, 'Mom');<br>SELECT * FROM foo;<br>EOD;<br>$dbRes = sqlite_query_multi ($db, $query);&nbsp; // 4 statements<br>while (sqlite_has_more($dbRes))<br>&nbsp; &nbsp; var_dump(sqlite_fetch_array($dbRes, SQLITE_ASSOC));<br><br>Csaba Gabor</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.sqlite-query.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 17:00:41 GMT -->


</body></html>