<html><!-- Mirrored from php.net/manual/en/function.crypt.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:54:54 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>crypt</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.crypt.html">
 <link rel="shorturl" href="http://php.net/crypt">
 <link rel="alternate" href="http://php.net/crypt" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.strings.html">
 <link rel="prev" href="function.crc32.html">
 <link rel="next" href="function.echo.html">

 <link rel="alternate" href="function.crypt.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.crypt.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.crypt.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.crypt.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.crypt.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.crypt.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.crypt.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.crypt.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.crypt.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.crypt.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.crypt.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.text.html">Text Processing</a></li>      <li><a href="book.strings.html">Strings</a></li>      <li><a href="ref.strings.html">String Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.crypt" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">crypt</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">crypt</span> â€” <span class="dc-title">One-way string hashing</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.crypt-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>crypt</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$str</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$salt</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>crypt()</strong></span> will return a hashed string using the
   standard Unix <abbr class="abbrev">DES</abbr>-based algorithm or
   alternative algorithms that may be available on the system.
  </p>
  <p class="para">
   The <code class="parameter">salt</code> parameter is optional. However, <span class="function"><strong>crypt()</strong></span> creates weak password without <code class="parameter">salt</code>. PHP 5.6 or later raise E_NOTICE error without it. Make sure specify strong enough salt for better security. 
  </p>
  <p class="para">
   <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span> uses strong hash, generates strong salt, applies proper rounds automatically. <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span> is simple <span class="function"><strong>crypt()</strong></span> wrapper and compatible with existing password hashes. Use of <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span> is encouraged.
  </p>
  <p class="para">
   Some operating systems support more than one type of hash.  In
   fact, sometimes the standard DES-based algorithm is replaced by an
   MD5-based algorithm.  The hash type is triggered by the salt argument.
   Prior to 5.3, PHP would determine the available algorithms at install-time
   based on the system's crypt(). If no salt is provided, PHP will
   auto-generate either a standard two character (DES) salt, or a twelve
   character (MD5), depending on the availability of MD5 crypt().  PHP sets a
   constant named <strong><code>CRYPT_SALT_LENGTH</code></strong> which indicates the
   longest valid salt allowed by the available hashes.
  </p>
  <p class="para">
   The standard DES-based <span class="function"><strong>crypt()</strong></span> returns the
   salt as the first two characters of the output. It also only uses the
   first eight characters of <code class="parameter">str</code>, so longer strings
   that start with the same eight characters will generate the same result
   (when the same salt is used).
  </p>
  <p class="simpara">
   On systems where the crypt() function supports multiple
   hash types, the following constants are set to 0 or 1
   depending on whether the given type is available:
  </p>
  <ul class="itemizedlist">
   <li class="listitem">
    <span class="simpara">
     <strong><code>CRYPT_STD_DES</code></strong> - Standard DES-based hash with a two character salt
       from the alphabet "./0-9A-Za-z". Using invalid characters in the salt will cause
       crypt() to fail.
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     <strong><code>CRYPT_EXT_DES</code></strong> - Extended DES-based hash. The "salt" is a
     9-character string consisting of an underscore followed by 4 bytes of iteration count and
     4 bytes of salt. These are encoded as printable characters, 6 bits per character, least
     significant character first. The values 0 to 63 are encoded as "./0-9A-Za-z". Using invalid
     characters in the salt will cause crypt() to fail.
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     <strong><code>CRYPT_MD5</code></strong> - MD5 hashing with a twelve character salt starting with
     $1$
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     <strong><code>CRYPT_BLOWFISH</code></strong> - Blowfish hashing with a salt as
     follows: "$2a$", "$2x$" or "$2y$", a two digit cost parameter, "$", and
     22 characters from the alphabet "./0-9A-Za-z". Using characters outside of
     this range in the salt will cause crypt() to return a zero-length string.
     The two digit cost parameter is the base-2 logarithm of the iteration
     count for the underlying Blowfish-based hashing algorithmeter and must be
     in range 04-31, values outside this range will cause crypt() to fail.
     Versions of PHP before 5.3.7 only support "$2a$" as the salt prefix: PHP
     5.3.7 introduced the new prefixes to fix a security weakness in the
     Blowfish implementation.  Please refer to
     <a href="http://www.php.net/security/crypt_blowfish.php" class="link external">Â»&nbsp;this document</a> for full
     details of the security fix, but to summarise, developers targeting only
     PHP 5.3.7 and later should use "$2y$" in preference to "$2a$".
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     <strong><code>CRYPT_SHA256</code></strong> - SHA-256 hash with a sixteen character salt
     prefixed with $5$. If the salt string starts with 'rounds=&lt;N&gt;$', the numeric value of N
     is used to indicate how many times the hashing loop should be executed, much like the cost
     parameter on Blowfish. The default number of rounds is 5000, there is a minimum of
     1000 and a maximum of 999,999,999. Any selection of N outside this range will be truncated to
     the nearest limit.
    </span>
   </li>
   <li class="listitem">
    <span class="simpara">
     <strong><code>CRYPT_SHA512</code></strong> - SHA-512 hash with a sixteen character salt
     prefixed with $6$. If the salt string starts with 'rounds=&lt;N&gt;$', the numeric value of N
     is used to indicate how many times the hashing loop should be executed, much like the cost
     parameter on Blowfish. The default number of rounds is 5000, there is a minimum of
     1000 and a maximum of 999,999,999. Any selection of N outside this range will be truncated to
     the nearest limit.
    </span>
   </li>
  </ul>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    As of PHP 5.3.0, PHP contains its own implementation and will use that
    if the system lacks of support for one or more of the algorithms.
   </p>
  <p></p></blockquote>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.crypt-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">str</code></dt>

     <dd>

      <p class="para">
       The string to be hashed.
      </p>
      <div class="caution"><strong class="caution">Caution</strong>
       <p class="para">
        Using the <strong><code>CRYPT_BLOWFISH</code></strong> algorithm, will result
        in the <code class="parameter">str</code> parameter being truncated to a
        maximum length of 72 characters.
       </p>
      </div>
     </dd>

    
    
     <dt>
<code class="parameter">salt</code></dt>

     <dd>

      <p class="para">
       An optional salt string to base the hashing on. If not provided, the
       behaviour is defined by the algorithm implementation and can lead to
       unexpected results.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.crypt-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the hashed string or a string that is shorter than 13 characters
   and is guaranteed to differ from the salt on failure.
  </p>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="simpara">
    When validating passwords, a string comparison function that isn't
    vulnerable to timing attacks should be used to compare the output of
    <span class="function"><strong>crypt()</strong></span> to the previously known hash. PHP 5.6 onwards
    provides <span class="function"><a href="function.hash-equals.html" class="function">hash_equals()</a></span> for this purpose.
   </p>
  </div>
 </div>

 
 <div class="refsect1 changelog" id="refsect1-function.crypt-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   </p><table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.6.0</td>
       <td>
        Raise E_NOTICE security warning if <code class="parameter">salt</code> is omitted.
       </td>
      </tr>

      <tr>
       <td>5.3.7</td>
       <td>
        Added <em>$2x$</em> and <em>$2y$</em> Blowfish
        modes to deal with potential high-bit attacks.
       </td>
      </tr>

      <tr>
       <td>5.3.2</td>
       <td>
        Added SHA-256 and SHA-512 crypt based on Ulrich Drepper's 
        <a href="http://people.redhat.com/drepper/SHA-crypt.txt" class="link external">Â»&nbsp;implementation</a>.
       </td>
      </tr>

      <tr>
       <td>5.3.2</td>
       <td>
        Fixed Blowfish behaviour on invalid rounds to return "failure" 
        string ("*0" or "*1"), instead of falling back to DES.
       </td>
      </tr>

      <tr>
       <td>5.3.0</td>
       <td>
        PHP now contains its own implementation for the MD5 crypt, Standard DES,
        Extended DES and the Blowfish algorithms and will use that if the system
        lacks of support for one or more of the algorithms.
       </td>
      </tr>

     </tbody>
    
   </table>

  <p></p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.crypt-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-4941">
    <p><strong>Example #1 <span class="function"><strong>crypt()</strong></span> examples</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$hashed_password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #DD0000">'mypassword'</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;let&nbsp;the&nbsp;salt&nbsp;be&nbsp;automatically&nbsp;generated<br><br>/*&nbsp;You&nbsp;should&nbsp;pass&nbsp;the&nbsp;entire&nbsp;results&nbsp;of&nbsp;crypt()&nbsp;as&nbsp;the&nbsp;salt&nbsp;for&nbsp;comparing&nbsp;a<br>&nbsp;&nbsp;&nbsp;password,&nbsp;to&nbsp;avoid&nbsp;problems&nbsp;when&nbsp;different&nbsp;hashing&nbsp;algorithms&nbsp;are&nbsp;used.&nbsp;(As<br>&nbsp;&nbsp;&nbsp;it&nbsp;says&nbsp;above,&nbsp;standard&nbsp;DES-based&nbsp;password&nbsp;hashing&nbsp;uses&nbsp;a&nbsp;2-character&nbsp;salt,<br>&nbsp;&nbsp;&nbsp;but&nbsp;MD5-based&nbsp;hashing&nbsp;uses&nbsp;12.)&nbsp;*/<br></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">hash_equals</span><span style="color: #007700">(</span><span style="color: #0000BB">$hashed_password</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #0000BB">$user_input</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$hashed_password</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Password&nbsp;verified!"</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-4942">
    <p><strong>Example #2 Using <span class="function"><strong>crypt()</strong></span> with htpasswd</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;Set&nbsp;the&nbsp;password<br></span><span style="color: #0000BB">$password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'mypassword'</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&nbsp;Get&nbsp;the&nbsp;hash,&nbsp;letting&nbsp;the&nbsp;salt&nbsp;be&nbsp;automatically&nbsp;generated<br></span><span style="color: #0000BB">$hash&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #0000BB">$password</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-4943">
    <p><strong>Example #3 Using <span class="function"><strong>crypt()</strong></span> with different hash types</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">/*&nbsp;These&nbsp;salts&nbsp;are&nbsp;examples&nbsp;only,&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;used&nbsp;verbatim&nbsp;in&nbsp;your&nbsp;code.<br>&nbsp;&nbsp;&nbsp;You&nbsp;should&nbsp;generate&nbsp;a&nbsp;distinct,&nbsp;correctly-formatted&nbsp;salt&nbsp;for&nbsp;each&nbsp;password.<br>*/<br></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">CRYPT_STD_DES&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Standard&nbsp;DES:&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #DD0000">'rasmuslerdorf'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'rl'</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>}<br><br>if&nbsp;(</span><span style="color: #0000BB">CRYPT_EXT_DES&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Extended&nbsp;DES:&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #DD0000">'rasmuslerdorf'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'_J9..rasm'</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>}<br><br>if&nbsp;(</span><span style="color: #0000BB">CRYPT_MD5&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'MD5:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #DD0000">'rasmuslerdorf'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'$1$rasmusle$'</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>}<br><br>if&nbsp;(</span><span style="color: #0000BB">CRYPT_BLOWFISH&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Blowfish:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #DD0000">'rasmuslerdorf'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'$2a$07$usesomesillystringforsalt$'</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>}<br><br>if&nbsp;(</span><span style="color: #0000BB">CRYPT_SHA256&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'SHA-256:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #DD0000">'rasmuslerdorf'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'$5$rounds=5000$usesomesillystringforsalt$'</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>}<br><br>if&nbsp;(</span><span style="color: #0000BB">CRYPT_SHA512&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'SHA-512:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">crypt</span><span style="color: #007700">(</span><span style="color: #DD0000">'rasmuslerdorf'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'$6$rounds=5000$usesomesillystringforsalt$'</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>Standard DES: rl.3StKT.4T8M
Extended DES: _J9..rasmBYk8r9AiWNc
MD5:          $1$rasmusle$rISCgZzpwk3UhDidwXvin0
Blowfish:     $2a$07$usesomesillystringfore2uDLvp1Ii2e./U9C8sBjqp8I90dH6hi
SHA-256:      $5$rounds=5000$usesomesillystri$KqJWpanXZHKq2BOB43TSaYhEWsQ1Lr5QNyPCDH/Tp.6
SHA-512:      $6$rounds=5000$usesomesillystri$D4IrlXatmP7rx3P3InaxBeoomnAihCKRVQP22JZ6EY47Wc6BkroIuUUBOov1i.S5KPgErtP/EN5mcO.ChWQW21
</pre></div>
    </div>
   </div>
  <p></p>
 </div>

 
 <div class="refsect1 notes" id="refsect1-function.crypt-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    There is no decrypt function, since <span class="function"><strong>crypt()</strong></span> uses a
    one-way algorithm.
   </span>
  </p></blockquote>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.crypt-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.hash-equals.html" class="function" rel="rdfs-seeAlso">hash_equals()</a> - Timing attack safe string comparison</span></li>
    <li class="member"><span class="function"><a href="function.password-hash.html" class="function" rel="rdfs-seeAlso">password_hash()</a> - Creates a password hash</span></li>
    <li class="member"><span class="function"><a href="function.md5.html" class="function" rel="rdfs-seeAlso">md5()</a> - Calculate the md5 hash of a string</span></li>
    <li class="member">The <a href="ref.mcrypt.html" class="link">Mcrypt</a> extension</li>
    <li class="member">The Unix man page for your crypt function for more information</li>
   </ul>
  <p></p>
 </div>

 
</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="112006">  
  <a class="name">
  <strong class="user"><em>mblaney at gmail dot com</em></strong></a><div class="date" title="2013-04-22 01:46"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112006">
<div class="phpcode"><code><span class="html">
For those wondering, like I did, what the maximum length of the returned hash can be for the purpose of storing it in a database, the answer is:<br><br>123 characters.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="60056">  
  <a class="name">
  <strong class="user"><em>solar at openwall dot com</em></strong></a><div class="date" title="2005-12-23 11:20"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom60056">
<div class="phpcode"><code><span class="html">
With different password hashing methods supported on different systems and with the need to generate salts with your own PHP code in order to use the more advanced / more secure methods, it takes special knowledge to use crypt() optimally, producing strong password hashes.&nbsp; Other message digest / hashing functions supported by PHP, such as md5() and sha1(), are really no good for password hashing if used naively, resulting in hashes which may be brute-forced at rates much higher than those possible for hashes produced by crypt().<br><br>I have implemented a PHP password hashing framework (in PHP, tested with all of PHP 3, 4, and 5) which hides the complexity from your PHP applications (no need for you to worry about salts, etc.), yet does things in almost the best way possible given the constraints of the available functions.&nbsp; The homepage for the framework is:<br><br><a rel="nofollow" target="_blank">http://www.openwall.com/phpass/</a><br><br>I have placed this code in the public domain, so there are no copyrights or licensing restrictions to worry about.<br><br>P.S. I have 10 years of experience in password (in)security and I've developed several other password security tools and libraries.&nbsp; So most people can feel confident they're getting this done better by using my framework than they could have done it on their own.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112035">  
  <a class="name">
  <strong class="user"><em>jette at nerdgirl dot dk</em></strong></a><div class="date" title="2013-04-25 07:48"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112035">
<div class="phpcode"><code><span class="html">
The crypt() function cant handle plus signs correctly. So if for example you are using crypt in a login function, use urlencode on the password first to make sure that the login procedure can handle any character:<br><br><span class="default">&lt;?php<br>$user_input </span><span class="keyword">=&nbsp; </span><span class="string">'12+#Ã¦345'</span><span class="keyword">;<br></span><span class="default">$pass </span><span class="keyword">= </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$user_input</span><span class="keyword">));<br></span><span class="default">$pass_crypt </span><span class="keyword">= </span><span class="default">crypt</span><span class="keyword">(</span><span class="default">$pass</span><span class="keyword">);<br><br>if (</span><span class="default">$pass_crypt </span><span class="keyword">== </span><span class="default">crypt</span><span class="keyword">(</span><span class="default">$pass</span><span class="keyword">, </span><span class="default">$pass_crypt</span><span class="keyword">)) {<br>&nbsp; echo </span><span class="string">"Success! Valid password"</span><span class="keyword">;<br>} else {<br>&nbsp; echo </span><span class="string">"Invalid password"</span><span class="keyword">;<br>} <br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114893">  
  <a class="name">
  <strong class="user"><em>chris at seccosquared dot com</em></strong></a><div class="date" title="2014-04-21 04:59"><strong>4 months ago</strong></div>
  <div class="text" id="Hcom114893">
<div class="phpcode"><code><span class="html">
A great implementation of crypt, that will generate the password and a unique salt used for it for you to easily add the data to your Database.&nbsp; It is called Encryptor and it is available on github: <br><br><a rel="nofollow" target="_blank">http://git.io/mSJqpw</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="111086">  
  <a class="name">
  <strong class="user"><em>steve at tobtu dot com</em></strong></a><div class="date" title="2013-01-13 12:26"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111086">
<div class="phpcode"><code><span class="html">
To generate salt use mcrypt_create_iv() not mt_rand() because no matter how many times you call mt_rand() it will only have at most 32 bits of entropy. Which you will start seeing salt collisions after about 2^16 users. mt_rand() is seeded poorly so it should happen sooner.<br><br>For bcrypt this will actually generate a 128 bit salt:<br><span class="default">&lt;?php $salt </span><span class="keyword">= </span><span class="default">strtr</span><span class="keyword">(</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">mcrypt_create_iv</span><span class="keyword">(</span><span class="default">16</span><span class="keyword">, </span><span class="default">MCRYPT_DEV_URANDOM</span><span class="keyword">)), </span><span class="string">'+'</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">); </span><span class="default">?&gt;<br></span><br>*** Bike shed ***<br>The last character in the 22 character salt is 2 bits.<br>base64_encode() will have these four character "AQgw"<br>bcrypt will have these four character ".Oeu"<br><br>You don't need to do a full translate because they "round" to different characters:<br>echo crypt('', '$2y$05$.....................A') . "\n";<br>echo crypt('', '$2y$05$.....................Q') . "\n";<br>echo crypt('', '$2y$05$.....................g') . "\n";<br>echo crypt('', '$2y$05$.....................w') . "\n";<br><br>$2y$05$......................J2ihDv8vVf7QZ9BsaRrKyqs2tkn55Yq<br>$2y$05$.....................O/jw2XygQa2.LrIT7CFCBQowLowDP6Y.<br>$2y$05$.....................eDOx4wMcy7WU.kE21W6nJfdMimsBE3V6<br>$2y$05$.....................uMMcgjnOELIa6oydRivPkiMrBG8.aFp.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102278">  
  <a class="name">
  <strong class="user"><em>kaminski at istori dot com</em></strong></a><div class="date" title="2011-02-05 03:43"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102278">
<div class="phpcode"><code><span class="html">
Here is an expression to generate pseudorandom salt for the CRYPT_BLOWFISH hash type:<br><br><span class="default">&lt;?php $salt </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'+'</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">, </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">pack</span><span class="keyword">(</span><span class="string">'N4'</span><span class="keyword">, </span><span class="default">mt_rand</span><span class="keyword">(), </span><span class="default">mt_rand</span><span class="keyword">(), </span><span class="default">mt_rand</span><span class="keyword">(), </span><span class="default">mt_rand</span><span class="keyword">()))), </span><span class="default">0</span><span class="keyword">, </span><span class="default">22</span><span class="keyword">); </span><span class="default">?&gt;<br></span><br>It is intended for use on systems where mt_getrandmax() == 2147483647.<br><br>The salt created will be 128 bits in length, padded to 132 bits and then expressed in 22 base64 characters.&nbsp; (CRYPT_BLOWFISH only uses 128 bits for the salt, even though there are 132 bits in 22 base64 characters.&nbsp; If you examine the CRYPT_BLOWFISH input and output, you can see that it ignores the last four bits on input, and sets them to zero on output.)<br><br>Note that the high-order bits of the four 32-bit dwords returned by mt_rand() will always be zero (since mt_getrandmax == 2^31), so only 124 of the 128 bits will be pseudorandom.&nbsp; I found that acceptable for my application.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73619">  
  <a class="name">
  <strong class="user"><em>mikey_nich (at) hotmÃ¡il . com</em></strong></a><div class="date" title="2007-03-04 07:47"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73619">
<div class="phpcode"><code><span class="html">
Are you using Apache2 on f.i. WinXP and want to create .htpasswd files via php? Then you need to use the APR1-MD5 encryption method. Here is a function for that:<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">crypt_apr1_md5</span><span class="keyword">(</span><span class="default">$plainpasswd</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$salt </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">str_shuffle</span><span class="keyword">(</span><span class="string">"abcdefghijklmnopqrstuvwxyz0123456789"</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$plainpasswd</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">$plainpasswd</span><span class="keyword">.</span><span class="string">'$apr1$'</span><span class="keyword">.</span><span class="default">$salt</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$bin </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"H32"</span><span class="keyword">, </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$plainpasswd</span><span class="keyword">.</span><span class="default">$salt</span><span class="keyword">.</span><span class="default">$plainpasswd</span><span class="keyword">));<br>&nbsp; &nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">-= </span><span class="default">16</span><span class="keyword">) { </span><span class="default">$text </span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">min</span><span class="keyword">(</span><span class="default">16</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">)); }<br>&nbsp; &nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&gt;&gt;= </span><span class="default">1</span><span class="keyword">) { </span><span class="default">$text </span><span class="keyword">.= (</span><span class="default">$i </span><span class="keyword">&amp; </span><span class="default">1</span><span class="keyword">) ? </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">) : </span><span class="default">$plainpasswd</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">}; }<br>&nbsp; &nbsp; </span><span class="default">$bin </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"H32"</span><span class="keyword">, </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">));<br>&nbsp; &nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">1000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new </span><span class="keyword">= (</span><span class="default">$i </span><span class="keyword">&amp; </span><span class="default">1</span><span class="keyword">) ? </span><span class="default">$plainpasswd </span><span class="keyword">: </span><span class="default">$bin</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$i </span><span class="keyword">% </span><span class="default">3</span><span class="keyword">) </span><span class="default">$new </span><span class="keyword">.= </span><span class="default">$salt</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$i </span><span class="keyword">% </span><span class="default">7</span><span class="keyword">) </span><span class="default">$new </span><span class="keyword">.= </span><span class="default">$plainpasswd</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new </span><span class="keyword">.= (</span><span class="default">$i </span><span class="keyword">&amp; </span><span class="default">1</span><span class="keyword">) ? </span><span class="default">$bin </span><span class="keyword">: </span><span class="default">$plainpasswd</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$bin </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"H32"</span><span class="keyword">, </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">));<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">5</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$k </span><span class="keyword">= </span><span class="default">$i </span><span class="keyword">+ </span><span class="default">6</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$j </span><span class="keyword">= </span><span class="default">$i </span><span class="keyword">+ </span><span class="default">12</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$j </span><span class="keyword">== </span><span class="default">16</span><span class="keyword">) </span><span class="default">$j </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">$bin</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="default">$bin</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">].</span><span class="default">$bin</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">].</span><span class="default">$tmp</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">).</span><span class="default">chr</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">).</span><span class="default">$bin</span><span class="keyword">[</span><span class="default">11</span><span class="keyword">].</span><span class="default">$tmp</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">strtr</span><span class="keyword">(</span><span class="default">strrev</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">), </span><span class="default">2</span><span class="keyword">)),<br>&nbsp; &nbsp; </span><span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="string">"$"</span><span class="keyword">.</span><span class="string">"apr1"</span><span class="keyword">.</span><span class="string">"$"</span><span class="keyword">.</span><span class="default">$salt</span><span class="keyword">.</span><span class="string">"$"</span><span class="keyword">.</span><span class="default">$tmp</span><span class="keyword">;<br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114060">  
  <a class="name">
  <strong class="user"><em>Marten Jacobs</em></strong></a><div class="date" title="2014-01-07 09:57"><strong>7 months ago</strong></div>
  <div class="text" id="Hcom114060">
<div class="phpcode"><code><span class="html">
As I understand it, blowfish is generally seen a secure hashing algorithm, even for enterprise use (correct me if I'm wrong). Because of this, I created functions to create and check secure password hashes using this algorithm, and using the (also deemed cryptographically secure) openssl_random_pseudo_bytes function to generate the salt.<br><br><span class="default">&lt;?php<br></span><span class="comment">/*<br> * Generate a secure hash for a given password. The cost is passed<br> * to the blowfish algorithm. Check the PHP manual page for crypt to<br> * find more information about this setting.<br> */<br></span><span class="keyword">function </span><span class="default">generate_hash</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">, </span><span class="default">$cost</span><span class="keyword">=</span><span class="default">11</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/* To generate the salt, first generate enough random bytes. Because<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * base64 returns one character for each 6 bits, the we should generate<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * at least 22*6/8=16.5 bytes, so we generate 17. Then we get the first<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * 22 base64 characters<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$salt</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">openssl_random_pseudo_bytes</span><span class="keyword">(</span><span class="default">17</span><span class="keyword">)),</span><span class="default">0</span><span class="keyword">,</span><span class="default">22</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/* As blowfish takes a salt with the alphabet ./A-Za-z0-9 we have to<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * replace any '+' in the base64 string with '.'. We don't have to do<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * anything about the '=', as this only occurs when the b64 string is<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * padded, which is always after the first 22 characters.<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$salt</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"+"</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">,</span><span class="default">$salt</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/* Next, create a string that will be passed to crypt, containing all<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * of the settings, separated by dollar signs<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$param</span><span class="keyword">=</span><span class="string">'$'</span><span class="keyword">.</span><span class="default">implode</span><span class="keyword">(</span><span class="string">'$'</span><span class="keyword">,array(<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"2y"</span><span class="keyword">, </span><span class="comment">//select the most secure version of blowfish (&gt;=PHP 5.3.7)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$cost</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="string">"0"</span><span class="keyword">,</span><span class="default">STR_PAD_LEFT</span><span class="keyword">), </span><span class="comment">//add the cost in two digits<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$salt </span><span class="comment">//add the salt<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//now do the actual hashing<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">crypt</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">,</span><span class="default">$param</span><span class="keyword">);<br>}<br> <br></span><span class="comment">/*<br> * Check the password against a hash generated by the generate_hash<br> * function.<br> */<br></span><span class="keyword">function </span><span class="default">validate_pw</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">, </span><span class="default">$hash</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/* Regenerating the with an available hash as the options parameter should<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * produce the same hash if the same password is passed.<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">crypt</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">, </span><span class="default">$hash</span><span class="keyword">)==</span><span class="default">$hash</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115041">  
  <a class="name">
  <strong class="user"><em>ian+php dot net at eiloart dot ocm</em></strong></a><div class="date" title="2014-05-16 12:46"><strong>3 months ago</strong></div>
  <div class="text" id="Hcom115041">
<div class="phpcode"><code><span class="html">
If you're stuck with CRYPT_EXT_DES, then you'll want to pick a number of iterations: the 2nd-5th characters of the "salt".<br><br>My experimentation suggests that the 5th character is the most significant. A '.' is a zero and 'Z' is the highest value. Using all dots will create an error: all passwords will be encrypted to the same value.<br><br>Here are some encryption timings (in seconds) that I obtained, with five different iteration counts over the same salt, and the same password, on a quad core 2.66GHz Intel Xeon machine.<br><br>_1111 time: 0.15666794776917<br>_J9.Z time: 1.8860530853271<br>_J9.. time: 0.00015401840209961<br>_...Z time: 1.9095730781555<br>_ZZZZ time: 1.9124970436096<br>_...A time: 0.61211705207825<br><br>I think a half a second is reasonable for an application, but for the back end authentication? I'm not so sure: there's a significant risk of overloading the back end if we're getting lots of authentication requests.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="58805">  
  <a class="name">
  <strong class="user"><em>hotdog (at) gmx (dot) net</em></strong></a><div class="date" title="2005-11-16 07:34"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom58805">
<div class="phpcode"><code><span class="html">
WRONG:<br><br>$mypassword = "toto";<br>$smd5_pass = "{SMD5}......." // in openldap<br><br>if (preg_match ("/{SMD5}/i", $smd5_pass))<br> {<br>&nbsp; $encrypted = substr($md5_pass, 6);<br>&nbsp; $hash = base64_decode($encrypted);<br>&nbsp; $salt = substr($hash,16);<br>&nbsp; $mhashed =&nbsp; mhash(MHASH_MD5, $mypassword . $salt) ;<br>&nbsp; $without_salt = explode($salt,$hash_hex);<br>&nbsp;&nbsp; if ($without_salt[0] == $mhashed) {<br>&nbsp; &nbsp; echo "Password verified &lt;br&gt;";<br>&nbsp; &nbsp; } else {<br>&nbsp; &nbsp; echo "Password Not verified&lt;br&gt;";<br>&nbsp; &nbsp; }<br> }<br><br>$without_salt = explode($salt,$hash_hex); should be $without_salt = explode($salt,$hash); <br><br>RIGHT:<br><br>$mypassword = "toto";<br>$smd5_pass = "{SMD5}......." // in openldap<br><br>if (preg_match ("/{SMD5}/i", $smd5_pass))<br> {<br>&nbsp; $encrypted = substr($md5_pass, 6);<br>&nbsp; $hash = base64_decode($encrypted);<br>&nbsp; $salt = substr($hash,16);<br>&nbsp; $mhashed =&nbsp; mhash(MHASH_MD5, $mypassword . $salt) ;<br>&nbsp; $without_salt = explode($salt,$hash);<br>&nbsp;&nbsp; if ($without_salt[0] == $mhashed) {<br>&nbsp; &nbsp; echo "Password verified &lt;br&gt;";<br>&nbsp; &nbsp; } else {<br>&nbsp; &nbsp; echo "Password Not verified&lt;br&gt;";<br>&nbsp; &nbsp; }<br> }</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108704">  
  <a class="name">
  <strong class="user"><em>Matteo</em></strong></a><div class="date" title="2012-05-18 10:39"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108704">
<div class="phpcode"><code><span class="html">
Password hashing should be done only with crypt and NEVER with SHA* and MD5 or hash(). The fundamental reason is that crypt is designed to be SLOW which is a VERY good thing for password hashing.
<br>
<br>It also automatically generate a salt every time which makes pre-computed tables to "decrypt" passwords useless (the generated salt is stored in the returned string for convenience).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105949">  
  <a class="name">
  <strong class="user"><em>harry at simans dot net</em></strong></a><div class="date" title="2011-09-27 04:34"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom105949">
<div class="phpcode"><code><span class="html">
I made a nice little wrapper function for crypt():
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">hasher</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">, </span><span class="default">$encdata </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)
<br>{
<br>&nbsp; </span><span class="default">$strength </span><span class="keyword">= </span><span class="string">"08"</span><span class="keyword">;
<br>&nbsp; </span><span class="comment">//if encrypted data is passed, check it against input ($info)
<br>&nbsp; </span><span class="keyword">if (</span><span class="default">$encdata</span><span class="keyword">) {
<br>&nbsp; &nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$encdata</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">60</span><span class="keyword">) == </span><span class="default">crypt</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">, </span><span class="string">"$2a$"</span><span class="keyword">.</span><span class="default">$strength</span><span class="keyword">.</span><span class="string">"$"</span><span class="keyword">.</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$encdata</span><span class="keyword">, </span><span class="default">60</span><span class="keyword">))) {
<br>&nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; else {
<br>&nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>&nbsp; }
<br>&nbsp; else {
<br>&nbsp; </span><span class="comment">//make a salt and hash it with input, and add salt to end
<br>&nbsp; </span><span class="default">$salt </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br>&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">22</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {
<br>&nbsp; &nbsp; </span><span class="default">$salt </span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="string">"./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"</span><span class="keyword">, </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">63</span><span class="keyword">), </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; }
<br>&nbsp; </span><span class="comment">//return 82 char string (60 char hash &amp; 22 char salt)
<br></span><span class="keyword">return </span><span class="default">crypt</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">, </span><span class="string">"$2a$"</span><span class="keyword">.</span><span class="default">$strength</span><span class="keyword">.</span><span class="string">"$"</span><span class="keyword">.</span><span class="default">$salt</span><span class="keyword">).</span><span class="default">$salt</span><span class="keyword">;
<br>}
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>This wrapper will accept a string as input and hash it, and output the hash result of the string and salt together, plus the salt added on the end. You can then store that output in a db, and pass it on to the function as the 2nd parameter when you go to verify it, along with the user input or whatever as the first.
<br>
<br>Examples:
<br>
<br><span class="default">&lt;?php
<br>$hash </span><span class="keyword">= </span><span class="default">hasher</span><span class="keyword">(</span><span class="default">$userinput</span><span class="keyword">);
<br>if (</span><span class="default">$hash </span><span class="keyword">== </span><span class="default">hasher</span><span class="keyword">(</span><span class="default">$userinput</span><span class="keyword">, </span><span class="default">$hash</span><span class="keyword">) {</span><span class="comment">//authed}
<br></span><span class="default">?&gt;
<br></span>
<br>Neat huh?</span>
</code></div>
  </div>
 </div>
  <div class="note" id="45350">  
  <a class="name">
  <strong class="user"><em>thorhajo at gmail dot com</em></strong></a><div class="date" title="2004-09-02 03:34"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom45350">
<div class="phpcode"><code><span class="html">
Here's a little function I wrote to generate MD5 password hashes in the format they're found in /etc/shadow:<br><br>function shadow($password)<br>{<br>&nbsp; $hash = '';<br>&nbsp; for($i=0;$i&lt;8;$i++)<br>&nbsp; {<br>&nbsp; &nbsp; $j = mt_rand(0,53);<br>&nbsp; &nbsp; if($j&lt;26)$hash .= chr(rand(65,90));<br>&nbsp; &nbsp; else if($j&lt;52)$hash .= chr(rand(97,122));<br>&nbsp; &nbsp; else if($j&lt;53)$hash .= '.';<br>&nbsp; &nbsp; else $hash .= '/';<br>&nbsp; }<br>&nbsp; return crypt($password,'$1$'.$hash.'$');<br>}<br><br>I've written this so that each character in the a-zA-Z./ set has a 1/54 of a chance of being selected (26 + 26 + 2 = 54), thus being statistically even.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112817">  
  <a class="name">
  <strong class="user"><em>mrdaniel619 at gmail dot com</em></strong></a><div class="date" title="2013-07-26 08:16"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112817">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php<br><br></span><span class="comment">/*<br>nice script for creating a hash with random salt<br>*/<br><br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">rand_str</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">, </span><span class="default">$charset</span><span class="keyword">=</span><span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$charset</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; while (</span><span class="default">$length</span><span class="keyword">--) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$str </span><span class="keyword">.= </span><span class="default">$charset</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$count</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)];<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$str</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="default">$hash </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br><br>&nbsp; &nbsp; if(isset(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'string'</span><span class="keyword">]) &amp;&amp; !empty(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'string'</span><span class="keyword">]) &amp;&amp; </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'string'</span><span class="keyword">]))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$salt </span><span class="keyword">= </span><span class="default">rand_str</span><span class="keyword">(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">100</span><span class="keyword">,</span><span class="default">200</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$hash </span><span class="keyword">= </span><span class="default">crypt</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'string'</span><span class="keyword">], </span><span class="string">'$6$rounds=9000$'</span><span class="keyword">.</span><span class="default">$salt</span><span class="keyword">.</span><span class="string">'$'</span><span class="keyword">);<br>&nbsp; &nbsp; }<br><br></span><span class="default">?&gt;<br></span>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&nbsp; &nbsp; &lt;head&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;title&gt;&lt;/title&gt;<br>&nbsp; &nbsp; &lt;/head&gt;<br>&nbsp; &nbsp; &lt;body&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;h1&gt;512 Hash&lt;/h1&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;div&gt;<span class="default">&lt;?= $hash ?&gt;</span>&lt;/div&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;form method ="post"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;table&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;tr&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;input type ="text" <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; value ="<span class="default">&lt;?php </span><span class="keyword">if(</span><span class="default">$hash</span><span class="keyword">!== </span><span class="string">""</span><span class="keyword">){ echo </span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'string'</span><span class="keyword">]); } </span><span class="default">?&gt;</span>" <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; id ="string" <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; name ="string" /&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;input type ="submit" value ="hash" /&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/td&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/tr&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/table&gt;&nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/form&gt;<br>&nbsp; &nbsp; &lt;/body&gt;<br>&lt;/html&gt;</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.crypt.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:54:55 GMT -->


</body></html>