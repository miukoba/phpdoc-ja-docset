<html><!-- Mirrored from php.net/manual/en/function.json-encode.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:05:06 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>json_encode</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.json-encode.html">
 <link rel="shorturl" href="http://php.net/json-encode">
 <link rel="alternate" href="http://php.net/json-encode" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.json.html">
 <link rel="prev" href="function.json-decode.html">
 <link rel="next" href="function.json-last-error-msg.html">

 <link rel="alternate" href="function.json-encode.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.json-encode.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.json-encode.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.json-encode.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.json-encode.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.json-encode.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.json-encode.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.json-encode.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.json-encode.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.json-encode.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.json-encode.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.other.html">Other Basic Extensions</a></li>      <li><a href="book.json.html">JSON</a></li>      <li><a href="ref.json.html">JSON Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.json-encode" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">json_encode</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.2.0, PECL json &gt;= 1.2.0)</p><p class="refpurpose"><span class="refname">json_encode</span> — <span class="dc-title">Returns the JSON representation of a value</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.json-encode-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>json_encode</strong></span>
    ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$value</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$depth</code><span class="initializer"> = 512</span></span>
  ]] )</div>

  <p class="para rdfs-comment">
   Returns a string containing the JSON representation of 
   <code class="parameter">value</code>.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.json-encode-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">value</code></dt>

     <dd>

      <p class="para">
       The <code class="parameter">value</code> being encoded. Can be any type except
       a <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>.
      </p>
      <p class="para">
       All string data must be UTF-8 encoded.
      </p>
      <blockquote class="note"><p><strong class="note">Note</strong>: </p><p class="para">PHP implements a superset of
JSON - it will also encode and decode scalar types and <strong><code>NULL</code></strong>. The JSON standard
only supports these values when they are nested inside an array or an object.
</p><p></p></blockquote>
     </dd>

    
    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       Bitmask consisting of <strong><code>JSON_HEX_QUOT</code></strong>,
       <strong><code>JSON_HEX_TAG</code></strong>,
       <strong><code>JSON_HEX_AMP</code></strong>,
       <strong><code>JSON_HEX_APOS</code></strong>,
       <strong><code>JSON_NUMERIC_CHECK</code></strong>,
       <strong><code>JSON_PRETTY_PRINT</code></strong>,
       <strong><code>JSON_UNESCAPED_SLASHES</code></strong>,
       <strong><code>JSON_FORCE_OBJECT</code></strong>,
       <strong><code>JSON_UNESCAPED_UNICODE</code></strong>. The behaviour of these
       constants is described on
       <a href="json.constants.html" class="link">the JSON constants page</a>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">depth</code></dt>

     <dd>

      <p class="para">
       Set the maximum depth. Must be greater than zero.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.json-encode-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns a JSON encoded <span class="type"><a href="language.types.string.html" class="type string">string</a></span> on success  or <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.json-encode-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   </p><table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.5.0</td>
       <td>
        <code class="parameter">depth</code> parameter was added.
       </td>
      </tr>

      <tr>
       <td>5.4.0</td>
       <td>
        <strong><code>JSON_PRETTY_PRINT</code></strong>, <strong><code>JSON_UNESCAPED_SLASHES</code></strong>, and <strong><code>JSON_UNESCAPED_UNICODE</code></strong> <code class="parameter">options</code> were added.
       </td>
      </tr>

      <tr>
       <td>5.3.3</td>
       <td>
        <strong><code>JSON_NUMERIC_CHECK</code></strong> <code class="parameter">option</code> was added.
       </td>
      </tr>

      <tr>
       <td>5.3.0</td>
       <td>
        The <code class="parameter">options</code> parameter was added.
       </td>
      </tr>

     </tbody>
    
   </table>

  <p></p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.json-encode-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-3884">
    <p><strong>Example #1 A <span class="function"><strong>json_encode()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$arr&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'a'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'b'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'c'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'d'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'e'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">);<br><br>echo&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$arr</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>{"a":1,"b":2,"c":3,"d":4,"e":5}
</pre></div>
    </div>
   </div>

   <div class="example" id="example-3885">
    <p><strong>Example #2 
     A <span class="function"><strong>json_encode()</strong></span> example showing some options in use
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$a&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'&lt;foo&gt;'</span><span style="color: #007700">,</span><span style="color: #DD0000">"'bar'"</span><span style="color: #007700">,</span><span style="color: #DD0000">'"baz"'</span><span style="color: #007700">,</span><span style="color: #DD0000">'&amp;blong&amp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"\xc3\xa9"</span><span style="color: #007700">);<br><br>echo&nbsp;</span><span style="color: #DD0000">"Normal:&nbsp;"</span><span style="color: #007700">,&nbsp;&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">"Tags:&nbsp;"</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">JSON_HEX_TAG</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">"Apos:&nbsp;"</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">JSON_HEX_APOS</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">"Quot:&nbsp;"</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">JSON_HEX_QUOT</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">"Amp:&nbsp;"</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">JSON_HEX_AMP</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">"Unicode:&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">JSON_UNESCAPED_UNICODE</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">"All:&nbsp;"</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$a</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">JSON_HEX_TAG&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">JSON_HEX_APOS&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">JSON_HEX_QUOT&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">JSON_HEX_AMP&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">JSON_UNESCAPED_UNICODE</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n\n"</span><span style="color: #007700">;<br><br></span><span style="color: #0000BB">$b&nbsp;</span><span style="color: #007700">=&nbsp;array();<br><br>echo&nbsp;</span><span style="color: #DD0000">"Empty&nbsp;array&nbsp;output&nbsp;as&nbsp;array:&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$b</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">"Empty&nbsp;array&nbsp;output&nbsp;as&nbsp;object:&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$b</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">JSON_FORCE_OBJECT</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n\n"</span><span style="color: #007700">;<br><br></span><span style="color: #0000BB">$c&nbsp;</span><span style="color: #007700">=&nbsp;array(array(</span><span style="color: #0000BB">1</span><span style="color: #007700">,</span><span style="color: #0000BB">2</span><span style="color: #007700">,</span><span style="color: #0000BB">3</span><span style="color: #007700">));<br><br>echo&nbsp;</span><span style="color: #DD0000">"Non-associative&nbsp;array&nbsp;output&nbsp;as&nbsp;array:&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$c</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">"Non-associative&nbsp;array&nbsp;output&nbsp;as&nbsp;object:&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$c</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">JSON_FORCE_OBJECT</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n\n"</span><span style="color: #007700">;<br><br></span><span style="color: #0000BB">$d&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'foo'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'bar'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'baz'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'long'</span><span style="color: #007700">);<br><br>echo&nbsp;</span><span style="color: #DD0000">"Associative&nbsp;array&nbsp;always&nbsp;output&nbsp;as&nbsp;object:&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$d</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br>echo&nbsp;</span><span style="color: #DD0000">"Associative&nbsp;array&nbsp;always&nbsp;output&nbsp;as&nbsp;object:&nbsp;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$d</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">JSON_FORCE_OBJECT</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">"\n\n"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>Normal: ["&lt;foo&gt;","'bar'","\"baz\"","&amp;blong&amp;","\u00e9"]
Tags: ["\u003Cfoo\u003E","'bar'","\"baz\"","&amp;blong&amp;","\u00e9"]
Apos: ["&lt;foo&gt;","\u0027bar\u0027","\"baz\"","&amp;blong&amp;","\u00e9"]
Quot: ["&lt;foo&gt;","'bar'","\u0022baz\u0022","&amp;blong&amp;","\u00e9"]
Amp: ["&lt;foo&gt;","'bar'","\"baz\"","\u0026blong\u0026","\u00e9"]
Unicode: ["&lt;foo&gt;","'bar'","\"baz\"","&amp;blong&amp;","é"]
All: ["\u003Cfoo\u003E","\u0027bar\u0027","\u0022baz\u0022","\u0026blong\u0026","é"]

Empty array output as array: []
Empty array output as object: {}

Non-associative array output as array: [[1,2,3]]
Non-associative array output as object: {"0":{"0":1,"1":2,"2":3}}

Associative array always output as object: {"foo":"bar","baz":"long"}
Associative array always output as object: {"foo":"bar","baz":"long"}
</pre></div>
    </div>
   </div>
   <div class="example" id="example-3886">
    <p><strong>Example #3 Sequential versus non-sequential array example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Sequential&nbsp;array"</span><span style="color: #007700">.</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$sequential&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"foo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"bar"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"baz"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"blong"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(<br>&nbsp;</span><span style="color: #0000BB">$sequential</span><span style="color: #007700">,<br>&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$sequential</span><span style="color: #007700">)<br>);<br><br>echo&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">.</span><span style="color: #DD0000">"Non-sequential&nbsp;array"</span><span style="color: #007700">.</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$nonsequential&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #0000BB">1</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"foo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"bar"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"baz"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"blong"</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(<br>&nbsp;</span><span style="color: #0000BB">$nonsequential</span><span style="color: #007700">,<br>&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$nonsequential</span><span style="color: #007700">)<br>);<br><br>echo&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">.</span><span style="color: #DD0000">"Sequential&nbsp;array&nbsp;with&nbsp;one&nbsp;key&nbsp;unset"</span><span style="color: #007700">.</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>unset(</span><span style="color: #0000BB">$sequential</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(<br>&nbsp;</span><span style="color: #0000BB">$sequential</span><span style="color: #007700">,<br>&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$sequential</span><span style="color: #007700">)<br>);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>Sequential array
array(4) {
  [0]=&gt;
  string(3) "foo"
  [1]=&gt;
  string(3) "bar"
  [2]=&gt;
  string(3) "baz"
  [3]=&gt;
  string(5) "blong"
}
string(27) "["foo","bar","baz","blong"]"

Non-sequential array
array(4) {
  [1]=&gt;
  string(3) "foo"
  [2]=&gt;
  string(3) "bar"
  [3]=&gt;
  string(3) "baz"
  [4]=&gt;
  string(5) "blong"
}
string(43) "{"1":"foo","2":"bar","3":"baz","4":"blong"}"

Sequential array with one key unset
array(3) {
  [0]=&gt;
  string(3) "foo"
  [2]=&gt;
  string(3) "baz"
  [3]=&gt;
  string(5) "blong"
}
string(33) "{"0":"foo","2":"baz","3":"blong"}"
</pre></div>
    </div>
   </div>
  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.json-encode-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    In the event of a failure to encode, <span class="function"><a href="function.json-last-error.html" class="function">json_last_error()</a></span>
    can be used to determine the exact nature of the error.
   </p>
  <p></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    When encoding an array, if the keys are not a continuous numeric
    sequence starting from 0, all keys are encoded as strings, and
    specified explicitly for each key-value pair.
   </p>
  <p></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    Like the reference JSON encoder, <span class="function"><strong>json_encode()</strong></span> will
    generate JSON that is a simple value (that is, neither an object nor an
    array) if given a <span class="type"><a href="language.types.string.html" class="type string">string</a></span>, <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>,
    <span class="type"><a href="language.types.float.html" class="type float">float</a></span> or <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span> as an input
    <code class="parameter">value</code>. While most decoders will accept these values
    as valid JSON, some may not, as the specification is ambiguous on this
    point.
   </p>
   <p class="para">
    To summarise, always test that your JSON decoder can handle the output you
    generate from <span class="function"><strong>json_encode()</strong></span>.
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.json-encode-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="interfacename"><a href="class.jsonserializable.html" class="interfacename">JsonSerializable</a></span></li>
    <li class="member"><span class="function"><a href="function.json-decode.html" class="function" rel="rdfs-seeAlso">json_decode()</a> - Decodes a JSON string</span></li>
    <li class="member"><span class="function"><a href="function.json-last-error.html" class="function" rel="rdfs-seeAlso">json_last_error()</a> - Returns the last error occurred</span></li>
    <li class="member"><span class="function"><a href="function.serialize.html" class="function" rel="rdfs-seeAlso">serialize()</a> - Generates a storable representation of a value</span></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="106641">  
  <a class="name">
  <strong class="user"><em>bohwaz</em></strong></a><div class="date" title="2011-11-23 05:05"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom106641">
<div class="phpcode"><code><span class="html">
Are you sure you want to use JSON_NUMERIC_CHECK, really really sure?<br><br>Just watch this usecase:<br><br><span class="default">&lt;?php<br></span><span class="comment">// International phone number<br></span><span class="default">json_encode</span><span class="keyword">(array(</span><span class="string">'phone_number' </span><span class="keyword">=&gt; </span><span class="string">'+33123456789'</span><span class="keyword">), </span><span class="default">JSON_NUMERIC_CHECK</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>And then you get this JSON:<br><br>{"phone_number":33123456789}<br><br>Maybe it makes sense for PHP (as is_numeric('+33123456789') returns true), but really, casting it as an int?!<br><br>So be careful when using JSON_NUMERIC_CHECK, it may mess up with your data!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102091">  
  <a class="name">
  <strong class="user"><em>bohwaz</em></strong></a><div class="date" title="2011-01-26 02:00"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102091">
<div class="phpcode"><code><span class="html">
This is intended to be a simple readable json encode function for PHP 5.3+ (and licensed under GNU/AGPLv3 or GPLv3 like you prefer):<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">json_readable_encode</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">, </span><span class="default">$indent </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$from_array </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$_myself </span><span class="keyword">= </span><span class="default">__FUNCTION__</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$_escape </span><span class="keyword">= function (</span><span class="default">$str</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"!([\b\t\n\r\f\"\\'])!"</span><span class="keyword">, </span><span class="string">"\\\\\\1"</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br>&nbsp; &nbsp; };<br><br>&nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br><br>&nbsp; &nbsp; foreach (</span><span class="default">$in </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"\t"</span><span class="keyword">, </span><span class="default">$indent </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\""</span><span class="keyword">.</span><span class="default">$_escape</span><span class="keyword">((string)</span><span class="default">$key</span><span class="keyword">).</span><span class="string">"\": "</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) || </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\n"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">$_myself</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$indent </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; elseif (</span><span class="default">is_bool</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">$value </span><span class="keyword">? </span><span class="string">'true' </span><span class="keyword">: </span><span class="string">'false'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; elseif (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">'null'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; elseif (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\"" </span><span class="keyword">. </span><span class="default">$_escape</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) .</span><span class="string">"\""</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">",\n"</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; if (!empty(</span><span class="default">$out</span><span class="keyword">))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"\t"</span><span class="keyword">, </span><span class="default">$indent</span><span class="keyword">) . </span><span class="string">"{\n" </span><span class="keyword">. </span><span class="default">$out</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\n" </span><span class="keyword">. </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"\t"</span><span class="keyword">, </span><span class="default">$indent</span><span class="keyword">) . </span><span class="string">"}"</span><span class="keyword">;<br><br>&nbsp; &nbsp; return </span><span class="default">$out</span><span class="keyword">;<br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112020">  
  <a class="name">
  <strong class="user"><em>guilhenfsu at gmail dot com</em></strong></a><div class="date" title="2013-04-22 08:35"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112020">
<div class="phpcode"><code><span class="html">
Solution for UTF-8 Special Chars.<br><br>&lt;?<br><br>$array = array('nome'=&gt;'Paição','cidade'=&gt;'São Paulo');<br><br>$array = array_map('htmlentities',$array);<br><br>//encode<br>$json = html_entity_decode(json_encode($array));<br><br>//Output: {"nome":"Paição","cidade":"São Paulo"}<br>echo $json;<br><br>?&gt;</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97008">  
  <a class="name">
  <strong class="user"><em>ryan at ryanparman dot com</em></strong></a><div class="date" title="2010-03-27 01:36"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97008">
<div class="phpcode"><code><span class="html">
I came across the "bug" where running json_encode() over a SimpleXML object was ignoring the CDATA. I ran across <a rel="nofollow" target="_blank">http://bugs.php.net/42001</a> and <a rel="nofollow" target="_blank">http://bugs.php.net/41976,</a> and while I agree with the poster that the documentation should clarify gotchas like this, I was able to figure out how to workaround it.<br><br>You need to convert the SimpleXML object back into an XML string, then re-import it back into SimpleXML using the LIBXML_NOCDATA option. Once you do this, then you can use json_encode() and still get back the CDATA.<br><br><span class="default">&lt;?php<br></span><span class="comment">// Pretend we already have a complex SimpleXML object stored in $xml<br></span><span class="default">$json </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">(new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">(), </span><span class="default">LIBXML_NOCDATA</span><span class="keyword">));<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100492">  
  <a class="name">
  <strong class="user"><em>migprj at gmail dot com</em></strong></a><div class="date" title="2010-10-19 07:46"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100492">
<div class="phpcode"><code><span class="html">
Because json_encode() only deals with utf8, it is often necessary to convert all the string values inside an array to utf8. I've created these two functions:&nbsp; &nbsp; 
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">utf8_encode_all</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">) </span><span class="comment">// -- It returns $dat encoded to UTF8
<br></span><span class="keyword">{
<br>&nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)) return </span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">);
<br>&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)) return </span><span class="default">$dat</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$ret </span><span class="keyword">= array();
<br>&nbsp; foreach(</span><span class="default">$dat </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">=&gt;</span><span class="default">$d</span><span class="keyword">) </span><span class="default">$ret</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">utf8_encode_all</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">);
<br>&nbsp; return </span><span class="default">$ret</span><span class="keyword">;
<br>}
<br></span><span class="comment">/* ....... */
<br>
<br></span><span class="keyword">function </span><span class="default">utf8_decode_all</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">) </span><span class="comment">// -- It returns $dat decoded from UTF8
<br></span><span class="keyword">{
<br>&nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)) return </span><span class="default">utf8_decode</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">);
<br>&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)) return </span><span class="default">$dat</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$ret </span><span class="keyword">= array();
<br>&nbsp; foreach(</span><span class="default">$dat </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">=&gt;</span><span class="default">$d</span><span class="keyword">) </span><span class="default">$ret</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">utf8_decode_all</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">);
<br>&nbsp; return </span><span class="default">$ret</span><span class="keyword">;
<br>}
<br></span><span class="comment">/* ....... */
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101843">  
  <a class="name">
  <strong class="user"><em>dan at elearnapp dot com</em></strong></a><div class="date" title="2011-01-13 12:01"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101843">
<div class="phpcode"><code><span class="html">
If you need to force an object (ex: empty array) you can also do:
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="default">&lt;?php json_encode</span><span class="keyword">( (object)</span><span class="default">$arr </span><span class="keyword">); </span><span class="default">?&gt;
<br></span>
<br>which acts the same as 
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class="default">&lt;?php json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">, </span><span class="default">JSON_FORCE_OBJECT</span><span class="keyword">); </span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105789">  
  <a class="name">
  <strong class="user"><em>devilan (REMOVEIT) (at) o2 (dot) pl</em></strong></a><div class="date" title="2011-09-15 12:39"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom105789">
<div class="phpcode"><code><span class="html">
For PHP5.3 users who want to emulate JSON_UNESCAPED_UNICODE, there is simple way to do it:<br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">my_json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//convmap since 0x80 char codes so it takes all multibyte codes (above ASCII 127). So such characters are being "hidden" from normal json_encoding<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">, function (&amp;</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">) { if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">)) </span><span class="default">$item </span><span class="keyword">= </span><span class="default">mb_encode_numericentity</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, array (</span><span class="default">0x80</span><span class="keyword">, </span><span class="default">0xffff</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0xffff</span><span class="keyword">), </span><span class="string">'UTF-8'</span><span class="keyword">); });<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">mb_decode_numericentity</span><span class="keyword">(</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">), array (</span><span class="default">0x80</span><span class="keyword">, </span><span class="default">0xffff</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0xffff</span><span class="keyword">), </span><span class="string">'UTF-8'</span><span class="keyword">);<br><br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112644">  
  <a class="name">
  <strong class="user"><em>CertaiN</em></strong></a><div class="date" title="2013-07-08 03:51"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112644">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php<br><br>$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'php://stdin'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">);<br></span><span class="default">$json </span><span class="keyword">= @</span><span class="default">json_encode</span><span class="keyword">(array(</span><span class="string">'a' </span><span class="keyword">=&gt; </span><span class="string">'foo'</span><span class="keyword">, </span><span class="string">'b' </span><span class="keyword">=&gt; </span><span class="default">$fp</span><span class="keyword">));<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$json</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>[PHP5.5 or after]<br>bool(false)<br><br>[PHP 5.4 or before]<br>string(20) "{"a":"foo","b":null}"</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113618">  
  <a class="name">
  <strong class="user"><em>info at pkrules dot in</em></strong></a><div class="date" title="2013-11-06 01:24"><strong>9 months ago</strong></div>
  <div class="text" id="Hcom113618">
<div class="phpcode"><code><span class="html">
Notice the last json_decode does not working :) ,you need to use a variable to use the encoded data in json_decode():- <br><span class="default">&lt;?php<br>$arr</span><span class="keyword">=array(</span><span class="string">'a'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">,</span><span class="string">'b'</span><span class="keyword">=&gt;</span><span class="default">2</span><span class="keyword">,</span><span class="string">'c'</span><span class="keyword">=&gt;</span><span class="default">3</span><span class="keyword">,</span><span class="string">'d'</span><span class="keyword">=&gt;</span><span class="default">4</span><span class="keyword">,</span><span class="string">'e'</span><span class="keyword">=&gt;</span><span class="default">5</span><span class="keyword">);<br><br>echo </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">).</span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br></span><span class="comment">//{"a":1,"b":2,"c":3,"d":4,"e":5}<br><br></span><span class="default">print_r </span><span class="keyword">(</span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">)));<br></span><span class="comment">//stdClass Object ( [a] =&gt; 1 [b] =&gt; 2 [c] =&gt; 3 [d] =&gt; 4 [e] =&gt; 5 )<br></span><span class="keyword">echo </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br></span><span class="default">$var</span><span class="keyword">=</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br></span><span class="default">print_r </span><span class="keyword">(</span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">));<br></span><span class="comment">//Array ( [a] =&gt; 1 [b] =&gt; 2 [c] =&gt; 3 [d] =&gt; 4 [e] =&gt; 5 ) <br></span><span class="keyword">echo </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br></span><span class="default">print_r </span><span class="keyword">(</span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">)),</span><span class="default">true</span><span class="keyword">);</span><span class="comment">//no output<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90407">  
  <a class="name">
  <strong class="user"><em>Sam Barnum</em></strong></a><div class="date" title="2009-04-20 11:01"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90407">
<div class="phpcode"><code><span class="html">
Note that if you try to encode an array containing non-utf values, you'll get null values in the resulting JSON string.&nbsp; You can batch-encode all the elements of an array with the array_map function:<br><span class="default">&lt;?php<br>$encodedArray </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="default">utf8_encode</span><span class="keyword">, </span><span class="default">$rawArray</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="89908">  
  <a class="name">
  <strong class="user"><em>andyrusterholz at g-m-a-i-l dot c-o-m</em></strong></a><div class="date" title="2009-03-27 11:17"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom89908">
<div class="phpcode"><code><span class="html">
For anyone who would like to encode arrays into JSON, but is using PHP 4, and doesn't want to wrangle PECL around, here is a function I wrote in PHP4 to convert nested arrays into JSON.
<br>
<br>Note that, because javascript converts JSON data into either nested named objects OR vector arrays, it's quite difficult to represent mixed PHP arrays (arrays with both numerical and associative indexes) well in JSON. This function does something funky if you pass it a mixed array -- see the comments for details.
<br>
<br>I don't make a claim that this function is by any means complete (for example, it doesn't handle objects) so if you have any improvements, go for it.
<br>
<br><span class="default">&lt;?php
<br>
<br></span><span class="comment">/**
<br> * Converts an associative array of arbitrary depth and dimension into JSON representation.
<br> *
<br> * NOTE: If you pass in a mixed associative and vector array, it will prefix each numerical
<br> * key with "key_". For example array("foo", "bar" =&gt; "baz") will be translated into
<br> * {"key_0": "foo", "bar": "baz"} but array("foo", "bar") would be translated into [ "foo", "bar" ].
<br> *
<br> * @param $array The array to convert.
<br> * @return mixed The resulting JSON string, or false if the argument was not an array.
<br> * @author Andy Rusterholz
<br> */
<br></span><span class="keyword">function </span><span class="default">array_to_json</span><span class="keyword">( </span><span class="default">$array </span><span class="keyword">){
<br>
<br>&nbsp; &nbsp; if( !</span><span class="default">is_array</span><span class="keyword">( </span><span class="default">$array </span><span class="keyword">) ){
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; </span><span class="default">$associative </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">( </span><span class="default">array_diff</span><span class="keyword">( </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">), </span><span class="default">array_keys</span><span class="keyword">( </span><span class="default">array_keys</span><span class="keyword">( </span><span class="default">$array </span><span class="keyword">)) ));
<br>&nbsp; &nbsp; if( </span><span class="default">$associative </span><span class="keyword">){
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$construct </span><span class="keyword">= array();
<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">){
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// We first copy each key/value pair into a staging array,
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // formatting each key and value properly as we go.
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Format the key:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if( </span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) ){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="string">"key_</span><span class="default">$key</span><span class="string">"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">).</span><span class="string">'"'</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Format the value:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if( </span><span class="default">is_array</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">)){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">array_to_json</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else if( !</span><span class="default">is_numeric</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">) || </span><span class="default">is_string</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">) ){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">).</span><span class="string">'"'</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Add to staging array:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$construct</span><span class="keyword">[] = </span><span class="string">"</span><span class="default">$key</span><span class="string">: </span><span class="default">$value</span><span class="string">"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Then we collapse the staging array into the JSON form:
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="string">"{ " </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">( </span><span class="string">", "</span><span class="keyword">, </span><span class="default">$construct </span><span class="keyword">) . </span><span class="string">" }"</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; } else { </span><span class="comment">// If the array is a vector (not associative):
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$construct </span><span class="keyword">= array();
<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$value </span><span class="keyword">){
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Format the value:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if( </span><span class="default">is_array</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">)){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">array_to_json</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else if( !</span><span class="default">is_numeric</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">) || </span><span class="default">is_string</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">) ){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">).</span><span class="string">'"'</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Add to staging array:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$construct</span><span class="keyword">[] = </span><span class="default">$value</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Then we collapse the staging array into the JSON form:
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="string">"[ " </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">( </span><span class="string">", "</span><span class="keyword">, </span><span class="default">$construct </span><span class="keyword">) . </span><span class="string">" ]"</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; return </span><span class="default">$result</span><span class="keyword">;
<br>}
<br>
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84997">  
  <a class="name">
  <strong class="user"><em>spam.goes.in.here AT gmail.com</em></strong></a><div class="date" title="2008-08-08 11:05"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84997">
<div class="phpcode"><code><span class="html">
For anyone who has run into the problem of private properties not being added, you can simply implement the IteratorAggregate interface with the getIterator() method. Add the properties you want to be included in the output into an array in the getIterator() method and return it.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107616">  
  <a class="name">
  <strong class="user"><em>webmaster_php at colnect dot com</em></strong></a><div class="date" title="2012-02-22 03:52"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107616">
<div class="phpcode"><code><span class="html">
WARNING! Do not pass associative arrays if the order is important to you. It seems that while FireFox does keep the same order, both Chrome and IE sort it. Here's a little workaround:
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; &nbsp; &nbsp; $arWrapper </span><span class="keyword">= array();&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$arWrapper</span><span class="keyword">[</span><span class="string">'k'</span><span class="keyword">] = </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$arChoices</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$arWrapper</span><span class="keyword">[</span><span class="string">'v'</span><span class="keyword">] = </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$arChoices</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$arWrapper</span><span class="keyword">);
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="94157">  
  <a class="name">
  <strong class="user"><em>simoncpu was here</em></strong></a><div class="date" title="2009-10-20 02:18"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom94157">
<div class="phpcode"><code><span class="html">
A note of caution: If you are wondering why json_encode() encodes your PHP array as a JSON object instead of a JSON array, you might want to double check your array keys because json_encode() assumes that you array is an object if your keys are not sequential.<br><br>e.g.:<br><br><span class="default">&lt;?php<br>$myarray </span><span class="keyword">= Array(</span><span class="string">'isa'</span><span class="keyword">, </span><span class="string">'dalawa'</span><span class="keyword">, </span><span class="string">'tatlo'</span><span class="keyword">);<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$myarray</span><span class="keyword">);<br></span><span class="comment">/* output<br>array(3) {<br>&nbsp; [0]=&gt;<br>&nbsp; string(3) "isa"<br>&nbsp; [1]=&gt;<br>&nbsp; string(6) "dalawa"<br>&nbsp; [2]=&gt;<br>&nbsp; string(5) "tatlo"<br>}<br>*/<br></span><span class="default">?&gt;<br></span><br>As you can see, the keys are sequential; $myarray will be correctly encoded as a JSON array.<br><br><span class="default">&lt;?php<br>$myarray </span><span class="keyword">= Array(</span><span class="string">'isa'</span><span class="keyword">, </span><span class="string">'dalawa'</span><span class="keyword">, </span><span class="string">'tatlo'</span><span class="keyword">);<br><br>unset(</span><span class="default">$myarray</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$myarray</span><span class="keyword">);<br></span><span class="comment">/* output<br>array(2) {<br>&nbsp; [0]=&gt;<br>&nbsp; string(3) "isa"<br>&nbsp; [2]=&gt;<br>&nbsp; string(5) "tatlo"<br>}<br>*/<br></span><span class="default">?&gt;<br></span><br>Unsetting an element will also remove the keys. json_encode() will now assume that this is an object, and will encode it as such.<br><br>SOLUTION: Use array_values() to re-index the array.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113219">  
  <a class="name">
  <strong class="user"><em>eep2004 at ukr dot net</em></strong></a><div class="date" title="2013-09-13 05:45"><strong>11 months ago</strong></div>
  <div class="text" id="Hcom113219">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php<br><br></span><span class="comment">// alternative json_encode<br></span><span class="keyword">function </span><span class="default">_json_encode</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) return </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">).</span><span class="string">'"'</span><span class="keyword">;<br>&nbsp; &nbsp; if (</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) return </span><span class="default">$val</span><span class="keyword">;<br>&nbsp; &nbsp; if (</span><span class="default">$val </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) return </span><span class="string">'null'</span><span class="keyword">;<br>&nbsp; &nbsp; if (</span><span class="default">$val </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) return </span><span class="string">'true'</span><span class="keyword">;<br>&nbsp; &nbsp; if (</span><span class="default">$val </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) return </span><span class="string">'false'</span><span class="keyword">;<br><br>&nbsp; &nbsp; </span><span class="default">$assoc </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; foreach (</span><span class="default">$val </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$v</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$k </span><span class="keyword">!== </span><span class="default">$i</span><span class="keyword">++){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$assoc </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">$res </span><span class="keyword">= array();<br>&nbsp; &nbsp; foreach (</span><span class="default">$val </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$v</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$v </span><span class="keyword">= </span><span class="default">_json_encode</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$assoc</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$k </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">).</span><span class="string">'"'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$v </span><span class="keyword">= </span><span class="default">$k</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$v</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$res</span><span class="keyword">[] = </span><span class="default">$v</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">$res </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">$res</span><span class="keyword">);<br>&nbsp; &nbsp; return (</span><span class="default">$assoc</span><span class="keyword">)? </span><span class="string">'{'</span><span class="keyword">.</span><span class="default">$res</span><span class="keyword">.</span><span class="string">'}' </span><span class="keyword">: </span><span class="string">'['</span><span class="keyword">.</span><span class="default">$res</span><span class="keyword">.</span><span class="string">']'</span><span class="keyword">;<br>}<br><br></span><span class="default">?&gt;<br></span><br>Example:<br>Array<br>(<br>&nbsp; &nbsp; [0] =&gt; 7<br>&nbsp; &nbsp; [1] =&gt; false<br>&nbsp; &nbsp; [2] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ['a'] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [3] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; true<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [2] =&gt; 6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [4] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; 'b'<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; null<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br>)<br>Result: [7,false,{"a":{"0":1,"1":2,"3":{"1":true,"2":6,"0":4},"4":["b",null]}}]<br><br>This function is more accurate and faster than, for example, that one:<br><a rel="nofollow" target="_blank">http://www.php.net/manual/ru/function.json-encode.php#89908</a><br>(RU: эта функция работает более точно и быстрее, чем указанная выше).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113495">  
  <a class="name">
  <strong class="user"><em>drdamour</em></strong></a><div class="date" title="2013-10-18 11:05"><strong>10 months ago</strong></div>
  <div class="text" id="Hcom113495">
<div class="phpcode"><code><span class="html">
note that although PHP bundles JSON, some linux distributions do not do to a licensing conflict.&nbsp; As such you may need to install json support yourself.<br><br>IE: on Ubuntu 13.10 Saucy Salamander apt-get install php5-json re-enables json support (json_encode and json_decode)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77367">  
  <a class="name">
  <strong class="user"><em>dennispopel(at)gmail.com</em></strong></a><div class="date" title="2007-08-26 10:43"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom77367">
<div class="phpcode"><code><span class="html">
Obviously, this function has trouble encoding arrays with empty string keys (''). I have just noticed that (because I was using a function in PHP under PHP4). When I switched to PHP5's json_encode, I noticed that browsers could not correctly parse the encoded data. More investigation maybe needed for a bug report, but this quick note may save somebody several hours.<br><br>Also, it manifests on Linux in 5.2.1 (tested on two boxes), on my XP with PHP5.2.3 json_encode() works just great! However, both 5.2.1 and 5.2.3 phpinfo()s show that the json version is 1.2.1 so might be Linux issue</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99837">  
  <a class="name">
  <strong class="user"><em>Dave - s10sys.com</em></strong></a><div class="date" title="2010-09-09 08:46"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom99837">
<div class="phpcode"><code><span class="html">
This may help others who are seeing null strings returned by json_encode().
<br>
<br>This function will encode all array values to utf8 so they are safe for json_encode();
<br>
<br>usage: 
<br>
<br><span class="default">&lt;?php
<br>json_encode</span><span class="keyword">(</span><span class="default">utf8json</span><span class="keyword">(</span><span class="default">$dataArray</span><span class="keyword">));
<br>
<br>function </span><span class="default">utf8json</span><span class="keyword">(</span><span class="default">$inArray</span><span class="keyword">) {
<br>
<br>&nbsp; &nbsp; static </span><span class="default">$depth </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="comment">/* our return object */
<br>&nbsp; &nbsp; </span><span class="default">$newArray </span><span class="keyword">= array();
<br>
<br>&nbsp; &nbsp; </span><span class="comment">/* safety recursion limit */
<br>&nbsp; &nbsp; </span><span class="default">$depth </span><span class="keyword">++;
<br>&nbsp; &nbsp; if(</span><span class="default">$depth </span><span class="keyword">&gt;= </span><span class="string">'30'</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; </span><span class="comment">/* step through inArray */
<br>&nbsp; &nbsp; </span><span class="keyword">foreach(</span><span class="default">$inArray </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/* recurse on array elements */
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newArray</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">utf8json</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/* encode string values */
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newArray</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; </span><span class="comment">/* return utf8 encoded array */
<br>&nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">$newArray</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>[NOTE BY danbrown AT php DOT net: Includes a bugfix by (robbiz233 AT hotmail DOT com) on 18-SEP-2010, to replace:
<br>&nbsp; &nbsp; $newArray[$key] = utf8json($inArray);
<br>with:
<br>&nbsp; &nbsp; $newArray[$key] = utf8json($val);"
<br>in the given function.]</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107968">  
  <a class="name">
  <strong class="user"><em>craig at craigfrancis dot co dot uk</em></strong></a><div class="date" title="2012-03-18 03:34"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107968">
<div class="phpcode"><code><span class="html">
If your on a version of PHP before 5.2, this might help:<br><br><span class="default">&lt;?php<br></span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'json_encode'</span><span class="keyword">)) {<br>&nbsp; &nbsp; function </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; switch (</span><span class="default">$type </span><span class="keyword">= </span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'NULL'</span><span class="keyword">:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="string">'null'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'boolean'</span><span class="keyword">:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return (</span><span class="default">$data </span><span class="keyword">? </span><span class="string">'true' </span><span class="keyword">: </span><span class="string">'false'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'integer'</span><span class="keyword">:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'double'</span><span class="keyword">:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'float'</span><span class="keyword">:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$data</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'string'</span><span class="keyword">:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="string">'"' </span><span class="keyword">. </span><span class="default">addslashes</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) . </span><span class="string">'"'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'object'</span><span class="keyword">:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'array'</span><span class="keyword">:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output_index_count </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output_indexed </span><span class="keyword">= array();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output_associative </span><span class="keyword">= array();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output_indexed</span><span class="keyword">[] = </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output_associative</span><span class="keyword">[] = </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) . </span><span class="string">':' </span><span class="keyword">. </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$output_index_count </span><span class="keyword">!== </span><span class="default">NULL </span><span class="keyword">&amp;&amp; </span><span class="default">$output_index_count</span><span class="keyword">++ !== </span><span class="default">$key</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output_index_count </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$output_index_count </span><span class="keyword">!== </span><span class="default">NULL</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="string">'[' </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">$output_indexed</span><span class="keyword">) . </span><span class="string">']'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="string">'{' </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">$output_associative</span><span class="keyword">) . </span><span class="string">'}'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="string">''</span><span class="keyword">; </span><span class="comment">// Not supported<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86513">  
  <a class="name">
  <strong class="user"><em>Garrett</em></strong></a><div class="date" title="2008-10-22 11:17"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom86513">
<div class="phpcode"><code><span class="html">
A note about json_encode automatically quoting numbers:<br><br>It appears that the json_encode function pays attention to the data type of the value. Let me explain what we came across:<br><br>We have found that when retrieving data from our database, there are occasions when numbers appear as strings to json_encode which results in double quotes around the values.<br><br>This can lead to problems within javascript functions expecting the values to be numeric.<br><br>This was discovered when were were retrieving fields from the database which contained serialized arrays. After unserializing them and sending them through the json_encode function the numeric values in the original array were now being treated as strings and showing up with double quotes around them.<br><br>The fix: Prior to encoding the array, send it to a function which checks for numeric types and casts accordingly. Encoding from then on worked as expected.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91434">  
  <a class="name">
  <strong class="user"><em>Istratov Vadim</em></strong></a><div class="date" title="2009-06-09 11:54"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91434">
<div class="phpcode"><code><span class="html">
Be careful with floating values in some locales (e.g. russian) with comma (",") as decimal point. Code:
<br>
<br><span class="default">&lt;?php
<br>setlocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">'ru_RU.utf8'</span><span class="keyword">);
<br>
<br></span><span class="default">$arr </span><span class="keyword">= array(</span><span class="string">'element' </span><span class="keyword">=&gt; </span><span class="default">12.34</span><span class="keyword">);
<br>echo </span><span class="default">json_encode</span><span class="keyword">( </span><span class="default">$arr </span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Output will be:
<br>--------------
<br>{"element":12,34}
<br>--------------
<br>
<br>Which is NOT a valid JSON markup. You should convert floating point variable to strings or set locale to something like "LC_NUMERIC, 'en_US.utf8'" before using json_encode.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106547">  
  <a class="name">
  <strong class="user"><em>me</em></strong></a><div class="date" title="2011-11-17 11:17"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom106547">
<div class="phpcode"><code><span class="html">
::fast utf8-encoding of strings::<br><br>json_encode( array_map( function($t){ return is_string($t) ? utf8_encode($t) : $t; }, $array ) )</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106417">  
  <a class="name">
  <strong class="user"><em>mmi at uhb-consulting dot de</em></strong></a><div class="date" title="2011-11-08 07:59"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom106417">
<div class="phpcode"><code><span class="html">
When you have trouble with json_encode and German umlauts. json_encode converts Strings to NULL when detecting umlauts not being UTF8encoded.
<br>
<br>Here's another recursive UTF8 conversion function and vice-versa. The object handling might be buggy but works for me.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">array_utf8_encode_recursive</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">) 
<br>&nbsp; &nbsp; &nbsp; &nbsp; { if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ovs</span><span class="keyword">= </span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new</span><span class="keyword">=</span><span class="default">$dat</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$ovs </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt;</span><span class="default">$v</span><span class="keyword">)&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new</span><span class="keyword">-&gt;</span><span class="default">$k</span><span class="keyword">=</span><span class="default">array_utf8_encode_recursive</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">-&gt;</span><span class="default">$k</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$new</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)) return </span><span class="default">$dat</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ret </span><span class="keyword">= array();
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$dat </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">=&gt;</span><span class="default">$d</span><span class="keyword">) </span><span class="default">$ret</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">array_utf8_encode_recursive</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$ret</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>function </span><span class="default">array_utf8_decode_recursive</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; { if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">utf8_decode</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ovs</span><span class="keyword">= </span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new</span><span class="keyword">=</span><span class="default">$dat</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$ovs </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt;</span><span class="default">$v</span><span class="keyword">)&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new</span><span class="keyword">-&gt;</span><span class="default">$k</span><span class="keyword">=</span><span class="default">array_utf8_decode_recursive</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">-&gt;</span><span class="default">$k</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$new</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$dat</span><span class="keyword">)) return </span><span class="default">$dat</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ret </span><span class="keyword">= array();
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$dat </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">=&gt;</span><span class="default">$d</span><span class="keyword">) </span><span class="default">$ret</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">array_utf8_decode_recursive</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$ret</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105923">  
  <a class="name">
  <strong class="user"><em>rob at weeverapps dot com</em></strong></a><div class="date" title="2011-09-25 09:15"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom105923">
<div class="phpcode"><code><span class="html">
If, for some reason you need to force a single object to be an array, you can use array_values() -- this can be necessary if you have an array with only one entry, as json_encode will assign it as an object otherwise :
<br>
<br><span class="default">&lt;?php
<br>$object</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = array(</span><span class="string">"foo" </span><span class="keyword">=&gt; </span><span class="string">"bar"</span><span class="keyword">, </span><span class="default">12 </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">);
<br>
<br></span><span class="default">$encoded_object </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>output:
<br>
<br>{"1": {"foo": "bar", "12": "true"}}
<br>
<br><span class="default">&lt;?php $encoded </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">)); </span><span class="default">?&gt;
<br></span>
<br>output:
<br>
<br>[{"foo": "bar", "12": "true"}]</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105386">  
  <a class="name">
  <strong class="user"><em>Tibor Halter</em></strong></a><div class="date" title="2011-08-13 05:21"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom105386">
<div class="phpcode"><code><span class="html">
json_encode($binary) problem: it results in an empty string "" without error.<br><br>You will see this happening when encoding binary images, for example.<br><br>Use utf8_encode first.<br><br><span class="default">&lt;?php<br><br>&nbsp; &nbsp; $data </span><span class="keyword">= </span><span class="string">'éáíúűóüöäÍÓ'</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">( </span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) );<br><br>&nbsp; &nbsp; </span><span class="comment">// [..]<br><br>&nbsp; &nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">utf8_decode</span><span class="keyword">( </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">$json</span><span class="keyword">) );<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104784">  
  <a class="name">
  <strong class="user"><em>Rijk van Wel</em></strong></a><div class="date" title="2011-07-07 02:18"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom104784">
<div class="phpcode"><code><span class="html">
The JSON_NUMERIC_CHECK flag introduced in 5.3.0 comes in very handy when handling numbers encapsulated in a string (database results and post requests are always encoded as string types, for example). Sending over variables from a database result directly (as string) would cause the json_encode() function to quote them, which in turn would make the Javascript store them as strings. As Javascript isn't loosely typed, some libraries could break on this, when attempting to use one of those variables as row id in a data store for instance. Using the aforementioned flag can prevent this from happening.<br><br><span class="default">&lt;?php<br>$arr </span><span class="keyword">= array( </span><span class="string">'row_id' </span><span class="keyword">=&gt; </span><span class="string">'1'</span><span class="keyword">, </span><span class="string">'name' </span><span class="keyword">=&gt; </span><span class="string">'George' </span><span class="keyword">); </span><span class="comment">// fictional db result<br></span><span class="keyword">echo </span><span class="default">json_encode</span><span class="keyword">( </span><span class="default">$arr</span><span class="keyword">, </span><span class="default">JSON_NUMERIC_CHECK </span><span class="keyword">); </span><span class="comment">// {"row_id":1,"name":"George"}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100835">  
  <a class="name">
  <strong class="user"><em>boukeversteegh at gmail dot com</em></strong></a><div class="date" title="2010-11-10 06:02"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100835">
<div class="phpcode"><code><span class="html">
For users of php 5.1.6 or lower, a native json_encode function. This version handles objects, and makes proper distinction between [lists] and {associative arrays}, mixed arrays work as well. It can handle newlines and quotes in both keys and data. 
<br>
<br>This function will convert non-ascii symbols to "\uXXXX" format as does json_encode. 
<br>
<br>Besides that, it outputs exactly the same string as json_encode. Including UTF-8 encoded 2-, 3- and 4-byte characters. It is a bit faster than PEAR/JSON::encode, but still slow compared to php 5.3's json_encode. It encodes any variable type exactly as the original.
<br>
<br>Relative speeds:
<br>PHP json_encode: 1x
<br>__json_encode: 31x
<br>PEAR/JSON: 46x
<br>
<br>NOTE: I assume the input will be valid UTF-8. I don't know what happens if your data contains illegal Unicode sequences. I tried to make the code fast and compact.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">__json_encode</span><span class="keyword">( </span><span class="default">$data </span><span class="keyword">) {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; if( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) || </span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) ) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$islist </span><span class="keyword">= </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) &amp;&amp; ( empty(</span><span class="default">$data</span><span class="keyword">) || </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) === </span><span class="default">range</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">count</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">) );
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; if( </span><span class="default">$islist </span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">= </span><span class="string">'[' </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'__json_encode'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">) ) . </span><span class="string">']'</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$items </span><span class="keyword">= Array();
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach( </span><span class="default">$data </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$items</span><span class="keyword">[] = </span><span class="default">__json_encode</span><span class="keyword">(</span><span class="string">"</span><span class="default">$key</span><span class="string">"</span><span class="keyword">) . </span><span class="string">':' </span><span class="keyword">. </span><span class="default">__json_encode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">= </span><span class="string">'{' </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">$items</span><span class="keyword">) . </span><span class="string">'}'</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; } elseif( </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) ) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># Escape non-printable or Non-ASCII characters.
<br>&nbsp; &nbsp; &nbsp; &nbsp; # I also put the \\ character first, as suggested in comments on the 'addclashes' page.
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="string">'"' </span><span class="keyword">. </span><span class="default">addcslashes</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="string">"\\\"\n\r\t/" </span><span class="keyword">. </span><span class="default">chr</span><span class="keyword">(</span><span class="default">8</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">12</span><span class="keyword">)) . </span><span class="string">'"'</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json&nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$len&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># Convert UTF-8 to Hexadecimal Codepoints.
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">for( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++ ) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">$string</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$c1 </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># Single byte;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if( </span><span class="default">$c1 </span><span class="keyword">&lt;</span><span class="default">128 </span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">.= (</span><span class="default">$c1 </span><span class="keyword">&gt; </span><span class="default">31</span><span class="keyword">) ? </span><span class="default">$char </span><span class="keyword">: </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"\\u%04x"</span><span class="keyword">, </span><span class="default">$c1</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># Double byte
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$c2 </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">[++</span><span class="default">$i</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( (</span><span class="default">$c1 </span><span class="keyword">&amp; </span><span class="default">32</span><span class="keyword">) === </span><span class="default">0 </span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">.= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"\\u%04x"</span><span class="keyword">, (</span><span class="default">$c1 </span><span class="keyword">- </span><span class="default">192</span><span class="keyword">) * </span><span class="default">64 </span><span class="keyword">+ </span><span class="default">$c2 </span><span class="keyword">- </span><span class="default">128</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># Triple
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$c3 </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">[++</span><span class="default">$i</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( (</span><span class="default">$c1 </span><span class="keyword">&amp; </span><span class="default">16</span><span class="keyword">) === </span><span class="default">0 </span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">.= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"\\u%04x"</span><span class="keyword">, ((</span><span class="default">$c1 </span><span class="keyword">- </span><span class="default">224</span><span class="keyword">) &lt;&lt;</span><span class="default">12</span><span class="keyword">) + ((</span><span class="default">$c2 </span><span class="keyword">- </span><span class="default">128</span><span class="keyword">) &lt;&lt; </span><span class="default">6</span><span class="keyword">) + (</span><span class="default">$c3 </span><span class="keyword">- </span><span class="default">128</span><span class="keyword">));
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># Quadruple
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$c4 </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">[++</span><span class="default">$i</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( (</span><span class="default">$c1 </span><span class="keyword">&amp; </span><span class="default">8 </span><span class="keyword">) === </span><span class="default">0 </span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$u </span><span class="keyword">= ((</span><span class="default">$c1 </span><span class="keyword">&amp; </span><span class="default">15</span><span class="keyword">) &lt;&lt; </span><span class="default">2</span><span class="keyword">) + ((</span><span class="default">$c2</span><span class="keyword">&gt;&gt;</span><span class="default">4</span><span class="keyword">) &amp; </span><span class="default">3</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$w1 </span><span class="keyword">= (</span><span class="default">54</span><span class="keyword">&lt;&lt;</span><span class="default">10</span><span class="keyword">) + (</span><span class="default">$u</span><span class="keyword">&lt;&lt;</span><span class="default">6</span><span class="keyword">) + ((</span><span class="default">$c2 </span><span class="keyword">&amp; </span><span class="default">15</span><span class="keyword">) &lt;&lt; </span><span class="default">2</span><span class="keyword">) + ((</span><span class="default">$c3</span><span class="keyword">&gt;&gt;</span><span class="default">4</span><span class="keyword">) &amp; </span><span class="default">3</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$w2 </span><span class="keyword">= (</span><span class="default">55</span><span class="keyword">&lt;&lt;</span><span class="default">10</span><span class="keyword">) + ((</span><span class="default">$c3 </span><span class="keyword">&amp; </span><span class="default">15</span><span class="keyword">)&lt;&lt;</span><span class="default">6</span><span class="keyword">) + (</span><span class="default">$c4</span><span class="keyword">-</span><span class="default">128</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">.= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"\\u%04x\\u%04x"</span><span class="keyword">, </span><span class="default">$w1</span><span class="keyword">, </span><span class="default">$w2</span><span class="keyword">); 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; } else {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># int, floats, bools, null
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">var_export</span><span class="keyword">( </span><span class="default">$data</span><span class="keyword">, </span><span class="default">true </span><span class="keyword">));
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; return </span><span class="default">$json</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>[EDIT BY danbrown AT php DOT net: Contains a bugfix by the original poster on 08-DEC-2010 with the following message: "I discovered a rather bad bug in my __json_encode function below. On versions prior to php 5.2.5, all 'f' characters are escaped to '\f'. This is because addcslashes in php &lt; 5.2 doesn't understand \f as 'formfeed'."]</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100265">  
  <a class="name">
  <strong class="user"><em>matt dot parlane at gmail dot com</em></strong></a><div class="date" title="2010-10-05 12:05"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100265">
<div class="phpcode"><code><span class="html">
To save some space, at the risk of it being illegal JSON, strictly speaking:<br><br><span class="default">&lt;?php<br>$json </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/"([a-zA-Z]+[a-zA-Z0-9]*)":/'</span><span class="keyword">, </span><span class="string">'$1:'</span><span class="keyword">, </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$whatever</span><span class="keyword">));<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99457">  
  <a class="name">
  <strong class="user"><em>nicolas dot baptiste at gmail dot com</em></strong></a><div class="date" title="2010-08-18 08:49"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom99457">
<div class="phpcode"><code><span class="html">
Beware of index arrays :<br><br><span class="default">&lt;?php<br></span><span class="keyword">echo </span><span class="default">json_encode</span><span class="keyword">(array(</span><span class="string">"test"</span><span class="keyword">,</span><span class="string">"test"</span><span class="keyword">,</span><span class="string">"test"</span><span class="keyword">));<br>echo </span><span class="default">json_encode</span><span class="keyword">(array(</span><span class="default">0</span><span class="keyword">=&gt;</span><span class="string">"test"</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">=&gt;</span><span class="string">"test"</span><span class="keyword">,</span><span class="default">7</span><span class="keyword">=&gt;</span><span class="string">"test"</span><span class="keyword">));<br></span><span class="default">?&gt;<br></span><br>Will give :<br><br>["test","test","test"]<br>{"0":"test","3":"test","7":"test"}<br><br>arrays are returned only if you don't define index.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99264">  
  <a class="name">
  <strong class="user"><em>gansbrest</em></strong></a><div class="date" title="2010-08-06 12:42"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom99264">
<div class="phpcode"><code><span class="html">
If you have problems with quotes when encoding numeric data retrieved from the database, you can just cast that value to integer and there will be no quotes:
<br>
<br><span class="default">&lt;?php
<br>$testArr</span><span class="keyword">[</span><span class="string">'key'</span><span class="keyword">] = </span><span class="string">'1'</span><span class="keyword">;
<br>print </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$testArr</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>===&gt; {"key":"1"}
<br>
<br><span class="default">&lt;?php
<br>$testArr</span><span class="keyword">[</span><span class="string">'key'</span><span class="keyword">] = (int)</span><span class="string">'1'</span><span class="keyword">;
<br>print </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$testArr</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>===&gt; {"key":1}
<br>
<br>Don't forget that you have to deal with numbers, otherwise your string will be converted to 0.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98718">  
  <a class="name">
  <strong class="user"><em>mic dot sumner at gmail dot com</em></strong></a><div class="date" title="2010-07-02 06:39"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98718">
<div class="phpcode"><code><span class="html">
Hey everyone,<br><br>In my application, I had objects that modeled database rows with a few one to many relationships, so one object may have an array of other objects.<br><br>I wanted to make the object properties private and use getters and setters, but I needed them to be serializable to json without losing the private variables. (I wanted to promote good coding practices but I needed the properties on the client side.) Because of this, I needed to encode not only the normal private properties but also properties that were arrays of other model objects. I looked for awhile with no luck, so I coded my own:<br><br>You can place these methods in each of your classes, or put them in a base class, as I've done. (But note that for this to work, the children classes must declare their properties as protected so the parent class has access)<br><br><span class="default">&lt;?php<br></span><span class="keyword">abstract class </span><span class="default">Model </span><span class="keyword">{<br>&nbsp;&nbsp; <br>&nbsp;&nbsp; public function </span><span class="default">toArray</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">processArray</span><span class="keyword">(</span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">));<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; private function </span><span class="default">processArray</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">-&gt;</span><span class="default">toArray</span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">processArray</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// If the property isn't an object or array, leave it untouched<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">$array</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; public function </span><span class="default">__toString</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">toArray</span><span class="keyword">());<br>&nbsp; &nbsp; }<br>&nbsp;&nbsp; <br>}<br></span><span class="default">?&gt;<br></span><br>Externally, you can just call<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="keyword">echo </span><span class="default">$theObject</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="comment">//or<br>&nbsp; &nbsp; </span><span class="keyword">echo </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$theObject</span><span class="keyword">-&gt;</span><span class="default">toArray</span><span class="keyword">());<br></span><span class="default">?&gt;<br></span><br>And you'll get the json for that object. Hope this helps someone!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115234">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2014-06-17 08:17"><strong>2 months ago</strong></div>
  <div class="text" id="Hcom115234">
<div class="phpcode"><code><span class="html">
Encoding arrays. some considerations:<br>I did this using a terminal.<br><br>php&gt; echo json_encode([])<br>[]<br><br>php&gt; echo json_encode([], JSON_FORCE_OBJECT)<br>{}<br><br>php&gt; echo json_encode([1,2])<br>[1,2]<br><br>php&gt; echo json_encode([1=&gt;1,2=&gt;2])<br>{"1":1,"2":2}<br><br>php&gt; echo json_encode([1, 2], JSON_FORCE_OBJECT)<br>{"0":1,"1":2}<br><br>php&gt; $data = [];<br>php&gt; $data_ = empty($data) ? (object) null : $data;<br>php&gt; echo json_encode($data_)<br>{}<br><br>php&gt; $data = [1];<br>php&gt; $data_ = empty($data) ? (object) null : $data;<br>php&gt; echo json_encode($data_)<br>[1]</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115134">  
  <a class="name">
  <strong class="user"><em>Joe P</em></strong></a><div class="date" title="2014-06-01 11:48"><strong>2 months ago</strong></div>
  <div class="text" id="Hcom115134">
<div class="phpcode"><code><span class="html">
&gt; Note:<br>&gt; PHP implements a superset of JSON - it will also encode and<br>&gt; decode scalar types and NULL. The JSON standard only supports<br>&gt; these values when they are nested inside an array or an object.<br><br>This is patently false. Nowhere in the standard does it say that only objects or arrays may be represented. The standard lays out what a value consists of and any value type is legal. Interpreters on other platforms which don't allow scalar types are incorrectly (and probably terribly) coded.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114465">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2014-02-23 07:22"><strong>6 months ago</strong></div>
  <div class="text" id="Hcom114465">
<div class="phpcode"><code><span class="html">
To use json_encode with javascript function I use : <br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">__json_encode</span><span class="keyword">(</span><span class="default">$mVar</span><span class="keyword">) {<br>&nbsp; &nbsp; return </span><span class="default">preg_replace_callback</span><span class="keyword">(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'#"[ ]{0,}function[ ]{0,}\([^)$]{0,}\)[ ]{0,}\{[ ]{0,}(?(?![ ]{0,}}[ ]{0,}").){0,}[ ]{0,}\}[ ]{0,}"#si'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; function (</span><span class="default">$aRes</span><span class="keyword">) { <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">1</span><span class="keyword">),</span><span class="default">$sOut</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$iOpen</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$iClose</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) &amp;&amp; </span><span class="default">$sOut</span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++) <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">) == </span><span class="string">"{"</span><span class="keyword">) </span><span class="default">$iOpen</span><span class="keyword">++;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">) == </span><span class="string">"}" </span><span class="keyword">AND </span><span class="default">$iOpen </span><span class="keyword">== ++</span><span class="default">$iClose</span><span class="keyword">) break;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">stripcslashes</span><span class="keyword">(</span><span class="default">$sOut</span><span class="keyword">); <br>&nbsp; &nbsp; &nbsp; &nbsp; },<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$mVar</span><span class="keyword">)<br>&nbsp; &nbsp; );<br>}<br>&nbsp; &nbsp; <br><br></span><span class="default">$aData </span><span class="keyword">= array( <br>&nbsp; &nbsp; </span><span class="string">'key1' </span><span class="keyword">=&gt; </span><span class="string">'value1'</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'key2' </span><span class="keyword">=&gt; </span><span class="string">'function(){ return $("&lt;INPUT /&gt;").attr("type","text"); }'</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'key3' </span><span class="keyword">=&gt; array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'key3.1'</span><span class="keyword">=&gt;</span><span class="string">'val3.1'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'key3.2'</span><span class="keyword">=&gt;</span><span class="string">'function(someArg) { if (someArg == "someValue") return true; else { document.write("error"); return false; } }'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; ),<br>&nbsp; &nbsp; </span><span class="string">'key4' </span><span class="keyword">=&gt; </span><span class="string">'function(){ return true; }'<br></span><span class="keyword">);<br><br></span><span class="default">$sData </span><span class="keyword">= </span><span class="string">'function(someArg) { if (someArg == "someValue") return true; else { document.write("error"); return false; } }'</span><span class="keyword">;<br><br>echo&nbsp; </span><span class="string">'Output for json_encode() : '</span><span class="keyword">.</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$aData</span><span class="keyword">).</span><span class="string">"\n\n"</span><span class="keyword">;<br>echo&nbsp; </span><span class="string">'Output for __json_encode() : '</span><span class="keyword">.</span><span class="default">__json_encode</span><span class="keyword">(</span><span class="default">$aData</span><span class="keyword">).</span><span class="string">"\n\n"</span><span class="keyword">;<br>echo&nbsp; </span><span class="string">'Output for json_encode($sData) : '</span><span class="keyword">.</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$sData</span><span class="keyword">).</span><span class="string">"\n\n"</span><span class="keyword">;<br>echo&nbsp; </span><span class="string">'Output for __json_encode($sData) : '</span><span class="keyword">.</span><span class="default">__json_encode</span><span class="keyword">(</span><span class="default">$sData</span><span class="keyword">).</span><span class="string">"\n\n"</span><span class="keyword">;<br><br></span><span class="comment">/*<br><br>Output for json_encode : {"key1":"value1","key2":"function(){ return $(\"&lt;INPUT \/&gt;\").attr(\"type\",\"text\"); }","key3":{"key3.1":"val3.1","key3.2":"function(someArg) { if (someArg == \"someValue\") return true; else { document.write(\"error\"); return false; } }"},"key4":"function(){ return true; }"}<br><br>Output for __json_encode : {"key1":"value1","key2":function(){ return $("&lt;INPUT /&gt;").attr("type","text"); },"key3":{"key3.1":"val3.1","key3.2":function(someArg) { if (someArg == "someValue") return true; else { document.write("error"); return false; } }},"key4":function(){ return true; }}<br><br>*/</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96248">  
  <a class="name">
  <strong class="user"><em>5hunter5 at mail dot ru</em></strong></a><div class="date" title="2010-02-17 03:03"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96248">
<div class="phpcode"><code><span class="html">
If I want to encode object whith all it's private and protected properties, then I implements that methods in my object:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">public function </span><span class="default">encodeJSON</span><span class="keyword">()
<br>{
<br>&nbsp; &nbsp; foreach (</span><span class="default">$this </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json</span><span class="keyword">-&gt;</span><span class="default">$key </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; return </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$json</span><span class="keyword">);
<br>}
<br>public function </span><span class="default">decodeJSON</span><span class="keyword">(</span><span class="default">$json_str</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">$json_str</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br>&nbsp; &nbsp; foreach (</span><span class="default">$json </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">$key </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>Or you may extend your class from base class, wich is implements that methods.
<br>
<br>Found that much more simple than regular expressions with PHP serialized objects...</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95805">  
  <a class="name">
  <strong class="user"><em>olivier dot pons dot no dot spam at gmail dot com</em></strong></a><div class="date" title="2010-01-22 07:13"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95805">
<div class="phpcode"><code><span class="html">
Be careful about one thing:
<br>With a string key Php will consider it's an object:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">echo </span><span class="default">json_encode</span><span class="keyword">(array(</span><span class="string">'id'</span><span class="keyword">=&gt;</span><span class="string">'testtext'</span><span class="keyword">));
<br>echo </span><span class="default">json_encode</span><span class="keyword">(array(</span><span class="string">'testtext'</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>Will give:
<br>
<br>{"id":"testtext"}
<br>["testtext"]
<br>
<br>Beware of the string keys!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95667">  
  <a class="name">
  <strong class="user"><em>garydavis at gmail dot com</em></strong></a><div class="date" title="2010-01-14 07:38"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95667">
<div class="phpcode"><code><span class="html">
If you are planning on using this function to serve a json file, it's important to note that the json generated by this function is not ready to be consumed by javascript until you wrap it in parens and add ";" to the end. <br><br>It took me a while to figure this out so I thought I'd save others the aggravation.<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; header</span><span class="keyword">(</span><span class="string">'Content-Type: text/javascript; charset=utf8'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Access-Control-Allow-Origin: <a rel="nofollow" target="_blank">http://www.example.com/</a>'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Access-Control-Max-Age: 3628800'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Access-Control-Allow-Methods: GET, POST, PUT, DELETE'</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="default">$file</span><span class="keyword">=</span><span class="string">'rss.xml'</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$arr </span><span class="keyword">= </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);</span><span class="comment">//this creates an object from the xml file<br>&nbsp; &nbsp; </span><span class="default">$json</span><span class="keyword">= </span><span class="string">'('</span><span class="keyword">.</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">).</span><span class="string">');'</span><span class="keyword">; </span><span class="comment">//must wrap in parens and end with semicolon<br>&nbsp; &nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'callback'</span><span class="keyword">].</span><span class="default">$json</span><span class="keyword">); </span><span class="comment">//callback is prepended for json-p<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="94359">  
  <a class="name">
  <strong class="user"><em>rlz_ar at yahoo dot com</em></strong></a><div class="date" title="2009-10-29 08:35"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom94359">
<div class="phpcode"><code><span class="html">
If you have problems with json_encode() on arrays, you can force json_encode() to encode as object, and then use json_decode() casting the result as array:<br><br><span class="default">&lt;?php<br><br>$myarray </span><span class="keyword">= Array(</span><span class="string">'isa'</span><span class="keyword">, </span><span class="string">'dalawa'</span><span class="keyword">, </span><span class="string">'tatlo'</span><span class="keyword">);<br><br>unset(</span><span class="default">$myarray</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br><br></span><span class="default">$json_encoded_array </span><span class="keyword">= </span><span class="default">json_encode </span><span class="keyword">( </span><span class="default">$myarray</span><span class="keyword">, </span><span class="default">JSON_FORCE_OBJECT </span><span class="keyword">);<br><br></span><span class="comment">// do whatever you want with your data<br>// then you can retrive the data doing:<br><br></span><span class="default">$myarray </span><span class="keyword">= (array) </span><span class="default">json_decode </span><span class="keyword">( </span><span class="default">$json_encoded_array </span><span class="keyword">);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113037">  
  <a class="name">
  <strong class="user"><em>kvz at php dot net</em></strong></a><div class="date" title="2013-08-21 09:40"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom113037">
<div class="phpcode"><code><span class="html">
json_encode "only works with UTF-8 encoded data." so if there is any chance that users influence the variable you're about to encode to json, you should first recursively encode to UTF-8.<br><br>There are several comments doing that, but some only traverse the input array 1 level deep. Others write full fledged recursive functions themselves. Whereas as of PHP5 you could also utilize array_walk_recursive<br><br><span class="default">&lt;?php<br>array_walk_recursive</span><span class="keyword">(</span><span class="default">$inputArray</span><span class="keyword">, function(&amp;</span><span class="default">$val</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br>});<br></span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$inputArray</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Hope this helps</span>
</code></div>
  </div>
 </div>
  <div class="note" id="92817">  
  <a class="name">
  <strong class="user"><em>http://mike.eire.ca/</em></strong></a><div class="date" title="2009-08-10 01:54"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom92817">
<div class="phpcode"><code><span class="html">
Note that this function does not always produce legal JSON.<br><br><span class="default">&lt;?php<br>$json </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">);<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$json</span><span class="keyword">);<br></span><span class="comment">//string(5) ""foo""<br><br></span><span class="default">$json </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">23</span><span class="keyword">);<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$json</span><span class="keyword">);<br></span><span class="comment">//string(2) "23"<br></span><span class="default">?&gt;<br></span><br>According to the JSON spec, only objects and arrays can be represented; the JSON_FORCE_OBJECT flag available since PHP 5.3 does not change this behaviour. If you're using this to produce JSON that will be exchanged with other systems, adjust your output accordingly.<br><br><span class="default">&lt;?php<br>$json </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/^([^[{].*)$/'</span><span class="keyword">, </span><span class="string">'[$1]'</span><span class="keyword">, </span><span class="default">$json</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>The json_decode function accepts these JSON fragments without complaint.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111788">  
  <a class="name">
  <strong class="user"><em>ck at ergovia dot de</em></strong></a><div class="date" title="2013-03-28 11:40"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111788">
<div class="phpcode"><code><span class="html">
Attention when passing a plain array to json_encode and using JSON_FORCE_OBJECT. It figured out that the index-order of the resulting JSON-string depends on the system PHP is running on.<br><br>$a = array("a" , "b", "c");<br>echo json_encode($a, JSON_FORCE_OBJECT);<br><br>On Xampp (Windows) you get:<br><br>{"0":"a","1":"b","2":"c"}';<br><br>On a machine running debian I get:<br><br>{"2":"a","1":"b","0":"c"}';<br><br>Note that the key:value pairs are different!<br><br>Solution here was to use array_combine to create a ssociative array and then pass it to json_encode:<br><br>json_encode(array_combine(range(0, count($a) - 1), $a), JSON_FORCE_OBJECT);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88790">  
  <a class="name">
  <strong class="user"><em>aangel at spam dot com</em></strong></a><div class="date" title="2009-02-07 05:50"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88790">
<div class="phpcode"><code><span class="html">
Here is a bit more on creating an iterator to get at those pesky private/protected variables:<br><br><span class="default">&lt;?php <br>&nbsp;&nbsp; </span><span class="keyword">class </span><span class="default">Kit </span><span class="keyword">implements </span><span class="default">IteratorAggregate </span><span class="keyword">{<br><br>&nbsp; &nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// if passed an object, we are cloning<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">kitID </span><span class="keyword">= </span><span class="default">$var</span><span class="keyword">-&gt;</span><span class="default">kitID</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">kitName </span><span class="keyword">= </span><span class="default">$var</span><span class="keyword">-&gt;</span><span class="default">kitName</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$var</span><span class="keyword">-&gt;</span><span class="default">productArray </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">productArray</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = (array)</span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp;&nbsp; ...<br>&nbsp; &nbsp; </span><span class="comment">// Create an iterator because private/protected vars can't<br>&nbsp; &nbsp; // be seen by json_encode().<br>&nbsp; &nbsp; </span><span class="keyword">public function </span><span class="default">getIterator</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$iArray</span><span class="keyword">[</span><span class="string">'kitID'</span><span class="keyword">] = </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">kitID</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$iArray</span><span class="keyword">[</span><span class="string">'kitName'</span><span class="keyword">] = </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">kitName</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$iArray</span><span class="keyword">[</span><span class="string">'productArray'</span><span class="keyword">] = (array)</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">productArray</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; return new </span><span class="default">ArrayIterator</span><span class="keyword">(</span><span class="default">$iArray</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">?&gt;</span> <br><br>Calling something like&nbsp; $t = json_encode($this-&gt;getIterator());&nbsp; will give you almost what you want:<br><span class="default">&lt;?php <br></span><span class="keyword">{</span><span class="string">"kitID"</span><span class="keyword">:</span><span class="string">"Kit_Essentials-Books.txt"</span><span class="keyword">,<br></span><span class="string">"kitName"</span><span class="keyword">:</span><span class="string">"Essential Books"</span><span class="keyword">,<br></span><span class="string">"productArray"</span><span class="keyword">:{</span><span class="string">"0470043601"</span><span class="keyword">:{</span><span class="string">"Category"</span><span class="keyword">:</span><span class="string">"Food"</span><span class="keyword">,</span><span class="string">"ASIN"</span><span class="keyword">:</span><span class="string">"0470043601"</span><span class="keyword">} } } <br></span><span class="default">?&gt;<br></span><br>Notice that the productArray is converted to an object ignoring the cast I put in front, which is not what I wanted. I haven't figured out how to make sure that encodes as an array.<br><br>Regardless, bringing that JSON back into an object using json_decode() will give you just a std object, and the only way I've found to get it into the proper object type is to use a constructor that instantiates the object the way it's supposed to be (see __construct($var) above). Like this:<br><span class="default">&lt;?php <br><br>&nbsp; &nbsp; &nbsp; &nbsp; $newKit </span><span class="keyword">= new </span><span class="default">Kit</span><span class="keyword">(</span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">$t</span><span class="keyword">));<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="80339">  
  <a class="name">
  <strong class="user"><em>umbrae at gmail dot com</em></strong></a><div class="date" title="2008-01-10 10:21"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80339">
<div class="phpcode"><code><span class="html">
Here's a quick function to pretty-print some JSON. Optimizations welcome, as this was a 10-minute dealie without efficiency in mind:
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">// Pretty print some JSON
<br></span><span class="keyword">function </span><span class="default">json_format</span><span class="keyword">(</span><span class="default">$json</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; </span><span class="default">$tab </span><span class="keyword">= </span><span class="string">"&nbsp; "</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$new_json </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$indent_level </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$in_string </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="default">$json_obj </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">$json</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; if(</span><span class="default">$json_obj </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>
<br>&nbsp; &nbsp; </span><span class="default">$json </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$json_obj</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$json</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; for(</span><span class="default">$c </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$c </span><span class="keyword">&lt; </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$c</span><span class="keyword">++)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">$json</span><span class="keyword">[</span><span class="default">$c</span><span class="keyword">];
<br>&nbsp; &nbsp; &nbsp; &nbsp; switch(</span><span class="default">$char</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'{'</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'['</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">$in_string</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_json </span><span class="keyword">.= </span><span class="default">$char </span><span class="keyword">. </span><span class="string">"\n" </span><span class="keyword">. </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="default">$tab</span><span class="keyword">, </span><span class="default">$indent_level</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$indent_level</span><span class="keyword">++;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_json </span><span class="keyword">.= </span><span class="default">$char</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'}'</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">']'</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">$in_string</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$indent_level</span><span class="keyword">--;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_json </span><span class="keyword">.= </span><span class="string">"\n" </span><span class="keyword">. </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="default">$tab</span><span class="keyword">, </span><span class="default">$indent_level</span><span class="keyword">) . </span><span class="default">$char</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_json </span><span class="keyword">.= </span><span class="default">$char</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">','</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">$in_string</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_json </span><span class="keyword">.= </span><span class="string">",\n" </span><span class="keyword">. </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="default">$tab</span><span class="keyword">, </span><span class="default">$indent_level</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_json </span><span class="keyword">.= </span><span class="default">$char</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">':'</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">$in_string</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_json </span><span class="keyword">.= </span><span class="string">": "</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_json </span><span class="keyword">.= </span><span class="default">$char</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">'"'</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$c </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">$json</span><span class="keyword">[</span><span class="default">$c</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">] != </span><span class="string">'\\'</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$in_string </span><span class="keyword">= !</span><span class="default">$in_string</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$new_json </span><span class="keyword">.= </span><span class="default">$char</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; return </span><span class="default">$new_json</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78719">  
  <a class="name">
  <strong class="user"><em>jjoss</em></strong></a><div class="date" title="2007-10-24 12:07"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78719">
<div class="phpcode"><code><span class="html">
Another way to work with Russian characters. This procedure just handles Cyrillic characters without UTF conversion. Thanks to JsHttpRequest developers.<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">php2js</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">)<br>{<br>&nbsp; if (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">)) return </span><span class="string">'null'</span><span class="keyword">;<br>&nbsp; if (</span><span class="default">$a </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) return </span><span class="string">'false'</span><span class="keyword">;<br>&nbsp; if (</span><span class="default">$a </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) return </span><span class="string">'true'</span><span class="keyword">;<br>&nbsp; if (</span><span class="default">is_scalar</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">))<br>&nbsp; {<br>&nbsp; &nbsp; if (</span><span class="default">is_float</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; </span><span class="comment">// Always use "." for floats.<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$a </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">","</span><span class="keyword">, </span><span class="string">"."</span><span class="keyword">, </span><span class="default">strval</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">));<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="comment">// All scalars are converted to strings to avoid indeterminism.<br>&nbsp; &nbsp; // PHP's "1" and 1 are equal for all PHP operators, but<br>&nbsp; &nbsp; // JS's "1" and 1 are not. So if we pass "1" or 1 from the PHP backend,<br>&nbsp; &nbsp; // we should get the same result in the JS frontend (string).<br>&nbsp; &nbsp; // Character replacements for JSON.<br>&nbsp; &nbsp; </span><span class="keyword">static </span><span class="default">$jsonReplaces </span><span class="keyword">= array(array(</span><span class="string">"\\"</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">, </span><span class="string">"\t"</span><span class="keyword">, </span><span class="string">"\r"</span><span class="keyword">, </span><span class="string">"\b"</span><span class="keyword">, </span><span class="string">"\f"</span><span class="keyword">, </span><span class="string">'"'</span><span class="keyword">),<br>&nbsp; &nbsp; array(</span><span class="string">'\\\\'</span><span class="keyword">, </span><span class="string">'\\/'</span><span class="keyword">, </span><span class="string">'\\n'</span><span class="keyword">, </span><span class="string">'\\t'</span><span class="keyword">, </span><span class="string">'\\r'</span><span class="keyword">, </span><span class="string">'\\b'</span><span class="keyword">, </span><span class="string">'\\f'</span><span class="keyword">, </span><span class="string">'\"'</span><span class="keyword">));<br>&nbsp; &nbsp; return </span><span class="string">'"' </span><span class="keyword">. </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$jsonReplaces</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$jsonReplaces</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$a</span><span class="keyword">) . </span><span class="string">'"'</span><span class="keyword">;<br>&nbsp; }<br>&nbsp; </span><span class="default">$isList </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br>&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++, </span><span class="default">next</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">))<br>&nbsp; {<br>&nbsp; &nbsp; if (</span><span class="default">key</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">) !== </span><span class="default">$i</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$isList </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; }<br>&nbsp; }<br>&nbsp; </span><span class="default">$result </span><span class="keyword">= array();<br>&nbsp; if (</span><span class="default">$isList</span><span class="keyword">)<br>&nbsp; {<br>&nbsp; &nbsp; foreach (</span><span class="default">$a </span><span class="keyword">as </span><span class="default">$v</span><span class="keyword">) </span><span class="default">$result</span><span class="keyword">[] = </span><span class="default">php2js</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="string">'[ ' </span><span class="keyword">. </span><span class="default">join</span><span class="keyword">(</span><span class="string">', '</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">) . </span><span class="string">' ]'</span><span class="keyword">;<br>&nbsp; }<br>&nbsp; else<br>&nbsp; {<br>&nbsp; &nbsp; foreach (</span><span class="default">$a </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) </span><span class="default">$result</span><span class="keyword">[] = </span><span class="default">php2js</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">).</span><span class="string">': '</span><span class="keyword">.</span><span class="default">php2js</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="string">'{ ' </span><span class="keyword">. </span><span class="default">join</span><span class="keyword">(</span><span class="string">', '</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">) . </span><span class="string">' }'</span><span class="keyword">;<br>&nbsp; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78688">  
  <a class="name">
  <strong class="user"><em>jfdsmit at gmail dot com</em></strong></a><div class="date" title="2007-10-23 07:31"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom78688">
<div class="phpcode"><code><span class="html">
json_encode also won't handle objects that do not directly expose their internals but through the Iterator interface. These two function will take care of that:<br><br><span class="default">&lt;?php<br><br></span><span class="comment">/**<br> * Convert an object into an associative array<br> *<br> * This function converts an object into an associative array by iterating<br> * over its public properties. Because this function uses the foreach<br> * construct, Iterators are respected. It also works on arrays of objects.<br> *<br> * @return array<br> */<br></span><span class="keyword">function </span><span class="default">object_to_array</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= array();<br>&nbsp; &nbsp; </span><span class="default">$references </span><span class="keyword">= array();<br><br>&nbsp; &nbsp; </span><span class="comment">// loop over elements/properties<br>&nbsp; &nbsp; </span><span class="keyword">foreach (</span><span class="default">$var </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// recursively convert objects<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) || </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// but prevent cycles<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$references</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">object_to_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$references</span><span class="keyword">[] = </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// simple values are untouched<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$result</span><span class="keyword">;<br>}<br><br></span><span class="comment">/**<br> * Convert a value to JSON<br> *<br> * This function returns a JSON representation of $param. It uses json_encode<br> * to accomplish this, but converts objects and arrays containing objects to<br> * associative arrays first. This way, objects that do not expose (all) their<br> * properties directly but only through an Iterator interface are also encoded<br> * correctly.<br> */<br></span><span class="keyword">function </span><span class="default">json_encode2</span><span class="keyword">(</span><span class="default">$param</span><span class="keyword">) {<br>&nbsp; &nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$param</span><span class="keyword">) || </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$param</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$param </span><span class="keyword">= </span><span class="default">object_to_array</span><span class="keyword">(</span><span class="default">$param</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$param</span><span class="keyword">);<br>}</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="74878">  
  <a class="name">
  <strong class="user"><em>Yi-Ren Chen at NCTU CSIE</em></strong></a><div class="date" title="2007-05-01 09:55"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom74878">
<div class="phpcode"><code><span class="html">
I write a function "php_json_encode" <br>for early version of php which support "multibyte" but doesn't support "json_encode".<br><span class="default">&lt;?php<br>&nbsp; </span><span class="keyword">function </span><span class="default">json_encode_string</span><span class="keyword">(</span><span class="default">$in_str</span><span class="keyword">)<br>&nbsp; {<br>&nbsp; &nbsp; </span><span class="default">mb_internal_encoding</span><span class="keyword">(</span><span class="string">"UTF-8"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$convmap </span><span class="keyword">= array(</span><span class="default">0x80</span><span class="keyword">, </span><span class="default">0xFFFF</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0xFFFF</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$in_str</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&gt;=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">--)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$mb_char </span><span class="keyword">= </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$in_str</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; if(</span><span class="default">mb_ereg</span><span class="keyword">(</span><span class="string">"&amp;#(\\d+);"</span><span class="keyword">, </span><span class="default">mb_encode_numericentity</span><span class="keyword">(</span><span class="default">$mb_char</span><span class="keyword">, </span><span class="default">$convmap</span><span class="keyword">, </span><span class="string">"UTF-8"</span><span class="keyword">), </span><span class="default">$match</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"\\u%04x"</span><span class="keyword">, </span><span class="default">$match</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) . </span><span class="default">$str</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">$mb_char </span><span class="keyword">. </span><span class="default">$str</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$str</span><span class="keyword">;<br>&nbsp; }<br>&nbsp; function </span><span class="default">php_json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">)<br>&nbsp; {<br>&nbsp; &nbsp; </span><span class="default">$json_str </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$pure_array </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$array_length </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$array_length</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)<br>&nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(! isset(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]))<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$pure_array </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; if(</span><span class="default">$pure_array</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json_str </span><span class="keyword">=</span><span class="string">"["</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$temp </span><span class="keyword">= array();<br>&nbsp; &nbsp; &nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$array_length</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$temp</span><span class="keyword">[] = </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%s"</span><span class="keyword">, </span><span class="default">php_json_encode</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]));<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json_str </span><span class="keyword">.= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">","</span><span class="keyword">,</span><span class="default">$temp</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json_str </span><span class="keyword">.=</span><span class="string">"]"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json_str </span><span class="keyword">=</span><span class="string">"{"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$temp </span><span class="keyword">= array();<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$temp</span><span class="keyword">[] = </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"\"%s\":%s"</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">php_json_encode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json_str </span><span class="keyword">.= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">","</span><span class="keyword">,</span><span class="default">$temp</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json_str </span><span class="keyword">.=</span><span class="string">"}"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; else<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; if(</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json_str </span><span class="keyword">= </span><span class="string">"\""</span><span class="keyword">. </span><span class="default">json_encode_string</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">) . </span><span class="string">"\""</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; else if(</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json_str </span><span class="keyword">= </span><span class="default">$arr</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$json_str </span><span class="keyword">= </span><span class="string">"\""</span><span class="keyword">. </span><span class="default">json_encode_string</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">) . </span><span class="string">"\""</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$json_str</span><span class="keyword">;<br>&nbsp; }</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100272">  
  <a class="name">
  <strong class="user"><em>tomas at matfyz dot cz</em></strong></a><div class="date" title="2010-10-05 07:43"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100272">
<div class="phpcode"><code><span class="html">
As json_encode() won't work with character sets other than UTF-8, this expression allows to encode strings for JSON regardless of the character set:
<br>
<br><span class="default">&lt;?php
<br>str_replace</span><span class="keyword">(</span><span class="string">"\0"</span><span class="keyword">, </span><span class="string">"\\u0000"</span><span class="keyword">, </span><span class="default">addcslashes</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="string">"\t\r\n\"\\"</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>You need to replace the nul character manually as addcslashes() won't do it right way. But BEWARE, this is only solution for common strings, other "unusual wild characters" like ESC, \b, \a etc. are not handled.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="94629">  
  <a class="name">
  <strong class="user"><em>me at daniel dot ie</em></strong></a><div class="date" title="2009-11-15 08:45"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom94629">
<div class="phpcode"><code><span class="html">
I had trouble putting the results of mysql_fetch_assoc() through json_encode: numbers being returned from the query were being quoted in the JSON output (i.e., they were being treated as strings). In order to fix this, it is necessary to explicitly cast each element of the array before json_encode() is called.<br><br>The following code uses metadata from a MySQL query result to do this casting.<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; $mysql </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">, </span><span class="string">'user'</span><span class="keyword">, </span><span class="string">'password'</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="string">'my_db'</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">$query </span><span class="keyword">= </span><span class="string">'select * from my_table'</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$res </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="comment">// iterate over every row<br>&nbsp; &nbsp; </span><span class="keyword">while (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">mysql_fetch_assoc</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// for every field in the result..<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">mysql_num_fields</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">mysql_fetch_field</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="default">$info</span><span class="keyword">-&gt;</span><span class="default">type</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// cast for real<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">$type </span><span class="keyword">== </span><span class="string">'real'</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$row</span><span class="keyword">[</span><span class="default">$info</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">] = </span><span class="default">doubleval</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">[</span><span class="default">$info</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// cast for int<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">$type </span><span class="keyword">== </span><span class="string">'int'</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$row</span><span class="keyword">[</span><span class="default">$info</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">] = </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">[</span><span class="default">$info</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$rows</span><span class="keyword">[] = </span><span class="default">$row</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="comment">// JSON-ify all rows together as one big array<br>&nbsp; &nbsp; </span><span class="keyword">echo </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$rows</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="default">mysql_close</span><span class="keyword">(</span><span class="default">$mysql</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107250">  
  <a class="name">
  <strong class="user"><em>julien dot dev at gmail dot com</em></strong></a><div class="date" title="2012-01-24 06:08"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107250">
<div class="phpcode"><code><span class="html">
Guys, (and girls)
<br>
<br>A trick to unescape UTF8 for ppl with php &lt; 5.4.0
<br>
<br>json_encode(...) gives you \\u..... right ?
<br>
<br>json_decode DOES unescape though !
<br>
<br>so:
<br>
<br><span class="default">&lt;?php
<br></span><span class="comment">/* Imagine you have an object like this :
<br>[{"name":"php help héhéhahéhé","url":"<a rel="nofollow" target="_blank">http://payAttention.example.com</a>"},{"name":"took me brainack j'étais mal mec","url":"<a rel="nofollow" target="_blank">http://slashesEscapingSux</a>"}]
<br>*/
<br>
<br>//first encode your object
<br></span><span class="default">$myDirtyString </span><span class="keyword">= </span><span class="default">$json_encode</span><span class="keyword">(</span><span class="default">$myObject</span><span class="keyword">);
<br>
<br></span><span class="comment">/*the JSON_UNESCAPED_SLASHES, and JSON_UNESCAPED_UNICODE being unavailable, you'll have some ugly escaping happening :
<br>
<br>[{"name":"php help h\\u00e9h\\u00e9hah\\u00e9h\\u00e9","url":"http:\\/\\/payAttention.example.com"},{"name":"took me brainack j'\\u00e9tais mal mec","url":"http:\\/\\/slashesEscapingSux\\/"}]
<br>*/
<br>
<br>//So, you'll have to unescape slashes:
<br></span><span class="default">$myDirtyString </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\\/"</span><span class="keyword">,</span><span class="string">"/"</span><span class="keyword">,</span><span class="default">$myDirtyString</span><span class="keyword">);
<br>
<br></span><span class="comment">//Then, for the trick, escape doule quotes
<br></span><span class="default">$myDirtyString </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'"'</span><span class="keyword">,</span><span class="string">'\\\\"'</span><span class="keyword">,</span><span class="default">$myDirtyString</span><span class="keyword">);
<br>
<br></span><span class="comment">//in oder to json_decode this trciked string (and get your utf8 unescaped)
<br>
<br></span><span class="default">$myCleanedString </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="string">'"'</span><span class="keyword">.</span><span class="default">$myDirtyString</span><span class="keyword">.</span><span class="string">'"'</span><span class="keyword">);
<br>
<br></span><span class="comment">// Je tour est joué !
<br>// There might be better ways to do it but i found so much useless nonsense on forums that i decided to go with it for tonight
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="105683">  
  <a class="name">
  <strong class="user"><em>grkworld1 at yahoo dot co dot in</em></strong></a><div class="date" title="2011-09-07 02:45"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom105683">
<div class="phpcode"><code><span class="html">
copy the php tagged code in a page <br>this is use full for multy dimention array<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">arr_2_str</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">,</span><span class="default">$counter</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; foreach( </span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$str</span><span class="keyword">.= </span><span class="default">$key</span><span class="keyword">.</span><span class="string">"=</span><span class="default">$counter</span><span class="string">&gt;"</span><span class="keyword">.</span><span class="default">arr_2_str</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">,(</span><span class="default">$counter</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">)).</span><span class="string">"="</span><span class="keyword">.</span><span class="default">$counter</span><span class="keyword">.</span><span class="string">"&gt;~Y~|"</span><span class="keyword">.</span><span class="default">$counter</span><span class="keyword">.</span><span class="string">"|"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$str</span><span class="keyword">.=</span><span class="default">$key</span><span class="keyword">.</span><span class="string">"=</span><span class="default">$counter</span><span class="string">&gt;"</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">.</span><span class="string">"|</span><span class="default">$counter</span><span class="string">|"</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="string">"|</span><span class="default">$counter</span><span class="string">|"</span><span class="keyword">);<br>}<br><br>function </span><span class="default">str_2_arr</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="default">$counter</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">,</span><span class="default">$arr</span><span class="keyword">=array(),</span><span class="default">$temparr</span><span class="keyword">=array())<br>{<br>&nbsp; &nbsp; </span><span class="default">$temparr</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"|</span><span class="default">$counter</span><span class="string">|"</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; foreach( </span><span class="default">$temparr </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$t1</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"=</span><span class="default">$counter</span><span class="string">&gt;"</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$kk</span><span class="keyword">=</span><span class="default">$t1</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$vv</span><span class="keyword">=</span><span class="default">$t1</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$t1</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]==</span><span class="string">"~Y~"</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$kk</span><span class="keyword">]=</span><span class="default">str_2_arr</span><span class="keyword">(</span><span class="default">$vv</span><span class="keyword">,(</span><span class="default">$counter</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$kk</span><span class="keyword">]=</span><span class="default">$vv</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$arr</span><span class="keyword">;<br>}<br><br></span><span class="default">$arr</span><span class="keyword">=array();<br><br></span><span class="default">$arr</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]=</span><span class="string">"a"</span><span class="keyword">;<br></span><span class="default">$arr</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]=</span><span class="string">"b"</span><span class="keyword">;<br></span><span class="default">$arr</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">]=</span><span class="string">"c"</span><span class="keyword">;<br></span><span class="default">$arr</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="default">3</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]=</span><span class="string">"d"</span><span class="keyword">;<br></span><span class="default">$arr</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="default">3</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]=</span><span class="string">"e1"</span><span class="keyword">;<br></span><span class="default">$arr</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="default">3</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">]=</span><span class="string">"e2"</span><span class="keyword">;<br></span><span class="default">$arr</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="default">3</span><span class="keyword">][</span><span class="default">3</span><span class="keyword">]=</span><span class="string">"f"</span><span class="keyword">;<br>print </span><span class="string">"&lt;pre&gt;"</span><span class="keyword">;<br><br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br><br>print </span><span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span><span class="keyword">;<br><br>print </span><span class="default">$ssttrr</span><span class="keyword">=</span><span class="default">arr_2_str</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br><br>print </span><span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span><span class="keyword">;<br><br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">str_2_arr</span><span class="keyword">(</span><span class="default">$ssttrr</span><span class="keyword">));<br><br></span><span class="comment">/*print "&lt;br&gt;&lt;br&gt;&lt;br&gt;";<br>print "use of json";<br>print "&lt;br&gt;&lt;br&gt;&lt;br&gt;";<br>print $sstr=json_encode($arr);<br>print "&lt;br&gt;&lt;br&gt;&lt;br&gt;";<br>print_r(json_decode($sstr));*/<br><br></span><span class="keyword">print </span><span class="string">"&lt;/pre&gt;"</span><span class="keyword">;<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103137">  
  <a class="name">
  <strong class="user"><em>pvl dot kolensikov at gmail dot com</em></strong></a><div class="date" title="2011-03-28 08:35"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103137">
<div class="phpcode"><code><span class="html">
As json_encode() is recursive, you can use it to serialize whole structure of objects.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{
<br>&nbsp; &nbsp; public </span><span class="default">$a </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; public </span><span class="default">$b </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;
<br>&nbsp; &nbsp; public </span><span class="default">$collection </span><span class="keyword">= array();
<br>
<br>&nbsp; &nbsp; function&nbsp; </span><span class="default">__construct</span><span class="keyword">(){
<br>&nbsp; &nbsp; &nbsp; &nbsp; for ( </span><span class="default">$i</span><span class="keyword">=</span><span class="default">3</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">--&gt;</span><span class="default">0</span><span class="keyword">;){
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">collection</span><span class="keyword">, new </span><span class="default">B</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; }
<br>}
<br>
<br>class </span><span class="default">B </span><span class="keyword">{
<br>&nbsp; &nbsp; public </span><span class="default">$a </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; public </span><span class="default">$b </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;
<br>}
<br>
<br>echo </span><span class="default">json_encode</span><span class="keyword">(new </span><span class="default">A</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>Will give:
<br>
<br>{
<br>&nbsp; &nbsp; "a":1,
<br>&nbsp; &nbsp; "b":2,
<br>&nbsp; &nbsp; "collection":[{
<br>&nbsp; &nbsp; &nbsp; &nbsp; "a":1,
<br>&nbsp; &nbsp; &nbsp; &nbsp; "b":2
<br>&nbsp; &nbsp; },{
<br>&nbsp; &nbsp; &nbsp; &nbsp; "a":1,
<br>&nbsp; &nbsp; &nbsp; &nbsp; "b":2
<br>&nbsp; &nbsp; },{
<br>&nbsp; &nbsp; &nbsp; &nbsp; "a":1,
<br>&nbsp; &nbsp; &nbsp; &nbsp; "b":2
<br>&nbsp; &nbsp; }]
<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102628">  
  <a class="name">
  <strong class="user"><em>Mathias Leppich</em></strong></a><div class="date" title="2011-02-24 10:29"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102628">
<div class="phpcode"><code><span class="html">
If you need a json_encode / json_decode which is array/object/assoc-array you might want to use: <a rel="nofollow" target="_blank">http://gist.github.com/820694</a><br><br><span class="default">&lt;?php<br>$dataIn </span><span class="keyword">= (object)array(<br>&nbsp; &nbsp; </span><span class="string">"assoc" </span><span class="keyword">=&gt; array(</span><span class="string">"cow"</span><span class="keyword">=&gt;</span><span class="string">"moo"</span><span class="keyword">),<br>&nbsp; &nbsp; </span><span class="string">"object" </span><span class="keyword">=&gt; (object)array(</span><span class="string">"cat"</span><span class="keyword">=&gt;</span><span class="string">"miao"</span><span class="keyword">),<br>);<br></span><span class="comment">/*<br>== IN<br>object(stdClass)#2 (2) {<br>&nbsp; ["assoc"]=&gt;<br>&nbsp; array(1) {<br>&nbsp; &nbsp; ["cow"]=&gt;<br>&nbsp; &nbsp; string(3) "moo"<br>&nbsp; }<br>&nbsp; ["object"]=&gt;<br>&nbsp; object(stdClass)#1 (1) {<br>&nbsp; &nbsp; ["cat"]=&gt;<br>&nbsp; &nbsp; string(4) "miao"<br>&nbsp; }<br>}<br><br>== JSON<br>{"assoc":{"_PHP_ASSOC":{"cow":"moo"}},"object":{"cat":"miao"}}<br><br>== OUT<br>object(stdClass)#4 (2) {<br>&nbsp; ["assoc"]=&gt;<br>&nbsp; array(1) {<br>&nbsp; &nbsp; ["cow"]=&gt;<br>&nbsp; &nbsp; string(3) "moo"<br>&nbsp; }<br>&nbsp; ["object"]=&gt;<br>&nbsp; object(stdClass)#7 (1) {<br>&nbsp; &nbsp; ["cat"]=&gt;<br>&nbsp; &nbsp; string(4) "miao"<br>&nbsp; }<br>}<br>*/<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100968">  
  <a class="name">
  <strong class="user"><em>spam dot here dot pls at hotmail dot com</em></strong></a><div class="date" title="2010-11-17 12:42"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100968">
<div class="phpcode"><code><span class="html">
Another way for pre-5.2.0 PHP users is using rawurlencode() in PHP to encode a string and decodeURIComponent() in javascript to decode it. I have written following class to handle PHP arrays and convert them to javascript format. It uses object notation for associative arrays and arrays for the other. Nesting is supported. True, false, integers, floats and null values are presented in respective javascript syntax.<br><br>Use: convert an array in PHP using this class, load it into the browser using ajax and then decode the strings in the resulting object using javascript function decodeData (below).<br><br>All of the example results have passed json validator so it shoud be allright. Feel free to use this.<br><br>PHP CLASS - encoding arrays<br>=======<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">class </span><span class="default">custom_json </span><span class="keyword">{<br><br>&nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp;&nbsp; * Convert array to javascript object/array<br>&nbsp; &nbsp;&nbsp; * @param array $array the array<br>&nbsp; &nbsp;&nbsp; * @return string<br>&nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; </span><span class="keyword">public static function </span><span class="default">encode</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">)<br>&nbsp; &nbsp; {<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// determine type<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if(</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">key</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">))) {<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// indexed (list)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="string">'['</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$last </span><span class="keyword">= (</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">); isset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]); ++</span><span class="default">$i</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])) </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">self</span><span class="keyword">::</span><span class="default">encode</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">self</span><span class="keyword">::</span><span class="default">_val</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$i </span><span class="keyword">!== </span><span class="default">$last</span><span class="keyword">) </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">','</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">']'</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// associative (object)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="string">'{'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$last </span><span class="keyword">= </span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'":'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">self</span><span class="keyword">::</span><span class="default">encode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">self</span><span class="keyword">::</span><span class="default">_val</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$i </span><span class="keyword">!== </span><span class="default">$last</span><span class="keyword">) </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">','</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ++</span><span class="default">$i</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">'}'</span><span class="keyword">;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; }<br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// return<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">$output</span><span class="keyword">;<br><br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp;&nbsp; * [INTERNAL] Format value<br>&nbsp; &nbsp;&nbsp; * @param mixed $val the value<br>&nbsp; &nbsp;&nbsp; * @return string<br>&nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; </span><span class="keyword">private static function </span><span class="default">_val</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) return </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">rawurlencode</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">).</span><span class="string">'"'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; elseif(</span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) return </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%d'</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; elseif(</span><span class="default">is_float</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) return </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%F'</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; elseif(</span><span class="default">is_bool</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)) return (</span><span class="default">$val </span><span class="keyword">? </span><span class="string">'true' </span><span class="keyword">: </span><span class="string">'false'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; else&nbsp; return </span><span class="string">'null'</span><span class="keyword">;<br>&nbsp; &nbsp; }<br><br>}<br><br></span><span class="comment">// prints ["apple","banana","blueberry"]<br></span><span class="keyword">echo </span><span class="default">custom_json</span><span class="keyword">::</span><span class="default">encode</span><span class="keyword">(array(</span><span class="string">'apple'</span><span class="keyword">, </span><span class="string">'banana'</span><span class="keyword">, </span><span class="string">'blueberry'</span><span class="keyword">));<br><br></span><span class="comment">// prints {"name":"orange","type":"fruit"}<br></span><span class="keyword">echo </span><span class="default">custom_json</span><span class="keyword">::</span><span class="default">encode</span><span class="keyword">(array(</span><span class="string">'name' </span><span class="keyword">=&gt; </span><span class="string">'orange'</span><span class="keyword">, </span><span class="string">'type' </span><span class="keyword">=&gt; </span><span class="string">'fruit'</span><span class="keyword">));<br><br></span><span class="comment">// prints: ** try it yourself, cannot post long lines here **<br></span><span class="default">$big_test </span><span class="keyword">= array(<br>&nbsp; &nbsp; array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'name' </span><span class="keyword">=&gt; array(</span><span class="string">'John'</span><span class="keyword">, </span><span class="string">'Smith'</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'age' </span><span class="keyword">=&gt; </span><span class="default">27</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'sex' </span><span class="keyword">=&gt; </span><span class="default">0</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'height' </span><span class="keyword">=&gt; </span><span class="default">180.53</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'is_human' </span><span class="keyword">=&gt; </span><span class="default">true</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'string' </span><span class="keyword">=&gt; </span><span class="string">'Hello'</span><span class="keyword">,<br>&nbsp; &nbsp; ),<br>&nbsp; &nbsp; array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'name' </span><span class="keyword">=&gt; array(</span><span class="string">'Green'</span><span class="keyword">, </span><span class="string">'Alien'</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'age' </span><span class="keyword">=&gt; </span><span class="default">642</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'sex' </span><span class="keyword">=&gt; </span><span class="default">null</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'height' </span><span class="keyword">=&gt; </span><span class="default">92.21</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'is_human' </span><span class="keyword">=&gt; </span><span class="default">false</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'string' </span><span class="keyword">=&gt; </span><span class="string">'こんにちは！'</span><span class="keyword">, </span><span class="comment">// test utf8 here<br>&nbsp; &nbsp; </span><span class="keyword">)<br>);<br><br>echo </span><span class="default">custom_json</span><span class="keyword">::</span><span class="default">encode</span><span class="keyword">(</span><span class="default">$big_test</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>JAVASCRIPT FUNCTION - decode rawurlencoded() strings<br>==================<br>function decodeData(data) {<br>&nbsp; &nbsp; &nbsp; &nbsp; for(var item in data) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var type = typeof data[item];<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(type === 'object') decodeData(data[item]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if(type === 'string') data[item] = decodeURIComponent(data[item]);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101267">  
  <a class="name">
  <strong class="user"><em>Andre M</em></strong></a><div class="date" title="2010-12-06 04:23"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101267">
<div class="phpcode"><code><span class="html">
Regarding encoding issues, if you make sure the PHP files containing your strings are encoded in UTF-8, you shouldn't need to call utf8_encode.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="69393">  
  <a class="name">
  <strong class="user"><em>giunta dot gaetano at sea-aeroportimilano dot it</em></strong></a><div class="date" title="2006-09-04 08:11"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom69393">
<div class="phpcode"><code><span class="html">
Take care that json_encode() expects strings to be encoded to be in UTF8 format, while by default PHP strings are ISO-8859-1 encoded.<br>This means that <br><br>json_encode(array('àü'));<br><br>will produce a json representation of an empty string, while<br><br>json_encode(array(utf8_encode('àü')));<br><br>will work.<br>The same applies to decoding, too, of course...</span>
</code></div>
  </div>
 </div>
  <div class="note" id="106445">  
  <a class="name">
  <strong class="user"><em>spm at bf-team dot com</em></strong></a><div class="date" title="2011-11-09 11:29"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom106445">
<div class="phpcode"><code><span class="html">
json and utf8?<br><br>Fast Easy Method:)<br><br>Encode: json_encode(array_map('base64_encode', $array));<br><br>Decode: array_map('base64_decode', json_decode($array);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104278">  
  <a class="name">
  <strong class="user"><em>Mr Swordsteel</em></strong></a><div class="date" title="2011-06-05 07:38"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom104278">
<div class="phpcode"><code><span class="html">
So i like to use ISO-8859-1 and a lot of åäöÅÄÖ and not that much for UTF-8 but i need some json stuff so this is what I'm trying to use this lite thing i made...
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">my_json_encode</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">) {
<br>&nbsp; </span><span class="default">$_escape </span><span class="keyword">= function (</span><span class="default">$str</span><span class="keyword">) {
<br>&nbsp; &nbsp; return </span><span class="default">addcslashes</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">"\v\t\n\r\f\"\\/"</span><span class="keyword">);
<br>&nbsp; };
<br>&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br>&nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">)) {
<br>&nbsp; &nbsp; </span><span class="default">$class_vars </span><span class="keyword">= </span><span class="default">get_object_vars</span><span class="keyword">((</span><span class="default">$in</span><span class="keyword">));
<br>&nbsp; &nbsp; </span><span class="default">$arr </span><span class="keyword">= array();
<br>&nbsp; &nbsp; foreach (</span><span class="default">$class_vars </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="string">"\"</span><span class="keyword">{</span><span class="default">$_escape</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)}</span><span class="string">\":\"</span><span class="keyword">{</span><span class="default">$val</span><span class="keyword">}</span><span class="string">\""</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">$arr</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"{</span><span class="keyword">{</span><span class="default">$val</span><span class="keyword">}</span><span class="string">}"</span><span class="keyword">;
<br>&nbsp; }elseif (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">)) {
<br>&nbsp; &nbsp; </span><span class="default">$obj </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; </span><span class="default">$arr </span><span class="keyword">= array();
<br>&nbsp; &nbsp; foreach(</span><span class="default">$in </span><span class="keyword">AS </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; if(!</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$obj </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">my_json_encode</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; if(</span><span class="default">$obj</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$arr </span><span class="keyword">AS </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="string">"\"</span><span class="keyword">{</span><span class="default">$_escape</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)}</span><span class="string">\":</span><span class="keyword">{</span><span class="default">$val</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">$arr</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"{</span><span class="keyword">{</span><span class="default">$val</span><span class="keyword">}</span><span class="string">}"</span><span class="keyword">;
<br>&nbsp; &nbsp; }else {
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">$arr</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"[</span><span class="keyword">{</span><span class="default">$val</span><span class="keyword">}</span><span class="string">]"</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br>&nbsp; }elseif (</span><span class="default">is_bool</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">)) {
<br>&nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">$in </span><span class="keyword">? </span><span class="string">'true' </span><span class="keyword">: </span><span class="string">'false'</span><span class="keyword">;
<br>&nbsp; }elseif (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">)) {
<br>&nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">'null'</span><span class="keyword">;
<br>&nbsp; }elseif (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">)) {
<br>&nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">"\"</span><span class="keyword">{</span><span class="default">$_escape</span><span class="keyword">(</span><span class="default">$in</span><span class="keyword">)}</span><span class="string">\""</span><span class="keyword">;
<br>&nbsp; }else {
<br>&nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">$in</span><span class="keyword">;
<br>&nbsp; }
<br>&nbsp; return </span><span class="string">"</span><span class="keyword">{</span><span class="default">$out</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>have fun make money off it or what you like with you code... this is for everyone...</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114468">  
  <a class="name">
  <strong class="user"><em>guillaume dot jonville at gmail dot com</em></strong></a><div class="date" title="2014-02-23 07:44"><strong>6 months ago</strong></div>
  <div class="text" id="Hcom114468">
<div class="phpcode"><code><span class="html">
It's my __json_encode function to encode in JSON format array or string with javascript function <br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">__json_encode</span><span class="keyword">(</span><span class="default">$mVar</span><span class="keyword">,</span><span class="default">$fnCallback</span><span class="keyword">=</span><span class="string">"stripcslashes"</span><span class="keyword">) {<br>&nbsp; &nbsp; return </span><span class="default">preg_replace_callback</span><span class="keyword">(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'#"[ ]{0,}function[ ]{0,}\([^)$]{0,}\)[ ]{0,}\{[ ]{0,}(?(?![ ]{0,}}[ ]{0,}").){0,}[ ]{0,}\}[ ]{0,}"([(?,")|(?\}{0,}$)]{0,})#si'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; function (</span><span class="default">$aRes</span><span class="keyword">) use (</span><span class="default">$fnCallback</span><span class="keyword">) { <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">1</span><span class="keyword">),</span><span class="default">$sOut</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$iOpen</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$iClose</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) &amp;&amp; </span><span class="default">$sOut</span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++) <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">) == </span><span class="string">"{"</span><span class="keyword">) </span><span class="default">$iOpen</span><span class="keyword">++;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">) == </span><span class="string">"}" </span><span class="keyword">AND </span><span class="default">$iOpen </span><span class="keyword">== ++</span><span class="default">$iClose</span><span class="keyword">) break;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">is_callable</span><span class="keyword">(</span><span class="default">$fnCallback</span><span class="keyword">) ? </span><span class="default">$fnCallback</span><span class="keyword">(</span><span class="default">$sOut</span><span class="keyword">).</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] : </span><span class="default">$fnCallback</span><span class="keyword">(</span><span class="default">$sOut</span><span class="keyword">).</span><span class="default">$aRes</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]; <br>&nbsp; &nbsp; &nbsp; &nbsp; },<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$mVar</span><span class="keyword">)<br>&nbsp; &nbsp; );<br>}<br>&nbsp; &nbsp; <br><br></span><span class="default">$aData </span><span class="keyword">= array( <br>&nbsp; &nbsp; </span><span class="string">'key1' </span><span class="keyword">=&gt; </span><span class="string">'value1'</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'key2' </span><span class="keyword">=&gt; </span><span class="string">'function(){ return $("&lt;INPUT /&gt;").attr("type","text"); }'</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">'key3' </span><span class="keyword">=&gt; array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'key3.1'</span><span class="keyword">=&gt;</span><span class="string">'val3.1'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'key3.2'</span><span class="keyword">=&gt;</span><span class="string">'function(someArg) { if (someArg == "someValue") return true; else { document.write("error"); return false; } }'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; ),<br>&nbsp; &nbsp; </span><span class="string">'key4' </span><span class="keyword">=&gt; </span><span class="string">'function(){ return true; }'<br></span><span class="keyword">);<br><br></span><span class="default">$sData </span><span class="keyword">= </span><span class="string">'function(someArg) { if (someArg == "someValue") return true; else { document.write("error"); return false; } }'</span><span class="keyword">;<br><br>echo&nbsp; </span><span class="string">'Output for json_encode() : '</span><span class="keyword">.</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$aData</span><span class="keyword">).</span><span class="string">"\n\n"</span><span class="keyword">;<br>echo&nbsp; </span><span class="string">'Output for __json_encode() : '</span><span class="keyword">.</span><span class="default">__json_encode</span><span class="keyword">(</span><span class="default">$aData</span><span class="keyword">).</span><span class="string">"\n\n"</span><span class="keyword">;<br><br>echo&nbsp; </span><span class="string">'Output for json_encode($sData) : '</span><span class="keyword">.</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$sData</span><span class="keyword">).</span><span class="string">"\n\n"</span><span class="keyword">;<br>echo&nbsp; </span><span class="string">'Output for __json_encode($sData) : '</span><span class="keyword">.</span><span class="default">__json_encode</span><span class="keyword">(</span><span class="default">$sData</span><span class="keyword">).</span><span class="string">"\n\n"</span><span class="keyword">;<br><br></span><span class="comment">/*<br> * <br> * Output for json_encode() : {"key1":"value1","key2":"function(){ return $(\"&lt;INPUT \/&gt;\").attr(\"type\",\"text\"); }","key3":{"key3.1":"val3.1","key3.2":"function(someArg) { if (someArg == \"someValue\") return true; else { document.write(\"error\"); return false; } }"},"key4":"function(){ return true; }"}<br> * <br> * Output for __json_encode() : {"key1":"value1","key2":function(){ return $("&lt;INPUT /&gt;").attr("type","text"); },"key3":{"key3.1":"val3.1","key3.2":function(someArg) { if (someArg == "someValue") return true; else { document.write("error"); return false; } }},"key4":function(){ return true; }}<br> * <br> * <br> * Output for json_encode($sData) : "function(someArg) { if (someArg == \"someValue\") return true; else { document.write(\"error\"); return false; } }"<br> * <br> * Output for __json_encode($sData) : function(someArg) { if (someArg == "someValue") return true; else { document.write("error"); return false; } }<br> * <br> */</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113416">  
  <a class="name">
  <strong class="user"><em>zac at javazac dot com</em></strong></a><div class="date" title="2013-10-08 04:27"><strong>10 months ago</strong></div>
  <div class="text" id="Hcom113416">
<div class="phpcode"><code><span class="html">
There is a gotcha that keeps getting me with JSON_NUMERIC_CHECK. At first it seems like the greatest thing in the world if you are encoding data pulled from a db because it turns numeric strings into seemingly appropriate ints or floats. Use with caution. I've been surprised a number of times by "numbers" that really are strings ie really precise lat/long coords.&nbsp; json_encode with the JSON_NUMERIC_CHECK will encode these as floats but the precision of the data is so large that php actually rounds the number off. In this case I had to rework my code so that it didn't use JSON_NUMERIC_CHECK and I manually cast fields as ints or floats as appropriate and skipped my lat/long fields so that they stayed numeric strings.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101546">  
  <a class="name">
  <strong class="user"><em>marc at leftek dot com</em></strong></a><div class="date" title="2010-12-23 10:08"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101546">
<div class="phpcode"><code><span class="html">
Anybody having empty arrays and needing the JSON_FORCE_OBJECT option but not using 5.3 yet, you can substitute assigning an empty object:<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; </span><span class="keyword">if (empty(</span><span class="default">$array</span><span class="keyword">)) </span><span class="default">$array </span><span class="keyword">= (object) </span><span class="default">null</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100679">  
  <a class="name">
  <strong class="user"><em>php at ianco dot co dot uk</em></strong></a><div class="date" title="2010-10-29 04:02"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100679">
<div class="phpcode"><code><span class="html">
Note that json_encode always escapes a solidus (forward slash, %x2F).<br>This may be a problem if you are encoding a URL.<br>It's been recognised and fixed in September 2010:<br><a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=49366</a><br>But escaping will still be the default behaviour.<br>A crude repair can be done with<br>str_replace('\\/', '/', $jsonEncoded)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107369">  
  <a class="name">
  <strong class="user"><em>pahreg at inbox dot ru</em></strong></a><div class="date" title="2012-02-04 10:36"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107369">
<div class="phpcode"><code><span class="html">
Simple replacement for JSON_UNESCAPED_UNICODE (PHP &lt; 5.4 for example)<br> <br>Can be buggy, but works for simple UTF-8 strings.<br><br><span class="default">&lt;?php<br>$json </span><span class="keyword">= </span><span class="default">preg_replace_callback</span><span class="keyword">(</span><span class="string">'/\\\u(\w\w\w\w)/'</span><span class="keyword">, <br>&nbsp; &nbsp; function(</span><span class="default">$matches</span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="string">'&amp;#'</span><span class="keyword">.</span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]).</span><span class="string">';'</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; , </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">));<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98987">  
  <a class="name">
  <strong class="user"><em>Arne Bech</em></strong></a><div class="date" title="2010-07-20 12:00"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98987">
<div class="phpcode"><code><span class="html">
To battle the quoting of numbers when encoding data retrieved from mysql you could do a simple preg_replace() to remove the quotes on numbers.<br><br>This has worked for me:<br><span class="default">&lt;?php<br>$json </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$dataFromMysql</span><span class="keyword">);<br></span><span class="default">$json </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/"(-?\d+\.?\d*)"/'</span><span class="keyword">, </span><span class="string">'$1'</span><span class="keyword">, </span><span class="default">$json</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86358">  
  <a class="name">
  <strong class="user"><em>stboisvert at nowantspam dot gmail dot com</em></strong></a><div class="date" title="2008-10-14 12:27"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom86358">
<div class="phpcode"><code><span class="html">
When Using Libraries such as Prototype you may find that once in a while when you return what you believe to be a empty array it will have a different behavior (vis a vis enumerables) than when you give it an associative array. To "fix" this, on your JS you may want to look for extended object properties to verify if it is an empty array or an ocject. 
<br>
<br>example:
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">if (</span><span class="default">transport</span><span class="keyword">.</span><span class="default">responseJSON</span><span class="keyword">[</span><span class="string">'User'</span><span class="keyword">].</span><span class="default">length </span><span class="keyword">== </span><span class="default">undefined</span><span class="keyword">){
<br>&nbsp; &nbsp; &nbsp; &nbsp; var </span><span class="default">user </span><span class="keyword">= </span><span class="default">$H</span><span class="keyword">(</span><span class="default">transport</span><span class="keyword">.</span><span class="default">responseJSON</span><span class="keyword">[</span><span class="string">'User'</span><span class="keyword">]);
<br>}else{
<br>&nbsp; &nbsp; &nbsp; &nbsp; var </span><span class="default">user </span><span class="keyword">= </span><span class="default">transport</span><span class="keyword">.</span><span class="default">responseJSON</span><span class="keyword">[</span><span class="string">'User'</span><span class="keyword">];&nbsp; &nbsp; &nbsp; 
<br>}
<br></span><span class="default">?&gt;
<br></span>
<br>Thanks goes out to :
<br>jani@php.net
<br>
<br>This is totally expected behaviour. Please read this:
<br><a rel="nofollow" target="_blank">http://www.json.org/</a>
<br>
<br>Note: array and assoc-array are different things. Latter being "object"
<br>in json.
<br>
<br><a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=45162</a>
<br>
<br>[RQuadling] See <a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=47493.</a> Fixed by using json_encode(array(), JSON_FORCE_OBJECT);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="91009">  
  <a class="name">
  <strong class="user"><em>other at killermonk dot com</em></strong></a><div class="date" title="2009-05-20 02:55"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom91009">
<div class="phpcode"><code><span class="html">
If you are trying to flatten a multi dimensional array, you can also just use serialize and unserialize. It just depends on what you are trying to do.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101497">  
  <a class="name">
  <strong class="user"><em>rdheijer at reestyle dot net</em></strong></a><div class="date" title="2010-12-21 02:11"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101497">
<div class="phpcode"><code><span class="html">
You may run into trouble when you need to call functions. In my case I had to fire a function based on a button pressed in the flexigrid javascript component.
<br>
<br>My solution in the project was:
<br>
<br><span class="default">&lt;?php
<br>
<br>$jsonify </span><span class="keyword">= array(</span><span class="string">'onpress'</span><span class="keyword">=&gt;</span><span class="string">'functionName'</span><span class="keyword">);
<br>
<br></span><span class="comment">// The part between braces in the regex is somewhat rough
<br>// but it will do the job. Afterall, you don't want this to be
<br>// used by a visitor :)
<br></span><span class="default">$regex </span><span class="keyword">= </span><span class="string">'/"onpress":"([\w\-\.]+)"/i'</span><span class="keyword">;
<br></span><span class="default">$replace </span><span class="keyword">= </span><span class="string">'"onpress":$1'</span><span class="keyword">;
<br></span><span class="default">$jsonified </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="default">$regex</span><span class="keyword">, </span><span class="default">$replace</span><span class="keyword">, </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$jsonify</span><span class="keyword">));
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>But you can extend this for your own needs. By altering the regex and replace vars:
<br>
<br><span class="default">&lt;?php 
<br>
<br>$replace </span><span class="keyword">= </span><span class="string">'"$1":$2'</span><span class="keyword">;
<br></span><span class="default">$regex </span><span class="keyword">= </span><span class="string">'/"(onpress|onclick|onmouseover|onmouseout)":"([\w_\-\.]+)"/i'</span><span class="keyword">;
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>Unfortunately you have to specify each call reference, but it does give you full control over what to and what not to.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90169">  
  <a class="name">
  <strong class="user"><em>atrauzzi at gmail dot com</em></strong></a><div class="date" title="2009-04-08 12:39"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90169">
<div class="phpcode"><code><span class="html">
Here's an idea for people trying to figure out an alternative to implode() to flatten multi-dimensional arrays.<br><br>Use json_encode()!<br><br>I needed a way to create a hash from an array:<br><br>md5(json_encode($multiDimensionalArray)) does the trick!<br><br>Happy caching!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102452">  
  <a class="name">
  <strong class="user"><em>Joao Neto</em></strong></a><div class="date" title="2011-02-15 04:36"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102452">
<div class="phpcode"><code><span class="html">
To solve the "problem" with encoded UTF8 chars, is easy:
<br>
<br>for example:
<br>
<br><span class="default">&lt;?php
<br>$arr </span><span class="keyword">= array( </span><span class="string">'áéíóúçã'</span><span class="keyword">, </span><span class="string">'áááééé´rŕŕ' </span><span class="keyword">);
<br>
<br>echo </span><span class="default">json_encode</span><span class="keyword">( </span><span class="default">$arr </span><span class="keyword">);
<br>
<br>foreach (</span><span class="default">$arr </span><span class="keyword">as &amp;</span><span class="default">$a</span><span class="keyword">) {
<br>&nbsp; </span><span class="default">$a </span><span class="keyword">= </span><span class="default">ascii_to_entities</span><span class="keyword">( </span><span class="default">$a </span><span class="keyword">);
<br>}
<br>
<br>echo </span><span class="default">json_encode</span><span class="keyword">( </span><span class="default">$arr </span><span class="keyword">);
<br>
<br>function </span><span class="default">ascii_to_entities</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$count&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out&nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$temp&nbsp; &nbsp; </span><span class="keyword">= array();
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$s </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$s</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)
<br>&nbsp; &nbsp; &nbsp;&nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ordinal </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$ordinal </span><span class="keyword">&lt; </span><span class="default">128</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">) == </span><span class="default">1</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out&nbsp; </span><span class="keyword">.= </span><span class="string">'&amp;#'</span><span class="keyword">.</span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">).</span><span class="string">';'</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= (</span><span class="default">$ordinal </span><span class="keyword">&lt; </span><span class="default">224</span><span class="keyword">) ? </span><span class="default">2 </span><span class="keyword">: </span><span class="default">3</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$temp</span><span class="keyword">[] = </span><span class="default">$ordinal</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">) == </span><span class="default">$count</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$number </span><span class="keyword">= (</span><span class="default">$count </span><span class="keyword">== </span><span class="default">3</span><span class="keyword">) ? ((</span><span class="default">$temp</span><span class="keyword">[</span><span class="string">'0'</span><span class="keyword">] % </span><span class="default">16</span><span class="keyword">) * </span><span class="default">4096</span><span class="keyword">) + 
<br>((</span><span class="default">$temp</span><span class="keyword">[</span><span class="string">'1'</span><span class="keyword">] % </span><span class="default">64</span><span class="keyword">) * </span><span class="default">64</span><span class="keyword">) + 
<br>(</span><span class="default">$temp</span><span class="keyword">[</span><span class="string">'2'</span><span class="keyword">] % </span><span class="default">64</span><span class="keyword">) : ((</span><span class="default">$temp</span><span class="keyword">[</span><span class="string">'0'</span><span class="keyword">] % </span><span class="default">32</span><span class="keyword">) * </span><span class="default">64</span><span class="keyword">) + 
<br>(</span><span class="default">$temp</span><span class="keyword">[</span><span class="string">'1'</span><span class="keyword">] % </span><span class="default">64</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">.= </span><span class="string">'&amp;#'</span><span class="keyword">.</span><span class="default">$number</span><span class="keyword">.</span><span class="string">';'</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$temp </span><span class="keyword">= array();
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br>&nbsp; &nbsp; &nbsp;&nbsp; }
<br>
<br>&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$out</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br></span><span class="default">?&gt;
<br></span>
<br>RESULT:
<br>
<br>["\u00e1\u00e9\u00ed\u00f3\u00fa\u00e7\u00e3",
<br>"\u00e1\u00e1\u00e1\u00e9\u00e9\u00e9\u00b4r\u0155\u0155"]
<br>
<br>Array ( [0] =&gt; áéíóúçã [1] =&gt; áááééé´rŕŕ ) 
<br>
<br>["áéíóúçã","áááééé´rŕŕ"]
<br>
<br>Array ( [0] =&gt; áéíóúçã [1] =&gt; áááééé´rŕŕ )</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.json-encode.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:05:07 GMT -->


</body></html>