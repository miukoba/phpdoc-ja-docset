<html><!-- Mirrored from php.net/manual/en/book.session.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:29:27 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Sessions</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="book.session.html">
 <link rel="shorturl" href="http://php.net/session">
 <link rel="alternate" href="http://php.net/session" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="refs.basic.session.html">
 <link rel="prev" href="function.msession-unlock.html">
 <link rel="next" href="intro.session.html">

 <link rel="alternate" href="book.session.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/book.session.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/book.session.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/book.session.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/book.session.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/book.session.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/book.session.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/book.session.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/book.session.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/book.session.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/book.session.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.session.html">Session Extensions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="book.session" class="book">
 
 <h1 class="title">Session Handling</h1>
 

 
 
 

 





 

 






 







 







 







 







 






 







<ul class="chunklist chunklist_book"><li><a href="intro.session.html">Introduction</a></li><li><a href="session.setup.html">Installing/Configuring</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="session.requirements.html">Requirements</a></li><li><a href="session.installation.html">Installation</a></li><li><a href="session.configuration.html">Runtime Configuration</a></li><li><a href="session.resources.html">Resource Types</a></li></ul></li><li><a href="session.constants.html">Predefined Constants</a></li><li><a href="session.examples.html">Examples</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="session.examples.basic.html">Basic usage</a></li><li><a href="session.idpassing.html">Passing the Session ID</a></li><li><a href="session.customhandler.html">Custom Session Handlers</a></li></ul></li><li><a href="session.upload-progress.html">Session Upload Progress</a></li><li><a href="session.security.html">Sessions and security</a></li><li><a href="ref.session.html">Session Functions</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="function.session-cache-expire.html">session_cache_expire</a> — Return current cache expire</li><li><a href="function.session-cache-limiter.html">session_cache_limiter</a> — Get and/or set the current cache limiter</li><li><a href="function.session-commit.html">session_commit</a> — Alias of session_write_close</li><li><a href="function.session-decode.html">session_decode</a> — Decodes session data from a session encoded string</li><li><a href="function.session-destroy.html">session_destroy</a> — Destroys all data registered to a session</li><li><a href="function.session-encode.html">session_encode</a> — Encodes the current session data as a session encoded string</li><li><a href="function.session-get-cookie-params.html">session_get_cookie_params</a> — Get the session cookie parameters</li><li><a href="function.session-id.html">session_id</a> — Get and/or set the current session id</li><li><a href="function.session-is-registered.html">session_is_registered</a> — Find out whether a global variable is registered in a session</li><li><a href="function.session-module-name.html">session_module_name</a> — Get and/or set the current session module</li><li><a href="function.session-name.html">session_name</a> — Get and/or set the current session name</li><li><a href="function.session-regenerate-id.html">session_regenerate_id</a> — Update the current session id with a newly generated one</li><li><a href="function.session-register-shutdown.html">session_register_shutdown</a> — Session shutdown function</li><li><a href="function.session-register.html">session_register</a> — Register one or more global variables with the current session</li><li><a href="function.session-save-path.html">session_save_path</a> — Get and/or set the current session save path</li><li><a href="function.session-set-cookie-params.html">session_set_cookie_params</a> — Set the session cookie parameters</li><li><a href="function.session-set-save-handler.html">session_set_save_handler</a> — Sets user-level session storage functions</li><li><a href="function.session-start.html">session_start</a> — Start new or resume existing session</li><li><a href="function.session-status.html">session_status</a> — Returns the current session status</li><li><a href="function.session-unregister.html">session_unregister</a> — Unregister a global variable from the current session</li><li><a href="function.session-unset.html">session_unset</a> — Free all session variables</li><li><a href="function.session-write-close.html">session_write_close</a> — Write session data and end session</li></ul></li><li><a href="class.sessionhandler.html">SessionHandler</a> — The SessionHandler class<ul class="chunklist chunklist_book chunklist_children"><li><a href="sessionhandler.close.html">SessionHandler::close</a> — Close the session</li><li><a href="sessionhandler.destroy.html">SessionHandler::destroy</a> — Destroy a session</li><li><a href="sessionhandler.gc.html">SessionHandler::gc</a> — Cleanup old sessions</li><li><a href="sessionhandler.open.html">SessionHandler::open</a> — Initialize session</li><li><a href="sessionhandler.read.html">SessionHandler::read</a> — Read session data</li><li><a href="sessionhandler.write.html">SessionHandler::write</a> — Write session data</li></ul></li><li><a href="class.sessionhandlerinterface.html">SessionHandlerInterface</a> — The SessionHandlerInterface class<ul class="chunklist chunklist_book chunklist_children"><li><a href="sessionhandlerinterface.close.html">SessionHandlerInterface::close</a> — Close the session</li><li><a href="sessionhandlerinterface.destroy.html">SessionHandlerInterface::destroy</a> — Destroy a session</li><li><a href="sessionhandlerinterface.gc.html">SessionHandlerInterface::gc</a> — Cleanup old sessions</li><li><a href="sessionhandlerinterface.open.html">SessionHandlerInterface::open</a> — Initialize session</li><li><a href="sessionhandlerinterface.read.html">SessionHandlerInterface::read</a> — Read session data</li><li><a href="sessionhandlerinterface.write.html">SessionHandlerInterface::write</a> — Write session data</li></ul></li></ul></div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="90351">  
  <a class="name">
  <strong class="user"><em>e dot mortoray at ecircle dot com</em></strong></a><div class="date" title="2009-04-17 05:02"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90351">
<div class="phpcode"><code><span class="html">
There is a nuance we found with session timing out although the user is still active in the session.&nbsp; The problem has to do with never modifying the session variable.
<br>
<br>The GC will clear the session data files based on their last modification time.&nbsp; Thus if you never modify the session, you simply read from it, then the GC will eventually clean up.
<br>
<br>To prevent this you need to ensure that your session is modified within the GC delete time.&nbsp; You can accomplish this like below.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">if( !isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'last_access'</span><span class="keyword">]) || (</span><span class="default">time</span><span class="keyword">() - </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'last_access'</span><span class="keyword">]) &gt; </span><span class="default">60 </span><span class="keyword">)
<br>&nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'last_access'</span><span class="keyword">] = </span><span class="default">time</span><span class="keyword">();
<br></span><span class="default">?&gt;
<br></span>
<br>This will update the session every 60s to ensure that the modification date is altered.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103020">  
  <a class="name">
  <strong class="user"><em>roberto at spadim dot com dot br</em></strong></a><div class="date" title="2011-03-20 10:28"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103020">
<div class="phpcode"><code><span class="html">
instead of memcache, you should consider using redis<br><a rel="nofollow" target="_blank">http://redis.io/commands</a><br><br>it have KEYS command (<a rel="nofollow" target="_blank">http://redis.io/commands/keys</a>) that can return all keys (like 'ls'/'dir' at php sessions directory)<br><br>it allow replication too (cluster use)<br><br>i don't know if anyone wrote a version of phpsessions using redis yet, but since memcache don't have KEYS command, it's hard to know if the users is connected (at app side) or what sessions still active (not expired/not logged)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102685">  
  <a class="name">
  <strong class="user"><em>elephant at punx dot pl</em></strong></a><div class="date" title="2011-02-28 11:51"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102685">
<div class="phpcode"><code><span class="html">
Please note, that database is NOT recommended for session storage. It can be a big performance bottleneck, especially in replicated environments.<br><br>For saving sessions, file handler seems to be very effective for most setups, except those situations:<br> - if performance is an issue, the directory which stores session files can be mounted as tmpfs (ram disk).<br> - if sharing sessions across multiple webservers is needed (in clustered environments), use memcache for storing session information (tip: you can setup more than one instance of memcache eliminate single point of failure). This method, however, sets a limitation of session size to 64k (this should be enough for most applications)<br> - don't use NFS for sharing session files between webservers, it does not handle locking correctly and can cause corruption of session data.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84753">  
  <a class="name">
  <strong class="user"><em>Madster</em></strong></a><div class="date" title="2008-07-28 12:45"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84753">
<div class="phpcode"><code><span class="html">
When you include a php file in your current script it's included, not processed separately, thus it's still within the same page and the current page hasn't finished processing.<br>Thus, session is not set yet. This is the expected behaviour.<br><br>If you need to load a page after setting session data, you should set session data and then send a redirection or refresh header (remember not to send anything, not even whitespace before sending headers).<br><br>Always consider session data to be updated after the next page load (as in http request completed).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88230">  
  <a class="name">
  <strong class="user"><em>Some Guy</em></strong></a><div class="date" title="2009-01-16 04:26"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88230">
<div class="phpcode"><code><span class="html">
Just some notes - it seems that php does the session writing after the script exits.<br>For example, if you set a bunch of session variables and then run session_regenerate_id() - the session variables are never written to the old session. The new session id is generated when you ask it to be generated, but the session exists only in memory until after the script exits - when the session is written and any and all session variables are written to it.<br><br>This caused me some confusion, as I'm running sessions in an sql database rather than flat file, trying to do any manipulation of the session database directly in a script where you have run session_regenerate_id() will fail for the new session ID because the insert hasn't been done yet, and setting any session variables will only be written to the new session, even if set before you regenerate the session ID.<br><br>Also - if using a database for sessions, make sure to use mysql_real_escape_string() before saving any session variables.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/book.session.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:29:29 GMT -->


</body></html>