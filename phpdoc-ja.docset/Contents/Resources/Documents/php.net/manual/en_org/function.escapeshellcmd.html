<html><!-- Mirrored from php.net/manual/en/function.escapeshellcmd.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:08:06 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>escapeshellcmd</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.escapeshellcmd.html">
 <link rel="shorturl" href="http://php.net/escapeshellcmd">
 <link rel="alternate" href="http://php.net/escapeshellcmd" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.exec.html">
 <link rel="prev" href="function.escapeshellarg.html">
 <link rel="next" href="function.exec.html">

 <link rel="alternate" href="function.escapeshellcmd.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.escapeshellcmd.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.escapeshellcmd.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.escapeshellcmd.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.escapeshellcmd.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.escapeshellcmd.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.escapeshellcmd.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.escapeshellcmd.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.escapeshellcmd.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.escapeshellcmd.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.escapeshellcmd.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.fileprocess.process.html">Process Control Extensions</a></li>      <li><a href="book.exec.html">Program execution</a></li>      <li><a href="ref.exec.html">Program execution Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.escapeshellcmd" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">escapeshellcmd</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">escapeshellcmd</span> â€” <span class="dc-title">Escape shell metacharacters</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.escapeshellcmd-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>escapeshellcmd</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$command</code></span>
   )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>escapeshellcmd()</strong></span> escapes any characters in a
   string that might be used to trick a shell command into executing
   arbitrary commands.  This function should be used to make sure
   that any data coming from user input is escaped before this data
   is passed to the <span class="function"><a href="function.exec.html" class="function">exec()</a></span> or
   <span class="function"><a href="function.system.html" class="function">system()</a></span> functions, or to the <a href="language.operators.execution.html" class="link">backtick
   operator</a>.
  </p>
  <p class="para">
   Following characters are preceded by a backslash:
   <em>#&amp;;`|*?~&lt;&gt;^()[]{}$\</em>, <em>\x0A</em>
   and <em>\xFF</em>. <em>'</em> and <em>"</em>
   are escaped only if they are not paired. In Windows, all these characters
   plus <em>%</em> are replaced by a space instead.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.escapeshellcmd-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">command</code></dt>

     <dd>

      <p class="para">
       The command that will be escaped.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.escapeshellcmd-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   The escaped string.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.escapeshellcmd-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-3773">
    <p><strong>Example #1 <span class="function"><strong>escapeshellcmd()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;We&nbsp;allow&nbsp;arbitrary&nbsp;number&nbsp;of&nbsp;arguments&nbsp;intentionally&nbsp;here.<br></span><span style="color: #0000BB">$command&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'./configure&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'configure_options'</span><span style="color: #007700">];<br><br></span><span style="color: #0000BB">$escaped_command&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">escapeshellcmd</span><span style="color: #007700">(</span><span style="color: #0000BB">$command</span><span style="color: #007700">);<br>&nbsp;<br></span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">$escaped_command</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.escapeshellcmd-notes">
   <div class="warning"><strong class="warning">Warning</strong>
    <p class="para">
     <span class="function"><strong>escapeshellcmd()</strong></span> should be used on the whole
     command string, and it still allows the attacker to pass
     arbitrary number of arguments. For escaping a single argument 
     <span class="function"><a href="function.escapeshellarg.html" class="function">escapeshellarg()</a></span> should be used instead.
    </p>
   </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.escapeshellcmd-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.escapeshellarg.html" class="function" rel="rdfs-seeAlso">escapeshellarg()</a> - Escape a string to be used as a shell argument</span></li>
    <li class="member"><span class="function"><a href="function.exec.html" class="function" rel="rdfs-seeAlso">exec()</a> - Execute an external program</span></li>
    <li class="member"><span class="function"><a href="function.popen.html" class="function" rel="rdfs-seeAlso">popen()</a> - Opens process file pointer</span></li>
    <li class="member"><span class="function"><a href="function.system.html" class="function" rel="rdfs-seeAlso">system()</a> - Execute an external program and display the output</span></li>
    <li class="member"><a href="language.operators.execution.html" class="link">backtick operator</a></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="102152">  
  <a class="name">
  <strong class="user"><em>nicholas at nicholaswilson dot me dot uk</em></strong></a><div class="date" title="2011-01-29 07:41"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102152">
<div class="phpcode"><code><span class="html">
There is a quirk to be aware of regarding use of echo. If you have a command which you want to execute which takes input from STDIN, you would normally do:
<br>
<br><span class="default">&lt;?php $output </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">"echo </span><span class="default">$input</span><span class="string"> | /the/command"</span><span class="keyword">); </span><span class="default">?&gt;
<br></span>
<br>Unfortunately, this is a *bad idea* and will make your script unportable, providing a very hard-to-trace bug on some systems. Depending on how the server is set up, /bin/sh will either call /bin/bash or /bin/dash, and these have very different versions of echo. Never use echo; use printf instead which is consistent. How do you escape for printf? Do this:
<br>
<br><span class="default">&lt;?php
<br>$input </span><span class="keyword">= </span><span class="string">'string to be passed *exactly* to the command'</span><span class="keyword">;
<br></span><span class="comment">//Escape only what is needed to get by PHP's parser; we want
<br>//the string data PHP is holding in its buffer to be passed
<br>//exactly to stdin buffer of the command.
<br></span><span class="default">$cmd </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">'%'</span><span class="keyword">), array(</span><span class="string">'\\\\'</span><span class="keyword">, </span><span class="string">'%%'</span><span class="keyword">), </span><span class="default">$input</span><span class="keyword">);
<br></span><span class="default">$cmd </span><span class="keyword">= </span><span class="default">escapeshellarg</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">);
<br>
<br></span><span class="default">$output </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">"printf </span><span class="default">$cmd</span><span class="string"> | /path/to/command"</span><span class="keyword">);
<br></span><span class="default">?&gt;
<br></span>
<br>For the paranoid, this torture test verifies that both shell escaping and printf's own escaping are handled correctly. Use with confidence!
<br>
<br><span class="default">&lt;?php
<br>
<br>$test </span><span class="keyword">= </span><span class="string">'stuff bash interprets, space: # &amp; ; ` | * ? ~ &lt; &gt; ^ ( ) [ ] { } $ \ \x0A \xFF. \' " %'</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">.
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'stuff bash interprets, no space: #&amp;;`|*?~&lt;&gt;^()[]{}$\\x0A\xFF.\'\"%'</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">.
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'stuff bash interprets, with leading backslash: \# \&amp; \; \` \| \* \? \~ \&lt; \&gt; \^ \( \) \[ \] \{ \} \$ \\\ \\\x0A \\\xFF. \\\' \" \%'</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">.
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'printf codes: % \ (used to form %.0#-*+d, or \\ \a \b \f \n \r \t \v \" \? \062 \0062 \x032 \u0032 and \U00000032)'</span><span class="keyword">;
<br>
<br>echo </span><span class="string">"These are the strings we are testing with:"</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">.</span><span class="default">$test</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">;
<br></span><span class="default">$cmd </span><span class="keyword">= </span><span class="default">$test</span><span class="keyword">;
<br></span><span class="default">$cmd </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">'%'</span><span class="keyword">), array(</span><span class="string">'\\\\'</span><span class="keyword">, </span><span class="string">'%%'</span><span class="keyword">), </span><span class="default">$test</span><span class="keyword">);
<br></span><span class="default">$cmd </span><span class="keyword">= </span><span class="default">escapeshellarg</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">);
<br>
<br>echo </span><span class="default">PHP_EOL</span><span class="keyword">.</span><span class="string">"This is the output using the escaping mechanism given:"</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">;
<br>echo `</span><span class="string">printf </span><span class="default">$cmd</span><span class="string"> | cat</span><span class="keyword">`.</span><span class="default">PHP_EOL</span><span class="keyword">;
<br>
<br>echo </span><span class="default">PHP_EOL</span><span class="keyword">.</span><span class="string">"They should match exactly"</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">;
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108322">  
  <a class="name">
  <strong class="user"><em>phpcomment at reversiblemaps dot ath dot cx</em></strong></a><div class="date" title="2012-04-17 11:31"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108322">
<div class="phpcode"><code><span class="html">
escaping strings for a shell is tricky.<br><br>&nbsp; If your target system is windows give up now.&nbsp; windows isn't even self consisitent in how to escape stuff.<br><br>&nbsp; if unix convert everything to octal - although this is hardest to implement it's the easiest to implement correctly - there are no special cases..<br>.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73169">  
  <a class="name">
  <strong class="user"><em>Leon</em></strong></a><div class="date" title="2007-02-11 04:31"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73169">
<div class="phpcode"><code><span class="html">
This function is great -- except when you need to legitimately use an escaped character as part of your command.&nbsp; The code below leaves the parts of the command that are enclosed within single quotes alone, but escapes the rest eg:<br><br>"echo Never use the '&lt;blink&gt;' tag ; cat /etc/passwd"<br>becomes:<br>"echo Never use the '&lt;blink&gt;' tag \; cat /etc/passwd"<br>and not:<br>"echo Never use the '\&lt;blink\&gt;' tag \; cat /etc/passwd"<br><br>i.e, we really want the ';' escaped, but not the HTML tag.&nbsp; I really needed the code below in order to run the external ImageMagick's 'convert' command properly and safely...<br><br><span class="default">&lt;?php<br><br></span><span class="comment">// Escape whole string<br></span><span class="default">$cmdQ </span><span class="keyword">= </span><span class="default">escapeshellcmd</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">);<br><br> </span><span class="comment">// Build array of quoted parts, and the same escaped<br></span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">'/\'[^\']+\'/'</span><span class="keyword">, </span><span class="default">$cmd</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);<br></span><span class="default">$matches </span><span class="keyword">= </span><span class="default">current</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">);<br></span><span class="default">$quoted </span><span class="keyword">= array();<br>foreach( </span><span class="default">$matches </span><span class="keyword">as </span><span class="default">$match </span><span class="keyword">)<br>&nbsp; &nbsp; </span><span class="default">$quoted</span><span class="keyword">[</span><span class="default">escapeshellcmd</span><span class="keyword">(</span><span class="default">$match</span><span class="keyword">)] = </span><span class="default">$match</span><span class="keyword">;<br><br></span><span class="comment">// Replace sections that were single quoted with original content<br></span><span class="keyword">foreach( </span><span class="default">$quoted </span><span class="keyword">as </span><span class="default">$search </span><span class="keyword">=&gt; </span><span class="default">$replace </span><span class="keyword">)<br>&nbsp; &nbsp; </span><span class="default">$cmdQ </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">( </span><span class="default">$search</span><span class="keyword">, </span><span class="default">$replace</span><span class="keyword">, </span><span class="default">$cmdQ </span><span class="keyword">);<br><br>return </span><span class="default">$cmdQ</span><span class="keyword">;<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="56720">  
  <a class="name">
  <strong class="user"><em>cast3r</em></strong></a><div class="date" title="2005-09-13 05:31"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom56720">
<div class="phpcode"><code><span class="html">
"normal any user on linux can view almost any directory so:<br>ls / -als will print a complete list of any file in the linux filesystem including its size, security and hidden files as well."<br>ls / -alsR is the whole filesystem.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="49527">  
  <a class="name">
  <strong class="user"><em>trisk at earthling dot net</em></strong></a><div class="date" title="2005-01-31 10:19"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom49527">
<div class="phpcode"><code><span class="html">
This function does not work as shown in the php.net examples.<br><br>If you put your encoded filename into double-quotes as they suggest, then it will break on certain characters in filenames, such as ampersand.<br><br>For example if you have a filename called "foo &amp; bar.jpg" and you use this function on it, your resulting filename when double-quoted will produce this and not be found:<br><br>"foo \&amp; bar.jpg"<br><br>If you need to have a single argument where spaces are included then do not use this function with added double-quotes, use escapeshellarg() which encloses the whole string in single quotes.<br><br>I do not understand which purpose this particular function is intended for.&nbsp; I can't see any use for it, unless you pass it through another function and convert spaces " " to "\ ", which would allow you to use the string directly on the command line.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98580">  
  <a class="name">
  <strong class="user"><em>carlos at wfmh dot org dot pl dot REMOVE dot COM</em></strong></a><div class="date" title="2010-06-24 04:42"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98580">
<div class="phpcode"><code><span class="html">
Mind it does not escape ! (exclamation mark). So if you want to i.e. printf() commands for later use in shell (i.e. by pasting to the console) you need to escape all exclamation marks or shell will try to process ! as history reference. This approach shall suffice:
<br>
<br><span class="default">&lt;?php $scaped </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'!'</span><span class="keyword">, </span><span class="string">'\!'</span><span class="keyword">, </span><span class="default">escapeshellarg</span><span class="keyword">( </span><span class="default">$str </span><span class="keyword">) ); </span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="80299">  
  <a class="name">
  <strong class="user"><em>davidwhthomas</em></strong></a><div class="date" title="2008-01-08 02:21"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom80299">
<div class="phpcode"><code><span class="html">
To extract an archive file to a specific folder using exec() :<br><br><span class="default">&lt;?php<br>$result </span><span class="keyword">= </span><span class="default">exec</span><span class="keyword">(</span><span class="default">escapeshellcmd</span><span class="keyword">(</span><span class="string">"tar -xvvf /path/to/archive.tar -C /path/to/extract/to/"</span><span class="keyword">));<br></span><span class="default">?&gt;<br></span><br>escapeshellcmd() is used here because I am getting the file path via user input / upload.<br><br>DT</span>
</code></div>
  </div>
 </div>
  <div class="note" id="67811">  
  <a class="name">
  <strong class="user"><em>abennett at clarku dot edu</em></strong></a><div class="date" title="2006-07-05 11:59"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom67811">
<div class="phpcode"><code><span class="html">
I've got a php script that needs to pass a username and password via exec to a perl script.&nbsp; The problem is valid password characters were getting escaped...<br><br>Here's a little perl function I wrote to fix it.<br><br>sub unescape_string {<br>&nbsp; &nbsp; &nbsp; my $string = shift;<br>&nbsp; &nbsp; &nbsp; # all these interpolated regex's are slow, so if there's no<br>&nbsp; &nbsp; &nbsp; # backslash in the string don't bother with it<br>&nbsp; &nbsp; &nbsp; # index() is faster then a regex<br>&nbsp; &nbsp; &nbsp; if ( ! index($string,'\\\\') ) {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $string;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; my @characters = ('#', '&amp;', ';', '`', '|', '*', '?', '~', '&lt;', '&gt;', '^', '(', ')',<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '[', ']', '{', '}', '$', '\\', ',', ' ', '\x0A', '\xFF' );<br>&nbsp; &nbsp; &nbsp; my $character;<br>&nbsp; &nbsp; &nbsp; foreach $character (@characters) {<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $character = quotemeta($character);<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; my $pattern = "\\\\(" . $character . ")";<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $string =~ s/$pattern/$1/g;<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; return $string;<br>}<br><br>Hope this is useful.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="63179">  
  <a class="name">
  <strong class="user"><em>ceejay at trashfactory dot de</em></strong></a><div class="date" title="2006-03-15 04:43"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom63179">
<div class="phpcode"><code><span class="html">
Well guys, i find it very hard that escapeshellarg and escapeshellcmd are forcely run when passing a command to exec, system or popen, when safe_mode is turned on.<br><br>Right now, i did not find any working solution to pass commands like this:<br>cmd -arg1 -arg2 "&lt;BLA varname=\"varvalue\" varname1=\"varvalue1\" /&gt;"<br><br>it is just the case, that the parameter for arg2 which is a string that looks like an HTML-Tag with various attributes set, all attributes of the string in arg2 gets splitted by the whitespaces within. this wont happen with safe_mode turned off, so it must be one of the escapefunctions, that breaks functionality. <br><br>In order to circumvent this, i have made a temporary solution, which dynamically creates a skriptfile (by fopen), which just contains the whole command with arguments, and then execute that skriptfile. i dont like that solution, but in the other hand, safe_mode cannot be easily turned off on that server.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="51827">  
  <a class="name">
  <strong class="user"><em>docey</em></strong></a><div class="date" title="2005-04-12 05:56"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom51827">
<div class="phpcode"><code><span class="html">
the main reason for quoting a command is that it not multiple&nbsp; command can be joined. i don't know for sure if this is the right syntax but remeber that this can do some nice security breaks. here's one way of how to know exactly what your trying to break into for.<br><br>normal any user on linux can view almost any directory so:<br>ls / -als will print a complete list of any file in the linux filesystem including its size, security and hidden files as well.<br><br>now the output would only become known to php and never will the user be able to view this data unless the php script would actual start to print it out. like passtru does!! but a good php coder knows never to use passtru unless not otherwise possible. <br><br>but what would happen if you can direct the output from ls also from that same commandline to a file in the webroot most webserver still default their base-webroot to /var/www/ so storing it there in text file to download it later and you can simply take coffee while checking wich files can be read by php security mode and then simply use the cp command to copy those to the webroot and download them to your own hard-disk. without a list of the files you can only guess where to copy from! and thats harder then guessing the root password. <br><br>so if the first command was quoted it is not possible to attach another command because of a syntax error. think of all the thinks you can do once you got a complete list of every file on the filesystem. including mounted once via NFS and others. security starts at keeping the door hidden.<br><br>also another nice command for hanging the webserver can be "php <span class="default">&lt;?php </span><span class="keyword">while(</span><span class="default">true</span><span class="keyword">){ </span><span class="default">exec</span><span class="keyword">(</span><span class="string">'ls / -als'</span><span class="keyword">); }; </span><span class="default">?&gt;</span>" this keeps creating a file list on the entire filesystem wich not only keeps the hard-disk(s) bussy but also memory and cpu&nbsp;&nbsp; wich must store the returned list. so keeping in mind not all command accepted from users can be used blind. <br><br>actualy never accept any command from external sources only proven built-in predefined commands should be executed.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.escapeshellcmd.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:08:06 GMT -->


</body></html>