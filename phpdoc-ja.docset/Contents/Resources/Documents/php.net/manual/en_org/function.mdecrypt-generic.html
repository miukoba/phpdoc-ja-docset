<html><!-- Mirrored from php.net/manual/en/function.mdecrypt-generic.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:16:52 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>mdecrypt_generic</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.mdecrypt-generic.html">
 <link rel="shorturl" href="http://php.net/mdecrypt-generic">
 <link rel="alternate" href="http://php.net/mdecrypt-generic" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.mcrypt.html">
 <link rel="prev" href="function.mcrypt-ofb.html">
 <link rel="next" href="book.mhash.html">

 <link rel="alternate" href="function.mdecrypt-generic.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.mdecrypt-generic.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.mdecrypt-generic.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.mdecrypt-generic.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.mdecrypt-generic.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.mdecrypt-generic.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.mdecrypt-generic.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.mdecrypt-generic.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.mdecrypt-generic.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.mdecrypt-generic.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.mdecrypt-generic.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.crypto.html">Cryptography Extensions</a></li>      <li><a href="book.mcrypt.html">Mcrypt</a></li>      <li><a href="ref.mcrypt.html">Mcrypt Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.mdecrypt-generic" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mdecrypt_generic</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.2, PHP 5)</p><p class="refpurpose"><span class="refname">mdecrypt_generic</span> â€” <span class="dc-title">Decrypts data</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.mdecrypt-generic-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>mdecrypt_generic</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$td</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>
   )</div>

  <p class="para rdfs-comment">
   This function decrypts data. Note that the length of the returned string
   can in fact be longer than the unencrypted string, due to the padding of
   the data.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mdecrypt-generic-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">td</code></dt>

     <dd>

      <p class="para">
       An encryption descriptor returned by
       <span class="function"><a href="function.mcrypt-module-open.html" class="function">mcrypt_module_open()</a></span>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">data</code></dt>

     <dd>

      <p class="para">
       Encrypted data.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mdecrypt-generic-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-891">
    <p><strong>Example #1 <span class="function"><strong>mdecrypt_generic()</strong></span> Example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Data&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'this&nbsp;is&nbsp;a&nbsp;very&nbsp;long&nbsp;key,&nbsp;even&nbsp;too&nbsp;long&nbsp;for&nbsp;the&nbsp;cipher'</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$plain_text&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'very&nbsp;important&nbsp;data'</span><span style="color: #007700">;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Open&nbsp;module,&nbsp;and&nbsp;create&nbsp;IV&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$td&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mcrypt_module_open</span><span style="color: #007700">(</span><span style="color: #DD0000">'des'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'ecb'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">mcrypt_enc_get_key_size</span><span style="color: #007700">(</span><span style="color: #0000BB">$td</span><span style="color: #007700">));<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$iv_size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mcrypt_enc_get_iv_size</span><span style="color: #007700">(</span><span style="color: #0000BB">$td</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$iv&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mcrypt_create_iv</span><span style="color: #007700">(</span><span style="color: #0000BB">$iv_size</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">MCRYPT_RAND</span><span style="color: #007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Initialize&nbsp;encryption&nbsp;handle&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">mcrypt_generic_init</span><span style="color: #007700">(</span><span style="color: #0000BB">$td</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$key</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$iv</span><span style="color: #007700">)&nbsp;!=&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Encrypt&nbsp;data&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$c_t&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mcrypt_generic</span><span style="color: #007700">(</span><span style="color: #0000BB">$td</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$plain_text</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">mcrypt_generic_deinit</span><span style="color: #007700">(</span><span style="color: #0000BB">$td</span><span style="color: #007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Reinitialize&nbsp;buffers&nbsp;for&nbsp;decryption&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">mcrypt_generic_init</span><span style="color: #007700">(</span><span style="color: #0000BB">$td</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$key</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$iv</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$p_t&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mdecrypt_generic</span><span style="color: #007700">(</span><span style="color: #0000BB">$td</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$c_t</span><span style="color: #007700">);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Clean&nbsp;up&nbsp;*/<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">mcrypt_generic_deinit</span><span style="color: #007700">(</span><span style="color: #0000BB">$td</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">mcrypt_module_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$td</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">strncmp</span><span style="color: #007700">(</span><span style="color: #0000BB">$p_t</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$plain_text</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$plain_text</span><span style="color: #007700">))&nbsp;==&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"ok\n"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"error\n"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
  <p class="para">
   The example above shows how to check if the data before the encryption is
   the same as the data after the decryption. It is very important to
   reinitialize the encryption buffer with
   <span class="function"><a href="function.mcrypt-generic-init.html" class="function">mcrypt_generic_init()</a></span> before you try to decrypt the
   data.
  </p>
  <p class="para">
   The decryption handle should always be initialized with
   <span class="function"><a href="function.mcrypt-generic-init.html" class="function">mcrypt_generic_init()</a></span> with a key and an IV before
   calling this function. Where the encryption is done, you should free the
   encryption buffers by calling <span class="function"><a href="function.mcrypt-generic-deinit.html" class="function">mcrypt_generic_deinit()</a></span>.
   See <span class="function"><a href="function.mcrypt-module-open.html" class="function">mcrypt_module_open()</a></span> for an example.
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mdecrypt-generic-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mcrypt-generic.html" class="function" rel="rdfs-seeAlso">mcrypt_generic()</a> - This function encrypts data</span></li>
    <li class="member"><span class="function"><a href="function.mcrypt-generic-init.html" class="function" rel="rdfs-seeAlso">mcrypt_generic_init()</a> - This function initializes all buffers needed for encryption</span></li>
    <li class="member"><span class="function"><a href="function.mcrypt-generic-deinit.html" class="function" rel="rdfs-seeAlso">mcrypt_generic_deinit()</a> - This function deinitializes an encryption module</span></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="88812">  
  <a class="name">
  <strong class="user"><em>nytro_rst at yahoo dot com</em></strong></a><div class="date" title="2009-02-09 03:33"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88812">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php
<br></span><span class="comment">// Parameters:
<br>// $text = The text that you want to encrypt.
<br>// $key = The key you're using to encrypt.
<br>// $alg = The algorithm.
<br>// $crypt = 1 if you want to crypt, or 0 if you want to decrypt.
<br>
<br></span><span class="keyword">function </span><span class="default">cryptare</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$alg</span><span class="keyword">, </span><span class="default">$crypt</span><span class="keyword">)
<br>{
<br>&nbsp; &nbsp; </span><span class="default">$encrypted_data</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;
<br>&nbsp; &nbsp; switch(</span><span class="default">$alg</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"3des"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'tripledes'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"cast-128"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'cast-128'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"gost"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'gost'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"rijndael-128"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'rijndael-128'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"twofish"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'twofish'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"arcfour"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'arcfour'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"cast-256"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'cast-256'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"loki97"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'loki97'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"rijndael-192"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'rijndael-192'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"saferplus"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'saferplus'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"wake"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'wake'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"blowfish-compat"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'blowfish-compat'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"des"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'des'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"rijndael-256"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'rijndael-256'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"xtea"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'xtea'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"enigma"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'enigma'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;
<br>&nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="string">"rc2"</span><span class="keyword">:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'rc2'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; default:
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$td </span><span class="keyword">= </span><span class="default">mcrypt_module_open</span><span class="keyword">(</span><span class="string">'blowfish'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="string">'ecb'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$iv </span><span class="keyword">= </span><span class="default">mcrypt_create_iv</span><span class="keyword">(</span><span class="default">mcrypt_enc_get_iv_size</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">), </span><span class="default">MCRYPT_RAND</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">mcrypt_enc_get_key_size</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">));
<br>&nbsp; &nbsp; </span><span class="default">mcrypt_generic_init</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$iv</span><span class="keyword">);
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; if(</span><span class="default">$crypt</span><span class="keyword">)
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$encrypted_data </span><span class="keyword">= </span><span class="default">mcrypt_generic</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; else 
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$encrypted_data </span><span class="keyword">= </span><span class="default">mdecrypt_generic</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">mcrypt_generic_deinit</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">mcrypt_module_close</span><span class="keyword">(</span><span class="default">$td</span><span class="keyword">);
<br>&nbsp; &nbsp; 
<br>&nbsp; &nbsp; return </span><span class="default">$encrypted_data</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112512">  
  <a class="name">
  <strong class="user"><em>jakub dot lopuszanski at nasza-klasa dot pl</em></strong></a><div class="date" title="2013-06-25 07:16"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112512">
<div class="phpcode"><code><span class="html">
For all those of you which are "surprised" by the padding (even though it is mentioned in the description of the method) please do not just "strip away everything which I do not understand".<br>The approach with rtrim, rtrim "\0", removing all charcodes &lt; 16, etc. are all wrong.<br>The PKCS #7 padding works just as described in&nbsp; RFC 5652.<br>To remove it, just look at the last byte of the message, and it will tell you how many bytes to remove.<br>For example, if the last byte is equal to \0A, then remove 10 bytes.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="89763">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2009-03-21 07:31"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom89763">
<div class="phpcode"><code><span class="html">
Here's a quick snippet for removing PKCS7 padding:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">unpadPKCS7</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$blockSize</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">strlen </span><span class="keyword">( </span><span class="default">$data </span><span class="keyword">);<br>&nbsp; &nbsp; if (</span><span class="default">$length </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$first </span><span class="keyword">= </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$data</span><span class="keyword">, - </span><span class="default">1 </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">ord </span><span class="keyword">( </span><span class="default">$first </span><span class="keyword">) &lt;= </span><span class="default">$blockSize</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$length </span><span class="keyword">- </span><span class="default">2</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">--)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">ord </span><span class="keyword">( </span><span class="default">$data </span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] != </span><span class="default">$first </span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$data</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$i </span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">$data</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="98199">  
  <a class="name">
  <strong class="user"><em>trashmail dot hashishin at gmail dot com</em></strong></a><div class="date" title="2010-06-01 12:46"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98199">
<div class="phpcode"><code><span class="html">
Whenever you need to decrypt files encrypted with dot.net (and others?) you can use the following settings:<br><br>Encryption: 'rijndael-256'<br>Mode: 'cbc'<br>Padding-Mode: Zeros<br>iv: "yes"<br><br>encode the data with base64 to send them to your php script</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107979">  
  <a class="name">
  <strong class="user"><em>Peter Bailey</em></strong></a><div class="date" title="2012-03-19 05:49"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107979">
<div class="phpcode"><code><span class="html">
We found that sometimes the resulting padding is not null characters "\0" but rather one of several control characters.<br><br>If you know your data is not supposed to have any trailing control characters "as we did" you can strip them like so.<br><br><span class="default">&lt;?php<br><br>$data </span><span class="keyword">= </span><span class="default">mdecrypt_generic</span><span class="keyword">( </span><span class="default">$cipher</span><span class="keyword">, </span><span class="default">$data </span><span class="keyword">);<br><br></span><span class="comment">// Strip trailing control-character padding<br></span><span class="default">$data </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">( </span><span class="string">"/\p{Cc}*$/u"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">$data </span><span class="keyword">);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113625">  
  <a class="name">
  <strong class="user"><em>Ulysse</em></strong></a><div class="date" title="2013-11-07 02:27"><strong>9 months ago</strong></div>
  <div class="text" id="Hcom113625">
<div class="phpcode"><code><span class="html">
Based on the information provided by "jakub dot lopuszanski at nasza-klasa dot pl" that in PKCS#7, the last byte contains the number of byte to remove (see RFC 5652, part 6.3), and for those like me who like to copy paste an already-made snippet:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">unpadPKCS7</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$blocksize</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$last </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) - </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$last</span><span class="keyword">));<br>}<br></span><span class="default">?&gt;<br></span><br>Now you have no more reason to use rtrim() to remove the padding at the end of the result.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77153">  
  <a class="name">
  <strong class="user"><em>Silvan</em></strong></a><div class="date" title="2007-08-17 12:34"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom77153">
<div class="phpcode"><code><span class="html">
It is generally not recommended to just use rtrim to remove the padding.<br><br>Use rtrim($str, "\0") for strings that do not end in "\0" or store the data length during encryption. <br>(Although data containing "\0" sometimes gets corrupted during encryption so these types of data actually should be packed.)<br><br>For example:<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">encrypt</span><span class="keyword">(</span><span class="default">$original_data</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$original_data</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$data_to_encrypt </span><span class="keyword">= </span><span class="default">$length</span><span class="keyword">.</span><span class="string">'|'</span><span class="keyword">.</span><span class="default">$original_data</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="comment">// Encrypt the data including its length. <br>&nbsp; &nbsp; // Do not save the length unencrypted, as this could be a (minor) security risk<br></span><span class="keyword">}<br><br>function </span><span class="default">decrypt</span><span class="keyword">(</span><span class="default">$cypher</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="comment">// Decrypt the cypher data first<br>&nbsp; &nbsp; // Next retrieve the original data<br>&nbsp; &nbsp; </span><span class="keyword">list(</span><span class="default">$length</span><span class="keyword">, </span><span class="default">$padded_data</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'|'</span><span class="keyword">, </span><span class="default">$decrypted_data</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$original_data </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$padded_data</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$length</span><span class="keyword">);<br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="70360">  
  <a class="name">
  <strong class="user"><em>php at pcwize dot com</em></strong></a><div class="date" title="2006-10-12 02:59"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom70360">
<div class="phpcode"><code><span class="html">
Just confirming the .DLL issues. With 4.3.4 you need the older .DLL. I'm guessing any version of PHP4 needs the older .DLL. With PHP5 you need the newer one.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="54472">  
  <a class="name">
  <strong class="user"><em>drew at expressdynamics dot com</em></strong></a><div class="date" title="2005-07-05 10:07"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom54472">
<div class="phpcode"><code><span class="html">
On Win32 systems with PHP 5, you must use the newer libmcrypt.dll file, otherwise mdecrypt_generic will not work.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="51238">  
  <a class="name">
  <strong class="user"><em>robbie [at] averill [dot] co [dot] nz</em></strong></a><div class="date" title="2005-03-24 03:15"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom51238">
<div class="phpcode"><code><span class="html">
I have noticed that sometimes when the binary ciphertext is longer than the plaintext, the decrypted plaintext can have some little boxes/squares next to it as 'padding'. I also noticed that you can't cut and paste them to be able to edit them out, but i did find a solution.<br><br>Just call rtrim() around the string and it removes them.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="41374">  
  <a class="name">
  <strong class="user"><em>jon@jonroig dot com</em></strong></a><div class="date" title="2004-04-07 07:29"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom41374">
<div class="phpcode"><code><span class="html">
Here's a bit of encrypt/decrypt code.<br><br>If you're using this on the win32 platform, BEWARE! The latest DLL (19-Jan-2004) contains a bug that keeps mdecrypt_generic from functioning. Nearly drove me over the edge... The 30-Dec-2002 version seems to work with no trouble.<br>&lt;?<br><br>$key = "this is a secret key";<br>$input = "Let us meet at 9 o'clock at the secret place.";<br><br>$td = mcrypt_module_open('tripledes', '', 'ecb', '');<br>$iv = mcrypt_create_iv (mcrypt_enc_get_iv_size($td), MCRYPT_RAND);<br>mcrypt_generic_init($td, $key, $iv);<br>$encrypted_data = mcrypt_generic($td, $input);<br>mcrypt_generic_deinit($td);<br>mcrypt_module_close($td);<br><br>echo "Encrypt: ".$encrypted_data;<br><br>echo "&lt;br&gt;&lt;br&gt;";<br><br>$td = mcrypt_module_open('tripledes', '', 'ecb', '');<br>$iv = mcrypt_create_iv (mcrypt_enc_get_iv_size($td), MCRYPT_RAND);<br>$key = substr($key, 0, mcrypt_enc_get_key_size($td));<br>mcrypt_generic_init($td, $key, $iv);<br>$decrypted_data = mdecrypt_generic($td, $encrypted_data);<br>echo "Decrypt: ".$decrypted_data;<br>mcrypt_generic_deinit($td);<br>mcrypt_module_close($td);<br><br>?&gt;</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.mdecrypt-generic.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:16:53 GMT -->


</body></html>