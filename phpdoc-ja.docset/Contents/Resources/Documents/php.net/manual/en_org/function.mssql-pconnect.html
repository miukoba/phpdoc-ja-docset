<html><!-- Mirrored from php.net/manual/en/function.mssql-pconnect.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:29:50 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>mssql_pconnect</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.mssql-pconnect.html">
 <link rel="shorturl" href="http://php.net/mssql-pconnect">
 <link rel="alternate" href="http://php.net/mssql-pconnect" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.mssql.html">
 <link rel="prev" href="function.mssql-num-rows.html">
 <link rel="next" href="function.mssql-query.html">

 <link rel="alternate" href="function.mssql-pconnect.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.mssql-pconnect.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.mssql-pconnect.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.mssql-pconnect.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.mssql-pconnect.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.mssql-pconnect.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.mssql-pconnect.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.mssql-pconnect.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.mssql-pconnect.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.mssql-pconnect.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.mssql-pconnect.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.vendors.html">Vendor Specific Database Extensions</a></li>      <li><a href="book.mssql.html">Mssql</a></li>      <li><a href="ref.mssql.html">Mssql Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.mssql-pconnect" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mssql_pconnect</h1>
  <p class="verinfo">(PHP 4, PHP 5, PECL odbtp &gt;= 1.1.1)</p><p class="refpurpose"><span class="refname">mssql_pconnect</span> â€” <span class="dc-title">Open persistent MS SQL connection</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.mssql-pconnect-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>mssql_pconnect</strong></span>
    ([ <span class="methodparam"><span class="type">string</span> <code class="parameter">$servername</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$username</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$password</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$new_link</code><span class="initializer"> = false</span></span>
  ]]]] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>mssql_pconnect()</strong></span> acts very much like
   <span class="function"><a href="function.mssql-connect.html" class="function">mssql_connect()</a></span> with two major differences.
  </p>
  <p class="para">
   First, when connecting, the function would first try to find a
   (persistent) link that's already open with the same host,
   username and password.  If one is found, an identifier for it
   will be returned instead of opening a new connection.
  </p>
  <p class="para">
   Second, the connection to the SQL server will not be closed when
   the execution of the script ends.  Instead, the link will remain
   open for future use (<span class="function"><a href="function.mssql-close.html" class="function">mssql_close()</a></span> will not
   close links established by <span class="function"><strong>mssql_pconnect()</strong></span>).
  </p>
  <p class="para">
   This type of links is therefore called 'persistent'.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mssql-pconnect-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">servername</code></dt>

     <dd>

      <p class="para">
       The MS SQL server. It can also include a port number. e.g. 
       <em>hostname:port</em>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">username</code></dt>

     <dd>

      <p class="para">
       The username. 
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">password</code></dt>

     <dd>

      <p class="para">
       The password. 
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">new_link</code></dt>

     <dd>

      <p class="para">
       If a second call is made to <span class="function"><strong>mssql_pconnect()</strong></span> with
       the same arguments, no new link will be established, but instead, the
       link identifier of the already opened link will be returned. This
       parameter modifies this behavior and makes
       <span class="function"><strong>mssql_pconnect()</strong></span> always open a new link, even if
       <span class="function"><strong>mssql_pconnect()</strong></span> was called before with the same
       parameters.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mssql-pconnect-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns a positive MS SQL persistent link identifier on success, or
   <strong><code>FALSE</code></strong> on error.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mssql-pconnect-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-1627">
    <p><strong>Example #1 <span class="function"><strong>mssql_pconnect()</strong></span> using the <code class="parameter">new_link</code> parameter</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;Connect&nbsp;to&nbsp;MSSQL&nbsp;and&nbsp;select&nbsp;the&nbsp;database<br></span><span style="color: #0000BB">$link1&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mssql_pconnect</span><span style="color: #007700">(</span><span style="color: #DD0000">'MANGO\SQLEXPRESS'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sa'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'phpfi'</span><span style="color: #007700">);<br></span><span style="color: #0000BB">mssql_select_db</span><span style="color: #007700">(</span><span style="color: #DD0000">'php'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$link1</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;link<br></span><span style="color: #0000BB">$link2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mssql_pconnect</span><span style="color: #007700">(</span><span style="color: #DD0000">'MANGO\SQLEXPRESS'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sa'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'phpfi'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br></span><span style="color: #0000BB">mssql_select_db</span><span style="color: #007700">(</span><span style="color: #DD0000">'random'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$link2</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="108508">  
  <a class="name">
  <strong class="user"><em>kagaku at gmail dot com</em></strong></a><div class="date" title="2012-05-02 06:47"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom108508">
<div class="phpcode"><code><span class="html">
Be careful when utilizing mssql_pconnect to connect to multiple databases on the same server using different credentials. For example:<br><br><span class="default">&lt;?php<br></span><span class="comment">/* first connection */<br></span><span class="default">$conn1 </span><span class="keyword">= </span><span class="default">mssql_pconnect</span><span class="keyword">(</span><span class="string">'production-server'</span><span class="keyword">,</span><span class="string">'sa'</span><span class="keyword">,</span><span class="string">'1234'</span><span class="keyword">);<br></span><span class="default">mssql_select_db</span><span class="keyword">(</span><span class="default">$conn1</span><span class="keyword">,</span><span class="string">'invoicelistdb'</span><span class="keyword">);<br><br></span><span class="default">$row </span><span class="keyword">= </span><span class="default">mssql_query</span><span class="keyword">(</span><span class="string">'select top 10 * from invoices'</span><span class="keyword">, </span><span class="default">$conn1</span><span class="keyword">);<br><br></span><span class="comment">/* open another connection, same server different */<br></span><span class="default">$conn2 </span><span class="keyword">= </span><span class="default">mssql_pconnect</span><span class="keyword">(</span><span class="string">'production-server'</span><span class="keyword">,</span><span class="string">'loweruser'</span><span class="keyword">,</span><span class="string">'6789'</span><span class="keyword">);<br></span><span class="default">mssql_select_db</span><span class="keyword">(</span><span class="default">$conn2</span><span class="keyword">,</span><span class="string">'someotherdb'</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>Results in the error:<br><br>PHP Warning:&nbsp; mssql_select_db(): Unable to select database:&nbsp; someotherdb<br><br>I suspect mssql_pconnect detects a connect opened to "production-server" and just re-uses it, regardless of whether or not the credentials are the same. We did not notice this until consolidating two different MSSQL servers onto one server with two databases with different users/permissions. Reverting back to mssql_connect() solves the problem.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="39791">  
  <a class="name">
  <strong class="user"><em>dave at dontspamme dot com</em></strong></a><div class="date" title="2004-02-10 02:32"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom39791">
<div class="phpcode"><code><span class="html">
If you are running PHP/Apache combination on a Windows machine that is part of a domain, using NT Authentication to connect to a MS SQL Server, you must to do the following things:<br><br>1) Turn NT Authentication On (under MSSQL in php.ini)<br>2) Configure the Apache service to run as the user that is authorized to access the MS SQL server.<br><br>Hope this helps save someone the time that it took me to track down!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="23396">  
  <a class="name">
  <strong class="user"><em>m1tk4 at hotmail dot com</em></strong></a><div class="date" title="2002-07-17 09:08"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom23396">
<div class="phpcode"><code><span class="html">
Be careful with pconnect!<br><br>Platform: RH Linux 7.3, PHP 4.2.1. FreeTDS.<br><br>pconnect does give you better time than connect (about 0.25-0.4 seconds gain) BUT:<br><br>- occasionally, I've experienced "quirks" when fetch() would randomly return empty recordsets from stored procedurest that can_not return empty recordsets by definition.<br><br>- if you restart MSSQL server while some of the connections did not time out, next pconnect() will not establish a new connection! It will return an old one, so next time you do execute() or query() your script will just _hang_ until timeouted by Apache.<br><br>All of the above I believe are FreeTDS problems, not PHP. I wonder if somebody with PHP+Sybase lib got pconnect to work.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="13980">  
  <a class="name">
  <strong class="user"><em>php at rawhide dot cjb dot net</em></strong></a><div class="date" title="2001-07-12 06:18"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom13980">
<div class="phpcode"><code><span class="html">
One should not that persistent connections are not persistent under a CGI interface.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="40663">  
  <a class="name">
  <strong class="user"><em>php at burntpopcorn dot net</em></strong></a><div class="date" title="2004-03-10 06:17"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom40663">
<div class="phpcode"><code><span class="html">
Please note that mssql_pconnect creates a connection for the pool for *each process*. If you have "ThreadsPerChild" set to 50 in apache, and mssql.max_procs set to 25 in php, then eventually you will get mssql_pconnect failing to give you a connection to the database. This has stumped me for quite a while, and the answer finally presented itself thanks to the people in #php.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.mssql-pconnect.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:29:52 GMT -->


</body></html>