<html><!-- Mirrored from php.net/manual/en/function.date-default-timezone-set.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:05:37 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>date_default_timezone_set</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.date-default-timezone-set.html">
 <link rel="shorturl" href="http://php.net/date-default-timezone-set">
 <link rel="alternate" href="http://php.net/date-default-timezone-set" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.datetime.html">
 <link rel="prev" href="function.date-default-timezone-get.html">
 <link rel="next" href="function.date-diff.html">

 <link rel="alternate" href="function.date-default-timezone-set.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.date-default-timezone-set.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.date-default-timezone-set.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.date-default-timezone-set.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.date-default-timezone-set.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.date-default-timezone-set.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.date-default-timezone-set.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.date-default-timezone-set.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.date-default-timezone-set.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.date-default-timezone-set.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.date-default-timezone-set.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.calendar.html">Date and Time Related Extensions</a></li>      <li><a href="book.datetime.html">Date/Time</a></li>      <li><a href="ref.datetime.html">Date/Time Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.date-default-timezone-set" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">date_default_timezone_set</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.1.0)</p><p class="refpurpose"><span class="refname">date_default_timezone_set</span> — <span class="dc-title">
   Sets the default timezone used by all date/time functions in a script
  </span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.date-default-timezone-set-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>date_default_timezone_set</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$timezone_identifier</code></span>
   )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>date_default_timezone_set()</strong></span> sets the default timezone
   used by all date/time functions.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    Since PHP 5.1.0 (when the date/time functions were rewritten), every call
    to a date/time function will generate a <strong><code>E_NOTICE</code></strong> if
    the timezone isn't valid, and/or a <strong><code>E_WARNING</code></strong> message
    if using the system settings or the <var class="varname"><var class="varname">TZ</var></var> environment
    variable.
   </p>
  <p></p></blockquote>
  <p class="para">
   Instead of using this function to set the default timezone in your script,
   you can also use the INI setting <a href="datetime.configuration.html#ini.date.timezone" class="link">date.timezone</a> to set the default
   timezone.
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.date-default-timezone-set-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">timezone_identifier</code></dt>

     <dd>

      <p class="para">
       The timezone identifier, like <em>UTC</em> or
       <em>Europe/Lisbon</em>. The list of valid identifiers is
       available in the <a href="timezones.html" class="xref">List of Supported Timezones</a>.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.date-default-timezone-set-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   This function returns <strong><code>FALSE</code></strong> if the
   <code class="parameter">timezone_identifier</code> isn't valid, or <strong><code>TRUE</code></strong>
   otherwise.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.date-default-timezone-set-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-2388">
    <p><strong>Example #1 Getting the default timezone</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>date_default_timezone_set</span><span style="color: #007700">(</span><span style="color: #DD0000">'America/Los_Angeles'</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$script_tz&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">date_default_timezone_get</span><span style="color: #007700">();<br><br>if&nbsp;(</span><span style="color: #0000BB">strcmp</span><span style="color: #007700">(</span><span style="color: #0000BB">$script_tz</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(</span><span style="color: #DD0000">'date.timezone'</span><span style="color: #007700">))){<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Script&nbsp;timezone&nbsp;differs&nbsp;from&nbsp;ini-set&nbsp;timezone.'</span><span style="color: #007700">;<br>}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Script&nbsp;timezone&nbsp;and&nbsp;ini-set&nbsp;timezone&nbsp;match.'</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.date-default-timezone-set-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   </p><table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.0</td>
       <td>
        Now throws <strong><code>E_WARNING</code></strong> rather than
        <strong><code>E_STRICT</code></strong>.
       </td>
      </tr>

      <tr>
       <td>5.1.2</td>
       <td>
        The function started to validate the
        <code class="parameter">timezone_identifier</code> parameter.
       </td>
      </tr>

     </tbody>
    
   </table>

  <p></p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.date-default-timezone-set-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.date-default-timezone-get.html" class="function" rel="rdfs-seeAlso">date_default_timezone_get()</a> - Gets the default timezone used by all date/time functions in a script</span></li>
    <li class="member"><a href="timezones.html" class="xref">List of Supported Timezones</a></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="95564">  
  <a class="name">
  <strong class="user"><em>Christopher Kramer</em></strong></a><div class="date" title="2010-01-09 07:52"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95564">
<div class="phpcode"><code><span class="html">
I experienced that using this function highly increases performance of functions like getdate() or date() using PHP 5.2.6 on Windows.<br>I experienced similar results on Linux servers with PHP 5.2.6 and 5.2.10, although the difference was not that significant on these servers: The PHP 5.2.10 server did run with date_default_timezone_set ("only") twice as fast as without. The 5.2.6 server did 5 times faster with date_default_timezone_set. As you can see below, the 5.2.6-Windows machine did a LOT faster.<br>Of course these machines have completely different hardware and can not really be compared, but all show improved performance.<br><br>I checked PHP 4.4.9 on Windows (without date_default_timezone_set of course) and noticed that its as fast as PHP 5.2.6 with date_default_timezone_set.<br><br>The following script shows this:<br><br><span class="default">&lt;?php<br><br></span><span class="comment"># uncomment to see difference<br># date_default_timezone_set(date_default_timezone_get());<br><br></span><span class="keyword">function </span><span class="default">getmicrotime</span><span class="keyword">()<br> {<br> list(</span><span class="default">$usec</span><span class="keyword">, </span><span class="default">$sec</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">,</span><span class="default">microtime</span><span class="keyword">());<br> return (</span><span class="default">$sec</span><span class="keyword">.</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$usec</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">7</span><span class="keyword">));<br> }<br> <br></span><span class="default">$start</span><span class="keyword">=</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">2005</span><span class="keyword">);<br></span><span class="default">$end</span><span class="keyword">=</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">2020</span><span class="keyword">);<br></span><span class="default">$nr</span><span class="keyword">=</span><span class="default">50000</span><span class="keyword">;<br> <br></span><span class="default">$start_time</span><span class="keyword">=</span><span class="default">getmicrotime</span><span class="keyword">();<br>for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$nr</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br></span><span class="comment"># $value=getdate(rand($start,$end));<br>&nbsp; </span><span class="default">date</span><span class="keyword">(</span><span class="string">"H:i:s d.m.Y"</span><span class="keyword">,</span><span class="default">rand</span><span class="keyword">(</span><span class="default">$start</span><span class="keyword">,</span><span class="default">$end</span><span class="keyword">));<br>}<br></span><span class="default">$end_time</span><span class="keyword">=</span><span class="default">getmicrotime</span><span class="keyword">();<br><br>echo </span><span class="string">"Time: "</span><span class="keyword">.(</span><span class="default">$end_time</span><span class="keyword">-</span><span class="default">$start_time</span><span class="keyword">);<br><br></span><span class="comment">// With date_default_timezone_set(): "Time: 0.379343986511"<br>// Without date_default_timezone_set(): "Time: 7.4971370697"<br><br></span><span class="default">?&gt;<br></span><br>Note that the timezone is not changed, it is only set again. I really wonder why this makes such a big performance difference, but its good to know.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113864">  
  <a class="name">
  <strong class="user"><em>chris at clwill dot com</em></strong></a><div class="date" title="2013-12-10 11:54"><strong>8 months ago</strong></div>
  <div class="text" id="Hcom113864">
<div class="phpcode"><code><span class="html">
I'm sure I'm not the only one who is distressed by the recent default behavior change to E_NOTICE when the timezone isn't explicitly set in the program or in .ini.&nbsp; I insure that the clock on the server IS correct, and I don't want to have to set it in two places (the system AND PHP).&nbsp; So I want to read it from the system.&nbsp; But PHP won't accept that answer, and insists on a call to this function.&nbsp; So, here's my answer:<br><br><span class="default">&lt;?php<br> </span><span class="keyword">function </span><span class="default">setTimezone</span><span class="keyword">(</span><span class="default">$default</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$timezone </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// On many systems (Mac, for instance) "/etc/localtime" is a symlink<br>&nbsp; &nbsp; // to the file with the timezone info<br>&nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">is_link</span><span class="keyword">(</span><span class="string">"/etc/localtime"</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// If it is, that file's name is actually the "Olsen" format timezone<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$filename </span><span class="keyword">= </span><span class="default">readlink</span><span class="keyword">(</span><span class="string">"/etc/localtime"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">"zoneinfo"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$pos</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// When it is, it's in the "/usr/share/zoneinfo/" folder<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$timezone </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$pos </span><span class="keyword">+ </span><span class="default">strlen</span><span class="keyword">(</span><span class="string">"zoneinfo/"</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// If not, bail<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$timezone </span><span class="keyword">= </span><span class="default">$default</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; else {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// On other systems, like Ubuntu, there's file with the Olsen time<br>&nbsp; &nbsp; &nbsp; &nbsp; // right inside it.<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$timezone </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"/etc/timezone"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (!</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$timezone</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$timezone </span><span class="keyword">= </span><span class="default">$default</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">date_default_timezone_set</span><span class="keyword">(</span><span class="default">$timezone</span><span class="keyword">);<br> }<br></span><span class="default">?&gt;<br></span><br>Use it by calling it with a fallback default answer.<br><br>Yes, I know it doesn't work on Windows.&nbsp; Neither do I :)&nbsp; Perhaps someone wants to add that functionality.<br><br>Hope this helps someone.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="73174">  
  <a class="name">
  <strong class="user"><em>PeerGoal.com</em></strong></a><div class="date" title="2007-02-12 04:21"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom73174">
<div class="phpcode"><code><span class="html">
The problem:<br><br>date() [function.date]: It is not safe to rely on the system's timezone settings. Please use the date.timezone setting, the TZ environment variable or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected 'America/Los_Angeles' for 'PST/-8.0/no DST' instead<br><br>Of course this is a problem that recently surfaced since PHP5. Quick fix is to set your time zone, add this line to your php code:<br><br>date_default_timezone_set("America/Los_Angeles");</span>
</code></div>
  </div>
 </div>
  <div class="note" id="100357">  
  <a class="name">
  <strong class="user"><em>steve at pozzie dot net</em></strong></a><div class="date" title="2010-10-11 01:35"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom100357">
<div class="phpcode"><code><span class="html">
Most of the scripts here depend on PHP identifying the correct zone when one is not set, but that does not always happen. 
<br>
<br>For example PHP 5.3.3 gives a 'UTC' result for a detected '8.0/no DST'. Not much help.
<br>
<br>So for those of us who for very good reasons really cannot set time zones in scripts of in .ini files, here is a function 
<br>for use in a Windows environment that sets the default time zone to the OS time zone and returns the detected and set texts.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">date_system_timezone_set</span><span class="keyword">(){
<br>&nbsp; </span><span class="default">$shell </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WScript.Shell"</span><span class="keyword">) or die(</span><span class="string">"Requires Windows Scripting Host"</span><span class="keyword">);
<br>&nbsp; </span><span class="default">$time_bias </span><span class="keyword">= -(</span><span class="default">$shell</span><span class="keyword">-&gt;</span><span class="default">RegRead</span><span class="keyword">(
<br></span><span class="string">"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control
<br>\\TimeZoneInformation\\Bias"</span><span class="keyword">))/</span><span class="default">60</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$ab </span><span class="keyword">= -(</span><span class="default">$shell</span><span class="keyword">-&gt;</span><span class="default">RegRead</span><span class="keyword">(
<br></span><span class="string">"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control
<br>\\TimeZoneInformation\\ActiveTimeBias"</span><span class="keyword">))/</span><span class="default">60</span><span class="keyword">;
<br>&nbsp; </span><span class="default">$sc </span><span class="keyword">= </span><span class="default">$shell</span><span class="keyword">-&gt;</span><span class="default">RegRead</span><span class="keyword">(
<br></span><span class="string">"HKEY_USERS\\.DEFAULT\\Control Panel\\International\\sCountry"</span><span class="keyword">);
<br>&nbsp; foreach(</span><span class="default">timezone_abbreviations_list</span><span class="keyword">() as </span><span class="default">$tza</span><span class="keyword">) foreach(</span><span class="default">$tza </span><span class="keyword">as </span><span class="default">$entry</span><span class="keyword">){
<br>&nbsp; &nbsp; </span><span class="default">$country </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'timezone_id'</span><span class="keyword">],</span><span class="string">'/'</span><span class="keyword">);
<br>&nbsp; &nbsp; </span><span class="default">$locale </span><span class="keyword">= </span><span class="default">strtok</span><span class="keyword">(</span><span class="string">'|'</span><span class="keyword">);
<br>&nbsp; &nbsp; if(</span><span class="default">$country</span><span class="keyword">==</span><span class="default">$sc </span><span class="keyword">&amp;&amp; </span><span class="default">$ab</span><span class="keyword">==(</span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'offset'</span><span class="keyword">]/</span><span class="default">60</span><span class="keyword">/</span><span class="default">60</span><span class="keyword">) &amp;&amp; (</span><span class="default">$ds </span><span class="keyword">= </span><span class="default">$time_bias</span><span class="keyword">!=</span><span class="default">$ab</span><span class="keyword">)==</span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'dst'</span><span class="keyword">]){
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">date_default_timezone_set</span><span class="keyword">(</span><span class="default">$timezone_identifier </span><span class="keyword">= </span><span class="default">$country</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$locale</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; return </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%.1f'</span><span class="keyword">,</span><span class="default">$ab</span><span class="keyword">).</span><span class="string">"/"</span><span class="keyword">.(</span><span class="default">$ds</span><span class="keyword">?</span><span class="string">''</span><span class="keyword">:</span><span class="string">'no '</span><span class="keyword">).</span><span class="string">'DST'</span><span class="keyword">.</span><span class="string">" "</span><span class="keyword">.</span><span class="default">$timezone_identifier</span><span class="keyword">;
<br>&nbsp; &nbsp;&nbsp; }
<br>&nbsp;&nbsp; }
<br>&nbsp; return </span><span class="default">false</span><span class="keyword">; 
<br> }
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96551">  
  <a class="name">
  <strong class="user"><em>Frederick Hathaway</em></strong></a><div class="date" title="2010-03-04 08:54"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom96551">
<div class="phpcode"><code><span class="html">
It's really a hassle that there is no way to set the timezone offset. I attempted to use the code that searched for the correct timezone name by offset from below. I found it didn't work reliably since various cities may have different rules about time DST etc. My solution is to actually search the array and do a test to insure the offset is what I expect it to be. It seems very kludgey (if thats a word) but it works. 
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">setTimezoneByOffset</span><span class="keyword">(</span><span class="default">$offset</span><span class="keyword">) 
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$testTimestamp </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">date_default_timezone_set</span><span class="keyword">(</span><span class="string">'UTC'</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$testLocaltime </span><span class="keyword">= </span><span class="default">localtime</span><span class="keyword">(</span><span class="default">$testTimestamp</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$testHour </span><span class="keyword">= </span><span class="default">$testLocaltime</span><span class="keyword">[</span><span class="string">'tm_hour'</span><span class="keyword">];&nbsp; &nbsp; &nbsp; &nbsp; 
<br>
<br>&nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; </span><span class="default">$abbrarray </span><span class="keyword">= </span><span class="default">timezone_abbreviations_list</span><span class="keyword">();
<br>&nbsp; &nbsp; foreach (</span><span class="default">$abbrarray </span><span class="keyword">as </span><span class="default">$abbr</span><span class="keyword">) 
<br>&nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//echo $abbr."&lt;br&gt;";
<br>&nbsp; &nbsp; &nbsp; </span><span class="keyword">foreach (</span><span class="default">$abbr </span><span class="keyword">as </span><span class="default">$city</span><span class="keyword">) 
<br>&nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">date_default_timezone_set</span><span class="keyword">(</span><span class="default">$city</span><span class="keyword">[</span><span class="string">'timezone_id'</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$testLocaltime&nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">localtime</span><span class="keyword">(</span><span class="default">$testTimestamp</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$hour&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">$testLocaltime</span><span class="keyword">[</span><span class="string">'tm_hour'</span><span class="keyword">];&nbsp; &nbsp; &nbsp; &nbsp; 
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$testOffset </span><span class="keyword">=&nbsp; </span><span class="default">$hour </span><span class="keyword">- </span><span class="default">$testHour</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$testOffset </span><span class="keyword">== </span><span class="default">$offset</span><span class="keyword">)
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; }
<br>&nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; }
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84459">  
  <a class="name">
  <strong class="user"><em>Rob Kaper</em></strong></a><div class="date" title="2008-07-15 01:46"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom84459">
<div class="phpcode"><code><span class="html">
If you want users to choose their own timezones, here's some code that gets all available timezones but only uses one city for each possible value:<br><br><span class="default">&lt;?php<br><br>$timezones </span><span class="keyword">= </span><span class="default">DateTimeZone</span><span class="keyword">::</span><span class="default">listAbbreviations</span><span class="keyword">();<br><br></span><span class="default">$cities </span><span class="keyword">= array();<br>foreach( </span><span class="default">$timezones </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$zones </span><span class="keyword">)<br>{<br>&nbsp; &nbsp; foreach( </span><span class="default">$zones </span><span class="keyword">as </span><span class="default">$id </span><span class="keyword">=&gt; </span><span class="default">$zone </span><span class="keyword">)<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Only get timezones explicitely not part of "Others".<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * @see <a rel="nofollow" target="_blank">http://www.php.net/manual/en/timezones.others.php</a><br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if ( </span><span class="default">preg_match</span><span class="keyword">( </span><span class="string">'/^(America|Antartica|Arctic|Asia|Atlantic|Europe|Indian|Pacific)\//'</span><span class="keyword">, </span><span class="default">$zone</span><span class="keyword">[</span><span class="string">'timezone_id'</span><span class="keyword">] ) )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$cities</span><span class="keyword">[</span><span class="default">$zone</span><span class="keyword">[</span><span class="string">'timezone_id'</span><span class="keyword">]][] = </span><span class="default">$key</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>}<br><br></span><span class="comment">// For each city, have a comma separated list of all possible timezones for that city.<br></span><span class="keyword">foreach( </span><span class="default">$cities </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">)<br>&nbsp; &nbsp; </span><span class="default">$cities</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">join</span><span class="keyword">( </span><span class="string">', '</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br><br></span><span class="comment">// Only keep one city (the first and also most important) for each set of possibilities. <br></span><span class="default">$cities </span><span class="keyword">= </span><span class="default">array_unique</span><span class="keyword">( </span><span class="default">$cities </span><span class="keyword">);<br><br></span><span class="comment">// Sort by area/city name.<br></span><span class="default">ksort</span><span class="keyword">( </span><span class="default">$cities </span><span class="keyword">);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115128">  
  <a class="name">
  <strong class="user"><em>Taylor</em></strong></a><div class="date" title="2014-05-30 09:47"><strong>2 months ago</strong></div>
  <div class="text" id="Hcom115128">
<div class="phpcode"><code><span class="html">
I was having major issues with the date.timezone setting after I updated from 5.3.3 to 5.4.29. I still need to update further, and perhaps it's a bug in this version that will be fixed when I update..<br><br>But to fix the issue of php not being about to find my time zone, I added a .htaccess file to the root of my web directory. All I have in it is this one line (without quotes)<br><br>"php_value date.timezone America/Denver"<br><br>And now the timezone is set in any directory I browse in. Very strange, and I still haven't figured out why It wont work from the php.ini file. But here's how to overcome the frustration.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109321">  
  <a class="name">
  <strong class="user"><em>Pierre Gourlaouen</em></strong></a><div class="date" title="2012-07-06 08:45"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom109321">
<div class="phpcode"><code><span class="html">
A simple method for conversation between two time zone.
<br>
<br><span class="default">&lt;?php
<br>$date </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">"2012-07-05 16:43:21"</span><span class="keyword">, new </span><span class="default">DateTimeZone</span><span class="keyword">(</span><span class="string">'Europe/Paris'</span><span class="keyword">));
<br>
<br></span><span class="default">date_default_timezone_set</span><span class="keyword">(</span><span class="string">'America/New_York'</span><span class="keyword">);
<br>
<br>echo </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y-m-d h:iA"</span><span class="keyword">, </span><span class="default">$date</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">'U'</span><span class="keyword">));
<br>
<br></span><span class="comment">// 2012-07-05 10:43AM
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="102187">  
  <a class="name">
  <strong class="user"><em>power2all at gmail dot com</em></strong></a><div class="date" title="2011-02-01 08:30"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom102187">
<div class="phpcode"><code><span class="html">
After poundering and knocking my head on the table, I finally got a proper fix for Windows and PHP timezone handling.<br><br>Since Windows applies the DST to ActiveTimeBias in the registry, you only need this to apply.<br>The only problem is, that it cant use the timezone_set command.<br><br>You can request a response back in any date-format you wish, or use the default one given in the function itself.<br><br><span class="default">&lt;?php<br><br></span><span class="comment">// Return proper time<br></span><span class="keyword">function </span><span class="default">time_zone_fix</span><span class="keyword">(</span><span class="default">$timeGiven </span><span class="keyword">= </span><span class="string">"H:i:s"</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$shell </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WScript.Shell"</span><span class="keyword">) or die(</span><span class="string">"Requires Windows Scripting Host"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$time_bias </span><span class="keyword">= -(</span><span class="default">$shell</span><span class="keyword">-&gt;</span><span class="default">RegRead</span><span class="keyword">(</span><span class="string">"HKEY_LOCAL_MACHINE\\SYSTEM\\<br>CurrentControlSet\\Control\\TimeZoneInformation\\<br>ActiveTimeBias"</span><span class="keyword">)) / </span><span class="default">60</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$timestamp_bias </span><span class="keyword">= </span><span class="default">60 </span><span class="keyword">* </span><span class="default">60 </span><span class="keyword">* </span><span class="default">$time_bias</span><span class="keyword">;<br>&nbsp; &nbsp; echo </span><span class="default">$time_bias </span><span class="keyword">. </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br>&nbsp; &nbsp; return </span><span class="default">gmdate</span><span class="keyword">(</span><span class="default">$timeGiven</span><span class="keyword">, </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$timestamp_bias </span><span class="keyword">. </span><span class="string">" seconds"</span><span class="keyword">));<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111624">  
  <a class="name">
  <strong class="user"><em>Christopher Kramer</em></strong></a><div class="date" title="2013-03-09 09:39"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom111624">
<div class="phpcode"><code><span class="html">
Regarding my post 3 years before:<br>The performance impact seems to be caused by the fact that a log message is written if you do not set a timezone. And writing a log message to disk can take significantly longer than actually calculating date() or getdate() - esp. on systems with slow IO like the Windows machine I used 3 years ago.<br><br>PHP 4 did not produce any log messages, and therefore was as fast as PHP5 with a timezone set.<br><br>So if you run date() or getdate() a lot of times, this will cause a lot of log messages to be written to disk (if you did not disable them in your php.ini settings), which will take its time.<br><br>So either use this function or set the ini-setting "date.timezone" to make things faster.<br>(And have a look into your logfiles! Solving all those warnings will not only save you disk space but will also speed up your web application.)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="99865">  
  <a class="name">
  <strong class="user"><em>Tom S</em></strong></a><div class="date" title="2010-09-11 06:22"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom99865">
<div class="phpcode"><code><span class="html">
This is a good script if you know or control your system so that you know that the local TZ in your OS is correct. Unfortunately, this script still creates an warning message under BSD UNIX.<br><br>To fix this, just add an "@" in front of "localtime" as:<br><br>$arr = @localtime($iTime);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="71909">  
  <a class="name">
  <strong class="user"><em>davidn at datalinktech dot com dot au</em></strong></a><div class="date" title="2006-12-21 05:27"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom71909">
<div class="phpcode"><code><span class="html">
Note that there may be some unexpected side-effects that result from using either set_default_timezone() or the putenv("TZ=...") workalike for earlier PHP versions.&nbsp; ANY date formatted and output either by PHP or its apache host process will be unconditionally expressed in that timezone.
<br>
<br>[red. That is only true for the putenv() hack - Derick]
<br>
<br>This does indeed include the web server's logs and other output files and reports which by default usually do not include any indication of timezone. This has a further side-effect on log processing and analysis, obviously.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="101020">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2010-11-20 01:58"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom101020">
<div class="phpcode"><code><span class="html">
People complaining that there's no way to set the offset - you are wrong. You can easily set the offset from GMT (see "Other" in available zones). And since all zones are offset from GMT it's just easy math with + or - to get that. So if you i.e. want the offset not from GMT but your timezone, then compute offset of your zone from GMT (say if you in Berlin its +1 now (mind summer time!)) and then offset for your target zone (i.e NYC is -5) then sum abs! of these values and set the sign of bigger (abs) value -&gt; total offset from your european zone to NYC is then abs(-5)+abs(1) = 6 and set "-" as NYC zone absolute value is bigger. So whatever time is in Berlin, in NYC it's 6hrs earlier. But it's better to do two step calculation and calculate always from GMT</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86950">  
  <a class="name">
  <strong class="user"><em>jason at jasonpriem dot com</em></strong></a><div class="date" title="2008-11-11 08:29"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom86950">
<div class="phpcode"><code><span class="html">
While it's easy to change timezones based on names or abbreviations, I haven't found any straightforward way of doing so using an offset integer.&nbsp; This situation comes up if you're using AJAX to get information about a user's timezone; javascript's getTimezoneOffset() method just sends you an offset number. So, here's my clunky solution: an adaptation of chris' function at <a rel="nofollow" target="_blank">http://us.php.net/manual/en/function.timezone-name-from-abbr.php.</a>
<br>
<br><span class="default">&lt;?php
<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">set_tz_by_offset</span><span class="keyword">(</span><span class="default">$offset</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">$offset</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$abbrarray </span><span class="keyword">= </span><span class="default">timezone_abbreviations_list</span><span class="keyword">();
<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$abbrarray </span><span class="keyword">as </span><span class="default">$abbr</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//echo $abbr."&lt;br&gt;";
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">foreach (</span><span class="default">$abbr </span><span class="keyword">as </span><span class="default">$city</span><span class="keyword">) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//echo $city['offset']." $offset&lt;br&gt;";
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">$city</span><span class="keyword">[</span><span class="string">'offset'</span><span class="keyword">] == </span><span class="default">$offset</span><span class="keyword">) { </span><span class="comment">// remember to multiply $offset by -1 if you're getting it from js
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">date_default_timezone_set</span><span class="keyword">(</span><span class="default">$city</span><span class="keyword">[</span><span class="string">'timezone_id'</span><span class="keyword">]);
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; &nbsp; &nbsp; }
<br>&nbsp; &nbsp; </span><span class="default">date_default_timezone_set</span><span class="keyword">(</span><span class="string">"ust"</span><span class="keyword">);
<br>&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br>&nbsp; &nbsp; &nbsp;&nbsp; }
<br>
<br></span><span class="default">set_tz_by_offset</span><span class="keyword">(-</span><span class="default">1</span><span class="keyword">);
<br>
<br></span><span class="default">?&gt;
<br></span>
<br>[EDIT BY thiago AT php DOT net: This code has contributions from iateadonut at gmail dot com]</span>
</code></div>
  </div>
 </div>
  <div class="note" id="107297">  
  <a class="name">
  <strong class="user"><em>daneiracleous at gmail dot com</em></strong></a><div class="date" title="2012-01-28 08:11"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom107297">
<div class="phpcode"><code><span class="html">
If you want to set the default timezone to the user's local timezone, you have to combine PHP and JavaScript. Here's how to do it:<br><br><span class="default">&lt;?php<br>session_start</span><span class="keyword">();<br>if(!isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'timezone'</span><span class="keyword">]))<br>{<br>&nbsp; &nbsp; if(!isset(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'offset'</span><span class="keyword">]))<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; </span><span class="default">?&gt;<br></span>&nbsp; &nbsp; &lt;script&gt;<br>&nbsp; &nbsp; var d = new Date()<br>&nbsp; &nbsp; var offset= -d.getTimezoneOffset()/60;<br>&nbsp; &nbsp; location.href = "<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">]; </span><span class="default">?&gt;</span>?offset="+offset;<br>&nbsp; &nbsp; &lt;/script&gt;<br>&nbsp; &nbsp; <span class="default">&lt;?php&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="keyword">}<br>&nbsp; &nbsp; else<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$zonelist </span><span class="keyword">= array(</span><span class="string">'Kwajalein' </span><span class="keyword">=&gt; -</span><span class="default">12.00</span><span class="keyword">, </span><span class="string">'Pacific/Midway' </span><span class="keyword">=&gt; -</span><span class="default">11.00</span><span class="keyword">, </span><span class="string">'Pacific/Honolulu' </span><span class="keyword">=&gt; -</span><span class="default">10.00</span><span class="keyword">, </span><span class="string">'America/Anchorage' </span><span class="keyword">=&gt; -</span><span class="default">9.00</span><span class="keyword">, </span><span class="string">'America/Los_Angeles' </span><span class="keyword">=&gt; -</span><span class="default">8.00</span><span class="keyword">, </span><span class="string">'America/Denver' </span><span class="keyword">=&gt; -</span><span class="default">7.00</span><span class="keyword">, </span><span class="string">'America/Tegucigalpa' </span><span class="keyword">=&gt; -</span><span class="default">6.00</span><span class="keyword">, </span><span class="string">'America/New_York' </span><span class="keyword">=&gt; -</span><span class="default">5.00</span><span class="keyword">, </span><span class="string">'America/Caracas' </span><span class="keyword">=&gt; -</span><span class="default">4.30</span><span class="keyword">, </span><span class="string">'America/Halifax' </span><span class="keyword">=&gt; -</span><span class="default">4.00</span><span class="keyword">, </span><span class="string">'America/St_Johns' </span><span class="keyword">=&gt; -</span><span class="default">3.30</span><span class="keyword">, </span><span class="string">'America/Argentina/Buenos_Aires' </span><span class="keyword">=&gt; -</span><span class="default">3.00</span><span class="keyword">, </span><span class="string">'America/Sao_Paulo' </span><span class="keyword">=&gt; -</span><span class="default">3.00</span><span class="keyword">, </span><span class="string">'Atlantic/South_Georgia' </span><span class="keyword">=&gt; -</span><span class="default">2.00</span><span class="keyword">, </span><span class="string">'Atlantic/Azores' </span><span class="keyword">=&gt; -</span><span class="default">1.00</span><span class="keyword">, </span><span class="string">'Europe/Dublin' </span><span class="keyword">=&gt; </span><span class="default">0</span><span class="keyword">, </span><span class="string">'Europe/Belgrade' </span><span class="keyword">=&gt; </span><span class="default">1.00</span><span class="keyword">, </span><span class="string">'Europe/Minsk' </span><span class="keyword">=&gt; </span><span class="default">2.00</span><span class="keyword">, </span><span class="string">'Asia/Kuwait' </span><span class="keyword">=&gt; </span><span class="default">3.00</span><span class="keyword">, </span><span class="string">'Asia/Tehran' </span><span class="keyword">=&gt; </span><span class="default">3.30</span><span class="keyword">, </span><span class="string">'Asia/Muscat' </span><span class="keyword">=&gt; </span><span class="default">4.00</span><span class="keyword">, </span><span class="string">'Asia/Yekaterinburg' </span><span class="keyword">=&gt; </span><span class="default">5.00</span><span class="keyword">, </span><span class="string">'Asia/Kolkata' </span><span class="keyword">=&gt; </span><span class="default">5.30</span><span class="keyword">, </span><span class="string">'Asia/Katmandu' </span><span class="keyword">=&gt; </span><span class="default">5.45</span><span class="keyword">, </span><span class="string">'Asia/Dhaka' </span><span class="keyword">=&gt; </span><span class="default">6.00</span><span class="keyword">, </span><span class="string">'Asia/Rangoon' </span><span class="keyword">=&gt; </span><span class="default">6.30</span><span class="keyword">, </span><span class="string">'Asia/Krasnoyarsk' </span><span class="keyword">=&gt; </span><span class="default">7.00</span><span class="keyword">, </span><span class="string">'Asia/Brunei' </span><span class="keyword">=&gt; </span><span class="default">8.00</span><span class="keyword">, </span><span class="string">'Asia/Seoul' </span><span class="keyword">=&gt; </span><span class="default">9.00</span><span class="keyword">, </span><span class="string">'Australia/Darwin' </span><span class="keyword">=&gt; </span><span class="default">9.30</span><span class="keyword">, </span><span class="string">'Australia/Canberra' </span><span class="keyword">=&gt; </span><span class="default">10.00</span><span class="keyword">, </span><span class="string">'Asia/Magadan' </span><span class="keyword">=&gt; </span><span class="default">11.00</span><span class="keyword">, </span><span class="string">'Pacific/Fiji' </span><span class="keyword">=&gt; </span><span class="default">12.00</span><span class="keyword">, </span><span class="string">'Pacific/Tongatapu' </span><span class="keyword">=&gt; </span><span class="default">13.00</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$index </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$zonelist</span><span class="keyword">, </span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'offset'</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'timezone'</span><span class="keyword">] = </span><span class="default">$index</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br>&nbsp; &nbsp; }<br>}<br></span><span class="default">date_default_timezone_set</span><span class="keyword">(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'timezone'</span><span class="keyword">]);<br><br></span><span class="comment">//rest of your code goes here<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="87389">  
  <a class="name">
  <strong class="user"><em>ted dot chou12 at gmail dot com</em></strong></a><div class="date" title="2008-12-02 11:13"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom87389">
<div class="phpcode"><code><span class="html">
Timezone using other approaches:<br><span class="default">&lt;?php $datetime </span><span class="keyword">= </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$originaldatetime</span><span class="keyword">) + </span><span class="default">$time</span><span class="keyword">;<br></span><span class="default">$datetime </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">'M d, Y h:i A'</span><span class="keyword">, </span><span class="default">$datetime</span><span class="keyword">);</span><span class="default">?&gt;<br></span><br>$time obtained from table below:<br>-25200|International Date Line (West) GMT-12|<br>-21600|Midway Island, Samoa GMT-11|<br>-18000|Hawaii, Honolulu GMT-10|<br>-14400|Alaska GMT-9|<br>-10800|Pacific Standard Time, US, Canada GMT-8|<br>-7200|British Columbia N.E., Santa Fe, Mountain Time GMT-7|<br>-3600|Central America, Chicago, Guatamala, Mexico City GMT-6|<br>0|US, Canada, Bogota, Boston, New York GMT-5|<br>+3600|Canada, Santiago, Atlantic Standard Time GMT-4|<br>+7200|Brazilia, Buenos Aires, Georgetown, Greenland GMT-3|<br>+10800|Mid-Atlantic GMT-2|<br>+14400|Azores, Cape Verde Is., Western Africa Time GMT-1|<br>+18000|London, Iceland, Ireland, Morocco, Portugal GMT|<br>+21600|Amsterdam, Berlin, Bern, Madrid, Paris, Rome, GMT+1|<br>+25200|Athens, Cairo, Cape Town, Finland, Greece, Israel GMT+2|<br>+28800|Ankara, Aden, Baghdad, Beruit, Kuwait, Moscow GMT+3|<br>+32400|Abu Dhabi, Baku, Kabul, Tehran, Tbilisi, Volgograd GMT+4|<br>+36000|Calcutta, Colombo, Islamabad, Madras, New Dehli GMT+5|<br>+39600|Almaty, Dhakar, Kathmandu, Colombo, Sri Lanka GMT+6|<br>+43200|Bangkok, Hanoi, Jakarta, Phnom Penh, Australia GMT+7|<br>+46800|Taipei, Beijing, Hong Kong, Singapore, GMT+8|<br>+50400|Seoul, Tokyo, Central Australia GMT+9|<br>+54000|Brisbane, Canberra, Guam, Melbourne, Sydney, GMT+10|<br>+57600|Magadan, New Caledonia, Solomon Is. GMT+11|<br>+61200|Auckland, Fiji, Kamchatka, Marshall, Wellington, GMT+12|</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.date-default-timezone-set.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:05:38 GMT -->


</body></html>