<html><!-- Mirrored from php.net/manual/en/ini.sect.safe-mode.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:29:12 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Security and Safe Mode</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="ini.sect.safe-mode.html">
 <link rel="shorturl" href="ini.sect.safe-mode.html">
 <link rel="alternate" href="ini.sect.safe-mode.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="features.safe-mode.html">
 <link rel="prev" href="features.safe-mode.html">
 <link rel="next" href="features.safe-mode.functions.html">

 <link rel="alternate" href="ini.sect.safe-mode.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/ini.sect.safe-mode.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/ini.sect.safe-mode.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/ini.sect.safe-mode.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/ini.sect.safe-mode.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/ini.sect.safe-mode.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/ini.sect.safe-mode.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/ini.sect.safe-mode.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/ini.sect.safe-mode.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/ini.sect.safe-mode.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/ini.sect.safe-mode.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="features.html">Features</a></li>      <li><a href="features.safe-mode.html">Safe Mode</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="ini.sect.safe-mode" class="sect1">
   <h2 class="title">Security and Safe Mode</h2>
   <p class="para">
    </p><table class="doctable table">
     <caption><strong>Security and Safe Mode Configuration Directives</strong></caption>
     
      <thead>
       <tr>
        <th>Name</th>
        <th>Default</th>
        <th>Changeable</th>
        <th>Changelog</th>
       </tr>

      </thead>

      <tbody class="tbody">
       <tr>
        <td><a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe_mode</a></td>
        <td>"0"</td>
        <td>PHP_INI_SYSTEM</td>
        <td>Removed in PHP 5.4.0.</td>
       </tr>

       <tr>
        <td><a href="ini.sect.safe-mode.html#ini.safe-mode-gid" class="link">safe_mode_gid</a></td>
        <td>"0"</td>
        <td>PHP_INI_SYSTEM</td>
        <td>Available since PHP 4.1.0. Removed in PHP 5.4.0.</td>
       </tr>

       <tr>
        <td><a href="ini.sect.safe-mode.html#ini.safe-mode-include-dir" class="link">safe_mode_include_dir</a></td>
        <td>NULL</td>
        <td>PHP_INI_SYSTEM</td>
        <td>Available since PHP 4.1.0. Removed in PHP 5.4.0.</td>
       </tr>

       <tr>
        <td><a href="ini.sect.safe-mode.html#ini.safe-mode-exec-dir" class="link">safe_mode_exec_dir</a></td>
        <td>""</td>
        <td>PHP_INI_SYSTEM</td>
        <td>Removed in PHP 5.4.0.</td>
       </tr>

       <tr>
        <td><a href="ini.sect.safe-mode.html#ini.safe-mode-allowed-env-vars" class="link">safe_mode_allowed_env_vars</a></td>
        <td>"PHP_"</td>
        <td>PHP_INI_SYSTEM</td>
        <td>Removed in PHP 5.4.0.</td>
       </tr>

       <tr>
        <td><a href="ini.sect.safe-mode.html#ini.safe-mode-protected-env-vars" class="link">safe_mode_protected_env_vars</a></td>
        <td>"LD_LIBRARY_PATH"</td>
        <td>PHP_INI_SYSTEM</td>
        <td>Removed in PHP 5.4.0.</td>
       </tr>

      </tbody>
     
    </table>

    For further details and definitions of the
PHP_INI_* modes, see the <a href="configuration.changes.modes.html" class="xref">Where a configuration setting may be set</a>.
   <p></p>
   
   <p class="para">Here's a short explanation of
the configuration directives.</p>
   
   <p class="para">
    </p><dl>

     
      <dt id="ini.safe-mode">
       <code class="parameter">safe_mode</code>
       <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
      </dt>

      <dd>

       <p class="para">
        Whether to enable PHP's safe mode.
        If PHP is compiled with <em>--enable-safe-mode</em> then
        defaults to On, otherwise Off.
       </p>
       <div class="warning"><strong class="warning">Warning</strong><p class="simpara">This feature has been
<em class="emphasis">DEPRECATED</em> as of PHP 5.3.0 and <em class="emphasis">REMOVED</em>
as of PHP 5.4.0.</p></div>
      </dd>

     
     
      <dt id="ini.safe-mode-gid">
       <code class="parameter">safe_mode_gid</code>
       <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
      </dt>

      <dd>

       <p class="para">
        By default, Safe Mode does a UID compare check when
        opening files. If you want to relax this to a GID compare,
        then turn on safe_mode_gid.
        Whether to use <em>UID</em> (<strong><code>FALSE</code></strong>) or
        <em>GID</em> (<strong><code>TRUE</code></strong>) checking upon file
        access.
       </p>
      </dd>

     
     
      <dt id="ini.safe-mode-include-dir">
       <code class="parameter">safe_mode_include_dir</code>
       <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
      </dt>

      <dd>

       <p class="para">
        <em>UID</em>/<em>GID</em> checks are bypassed when
        including files from this directory and its subdirectories (directory
        must also be in <a href="ini.core.html#ini.include-path" class="link">include_path</a>
        or full path must including).
       </p>
       <span class="simpara">
        As of PHP 4.2.0, this directive can take a colon (semi-colon on
        Windows) separated path in a fashion similar to the
        <a href="ini.core.html#ini.include-path" class="link">include_path</a> directive,
        rather than just a single directory.
       </span>
       <span class="simpara">
        The restriction specified is actually a prefix, not a directory name. 
        This means that "<em>safe_mode_include_dir = /dir/incl</em>" also allows
        access to "<em>/dir/include</em>" and
        "<em>/dir/incls</em>" if they exist.  When you 
        want to restrict access to only the specified directory, end with a 
        slash. For example: "<em>safe_mode_include_dir = /dir/incl/</em>"
       </span>
       <span class="simpara">
        If the value of this directive is empty, no files with different
        <em>UID</em>/<em>GID</em> can be included in
        PHP 4.2.3 and as of PHP 4.3.3. In earlier versions, all files could be
        included.
       </span>
      </dd>

     
     
      <dt id="ini.safe-mode-exec-dir">
       <code class="parameter">safe_mode_exec_dir</code>
       <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
      </dt>

      <dd>

       <p class="para">
        If PHP is used in safe mode, <span class="function"><a href="function.system.html" class="function">system()</a></span> and the other
        <a href="ref.exec.html" class="link">functions executing system programs</a>
        refuse to start programs that are not in this directory.
        You have to use <em>/</em> as directory separator on all
        environments including Windows.
       </p>
      </dd>

     
     
      <dt id="ini.safe-mode-allowed-env-vars">
       <code class="parameter">safe_mode_allowed_env_vars</code>
       <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
      </dt>

      <dd>

       <p class="para">
        Setting certain environment variables may be a potential security breach.
        This directive contains a comma-delimited list of prefixes. In Safe Mode,
        the user may only alter environment variables whose names begin with the
        prefixes supplied here. By default, users will only be able to set
        environment variables that begin with <em>PHP_</em>
        (e.g. <em>PHP_FOO=BAR</em>).
       </p>
       <blockquote class="note"><p><strong class="note">Note</strong>: 
        </p><p class="para">
         If this directive is empty, PHP will let the user modify ANY
         environment variable!
        </p>
       <p></p></blockquote>
      </dd>

     
     
      <dt id="ini.safe-mode-protected-env-vars">
       <code class="parameter">safe_mode_protected_env_vars</code>
       <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
      </dt>

      <dd>

       <p class="para">
        This directive contains a comma-delimited list of environment
        variables that the end user won't be able to change using
        <span class="function"><a href="function.putenv.html" class="function">putenv()</a></span>. These variables will be protected
        even if safe_mode_allowed_env_vars is set to allow to change them.
       </p>
      </dd>

     
    </dl>

   <p></p>
   <p class="para">
    See also: <a href="ini.core.html#ini.open-basedir" class="link">open_basedir</a>,
    <a href="ini.core.html#ini.disable-functions" class="link">disable_functions</a>,
    <a href="ini.core.html#ini.disable-classes" class="link">disable_classes</a>,
    <a href="ini.core.html#ini.register-globals" class="link">register_globals</a>,
    <a href="errorfunc.configuration.html#ini.display-errors" class="link">display_errors</a>, and
    <a href="errorfunc.configuration.html#ini.log-errors" class="link">log_errors</a>.
   </p>

  <p class="para">
   When <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe_mode</a> is on, PHP checks to see 
   if the owner of the current script matches the owner of the file to be 
   operated on by a file function or its directory. For example: 
   </p><div class="example-contents">
<div class="lscode"><pre class="lscode">-rw-rw-r--    1 rasmus   rasmus       33 Jul  1 19:20 script.php 
-rw-r--r--    1 root     root       1116 May 26 18:01 /etc/passwd</pre>
</div>
   </div>

   Running <var class="filename">script.php</var>:
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>&nbsp;readfile</span><span style="color: #007700">(</span><span style="color: #DD0000">'/etc/passwd'</span><span style="color: #007700">);&nbsp;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   results in this error when safe mode is enabled: 
   <div class="example-contents screen">
<div class="cdata"><pre>Warning: SAFE MODE Restriction in effect. The script whose uid is 500 is not 
allowed to access /etc/passwd owned by uid 0 in /docroot/script.php on line 2
</pre></div>
   </div>
  <p></p>
  <p class="para">
   However, there may be environments where a strict <em>UID</em>
   check is not appropriate and a relaxed <em>GID</em> check is
   sufficient.  This is supported by means of the <a href="ini.sect.safe-mode.html#ini.safe-mode-gid" class="link">safe_mode_gid</a> switch. Setting it to
   <em>On</em> performs the relaxed <em>GID</em> checking,
   setting it to <em>Off</em> (the default) performs
   <em>UID</em> checking.
  </p>
  <p class="para">
   If instead of <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe_mode</a>, you set an 
   <a href="ini.core.html#ini.open-basedir" class="link">open_basedir</a> directory then all
   file operations will be limited to files under the specified directory.
   For example (Apache <var class="filename">httpd.conf</var> example): 
   </p><div class="example-contents">
<div class="inicode"><pre class="inicode">&lt;Directory /docroot&gt;
  php_admin_value open_basedir /docroot 
&lt;/Directory&gt;</pre>
</div>
   </div>

   If you run the same <var class="filename">script.php</var> with this
   <a href="ini.core.html#ini.open-basedir" class="link">open_basedir</a> setting
   then this is the result: 
   <div class="example-contents screen">
<div class="cdata"><pre>Warning: open_basedir restriction in effect. File is in wrong directory in 
/docroot/script.php on line 2 
</pre></div>
   </div>
  <p></p>
  <p class="para">
   You can also disable individual functions. Note that the
   <a href="ini.core.html#ini.disable-functions" class="link">disable_functions</a>
   directive can not be used outside of the <var class="filename">php.ini</var> file which means that
   you cannot disable functions on a per-virtualhost or per-directory basis
   in your <var class="filename">httpd.conf</var> file.
   If we add this to our <var class="filename">php.ini</var> file: 
   </p><div class="example-contents">
<div class="inicode"><pre class="inicode">disable_functions = readfile,system</pre>
</div>
   </div>

   Then we get this output: 
   <div class="example-contents screen">
<div class="cdata"><pre>Warning: readfile() has been disabled for security reasons in 
/docroot/script.php on line 2 
</pre></div>
   </div>
  <p></p>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">
    These PHP restrictions are not valid in executed binaries, of course.
   </p>
  </div>
 </div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="88614">  
  <a class="name">
  <strong class="user"><em>rayro at gmx dot de</em></strong></a><div class="date" title="2009-01-31 11:18"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88614">
<div class="phpcode"><code><span class="html">
Theres a failure with open_basedir and per-host configuration<br>in apache as described in bug #42836: <a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=42836</a><br><br>I got the same errors on my development windows system and apache 2.2.4 with php 5.3.beta1.<br><br>This error (or similar) is shown:<br>Warning: Unknown: open_basedir restriction in effect. File(...)<br>is not within the allowed path(s): (� �� �@5�,�)<br><br>Fix:<br>&nbsp; - try slashes at the end of the folder name<br>&nbsp; or<br>&nbsp; - put "php_admin_value open_basedir ..." at first of all in the configuration</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/ini.sect.safe-mode.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:29:12 GMT -->


</body></html>