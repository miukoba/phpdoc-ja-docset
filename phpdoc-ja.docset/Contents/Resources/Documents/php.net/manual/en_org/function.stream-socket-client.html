<html><!-- Mirrored from php.net/manual/en/function.stream-socket-client.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:04:49 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>stream_socket_client</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.stream-socket-client.html">
 <link rel="shorturl" href="http://php.net/stream-socket-client">
 <link rel="alternate" href="http://php.net/stream-socket-client" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.stream.html">
 <link rel="prev" href="function.stream-socket-accept.html">
 <link rel="next" href="function.stream-socket-enable-crypto.html">

 <link rel="alternate" href="function.stream-socket-client.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.stream-socket-client.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.stream-socket-client.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.stream-socket-client.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.stream-socket-client.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.stream-socket-client.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.stream-socket-client.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.stream-socket-client.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.stream-socket-client.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.stream-socket-client.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.stream-socket-client.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.basic.other.html">Other Basic Extensions</a></li>      <li><a href="book.stream.html">Streams</a></li>      <li><a href="ref.stream.html">Stream Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.stream-socket-client" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">stream_socket_client</h1>
  <p class="verinfo">(PHP 5)</p><p class="refpurpose"><span class="refname">stream_socket_client</span> â€” <span class="dc-title">Open Internet or Unix domain socket connection</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.stream-socket-client-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>stream_socket_client</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$remote_socket</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter reference">&amp;$errno</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter reference">&amp;$errstr</code></span>
   [, <span class="methodparam"><span class="type">float</span> <code class="parameter">$timeout</code><span class="initializer"> = ini_get("default_socket_timeout")</span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$flags</code><span class="initializer"> = STREAM_CLIENT_CONNECT</span></span>
   [, <span class="methodparam"><span class="type">resource</span> <code class="parameter">$context</code></span>
  ]]]]] )</div>

  <p class="para rdfs-comment">
   Initiates a stream or datagram connection to the destination specified
   by <code class="parameter">remote_socket</code>.  The type of socket created
   is determined by the transport specified using standard URL formatting:
   <em>transport://target</em>.  For Internet Domain sockets
   (AF_INET) such as TCP and UDP, the <em>target</em> portion
   of the <code class="parameter">remote_socket</code> parameter should consist of
   a hostname or IP address followed by a colon and a port number.  For Unix
   domain sockets, the <code class="parameter">target</code> portion should point
   to the socket file on the filesystem.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    The stream will by default be opened in blocking mode.  You can
    switch it to non-blocking mode by using
    <span class="function"><a href="function.stream-set-blocking.html" class="function">stream_set_blocking()</a></span>.
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.stream-socket-client-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    
     <dt>
<code class="parameter">remote_socket</code></dt>

     <dd>

      <p class="para">
       Address to the socket to connect to.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">errno</code></dt>

     <dd>

      <p class="para">
       Will be set to the system level error number if connection fails.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">errstr</code></dt>

     <dd>

      <p class="para">
       Will be set to the system level error message if the connection fails.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">timeout</code></dt>

     <dd>

      <p class="para">
       Number of seconds until the <em>connect()</em> system call
       should timeout.
       </p><blockquote class="note"><p><strong class="note">Note</strong>: 
        <span class="simpara">
         This parameter only applies when not making asynchronous
         connection attempts.
        </span>
       </p></blockquote>
       <blockquote class="note"><p><strong class="note">Note</strong>: 
        </p><p class="para">
         To set a timeout for reading/writing data over the socket, use the
         <span class="function"><a href="function.stream-set-timeout.html" class="function">stream_set_timeout()</a></span>, as the
         <code class="parameter">timeout</code> only applies while making connecting
         the socket.
        </p>
       <p></p></blockquote>
      <p></p>
     </dd>

    
    
     <dt>
<code class="parameter">flags</code></dt>

     <dd>

      <p class="para">
       Bitmask field which may be set to any combination of connection flags.
       Currently the select of connection flags is limited to
       <strong><code>STREAM_CLIENT_CONNECT</code></strong> (default),
       <strong><code>STREAM_CLIENT_ASYNC_CONNECT</code></strong> and
       <strong><code>STREAM_CLIENT_PERSISTENT</code></strong>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">context</code></dt>

     <dd>

      <p class="para">
       A valid context resource created with <span class="function"><a href="function.stream-context-create.html" class="function">stream_context_create()</a></span>.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.stream-socket-client-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   On success a stream resource is returned which may
   be used together with the other file functions (such as
   <span class="function"><a href="function.fgets.html" class="function">fgets()</a></span>, <span class="function"><a href="function.fgetss.html" class="function">fgetss()</a></span>,
   <span class="function"><a href="function.fwrite.html" class="function">fwrite()</a></span>, <span class="function"><a href="function.fclose.html" class="function">fclose()</a></span>, and
   <span class="function"><a href="function.feof.html" class="function">feof()</a></span>), <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>

 
 <div class="refsect1 errors" id="refsect1-function.stream-socket-client-errors">
  <h3 class="title">Errors/Exceptions</h3>
  <p class="para">
   On failure the <code class="parameter">errno</code> and
   <code class="parameter">errstr</code> arguments will be populated with the actual
   system level error that occurred in the system-level
   <em>connect()</em> call. If the value returned in
   <code class="parameter">errno</code> is <em>0</em> and the
   function returned <strong><code>FALSE</code></strong>, it is an indication that the error
   occurred before the <em>connect()</em> call. This is
   most likely due to a problem initializing the socket. Note that
   the <code class="parameter">errno</code> and
   <code class="parameter">errstr</code> arguments will always be passed by
   reference.
  </p>
 </div>

 
 
 <div class="refsect1 examples" id="refsect1-function.stream-socket-client-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="stream-socket-client.example.basic">
    <p><strong>Example #1 <span class="function"><strong>stream_socket_client()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_socket_client</span><span style="color: #007700">(</span><span style="color: #DD0000">"tcp://www.example.com:80"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$errno</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$errstr</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">30</span><span style="color: #007700">);<br>if&nbsp;(!</span><span style="color: #0000BB">$fp</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$errstr</span><span style="color: #DD0000">&nbsp;(</span><span style="color: #0000BB">$errno</span><span style="color: #DD0000">)&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br>}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"GET&nbsp;/&nbsp;HTTP/1.0\r\nHost:&nbsp;www.example.com\r\nAccept:&nbsp;*/*\r\n\r\n"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(!</span><span style="color: #0000BB">feof</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">fgets</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1024</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="stream-socket-client.example.daytime">
    <p><strong>Example #2 Using UDP connection</strong></p>
    <div class="example-contents"><p>
     Retrieving the day and time from the UDP service "daytime" (port 13)
     on localhost.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_socket_client</span><span style="color: #007700">(</span><span style="color: #DD0000">"udp://127.0.0.1:13"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$errno</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$errstr</span><span style="color: #007700">);<br>if&nbsp;(!</span><span style="color: #0000BB">$fp</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"ERROR:&nbsp;</span><span style="color: #0000BB">$errno</span><span style="color: #DD0000">&nbsp;-&nbsp;</span><span style="color: #0000BB">$errstr</span><span style="color: #DD0000">&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br>}&nbsp;else&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">fread</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">26</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.stream-socket-client-notes">
  <h3 class="title">Notes</h3>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="simpara">
     UDP sockets will sometimes appear to have opened without an error,
     even if the remote host is unreachable.  The error will only
     become apparent when you read or write data to/from the socket.
     The reason for this is because UDP is a "connectionless" protocol,
     which means that the operating system does not try to establish
     a link for the socket until it actually needs to send or receive data.
   </p>
  </div>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">When specifying a numerical IPv6 address
(e.g. <em>fe80::1</em>), you must enclose the IP in square
bracketsâ€”for example, <em>tcp://[fe80::1]:80</em>.</span></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    Depending on the environment, the Unix domain or the optional
    connect timeout may not be available.  A list of available
    transports can be retrieved using <span class="function"><a href="function.stream-get-transports.html" class="function">stream_get_transports()</a></span>.
    See <a href="transports.html" class="xref">List of Supported Socket Transports</a> for a list of built in transports.
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.stream-socket-client-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.stream-socket-server.html" class="function" rel="rdfs-seeAlso">stream_socket_server()</a> - Create an Internet or Unix domain server socket</span></li>
    <li class="member"><span class="function"><a href="function.stream-set-blocking.html" class="function" rel="rdfs-seeAlso">stream_set_blocking()</a> - Set blocking/non-blocking mode on a stream</span></li>
    <li class="member"><span class="function"><a href="function.stream-set-timeout.html" class="function" rel="rdfs-seeAlso">stream_set_timeout()</a> - Set timeout period on a stream</span></li>
    <li class="member"><span class="function"><a href="function.stream-select.html" class="function" rel="rdfs-seeAlso">stream_select()</a> - Runs the equivalent of the select() system call on the given
   arrays of streams with a timeout specified by tv_sec and tv_usec</span></li>
    <li class="member"><span class="function"><a href="function.fgets.html" class="function" rel="rdfs-seeAlso">fgets()</a> - Gets line from file pointer</span></li>
    <li class="member"><span class="function"><a href="function.fgetss.html" class="function" rel="rdfs-seeAlso">fgetss()</a> - Gets line from file pointer and strip HTML tags</span></li>
    <li class="member"><span class="function"><a href="function.fwrite.html" class="function" rel="rdfs-seeAlso">fwrite()</a> - Binary-safe file write</span></li>
    <li class="member"><span class="function"><a href="function.fclose.html" class="function" rel="rdfs-seeAlso">fclose()</a> - Closes an open file pointer</span></li>
    <li class="member"><span class="function"><a href="function.feof.html" class="function" rel="rdfs-seeAlso">feof()</a> - Tests for end-of-file on a file pointer</span></li>
    <li class="member"><a href="ref.curl.html" class="xref">cURL Functions</a></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="105393">  
  <a class="name">
  <strong class="user"><em>Vasil Rangelov a.k.a. boen_robot</em></strong></a><div class="date" title="2011-08-14 01:11"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom105393">
<div class="phpcode"><code><span class="html">
The remote_socket argument, in its end (well... after the port), can also contain a "/" followed by a unique identifier. This is especially useful if you want to create multiple persistent connections to the same transport://host:port combo.<br><br>Example:<br><span class="default">&lt;?php<br>$socket </span><span class="keyword">= </span><span class="default">stream_socket_client</span><span class="keyword">(</span><span class="string">'tcp://mysql.example.com:3306/root'</span><span class="keyword">, </span><span class="default">$errorno</span><span class="keyword">, </span><span class="default">$errorstr</span><span class="keyword">, </span><span class="default">$timeout</span><span class="keyword">, </span><span class="default">STREAM_CLIENT_CONNECT </span><span class="keyword">| </span><span class="default">STREAM_CLIENT_PERSISTENT</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Note that while (p)fsockopen() follows a similar scheme, it doesn't have this particular feature.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86667">  
  <a class="name">
  <strong class="user"><em>nicholas at nicholaswilliams dot net</em></strong></a><div class="date" title="2008-10-28 05:08"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom86667">
<div class="phpcode"><code><span class="html">
For those wanting to use stream_socket_client() to connect to a local UNIX socket who can't find documentation on how to do it, here's a (rough) example:<br><br><span class="default">&lt;?php<br><br>$sock </span><span class="keyword">= </span><span class="default">stream_socket_client</span><span class="keyword">(</span><span class="string">'unix:///full/path/to/my/socket.sock'</span><span class="keyword">, </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">);<br><br></span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">, </span><span class="string">'SOME COMMAND'</span><span class="keyword">.</span><span class="string">"\r\n"</span><span class="keyword">);<br><br>echo </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">, </span><span class="default">4096</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br><br></span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77497">  
  <a class="name">
  <strong class="user"><em>wbeaver at afilias dot info</em></strong></a><div class="date" title="2007-08-31 02:06"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom77497">
<div class="phpcode"><code><span class="html">
# Some may find it useful to know that your caCert <br># must be in pem format, and that PHP seems to like <br># your key, cert, and cacert pem's to be concatenated<br># in a single file (I suffered various "unknown chain" <br># errors, otherwise)<br>#<br># So, (linux users), concat your components as follows:<br># (where current working dir is dir where <br># cert components are stored)<br>#<br># cat key.pem &gt;certchain.pem<br># cat cert.pem &gt;&gt;certchain.pem<br># cat cacert.pem &gt;&gt;certchain.pem<br>#<br># Then, the php....<br>##################################<br><br><span class="default">&lt;?php<br><br>$host </span><span class="keyword">= </span><span class="string">'host.domain.tld'</span><span class="keyword">;<br></span><span class="default">$port </span><span class="keyword">= </span><span class="default">1234</span><span class="keyword">;<br></span><span class="default">$timeout </span><span class="keyword">= </span><span class="default">10</span><span class="keyword">;<br><br></span><span class="default">$cert </span><span class="keyword">= </span><span class="string">'/path/to/your/certchain/certchain.pem'</span><span class="keyword">;<br></span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">(array(</span><span class="string">'ssl'</span><span class="keyword">=&gt;array(</span><span class="string">'local_cert'</span><span class="keyword">=&gt; </span><span class="default">$cert</span><span class="keyword">,<br>)));<br><br>if (</span><span class="default">$fp </span><span class="keyword">= </span><span class="default">stream_socket_client</span><span class="keyword">(</span><span class="string">'ssl://'</span><span class="keyword">.</span><span class="default">$host</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$port</span><span class="keyword">, </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">STREAM_CLIENT_CONNECT</span><span class="keyword">, </span><span class="default">$context</span><span class="keyword">)) {<br>&nbsp; &nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">);<br>&nbsp; &nbsp; echo </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">,</span><span class="default">8192</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br>} else {<br>&nbsp;&nbsp; echo </span><span class="string">"ERROR: </span><span class="default">$errno</span><span class="string"> - </span><span class="default">$errstr</span><span class="string">&lt;br /&gt;\n"</span><span class="keyword">;<br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97036">  
  <a class="name">
  <strong class="user"><em>bisho at onirica dot com</em></strong></a><div class="date" title="2010-03-29 09:04"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97036">
<div class="phpcode"><code><span class="html">
stream_socket_client is much easier and faster to use to direct sockets, because you can use directly fwrite / fget / fclose functions, but I find hard to find how to connect to a UNIX domain socket. The URL to use is "udg:///path/to/socket".<br><br>For example, to log to the log socket (like syslog), you can use:<br><br><span class="default">&lt;?php<br>$socket </span><span class="keyword">= </span><span class="default">stream_socket_client</span><span class="keyword">(</span><span class="string">'udg:///dev/log'</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$errorno</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$errorstr</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$timeout</span><span class="keyword">);<br></span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$socket</span><span class="keyword">, ...);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85345">  
  <a class="name">
  <strong class="user"><em>robin at gareus dot org</em></strong></a><div class="date" title="2008-08-26 03:34"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom85345">
<div class="phpcode"><code><span class="html">
I came here since fsockopen() does not support any SSL certificate checking in PHP5.<br><br>while curl is nice, I use stream_socket_client() to make XML-RPC POST requests via HTTPS and since I have not found any PHP code around that does this, I'll attach an example that also includes HTTP-Digest Auth (eg. trac's WikiRPCInterface2):<br><br><span class="default">&lt;?php<br></span><span class="comment">#################################################<br># $host: hostname ; eg 'example.org' <br># $path: request' eg '/index.php?id=123'<br># $data_to_send : data to POST after the HTTP header.<br>#<br># if $opts is an&nbsp; empty array() a standard&nbsp; HTTP to port 80 request is performed. <br># <br># set auth['type']='basic' to use plain-text auth, <br># digest-auth will be handled automatically if $auth['username'] is set and a 401<br># status is encountered. - use auth['type']='nodigest' to override.<br>#<br>##<br></span><span class="keyword">function </span><span class="default">httpPost</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$data_to_send</span><span class="keyword">,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$opts</span><span class="keyword">=array(</span><span class="string">'cert'</span><span class="keyword">=&gt;</span><span class="string">""</span><span class="keyword">, </span><span class="string">'headers'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">, </span><span class="string">'transport' </span><span class="keyword">=&gt;</span><span class="string">'ssl'</span><span class="keyword">, </span><span class="string">'port'</span><span class="keyword">=&gt;</span><span class="default">443</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">=array(</span><span class="string">'username'</span><span class="keyword">=&gt;</span><span class="string">""</span><span class="keyword">, </span><span class="string">'password'</span><span class="keyword">=&gt;</span><span class="string">""</span><span class="keyword">, </span><span class="string">'type'</span><span class="keyword">=&gt;</span><span class="string">""</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ) {<br>&nbsp; </span><span class="default">$transport</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">; </span><span class="default">$port</span><span class="keyword">=</span><span class="default">80</span><span class="keyword">;<br>&nbsp; if (!empty(</span><span class="default">$opts</span><span class="keyword">[</span><span class="string">'transport'</span><span class="keyword">])) </span><span class="default">$transport</span><span class="keyword">=</span><span class="default">$opts</span><span class="keyword">[</span><span class="string">'transport'</span><span class="keyword">];<br>&nbsp; if (!empty(</span><span class="default">$opts</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">])) </span><span class="default">$port</span><span class="keyword">=</span><span class="default">$opts</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">];<br>&nbsp; </span><span class="default">$remote</span><span class="keyword">=</span><span class="default">$transport</span><span class="keyword">.</span><span class="string">'://'</span><span class="keyword">.</span><span class="default">$host</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$port</span><span class="keyword">;<br><br>&nbsp; </span><span class="default">$context </span><span class="keyword">= </span><span class="default">stream_context_create</span><span class="keyword">();<br>&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">stream_context_set_option</span><span class="keyword">(</span><span class="default">$context</span><span class="keyword">, </span><span class="string">'ssl'</span><span class="keyword">, </span><span class="string">'verify_host'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; if (!empty(</span><span class="default">$opts</span><span class="keyword">[</span><span class="string">'cert'</span><span class="keyword">])) {<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">stream_context_set_option</span><span class="keyword">(</span><span class="default">$context</span><span class="keyword">, </span><span class="string">'ssl'</span><span class="keyword">, </span><span class="string">'cafile'</span><span class="keyword">, </span><span class="default">$opts</span><span class="keyword">[</span><span class="string">'cert'</span><span class="keyword">]);<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">stream_context_set_option</span><span class="keyword">(</span><span class="default">$context</span><span class="keyword">, </span><span class="string">'ssl'</span><span class="keyword">, </span><span class="string">'verify_peer'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; } else {<br>&nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">stream_context_set_option</span><span class="keyword">(</span><span class="default">$context</span><span class="keyword">, </span><span class="string">'ssl'</span><span class="keyword">, </span><span class="string">'allow_self_signed'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&nbsp; }<br>&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">stream_socket_client</span><span class="keyword">(</span><span class="default">$remote</span><span class="keyword">, </span><span class="default">$err</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">60</span><span class="keyword">, </span><span class="default">STREAM_CLIENT_CONNECT</span><span class="keyword">, </span><span class="default">$context</span><span class="keyword">);<br><br>&nbsp; if (!</span><span class="default">$fp</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'httpPost error: '</span><span class="keyword">.</span><span class="default">$errstr</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">NULL</span><span class="keyword">;<br>&nbsp; }<br><br>&nbsp; </span><span class="default">$req</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br>&nbsp; </span><span class="default">$req</span><span class="keyword">.=</span><span class="string">"POST </span><span class="default">$path</span><span class="string"> HTTP/1.1\r\n"</span><span class="keyword">;<br>&nbsp; </span><span class="default">$req</span><span class="keyword">.=</span><span class="string">"Host: </span><span class="default">$host</span><span class="string">\r\n"</span><span class="keyword">;<br>&nbsp; if (</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">]==</span><span class="string">'basic' </span><span class="keyword">&amp;&amp; !empty(</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">])) {<br>&nbsp; &nbsp; </span><span class="default">$req</span><span class="keyword">.=</span><span class="string">"Authorization: Basic "</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$req</span><span class="keyword">.=</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">]).</span><span class="string">"\r\n"</span><span class="keyword">;<br>&nbsp; }<br>&nbsp; elseif (</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">]==</span><span class="string">'digest' </span><span class="keyword">&amp;&amp; !empty(</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">])) {<br>&nbsp; &nbsp; </span><span class="default">$req</span><span class="keyword">.=</span><span class="string">'Authorization: Digest '</span><span class="keyword">;<br>&nbsp; &nbsp; foreach (</span><span class="default">$auth </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; if (empty(</span><span class="default">$k</span><span class="keyword">) || empty(</span><span class="default">$v</span><span class="keyword">)) continue;<br>&nbsp; &nbsp; &nbsp; if (</span><span class="default">$k</span><span class="keyword">==</span><span class="string">'password'</span><span class="keyword">) continue;<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$req</span><span class="keyword">.=</span><span class="default">$k</span><span class="keyword">.</span><span class="string">'="'</span><span class="keyword">.</span><span class="default">$v</span><span class="keyword">.</span><span class="string">'", '</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; </span><span class="default">$req</span><span class="keyword">.=</span><span class="string">"\r\n"</span><span class="keyword">;<br>&nbsp; }<br>&nbsp; </span><span class="default">$req</span><span class="keyword">.=</span><span class="string">"Content-type: text/xml\r\n"</span><span class="keyword">;<br>&nbsp; </span><span class="default">$req</span><span class="keyword">.=</span><span class="string">'Content-length: '</span><span class="keyword">. </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data_to_send</span><span class="keyword">) .</span><span class="string">"\r\n"</span><span class="keyword">;<br>&nbsp; </span><span class="default">$req</span><span class="keyword">.=</span><span class="string">"Connection: close\r\n\r\n"</span><span class="keyword">;<br><br>&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$req</span><span class="keyword">);<br>&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$data_to_send</span><span class="keyword">);<br><br>&nbsp; while(!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">)) { </span><span class="default">$res </span><span class="keyword">.= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">128</span><span class="keyword">); }<br>&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br><br>&nbsp; if (</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">]!=</span><span class="string">'nodigest'<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">&amp;&amp; !empty(</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">])<br>&nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp; </span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">]!=</span><span class="string">'digest' </span><span class="comment"># prev. digest AUTH failed.<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">&amp;&amp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^HTTP\/[0-9\.]* 401 /"</span><span class="keyword">, </span><span class="default">$res</span><span class="keyword">)) {<br>&nbsp; &nbsp; if (</span><span class="default">1 </span><span class="keyword">== </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/WWW-Authenticate: Digest ([^\n\r]*)\r\n/Us"</span><span class="keyword">, </span><span class="default">$res</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; foreach (</span><span class="default">split</span><span class="keyword">(</span><span class="string">","</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) as </span><span class="default">$i</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ii</span><span class="keyword">=</span><span class="default">split</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">,</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">),</span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (!empty(</span><span class="default">$ii</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) &amp;&amp; !empty(</span><span class="default">$ii</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">[</span><span class="default">$ii</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]]=</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/^\"/"</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">, </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/\"$/"</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">, </span><span class="default">$ii</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]));<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">]=</span><span class="string">'digest'</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'uri'</span><span class="keyword">]=</span><span class="string">'https://'</span><span class="keyword">.</span><span class="default">$host</span><span class="keyword">.</span><span class="default">$path</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'cnonce'</span><span class="keyword">]=</span><span class="default">randomNonce</span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'nc'</span><span class="keyword">]=</span><span class="default">1</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$a1</span><span class="keyword">=</span><span class="default">md5</span><span class="keyword">(</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'realm'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$a2</span><span class="keyword">=</span><span class="default">md5</span><span class="keyword">(</span><span class="string">'POST'</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'uri'</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; </span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'response'</span><span class="keyword">]=</span><span class="default">md5</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">.</span><span class="string">':'<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">.</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'nonce'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'nc'</span><span class="keyword">].</span><span class="string">':'<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">.</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'cnonce'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$auth</span><span class="keyword">[</span><span class="string">'qop'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$a2</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; return </span><span class="default">httpPost</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$data_to_send</span><span class="keyword">, </span><span class="default">$opts</span><span class="keyword">, </span><span class="default">$auth</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; }<br><br>&nbsp; if (</span><span class="default">1 </span><span class="keyword">!= </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^HTTP\/[0-9\.]* ([0-9]{3}) ([^\r\n]*)/"</span><span class="keyword">, </span><span class="default">$res</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">)) {<br>&nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'httpPost: invalid HTTP reply.'</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">NULL</span><span class="keyword">;<br>&nbsp; }<br><br>&nbsp; if (</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] != </span><span class="string">'200'</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'httpPost: HTTP error: '</span><span class="keyword">.</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">].</span><span class="string">' '</span><span class="keyword">.</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br>&nbsp; &nbsp; return </span><span class="default">NULL</span><span class="keyword">;<br>&nbsp; }<br><br>&nbsp; if (!</span><span class="default">$opts</span><span class="keyword">[</span><span class="string">'headers'</span><span class="keyword">]) {<br>&nbsp; &nbsp; </span><span class="default">$res</span><span class="keyword">=</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/^.*\r\n\r\n/Us"</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$res</span><span class="keyword">);<br>&nbsp; }<br>&nbsp; return </span><span class="default">$res</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.stream-socket-client.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:04:49 GMT -->


</body></html>