<html><!-- Mirrored from php.net/manual/en/function.imap-headerinfo.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:57:25 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>imap_headerinfo</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.imap-headerinfo.html">
 <link rel="shorturl" href="http://php.net/imap-headerinfo">
 <link rel="alternate" href="http://php.net/imap-headerinfo" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.imap.html">
 <link rel="prev" href="function.imap-header.html">
 <link rel="next" href="function.imap-headers.html">

 <link rel="alternate" href="function.imap-headerinfo.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/function.imap-headerinfo.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/function.imap-headerinfo.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/function.imap-headerinfo.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/function.imap-headerinfo.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/function.imap-headerinfo.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/function.imap-headerinfo.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/function.imap-headerinfo.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/function.imap-headerinfo.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/function.imap-headerinfo.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/function.imap-headerinfo.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.remote.mail.html">Mail Related Extensions</a></li>      <li><a href="book.imap.html">IMAP</a></li>      <li><a href="ref.imap.html">IMAP Functions</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="function.imap-headerinfo" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imap_headerinfo</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">imap_headerinfo</span> â€” <span class="dc-title">Read the header of the message</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imap-headerinfo-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">object</span> <span class="methodname"><strong>imap_headerinfo</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$imap_stream</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$msg_number</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$fromlength</code><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$subjectlength</code><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$defaulthost</code><span class="initializer"> = <strong><code>NULL</code></strong></span></span>
  ]]] )</div>

  <p class="para rdfs-comment">
   Gets information about the given message number by reading its headers.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imap-headerinfo-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>

    <dt>
<code class="parameter">
imap_stream</code></dt>
<dd>
<p class="para">An IMAP stream returned by
<span class="function"><a href="function.imap-open.html" class="function">imap_open()</a></span>.</p></dd>

    
     <dt>
<code class="parameter">msg_number</code></dt>

     <dd>

      <p class="para">
       The message number
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">fromlength</code></dt>

     <dd>

      <p class="para">
       Number of characters for the <em>fetchfrom</em> property.
       Must be greater than or equal to zero.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">subjectlength</code></dt>

     <dd>

      <p class="para">
       Number of characters for the <em>fetchsubject</em> property
       Must be greater than or equal to zero.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">defaulthost</code></dt>

     <dd>

      <p class="para">
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imap-headerinfo-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the information in an object with following properties:
   </p><ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      toaddress - full to: line, up to 1024 characters
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      to - an array of objects from the To: line, with the following 
      properties: <em>personal</em>, <em>adl</em>,
      <em>mailbox</em>, and <em>host</em>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      fromaddress - full from: line, up to 1024 characters
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      from - an array of objects from the From: line, with the following 
      properties: <em>personal</em>, <em>adl</em>,
      <em>mailbox</em>, and <em>host</em>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      ccaddress - full cc: line, up to 1024 characters
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      cc - an array of objects from the Cc: line, with the following 
      properties: <em>personal</em>, <em>adl</em>,
      <em>mailbox</em>, and <em>host</em>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      bccaddress - full bcc: line, up to 1024 characters
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      bcc - an array of objects from the Bcc: line, with the following 
      properties: <em>personal</em>, <em>adl</em>,
      <em>mailbox</em>, and <em>host</em>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      reply_toaddress - full Reply-To: line, up to 1024 characters
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      reply_to - an array of objects from the Reply-To: line, with the following
      properties: <em>personal</em>, <em>adl</em>,
      <em>mailbox</em>, and <em>host</em>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      senderaddress - full sender: line, up to 1024 characters
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      sender - an array of objects from the Sender: line, with the following 
      properties: <em>personal</em>, <em>adl</em>,
      <em>mailbox</em>, and <em>host</em>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      return_pathaddress - full Return-Path: line, up to 1024 characters
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      return_path - an array of objects from the Return-Path: line, with the
      following properties: <em>personal</em>, 
      <em>adl</em>, <em>mailbox</em>, and 
      <em>host</em>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      remail - 
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      date - The message date as found in its headers
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Date - Same as date
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      subject - The message subject
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Subject - Same as subject 
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      in_reply_to - 
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      message_id - 
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      newsgroups - 
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      followup_to - 
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      references - 
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Recent - <em>R</em> if recent and seen, <em>N</em>
      if recent and not seen, ' ' if not recent.
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Unseen - <em>U</em> if not seen AND not recent, ' ' if seen
      OR not seen and recent
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Flagged - <em>F</em> if flagged, ' ' if not flagged
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Answered - <em>A</em> if answered, ' ' if unanswered
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Deleted - <em>D</em> if deleted, ' ' if not deleted
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Draft - <em>X</em> if draft, ' ' if not draft
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Msgno - The message number
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      MailDate - 
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      Size - The message size
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      udate - mail message date in Unix time
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      fetchfrom - from line formatted to fit <code class="parameter">fromlength</code>
      characters
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      fetchsubject - subject line formatted to fit 
      <code class="parameter">subjectlength</code> characters
     </span>
    </li>
   </ul>
  <p></p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.imap-headerinfo-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.imap-fetch-overview.html" class="function" rel="rdfs-seeAlso">imap_fetch_overview()</a> - Read an overview of the information in the headers of the given message</span></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="98809">  
  <a class="name">
  <strong class="user"><em>andyltm</em></strong></a><div class="date" title="2010-07-08 03:17"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom98809">
<div class="phpcode"><code><span class="html">
When I was testing imap_headerinfo() with an e-mail that had multiple recipients (multiple e-mails in to to: and/or cc: field), I noticed that imap_headerinfo() was failing hard for me on PHP 5.2.10-2ubuntu6.4 with Suhosin-Patch 0.9.7 (cli).<br><br>Rather than providing me an array with each and every e-mail address listed in the to and/or cc fields, it was only providing me the first listed.&nbsp; This was disappointing.<br><br>&nbsp;&nbsp; [to] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; (&nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; stdClass Object<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (&nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [mailbox] =&gt; game<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [host] =&gt; blunts.com<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br><br>Luckily, there was a cool workaround to this problem:<br><br>imap_rfc822_parse_headers(imap_fetchheader( string ); which subsequentally worked like a nice little pet would:<br><br>&nbsp;&nbsp; [to] =&gt; Array<br>&nbsp; &nbsp; &nbsp; &nbsp; (&nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] =&gt; stdClass Object<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (&nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [mailbox] =&gt; game<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [host] =&gt; blunts.com<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] =&gt; stdClass Object<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (&nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [mailbox] =&gt; dutch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [host] =&gt; masters.com<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )<br>&nbsp; &nbsp; &nbsp; &nbsp; )<br><br>TL;DR: <br>So in other words, instead of imap_headerinfo() use imap_rfc822_parse_headers(imap_fetchheader()).<br><br>Hope this helps anyone else that runs into this issue from now into the future.&nbsp; This post was suggested by people in #PHP on FreeNode IRC.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="26741">  
  <a class="name">
  <strong class="user"><em>scott at fuzzygroup dot com</em></strong></a><div class="date" title="2002-11-11 09:13"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom26741">
<div class="phpcode"><code><span class="html">
If you want to extract values from to, from, or other header elements, they are an object and you need to loop over them i.e.<br><br>$header = imap_header($mbox, $message_id);<br>$from = $header-&gt;from;<br>foreach ($from as $id =&gt; $object) {<br>&nbsp; &nbsp; $fromname = $object-&gt;personal;<br>&nbsp; &nbsp; $fromaddress = $object-&gt;mailbox . "@" . $object-&gt;host;<br>}<br><br>Would give you two variables for the friendly from and the smtp from address<br><br>Thanks to www.natrak.net for help with this</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95012">  
  <a class="name">
  <strong class="user"><em>jahservant 13 at gmail dot com</em></strong></a><div class="date" title="2009-12-08 03:56"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95012">
<div class="phpcode"><code><span class="html">
I'm not entirely sure why this is, but if you loop through all of the messages in a mailbox, calling imap_header() each time, you can significantly increase performance by calling imap_headers() first.<br><br>Compare this:<br><span class="default">&lt;?php<br>&nbsp; &nbsp;&nbsp; $imap </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{my.server.com:143}INBOX"</span><span class="keyword">, </span><span class="string">"user"</span><span class="keyword">, </span><span class="string">"pass"</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; </span><span class="default">$n_msgs </span><span class="keyword">= </span><span class="default">imap_num_msg</span><span class="keyword">(</span><span class="default">$imap</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$n_msgs</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="default">imap_header</span><span class="keyword">(</span><span class="default">$imap</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; }<br>&nbsp; &nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; echo (</span><span class="default">$e </span><span class="keyword">- </span><span class="default">$s</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; </span><span class="default">imap_close</span><span class="keyword">(</span><span class="default">$imap</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>With this:<br><span class="default">&lt;?php<br>&nbsp; &nbsp;&nbsp; $imap </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{my.server.com:143}INBOX"</span><span class="keyword">, </span><span class="string">"user"</span><span class="keyword">, </span><span class="string">"pass"</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; </span><span class="default">$n_msgs </span><span class="keyword">= </span><span class="default">imap_num_msg</span><span class="keyword">(</span><span class="default">$imap</span><span class="keyword">);<br>&nbsp; </span><span class="comment">/****** adding this line: ******/<br>&nbsp; &nbsp;&nbsp; </span><span class="default">imap_headers</span><span class="keyword">(</span><span class="default">$imap</span><span class="keyword">)<br>&nbsp; </span><span class="comment">/***************************/<br>&nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$n_msgs</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="default">imap_header</span><span class="keyword">(</span><span class="default">$imap</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; }<br>&nbsp; &nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; echo (</span><span class="default">$e </span><span class="keyword">- </span><span class="default">$s</span><span class="keyword">);<br>&nbsp; &nbsp;&nbsp; </span><span class="default">imap_close</span><span class="keyword">(</span><span class="default">$imap</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>The performance difference, as I have tested on several boxes, connecting to several different servers, is that the second code snippet ALWAYS takes 1/2 the time, if not less.<br><br>Perhaps it is because imap_headers() retrieves all of the messages on one connection, whereas imap_header() has to make a new fetch request for each message??&nbsp; I'm not sure WHY it is faster if imap_headers() is called first, but I do know that it is, so I thought I'd pass on the knowledge.&nbsp; If anyone knows why this is, please let me know....</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86837">  
  <a class="name">
  <strong class="user"><em>ron at NOSPAM dot clicks2hits dot com</em></strong></a><div class="date" title="2008-11-05 05:51"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom86837">
<div class="phpcode"><code><span class="html">
Simple little code for checking gmail using headerinfo<br><br><span class="default">&lt;?php </span><span class="comment">/* Created on: 11/3/2008 By Ron Hickey 6tx.net/gmail_mod <br>Gmail mod for admin panels or you can edit it and convert html results to XML for personal RSS reader */ <br><br>// enter gmail username below e.g.--&gt; $m_username = "yourusername";<br></span><span class="default">$m_username </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br><br></span><span class="comment">// enter gmail password below e.g.--&gt; $m_password = "yourpword";<br></span><span class="default">$m_password </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br><br></span><span class="comment">// enter the number of unread messages you want to display from mailbox or <br>//enter 0 to display all unread messages e.g.--&gt; $m_acs = 0; <br></span><span class="default">$m_acs </span><span class="keyword">= </span><span class="default">15</span><span class="keyword">; <br><br></span><span class="comment">// How far back in time do you want to search for unread messages - one month = 0 , two weeks = 1, one week = 2, three days = 3,<br>// one day = 4, six hours = 5 or one hour = 6 e.g.--&gt; $m_t = 6;<br></span><span class="default">$m_t </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br><br></span><span class="comment">//-----------&gt;Nothing More to edit below<br>//open mailbox..........please<br></span><span class="default">$m_mail </span><span class="keyword">= </span><span class="default">imap_open </span><span class="keyword">(</span><span class="string">"{imap.gmail.com:993/imap/ssl}INBOX"</span><span class="keyword">, </span><span class="default">$m_username </span><span class="keyword">. </span><span class="string">"@gmail.com"</span><span class="keyword">, </span><span class="default">$m_password</span><span class="keyword">)<br><br></span><span class="comment">// or throw a freakin error............you pig<br></span><span class="keyword">or die(</span><span class="string">"ERROR: " </span><span class="keyword">. </span><span class="default">imap_last_error</span><span class="keyword">());<br><br></span><span class="comment">// unix time gone by or is it bye.....its certanly not bi.......or is it? ......I dunno fooker <br></span><span class="default">$m_gunixtp </span><span class="keyword">= array(</span><span class="default">2592000</span><span class="keyword">, </span><span class="default">1209600</span><span class="keyword">, </span><span class="default">604800</span><span class="keyword">, </span><span class="default">259200</span><span class="keyword">, </span><span class="default">86400</span><span class="keyword">, </span><span class="default">21600</span><span class="keyword">, </span><span class="default">3600</span><span class="keyword">);<br><br></span><span class="comment">// Date to start search<br></span><span class="default">$m_gdmy </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">'d-M-Y'</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">() - </span><span class="default">$m_gunixtp</span><span class="keyword">[</span><span class="default">$m_t</span><span class="keyword">]); <br><br></span><span class="comment">//search mailbox for unread messages since $m_t date <br></span><span class="default">$m_search</span><span class="keyword">=</span><span class="default">imap_search </span><span class="keyword">(</span><span class="default">$m_mail</span><span class="keyword">, </span><span class="string">'UNSEEN SINCE ' </span><span class="keyword">. </span><span class="default">$m_gdmy </span><span class="keyword">. </span><span class="string">''</span><span class="keyword">);<br><br></span><span class="comment">//If mailbox is empty......Display "No New Messages", else........ You got mail....oh joy<br></span><span class="keyword">if(</span><span class="default">$m_search </span><span class="keyword">&lt; </span><span class="default">1</span><span class="keyword">){ <br></span><span class="default">$m_empty </span><span class="keyword">= </span><span class="string">"No New Messages"</span><span class="keyword">;} <br>else {<br><br></span><span class="comment">// Order results starting from newest message<br></span><span class="default">rsort</span><span class="keyword">(</span><span class="default">$m_search</span><span class="keyword">);<br><br></span><span class="comment">//if m_acs &gt; 0 then limit results<br></span><span class="keyword">if(</span><span class="default">$m_acs </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">){ <br></span><span class="default">array_splice</span><span class="keyword">(</span><span class="default">$m_search</span><span class="keyword">, </span><span class="default">$m_acs</span><span class="keyword">);<br>} <br><br></span><span class="comment">//loop it <br></span><span class="keyword">foreach (</span><span class="default">$m_search </span><span class="keyword">as </span><span class="default">$what_ever</span><span class="keyword">) { <br><br></span><span class="comment">//get imap header info for obj thang <br></span><span class="default">$obj_thang </span><span class="keyword">= </span><span class="default">imap_headerinfo</span><span class="keyword">(</span><span class="default">$m_mail</span><span class="keyword">, </span><span class="default">$what_ever</span><span class="keyword">);<br><br></span><span class="comment">//Then spit it out below.........if you dont swallow <br></span><span class="keyword">echo </span><span class="string">"&lt;body bgcolor=D3D3D3&gt;&lt;div align=center&gt;&lt;br /&gt;&lt;font face=Arial size=2 color=#800000&gt;Message ID# " </span><span class="keyword">. </span><span class="default">$what_ever </span><span class="keyword">. </span><span class="string">"&lt;/font&gt;<br><br>&lt;table bgcolor=#D3D3D3 width=700 border=1 bordercolor=#000000 cellpadding=0 cellspacing=0&gt;<br>&lt;tr&gt;<br>&lt;td&gt;&lt;table width=100% border=0&gt;<br>&lt;tr&gt;<br>&lt;td&gt;&lt;table width=100% border=0&gt;<br>&lt;tr&gt;<br>&lt;td bgcolor=#F8F8FF&gt;&lt;font face=Arial size=2 color=#800000&gt;Date:&lt;/font&gt; &lt;font face=Arial size=2 color=#000000&gt;" </span><span class="keyword">. </span><span class="default">date</span><span class="keyword">(</span><span class="string">"F j, Y, g:i a"</span><span class="keyword">, </span><span class="default">$obj_thang</span><span class="keyword">-&gt;</span><span class="default">udate</span><span class="keyword">) . </span><span class="string">"&lt;/font&gt;&lt;/td&gt;<br>&lt;td bgcolor=#F8F8FF&gt;&lt;font face=Arial size=2 color=#800000&gt;From:&lt;/font&gt; &lt;font face=Arial size=2 color=#000000&gt;" </span><span class="keyword">. </span><span class="default">$obj_thang</span><span class="keyword">-&gt;</span><span class="default">fromaddress </span><span class="keyword">. </span><span class="string">"&lt;/font&gt;&lt;/td&gt;<br>&lt;td bgcolor=#F8F8FF&gt;&lt;font face=Arial size=2 color=#800000&gt;To:&lt;/font&gt; &lt;font face=Arial size=2 color=#000000&gt;" </span><span class="keyword">. </span><span class="default">$obj_thang</span><span class="keyword">-&gt;</span><span class="default">toaddress </span><span class="keyword">. </span><span class="string">" &lt;/font&gt;&lt;/td&gt;<br>&lt;/tr&gt;<br>&lt;tr&gt;<br>&lt;/table&gt;<br>&lt;/td&gt;<br>&lt;/tr&gt;&lt;tr&gt;&lt;td bgcolor=#F8F8FF&gt;&lt;font face=Arial size=2 color=#800000&gt;Subject:&lt;/font&gt; &lt;font face=Arial size=2 color=#000000&gt;" </span><span class="keyword">. </span><span class="default">$obj_thang</span><span class="keyword">-&gt;</span><span class="default">Subject </span><span class="keyword">. </span><span class="string">"&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;<br>&lt;/tr&gt;<br>&lt;/table&gt;&lt;/td&gt;<br>&lt;/tr&gt;<br>&lt;/table&gt;&lt;a href=<a rel="nofollow" target="_blank">http://gmail.com</a> target=_blank&gt;&lt;font face=Arial size=2 color=#800000&gt;Login to read message&lt;/a&gt;&lt;/font&gt;&lt;br /&gt;&lt;/div&gt;&lt;/body&gt;"</span><span class="keyword">;<br><br>}} echo </span><span class="string">"&lt;div align=center&gt;&lt;font face=Arial size=4 color=#800000&gt;&lt;b&gt;" </span><span class="keyword">. </span><span class="default">$m_empty </span><span class="keyword">. </span><span class="string">"&lt;/b&gt;&lt;/font&gt;&lt;/div&gt;"</span><span class="keyword">;<br></span><span class="comment">//close mailbox bi by bye<br></span><span class="default">imap_close</span><span class="keyword">(</span><span class="default">$m_mail</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115491">  
  <a class="name">
  <strong class="user"><em>milosh</em></strong></a><div class="date" title="2014-08-03 10:14"><strong>24 days ago</strong></div>
  <div class="text" id="Hcom115491">
<div class="phpcode"><code><span class="html">
I did some testing on using imap_headerinfo() function and I am very confused with the results.<br><br>On small mailboxes, getting data for 30 messages takes about 0.5 secs. On mailboxes with approximately 500 messages it takes about 7 secs to retrieve data for the same number of messages.<br><br>Why would the size of mailbox had anything to do with the time needed to retrieve the header of the single email message? Mailboxes are on the same account.<br><br>Next, If you measure every call to imap_headerinfo() function the result are even stranger! First and then every 22th call to the imap_headerinfo() function takes 10000 times more that the others. Example: the first call takes about 0.39 secs, then other 20 calls take about 0.0001 secs, then 22th call takes about 0.47 secs, then other 20 calls about 0.00004, and so on.<br><br>After some more research there is something else that came up.<br><br>If you use:<br><br>$message_header[$i] = imap_headerinfo($mbox, $i + 1);<br><br>it takes about 0.4 secs for every 22th call and about 0.0001 sec for other calls.<br><br>However, you would expect the same results with:<br><br>$message_header[$i] = imap_headerinfo($mbox, 30 - $i);<br><br>But, in this case it takes about 0.2 secs for every call!<br><br>The only difference here is that in the second example headers are retrieved in the reversed message order (from the 30th to the 1st) and for some reason it greatly affects the time needed for the operation. Strange, or is it just me?</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95953">  
  <a class="name">
  <strong class="user"><em>trinkaus at ttNetz dot de</em></strong></a><div class="date" title="2010-01-31 02:32"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom95953">
<div class="phpcode"><code><span class="html">
When i try to access the same mailbox through pop3 and through imap i get different update infomations.<br><br>1. Using imap <br>header-&gt;udate is not the same as strtotime($header-&gt;date)<br><span class="default">&lt;?php<br>$mBox </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{host:143/imap/novalidate-cert}INBOX}"</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">); </span><span class="comment">// open as imap<br></span><span class="default">$header </span><span class="keyword">= </span><span class="default">imap_header</span><span class="keyword">(</span><span class="default">$mBox</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// get first mails header<br></span><span class="keyword">echo </span><span class="default">$header</span><span class="keyword">-&gt;</span><span class="default">udate</span><span class="keyword">;<br>echo </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$header</span><span class="keyword">-&gt;</span><span class="default">date</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>1. Using pop3<br>header-&gt;udate is the same as strtotime($header-&gt;date)<br><span class="default">&lt;?php<br>$mBox </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{host:110/pop3/novalidate-cert}INBOX}"</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">); </span><span class="comment">// open as pop3<br></span><span class="default">$header </span><span class="keyword">= </span><span class="default">imap_header</span><span class="keyword">(</span><span class="default">$mBox</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// get first mails header<br></span><span class="keyword">echo </span><span class="default">$header</span><span class="keyword">-&gt;</span><span class="default">udate</span><span class="keyword">;<br>echo </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$header</span><span class="keyword">-&gt;</span><span class="default">date</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>I do not know why this is so, but for this reason, i use strtotime($header-&gt;date) together with other values to create my own message-UID because this seems to work independent from the protocol.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90943">  
  <a class="name">
  <strong class="user"><em>aeolianmeson at exoyiga dot blitzeclipse dot com</em></strong></a><div class="date" title="2009-05-17 10:56"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom90943">
<div class="phpcode"><code><span class="html">
I typically use UID's to identify messages, and recently discovered that the headers I had been pulling using this function and a message-number didn't match the UID's. Instead of worrying about it, I just began using imap_fetchheader() and imap_ rfc822_ parse_ headers() on its output. The only significant difference I immediately noticed was that there is no "udate" property, so I assigned one with the result of strtotime() on the 'date' property.<br><br>Dustin</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88515">  
  <a class="name">
  <strong class="user"><em>php at spacefish dot biz</em></strong></a><div class="date" title="2009-01-27 10:57"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom88515">
<div class="phpcode"><code><span class="html">
I had to pass the msgid as array($msgid) instead of an integer. the error "Invalid messageID" is generated if i pass an integer.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/function.imap-headerinfo.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 15:57:25 GMT -->


</body></html>