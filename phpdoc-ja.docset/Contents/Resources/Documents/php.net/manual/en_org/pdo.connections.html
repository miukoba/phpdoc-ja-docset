<html><!-- Mirrored from php.net/manual/en/pdo.connections.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:17:22 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

  <title>Connections and Connection management</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="http://php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="pdo.connections.html">
 <link rel="shorturl" href="pdo.connections.html">
 <link rel="alternate" href="pdo.connections.html" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="book.pdo.html">
 <link rel="prev" href="pdo.constants.html">
 <link rel="next" href="pdo.transactions.html">

 <link rel="alternate" href="pdo.connections.html" hreflang="en">
 <link rel="alternate" href="http://php.net/manual/pt_BR/pdo.connections.php" hreflang="pt_BR">
 <link rel="alternate" href="http://php.net/manual/zh/pdo.connections.php" hreflang="zh">
 <link rel="alternate" href="http://php.net/manual/fr/pdo.connections.php" hreflang="fr">
 <link rel="alternate" href="http://php.net/manual/de/pdo.connections.php" hreflang="de">
 <link rel="alternate" href="http://php.net/manual/it/pdo.connections.php" hreflang="it">
 <link rel="alternate" href="http://php.net/manual/ja/pdo.connections.php" hreflang="ja">
 <link rel="alternate" href="http://php.net/manual/ro/pdo.connections.php" hreflang="ro">
 <link rel="alternate" href="http://php.net/manual/ru/pdo.connections.php" hreflang="ru">
 <link rel="alternate" href="http://php.net/manual/es/pdo.connections.php" hreflang="es">
 <link rel="alternate" href="http://php.net/manual/tr/pdo.connections.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached8fe1.css?t=1401250819&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached4b8d.css?t=1404368420&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached5065.css?t=1403329232&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedc78d.css?t=1401249623&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script type="text/javascript">
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="http://php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script type="text/javascript" src="http://php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>

</head>
<body class="docs " style="">


<div class="headsup"><a href="http://php.net/index.php#id2014-08-28-1">PHP 5.6.0 released</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.globals.html">Using Register Globals</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.magicquotes.html">Magic Quotes</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.safe-mode.html">Safe Mode</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.creditcard.html">Credit Card Processing</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
          
              
        <ul class="breadcrumbs-container">
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.abstract.html">Abstraction Layers</a></li>      <li><a href="book.pdo.html">PDO</a></li>    </ul>
  </div>




<div id="layout">
  <section id="layout-content">
  <div id="pdo.connections" class="chapter">
 <h1>Connections and Connection management</h1>

 <p class="para">
  Connections are established by creating instances of the PDO base class.
  It doesn't matter which driver you want to use; you always use the PDO
  class name. The constructor accepts parameters for specifying the
  database source (known as the DSN) and optionally for the username and
  password (if any).
 </p>
 <p class="para">
  </p><div class="example" id="example-947">
   <p><strong>Example #1 Connecting to MySQL</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #DD0000">'mysql:host=localhost;dbname=test'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$pass</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div> 
   </div>

  </div>
 <p></p>
 <p class="para">
  If there are any connection errors, a <em>PDOException</em>
  object will be thrown.  You may catch the exception if you want to handle
  the error condition, or you may opt to leave it for an application
  global exception handler that you set up via
  <span class="function"><a href="function.set-exception-handler.html" class="function">set_exception_handler()</a></span>.
 </p>
 <p class="para">
  </p><div class="example" id="example-948"><p><strong>Example #2 Handling connection errors</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">try&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #DD0000">'mysql:host=localhost;dbname=test'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$pass</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$dbh</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;from&nbsp;FOO'</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$row</span><span style="color: #007700">);<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br>}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">PDOException&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"Error!:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$e</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">()&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br>&nbsp;&nbsp;&nbsp;&nbsp;die();<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 <p></p>
 <div class="warning"><strong class="warning">Warning</strong>
  <p class="para">
   If your application does not catch the exception thrown from the PDO
   constructor, the default action taken by the zend engine is to terminate
   the script and display a back trace.  This back trace will likely reveal
   the full database connection details, including the username and
   password.  It is your responsibility to catch this exception, either
   explicitly (via a <em>catch</em> statement) or implicitly via
   <span class="function"><a href="function.set-exception-handler.html" class="function">set_exception_handler()</a></span>.
  </p>
 </div>
 <p class="para">
  Upon successful connection to the database, an instance of the PDO class
  is returned to your script.  The connection remains active for the
  lifetime of that PDO object.  To close the connection, you need to
  destroy the object by ensuring that all remaining references to it are
  deleted--you do this by assigning <strong><code>NULL</code></strong> to the variable that holds the
  object.  If you don't do this explicitly, PHP will automatically close
  the connection when your script ends.
 </p>
 <p class="para">
  </p><div class="example" id="example-949">
   <p><strong>Example #3 Closing a connection</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #DD0000">'mysql:host=localhost;dbname=test'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$pass</span><span style="color: #007700">);<br></span><span style="color: #FF8000">//&nbsp;use&nbsp;the&nbsp;connection&nbsp;here<br><br><br>//&nbsp;and&nbsp;now&nbsp;we're&nbsp;done;&nbsp;close&nbsp;it<br></span><span style="color: #0000BB">$dbh&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 <p></p>
 <p class="para">
  Many web applications will benefit from making persistent connections to
  database servers.  Persistent connections are not closed at the end of the
  script, but are cached and re-used when another script requests a
  connection using the same credentials.  The persistent connection cache
  allows you to avoid the overhead of establishing a new connection every
  time a script needs to talk to a database, resulting in a faster web
  application.
 </p>
 <p class="para">
  </p><div class="example" id="example-950">
   <p><strong>Example #4 Persistent connections</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$dbh&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #DD0000">'mysql:host=localhost;dbname=test'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$pass</span><span style="color: #007700">,&nbsp;array(<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">ATTR_PERSISTENT&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">true<br></span><span style="color: #007700">));<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 <p></p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  </p><p class="para">
   If you wish to use persistent connections, you must set
   <strong><code>PDO::ATTR_PERSISTENT</code></strong> in the array of driver options
   passed to the PDO constructor. If setting this attribute with
   <span class="function"><a href="pdo.setattribute.html" class="function">PDO::setAttribute()</a></span> after instantiation of the
   object, the driver will not use persistent connections.
  </p>
 <p></p></blockquote>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  </p><p class="para">
   If you're using the PDO ODBC driver and your ODBC libraries support ODBC
   Connection Pooling (unixODBC and Windows are two that do; there may be
   more), then it's recommended that you don't use persistent PDO
   connections, and instead leave the connection caching to the ODBC
   Connection Pooling layer.  The ODBC Connection Pool is shared with other
   modules in the process; if PDO is told to cache the connection, then
   that connection would never be returned to the ODBC connection pool,
   resulting in additional connections being created to service those other
   modules.
  </p>
 <p></p></blockquote>
</div>

<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="114822">  
  <a class="name">
  <strong class="user"><em>cappytoi at yahoo dot com</em></strong></a><div class="date" title="2014-04-09 07:08"><strong>4 months ago</strong></div>
  <div class="text" id="Hcom114822">
<div class="phpcode"><code><span class="html">
Using PHP 5.4.26, pdo_pgsql with libpg 9.2.8 (self compiled). As usual PHP never explains some critical stuff in documentation. You shouldn't expect that your connection is closed when you set $dbh = null unless all you do is just instantiating PDO class. Try following:<br><br><span class="default">&lt;?php<br>$pdo </span><span class="keyword">= new </span><span class="default">PDO</span><span class="keyword">(</span><span class="string">'pgsql:host=192.168.137.1;port=5432;dbname=anydb'</span><span class="keyword">, </span><span class="string">'anyuser'</span><span class="keyword">, </span><span class="string">'pw'</span><span class="keyword">);<br></span><span class="default">sleep</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br></span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$pdo</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">'SELECT * FROM sometable'</span><span class="keyword">);<br></span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br></span><span class="default">$pdo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br></span><span class="default">sleep</span><span class="keyword">(</span><span class="default">60</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Now check your database. And what a surprise! Your connection hangs for another 60 seconds. Now that might be expectable because you haven't cleared the resultset.<br><br><span class="default">&lt;?php<br>$pdo </span><span class="keyword">= new </span><span class="default">PDO</span><span class="keyword">(</span><span class="string">'pgsql:host=192.168.137.160;port=5432;dbname=platin'</span><span class="keyword">, </span><span class="string">'cappytoi'</span><span class="keyword">, </span><span class="string">'1111'</span><span class="keyword">);<br></span><span class="default">sleep</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br></span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$pdo</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">'SELECT * FROM admin'</span><span class="keyword">);<br></span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br></span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">closeCursor</span><span class="keyword">();<br></span><span class="default">$pdo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br></span><span class="default">sleep</span><span class="keyword">(</span><span class="default">60</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>What teh heck you say at this point? Still same? Here is what you need to do to close that connection:<br><br><span class="default">&lt;?php<br>$pdo </span><span class="keyword">= new </span><span class="default">PDO</span><span class="keyword">(</span><span class="string">'pgsql:host=192.168.137.160;port=5432;dbname=platin'</span><span class="keyword">, </span><span class="string">'cappytoi'</span><span class="keyword">, </span><span class="string">'1111'</span><span class="keyword">);<br></span><span class="default">sleep</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br></span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$pdo</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">'SELECT * FROM admin'</span><span class="keyword">);<br></span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br></span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">closeCursor</span><span class="keyword">(); </span><span class="comment">// this is not even required<br></span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">; </span><span class="comment">// doing this is mandatory for connection to get closed<br></span><span class="default">$pdo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br></span><span class="default">sleep</span><span class="keyword">(</span><span class="default">60</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>PDO is just one of a kind because it saves you to depend on 3rd party abstraction layers. But it becomes annoying to see there is no implementation of a "disconnect" method even though there is a request for it for 2 years. Developers underestimate the requirement of such a method. First of all, doing $stmt = null&nbsp; everywhere is annoying and what is most annoying is you cannot forcibly disconnect even when you set $pdo = null. It might get cleared on script's termination but this is not always possible because script termination may delayed due to slow client connection etc.<br><br>Anyway here is how to disconnect forcibly using postgresql:<br><br><span class="default">&lt;?php<br>$pdo </span><span class="keyword">= new </span><span class="default">PDO</span><span class="keyword">(</span><span class="string">'pgsql:host=192.168.137.160;port=5432;dbname=platin'</span><span class="keyword">, </span><span class="string">'cappytoi'</span><span class="keyword">, </span><span class="string">'1111'</span><span class="keyword">);<br></span><span class="default">sleep</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">);<br></span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">$pdo</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">'SELECT * FROM admin'</span><span class="keyword">);<br></span><span class="default">$stmt</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br></span><span class="default">$pdo</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">'SELECT pg_terminate_backend(pg_backend_pid());'</span><span class="keyword">);<br></span><span class="default">$pdo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br></span><span class="default">sleep</span><span class="keyword">(</span><span class="default">60</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Following may be used for MYSQL: (not guaranteed)<br>KILL CONNECTION_ID()</span>
</code></div>
  </div>
 </div>
  <div class="note" id="103365">  
  <a class="name">
  <strong class="user"><em>jak dot spalding at gmail dot com</em></strong></a><div class="date" title="2011-04-10 12:35"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom103365">
<div class="phpcode"><code><span class="html">
Just thought I'd add in and give an explanation as to why you need to use 127.0.0.1 if you have a different port number.<br><br>The mysql libraries will automatically use Unix sockets if the host of "localhost" is used. To force TCP/IP you need to set an IP address.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="94100">  
  <a class="name">
  <strong class="user"><em>neville at whitespacers dot com</em></strong></a><div class="date" title="2009-10-16 03:40"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom94100">
<div class="phpcode"><code><span class="html">
To avoid exposing your connection details should you fail to remember to catch any exception thrown by the PDO constructor you can use the following class to implicitly change the exception handler temporarily.<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">Class </span><span class="default">SafePDO </span><span class="keyword">extends </span><span class="default">PDO </span><span class="keyword">{<br> <br>&nbsp; &nbsp; &nbsp; &nbsp; public static function </span><span class="default">exception_handler</span><span class="keyword">(</span><span class="default">$exception</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Output the exception details<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">die(</span><span class="string">'Uncaught exception: '</span><span class="keyword">, </span><span class="default">$exception</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">());<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br> <br>&nbsp; &nbsp; &nbsp; &nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$dsn</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$driver_options</span><span class="keyword">=array()) {<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Temporarily change the PHP exception handler while we . . .<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">set_exception_handler</span><span class="keyword">(array(</span><span class="default">__CLASS__</span><span class="keyword">, </span><span class="string">'exception_handler'</span><span class="keyword">));<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// . . . create a PDO object<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$dsn</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">, </span><span class="default">$driver_options</span><span class="keyword">);<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Change the exception handler back to whatever it was before<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">restore_exception_handler</span><span class="keyword">();<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br><br>}<br><br></span><span class="comment">// Connect to the database with defined constants<br></span><span class="default">$dbh </span><span class="keyword">= new </span><span class="default">SafePDO</span><span class="keyword">(</span><span class="default">PDO_DSN</span><span class="keyword">, </span><span class="default">PDO_USER</span><span class="keyword">, </span><span class="default">PDO_PASSWORD</span><span class="keyword">);<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="104705">  
  <a class="name">
  <strong class="user"><em>alvaro at demogracia dot com</em></strong></a><div class="date" title="2011-07-01 10:07"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom104705">
<div class="phpcode"><code><span class="html">
On connection errors, the PDO constructor seems to do two things no matter your PDO::ATTR_ERRMODE setting:<br><br>1. Trigger a warning<br>2. Throw a PDOException<br><br>If you set the PDO::ATTR_ERRMODE parameter, it will only take effect on further operations.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112419">  
  <a class="name">
  <strong class="user"><em>thz at plista dot com</em></strong></a><div class="date" title="2013-06-14 01:27"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom112419">
<div class="phpcode"><code><span class="html">
If you are using PHP 5.4 and later, you can no longer use persistent connections when you have your own database class that derives from the native PDO object. If you do, you will get segmentation faults during the PHP process shutdown.<br><br>Please see this bug report for more information: https://bugs.php.net/bug.php?id=63176</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82591">  
  <a class="name">
  <strong class="user"><em>dan dot franklin at pearson dot com</em></strong></a><div class="date" title="2008-04-17 09:37"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom82591">
<div class="phpcode"><code><span class="html">
Note that you can specify a port number with "port=####", but this port number will be ignored if the host is localhost.&nbsp; If you want to connect to a local port other than the default, use host=127.0.0.1 instead of localhost.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115244">  
  <a class="name">
  <strong class="user"><em>Vicente</em></strong></a><div class="date" title="2014-06-19 08:48"><strong>2 months ago</strong></div>
  <div class="text" id="Hcom115244">
<div class="phpcode"><code><span class="html">
WARNING: please note that the documentation is FALSE and INCOMPLETE, when it states setting the variable to NULL is enough to close the connection. Unfortunately, the real signification is obscur for those who don't understand what it means setting a variable to NULL in PHP (ref count).<br><br>In fact, references count is used to determine automatically when a connection must be closed: when the connection instance is not holded by any variable anymore, it is closed. Not very flexible to manage resources allocation exactly the way you want.<br><br>PDO class actually doesn't expose any method to manually close connection it opens in the constructor.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="97168">  
  <a class="name">
  <strong class="user"><em>angela</em></strong></a><div class="date" title="2010-04-06 02:53"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom97168">
<div class="phpcode"><code><span class="html">
I spent hours today trying to get my portable wamp to update a database, using localhost:800 and port 3307 for mysql. For it to work I needed to adjust the connect() instruction as described:<br>$dsn = "mysql:host=127.0.0.1;port=3307;dbname=mydatabase";</span>
</code></div>
  </div>
 </div>
  <div class="note" id="114739">  
  <a class="name">
  <strong class="user"><em>jgestiotremovethis at gmail dot com</em></strong></a><div class="date" title="2014-03-31 10:47"><strong>4 months ago</strong></div>
  <div class="text" id="Hcom114739">
<div class="phpcode"><code><span class="html">
Most web development does not warrant the use of Object Oriented Programming so it is surprising to see interfaces such as PDO are only provided as a class. The language should not force the developers to adopt Object Oriented Programming if they do not wish to use it.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->
         
  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from php.net/manual/en/pdo.connections.php by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 28 Aug 2014 16:17:22 GMT -->


</body></html>