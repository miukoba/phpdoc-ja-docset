<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>COM関数</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="class.variant.html">≪ VARIANT</a></li>
      <li style="float: right;"><a href="function.com-addref.html">com_addref ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.com.html">COM</a></li>
    <li>COM関数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.com" class="reference"> 
 <h1 class="title">COM関数</h1> 
   
 <div class="partintro">
  <div class="section" id="com.seealso">
   <h2 class="title">参考</h2>
   <p class="para">
    COM についてのより詳細な情報は <a href="http://www.microsoft.com/Com/resources/comdocs.asp" class="link external" title="Link : http://www.microsoft.com/Com/resources/comdocs.asp">&raquo;&nbsp;COM
     仕様</a> を読むか、あるいは Don Box の
    <a href="http://www.sellsbrothers.com/links/dbox/yacl.zip" class="link external" title="Link : http://www.sellsbrothers.com/links/dbox/yacl.zip">&raquo;&nbsp;Yet Another COM Library (YACL)</a>
    をごらんください。その他の有用な情報が、
    <a href="faq.com.html" class="xref">PHP と COM</a> の FAQ からも得られるでしょう。
    MS Office アプリケーションをサーバーサイドで使用しようと考えておられるなら、
    <a href="http://support.microsoft.com/kb/257757" class="link external" title="Link : http://support.microsoft.com/kb/257757">&raquo;&nbsp;Considerations for Server-Side Automation
     of Office</a> の情報も読んでおくべきでしょう。
   </p> 
  </div>
 </div>

 




















































































































































































































































































































<h2>目次</h2><ul class="chunklist chunklist_reference"><li><a href="function.com-addref.html">com_addref</a> &mdash; コンポーネントの参照カウンタを増やす [非推奨]</li><li><a href="function.com-create-guid.html">com_create_guid</a> &mdash; グローバルユニーク ID (GUID) を生成する</li><li><a href="function.com-event-sink.html">com_event_sink</a> &mdash; COM オブジェクトのイベントを PHP オブジェクトに接続する</li><li><a href="function.com-get-active-object.html">com_get_active_object</a> &mdash; すでに実行中の COM オブジェクトのインスタンスへのハンドルを返す</li><li><a href="function.com-get.html">com_get</a> &mdash; COM コンポーネントのプロパティの値を得る [非推奨]</li><li><a href="function.com-invoke.html">com_invoke</a> &mdash; COM コンポーネントのメソッドをコールする [非推奨]</li><li><a href="function.com-isenum.html">com_isenum</a> &mdash; COM オブジェクトが IEnumVariant インターフェイスを実装しているかどうかを示す [非推奨]</li><li><a href="function.com-load-typelib.html">com_load_typelib</a> &mdash; タイプライブラリを読み込む</li><li><a href="function.com-load.html">com_load</a> &mdash; COM コンポーネントへの新規リファレンスを作成する [非推奨]</li><li><a href="function.com-message-pump.html">com_message_pump</a> &mdash; COM メッセージを処理し、timeoutms ミリ秒の間待つ</li><li><a href="function.com-print-typeinfo.html">com_print_typeinfo</a> &mdash; ディスパッチインターフェイスのために、PHP のクラス定義を出力する</li><li><a href="function.com-propget.html">com_propget</a> &mdash; com_get のエイリアス</li><li><a href="function.com-propput.html">com_propput</a> &mdash; com_set のエイリアス</li><li><a href="function.com-propset.html">com_propset</a> &mdash; com_set のエイリアス</li><li><a href="function.com-release.html">com_release</a> &mdash; コンポーネントリファレンスカウンタを減らす [廃止]</li><li><a href="function.com-set.html">com_set</a> &mdash; COM コンポーネントのプロパティに値を代入する</li><li><a href="function.variant-abs.html">variant_abs</a> &mdash; variant の絶対値を返す</li><li><a href="function.variant-add.html">variant_add</a> &mdash; 2 つの variant 値を「加算」し、結果を返す</li><li><a href="function.variant-and.html">variant_and</a> &mdash; 2 つの variant の論理積を計算し、結果を返す</li><li><a href="function.variant-cast.html">variant_cast</a> &mdash; variant を、別の型の新しい variant に変換する</li><li><a href="function.variant-cat.html">variant_cat</a> &mdash; 2 つの variant 値を連結し、その結果を返す</li><li><a href="function.variant-cmp.html">variant_cmp</a> &mdash; 2 つの variant を比較する</li><li><a href="function.variant-date-from-timestamp.html">variant_date_from_timestamp</a> &mdash; Unix タイムスタンプを、日付形式の variant で返す</li><li><a href="function.variant-date-to-timestamp.html">variant_date_to_timestamp</a> &mdash; 日付/時刻の variant 値を Unix タイムスタンプに変換する</li><li><a href="function.variant-div.html">variant_div</a> &mdash; 2 つの variant の除算結果を返す</li><li><a href="function.variant-eqv.html">variant_eqv</a> &mdash; 2 つの variant のビット値が等しいかどうかを調べる</li><li><a href="function.variant-fix.html">variant_fix</a> &mdash; variant の整数部を返す</li><li><a href="function.variant-get-type.html">variant_get_type</a> &mdash; variant オブジェクトの型を返す</li><li><a href="function.variant-idiv.html">variant_idiv</a> &mdash; variants を整数に変換し、除算の結果を返す</li><li><a href="function.variant-imp.html">variant_imp</a> &mdash; 2 つの variant のビット implication を行う</li><li><a href="function.variant-int.html">variant_int</a> &mdash; variant の整数部を返す</li><li><a href="function.variant-mod.html">variant_mod</a> &mdash; 2 つの variant の除算を行い、剰余を返す</li><li><a href="function.variant-mul.html">variant_mul</a> &mdash; 2 つの variant の乗算を行い、その結果を返す</li><li><a href="function.variant-neg.html">variant_neg</a> &mdash; variant の論理否定演算を行う</li><li><a href="function.variant-not.html">variant_not</a> &mdash; variant のビット否定演算を行う</li><li><a href="function.variant-or.html">variant_or</a> &mdash; 2 つの variant の論理和を計算する</li><li><a href="function.variant-pow.html">variant_pow</a> &mdash; 2 つの variant の累乗計算を行い、その結果を返す</li><li><a href="function.variant-round.html">variant_round</a> &mdash; 指定した桁で variant を丸める</li><li><a href="function.variant-set-type.html">variant_set_type</a> &mdash; variant を「その場で」別の型に変換する</li><li><a href="function.variant-set.html">variant_set</a> &mdash; variant オブジェクトに新しい値を代入する</li><li><a href="function.variant-sub.html">variant_sub</a> &mdash; 左の variant から右の variant を引き、その結果を返す</li><li><a href="function.variant-xor.html">variant_xor</a> &mdash; 2 つの variant の排他的論理和を計算する</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="95218""></a>
  <div class="note">
   <strong class="user">codeslinger at compsalot dot com</strong>
   <a href="#95218" class="date">18-Dec-2009 11:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
it took me awhile to track this down, the website given below is long gone, and it was hard to find the new site, so thought I would post it here.<br />
<br />
Here is the current website for DynamicWrapper<br />
<a href="http://freenet-homepage.de/gborn/WSHBazaar/WSHDynaCall.htm" rel="nofollow" target="_blank">http://freenet-homepage.de/gborn/WSHBazaar/WSHDynaCall.htm</a><br />
<br />
DynamicWrapper and WinBinder are dlls which enable php to call windows api's directly.<br />
<br />
see notes below for an example of using DynamicWrapper. <br />
<br />
It is an interesting alternative to <a href="http://www.winbinder.org&nbsp; which does similar things." rel="nofollow" target="_blank">http://www.winbinder.org&nbsp; which does similar things.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85494""></a>
  <div class="note">
   <strong class="user">larrywalker at at  chelseagroton dot com</strong>
   <a href="#85494" class="date">02-Sep-2008 05:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To run a php script in a background process and pass it you var use 
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
$WshShell </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WScript.Shell"</span><span class="keyword">);
<br />
</span><span class="default">$oExec </span><span class="keyword">= </span><span class="default">$WshShell</span><span class="keyword">-&gt;</span><span class="default">Run</span><span class="keyword">(</span><span class="string">"c:\\xampp\\php\\php.exe 
<br />

<br />
c:\\xampp\\Not_on_Web\\ftptestback.php --user=</span><span class="default">$username</span><span class="string">"</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Works for me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80074""></a>
  <div class="note">
   <strong class="user">monica at digitaldesignservices dot com</strong>
   <a href="#80074" class="date">27-Dec-2007 11:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Working with Word 2003 COM object.&nbsp; <br />
<br />
Have you been trying to work with the Word.Application COM and the Word Document would crash and the PHP script would hang?&nbsp; <br />
<br />
Turns out that there is an issue within the Office COM object that doesn't let the web application (IIS, Apache) scripting engine release the object after instancing the COM.&nbsp; The Service Pack 3 office update claims to remedy this.&nbsp; Will test and post findings.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78361""></a>
  <div class="note">
   <strong class="user">tomfmason at nospam-gmail dot com</strong>
   <a href="#78361" class="date">08-Oct-2007 04:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To get the cpu load percentage you can do something like this.<br />
<br />
<span class="default">&lt;?php<br />
$wmi </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'winmgmts://'</span><span class="keyword">);<br />
</span><span class="default">$processor </span><span class="keyword">= </span><span class="default">$wmi</span><span class="keyword">-&gt;</span><span class="default">ExecQuery</span><span class="keyword">(</span><span class="string">"SELECT * FROM Win32_Processor"</span><span class="keyword">);<br />
foreach(</span><span class="default">$processor </span><span class="keyword">as </span><span class="default">$obj</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cpu_load_time </span><span class="keyword">= </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">LoadPercentage</span><span class="keyword">;<br />
}<br />
echo </span><span class="default">$cpu_load_time</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
reference <a href="http://msdn2.microsoft.com/en-us/library/aa394373.aspx" rel="nofollow" target="_blank">http://msdn2.microsoft.com/en-us/library/aa394373.aspx</a><br />
<br />
To list current apache instances<br />
<br />
<span class="default">&lt;?php<br />
$wmi </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'winmgmts://'</span><span class="keyword">);<br />
</span><span class="default">$processes </span><span class="keyword">= </span><span class="default">$wmi</span><span class="keyword">-&gt;</span><span class="default">ExecQuery</span><span class="keyword">(</span><span class="string">"SELECT * FROM Win32_Process WHERE Name = 'httpd.exe'"</span><span class="keyword">);<br />
foreach(</span><span class="default">$processes </span><span class="keyword">as </span><span class="default">$process</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$process</span><span class="keyword">-&gt;</span><span class="default">CommandLine </span><span class="keyword">. </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$process</span><span class="keyword">-&gt;</span><span class="default">ProcessId </span><span class="keyword">. </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
reference <a href="http://msdn2.microsoft.com/en-us/library/aa394372.aspx" rel="nofollow" target="_blank">http://msdn2.microsoft.com/en-us/library/aa394372.aspx</a><br />
<br />
To run a php script in a background process<br />
<br />
<span class="default">&lt;?php<br />
$dir </span><span class="keyword">= </span><span class="string">"C:\\path\\to\\dir"</span><span class="keyword">;<br />
</span><span class="default">$php_path </span><span class="keyword">= </span><span class="string">"C:\\path\\to\\php.exe"</span><span class="keyword">;<br />
</span><span class="default">$file </span><span class="keyword">= </span><span class="string">"somescript.php"</span><span class="keyword">;<br />
</span><span class="comment">//send time current timestamp<br />
</span><span class="default">$cmd_options </span><span class="keyword">= </span><span class="string">"-t " </span><span class="keyword">. </span><span class="default">time</span><span class="keyword">();<br />
</span><span class="default">$wscript </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'WScript.Shell'</span><span class="keyword">);<br />
</span><span class="default">$wscript</span><span class="keyword">-&gt;</span><span class="default">Run</span><span class="keyword">(</span><span class="string">"cmd /K CD </span><span class="default">$php_path</span><span class="string"> </span><span class="default">$dir</span><span class="string">\\</span><span class="default">$file</span><span class="string">&nbsp; &amp;&nbsp; "</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Enjoy<br />
<br />
Tom</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78113""></a>
  <div class="note">
   <strong class="user">sk89q</strong>
   <a href="#78113" class="date">28-Sep-2007 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The only way I've been able to call Win32 API functions with PHP5 has been through COM and DynamicWrapper.
<br />

<br />
Here's an example to play a beep sound with your computer speaker:
<br />
<span class="default">&lt;?php
<br />
$com </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"DynamicWrapper"</span><span class="keyword">);
<br />
</span><span class="default">$com</span><span class="keyword">-&gt;</span><span class="default">Register</span><span class="keyword">(</span><span class="string">"KERNEL32.DLL"</span><span class="keyword">, </span><span class="string">"Beep"</span><span class="keyword">, </span><span class="string">"i=ll"</span><span class="keyword">, </span><span class="string">"f=s"</span><span class="keyword">, </span><span class="string">"r=l"</span><span class="keyword">);
<br />
</span><span class="default">$com</span><span class="keyword">-&gt;</span><span class="default">Beep</span><span class="keyword">(</span><span class="default">5000</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73791""></a>
  <div class="note">
   <strong class="user">naveed at php dot net</strong>
   <a href="#73791" class="date">10-Mar-2007 02:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a spell check implementation that displays the suggestion list for each misspelled word.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">SpellCheck</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word</span><span class="keyword">=new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Cannot create Word object"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Visible</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">WindowState</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">DisplayAlerts</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$doc</span><span class="keyword">=</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">Content</span><span class="keyword">=</span><span class="default">$input</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">CheckSpelling</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">= </span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">SpellingErrors</span><span class="keyword">-&gt;</span><span class="default">Count</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$result</span><span class="keyword">!=</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Input text contains misspelled words.\n\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt;= </span><span class="default">$result</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Original Word: " </span><span class="keyword">.</span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">SpellingErrors</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]-&gt;</span><span class="default">Text</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$list</span><span class="keyword">=</span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">SpellingErrors</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]-&gt;</span><span class="default">GetSpellingSuggestions</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Suggestions: "</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$j</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt;= </span><span class="default">$list</span><span class="keyword">-&gt;</span><span class="default">Count</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$correct</span><span class="keyword">=</span><span class="default">$list</span><span class="keyword">-&gt;</span><span class="default">Item</span><span class="keyword">(</span><span class="default">$j</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$correct</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">.</span><span class="string">","</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"\n\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"No spelling mistakes found."</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$str</span><span class="keyword">=</span><span class="string">"Hellu world. There is a spellling error in this sentence."</span><span class="keyword">;<br />
</span><span class="default">SpellCheck</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73229""></a>
  <div class="note">
   <strong class="user">Francois-R dot Boyer at PolyMtl dot ca</strong>
   <a href="#73229" class="date">14-Feb-2007 05:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had the problem when trying to call Access VBA scripts from PHP; the call was working but Access would never quit.&nbsp; The problem was that the Apache server is running as SYSTEM, and not a user we normally use to run Office.&nbsp; And as the first time a user runs Office, it asked the SYSTEM user to enter its name and initials! ;-)
<br />

<br />
To correct this problem: Stop Apache, go to Services, Apache, Properties, "Log On" tab, and check "Allow service to interact with desktop.&nbsp; Restart Apache, then open your office application, in a page loaded by the Apache server, with a small PHP code like this, :
<br />

<br />
<span class="default">&lt;?php
<br />
$app </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Access.Application"</span><span class="keyword">); </span><span class="comment">// or Word.Application or Excel.Application ...
<br />
</span><span class="default">$app</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">; </span><span class="comment">// so that we see the window on screen
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Put the name you want and quit the application.&nbsp; Now your Office application should terminate correctly the next time you load it with a COM object in PHP.&nbsp; You can stop Apache uncheck the "Allow service to interact with desktop", and restart Apache if you like.&nbsp; I don't even require a Quit or anything to be sent to Access, it quits automatically when PHP terminates.
<br />

<br />
And for those who wish to know how I'm calling Access VBA scripts, instead of using ODBC or any other way to send SQL requests, which does not seem to work to call VBA scripts, I open the database as a COM object and it works fine:
<br />

<br />
<span class="default">&lt;?php
<br />
$db_com </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"pathname of the file.mdb"</span><span class="keyword">);
<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">$db_com</span><span class="keyword">-&gt;</span><span class="default">Application</span><span class="keyword">-&gt;</span><span class="default">Run</span><span class="keyword">(</span><span class="string">"function_name"</span><span class="keyword">, </span><span class="string">'param1'</span><span class="keyword">, </span><span class="string">'param2'</span><span class="keyword">, </span><span class="string">'...'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72955""></a>
  <div class="note">
   <strong class="user">wiliamfeijo at gmail dot com</strong>
   <a href="#72955" class="date">05-Feb-2007 09:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This code use a Crystal Reports file with a connection on
<br />
&nbsp;Oracle 9i Database, suports manipulate and refresh data
<br />
&nbsp;and export to PDF file:
<br />

<br />
------ REMEMBER ------
<br />
These functions are only available if you had instaled the 
<br />
Crystal Reports Developer Edition. Catch the trial on the 
<br />
<a href="http://www.businessobjects.com web site." rel="nofollow" target="_blank">http://www.businessobjects.com web site.</a>
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">//------&nbsp; Variables ------
<br />
</span><span class="default">$my_report </span><span class="keyword">= </span><span class="string">"C:\\rel_apontamento.rpt"</span><span class="keyword">;
<br />
</span><span class="default">$my_pdf </span><span class="keyword">= </span><span class="string">"C:\\teste.pdf"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">//------ Create a new COM Object of Crytal Reports XI ------
<br />
</span><span class="default">$ObjectFactory</span><span class="keyword">= new
<br />
&nbsp;</span><span class="default">COM</span><span class="keyword">(</span><span class="string">"CrystalReports11.ObjectFactory.1"</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//------ Create a instance of library Application -------
<br />
</span><span class="default">$crapp 
<br />
</span><span class="keyword">=</span><span class="default">$ObjectFactory</span><span class="keyword">-&gt;
<br />
</span><span class="default">CreateObject</span><span class="keyword">(</span><span class="string">"CrystalDesignRunTime.Application.11"</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//------ Open your rpt file ------
<br />
</span><span class="default">$creport </span><span class="keyword">= </span><span class="default">$crapp</span><span class="keyword">-&gt;</span><span class="default">OpenReport</span><span class="keyword">(</span><span class="default">$my_report</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//------ Connect to Oracle 9i DataBase ------
<br />
</span><span class="default">$crapp</span><span class="keyword">-&gt;</span><span class="default">LogOnServer</span><span class="keyword">(</span><span class="string">'crdb_oracle.dll'</span><span class="keyword">,</span><span class="string">'YOUR_TNS'</span><span class="keyword">,
<br />
</span><span class="string">'YOUR_TABLE'</span><span class="keyword">,</span><span class="string">'YOUR_LOGIN'</span><span class="keyword">,</span><span class="string">'YOUR_PASSWORD'</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//------ Put the values that you want --------
<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">RecordSelectionFormula</span><span class="keyword">=
<br />
</span><span class="string">"{YOUR_TABLE.FIELD}='ANY_VALUE'"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">//------ This is very important. DiscardSavedData make a
<br />
&nbsp;</span><span class="default">Refresh in your data </span><span class="keyword">-------
<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">DiscardSavedData</span><span class="keyword">;
<br />

<br />
</span><span class="comment">//------ Read the records :-P -------
<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ReadRecords</span><span class="keyword">();
<br />

<br />
</span><span class="comment">//------ Export to PDF -------
<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DiskFileName</span><span class="keyword">=</span><span class="default">$my_pdf</span><span class="keyword">;
<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">FormatType</span><span class="keyword">=</span><span class="default">31</span><span class="keyword">;
<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DestinationType</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;
<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">Export</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//------ Release the variables
<br />
</span><span class="default">$creport </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
</span><span class="default">$crapp </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
</span><span class="default">$ObjectFactory </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
It's functional and perfectly !!!!!!!
<br />

<br />
Thanks.....</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70101""></a>
  <div class="note">
   
   <a href="#70101" class="date">03-Oct-2006 01:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If someone want to get a COM object out of a DCOM object can do something like that:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; $dcom_obj </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'dacom.object'</span><span class="keyword">,</span><span class="string">'remotehost'</span><span class="keyword">) or die(</span><span class="string">"Unable to get DCOM object!"</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$com_obj </span><span class="keyword">= new </span><span class="default">Variant</span><span class="keyword">(</span><span class="default">NULL</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$dcom_obj</span><span class="keyword">-&gt;</span><span class="default">Get_Module</span><span class="keyword">(</span><span class="default">$com_obj</span><span class="keyword">); </span><span class="comment">//user function which returns a custom IDispatch (casted as variant*)<br />
</span><span class="default">?&gt;<br />
</span><br />
Hopefully this will help someone, because it took me quite long to figure this out.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68208""></a>
  <div class="note">
   <strong class="user">kiotech at hotmail dot com</strong>
   <a href="#68208" class="date">18-Jul-2006 03:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For use parameters with PHP this is a Code Example
<br />

<br />
<span class="default">&lt;?php
<br />
$ObjectFactory</span><span class="keyword">= New </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"CrystalReports11.ObjectFactory.1"</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$crapp </span><span class="keyword">= </span><span class="default">$ObjectFactory</span><span class="keyword">-&gt;</span><span class="default">CreateObject</span><span class="keyword">(</span><span class="string">"CrystalDesignRunTime.Application"</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$creport </span><span class="keyword">= </span><span class="default">$crapp</span><span class="keyword">-&gt;</span><span class="default">OpenReport</span><span class="keyword">(</span><span class="string">"//report1.rpt"</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$z</span><span class="keyword">= </span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ParameterFields</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">SetCurrentValue</span><span class="keyword">(</span><span class="string">"Mango"</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$z</span><span class="keyword">= </span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ParameterFields</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">)-&gt;</span><span class="default">SetCurrentValue</span><span class="keyword">(</span><span class="default">5000</span><span class="keyword">);
<br />

<br />
&nbsp; </span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DiskFileName</span><span class="keyword">=</span><span class="string">"reportin.pdf"</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">PDFExportAllPages</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DestinationType</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;&nbsp;&nbsp; </span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">FormatType</span><span class="keyword">=</span><span class="default">31</span><span class="keyword">; 
<br />
&nbsp; </span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">Export</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);
<br />

<br />
</span><span class="default">$len </span><span class="keyword">= </span><span class="default">filesize</span><span class="keyword">(</span><span class="string">"reportin.pdf"</span><span class="keyword">);
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: application/pdf"</span><span class="keyword">);
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-Length: </span><span class="default">$len</span><span class="string">"</span><span class="keyword">);
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-Disposition: inline; filename=reportin.pdf"</span><span class="keyword">); 
<br />
</span><span class="default">readfile</span><span class="keyword">(</span><span class="string">"reportin.pdf"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63109""></a>
  <div class="note">
   <strong class="user">a dot kulikov at pool4tool dot com</strong>
   <a href="#63109" class="date">13-Mar-2006 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In case you are wondering how to group rows or columns in the freshly created EXCEL files, then this may help you
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; </span><span class="comment">/***
<br />
&nbsp;&nbsp;&nbsp; * Grouping Rows optically in Excel Using a COM Object
<br />
&nbsp;&nbsp;&nbsp; *
<br />
&nbsp;&nbsp;&nbsp; * That was not easy, I have spent several hours of trial and error to get
<br />
&nbsp;&nbsp;&nbsp; * this thing to work!!!
<br />
&nbsp;&nbsp;&nbsp; *
<br />
&nbsp;&nbsp;&nbsp; * @author Kulikov Alexey &lt;a.kulikov@gmail.com&gt;
<br />
&nbsp;&nbsp;&nbsp; * @since&nbsp; 13.03.2006
<br />
&nbsp;&nbsp;&nbsp; *
<br />
&nbsp;&nbsp;&nbsp; * @see&nbsp; &nbsp; Open Excel, Hit Alt+F11, thne Hit F2 -- this is your COM bible
<br />
&nbsp;&nbsp;&nbsp; ***/
<br />

<br />
&nbsp;&nbsp; //starting excel
<br />
&nbsp;&nbsp; </span><span class="default">$excel </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"excel.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instanciate excel"</span><span class="keyword">);
<br />
&nbsp;&nbsp; print </span><span class="string">"Loaded excel, version </span><span class="keyword">{</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="keyword">}</span><span class="string">\n"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">//bring it to front
<br />
&nbsp;&nbsp; #$excel-&gt;Visible = 1;//NOT
<br />

<br />
&nbsp;&nbsp; //dont want alerts ... run silent
<br />
&nbsp;&nbsp; </span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">DisplayAlerts </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">//create a new workbook
<br />
&nbsp;&nbsp; </span><span class="default">$wkb </span><span class="keyword">= </span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">();
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">//select the default sheet
<br />
&nbsp;&nbsp; </span><span class="default">$sheet</span><span class="keyword">=</span><span class="default">$wkb</span><span class="keyword">-&gt;</span><span class="default">Worksheets</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">//make it the active sheet
<br />
&nbsp;&nbsp; </span><span class="default">$sheet</span><span class="keyword">-&gt;</span><span class="default">activate</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">//fill it with some bogus data
<br />
&nbsp;&nbsp; </span><span class="keyword">for(</span><span class="default">$row</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;</span><span class="default">$row</span><span class="keyword">&lt;=</span><span class="default">7</span><span class="keyword">;</span><span class="default">$row</span><span class="keyword">++){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; for (</span><span class="default">$col</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;</span><span class="default">$col</span><span class="keyword">&lt;=</span><span class="default">5</span><span class="keyword">;</span><span class="default">$col</span><span class="keyword">++){
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sheet</span><span class="keyword">-&gt;</span><span class="default">activate</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cell</span><span class="keyword">=</span><span class="default">$sheet</span><span class="keyword">-&gt;</span><span class="default">Cells</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">,</span><span class="default">$col</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cell</span><span class="keyword">-&gt;</span><span class="default">Activate</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cell</span><span class="keyword">-&gt;</span><span class="default">value </span><span class="keyword">= </span><span class="string">'pool4tool 4eva ' </span><span class="keyword">. </span><span class="default">$row </span><span class="keyword">. </span><span class="string">' ' </span><span class="keyword">. </span><span class="default">$col </span><span class="keyword">. </span><span class="string">' ak'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; }</span><span class="comment">//end of colcount for loop
<br />
&nbsp;&nbsp; </span><span class="keyword">}
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">///////////
<br />
&nbsp;&nbsp; // Select Rows 2 to 5
<br />
&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">$sheet</span><span class="keyword">-&gt;</span><span class="default">Range</span><span class="keyword">(</span><span class="string">"2:5"</span><span class="keyword">)-&gt;</span><span class="default">Rows</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">// group them baby, yeah
<br />
&nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">Cells</span><span class="keyword">-&gt;</span><span class="default">Group</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">// save the new file
<br />
&nbsp;&nbsp; </span><span class="default">$strPath </span><span class="keyword">= </span><span class="string">'tfile.xls'</span><span class="keyword">;
<br />
&nbsp;&nbsp; if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$strPath</span><span class="keyword">)) {</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$strPath</span><span class="keyword">);}
<br />
&nbsp;&nbsp; </span><span class="default">$wkb</span><span class="keyword">-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="default">$strPath</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">//close the book
<br />
&nbsp;&nbsp; </span><span class="default">$wkb</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);
<br />
&nbsp;&nbsp; </span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">//free up the RAM
<br />
&nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$sheet</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">//closing excel
<br />
&nbsp;&nbsp; </span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">//free the object
<br />
&nbsp;&nbsp; </span><span class="default">$excel </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62629""></a>
  <div class="note">
   <strong class="user">Pedro Heliodoro</strong>
   <a href="#62629" class="date">05-Mar-2006 11:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using the Windows Media Player OCX and the latest snap of PHP 5.1 i was able to eject a CD-ROM drive<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//create an instance of Windows Media Player<br />
</span><span class="default">$mp </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WMPlayer.OCX"</span><span class="keyword">);<br />
</span><span class="comment">//ejects the first cd-rom on the drive list<br />
</span><span class="default">$mp</span><span class="keyword">-&gt;</span><span class="default">cdromcollection</span><span class="keyword">-&gt;</span><span class="default">item</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">)-&gt;</span><span class="default">eject</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61253""></a>
  <div class="note">
   <strong class="user">vedanta dot barooah at gmail dot com</strong>
   <a href="#61253" class="date">29-Jan-2006 04:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Microsoft provides two binaries to create windows services: INSTSRV.EXE and SRVANY.EXE, using these php scripts can be run as windows services.<br />
<br />
More information is available at: <a href="http://support.microsoft.com/?kbid=137890" rel="nofollow" target="_blank">http://support.microsoft.com/?kbid=137890</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58838""></a>
  <div class="note">
   <strong class="user">sadi at unicornsoftbd dot com</strong>
   <a href="#58838" class="date">17-Nov-2005 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There's no way to use static dlls in php. only way to use a dll in php is to make it a com object first and then using it in php like this<br />
<br />
<span class="default">&lt;?php<br />
$NewCom</span><span class="keyword">=new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"uni.example"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
once we created the COM object this can be used like any other php classes.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sadi<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; www.unicornsoftbd.com</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57279""></a>
  <div class="note">
   <strong class="user">allan666 at gmail dot com</strong>
   <a href="#57279" class="date">29-Sep-2005 12:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using a COM object that opens windows or dialogs (like Office applications), those windows or dialogs will not appear and will stay invisible even if you use codes like&nbsp; &nbsp;&nbsp; <br />
<br />
$word-&gt;visible = true;<br />
<br />
To solve this problem, go to the web service properties (Administrative Tools) and click (in the Logon TAB) "Allow the Service to Iterate with desktop".<br />
<br />
This explain lots of problems to close applications. When you try to close, the dialos asking to save the file must appear, but only in the option to iterate with desktop is on.<br />
<br />
Hope it helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53227""></a>
  <div class="note">
   <strong class="user">dazb@localhost</strong>
   <a href="#53227" class="date">26-May-2005 10:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For permissions problems, etc. including "Could Not Open Macro Storage" with Word;
<br />
How To Configure Office Applications to Run Under the Interactive User Account
<br />

<br />
<a href="http://theether.net/download/Microsoft/kb/288366.html" rel="nofollow" target="_blank">http://theether.net/download/Microsoft/kb/288366.html</a>
<br />

<br />
[EDITOR NOTE: As reported by "damir@example", the link originally provided in this note is dead. The note was updated with a new link sent from "damir". - Editor thiago AT php DOT net]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52681""></a>
  <div class="note">
   <strong class="user">mpg123 at thinstall dot com</strong>
   <a href="#52681" class="date">09-May-2005 10:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found the lack of good online docs about how to access a windows environment very frustrating.&nbsp; I finally found something here: <a href="http://www.sitepoint.com/forums/showthread.php?t=92358 but it" rel="nofollow" target="_blank">http://www.sitepoint.com/forums/showthread.php?t=92358 but it</a>'s a php4 way.&nbsp; I cleaned up the code, added introspection for methods and voila.&nbsp; Thanks and credit to the original posters.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// php translation of asp script by Bill Wooten from<br />
// <a href="http://www.4guysfromrolla.com/webtech/082802-1.shtml" rel="nofollow" target="_blank">http://www.4guysfromrolla.com/webtech/082802-1.shtml</a><br />
</span><span class="keyword">function </span><span class="default">showServices</span><span class="keyword">(</span><span class="default">$vComputerName</span><span class="keyword">, </span><span class="default">$vClass</span><span class="keyword">)&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$objLocator </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WbemScripting.SWbemLocator"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$vComputerName </span><span class="keyword">== </span><span class="string">""</span><span class="keyword">) </span><span class="default">$objService </span><span class="keyword">= </span><span class="default">$objLocator</span><span class="keyword">-&gt;</span><span class="default">ConnectServer</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; else&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$objService </span><span class="keyword">= </span><span class="default">$objLocator</span><span class="keyword">-&gt;</span><span class="default">ConnectServer</span><span class="keyword">(</span><span class="default">$vComputerName</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$objWEBM </span><span class="keyword">= </span><span class="default">$objService</span><span class="keyword">-&gt;</span><span class="default">Get</span><span class="keyword">(</span><span class="default">$vClass</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$objProp </span><span class="keyword">= </span><span class="default">$objWEBM</span><span class="keyword">-&gt;</span><span class="default">Properties_</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$objMeth </span><span class="keyword">= </span><span class="default">$objWEBM</span><span class="keyword">-&gt;</span><span class="default">Methods_</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$objMeth </span><span class="keyword">as </span><span class="default">$methItem</span><span class="keyword">) echo </span><span class="string">"Method: " </span><span class="keyword">. </span><span class="default">$methItem</span><span class="keyword">-&gt;</span><span class="default">Name </span><span class="keyword">.</span><span class="string">"\r\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"\r\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$objWEBMCol </span><span class="keyword">= </span><span class="default">$objWEBM</span><span class="keyword">-&gt;</span><span class="default">Instances_</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$objWEBMCol </span><span class="keyword">as </span><span class="default">$objItem</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"[" </span><span class="keyword">. </span><span class="default">$objItem</span><span class="keyword">-&gt;</span><span class="default">Name </span><span class="keyword">. </span><span class="string">"]\r\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$objProp </span><span class="keyword">as </span><span class="default">$propItem</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">$propItem</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"</span><span class="default">$tmp</span><span class="string">: " </span><span class="keyword">. </span><span class="default">$objItem</span><span class="keyword">-&gt;</span><span class="default">$tmp </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">// Test the function:<br />
</span><span class="default">showServices</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="string">"Win32_Processor"</span><span class="keyword">);<br />
</span><span class="default">showServices</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="string">"Win32_LogicalDisk"</span><span class="keyword">);</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52234""></a>
  <div class="note">
   <strong class="user">angelo [at] mandato &lt;dot&gt; com</strong>
   <a href="#52234" class="date">25-Apr-2005 06:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
ADO + PHP5 + SQL DATE FIELDS<br />
<br />
Using a COM("ADODB.Connection") object in PHP4 and PHP5 to return date fields in databases will have different results.<br />
<br />
In PHP4, the date is returned as a string as represented in the database.&nbsp; In my case, '2005-04-11 11:35:44'.<br />
<br />
In PHP5, the date is returned as a VARIANT type, when printed or implicitly casted would result as '4/11/2005 11:35:44 AM'.<br />
<br />
For this example, the solution is to use the variant conversion function variant_date_to_timestamp() to convert the value to a Unix timestamp.<br />
<br />
Please refer to this as an example.&nbsp; Other date types may be converted using one of the other variant_&lt;convert&gt; functions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52193""></a>
  <div class="note">
   <strong class="user">bruce at yourweb dot com dot au</strong>
   <a href="#52193" class="date">24-Apr-2005 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple convert xls to csv<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// starting excel <br />
</span><span class="default">$excel </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"excel.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instanciate excel"</span><span class="keyword">); <br />
print </span><span class="string">"Loaded excel, version </span><span class="keyword">{</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="keyword">}</span><span class="string">\n"</span><span class="keyword">; <br />
<br />
</span><span class="comment">//bring it to front <br />
#$excel-&gt;Visible = 1;//NOT<br />
//dont want alerts ... run silent <br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">DisplayAlerts </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; <br />
<br />
</span><span class="comment">//open&nbsp; document <br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"C:\\mydir\\myfile.xls"</span><span class="keyword">); <br />
</span><span class="comment">//XlFileFormat.xlcsv file format is 6<br />
//saveas command (file,format ......)<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="string">"c:\\mydir\\myfile.csv"</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">); <br />
<br />
</span><span class="comment">//closing excel <br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">(); <br />
<br />
</span><span class="comment">//free the object <br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">(); <br />
</span><span class="default">$excel </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">; <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51780""></a>
  <div class="note">
   <strong class="user">Jack dot CHLiang at gmail dot com</strong>
   <a href="#51780" class="date">11-Apr-2005 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to search an Excel file and don't connect with ODBC, you can try the function I provide. It will search a keyword in the Excel find and return its sheet name, text, field and the row which found the keyword.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// The example of print out the result<br />
</span><span class="default">$result </span><span class="keyword">= array();<br />
</span><span class="default">searchEXL</span><span class="keyword">(</span><span class="string">"C:/test.xls"</span><span class="keyword">, </span><span class="string">"test"</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">);<br />
<br />
foreach(</span><span class="default">$result </span><span class="keyword">as </span><span class="default">$sheet </span><span class="keyword">=&gt; </span><span class="default">$rs</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Found at </span><span class="default">$sheet</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;table width=\"100%\" border=\"1\"&gt;&lt;tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">[</span><span class="string">"FIELD"</span><span class="keyword">]); </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;th&gt;" </span><span class="keyword">. </span><span class="default">$rs</span><span class="keyword">[</span><span class="string">"FIELD"</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">] . </span><span class="string">"&lt;/th&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;/tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">[</span><span class="string">"TEXT"</span><span class="keyword">]); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$j </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">[</span><span class="string">"FIELD"</span><span class="keyword">]); </span><span class="default">$j</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;td&gt;" </span><span class="keyword">. </span><span class="default">$rs</span><span class="keyword">[</span><span class="string">"ROW"</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$j</span><span class="keyword">] . </span><span class="string">"&lt;/td&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;/tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;/table&gt;"</span><span class="keyword">;<br />
<br />
}<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* @param $file string The excel file path<br />
&nbsp;* @param $keyword string The keyword<br />
&nbsp;* @param $result array The search result<br />
&nbsp;*/<br />
<br />
</span><span class="keyword">function </span><span class="default">searchEXL</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$keyword</span><span class="keyword">, &amp;</span><span class="default">$result</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$exlObj </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Excel.Application"</span><span class="keyword">) or Die (</span><span class="string">"Did not connect"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$exlObj</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$exlBook </span><span class="keyword">= </span><span class="default">$exlObj</span><span class="keyword">-&gt;</span><span class="default">ActiveWorkBook</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$exlSheets </span><span class="keyword">= </span><span class="default">$exlBook</span><span class="keyword">-&gt;</span><span class="default">Sheets</span><span class="keyword">;<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt;= </span><span class="default">$exlSheets</span><span class="keyword">-&gt;</span><span class="default">Count</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$exlSheet </span><span class="keyword">= </span><span class="default">$exlBook</span><span class="keyword">-&gt;</span><span class="default">WorkSheets</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$sheetName </span><span class="keyword">= </span><span class="default">$exlSheet</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$exlRange </span><span class="keyword">= </span><span class="default">$exlSheet</span><span class="keyword">-&gt;</span><span class="default">Cells</span><span class="keyword">-&gt;</span><span class="default">Find</span><span class="keyword">(</span><span class="default">$keyword</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$col </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">$fields </span><span class="keyword">= </span><span class="default">$exlSheet</span><span class="keyword">-&gt;</span><span class="default">Cells</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">$col</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$fields</span><span class="keyword">-&gt;</span><span class="default">Text </span><span class="keyword">== </span><span class="string">""</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$sheetName</span><span class="keyword">][</span><span class="string">"FIELD"</span><span class="keyword">][] = </span><span class="default">$fields</span><span class="keyword">-&gt;</span><span class="default">Text</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$col</span><span class="keyword">++;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$firstAddress </span><span class="keyword">= </span><span class="default">$exlRange</span><span class="keyword">-&gt;</span><span class="default">Address</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$finding </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$sheetName</span><span class="keyword">][</span><span class="string">"TEXT"</span><span class="keyword">][] = </span><span class="default">$exlRange</span><span class="keyword">-&gt;</span><span class="default">Text</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$j </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt;= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">[</span><span class="default">$sheetName</span><span class="keyword">][</span><span class="string">"FIELD"</span><span class="keyword">]); </span><span class="default">$j</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cell </span><span class="keyword">= </span><span class="default">$exlSheet</span><span class="keyword">-&gt;</span><span class="default">Cells</span><span class="keyword">(</span><span class="default">$exlRange</span><span class="keyword">-&gt;</span><span class="default">Row </span><span class="keyword">,</span><span class="default">$j</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$sheetName</span><span class="keyword">][</span><span class="string">"ROW"</span><span class="keyword">][</span><span class="default">$finding </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">][</span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] = </span><span class="default">$cell</span><span class="keyword">-&gt;</span><span class="default">Text</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">$exlRange </span><span class="keyword">= </span><span class="default">$exlRange</span><span class="keyword">-&gt;</span><span class="default">Cells</span><span class="keyword">-&gt;</span><span class="default">Find</span><span class="keyword">(</span><span class="default">$keyword</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$exlRange</span><span class="keyword">-&gt;</span><span class="default">Address </span><span class="keyword">== </span><span class="default">$firstAddress</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$finding</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$sheetName</span><span class="keyword">][</span><span class="string">"TEXT"</span><span class="keyword">][] = </span><span class="default">$exlRange</span><span class="keyword">-&gt;</span><span class="default">Text</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$j </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt;= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">[</span><span class="default">$sheetName</span><span class="keyword">][</span><span class="string">"FIELD"</span><span class="keyword">]); </span><span class="default">$j</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cell </span><span class="keyword">= </span><span class="default">$exlSheet</span><span class="keyword">-&gt;</span><span class="default">Cells</span><span class="keyword">(</span><span class="default">$exlRange</span><span class="keyword">-&gt;</span><span class="default">Row </span><span class="keyword">,</span><span class="default">$j</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$sheetName</span><span class="keyword">][</span><span class="string">"ROW"</span><span class="keyword">][</span><span class="default">$finding </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">][</span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] = </span><span class="default">$cell</span><span class="keyword">-&gt;</span><span class="default">Text</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; </span><span class="default">$exlBook</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp; unset(</span><span class="default">$exlSheets</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$exlObj</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br />
&nbsp;&nbsp; unset(</span><span class="default">$exlBook</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$exlObj</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">;<br />
&nbsp;&nbsp; unset(</span><span class="default">$exlObj</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
For more information, please visit my blog site (written in Chinese)<br />
<a href="http://www.microsmile.idv.tw/blog/index.php?p=77" rel="nofollow" target="_blank">http://www.microsmile.idv.tw/blog/index.php?p=77</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50287""></a>
  <div class="note">
   <strong class="user">michael at example dot com</strong>
   <a href="#50287" class="date">23-Feb-2005 09:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After alot of trouble with IIS 6/Windows 2003 and PHP 5.0.2 I figured out how to use Imagemagick COM+/OLE interface. Seems you have to recreate the COM object after each convert() otherwise it will sometimes fail with very strange errors, since the PHP COM interface is not as stable as the old ASP one apparently is.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49953""></a>
  <div class="note">
   <strong class="user">pelegk2 at walla DOT co DOT il</strong>
   <a href="#49953" class="date">13-Feb-2005 05:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Printing to a network printer :
<br />
read this note for : 
<br />

<br />
NOTE: Using COM with windows NT/2000/XP with apache as a service 
<br />
- Run dcomcnfg.exe 
<br />
- Find word application and click properties 
<br />
- Click the Security tab 
<br />
- Use Custom Access Permissions 
<br />
- Add the user who runs the web server service 
<br />
- Use Custom Launch permissions 
<br />
- Add the user who runs the web server service 
<br />

<br />
THEN
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// starting word
<br />
</span><span class="default">$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instanciate Word"</span><span class="keyword">);
<br />
print </span><span class="string">"Loaded Word, version </span><span class="keyword">{</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="keyword">}</span><span class="string">\n"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// bring it to front
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br />
</span><span class="comment">//this is for example a printer on my network
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActivePrinter </span><span class="keyword">= </span><span class="string">"\\\\192.168.4.201\\printer1"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// Open a word document, or anything else that word
<br />
// can read
<br />
</span><span class="default">$input </span><span class="keyword">=</span><span class="string">"c:\\test.html"</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);
<br />

<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">PrintOut</span><span class="keyword">();
<br />

<br />
</span><span class="comment">// closing word
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Close</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();
<br />

<br />
</span><span class="comment">// free the object
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();
<br />
</span><span class="default">$word </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
unset(</span><span class="default">$word</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48775""></a>
  <div class="note">
   
   <a href="#48775" class="date">06-Jan-2005 06:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you want to add a new hyperlink with excel :
<br />

<br />
<span class="default">&lt;?php
<br />
$cell</span><span class="keyword">=</span><span class="default">$sheet</span><span class="keyword">-&gt;</span><span class="default">Range</span><span class="keyword">(</span><span class="string">'O'</span><span class="keyword">.</span><span class="default">$j</span><span class="keyword">);
<br />
</span><span class="default">$cell</span><span class="keyword">-&gt;</span><span class="default">Hyperlinks</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">(</span><span class="default">$cell </span><span class="keyword">,</span><span class="string">'here_your_file'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
I write this note because is very difficult to find 
<br />
the good method to do that .
<br />

<br />
Merci beaucoup</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45996""></a>
  <div class="note">
   <strong class="user">sorin dot andrei at mymail dot ro</strong>
   <a href="#45996" class="date">25-Sep-2004 11:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editor's Note:
<br />
Serializing the object, storing it and then (on the next page) unserializing it WILL work.
<br />
End Note]
<br />

<br />
the big problem for PHP is it can't save in session an COM object
<br />

<br />
an samples code is here. This works just first time, then give the error:
<br />
Call to undefined method com::Refresh() on line&nbsp; $mMap-&gt;Refresh();
<br />
the reson is he can't save the object $mMap in session
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; session_start</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'map'</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mMap </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'map'</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ArcIMSConnector </span><span class="keyword">= new </span><span class="default">COM </span><span class="keyword">(</span><span class="string">"aims.ArcIMSConnector"</span><span class="keyword">)&nbsp; or die(</span><span class="string">"can not create AIMS message object"</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Loaded ArcIMSConnector, &lt;br&gt;"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ArcIMSConnector</span><span class="keyword">-&gt;</span><span class="default">ServerName </span><span class="keyword">= </span><span class="string">"map.sdsu.edu"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ArcIMSConnector</span><span class="keyword">-&gt;</span><span class="default">ServerPort </span><span class="keyword">= </span><span class="default">5300</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mMap </span><span class="keyword">= new </span><span class="default">COM </span><span class="keyword">(</span><span class="string">"aims.Map"</span><span class="keyword">)&nbsp; or die(</span><span class="string">"can not create aims.Map message object"</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Loaded aims.Map, &lt;br&gt;"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"AIMS-ServerName= </span><span class="default">$ArcIMSConnector</span><span class="keyword">-&gt;</span><span class="default">ServerName</span><span class="string"> &lt;br&gt;"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$resultInit</span><span class="keyword">= </span><span class="default">$mMap</span><span class="keyword">-&gt;</span><span class="default">InitMap</span><span class="keyword">(</span><span class="default">$ArcIMSConnector</span><span class="keyword">,</span><span class="string">"Worldgeography"</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mMap</span><span class="keyword">-&gt;</span><span class="default">Width&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">400</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Width of the map in pixels
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mMap</span><span class="keyword">-&gt;</span><span class="default">Height&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">300</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Height of the map in pixels
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mMap</span><span class="keyword">-&gt;</span><span class="default">BackColor </span><span class="keyword">= </span><span class="default">15130848</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'map'</span><span class="keyword">] = </span><span class="default">$mMap</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$resultRefresh </span><span class="keyword">= </span><span class="default">$mMap</span><span class="keyword">-&gt;</span><span class="default">Refresh</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//Refresh the map
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$urlImage&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">$mMap</span><span class="keyword">-&gt;</span><span class="default">GetImageAsUrl</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;br&gt;urlImage=</span><span class="default">$urlImage</span><span class="string">&lt;br&gt;"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;br&gt;&lt;IMG SRC='</span><span class="default">$urlImage</span><span class="string">'&gt;"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">/*
<br />
&nbsp;&nbsp;&nbsp; $ArcIMSConnector-&gt;Release();
<br />
&nbsp;&nbsp;&nbsp; $ArcIMSConnector = null;
<br />

<br />
&nbsp;&nbsp;&nbsp; $mMap-&gt;Release();
<br />
&nbsp;&nbsp;&nbsp; $mMap = null;
<br />
*/
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45038""></a>
  <div class="note">
   <strong class="user">ferozzahid [at] usa [dot] com</strong>
   <a href="#45038" class="date">24-Aug-2004 09:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To pass a parameter by reference to a COM function, you need to pass VARIANT to it. Common data types like integers and strings will not work for it.
<br />

<br />
As an example, calling a function that retrieves the name of a person will look like:
<br />

<br />
<span class="default">&lt;?php
<br />
$Name </span><span class="keyword">= new </span><span class="default">VARIANT</span><span class="keyword">;
<br />

<br />
</span><span class="default">$comobj </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"MyCOMOBj.Component"</span><span class="keyword">) or die(</span><span class="string">"Couldn't create the COM Component"</span><span class="keyword">);
<br />

<br />
if(!</span><span class="default">$comobj</span><span class="keyword">-&gt;</span><span class="default">GetName</span><span class="keyword">(</span><span class="default">$Name</span><span class="keyword">)) {
<br />
&nbsp;&nbsp;&nbsp; echo(</span><span class="string">"Could not retrieve name"</span><span class="keyword">);
<br />
}
<br />
else {
<br />
&nbsp;&nbsp;&nbsp; echo(</span><span class="string">"The name retrieved is : " </span><span class="keyword">. </span><span class="default">$Name</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
$Name-&gt;type will contain the type of the value stored in the VARIANT e.g. VT_BSTR.
<br />

<br />
Note For PHP 5:
<br />

<br />
Insted of '$Name-&gt;value', we can use only '$Name' for getting the value stored in the VARIANT. To get the type of the value stored in the VARIANT, use 'variant_get_type($Name)'.
<br />

<br />
Feroz Zahid</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44625""></a>
  <div class="note">
   <strong class="user">Shawn Coppock</strong>
   <a href="#44625" class="date">11-Aug-2004 10:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of us that are not experts with object models, if you have Microsoft Excel or Microsoft Word available, go into the Visual Basic Editor (Alt+F11). Now you can open the object browser window (F2) and see what you find.
<br />

<br />
If you select "Word" in the object browser, then the classes and members of that class are displayed below. For example, if you click on "Selection" in the classes column, and then "Font" in the members column, you will then see "Property Font As Font Member of Word.Selection" displayed at the bottom. Click on the "Font" link there.
<br />

<br />
Click on Word "Selection" again in the classes column, and then "PageSetup" in the members column, you will then see "Property PageSetup As PageSetup Member of word.Selection" displayed at the bottom. Click on the "PageSetup" link there.
<br />

<br />
Using the above examples, you can now formulate your Word Document from php. Here is a simple example that creates a 1 &amp; 1/2" space for text based on the margin settings &amp; with dark red text and an 8pt Helvetica font face:
<br />

<br />
<span class="default">&lt;?php
<br />
$content </span><span class="keyword">= </span><span class="string">"Insert Sample Text Here\n\nThis starts a new paragraph line."</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to create Word document"</span><span class="keyword">); 
<br />
print </span><span class="string">"Loaded Word, version </span><span class="keyword">{</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="keyword">}</span><span class="string">\n"</span><span class="keyword">; 
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; 
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">(); 
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">PageSetup</span><span class="keyword">-&gt;</span><span class="default">LeftMargin </span><span class="keyword">= </span><span class="string">'3"'</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">PageSetup</span><span class="keyword">-&gt;</span><span class="default">RightMargin </span><span class="keyword">= </span><span class="string">'4"'</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">Font</span><span class="keyword">-&gt;</span><span class="default">Name </span><span class="keyword">= </span><span class="string">'Helvetica'</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">Font</span><span class="keyword">-&gt;</span><span class="default">Size </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">Font</span><span class="keyword">-&gt;</span><span class="default">ColorIndex</span><span class="keyword">= </span><span class="default">13</span><span class="keyword">; </span><span class="comment">//wdDarkRed = 13
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">TypeText</span><span class="keyword">(</span><span class="string">"</span><span class="default">$content</span><span class="string">"</span><span class="keyword">); 
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="string">"some_tst.doc"</span><span class="keyword">); 
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">quit</span><span class="keyword">(); 
<br />
echo </span><span class="string">"done"</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
This example (and others) worked for me with Microsoft Word 10.0 Object Library (MS Word 2002), Apache &amp; PHP on Windows XP. Experimenting using the Visual Basic editor will yield some amazing documents from PHP as it will help you see the relationships of the objects used and give you an idea as to how to construct your code. But be prepared for an occaisional PHP.exe crash if your code is way off base.
<br />

<br />
Hope this helps!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44347""></a>
  <div class="note">
   <strong class="user">Jason Neal</strong>
   <a href="#44347" class="date">21-Jul-2004 09:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having issues with the outlook.application locking up when you try to access it, ensure that your apache server is running in the context of a user on the machine instead of the system account.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42918""></a>
  <div class="note">
   <strong class="user">angelo [at] mandato &lt;dot&gt; com</strong>
   <a href="#42918" class="date">03-Jun-2004 08:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Useful PHP MSWord class I created to do some simple file conversions.&nbsp; This class could have a lot more to it but I am not familiar with all the COM MS Word function calls.<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// msword.inc.php<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; // NOTE: Using COM with windows NT/2000/XP with apache as a service<br />
&nbsp;&nbsp;&nbsp; // - Run dcomcnfg.exe<br />
&nbsp;&nbsp;&nbsp; // - Find word application and click properties<br />
&nbsp;&nbsp;&nbsp; // - Click the Security tab<br />
&nbsp;&nbsp;&nbsp; // - Use Custom Access Permissions<br />
&nbsp;&nbsp;&nbsp; //&nbsp; &nbsp; &nbsp; - Add the user who runs the web server service<br />
&nbsp;&nbsp;&nbsp; // - Use Custom Launch permissions<br />
&nbsp;&nbsp;&nbsp; //&nbsp; &nbsp; &nbsp; - Add the user who runs the web server service<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wdFormatDocument </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wdFormatTemplate </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wdFormatText </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wdFormatTextLineBreaks </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wdFormatDOSText </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wdFormatDOSTextLineBreaks </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wdFormatRTF </span><span class="keyword">= </span><span class="default">6</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wdFormatUnicodeText </span><span class="keyword">= </span><span class="default">7</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wdFormatHTML</span><span class="keyword">=</span><span class="default">8</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; class </span><span class="default">MSWord<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Vars:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">var </span><span class="default">$handle</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Create COM instance to word<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">MSWord</span><span class="keyword">(</span><span class="default">$Visible </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instanciate Word"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">$Visible</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Open existing document<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">Open</span><span class="keyword">(</span><span class="default">$File</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$File</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Create new document<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">NewDocument</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Write text to active document<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">WriteText</span><span class="keyword">( </span><span class="default">$Text </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">Typetext</span><span class="keyword">( </span><span class="default">$Text </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Number of documents open<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">DocumentCount</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Count</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Save document as another file and/or format<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">SaveAs</span><span class="keyword">(</span><span class="default">$File</span><span class="keyword">, </span><span class="default">$Format </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="default">$File</span><span class="keyword">, </span><span class="default">$Format</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Save active document<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">Save</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Save</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// close active document.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">Close</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Get word version<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">GetVersion</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// get handle to word<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">GetHandle</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Clean up instance with word<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">Quit</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// close word<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// free the object<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">handle </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; };<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Example 1, opens an html file, writes text to it, then saves it as a document:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $input </span><span class="keyword">= </span><span class="string">"C:\\test.htm"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="string">"C:\\test.doc"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Word </span><span class="keyword">= new </span><span class="default">MSWord</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Word</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Word</span><span class="keyword">-&gt;</span><span class="default">WriteText</span><span class="keyword">(</span><span class="string">"This is a test "</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Word</span><span class="keyword">-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Example 2, opens an html file, then saves it as a rtf file:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $input </span><span class="keyword">= </span><span class="string">"C:\\test.htm"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="string">"C:\\test.rtf"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Word </span><span class="keyword">= new </span><span class="default">MSWord</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Word</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Word</span><span class="keyword">-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">, </span><span class="default">$wdFormatRTF</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42496""></a>
  <div class="note">
   <strong class="user">angelo [at] mandato &lt;dot&gt; com</strong>
   <a href="#42496" class="date">19-May-2004 01:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Useful PHP functions I created (similar to other standard PHP database functions) for working with an ADO datasource:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// ado.inc.php<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ADO_NUM </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ADO_ASSOC </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ADO_BOTH </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_connect</span><span class="keyword">( </span><span class="default">$dsn </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$link </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$link</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$dsn</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$link</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_close</span><span class="keyword">( </span><span class="default">$link </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$link</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_num_fields</span><span class="keyword">( </span><span class="default">$rs </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">-&gt;</span><span class="default">Count</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_error</span><span class="keyword">(</span><span class="default">$link</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$link</span><span class="keyword">-&gt;</span><span class="default">Errors</span><span class="keyword">[</span><span class="default">$link</span><span class="keyword">-&gt;</span><span class="default">Errors</span><span class="keyword">-&gt;</span><span class="default">Count</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Number</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_errormsg</span><span class="keyword">(</span><span class="default">$link</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$link</span><span class="keyword">-&gt;</span><span class="default">Errors</span><span class="keyword">[</span><span class="default">$link</span><span class="keyword">-&gt;</span><span class="default">Errors</span><span class="keyword">-&gt;</span><span class="default">Count</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Description</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_fetch_array</span><span class="keyword">( </span><span class="default">$rs</span><span class="keyword">, </span><span class="default">$result_type</span><span class="keyword">,&nbsp; </span><span class="default">$row_number </span><span class="keyword">= -</span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; global </span><span class="default">$ADO_NUM</span><span class="keyword">, </span><span class="default">$ADO_ASSOC</span><span class="keyword">, </span><span class="default">$ADO_BOTH</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$row_number </span><span class="keyword">&gt; -</span><span class="default">1 </span><span class="keyword">) </span><span class="comment">// Defined in adoint.h - adBookmarkFirst&nbsp; &nbsp; = 1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Move</span><span class="keyword">( </span><span class="default">$row_number</span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">EOF </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ToReturn </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for( </span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">ado_num_fields</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">); </span><span class="default">$x</span><span class="keyword">++ )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$result_type </span><span class="keyword">== </span><span class="default">$ADO_NUM </span><span class="keyword">|| </span><span class="default">$result_type </span><span class="keyword">== </span><span class="default">$ADO_BOTH </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ToReturn</span><span class="keyword">[ </span><span class="default">$x </span><span class="keyword">] = </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">]-&gt;</span><span class="default">Value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$result_type </span><span class="keyword">== </span><span class="default">$ADO_ASSOC </span><span class="keyword">|| </span><span class="default">$result_type </span><span class="keyword">== </span><span class="default">$ADO_BOTH </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ToReturn</span><span class="keyword">[ </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">]-&gt;</span><span class="default">Name </span><span class="keyword">] = </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">]-&gt;</span><span class="default">Value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$ToReturn</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_num_rows</span><span class="keyword">( </span><span class="default">$rs </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">RecordCount</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_free_result</span><span class="keyword">( </span><span class="default">$rs </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_query</span><span class="keyword">( </span><span class="default">$link</span><span class="keyword">, </span><span class="default">$query </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$link</span><span class="keyword">-&gt;</span><span class="default">Execute</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_fetch_assoc</span><span class="keyword">( </span><span class="default">$rs</span><span class="keyword">,&nbsp; </span><span class="default">$row_number </span><span class="keyword">= -</span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; global </span><span class="default">$ADO_ASSOC</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return&nbsp; </span><span class="default">ado_fetch_array</span><span class="keyword">( </span><span class="default">$rs</span><span class="keyword">, </span><span class="default">$ADO_ASSOC</span><span class="keyword">, </span><span class="default">$row_number</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_fetch_row</span><span class="keyword">( </span><span class="default">$rs</span><span class="keyword">,&nbsp; </span><span class="default">$row_number </span><span class="keyword">= -</span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; global </span><span class="default">$ADO_NUM</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">ado_fetch_array</span><span class="keyword">( </span><span class="default">$rs</span><span class="keyword">, </span><span class="default">$ADO_NUM</span><span class="keyword">, </span><span class="default">$row_number</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Extra functions:<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">ado_field_len</span><span class="keyword">( </span><span class="default">$rs</span><span class="keyword">, </span><span class="default">$field_number </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="default">$field_number</span><span class="keyword">]-&gt;</span><span class="default">Precision</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_field_name</span><span class="keyword">( </span><span class="default">$rs</span><span class="keyword">, </span><span class="default">$field_number </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="default">$field_number</span><span class="keyword">]-&gt;</span><span class="default">Name</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_field_scale</span><span class="keyword">( </span><span class="default">$rs</span><span class="keyword">, </span><span class="default">$field_number </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="default">$field_number</span><span class="keyword">]-&gt;</span><span class="default">NumericScale</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">ado_field_type</span><span class="keyword">( </span><span class="default">$rs</span><span class="keyword">, </span><span class="default">$field_number </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="default">$field_number</span><span class="keyword">]-&gt;</span><span class="default">Type</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">?&gt;<br />
</span><br />
The aod version was a typo.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40335""></a>
  <div class="note">
   <strong class="user">mark dickens at mindspring dot com</strong>
   <a href="#40335" class="date">29-Feb-2004 05:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a note to those wanting to use COM to interface to printers under Windows 2000/XP.&nbsp; If it doesn't work or seems to hang, try changing the logon identity under which the Apache (assuming you're using Apache) service is running from the System account to another account.&nbsp; By default most services will install to run under the System account and although the System account has total authority on the computer it is running on, it has no authority outside of that realm as I understand it.&nbsp; Apparently accessing printers is considered "outside the realm".&nbsp; I used this technique to interface a Dymo thermal label printer to my server and it works now.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39846""></a>
  <div class="note">
   <strong class="user">platiumstar at canada dot com</strong>
   <a href="#39846" class="date">13-Feb-2004 12:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I didn't found any working examples of PHP using the MSMQ COM object, so I made up one, thought I share it with everybody..it works ok.
<br />
You have to create a local Public message queue named "TestQueue" first.
<br />

<br />
<span class="default">&lt;?php
<br />
define</span><span class="keyword">(</span><span class="default">MQ_SEND_ACCESS </span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);
<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="default">MQ_DENY_NONE </span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br />

<br />
</span><span class="default">$msgQueueInfo </span><span class="keyword">=&nbsp; new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"MSMQ.MSMQQueueInfo"</span><span class="keyword">) or die(</span><span class="string">"can not create MSMQ Info object"</span><span class="keyword">);
<br />
</span><span class="default">$msgQueueInfo</span><span class="keyword">-&gt;</span><span class="default">PathName </span><span class="keyword">= </span><span class="string">".\TestQueue"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
</span><span class="default">$msgQueue </span><span class="keyword">=&nbsp; new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"MSMQ.MSMQQueue"</span><span class="keyword">) or die(</span><span class="string">"can not create MSMQ object"</span><span class="keyword">);
<br />
</span><span class="default">$msgQueue</span><span class="keyword">=</span><span class="default">$msgQueueInfo</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">MQ_SEND_ACCESS</span><span class="keyword">, </span><span class="default">MQ_DENY_NONE </span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
</span><span class="default">$msgOut </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"MSMQ.MSMQMessage"</span><span class="keyword">) or die(</span><span class="string">"can not create MSMQ message object"</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br />
</span><span class="default">$msgOut</span><span class="keyword">-&gt;</span><span class="default">Body </span><span class="keyword">= </span><span class="string">"Hello world!"</span><span class="keyword">;
<br />
</span><span class="default">$msgOut</span><span class="keyword">-&gt;</span><span class="default">Send</span><span class="keyword">(</span><span class="default">$msgQueue</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
</span><span class="default">$msgQueue</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; 
<br />
unset(</span><span class="default">$msgOut</span><span class="keyword">);
<br />
unset(</span><span class="default">$msgQueue</span><span class="keyword">);
<br />
unset(</span><span class="default">$msgQueueInfo</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
enjoy
<br />
PS</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38289""></a>
  <div class="note">
   <strong class="user">kleontiv -at- combellga -dot- ru</strong>
   <a href="#38289" class="date">15-Dec-2003 08:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
And here is an example of using ADSI via ADODB. This sample is unique because only ADODB can provide recursive Active directory searching and listing. But ADODB can only READ Active directory. So you can find something by ADODB and then modify that directly by ADSI.<br />
<br />
With previos example this help build you PHP coded interface to Menaging and browsing Microsoft Active Directory.<br />
<br />
Also ADODB on ADSI helps you sort recordset and search on it.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$objConnection </span><span class="keyword">= new </span><span class="default">COM </span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">) ;<br />
</span><span class="default">$objConnection</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"Provider=ADsDSOObject;user id=DOMAIN\\login;password=your_passowrd;"</span><span class="keyword">) ;<br />
<br />
</span><span class="default">$objCommand </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Command"</span><span class="keyword">) ;<br />
</span><span class="default">$objCommand</span><span class="keyword">-&gt;</span><span class="default">ActiveConnection </span><span class="keyword">= </span><span class="default">$objConnection </span><span class="keyword">;<br />
<br />
</span><span class="default">$Cmd&nbsp; </span><span class="keyword">= </span><span class="string">"&lt;LDAP://dc=mydomain,dc=com&gt;;" </span><span class="keyword">;<br />
</span><span class="default">$Cmd </span><span class="keyword">.= </span><span class="string">"(&amp;(objectClass=user)(mail=*)(!cn=SystemMailbox*));" </span><span class="keyword">;<br />
</span><span class="default">$Cmd </span><span class="keyword">.= </span><span class="string">"name,mail,telephoneNumber;subtree" </span><span class="keyword">;<br />
<br />
</span><span class="default">$objCommand</span><span class="keyword">-&gt;</span><span class="default">Properties</span><span class="keyword">[</span><span class="string">'Sort On'</span><span class="keyword">]-&gt;</span><span class="default">Value </span><span class="keyword">= </span><span class="string">"name" </span><span class="keyword">;<br />
<br />
</span><span class="default">$objCommand</span><span class="keyword">-&gt;</span><span class="default">CommandText </span><span class="keyword">= </span><span class="default">$Cmd </span><span class="keyword">;<br />
</span><span class="default">$objRecordSet </span><span class="keyword">= </span><span class="default">$objCommand</span><span class="keyword">-&gt;</span><span class="default">Execute</span><span class="keyword">() ;<br />
<br />
</span><span class="default">$OrderNumber </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">;<br />
while(!</span><span class="default">$objRecordSet</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">())<br />
&nbsp;{<br />
&nbsp; </span><span class="default">$OrderNumber </span><span class="keyword">++ ;<br />
&nbsp; </span><span class="default">$nn </span><span class="keyword">= </span><span class="default">$objRecordSet</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]-&gt;</span><span class="default">Value </span><span class="keyword">;<br />
&nbsp; </span><span class="default">$mm </span><span class="keyword">= </span><span class="default">$objRecordSet</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'mail'</span><span class="keyword">]-&gt;</span><span class="default">Value </span><span class="keyword">;<br />
&nbsp; </span><span class="default">$ph </span><span class="keyword">= </span><span class="default">$objRecordSet</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'telephoneNumber'</span><span class="keyword">]-&gt;</span><span class="default">Value </span><span class="keyword">;<br />
&nbsp; echo </span><span class="string">"</span><span class="default">$OrderNumber</span><span class="string">: </span><span class="default">$nn</span><span class="string"> mail: </span><span class="default">$mm</span><span class="string"> phone: </span><span class="default">$ph</span><span class="string">&lt;br&gt;" </span><span class="keyword">;<br />
&nbsp; </span><span class="default">$objRecordSet</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">() ;<br />
&nbsp;}<br />
<br />
Echo </span><span class="string">"===========================&lt;br&gt;" </span><span class="keyword">;<br />
Echo </span><span class="string">"All MailBoxes: " </span><span class="keyword">;<br />
Echo </span><span class="default">$objRecordSet</span><span class="keyword">-&gt;</span><span class="default">RecordCount</span><span class="keyword">() ;<br />
</span><span class="default">$objRecordSet</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">() ;<br />
</span><span class="default">$objCommand</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">() ;<br />
</span><span class="default">$objConnection</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">() ;<br />
<br />
unset(</span><span class="default">$objRecordSet</span><span class="keyword">) ;<br />
unset(</span><span class="default">$objCommand</span><span class="keyword">) ;<br />
unset(</span><span class="default">$objConnection</span><span class="keyword">) ;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38287""></a>
  <div class="note">
   <strong class="user">kleontiv -at- combellga -dot- ru</strong>
   <a href="#38287" class="date">15-Dec-2003 06:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I think some one wants to access to Microsoft Active Directory using ADSI with different credential by PHP. You can also do it via pure LDAP but using ADSI it is more simpler.<br />
<br />
On VB, VBS or ASP you can do like folowing (so not trivial):<br />
<br />
&lt;%<br />
Set dso = GetObject("LDAP:")<br />
<br />
Set DsObj = dso.OpenDSObject( _<br />
&nbsp;&nbsp;&nbsp; "LDAP://DC=mydomain,DC=com", _<br />
&nbsp;&nbsp;&nbsp; "DOMAIN\login", _<br />
&nbsp;&nbsp;&nbsp; "password", _<br />
&nbsp;&nbsp;&nbsp; ADS_SECURE_AUTHENTICATION + ADS_SERVER_BIND + ADS_USE_ENCRYPTION)<br />
<br />
for each Obj in DsObj<br />
&nbsp;&nbsp;&nbsp; Response.Write Obj.name &amp; " with class of: " &amp; Obj.class &amp; "&lt;br&gt;"<br />
next<br />
%&gt;<br />
<br />
On PHP you can do like that:<br />
<br />
<span class="default">&lt;?php<br />
$ADSI </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"LDAP:"</span><span class="keyword">) ;<br />
<br />
</span><span class="default">$DsObj </span><span class="keyword">= </span><span class="default">$ADSI</span><span class="keyword">-&gt;</span><span class="default">OpenDsObject</span><span class="keyword">(</span><span class="string">"LDAP://DC=mydomain,DC=com"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"DOMAIN\login"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"password"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">515</span><span class="keyword">) ;<br />
<br />
while(</span><span class="default">$Obj </span><span class="keyword">= </span><span class="default">$DsObj</span><span class="keyword">-&gt;</span><span class="default">Next</span><span class="keyword">())<br />
&nbsp;{<br />
&nbsp; echo </span><span class="default">$Obj</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">.</span><span class="string">' with class of: '</span><span class="keyword">.</span><span class="default">$Obj</span><span class="keyword">-&gt;</span><span class="default">class</span><span class="keyword">.</span><span class="string">'&lt;br&gt;' </span><span class="keyword">;<br />
&nbsp;}<br />
</span><span class="default">?&gt;<br />
</span><br />
The access type enumeration you can use as ADS_AUTHENTICATION_ENUM.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38063""></a>
  <div class="note">
   <strong class="user">david at wu-man dot com</strong>
   <a href="#38063" class="date">06-Dec-2003 11:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After many hours of trial and error, I have finally discovered how to kill the notorious Word process.&nbsp; I hope my solution works for everyone else.
<br />

<br />
#1) $word-&gt;Quit() is perfectly fine.&nbsp; Don't bother feeding in as parameter those empty variants.
<br />

<br />
#2) Do NOT have com_load_typelib('Word.Application') anywhere in your script.
<br />

<br />
#3) Make sure you have the following line before $word-&gt;Quit() :
<br />

<br />
$word-&gt;Documents[1]-&gt;Close(false);
<br />

<br />
#4) Add the following lines after $word-&gt;Quit() :
<br />

<br />
<span class="default">&lt;?php
<br />
$word</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();
<br />
</span><span class="default">$word </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
unset(</span><span class="default">$word</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
If my solution indeed helped you with your problem, please email me and let me know.&nbsp; I would like to see if the problem was indeed solved.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37981""></a>
  <div class="note">
   <strong class="user">alanraycom at el hogar dot net com</strong>
   <a href="#37981" class="date">04-Dec-2003 12:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
XSLT transformations using MSXML can be done with this code
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">xsltransform1</span><span class="keyword">(</span><span class="default">$xslpath</span><span class="keyword">,</span><span class="default">$xmlstring</span><span class="keyword">)
<br />
&nbsp;{
<br />
&nbsp; </span><span class="default">$xml</span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Microsoft.XMLDOM"</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">async</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">;
<br />
&nbsp; </span><span class="comment">// $xmlstring is an xml string
<br />
&nbsp; </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">load</span><span class="keyword">(</span><span class="default">$xmlstring</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$xsl </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Microsoft.XMLDOM"</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$xsl</span><span class="keyword">-&gt;</span><span class="default">async</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">;
<br />
&nbsp; </span><span class="comment">// $xslpath is path to an xsl file
<br />
&nbsp; </span><span class="default">$xsl</span><span class="keyword">-&gt;</span><span class="default">load</span><span class="keyword">(</span><span class="default">$xslpath</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$response</span><span class="keyword">=</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">transformNode</span><span class="keyword">(</span><span class="default">$xsl</span><span class="keyword">);
<br />
&nbsp; unset(</span><span class="default">$xml</span><span class="keyword">);
<br />
&nbsp; unset(</span><span class="default">$xsl</span><span class="keyword">);
<br />
&nbsp; return </span><span class="default">$response</span><span class="keyword">;
<br />
&nbsp;}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
enjoy
<br />
Alan Young</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37901""></a>
  <div class="note">
   <strong class="user">chris at hitcatcher dot com</strong>
   <a href="#37901" class="date">02-Dec-2003 01:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Many COM objects don't do well when passing long (win32) filenames as function parameters.&nbsp; You can get the 8.3 name of the folder or file on *most* (some win platforms don't support it, and it can be toggled off in the registry for performance reasons) servers using the following:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//create FSO instance<br />
</span><span class="default">$exFSO </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Scripting.FileSystemObject"</span><span class="keyword">) or die (</span><span class="string">"Could not create Scripting.FileSystemObject"</span><span class="keyword">);<br />
<br />
</span><span class="comment">//set vars<br />
</span><span class="default">$myDir </span><span class="keyword">= </span><span class="string">"C:\\Program Files\\"</span><span class="keyword">;<br />
</span><span class="default">$myFile </span><span class="keyword">= </span><span class="string">"a long file name.txt"</span><span class="keyword">;<br />
<br />
</span><span class="comment">//get folder &amp; file objects<br />
</span><span class="default">$exDir </span><span class="keyword">= </span><span class="default">$exFSO</span><span class="keyword">-&gt;</span><span class="default">GetFolder</span><span class="keyword">(</span><span class="default">$myDir</span><span class="keyword">);<br />
</span><span class="default">$exFile </span><span class="keyword">= </span><span class="default">$exFSO</span><span class="keyword">-&gt;</span><span class="default">GetFile</span><span class="keyword">(</span><span class="default">$myDir </span><span class="keyword">. </span><span class="default">$myFile</span><span class="keyword">);<br />
echo </span><span class="default">$exDir</span><span class="keyword">-&gt;</span><span class="default">ShortPath</span><span class="keyword">;<br />
echo </span><span class="default">$exFile</span><span class="keyword">-&gt;</span><span class="default">ShortPath</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37700""></a>
  <div class="note">
   
   <a href="#37700" class="date">23-Nov-2003 06:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an example of reading the custom properties like Author, Keywords, etc. which are stored in MS Office and other Windows files. You must install and register dsofile as described at <a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;Q224351. The .frm file in that distribution lists most of the available properties. " rel="nofollow" target="_blank">http://support.microsoft.com/default.aspx?scid=kb;EN-US;Q224351. The .frm file in that distribution lists most of the available properties. </a>
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// the file you wish to access
<br />
</span><span class="default">$fn </span><span class="keyword">= </span><span class="string">'/docs/MFA.xls'</span><span class="keyword">;
<br />

<br />
</span><span class="default">$oFilePropReader </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'DSOleFile.PropertyReader'</span><span class="keyword">);
<br />
</span><span class="default">$props </span><span class="keyword">= </span><span class="default">$oFilePropReader</span><span class="keyword">-&gt;</span><span class="default">GetDocumentProperties</span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// one syntax
<br />
</span><span class="default">$au </span><span class="keyword">= </span><span class="default">com_get</span><span class="keyword">(</span><span class="default">$props</span><span class="keyword">, </span><span class="string">'Author'</span><span class="keyword">);
<br />
print </span><span class="string">"au: </span><span class="default">$au</span><span class="string"> \n"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">//another syntax
<br />
</span><span class="default">$str </span><span class="keyword">= </span><span class="string">'LastEditedBy'</span><span class="keyword">;
<br />
</span><span class="default">$lsb </span><span class="keyword">= </span><span class="default">$props</span><span class="keyword">-&gt;</span><span class="default">$str</span><span class="keyword">;
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$lsb</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// set a property if you wish
<br />
</span><span class="keyword">if (!</span><span class="default">$props</span><span class="keyword">-&gt;</span><span class="default">IsReadOnly</span><span class="keyword">()) {
<br />
&nbsp; </span><span class="default">$props</span><span class="keyword">-&gt;</span><span class="default">Subject </span><span class="keyword">= </span><span class="string">'tlc'</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37484""></a>
  <div class="note">
   <strong class="user">brana</strong>
   <a href="#37484" class="date">17-Nov-2003 02:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How to send email via MAPI (works with Windows NT4, apache launched as a service)
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">#New MAPI session...
<br />
</span><span class="default">$session </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"MAPI.Session"</span><span class="keyword">);
<br />

<br />
</span><span class="comment">#Login
<br />
</span><span class="default">$strProfileInfo </span><span class="keyword">= </span><span class="string">"exchange_server" </span><span class="keyword">. </span><span class="default">chr</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">) . </span><span class="string">"exchange_user"</span><span class="keyword">;
<br />
</span><span class="default">$session</span><span class="keyword">-&gt;</span><span class="default">Logon</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">$strProfileInfo</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
</span><span class="comment"># New message...
<br />
</span><span class="default">$msg </span><span class="keyword">= </span><span class="default">$session</span><span class="keyword">-&gt;</span><span class="default">Outbox</span><span class="keyword">-&gt;</span><span class="default">Messages</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">();
<br />
</span><span class="default">$msg</span><span class="keyword">-&gt;</span><span class="default">Subject </span><span class="keyword">= </span><span class="string">"Subject"</span><span class="keyword">;
<br />
</span><span class="default">$msg</span><span class="keyword">-&gt;</span><span class="default">Text </span><span class="keyword">= </span><span class="string">"body"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
</span><span class="comment">#set recipients...
<br />
</span><span class="default">$rcpts </span><span class="keyword">= </span><span class="default">$msg</span><span class="keyword">-&gt;</span><span class="default">Recipients</span><span class="keyword">;
<br />
</span><span class="default">$rcpts</span><span class="keyword">-&gt;</span><span class="default">AddMultiple</span><span class="keyword">(</span><span class="string">"toto@toto.com"</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);&nbsp;&nbsp; </span><span class="comment">#To...
<br />
</span><span class="default">$rcpts</span><span class="keyword">-&gt;</span><span class="default">AddMultiple</span><span class="keyword">(</span><span class="string">"titi@titi.com"</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);&nbsp;&nbsp; </span><span class="comment">#Cc...
<br />
</span><span class="default">$rcpts</span><span class="keyword">-&gt;</span><span class="default">AddMultiple</span><span class="keyword">(</span><span class="string">"tutu@tutu.com"</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);&nbsp;&nbsp; </span><span class="comment">#Bcc...
<br />

<br />
# Resolve senders
<br />
</span><span class="default">$rcpts</span><span class="keyword">-&gt;</span><span class="default">Resolve</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
</span><span class="comment">#Send message
<br />
</span><span class="default">$msg</span><span class="keyword">-&gt;</span><span class="default">Send</span><span class="keyword">();&nbsp; &nbsp; 
<br />

<br />
</span><span class="comment">#Logoff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br />
</span><span class="default">$session</span><span class="keyword">-&gt;</span><span class="default">Logoff</span><span class="keyword">();&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
</span><span class="comment">#Cleanup
<br />
</span><span class="keyword">if(</span><span class="default">$msg</span><span class="keyword">!=</span><span class="default">null</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$msg</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$msg </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
}&nbsp; &nbsp; &nbsp; &nbsp; 
<br />
if(</span><span class="default">$session</span><span class="keyword">!=</span><span class="default">null</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$session</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$session </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
}&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
ps : NT account launching the service and exchange user must match !</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36289""></a>
  <div class="note">
   
   <a href="#36289" class="date">03-Oct-2003 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Convert Microsoft word document .DOC to adobe acrobat .PS or .PDF files:
<br />

<br />
Drawback: if any dialog boxes pop up, the conversion will become non-automated.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// You must have word and adobe acrobat distiller on 
<br />
// your system, although theoretically any printer driver 
<br />
// that makes .PS files would work.
<br />

<br />
// starting word
<br />
</span><span class="default">$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instanciate Word"</span><span class="keyword">);
<br />
print </span><span class="string">"Loaded Word, version </span><span class="keyword">{</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="keyword">}</span><span class="string">\n"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// bring it to front
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// Select the acrobat distiller as the active printer.
<br />
// I presume that you could also use the Acrobat PDF writer // driver that comes with Acrobat full version.
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActivePrinter </span><span class="keyword">= </span><span class="string">"Acrobat Distiller"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// Open a word document, or anything else that word
<br />
// can read
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// This will create a .PS file called $output
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">PrintOut</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$output</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// If you need a .pdf instead, use the acrobat 
<br />
// distiller's watched folder option.
<br />

<br />
// closing word
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();
<br />

<br />
</span><span class="comment">// free the object
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();
<br />
</span><span class="default">$word </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36118""></a>
  <div class="note">
   <strong class="user">court shrock</strong>
   <a href="#36118" class="date">26-Sep-2003 02:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
took me a while until I found out how to loop through COM objects in PHP.... in ASP, you use something like:<br />
<br />
&lt;%<br />
set domainObject = GetObject("WinNT://Domain")<br />
<br />
for each obj in domainObject<br />
&nbsp; Response.write obj.Name &amp; "&lt;br&gt;"<br />
next<br />
<br />
%&gt;<br />
<br />
I finally found a note in a PHP bogus bug report that said you needed to do something like this (this is using ADSI):<br />
<br />
<span class="default">&lt;?php<br />
$adsi </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WinNT://Domain"</span><span class="keyword">);<br />
<br />
while(</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">$adsi</span><span class="keyword">-&gt;</span><span class="default">Next</span><span class="keyword">()) {<br />
&nbsp; echo </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">.</span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
}</span><span class="comment">// while<br />
<br />
// will list all the names of all objects in the domain 'Domain'<br />
</span><span class="default">?&gt;<br />
</span><br />
Also, you can access the IIS metabase by doing something like the following:<br />
<br />
<span class="default">&lt;?php<br />
$iis </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"IIS://localhost/w3svc"</span><span class="keyword">);<br />
<br />
while(</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">$iis</span><span class="keyword">-&gt;</span><span class="default">Next</span><span class="keyword">()) {<br />
&nbsp; if (</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">Class </span><span class="keyword">== </span><span class="string">'IISWebServer'</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$site </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"IIS://Localhost/w3svc/"</span><span class="keyword">.</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'serviceID ('</span><span class="keyword">.</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">.</span><span class="string">'): '</span><span class="keyword">.</span><span class="default">$site</span><span class="keyword">-&gt;</span><span class="default">ServerComment</span><span class="keyword">.</span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bindings </span><span class="keyword">= </span><span class="default">$site</span><span class="keyword">-&gt;</span><span class="default">ServerBindings</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;ul&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$bindings </span><span class="keyword">as </span><span class="default">$binding</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; list(</span><span class="default">$ip</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">, </span><span class="default">$hostHeader</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">, </span><span class="default">$binding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;li&gt;</span><span class="default">$ip</span><span class="string">:</span><span class="default">$port</span><span class="string"> -- </span><span class="default">$hostHeader</span><span class="string">&lt;/li&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }</span><span class="comment">// foreach<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'&lt;/ul&gt;'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// hint: ssl bindings are in $site-&gt;SecureBindings<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$site</span><span class="keyword">);<br />
<br />
&nbsp; }</span><span class="comment">// if<br />
&nbsp; <br />
</span><span class="keyword">}</span><span class="comment">// while<br />
</span><span class="keyword">unset(</span><span class="default">$iis</span><span class="keyword">);<br />
<br />
</span><span class="comment">// will list all the sites and their bindings on 'localhost'<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35580""></a>
  <div class="note">
   <strong class="user">php at dictim dot com</strong>
   <a href="#35580" class="date">06-Sep-2003 10:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This took me days to work out how to do so I gotta share it:
<br />

<br />
How to get the word count from a MS Word Document:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">#Instantiate the Word component.
<br />

<br />
</span><span class="default">$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instantiate Word"</span><span class="keyword">); 
<br />

<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; 
<br />

<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"c:/anydocument.doc"</span><span class="keyword">);
<br />
</span><span class="default">$temp </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Dialogs</span><span class="keyword">-&gt;</span><span class="default">Item</span><span class="keyword">(</span><span class="default">228</span><span class="keyword">);
<br />
</span><span class="default">$temp</span><span class="keyword">-&gt;</span><span class="default">Execute</span><span class="keyword">();
<br />
</span><span class="default">$numwords </span><span class="keyword">= </span><span class="default">$temp</span><span class="keyword">-&gt;</span><span class="default">Words</span><span class="keyword">();
<br />

<br />
echo </span><span class="default">$numwords</span><span class="keyword">;
<br />

<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">(); 
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Note that this is the only way to get the word count accurately:
<br />
$word-&gt;ActiveDocument-&gt;Words-&gt;Count;
<br />
Will see all carriage returns and punctuation as words so is wildy innaccurate.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33954""></a>
  <div class="note">
   <strong class="user">seidenberg at cf-mail dot net</strong>
   <a href="#33954" class="date">12-Jul-2003 12:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
open PDF Documents with Internet Explorer
<br />

<br />
<span class="default">&lt;?php
<br />
$browser </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"InternetExplorer.Application"</span><span class="keyword">);
<br />
</span><span class="default">$browser</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br />
</span><span class="default">$browser</span><span class="keyword">-&gt;</span><span class="default">Navigate</span><span class="keyword">(</span><span class="string">"path_to_your_pdf_document"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
this works for me with php-gtk</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33082""></a>
  <div class="note">
   <strong class="user">tomas dot pacl at atlas dot cz</strong>
   <a href="#33082" class="date">16-Jun-2003 03:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Passing parameters by reference in PHP 4.3.2 (and in a future releases of PHP )
<br />

<br />
In PHP 4.3.2 allow_call_time_pass_reference option is set to "Off" by default and future versions may not support this option any longer.
<br />
Some COM functions has by-reference parameters. VARIANT object must be used to call this functions, but it would be passed without an '&amp;' before variable name.
<br />

<br />
Example:
<br />

<br />
<span class="default">&lt;?php
<br />
$myStringVariant </span><span class="keyword">= new </span><span class="default">VARIANT</span><span class="keyword">(</span><span class="string">"over-write me"</span><span class="keyword">, </span><span class="default">VT_BSTR</span><span class="keyword">);
<br />

<br />
</span><span class="comment">/* works */
<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">$comobj</span><span class="keyword">-&gt;</span><span class="default">DoSomethingTo</span><span class="keyword">(</span><span class="default">$myStringVariant </span><span class="keyword">);
<br />

<br />
</span><span class="comment">/* works only with allow_call_time_pass_reference option set to "On" and may not work in a future release of PHP */
<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">$comobj</span><span class="keyword">-&gt;</span><span class="default">DoSomethingTo</span><span class="keyword">(&amp;</span><span class="default">$myStringVariant </span><span class="keyword">);
<br />

<br />
</span><span class="comment">/* The value in the variant can be retrieved by: */
<br />
</span><span class="default">$theActualValue </span><span class="keyword">= </span><span class="default">$myStringVariant</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30582""></a>
  <div class="note">
   <strong class="user">php at racinghippo dot co dot uk</strong>
   <a href="#30582" class="date">23-Mar-2003 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PASSING/RETURNING PARAMETERS BY REFERENCE<br />
=========================================<br />
<br />
Some COM functions not only return values through the return value, but also act upon a variable passed to it as a parameter *By Reference*:<br />
<br />
RetVal = DoSomethingTo (myVariable)<br />
<br />
Simply sticking an '&amp;' in front of myVariable doesn't work - you need to pass it a variant of the correct type, as follows:<br />
<br />
&nbsp; $myStringVariant = new VARIANT("over-write me", VT_BSTR);<br />
&nbsp; $result = $comobj-&gt;DoSomethingTo( &amp;$myStringVariant );<br />
<br />
The value in the variant can then be retrieved by:<br />
<br />
&nbsp; $theActualValue = $myStringVariant-&gt;value;<br />
<br />
Other types of variant can be created as your needs demand - see the preceding section on the VARIANT type.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30044""></a>
  <div class="note">
   <strong class="user">alex at domini dot net</strong>
   <a href="#30044" class="date">05-Mar-2003 11:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To manage the Windows Register at HKEY_LOCAL_MACHINE\SOFTWARE\ use these functions:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* @return string<br />
&nbsp;* @param aplicacio string<br />
&nbsp;* @param nom string<br />
&nbsp;* @desc Retorna el valor del registre HKEY_LOCAL_MACHINE\SOFTWARE\aplicacio\nom<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">rtv_registre</span><span class="keyword">(</span><span class="default">$aplicacio</span><span class="keyword">, </span><span class="default">$nom</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; Global </span><span class="default">$WshShell</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$registre </span><span class="keyword">=&nbsp; </span><span class="string">"HKEY_LOCAL_MACHINE\SOFTWARE\\" </span><span class="keyword">. </span><span class="default">$aplicacio </span><span class="keyword">. </span><span class="string">"\\"&nbsp; </span><span class="keyword">. </span><span class="default">$nom</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$valor </span><span class="keyword">= </span><span class="default">$WshShell</span><span class="keyword">-&gt;</span><span class="default">RegRead</span><span class="keyword">(</span><span class="default">$registre</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return(</span><span class="default">$valor</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* @return string<br />
&nbsp;* @param aplicacio string<br />
&nbsp;* @param nom string<br />
&nbsp;* @param valor string<br />
&nbsp;* @param tipus string<br />
&nbsp;* @desc Actualitza el valor del registre HKEY_LOCAL_MACHINE\SOFTWARE\aplicacio\nom<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">put_registre</span><span class="keyword">(</span><span class="default">$aplicacio</span><span class="keyword">, </span><span class="default">$nom</span><span class="keyword">, </span><span class="default">$valor</span><span class="keyword">, </span><span class="default">$tipus</span><span class="keyword">=</span><span class="string">"REG_SZ"</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; Global </span><span class="default">$WshShell</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$registre </span><span class="keyword">=&nbsp; </span><span class="string">"HKEY_LOCAL_MACHINE\SOFTWARE\\" </span><span class="keyword">. </span><span class="default">$aplicacio </span><span class="keyword">. </span><span class="string">"\\"&nbsp; </span><span class="keyword">. </span><span class="default">$nom</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$retorn </span><span class="keyword">= </span><span class="default">$WshShell</span><span class="keyword">-&gt;</span><span class="default">RegWrite</span><span class="keyword">(</span><span class="default">$registre</span><span class="keyword">, </span><span class="default">$valor</span><span class="keyword">, </span><span class="default">$tipus</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return(</span><span class="default">$retorn</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
</span><span class="comment">//<br />
// Creem una inst?ncia del COM que ens serveix per<br />
// accedir al registre de Windows, i la mantenim.<br />
// D'aquesta manera millorem el rendiment.<br />
</span><span class="default">$WshShell </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WScript.Shell"</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29831""></a>
  <div class="note">
   <strong class="user">richard dot quadling at carval dot co dot uk</strong>
   <a href="#29831" class="date">26-Feb-2003 02:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With thanks to Harald Radi and Wez Furlong.<br />
<br />
Some VBA functions have optional parameters. Sometimes the parameters you want to pass are not consecutive.<br />
<br />
e.g.<br />
<br />
GoTo What:=wdGoToBookmark, Name="BookMarkName"<br />
GoTo(wdGoToBookmark,,,"BookMarkName)<br />
<br />
In PHP, the "blank" parameters need to be empty.<br />
<br />
Which is ...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Some servers may have an auto timeout, so take as long as you want.<br />
</span><span class="default">set_time_limit</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Show all errors, warnings and notices whilst developing.<br />
</span><span class="default">error_reporting</span><span class="keyword">(</span><span class="default">E_ALL</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Used as a placeholder in certain COM functions where no parameter is required.<br />
</span><span class="default">$empty </span><span class="keyword">= new </span><span class="default">VARIANT</span><span class="keyword">();<br />
<br />
</span><span class="comment">// Load the appropriate type library.<br />
</span><span class="default">com_load_typelib</span><span class="keyword">(</span><span class="string">'Word.Application'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Create an object to use.<br />
</span><span class="default">$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'word.application'</span><span class="keyword">) or die(</span><span class="string">'Unable to load Word'</span><span class="keyword">);<br />
print </span><span class="string">"Loaded Word, version </span><span class="keyword">{</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="keyword">}</span><span class="string">\n"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Open a new document with bookmarks of YourName and YourAge.<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">'C:/Unfilled.DOC'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Fill in the information from the form.<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">GoTo</span><span class="keyword">(</span><span class="default">wdGoToBookmark</span><span class="keyword">,</span><span class="default">$empty</span><span class="keyword">,</span><span class="default">$empty</span><span class="keyword">,</span><span class="string">'YourName'</span><span class="keyword">); </span><span class="comment">// Note use of wdGoToBookmark, from the typelibrary and the use of $empty.<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">TypeText</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'YourName'</span><span class="keyword">]);<br />
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">GoTo</span><span class="keyword">(</span><span class="default">wdGoToBookmark</span><span class="keyword">,</span><span class="default">$empty</span><span class="keyword">,</span><span class="default">$empty</span><span class="keyword">,</span><span class="string">'YourAge'</span><span class="keyword">);<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Selection</span><span class="keyword">-&gt;</span><span class="default">TypeText</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'YourAge'</span><span class="keyword">]);<br />
<br />
</span><span class="comment">// Save it, close word and finish.<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="string">"C:/</span><span class="keyword">{</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'YourName'</span><span class="keyword">]}</span><span class="string">.doc"</span><span class="keyword">);<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();<br />
</span><span class="default">$word </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
print </span><span class="string">"Word closed.\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
The example document is ...<br />
<br />
Hello [Bookmark of YourName], you are [Bookmark of YourAge] years old.<br />
<br />
and it would be called ...<br />
<br />
word.php?YourName=Richard%20Quadling&amp;YourAge=35<br />
<br />
Regards,<br />
<br />
Richard.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27574""></a>
  <div class="note">
   <strong class="user">pchason at juno dot com</strong>
   <a href="#27574" class="date">11-Dec-2002 08:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Searched for days on how to set up a multi-column html output grid that didn't use an array when creating an ADODB connection. Couldn't find one so I figured it out myself. Pretty simple. Wish I would have tried it myself sooner. Commented code with database connection is below...<br />
<br />
&lt;html&gt;<br />
&lt;body&gt;<br />
&lt;table&gt;<br />
<span class="default">&lt;?php <br />
</span><span class="comment">//create the database connection<br />
</span><span class="default">$conn </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">); <br />
</span><span class="default">$dsn </span><span class="keyword">= </span><span class="string">"DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=" </span><span class="keyword">. </span><span class="default">realpath</span><span class="keyword">(</span><span class="string">"mydb.mdb"</span><span class="keyword">); <br />
</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$dsn</span><span class="keyword">); <br />
</span><span class="comment">//pull the data through SQL string<br />
</span><span class="default">$rs </span><span class="keyword">= </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Execute</span><span class="keyword">(</span><span class="string">"select clients from web"</span><span class="keyword">); <br />
</span><span class="default">$clients </span><span class="keyword">= </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">); <br />
</span><span class="comment">//start the multicolumn data output<br />
</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
</span><span class="default">$columns </span><span class="keyword">= </span><span class="default">5</span><span class="keyword">; <br />
while (!</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">){<br />
</span><span class="comment">//if $i equals 0, start a row<br />
</span><span class="keyword">if(</span><span class="default">$i </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">){ <br />
echo </span><span class="string">"&lt;tr&gt;"</span><span class="keyword">; <br />
}<br />
</span><span class="comment">//then start writing the cells in the row, increase $i by one, and move to the next record<br />
</span><span class="keyword">echo </span><span class="string">"&lt;td&gt;" </span><span class="keyword">. </span><span class="default">$clients</span><span class="keyword">-&gt;</span><span class="default">value </span><span class="keyword">. </span><span class="string">"&lt;/td&gt;"</span><span class="keyword">; <br />
</span><span class="default">$i</span><span class="keyword">++;<br />
</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">movenext</span><span class="keyword">();<br />
</span><span class="comment">//once $i increments to equal $columns, end the row, <br />
//and start the process over by setting $i to 0 <br />
</span><span class="keyword">if(</span><span class="default">$i </span><span class="keyword">== </span><span class="default">$columns </span><span class="keyword">|| </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">) { <br />
echo </span><span class="string">"&lt;/tr&gt;"</span><span class="keyword">;<br />
</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } <br />
}<br />
</span><span class="comment">//end multicolumn data output<br />
<br />
//close the ADO connections and release resources<br />
</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">(); <br />
</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">(); <br />
</span><span class="default">$rs </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">; <br />
</span><span class="default">$conn </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">; </span><span class="default">?&gt;</span> <br />
&lt;/table&gt;<br />
&lt;/body&gt;<br />
&lt;/html&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25521""></a>
  <div class="note">
   <strong class="user">tedknightusa at hotmail dot com</strong>
   <a href="#25521" class="date">26-Sep-2002 06:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A Notes example:
<br />

<br />
<span class="default">&lt;?php
<br />
$session </span><span class="keyword">= new </span><span class="default">COM </span><span class="string">"Lotus.NotesSession" </span><span class="keyword">);
<br />
</span><span class="default">$session</span><span class="keyword">-&gt;</span><span class="default">Initialize</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">); 
<br />
&nbsp;&nbsp;&nbsp; 
<br />
</span><span class="default">$someDB </span><span class="keyword">= </span><span class="string">"C:\Lotus\Notes\Data\somedb.nsf"</span><span class="keyword">;
<br />
</span><span class="default">$db </span><span class="keyword">= </span><span class="default">$session</span><span class="keyword">-&gt;</span><span class="default">GetDatabase</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="default">$someDB</span><span class="keyword">) or die(</span><span class="string">"Cannot get someDB.nsf"</span><span class="keyword">);
<br />
</span><span class="default">$view </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">GetView</span><span class="keyword">(</span><span class="string">"some_view"</span><span class="keyword">) or die(</span><span class="string">"Some View not found"</span><span class="keyword">);
<br />

<br />
</span><span class="default">$doc </span><span class="keyword">= </span><span class="default">$view</span><span class="keyword">-&gt;</span><span class="default">GetFirstDocument</span><span class="keyword">() or die(</span><span class="string">"Unable to get Initial Some Document"</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// loop through
<br />
</span><span class="keyword">while(</span><span class="default">$doc</span><span class="keyword">){
<br />
&nbsp; </span><span class="default">$col_vals </span><span class="keyword">= </span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">ColumnValues</span><span class="keyword">();
<br />
&nbsp; echo </span><span class="default">$col_vals</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];
<br />
&nbsp; </span><span class="default">$doc </span><span class="keyword">= </span><span class="default">$view</span><span class="keyword">-&gt;</span><span class="default">GetNextDocument</span><span class="keyword">(</span><span class="default">$doc</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="24724""></a>
  <div class="note">
   <strong class="user">dwt at myrealbox dot com</strong>
   <a href="#24724" class="date">27-Aug-2002 12:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When first writing applications instancing COM objects I always faced the problem of the instanced program not terminating correctly although everything else worked fine. In fact the process had to be killed manually by using the task manager. When experimenting a bit I was able to isolate the cause for this peculiar behaviour to be illustrated by the sample code below:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">//Accessing arrays by retrieving elements via function ArrayName(Index) works, but certainly is neither efficient nor good style<br />
</span><span class="default">$excel</span><span class="keyword">=new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Excel.Application"</span><span class="keyword">);<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">sheetsinnewworkbook</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">();<br />
<br />
</span><span class="default">$book</span><span class="keyword">=</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">$sheet</span><span class="keyword">=</span><span class="default">$book</span><span class="keyword">-&gt;</span><span class="default">Worksheets</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />
<br />
</span><span class="default">$sheet</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">=</span><span class="string">"Debug-Test"</span><span class="keyword">;<br />
</span><span class="default">$book</span><span class="keyword">-&gt;</span><span class="default">saveas</span><span class="keyword">(</span><span class="string">"C:\\debug.xls"</span><span class="keyword">);<br />
<br />
</span><span class="default">$book</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br />
unset(</span><span class="default">$sheet</span><span class="keyword">);<br />
unset(</span><span class="default">$book</span><span class="keyword">);<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br />
unset(</span><span class="default">$excel</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Accessing arrays as usual (using the [] operator) works, buts leads to the application not being able to terminate by itself<br />
</span><span class="default">$excel</span><span class="keyword">=new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Excel.Application"</span><span class="keyword">);<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">sheetsinnewworkbook</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">();<br />
<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Worksheets</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Name</span><span class="keyword">=</span><span class="string">"Debug-Test"</span><span class="keyword">;<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">saveas</span><span class="keyword">(</span><span class="string">"C:\\debug.xls"</span><span class="keyword">);<br />
<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Close</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br />
</span><span class="default">$excel</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br />
unset(</span><span class="default">$excel</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The sample code performs the same action twice and each time the file is properly created. Yet for some mysterious reason the instanced excel process won't terminate once you've accessed an array the way most programmers (especially those who do a lot of oop in c++) do! Therefore until the PHP developers become aware of this problem we'll have to use the inefficient coding style illustrated in the first example.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="24549""></a>
  <div class="note">
   <strong class="user">nospam  at  bol  dot com dot br</strong>
   <a href="#24549" class="date">21-Aug-2002 12:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a sample to make a parametrized query using ADO via COM, this sample was used with Foxpro but will work's with most ADO complient databases. This was tested on IIS with WIN XP pro.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// Create the main connection
<br />
</span><span class="default">$dbc </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">)&nbsp; or die (</span><span class="string">"connection create fail"</span><span class="keyword">);
<br />
</span><span class="default">$dbc</span><span class="keyword">-&gt;</span><span class="default">Provider </span><span class="keyword">= </span><span class="string">"MSDASQL"</span><span class="keyword">;
<br />
</span><span class="default">$dbc</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"FoxDatabase"</span><span class="keyword">);
<br />
</span><span class="comment">// Creates a temporary record set
<br />
</span><span class="default">$RSet </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Recordset"</span><span class="keyword">);
<br />
</span><span class="comment">// Create one ADO command
<br />
</span><span class="default">$cm&nbsp;&nbsp; </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Command"</span><span class="keyword">);
<br />
</span><span class="default">$cm</span><span class="keyword">-&gt;</span><span class="default">Activeconnection </span><span class="keyword">= </span><span class="default">$dbc</span><span class="keyword">;
<br />
</span><span class="comment">// the ? inside values will be the parameters $par01 and $par02
<br />
</span><span class="default">$cm</span><span class="keyword">-&gt;</span><span class="default">CommandText </span><span class="keyword">=&nbsp; </span><span class="string">"Insert Into testtable ( mycharfield,mymemofield) VALUES (?,?)" </span><span class="keyword">;
<br />
</span><span class="default">$cm</span><span class="keyword">-&gt;</span><span class="default">Prepared </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;
<br />
</span><span class="comment">// Creates and append 2 parameters
<br />
</span><span class="default">$par01 </span><span class="keyword">= </span><span class="default">$cm</span><span class="keyword">-&gt;</span><span class="default">CreateParameter</span><span class="keyword">(</span><span class="string">'ppar01'</span><span class="keyword">,</span><span class="default">129</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">50</span><span class="keyword">,</span><span class="string">'ABCDEFGHIKL'</span><span class="keyword">);
<br />
</span><span class="default">$cm</span><span class="keyword">-&gt;</span><span class="default">Parameters</span><span class="keyword">-&gt;</span><span class="default">Append</span><span class="keyword">(</span><span class="default">$par01</span><span class="keyword">);
<br />
</span><span class="default">$par02 </span><span class="keyword">= </span><span class="default">$cm</span><span class="keyword">-&gt;</span><span class="default">CreateParameter</span><span class="keyword">(</span><span class="string">'ppar01'</span><span class="keyword">,</span><span class="default">129</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">50</span><span class="keyword">,</span><span class="string">'123456789012346789'</span><span class="keyword">);
<br />
</span><span class="default">$cm</span><span class="keyword">-&gt;</span><span class="default">Parameters</span><span class="keyword">-&gt;</span><span class="default">Append</span><span class="keyword">(</span><span class="default">$par02</span><span class="keyword">);
<br />
</span><span class="comment">// Call 10 times the exec comand to show 10 different queries
<br />
</span><span class="keyword">for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt;= </span><span class="default">10</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp; </span><span class="default">$par01</span><span class="keyword">-&gt;</span><span class="default">Value </span><span class="keyword">= </span><span class="string">'Count '</span><span class="keyword">.</span><span class="default">$i</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$par02</span><span class="keyword">-&gt;</span><span class="default">Value </span><span class="keyword">= </span><span class="string">'Passing here'</span><span class="keyword">.</span><span class="default">$i</span><span class="keyword">.</span><span class="string">' times'</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$RSet </span><span class="keyword">= </span><span class="default">$cm</span><span class="keyword">-&gt;</span><span class="default">Execute</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">$RSet </span><span class="keyword">= </span><span class="default">$dbc</span><span class="keyword">-&gt;</span><span class="default">Execute</span><span class="keyword">(</span><span class="string">"select * from testtable"</span><span class="keyword">);
<br />
while (!</span><span class="default">$RSet</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">){
<br />
&nbsp; echo </span><span class="default">$RSet</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">[</span><span class="string">"mycharfield"</span><span class="keyword">]-&gt;</span><span class="default">value</span><span class="keyword">.</span><span class="string">' ' </span><span class="keyword">;
<br />
&nbsp; echo </span><span class="default">$RSet</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">[</span><span class="string">"mymemofield"</span><span class="keyword">]-&gt;</span><span class="default">value </span><span class="keyword">;
<br />
&nbsp; echo </span><span class="string">'&lt;BR&gt;'</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$RSet</span><span class="keyword">-&gt;</span><span class="default">movenext</span><span class="keyword">();
<br />
}
<br />
</span><span class="default">$RSet</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">;
<br />
</span><span class="default">$dbc</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">;
<br />
</span><span class="default">$cm</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">;&nbsp; &nbsp; 
<br />
</span><span class="default">$RSet </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
</span><span class="default">$dbc </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
</span><span class="default">$cm </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20862""></a>
  <div class="note">
   <strong class="user">admin at purplerain dot org</strong>
   <a href="#20862" class="date">19-Apr-2002 01:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
an easy way to convert your file from .doc to .html
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// starting word
<br />
</span><span class="default">$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instanciate Word"</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// if you want see thw World interface the value must be '1' else '0'
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br />

<br />
</span><span class="comment">//doc file location
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"E:\\first.doc"</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//html file location&nbsp; '8' mean HTML format
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="string">"E:\\test_doc.html"</span><span class="keyword">,</span><span class="default">8</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//closing word
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();
<br />

<br />
</span><span class="comment">//free the object from the memory
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();
<br />
</span><span class="default">$word </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20383""></a>
  <div class="note">
   <strong class="user">admin at purplerain dot org</strong>
   <a href="#20383" class="date">02-Apr-2002 12:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
An easy way to send e-mail using your default Outlook account:
<br />

<br />
<span class="default">&lt;?php
<br />
$objApp </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Outlook.Application"</span><span class="keyword">);
<br />
</span><span class="default">$myItem </span><span class="keyword">= </span><span class="default">$objApp</span><span class="keyword">-&gt;</span><span class="default">CreateItem</span><span class="keyword">(</span><span class="default">olMailItem</span><span class="keyword">);
<br />
</span><span class="default">$a</span><span class="keyword">=</span><span class="default">$myItem</span><span class="keyword">-&gt;</span><span class="default">Recipients</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">(</span><span class="string">"admin@purplerain.org"</span><span class="keyword">);
<br />
</span><span class="default">$myItem</span><span class="keyword">-&gt;</span><span class="default">Subject</span><span class="keyword">=</span><span class="string">"Subject"</span><span class="keyword">;
<br />
</span><span class="default">$myItem</span><span class="keyword">-&gt;</span><span class="default">Body</span><span class="keyword">=</span><span class="string">"This is a Body Section now.....!"</span><span class="keyword">;
<br />
</span><span class="default">$myItem</span><span class="keyword">-&gt;</span><span class="default">Display</span><span class="keyword">();
<br />
</span><span class="default">$myItem</span><span class="keyword">-&gt;</span><span class="default">Send</span><span class="keyword">();
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19688""></a>
  <div class="note">
   <strong class="user">madon at cma-it dot com</strong>
   <a href="#19688" class="date">07-Mar-2002 09:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I thought this excel chart example could be useful.<br />
<br />
Note the use of Excel.application vs Excel.sheet.<br />
<br />
&lt;pre&gt;<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">print </span><span class="string">"Hi"</span><span class="keyword">;<br />
</span><span class="comment">#Instantiate the spreadsheet component.<br />
#&nbsp; &nbsp; $ex = new COM("Excel.sheet") or Die ("Did not connect");<br />
</span><span class="default">$exapp </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Excel.application"</span><span class="keyword">) or Die (</span><span class="string">"Did not connect"</span><span class="keyword">);<br />
<br />
</span><span class="comment">#Get the application name and version&nbsp; &nbsp; <br />
</span><span class="keyword">print </span><span class="string">"Application name:</span><span class="keyword">{</span><span class="default">$ex</span><span class="keyword">-&gt;</span><span class="default">Application</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">}</span><span class="string">&lt;BR&gt;" </span><span class="keyword">; <br />
print </span><span class="string">"Loaded version: </span><span class="keyword">{</span><span class="default">$ex</span><span class="keyword">-&gt;</span><span class="default">Application</span><span class="keyword">-&gt;</span><span class="default">version</span><span class="keyword">}</span><span class="string">&lt;BR&gt;"</span><span class="keyword">; <br />
<br />
</span><span class="default">$wkb</span><span class="keyword">=</span><span class="default">$exapp</span><span class="keyword">-&gt;</span><span class="default">Workbooks</span><span class="keyword">-&gt;</span><span class="default">add</span><span class="keyword">();<br />
</span><span class="comment">#$wkb = $ex-&gt;Application-&gt;ActiveWorkbook or Die ("Did not open workbook"); <br />
</span><span class="keyword">print </span><span class="string">"we opened workbook&lt;BR&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="default">$ex</span><span class="keyword">-&gt;</span><span class="default">Application</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="comment">#Make Excel visible. <br />
</span><span class="keyword">print </span><span class="string">"we made excell visible&lt;BR&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="default">$sheets </span><span class="keyword">= </span><span class="default">$wkb</span><span class="keyword">-&gt;</span><span class="default">Worksheets</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">); </span><span class="comment">#Select the sheet <br />
</span><span class="keyword">print </span><span class="string">"selected a sheet&lt;BR&gt;"</span><span class="keyword">;<br />
</span><span class="default">$sheets</span><span class="keyword">-&gt;</span><span class="default">activate</span><span class="keyword">; </span><span class="comment">#Activate it <br />
</span><span class="keyword">print </span><span class="string">"activated sheet&lt;BR&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="comment">#This is a new sheet<br />
</span><span class="default">$sheets2 </span><span class="keyword">= </span><span class="default">$wkb</span><span class="keyword">-&gt;</span><span class="default">Worksheets</span><span class="keyword">-&gt;</span><span class="default">add</span><span class="keyword">(); </span><span class="comment">#Add a sheet <br />
</span><span class="keyword">print </span><span class="string">"added a new sheet&lt;BR&gt;"</span><span class="keyword">;<br />
</span><span class="default">$sheets2</span><span class="keyword">-&gt;</span><span class="default">activate</span><span class="keyword">; </span><span class="comment">#Activate it <br />
</span><span class="keyword">print </span><span class="string">"activated sheet&lt;BR&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="default">$sheets2</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">=</span><span class="string">"Report Second page"</span><span class="keyword">;<br />
<br />
</span><span class="default">$sheets</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">=</span><span class="string">"Report First page"</span><span class="keyword">;<br />
print </span><span class="string">"We set a name to the sheet: </span><span class="default">$sheets</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="string">&lt;BR&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="comment"># fills a columns<br />
</span><span class="default">$maxi</span><span class="keyword">=</span><span class="default">20</span><span class="keyword">;<br />
for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$maxi</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cell </span><span class="keyword">= </span><span class="default">$sheets</span><span class="keyword">-&gt;</span><span class="default">Cells</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">) ; </span><span class="comment">#Select the cell (Row Column number) <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cell</span><span class="keyword">-&gt;</span><span class="default">activate</span><span class="keyword">; </span><span class="comment">#Activate the cell <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cell</span><span class="keyword">-&gt;</span><span class="default">value </span><span class="keyword">= </span><span class="default">$i</span><span class="keyword">*</span><span class="default">$i</span><span class="keyword">; </span><span class="comment">#Change it to 15000 <br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">$ch </span><span class="keyword">= </span><span class="default">$sheets</span><span class="keyword">-&gt;</span><span class="default">chartobjects</span><span class="keyword">-&gt;</span><span class="default">add</span><span class="keyword">(</span><span class="default">50</span><span class="keyword">, </span><span class="default">40</span><span class="keyword">, </span><span class="default">400</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">); </span><span class="comment"># make a chartobject<br />
<br />
</span><span class="default">$chartje </span><span class="keyword">= </span><span class="default">$ch</span><span class="keyword">-&gt;</span><span class="default">chart</span><span class="keyword">; </span><span class="comment"># place a chart in the chart object <br />
</span><span class="default">$chartje</span><span class="keyword">-&gt;</span><span class="default">activate</span><span class="keyword">; </span><span class="comment">#activate chartobject <br />
</span><span class="default">$chartje</span><span class="keyword">-&gt;</span><span class="default">ChartType</span><span class="keyword">=</span><span class="default">63</span><span class="keyword">;<br />
</span><span class="default">$selected </span><span class="keyword">= </span><span class="default">$sheets</span><span class="keyword">-&gt;</span><span class="default">range</span><span class="keyword">(</span><span class="string">"E1:E</span><span class="default">$maxi</span><span class="string">"</span><span class="keyword">); </span><span class="comment"># set the data the chart uses <br />
</span><span class="default">$chartje</span><span class="keyword">-&gt;</span><span class="default">setsourcedata</span><span class="keyword">(</span><span class="default">$selected</span><span class="keyword">); </span><span class="comment"># set the data the chart uses <br />
</span><span class="keyword">print </span><span class="string">"set the data the chart uses &lt;BR&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="default">$file_name</span><span class="keyword">=</span><span class="string">"D:/apache/Apache/htdocs/alm/tmp/final14.xls"</span><span class="keyword">;<br />
if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$file_name</span><span class="keyword">)) {</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$file_name</span><span class="keyword">);}<br />
</span><span class="comment">#$ex-&gt;Application-&gt;ActiveWorkbook-&gt;SaveAs($file_name); # saves sheet as final.xls <br />
</span><span class="default">$wkb</span><span class="keyword">-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="default">$file_name</span><span class="keyword">); </span><span class="comment"># saves sheet as final.xls <br />
</span><span class="keyword">print </span><span class="string">"saved&lt;BR&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="comment">#$ex-&gt;Application-&gt;ActiveWorkbook-&gt;Close("False");&nbsp; &nbsp; <br />
</span><span class="default">$exapp</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();<br />
unset(</span><span class="default">$exapp</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
&lt;/pre&gt;<br />
<br />
Alex Madon</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
