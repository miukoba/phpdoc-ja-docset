<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>インデックスを使用してエントリの詳細を取得する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="ziparchive.setexternalattributesname.html">≪ ZipArchive::setExternalAttributesName</a></li>
      <li style="float: right;"><a href="ziparchive.statname.html">ZipArchive::statName ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.ziparchive.html">ZipArchive</a></li>
    <li>インデックスを使用してエントリの詳細を取得する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ziparchive.statindex" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">ZipArchive::statIndex</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.2.0, PECL zip &gt;= 1.1.0)</p><p class="refpurpose"><span class="refname">ZipArchive::statIndex</span> &mdash; <span class="dc-title">インデックスを使用してエントリの詳細を取得する</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-ziparchive.statindex-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>ZipArchive::statIndex</strong></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$index</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$flags</code></span>
  ] )</div>

  <p class="para rdfs-comment">
    この関数は、インデックスを使用してエントリの詳細情報を取得します。
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-ziparchive.statindex-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">index</code></dt>

     <dd>

      <p class="para">
       エントリのインデックス。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">flags</code></dt>

     <dd>

      <p class="para">
       <strong><code>ZipArchive::FL_UNCHANGED</code></strong> を OR で連結すると、
       アーカイブ内に最初に記録された際の情報を取得します。
       変更内容は無視されます。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-ziparchive.statindex-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   エントリの詳細を含む配列を返します。失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-ziparchive.statindex-examples">
  <h3 class="title">例</h3>
    <div class="example" id="example-844">
     <p><strong>例1 エントリの情報の出力</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$zip&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">ZipArchive</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$zip</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'test.zip'</span><span style="color: #007700">);<br />if&nbsp;(</span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">TRUE</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$zip</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">statIndex</span><span style="color: #007700">(</span><span style="color: #0000BB">3</span><span style="color: #007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$zip</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">close</span><span style="color: #007700">();<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'失敗、コード:'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$res</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

      <div class="example-contents"><p>上の例の出力は、
たとえば以下のようになります。</p></div>
     <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [name] =&gt; foobar/baz
    [index] =&gt; 3
    [crc] =&gt; 499465816
    [size] =&gt; 27
    [mtime] =&gt; 1123164748
    [comp_size] =&gt; 24
    [comp_method] =&gt; 8
)
</pre></div>
     </div>

    </div>

   </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="106948""></a>
  <div class="note">
   <strong class="user">Chris Lewis</strong>
   <a href="#106948" class="date">20-Dec-2011 09:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the signed-integer CRC result is only true on 32-bit systems. 64-bit systems return correct CRCs.<br />
<br />
A safer way (as recommended by crc32() function page) might be:<br />
<br />
if ($file['crc'] &lt; 0)<br />
&nbsp;&nbsp; $file['crc'] = sprintf("%u",$file['crc']);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106528""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#106528" class="date">16-Nov-2011 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The CRC returned from this method is a signed number and so can be negative. This isn't how most CRC's are represented and so can cause problems. Another thing to know is that the standerd CRC algorithm used for zip files is CRC32b. 
<br />

<br />
So to put this together lets say that you wanted to extract the first file from a zip and then compare the original CRC with the CRC for the extracted file this is what you would need to do. (proper error checking is omitted for simplicity). 
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;$zip </span><span class="keyword">= new </span><span class="default">ZipArchive</span><span class="keyword">();
<br />

<br />
&nbsp;</span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="string">"myZip.zip"</span><span class="keyword">);
<br />

<br />
&nbsp;</span><span class="default">$stat </span><span class="keyword">= </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">statIndex</span><span class="keyword">( </span><span class="default">0 </span><span class="keyword">);
<br />

<br />
&nbsp;</span><span class="default">$name </span><span class="keyword">= </span><span class="default">$stat</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">];
<br />

<br />
&nbsp;</span><span class="default">$oldCrc </span><span class="keyword">= </span><span class="default">$stat</span><span class="keyword">[</span><span class="string">'crc'</span><span class="keyword">];
<br />

<br />
&nbsp;</span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">extractTo</span><span class="keyword">(</span><span class="string">"myPath"</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">);
<br />

<br />
&nbsp;</span><span class="default">$newCrc </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">hash_file</span><span class="keyword">(</span><span class="string">"crc32b"</span><span class="keyword">, </span><span class="string">"myPath/" </span><span class="keyword">. </span><span class="default">$name</span><span class="keyword">));
<br />

<br />
&nbsp;</span><span class="comment">// Have to test both cases as the unsigned CRC from within the zip might appear negative as a signed int. 
<br />
&nbsp;</span><span class="keyword">if(</span><span class="default">$newCrc </span><span class="keyword">!== </span><span class="default">$oldCrc </span><span class="keyword">&amp;&amp; (</span><span class="default">$oldCrc </span><span class="keyword">+ </span><span class="default">4294967296</span><span class="keyword">) !== </span><span class="default">$newCrc</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"The files don't match!"</span><span class="keyword">;
<br />
&nbsp;}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
