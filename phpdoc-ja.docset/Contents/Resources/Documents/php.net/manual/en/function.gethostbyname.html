<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>インターネットホスト名に対応するIPv4アドレスを取得する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.gethostbyaddr.html">≪ gethostbyaddr</a></li>
      <li style="float: right;"><a href="function.gethostbynamel.html">gethostbynamel ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.network.html">ネットワーク 関数</a></li>
    <li>インターネットホスト名に対応するIPv4アドレスを取得する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.gethostbyname" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">gethostbyname</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">gethostbyname</span> &mdash; <span class="dc-title">
   インターネットホスト名に対応するIPv4アドレスを取得する
  </span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.gethostbyname-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>gethostbyname</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$hostname</code></span>
   )</div>

  <p class="para rdfs-comment">
   <code class="parameter">hostname</code> で指定したインターネットホストの
   IPv4 アドレスを返します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.gethostbyname-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">hostname</code></dt>

     <dd>

      <p class="para">
       ホスト名。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.gethostbyname-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   IPv4 アドレスを返します。失敗した場合は、そのままの形の
   <code class="parameter">hostname</code> を文字列で返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.gethostbyname-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-4582">
    <p><strong>例1 単純な <span class="function"><strong>gethostbyname()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$ip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">gethostbyname</span><span style="color: #007700">(</span><span style="color: #DD0000">'www.example.com'</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$ip</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.gethostbyname-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.gethostbyaddr.html" class="function" rel="rdfs-seeAlso">gethostbyaddr()</a> - 指定した IP アドレスに対応するインターネットホスト名を取得する</span></li>
    <li class="member"><span class="function"><a href="function.gethostbynamel.html" class="function" rel="rdfs-seeAlso">gethostbynamel()</a> - 指定したインターネットホスト名に対応するIPv4アドレスのリストを取得する</span></li>
    <li class="member"><span class="function"><a href="function.inet-pton.html" class="function" rel="rdfs-seeAlso">inet_pton()</a> - 人間が読める形式の IP アドレスを、パックされた in_addr 形式に変換する</span></li>
    <li class="member"><span class="function"><a href="function.inet-ntop.html" class="function" rel="rdfs-seeAlso">inet_ntop()</a> - パックされたインターネットアドレスを、人間が読める形式に変換する</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="114249""></a>
  <div class="note">
   <strong class="user">filippusnafuka at gmail dot com</strong>
   <a href="#114249" class="date">29-Jan-2014 10:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
$mysql_hostname </span><span class="keyword">= </span><span class="string">"localhost"</span><span class="keyword">;<br />
</span><span class="default">$mysql_username</span><span class="keyword">=</span><span class="string">"root"</span><span class="keyword">;<br />
</span><span class="default">$mysql_password</span><span class="keyword">=</span><span class="string">"emma"</span><span class="keyword">; </span><span class="comment">// if it is exist in your database other wise it will be null($password="")<br />
</span><span class="default">$mysql_database</span><span class="keyword">=</span><span class="string">"try"</span><span class="keyword">;<br />
<br />
</span><span class="comment">//connects to database<br />
</span><span class="default">$db </span><span class="keyword">= </span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="default">$mysql_hostname</span><span class="keyword">, </span><span class="default">$mysql_username</span><span class="keyword">, </span><span class="default">$mysql_password</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; or die(</span><span class="string">"ther is an error in connecting with the database"</span><span class="keyword">);<br />
<br />
</span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="string">'try'</span><span class="keyword">) or die(</span><span class="string">"couldn't find database"</span><span class="keyword">);<br />
<br />
</span><span class="default">$username </span><span class="keyword">= @</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">];<br />
</span><span class="default">$password </span><span class="keyword">= @</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">];<br />
</span><span class="default">$submit&nbsp; &nbsp; &nbsp; </span><span class="keyword">= @</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'submit'</span><span class="keyword">];<br />
</span><span class="default">$encpassword </span><span class="keyword">= </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$password</span><span class="keyword">);<br />
<br />
if(</span><span class="default">$submit</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$username</span><span class="keyword">==</span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$password</span><span class="keyword">==</span><span class="default">true</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="string">'try'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$db </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="default">$mysql_hostname</span><span class="keyword">,</span><span class="default">$mysql_username</span><span class="keyword">,</span><span class="default">$mysql_password</span><span class="keyword">,</span><span class="default">$mysql_database</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//to show encrypted pass use encpassword<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"INSERT INTO table1 (id, username, password) values ('</span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">username</span><span class="keyword">]</span><span class="string">','</span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">password</span><span class="keyword">]</span><span class="string">')"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//&nbsp; &nbsp; &nbsp; &nbsp; echo ("Last inserted record has id %d\n", mysql_insert_id());<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Location: localhost\new.php"</span><span class="keyword">); </span><span class="comment">/* Redirect browser */<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; /* Make sure that code below does not get executed when we redirect. */<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">exit;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
</span><span class="comment">//38<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}else{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo (</span><span class="string">"Please enter password: "</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; }</span><span class="comment">//end of iF submit<br />
<br />
</span><span class="default">?&gt;<br />
</span>What is wrong with this code? .it does not want to post to the database</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111684""></a>
  <div class="note">
   <strong class="user">Ome Ko</strong>
   <a href="#111684" class="date">16-Mar-2013 05:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you do a gethostbyname() and there is no trailing dot after a domainname that does not resolve, this domainname will ultimately be appended to the server-FQDN by nslookup.<br />
<br />
So if you do a lookup for nonexistentdomainname.be your server may return the ip for nonexistentdomainname.be.yourhostname.com, which is the server-ip.<br />
<br />
To avoid this behaviour, just add a trailing dot to the domainname; i.e. gethostbyname('nonexistentdomainname.be.')</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107346""></a>
  <div class="note">
   <strong class="user">Emmett Brosnan</strong>
   <a href="#107346" class="date">02-Feb-2012 08:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Grabbing IPs for multiple hosts:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getAddrByHost</span><span class="keyword">(</span><span class="default">$hosts</span><span class="keyword">, </span><span class="default">$timeout </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$returnString </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp; foreach (</span><span class="default">$hosts </span><span class="keyword">as </span><span class="default">$host</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">= `</span><span class="string">nslookup -timeout=</span><span class="default">$timeout</span><span class="string"> -retry=1 </span><span class="default">$host</span><span class="keyword">`;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\nAddress: (.*)\n/'</span><span class="keyword">, </span><span class="default">$query</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$returnString </span><span class="keyword">.= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) . </span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$returnString </span><span class="keyword">.= </span><span class="default">$host </span><span class="keyword">. </span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$returnString</span><span class="keyword">;<br />
<br />
}<br />
<br />
</span><span class="default">$hostArray</span><span class="keyword">[] = </span><span class="string">'www.domain1.com'</span><span class="keyword">;<br />
</span><span class="default">$hostArray</span><span class="keyword">[] = </span><span class="string">'www.domain2.com'</span><span class="keyword">;<br />
</span><span class="comment">//$hostArray[] = 'www.domain3.com';<br />
//$hostArray[] = 'www.domain4.com';<br />
<br />
</span><span class="default">$returnString </span><span class="keyword">= </span><span class="default">getAddrByHost</span><span class="keyword">(</span><span class="default">$hostArray</span><span class="keyword">);<br />
echo </span><span class="default">$returnString</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104944""></a>
  <div class="note">
   <strong class="user">Alexandre (d)</strong>
   <a href="#104944" class="date">18-Jul-2011 06:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Important note: You should avoid its use in production.<br />
<br />
DNS Resolution may take from 0.5 to 4 seconds, and during this time your script is NOT being executed.<br />
<br />
Your customers may think that the server is slow, but actually it is just waiting for the DNS resolution response.<br />
<br />
You can use it, but if you want performance, you should avoid it, or schedule it to some CRON script...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92870""></a>
  <div class="note">
   <strong class="user">nirazuelos at gmail dot com</strong>
   <a href="#92870" class="date">12-Aug-2009 05:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is the best method I've come up with to resolve any host-name to ip-address, it's quick and reliable and has support for timeout! An invalid address, a unicode string for exmaple, returns after 4~ seconds, instead of 8~ with gethostbyname! It works only with unix though.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getAddrByHost</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$timeout </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">= `</span><span class="string">nslookup -timeout=</span><span class="default">$timeout</span><span class="string"> -retry=1 </span><span class="default">$host</span><span class="keyword">`;<br />
&nbsp;&nbsp; if(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\nAddress: (.*)\n/'</span><span class="keyword">, </span><span class="default">$query</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; return </span><span class="default">$host</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83417""></a>
  <div class="note">
   <strong class="user">manalejandro at gmail dot com</strong>
   <a href="#83417" class="date">25-May-2008 05:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This logic solution to problem checking dns reverse name resolution:<br />
<br />
<span class="default">&lt;?php<br />
$ip </span><span class="keyword">= </span><span class="default">gethostbyname</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">);<br />
if(</span><span class="default">ip2long</span><span class="keyword">(</span><span class="default">$ip</span><span class="keyword">) == -</span><span class="default">1 </span><span class="keyword">|| (</span><span class="default">$ip </span><span class="keyword">== </span><span class="default">gethostbyaddr</span><span class="keyword">(</span><span class="default">$ip</span><span class="keyword">) &amp;&amp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/.*\.[a-zA-Z]{2,3}$/"</span><span class="keyword">,</span><span class="default">$host</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">) ) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Error, incorrect host or ip'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Ok'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79629""></a>
  <div class="note">
   <strong class="user">geoff at spacevs dot com</strong>
   <a href="#79629" class="date">06-Dec-2007 04:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I put this in a prepend script for all my websites to cut down the amount of abuse by automated scripts.<br />
<span class="default">&lt;?PHP<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $blacklists </span><span class="keyword">= array(</span><span class="string">'web.sorbs.net'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts&nbsp; </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ip&nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">, </span><span class="default">array_reverse</span><span class="keyword">(</span><span class="default">$parts</span><span class="keyword">)) . </span><span class="string">'.'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$blacklists </span><span class="keyword">as </span><span class="default">$bl</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$check </span><span class="keyword">= </span><span class="default">$ip </span><span class="keyword">. </span><span class="default">$bl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$check </span><span class="keyword">!= </span><span class="default">gethostbyname</span><span class="keyword">(</span><span class="default">$check</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="string">'PHP Security: [DNSBL] - ' </span><span class="keyword">. </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">] . </span><span class="string">' - ' </span><span class="keyword">. </span><span class="default">$bl</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; die(</span><span class="string">'Put a detailed error here so the client knows why they have been blocked'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77766""></a>
  <div class="note">
   <strong class="user">Florian Holzhauer</strong>
   <a href="#77766" class="date">12-Sep-2007 12:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If name resolution fails with apache2, mod_chroot and php5, add<br />
LoadFile /lib/libnss_dns.so.2<br />
to the mod_chroot config.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77668""></a>
  <div class="note">
   <strong class="user">guwapo at thedoghouse dot bz</strong>
   <a href="#77668" class="date">07-Sep-2007 05:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
referring to ralphbolton at mail2sexy dot com comment:<br />
<br />
(at least in 5.2.0 + djbdns-dnscache) gethostbyname does not really seem to cache entries. If somebody notices a speed-up after the second lookup of the same domain - that's most likely your dns-cache itself, not some php-internal dns-cache.<br />
<br />
It does cache the entries in your /etc/resolv.conf (e.g. what dns to use) so I agree with him, that stopping and starting apache, will reload the resolv.conf.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76554""></a>
  <div class="note">
   <strong class="user">von at student dot chalmers dot se</strong>
   <a href="#76554" class="date">20-Jul-2007 12:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using PHP and Apache in a chroot environment on RedHat Linux, I have found that I need to bind-mount /var/run/nscd to get this to work. Apparently, the socket in that directory is needed for all the DNS things.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70936""></a>
  <div class="note">
   <strong class="user">Josh Finlay josh at glamourcastle dot com</strong>
   <a href="#70936" class="date">05-Nov-2006 03:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
gethostbyname and gethostbynamel does not ask for AAAA records. I have written two functions to implement this. gethostbyname6 and gethostbynamel6. I don't believe this issue has been addressed yet.<br />
<br />
They are made to replace gethostbyname[l], in a way that if $try_a is true, if it fails to get AAAA records it will fall back on trying to get A records.<br />
<br />
Feel free to correct any errors, I realise that it is asking for *both* A and AAAA records, so this means two DNS calls.. probably would be more efficient if it checked $try_a before making the query, but this works for me so I'll leave that up to someone else to implement in their own work.. the tip is out there now anyway..<br />
<br />
Here is the code:<br />
<br />
&nbsp;&nbsp;&nbsp; function gethostbyname6($host, $try_a = false) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // get AAAA record for $host<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // if $try_a is true, if AAAA fails, it tries for A<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // the first match found is returned<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // otherwise returns false<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $dns = gethostbynamel6($host, $try_a);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($dns == false) { return false; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else { return $dns[0]; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function gethostbynamel6($host, $try_a = false) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // get AAAA records for $host,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // if $try_a is true, if AAAA fails, it tries for A<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // results are returned in an array of ips found matching type<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // otherwise returns false<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $dns6 = dns_get_record($host, DNS_AAAA);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($try_a == true) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $dns4 = dns_get_record($host, DNS_A);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $dns = array_merge($dns4, $dns6);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else { $dns = $dns6; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $ip6 = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $ip4 = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ($dns as $record) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($record["type"] == "A") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ip4[] = $record["ip"];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($record["type"] == "AAAA") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ip6[] = $record["ipv6"];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (count($ip6) &lt; 1) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($try_a == true) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (count($ip4) &lt; 1) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $ip4;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $ip6;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70408""></a>
  <div class="note">
   <strong class="user">chris at chollis dot net</strong>
   <a href="#70408" class="date">15-Oct-2006 07:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mmucklo raises a valid point, however the function to use would be getmxrr() in the simplest case, or alternatively checkdnsrr() if you so wish; getdnsrr() does not exist.<br />
<br />
On another note, it can be a pain (when iterating with while loops for example) that on failure gethostbyname() returns the hostname, rather than FALSE. You could wrap it in a simple user function, to "correct" this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">fixed_gethostbyname </span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Try the lookup as normal...<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ip </span><span class="keyword">= </span><span class="default">gethostbyname</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// ...but if it fails, FALSE is returned instead of the unresolved host<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$ip </span><span class="keyword">!= </span><span class="default">$host</span><span class="keyword">) { return </span><span class="default">$ip</span><span class="keyword">; } else return </span><span class="default">false</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69430""></a>
  <div class="note">
   <strong class="user">Peter &lt;toomuchphp-phpman at yahoo dot com&gt;</strong>
   <a href="#69430" class="date">06-Sep-2006 03:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One way to discover your IP address automatically:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// need to trim() because whitespace will confuse the name lookup<br />
</span><span class="default">$myIP </span><span class="keyword">= </span><span class="default">gethostbyname</span><span class="keyword">(</span><span class="default">trim</span><span class="keyword">(`</span><span class="string">hostname</span><span class="keyword">`));<br />
echo </span><span class="default">$myIP</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68941""></a>
  <div class="note">
   <strong class="user">mmucklo at yahoo dot com</strong>
   <a href="#68941" class="date">16-Aug-2006 08:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One note about using gethostbyname() for checking email address domains:<br />
<br />
If the name doesn't resolve, follow up with getdnsrr() and make sure they don't have an MX entry before returning an error.<br />
<br />
It is possible for a domain name not to have an A record, but still have an MX entry.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68744""></a>
  <div class="note">
   <strong class="user">Marc M</strong>
   <a href="#68744" class="date">09-Aug-2006 05:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a heads up. I was using this function on my site to verify email host addresses. I thought all was good, until a potential client contacted me and said they couldn't sign up correctly. They have a valid email address and domain, but this function failed. <br />
<br />
Good luck.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64070""></a>
  <div class="note">
   <strong class="user">ralphbolton at mail2sexy dot com</strong>
   <a href="#64070" class="date">06-Apr-2006 10:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On a side-note, PHP (5.0.4, but probably other versions too) can cache gethostbyname information.<br />
<br />
In short, once PHP looks up an address, it may not actually perform another lookup as you may expect. In my particular case (I think) the problem was a change to resolv.conf didn't take effect inside PHP (although nslookup/ping etc worked fine). Stop/Starting Apache fixed it (although a simple 'restart' (kill -HUP) didn't).<br />
<br />
In short, if you change resolv.conf, stop and restart Apache.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63141""></a>
  <div class="note">
   <strong class="user">ivan[DOT]pirog[AT]gmail[DOT]com</strong>
   <a href="#63141" class="date">14-Mar-2006 03:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Function returns boolean:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">isDomainResolves</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">gethostbyname</span><span class="keyword">(</span><span class="default">$domain</span><span class="keyword">) != </span><span class="default">$domain</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58017""></a>
  <div class="note">
   <strong class="user">mcgrof at gmail dot com</strong>
   <a href="#58017" class="date">21-Oct-2005 06:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Better yet:<br />
<span class="default">&lt;?php<br />
$ip </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(`</span><span class="string">/usr/bin/dig </span><span class="default">$host</span><span class="string"> A +short</span><span class="keyword">`);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58015""></a>
  <div class="note">
   <strong class="user">mcgrof at gmail dot com</strong>
   <a href="#58015" class="date">21-Oct-2005 06:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In PHP4 you can use gethostbyname() but I have found this unreliable when doing lookups on entries that return A records on the private network. PHP5 has a much better routine -- dns_get_record(). If you are stuck with PHP4 or don't want to upgrade you can use dig:<br />
<br />
<span class="default">&lt;?php<br />
$ip </span><span class="keyword">= `</span><span class="string">/usr/bin/dig </span><span class="default">$host</span><span class="string"> A +short</span><span class="keyword">`;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55932""></a>
  <div class="note">
   <strong class="user">tabascopete78 at yahoo dot com</strong>
   <a href="#55932" class="date">18-Aug-2005 09:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was using file_get_contents on a set of URLs. Some of them URLs were invalid (the structure of it was ok but the DNS hosts couldn't resolve them) and I kept getting an annoying warning. I wanted to check the DNS somehow but existing check dns function in php doesn't have one for windows and the one a person supplied there does not work 100% of the time.<br />
<br />
Instead use this function to try to resolve a host. This won't throw any warnings, you just need to check the output. You'll get the same warnings with fopen and fsockopen.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48493""></a>
  <div class="note">
   <strong class="user">cox at idecnet dot com</strong>
   <a href="#48493" class="date">26-Dec-2004 09:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For doing basic RBL (Real Time Blacklist) lookups with this function do:<br />
<br />
<span class="default">&lt;?php<br />
$host </span><span class="keyword">= </span><span class="string">'64.53.200.156'</span><span class="keyword">;<br />
</span><span class="default">$rbl&nbsp; </span><span class="keyword">= </span><span class="string">'sbl-xbl.spamhaus.org'</span><span class="keyword">;<br />
</span><span class="comment">// valid query format is: 156.200.53.64.sbl-xbl.spamhaus.org<br />
</span><span class="default">$rev </span><span class="keyword">= </span><span class="default">array_reverse</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$host</span><span class="keyword">));<br />
</span><span class="default">$lookup </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$rev</span><span class="keyword">) . </span><span class="string">'.' </span><span class="keyword">. </span><span class="default">$rbl</span><span class="keyword">;<br />
if (</span><span class="default">$lookup </span><span class="keyword">!= </span><span class="default">gethostbyname</span><span class="keyword">(</span><span class="default">$lookup</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"ip: </span><span class="default">$host</span><span class="string"> is listed in </span><span class="default">$rbl</span><span class="string">\n"</span><span class="keyword">;<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"ip: </span><span class="default">$host</span><span class="string"> NOT listed in </span><span class="default">$rbl</span><span class="string">\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Tomas V.V.Cox</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44092""></a>
  <div class="note">
   <strong class="user">Vincent</strong>
   <a href="#44092" class="date">15-Jul-2004 06:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that if you pass an IP address to gethostbyname() it will return that IP address.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41099""></a>
  <div class="note">
   
   <a href="#41099" class="date">30-Mar-2004 11:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The dns entries get cached, whether they exist or not.&nbsp; Expect really good response times after the first one.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30852""></a>
  <div class="note">
   <strong class="user">christian at SPAM at IS at DEAD at MEAT at karg dot org</strong>
   <a href="#30852" class="date">01-Apr-2003 01:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had difficulty getting gethostbyname to work under OpenBSD 3.2 and Apache, until I discovered that the default Apache chroot caused the problem.<br />
<br />
To get PHP's gethostbyname to work, you need resolv.conf (and possibly hosts) in /var/www/etc (assuming default install dirs).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22927""></a>
  <div class="note">
   <strong class="user">tonyhana at sixzeros dot com</strong>
   <a href="#22927" class="date">04-Jul-2002 04:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">//script to time DNS propagation<br />
//(Above script modified slightly to show micro time)<br />
//seems pretty damn quick to me.. I'm getting .0055 sec worstcase badhost times.<br />
<br />
//A known good dns name (my own)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nametotest </span><span class="keyword">= </span><span class="string">"fuzzygroup.com"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="comment">//Call address test function <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$time_start </span><span class="keyword">= </span><span class="default">getmicrotime</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">testipaddress</span><span class="keyword">(</span><span class="default">$nametotest</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$time_end </span><span class="keyword">= </span><span class="default">getmicrotime</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$time </span><span class="keyword">= </span><span class="default">$time_end </span><span class="keyword">- </span><span class="default">$time_start</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Good Host Search took </span><span class="default">$time</span><span class="string"> seconds&lt;br&gt;&lt;br&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="comment">//A known bad name (trust me)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nametotest </span><span class="keyword">= </span><span class="string">"providence.mascot.com"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$time_start </span><span class="keyword">= </span><span class="default">getmicrotime</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">testipaddress</span><span class="keyword">(</span><span class="default">$nametotest</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$time_end </span><span class="keyword">= </span><span class="default">getmicrotime</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$time </span><span class="keyword">= </span><span class="default">$time_end </span><span class="keyword">- </span><span class="default">$time_start</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Bad Host Search took </span><span class="default">$time</span><span class="string"> seconds&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
function </span><span class="default">getmicrotime</span><span class="keyword">(){ <br />
&nbsp;&nbsp;&nbsp; list(</span><span class="default">$usec</span><span class="keyword">, </span><span class="default">$sec</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">,</span><span class="default">microtime</span><span class="keyword">()); <br />
&nbsp;&nbsp;&nbsp; return ((float)</span><span class="default">$usec </span><span class="keyword">+ (float)</span><span class="default">$sec</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; } <br />
<br />
</span><span class="comment">//ip address checking function<br />
//for real use should have a return value but example code<br />
</span><span class="keyword">function </span><span class="default">testipaddress </span><span class="keyword">(</span><span class="default">$nametotest</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ipaddress </span><span class="keyword">= </span><span class="default">$nametotest</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ipaddress </span><span class="keyword">= </span><span class="default">gethostbyname</span><span class="keyword">(</span><span class="default">$nametotest</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$ipaddress </span><span class="keyword">== </span><span class="default">$nametotest</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"No ip address for host&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"good hostname, </span><span class="default">$nametotest</span><span class="string"> ipaddress = </span><span class="default">$ipaddress</span><span class="string">&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">//Recommended fix for sql applications: <br />
// store url to temporary table <br />
// run second process periodically to <br />
// check urls and update main table<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19953""></a>
  <div class="note">
   <strong class="user">sjohnson at fuzzygroup dot com</strong>
   <a href="#19953" class="date">16-Mar-2002 07:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">//script to see if host exists on Internet<br />
<br />
//following up on the above point about host name <br />
//checking and SQL timeouts, run this test script<br />
//and see how long it takes for 2nd call to <br />
//hostname check to fail<br />
//NOTE -- not PHP's fault -- nature of DNS <br />
<br />
//A known good dns name (my own)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nametotest </span><span class="keyword">= </span><span class="string">"fuzzygroup.com"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="comment">//Call address test function <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">testipaddress</span><span class="keyword">(</span><span class="default">$nametotest</span><span class="keyword">);<br />
<br />
</span><span class="comment">//A known bad name (trust me)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nametotest </span><span class="keyword">= </span><span class="string">"providence.mascot.com"</span><span class="keyword">;<br />
</span><span class="comment">//Call address test function<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">testipaddress</span><span class="keyword">(</span><span class="default">$nametotest</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="comment">//ip address checking function<br />
//for real use should have a return value but example code<br />
</span><span class="keyword">function </span><span class="default">testipaddress </span><span class="keyword">(</span><span class="default">$nametotest</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ipaddress </span><span class="keyword">= </span><span class="default">$nametotest</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ipaddress </span><span class="keyword">= </span><span class="default">gethostbyname</span><span class="keyword">(</span><span class="default">$nametotest</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$ipaddress </span><span class="keyword">== </span><span class="default">$nametotest</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"No ip address for host, so host "<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">"not currently available in DNS and "<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">"probably offline for some time&lt;BR&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"good hostname, ipaddress = </span><span class="default">$ipaddress</span><span class="string">&lt;BR&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">//Recommended fix for sql applications: <br />
// store url to temporary table <br />
// run second process periodically to <br />
// check urls and update main table<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
