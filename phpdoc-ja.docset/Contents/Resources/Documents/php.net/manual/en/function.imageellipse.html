<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>楕円を描画する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.imagedestroy.html">≪ imagedestroy</a></li>
      <li style="float: right;"><a href="function.imagefill.html">imagefill ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.image.html">GD および Image 関数</a></li>
    <li>楕円を描画する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.imageellipse" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imageellipse</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.6, PHP 5)</p><p class="refpurpose"><span class="refname">imageellipse</span> &mdash; <span class="dc-title">楕円を描画する</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imageellipse-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>imageellipse</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$image</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$cx</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$cy</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$width</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$height</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$color</code></span>
   )</div>

  <p class="para rdfs-comment">
   指定した座標を中心とする楕円を描画します。
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imageellipse-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>
<code class="parameter">
image</code></dt>
<dd>
<p class="para"><span class="function"><a href="function.imagecreatetruecolor.html" class="function">imagecreatetruecolor()</a></span>
のような画像作成関数が返す画像リソース。</p></dd>

    
     <dt>
<code class="parameter">cx</code></dt>

     <dd>

      <p class="para">
       中心の x 座標。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">cy</code></dt>

     <dd>

      <p class="para">
       中心の y 座標。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">width</code></dt>

     <dd>

      <p class="para">
       楕円の幅。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">height</code></dt>

     <dd>

      <p class="para">
       楕円の高さ。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">color</code></dt>

     <dd>

      <p class="para">
       楕円の色を、
       <span class="function"><a href="function.imagecolorallocate.html" class="function">imagecolorallocate()</a></span>
       で作成した画像 ID で指定します。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imageellipse-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.imageellipse-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-3316">
    <p><strong>例1 <span class="function"><strong>imageellipse()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">//&nbsp;空の画像を生成します<br /></span><span style="color: #0000BB">$image&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatetruecolor</span><span style="color: #007700">(</span><span style="color: #0000BB">400</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">300</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;背景色を選択します<br /></span><span style="color: #0000BB">$bg&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$image</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;上で選択した色で背景を塗ります<br /></span><span style="color: #0000BB">imagefill</span><span style="color: #007700">(</span><span style="color: #0000BB">$image</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$bg</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;楕円の色を選択します<br /></span><span style="color: #0000BB">$col_ellipse&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$image</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;楕円を描画します<br /></span><span style="color: #0000BB">imageellipse</span><span style="color: #007700">(</span><span style="color: #0000BB">$image</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">200</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">150</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">300</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">200</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$col_ellipse</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;画像を出力します<br /></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Content-type:&nbsp;image/png"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$image</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は、
たとえば以下のようになります。</p></div>
    <div class="mediaobject">
     
     <div class="imageobject">
      <img src="images/21009b70229598c6a80eef8b45bf282b-imageellipse.png" alt="出力例 : imageellipse()" width="400" height="300" />
     </div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 notes" id="refsect1-function.imageellipse-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    この関数は GD 2.0.2 以降を必要とします。
   </p>
  </p></blockquote>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.imageellipse-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.imagefilledellipse.html" class="function" rel="rdfs-seeAlso">imagefilledellipse()</a> - 塗りつぶされた楕円を描画する</span></li>
    <li class="member"><span class="function"><a href="function.imagearc.html" class="function" rel="rdfs-seeAlso">imagearc()</a> - 部分楕円を描画する</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="84416""></a>
  <div class="note">
   <strong class="user">themountainlion at gmail dot com</strong>
   <a href="#84416" class="date">13-Jul-2008 06:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In example #1 above, the variable $bg is set but not used. Set the background to anything but black ,and it won't take effect. The example needs <br />
<br />
imagefill($image, 0, 0, $bg);<br />
<br />
Some other image function examples have the same issue.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="67420""></a>
  <div class="note">
   <strong class="user">simon_nuttall at hotmail dot com</strong>
   <a href="#67420" class="date">07-Jun-2006 10:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an optimised and bug fixed version of nojer at yahoo dot com's rotatedellipse function. I've changed it so that the arguments are compatible with imageellipse. See notes on imagearc for original version.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">rotatedellipse</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$rotateangle</span><span class="keyword">, </span><span class="default">$colour</span><span class="keyword">, </span><span class="default">$filled</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp; </span><span class="comment">// modified here from nojer's version<br />
&nbsp; // Rotates from the three o-clock position clockwise with increasing angle.<br />
&nbsp; // Arguments are compatible with imageellipse.<br />
<br />
&nbsp; </span><span class="default">$width</span><span class="keyword">=</span><span class="default">$width</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$height</span><span class="keyword">=</span><span class="default">$height</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="comment">// This affects how coarse the ellipse is drawn.<br />
&nbsp; </span><span class="default">$step</span><span class="keyword">=</span><span class="default">3</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="default">$cosangle</span><span class="keyword">=</span><span class="default">cos</span><span class="keyword">(</span><span class="default">deg2rad</span><span class="keyword">(</span><span class="default">$rotateangle</span><span class="keyword">));<br />
&nbsp; </span><span class="default">$sinangle</span><span class="keyword">=</span><span class="default">sin</span><span class="keyword">(</span><span class="default">deg2rad</span><span class="keyword">(</span><span class="default">$rotateangle</span><span class="keyword">));<br />
<br />
&nbsp; </span><span class="comment">// $px and $py are initialised to values corresponding to $angle=0.<br />
&nbsp; </span><span class="default">$px</span><span class="keyword">=</span><span class="default">$width </span><span class="keyword">* </span><span class="default">$cosangle</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$py</span><span class="keyword">=</span><span class="default">$width </span><span class="keyword">* </span><span class="default">$sinangle</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; for (</span><span class="default">$angle</span><span class="keyword">=</span><span class="default">$step</span><span class="keyword">; </span><span class="default">$angle</span><span class="keyword">&lt;=(</span><span class="default">180</span><span class="keyword">+</span><span class="default">$step</span><span class="keyword">); </span><span class="default">$angle</span><span class="keyword">+=</span><span class="default">$step</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ox </span><span class="keyword">= </span><span class="default">$width </span><span class="keyword">* </span><span class="default">cos</span><span class="keyword">(</span><span class="default">deg2rad</span><span class="keyword">(</span><span class="default">$angle</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$oy </span><span class="keyword">= </span><span class="default">$height </span><span class="keyword">* </span><span class="default">sin</span><span class="keyword">(</span><span class="default">deg2rad</span><span class="keyword">(</span><span class="default">$angle</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= (</span><span class="default">$ox </span><span class="keyword">* </span><span class="default">$cosangle</span><span class="keyword">) - (</span><span class="default">$oy </span><span class="keyword">* </span><span class="default">$sinangle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= (</span><span class="default">$ox </span><span class="keyword">* </span><span class="default">$sinangle</span><span class="keyword">) + (</span><span class="default">$oy </span><span class="keyword">* </span><span class="default">$cosangle</span><span class="keyword">);<br />
&nbsp;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$filled</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">triangle</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">+</span><span class="default">$px</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">+</span><span class="default">$py</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">+</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">+</span><span class="default">$y</span><span class="keyword">, </span><span class="default">$colour</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">triangle</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">-</span><span class="default">$px</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">-</span><span class="default">$py</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">-</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">-</span><span class="default">$y</span><span class="keyword">, </span><span class="default">$colour</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">imageline</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">+</span><span class="default">$px</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">+</span><span class="default">$py</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">+</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">+</span><span class="default">$y</span><span class="keyword">, </span><span class="default">$colour</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">imageline</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">-</span><span class="default">$px</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">-</span><span class="default">$py</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">-</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$cy</span><span class="keyword">-</span><span class="default">$y</span><span class="keyword">, </span><span class="default">$colour</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$px</span><span class="keyword">=</span><span class="default">$x</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$py</span><span class="keyword">=</span><span class="default">$y</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
<br />
function </span><span class="default">triangle</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x1</span><span class="keyword">,</span><span class="default">$y1</span><span class="keyword">, </span><span class="default">$x2</span><span class="keyword">,</span><span class="default">$y2</span><span class="keyword">, </span><span class="default">$x3</span><span class="keyword">,</span><span class="default">$y3</span><span class="keyword">, </span><span class="default">$colour</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="default">$coords </span><span class="keyword">= array(</span><span class="default">$x1</span><span class="keyword">,</span><span class="default">$y1</span><span class="keyword">, </span><span class="default">$x2</span><span class="keyword">,</span><span class="default">$y2</span><span class="keyword">, </span><span class="default">$x3</span><span class="keyword">,</span><span class="default">$y3</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">imagefilledpolygon</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$coords</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="default">$colour</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49091""></a>
  <div class="note">
   <strong class="user">julian</strong>
   <a href="#49091" class="date">16-Jan-2005 03:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you want to display an ellipse in the upper left corner of an image, you can easily calculate the corresponding cx and cy values. this example will draw an ellipse having the same width and height as the image.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$ellipse_width </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">;<br />
</span><span class="default">$ellipse_height </span><span class="keyword">= </span><span class="default">200</span><span class="keyword">;<br />
<br />
</span><span class="default">$ellipse_cx </span><span class="keyword">= (</span><span class="default">$ellipse_width </span><span class="keyword">/ </span><span class="default">2</span><span class="keyword">);<br />
</span><span class="default">$ellipse_cy </span><span class="keyword">= (</span><span class="default">$ellipse_height </span><span class="keyword">/ </span><span class="default">2</span><span class="keyword">);<br />
<br />
</span><span class="default">$img_x </span><span class="keyword">= </span><span class="default">$ellipse_width</span><span class="keyword">;<br />
</span><span class="default">$img_y </span><span class="keyword">= </span><span class="default">$ellipse_height</span><span class="keyword">;<br />
<br />
</span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreate</span><span class="keyword">(</span><span class="default">$img_x</span><span class="keyword">, </span><span class="default">$img_y</span><span class="keyword">);<br />
</span><span class="default">$bg </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">);<br />
<br />
</span><span class="default">$ellipse_color </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
<br />
</span><span class="default">imageellipse</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$ellipse_cx</span><span class="keyword">, </span><span class="default">$ellipse_cy</span><span class="keyword">, </span><span class="default">$ellipse_width</span><span class="keyword">, </span><span class="default">$ellipse_height</span><span class="keyword">, </span><span class="default">$ellipse_color</span><span class="keyword">);<br />
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27416""></a>
  <div class="note">
   <strong class="user">agentyoungsoo at hanmail dot net</strong>
   <a href="#27416" class="date">05-Dec-2002 05:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you wana use "ImageEllipse" function <br />
in under GD 2.0.2 version, you can use "ImageArc" like bellow<br />
<br />
----------------------------------------------------<br />
$file_name = "test.png";<br />
<br />
$screen_x = 300;<br />
$screen_y = 200;<br />
<br />
$x1 = $screen_x / 2;<br />
$y1 = $screen_y / 2;<br />
<br />
$radius = 30;<br />
<br />
$image = ImageCreate($screen_x, $screen_y);<br />
$black = ImageColorAllocate($image, 0,0,0);<br />
<br />
ImageArc($image, $x1, $y1, $radius , $radius , 0, 360, $black);<br />
<br />
ImagePng($image, $file_name); <br />
ImageDestroy($image); <br />
----------------------------------------------------</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
