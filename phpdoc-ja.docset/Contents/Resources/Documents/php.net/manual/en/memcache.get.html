<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>サーバーから項目を取得する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="memcache.flush.html">≪ Memcache::flush</a></li>
      <li style="float: right;"><a href="memcache.getextendedstats.html">Memcache::getExtendedStats ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.memcache.html">Memcache</a></li>
    <li>サーバーから項目を取得する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="memcache.get" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Memcache::get</h1>
  <p class="verinfo">(PECL memcache &gt;= 0.2.0)</p><p class="refpurpose"><span class="refname">Memcache::get</span> &mdash; <span class="dc-title">サーバーから項目を取得する</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-memcache.get-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>Memcache::get</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$key</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter reference">&$flags</code></span>
  ] )</div>

  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>Memcache::get</strong></span>
    ( <span class="methodparam"><span class="type">array</span> <code class="parameter">$keys</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter reference">&$flags</code></span>
  ] )</div>

  
  <p class="para rdfs-comment">
   <span class="function"><strong>Memcache::get()</strong></span> は、その時点でサーバー上に
   <code class="parameter">key</code> というキーのデータが存在する場合に、
   格納されているデータを返します。
  </p>

  <p class="para">
   <span class="function"><strong>Memcache::get()</strong></span> にキーの配列を渡すことにより、
   値の配列を取得することができます。この配列には、サーバー上で見つかった
   キーと値のペアのみが含まれます。
  </p>
  
 </div>

  
 <div class="refsect1 parameters" id="refsect1-memcache.get-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">key</code></dt>

     <dd>

      <p class="para">
       取得したいキー (あるいはキーの配列)。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">flags</code></dt>

     <dd>

      <p class="para">
       存在した場合は、値とともに取得したフラグをここに書き込みます。
       これらのフラグは、たとえば <span class="function"><a href="memcache.set.html" class="function">Memcache::set()</a></span>
       に渡すものと同じです。int の最下位バイトは pecl/memcache
       で内部的に使用するために予約されています
       (たとえば圧縮やシリアライズに関する状態を表します)。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-memcache.get-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   <code class="parameter">key</code> に関連付けられた文字列を返します。
   <code class="parameter">key</code> が配列の場合は、
   見つかったキー・値のペアを配列で返します。
   取得に失敗したり <code class="parameter">key</code> が見つからなかったり、
   あるいは <code class="parameter">key</code> が空だったりした場合は <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-memcache.get-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-4521">
    <p><strong>例1 <span class="function"><strong>Memcache::get()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">/*&nbsp;手続き型の&nbsp;API&nbsp;*/<br /></span><span style="color: #0000BB">$memcache_obj&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">memcache_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">memcache_get</span><span style="color: #007700">(</span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'some_key'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;オブジェクト指向の&nbsp;API&nbsp;*/<br /></span><span style="color: #0000BB">$memcache_obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Memcache</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">'some_key'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;<br />キーの配列をパラメータとして使用することもできます。<br />もしキーに対応する項目がサーバー上で見つからなければ、<br />結果の配列の中にはそのキーは含まれません。<br />*/<br /><br />/*&nbsp;手続き型の&nbsp;API&nbsp;*/<br /></span><span style="color: #0000BB">$memcache_obj&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">memcache_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">memcache_get</span><span style="color: #007700">(</span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">,&nbsp;Array(</span><span style="color: #DD0000">'some_key'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'another_key'</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">/*&nbsp;オブジェクト指向の&nbsp;API&nbsp;*/<br /></span><span style="color: #0000BB">$memcache_obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Memcache</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'memcache_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$memcache_obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(Array(</span><span style="color: #DD0000">'some_key'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'second_key'</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="114227""></a>
  <div class="note">
   <strong class="user">a dot karabiowski at gmx dot net</strong>
   <a href="#114227" class="date">27-Jan-2014 06:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Signature is not correct.<br />
<br />
<span class="default">&lt;?php <br />
$memcache </span><span class="keyword">= new </span><span class="default">Memcache</span><span class="keyword">();<br />
</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">connect</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">, </span><span class="default">11211</span><span class="keyword">);<br />
class </span><span class="default">Test </span><span class="keyword">{ public </span><span class="default">$property </span><span class="keyword">= </span><span class="string">"testvalue"</span><span class="keyword">; }<br />
</span><span class="default">$test </span><span class="keyword">= new </span><span class="default">Test</span><span class="keyword">();<br />
</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="string">"asdf"</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="string">"asdf"</span><span class="keyword">));<br />
</span><span class="comment">/* will return the object, not the string:<br />
&nbsp;&nbsp;&nbsp; class Test#3 (1) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; public $property =&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; string(9) "testvalue"<br />
&nbsp;&nbsp;&nbsp; }<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112236""></a>
  <div class="note">
   <strong class="user">bijay dot rungta at gmail dot com</strong>
   <a href="#112236" class="date">21-May-2013 03:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that if you include spaces in your keys when saving Data and use array of keys to get the Data, The returned array will replace spaces with underscores in the keys. <br />
<br />
<span class="default">&lt;?php<br />
<br />
$memcache </span><span class="keyword">= new </span><span class="default">Memcache</span><span class="keyword">;<br />
</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">connect</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">);<br />
</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="string">'my-key'</span><span class="keyword">, </span><span class="string">'value1'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">300</span><span class="keyword">);<br />
</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="string">'key with space'</span><span class="keyword">, </span><span class="string">'value 2'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">300</span><span class="keyword">);<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(array(</span><span class="string">'my-key'</span><span class="keyword">, </span><span class="string">'key with space'</span><span class="keyword">))); </span><span class="comment">// Array ( [my-key] =&gt; value1 [key_with_space] =&gt; value 2 )<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Memcache replaces spaces with underscores when saving, it does so when doing a get too, but when you do a get with single key (string) you don't notice this as it merely returns the value. But when you do a get for array of keys, you would expect the same keys in the returned array but it replaces spaces by underscores in them.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112056""></a>
  <div class="note">
   <strong class="user">clover at fromru dot com</strong>
   <a href="#112056" class="date">27-Apr-2013 09:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
$flags stays untouched if $key was not found on the server, it's helpfull to determine if bool(false) was stored:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$memcache </span><span class="keyword">= new </span><span class="default">Memcache</span><span class="keyword">();<br />
<br />
</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="string">'test'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">); </span><span class="comment">// <br />
</span><span class="default">$flags </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="string">'test'</span><span class="keyword">, </span><span class="default">$flags</span><span class="keyword">)); </span><span class="comment">// bool(false)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$flags</span><span class="keyword">); </span><span class="comment">// int(256) - changed to int<br />
<br />
</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">delete</span><span class="keyword">(</span><span class="string">'test'</span><span class="keyword">);<br />
<br />
</span><span class="default">$flags </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="string">'test'</span><span class="keyword">, </span><span class="default">$flags</span><span class="keyword">)); </span><span class="comment">// bool(false)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$flags</span><span class="keyword">); </span><span class="comment">// bool(false) - untouched<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102485""></a>
  <div class="note">
   <strong class="user">Michael Brenden</strong>
   <a href="#102485" class="date">17-Feb-2011 11:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware, if there's a backslash present in the key name then the results are unpredictable and random.<br />
<br />
I was generating keys like this:<br />
<br />
$mc_key = get_called_class(). $_COOKIE['crumb'];<br />
<br />
This works fine when get_called_class() returns CLASSNAME.<br />
<br />
But then I began using namespaces, and get_class_class() of course returned NAMESPACE\CLASSNAME<br />
<br />
Well that backslash sends Memcache into quite the tizzy.<br />
No errors, mind you, just insanity.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96912""></a>
  <div class="note">
   <strong class="user">janis at unrepublic dot com</strong>
   <a href="#96912" class="date">22-Mar-2010 11:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For me it was the case that if such key doesn't exist, null is returned not false.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86351""></a>
  <div class="note">
   <strong class="user">nate</strong>
   <a href="#86351" class="date">14-Oct-2008 05:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware that when using the multi-key version, Memcache::get returns bool false if no servers are configured for the pool (and possibly if other errors occur as well while attempting to fetch). Also, Memcache class throws annoying warnings on every get/set/delete-type calls if you have no servers added to the pool.
<br />

<br />
The following snippet var_dump's bool false, not an empty array like you might expect.
<br />

<br />
<span class="default">&lt;?php
<br />
$cache </span><span class="keyword">= new </span><span class="default">Memcache</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// no $cache-&gt;addServer calls (for example,
<br />
</span><span class="default">due to temporarily disabling </span><span class="keyword">use </span><span class="default">of cache</span><span class="keyword">)
<br />

<br />
</span><span class="comment">// use @ symbol to ignore warning
<br />

<br />
</span><span class="default">var_dump</span><span class="keyword">(
<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">$cache</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(array(</span><span class="string">'one'</span><span class="keyword">, </span><span class="string">'two'</span><span class="keyword">))
<br />
);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84275""></a>
  <div class="note">
   <strong class="user">jakub dot lopuszanski at nasza-klasa dot pl</strong>
   <a href="#84275" class="date">07-Jul-2008 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If deserialization fails for some reason, that is when memcache server returned flag 1 set, but the value was not a correctly serialized PHP data,
<br />
then Memcache::get acts in a following way:
<br />

<br />
If it was called with a single key to retrieve, then a warning is raised, but since it was not actually a bug of a server, the warning says something confusing like "Memcached Server Error: null" and the function returns bool(false).
<br />

<br />
If it was called by passing an array (even with a single element in it), then the warning is not raised and the resulting array contains a value bool(false).
<br />

<br />
Since there are some buffer overrun bugs present in Memcached Server, which from time to time cause overwriting of [part of] data and therefore rendering it impossible to deserialize, make sure to check if the result of Memcache::get contains only string, or deserialized structure. If the result is bool,dobule or long, then something went wrong.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
