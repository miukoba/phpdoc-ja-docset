<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>ビット演算子</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="language.operators.assignment.html">≪ 代入演算子</a></li>
      <li style="float: right;"><a href="language.operators.comparison.html">比較演算子 ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.operators.html">演算子</a></li>
    <li>ビット演算子</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="language.operators.bitwise" class="sect1">
   <h2 class="title">ビット演算子</h2>
   <p class="simpara">
    ビット演算子は、整数値の特定のビットの評価や操作を行います。
   </p>
   <table class="doctable table">
    <caption><strong>ビット演算子</strong></caption>
    
     <thead>
      <tr>
       <th>例</th>
       <th>名前</th>
       <th>結果</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td><strong class="userinput"><code>$a &amp; $b</code></strong></td>
       <td>ビット積</td>
       <td><var class="varname"><var class="varname">$a</var></var> および <var class="varname"><var class="varname">$b</var></var> の両方にセットされているビットがセットされます</td>
      </tr>

      <tr>
       <td><strong class="userinput"><code>$a | $b</code></strong></td>
       <td>ビット和</td>
       <td><var class="varname"><var class="varname">$a</var></var> または <var class="varname"><var class="varname">$b</var></var> のどちらかにセットされているビットがセットされます</td>
      </tr>

      <tr>
       <td><strong class="userinput"><code>$a ^ $b</code></strong></td>
       <td>排他的論理和</td>
       <td><var class="varname"><var class="varname">$a</var></var> または <var class="varname"><var class="varname">$b</var></var> のどちらか一方にセットされており、両方にセットされていないビットがセットされます</td>
      </tr>

      <tr>
       <td><strong class="userinput"><code>~ $a</code></strong></td>
       <td>否定</td>
       <td><var class="varname"><var class="varname">$a</var></var> にセットされているビットはセットせず、そうでないものは逆にします</td>
      </tr>

      <tr>
       <td><strong class="userinput"><code>$a &lt;&lt; $b</code></strong></td>
       <td>左シフト</td>
       <td><var class="varname"><var class="varname">$a</var></var> のビットを左に <var class="varname"><var class="varname">$b</var></var> ビットシフトする (各シフトは &quot;2をかける&quot;
    ことを意味します)
       </td>
      </tr>

      <tr>
       <td><strong class="userinput"><code>$a &gt;&gt; $b</code></strong></td>
       <td>右シフト</td>
       <td><var class="varname"><var class="varname">$a</var></var> のビットを右に <var class="varname"><var class="varname">$b</var></var> ビットシフトします (各シフトは &quot;2で割る&quot;
    ことを意味します)
       </td>
      </tr>

     </tbody>
    
   </table>

   <p class="para">
    PHP のシフト処理は算術シフトです。両端からあふれたビットは捨てられます。
    左シフトをすると右側にはゼロが埋められます。
    符号ビットは左端からあふれて消えます。
    つまり、オペランドの符号は維持されないということです。
    右シフトの際には、符号ビットと同じ内容が左端から埋められます。
    つまり、この場合はオペランドの符号が維持されます。
   </p>
   <p class="para">
    括弧を使うことで、望みどおりの
    <a href="language.operators.precedence.html" class="link">優先順位</a>
    で処理させることができます。たとえば、<em>$a &amp; $b == true</em>
    はまず等価かどうかを評価してからビット演算を行いますが
    <em>($a &amp; $b) == true</em>
    はまずビット演算を行ってから等価かどうかを評価します。
   </p>
   <p class="para">
    <em>&amp;</em>、<em>|</em> そして
    <em>^</em> 演算子の左右のオペランドが文字列の場合、その演算は、
    文字列を構成する文字の ASCII 値を使って行います。その結果は文字列になります。
    それ以外の場合は、左右のオペランドを
    <a href="language.types.integer.html#language.types.integer.casting" class="link">integer に変換</a>
    し、結果も integer になります。
   </p>
   <p class="para">
    <em>~</em> 演算子のオペランドが文字列の場合、その演算は、
    文字列を構成する文字の ASCII 値を使って行います。その結果は文字列になります。
    それ以外の場合は、オペランドや演算結果を integer として扱います。
   </p>
   <p class="para">
    <em>&lt;&lt;</em> および
    <em>&gt;&gt;</em> 演算子のオペランドとその結果は、常に integer として扱います。
   </p>
   <p class="para">
    <div class="informalexample">
     <p class="para">
      <pre class="literallayout">
PHP の ini 設定 error_reporting はビット値を用いています。
これを用いて、特定のビットを落とす演算の例を見てみましょう。
notice 以外のすべてのエラーを表示させるには、
php.ini ファイルで
<strong class="userinput"><code>E_ALL &amp; ~E_NOTICE</code></strong>
と指定することになります。
      </pre>
     </p>
     <p class="para">
      <pre class="literallayout">
まずは E_ALL。
<span class="computeroutput">00000000000000000111011111111111</span>
そして E_NOTICE...。
<span class="computeroutput">00000000000000000000000000001000</span>
... これを <em>~</em> で逆転させます。
<span class="computeroutput">11111111111111111111111111110111</span>
最後に AND (&amp;) を使い、両方ともビットが立っているところをみつけます。
<span class="computeroutput">00000000000000000111011111110111</span>
      </pre>
     </p>
     <p class="para">
      <pre class="literallayout">
同じ結果を得るもうひとつの方法として、 XOR (<em>^</em>)
を使ってどちらか一方だけ立っているビットを探すという方法もあります。
<strong class="userinput"><code>E_ALL ^ E_NOTICE</code></strong>
      </pre>
     </p>
    </div>
   </p>
   <p class="para">
    <div class="informalexample">
     <p class="para">
      <pre class="literallayout">
error_reporting を使って、特定のビットを立てる処理の例を見てみましょう。
通常のエラーとリカバー可能なエラーだけを表示させるには、次のようにします。
<strong class="userinput"><code>E_ERROR | E_RECOVERABLE_ERROR</code></strong>
      </pre>
     </p>
     <p class="para">
      <pre class="literallayout">
この処理は、 E_ERROR
<span class="computeroutput">00000000000000000000000000000001</span>
と
<span class="computeroutput">00000000000000000001000000000000</span>
を OR (<em>|</em>) 演算子でつないで、
少なくともどちらかのビットが立っているところを取得します。
<span class="computeroutput">00000000000000000001000000000001</span>
      </pre>
     </p>
    </div>
   </p>
   <p class="para">
    <div class="example" id="example-132">
     <p><strong>例1 整数値におけるビット AND、OR および XOR 演算</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*<br />&nbsp;*&nbsp;このへんは無視してください。<br />&nbsp;*&nbsp;たんに結果をきれいに表示させるためだけのものです。<br />&nbsp;*/<br /><br /></span><span style="color: #0000BB">$format&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'(%1$2d&nbsp;=&nbsp;%1$04b)&nbsp;=&nbsp;(%2$2d&nbsp;=&nbsp;%2$04b)'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'&nbsp;%3$s&nbsp;(%4$2d&nbsp;=&nbsp;%4$04b)'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /><br />echo&nbsp;&lt;&lt;&lt;EOH<br /></span><span style="color: #DD0000">&nbsp;---------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------&nbsp;&nbsp;--&nbsp;---------<br />&nbsp;result&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op&nbsp;test<br />&nbsp;---------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------&nbsp;&nbsp;--&nbsp;---------<br /></span><span style="color: #007700">EOH;<br /><br /><br /></span><span style="color: #FF8000">/*<br />&nbsp;*&nbsp;ここからが本番<br />&nbsp;*/<br /><br /></span><span style="color: #0000BB">$values&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">8</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$test&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /><br />echo&nbsp;</span><span style="color: #DD0000">"\n&nbsp;Bitwise&nbsp;AND&nbsp;\n"</span><span style="color: #007700">;<br />foreach&nbsp;(</span><span style="color: #0000BB">$values&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">&amp;&nbsp;</span><span style="color: #0000BB">$test</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #0000BB">$format</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$test</span><span style="color: #007700">);<br />}<br /><br />echo&nbsp;</span><span style="color: #DD0000">"\n&nbsp;Bitwise&nbsp;Inclusive&nbsp;OR&nbsp;\n"</span><span style="color: #007700">;<br />foreach&nbsp;(</span><span style="color: #0000BB">$values&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">$test</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #0000BB">$format</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'|'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$test</span><span style="color: #007700">);<br />}<br /><br />echo&nbsp;</span><span style="color: #DD0000">"\n&nbsp;Bitwise&nbsp;Exclusive&nbsp;OR&nbsp;(XOR)&nbsp;\n"</span><span style="color: #007700">;<br />foreach&nbsp;(</span><span style="color: #0000BB">$values&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">^&nbsp;</span><span style="color: #0000BB">$test</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #0000BB">$format</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'^'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$test</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

     <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
     <div class="example-contents screen">
<div class="cdata"><pre>
 ---------     ---------  -- ---------
 result        value      op test
 ---------     ---------  -- ---------
 Bitwise AND
( 0 = 0000) = ( 0 = 0000) &amp; ( 5 = 0101)
( 1 = 0001) = ( 1 = 0001) &amp; ( 5 = 0101)
( 0 = 0000) = ( 2 = 0010) &amp; ( 5 = 0101)
( 4 = 0100) = ( 4 = 0100) &amp; ( 5 = 0101)
( 0 = 0000) = ( 8 = 1000) &amp; ( 5 = 0101)

 Bitwise Inclusive OR
( 5 = 0101) = ( 0 = 0000) | ( 5 = 0101)
( 5 = 0101) = ( 1 = 0001) | ( 5 = 0101)
( 7 = 0111) = ( 2 = 0010) | ( 5 = 0101)
( 5 = 0101) = ( 4 = 0100) | ( 5 = 0101)
(13 = 1101) = ( 8 = 1000) | ( 5 = 0101)

 Bitwise Exclusive OR (XOR)
( 5 = 0101) = ( 0 = 0000) ^ ( 5 = 0101)
( 4 = 0100) = ( 1 = 0001) ^ ( 5 = 0101)
( 7 = 0111) = ( 2 = 0010) ^ ( 5 = 0101)
( 1 = 0001) = ( 4 = 0100) ^ ( 5 = 0101)
(13 = 1101) = ( 8 = 1000) ^ ( 5 = 0101)
</pre></div>
     </div>
    </div>
   </p>
   <p class="para">
    <div class="example" id="example-133">
     <p><strong>例2 文字列でのビット XOR 演算</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">12&nbsp;</span><span style="color: #007700">^&nbsp;</span><span style="color: #0000BB">9</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;出力は&nbsp;'5'<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"12"&nbsp;</span><span style="color: #007700">^&nbsp;</span><span style="color: #DD0000">"9"</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;出力はバックスペース文字&nbsp;(ascii&nbsp;8)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;('1'&nbsp;(ascii&nbsp;49))&nbsp;^&nbsp;('9'&nbsp;(ascii&nbsp;57))&nbsp;=&nbsp;#8<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"hallo"&nbsp;</span><span style="color: #007700">^&nbsp;</span><span style="color: #DD0000">"hello"</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;出力は、ascii&nbsp;コード&nbsp;#0&nbsp;#4&nbsp;#0&nbsp;#0&nbsp;#0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;'a'&nbsp;^&nbsp;'e'&nbsp;=&nbsp;#4<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">2&nbsp;</span><span style="color: #007700">^&nbsp;</span><span style="color: #DD0000">"3"</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;出力は&nbsp;1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;2&nbsp;^&nbsp;((int)"3")&nbsp;==&nbsp;1<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"2"&nbsp;</span><span style="color: #007700">^&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;出力は&nbsp;1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;((int)"2")&nbsp;^&nbsp;3&nbsp;==&nbsp;1<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <p class="para">
    <div class="example" id="example-134">
     <p><strong>例3 整数値のビットシフト</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*<br />&nbsp;*&nbsp;これが例です<br />&nbsp;*/<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"\n---&nbsp;BIT&nbsp;SHIFT&nbsp;RIGHT&nbsp;ON&nbsp;POSITIVE&nbsp;INTEGERS&nbsp;---\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&gt;&gt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&gt;&gt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'copy&nbsp;of&nbsp;sign&nbsp;bit&nbsp;shifted&nbsp;into&nbsp;left&nbsp;side'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&gt;&gt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&gt;&gt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&gt;&gt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&gt;&gt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bits&nbsp;shift&nbsp;out&nbsp;right&nbsp;side'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&gt;&gt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&gt;&gt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'same&nbsp;result&nbsp;as&nbsp;above;&nbsp;can&nbsp;not&nbsp;shift&nbsp;beyond&nbsp;0'</span><span style="color: #007700">);<br /><br /><br />echo&nbsp;</span><span style="color: #DD0000">"\n---&nbsp;BIT&nbsp;SHIFT&nbsp;RIGHT&nbsp;ON&nbsp;NEGATIVE&nbsp;INTEGERS&nbsp;---\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;-</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&gt;&gt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&gt;&gt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'copy&nbsp;of&nbsp;sign&nbsp;bit&nbsp;shifted&nbsp;into&nbsp;left&nbsp;side'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;-</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&gt;&gt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&gt;&gt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bits&nbsp;shift&nbsp;out&nbsp;right&nbsp;side'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;-</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&gt;&gt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&gt;&gt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'same&nbsp;result&nbsp;as&nbsp;above;&nbsp;can&nbsp;not&nbsp;shift&nbsp;beyond&nbsp;-1'</span><span style="color: #007700">);<br /><br /><br />echo&nbsp;</span><span style="color: #DD0000">"\n---&nbsp;BIT&nbsp;SHIFT&nbsp;LEFT&nbsp;ON&nbsp;POSITIVE&nbsp;INTEGERS&nbsp;---\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&lt;&lt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&lt;&lt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'zeros&nbsp;fill&nbsp;in&nbsp;right&nbsp;side'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;(</span><span style="color: #0000BB">PHP_INT_SIZE&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">8</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&lt;&lt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&lt;&lt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;(</span><span style="color: #0000BB">PHP_INT_SIZE&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">8</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&lt;&lt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&lt;&lt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sign&nbsp;bits&nbsp;get&nbsp;shifted&nbsp;out'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;(</span><span style="color: #0000BB">PHP_INT_SIZE&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">8</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&lt;&lt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&lt;&lt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bits&nbsp;shift&nbsp;out&nbsp;left&nbsp;side'</span><span style="color: #007700">);<br /><br /><br />echo&nbsp;</span><span style="color: #DD0000">"\n---&nbsp;BIT&nbsp;SHIFT&nbsp;LEFT&nbsp;ON&nbsp;NEGATIVE&nbsp;INTEGERS&nbsp;---\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;-</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&lt;&lt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&lt;&lt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'zeros&nbsp;fill&nbsp;in&nbsp;right&nbsp;side'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;-</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;(</span><span style="color: #0000BB">PHP_INT_SIZE&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">8</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&lt;&lt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&lt;&lt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;-</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$places&nbsp;</span><span style="color: #007700">=&nbsp;(</span><span style="color: #0000BB">PHP_INT_SIZE&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">8</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">&lt;&lt;&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&lt;&lt;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bits&nbsp;shift&nbsp;out&nbsp;left&nbsp;side,&nbsp;including&nbsp;sign&nbsp;bit'</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #FF8000">/*<br />&nbsp;*&nbsp;このへんは無視してください。<br />&nbsp;*&nbsp;たんに結果をきれいに表示させるためだけのものです。<br />&nbsp;*/<br /><br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">p</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$op</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$note&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$format&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'%0'&nbsp;</span><span style="color: #007700">.&nbsp;(</span><span style="color: #0000BB">PHP_INT_SIZE&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">8</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"b\n"</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Expression:&nbsp;%d&nbsp;=&nbsp;%d&nbsp;%s&nbsp;%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$res</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$op</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$places</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&nbsp;Decimal:\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"&nbsp;&nbsp;val=%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"&nbsp;&nbsp;res=%d\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&nbsp;Binary:\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">'&nbsp;&nbsp;val='&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$format</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">'&nbsp;&nbsp;res='&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$format</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$note</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&nbsp;NOTE:&nbsp;</span><span style="color: #0000BB">$note</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

     <div class="example-contents"><p>上の例の 32 ビットマシンでの出力は、このようになります。</p></div>
     <div class="example-contents screen">
<div class="cdata"><pre>

--- BIT SHIFT RIGHT ON POSITIVE INTEGERS ---
Expression: 2 = 4 &gt;&gt; 1
 Decimal:
  val=4
  res=2
 Binary:
  val=00000000000000000000000000000100
  res=00000000000000000000000000000010
 NOTE: copy of sign bit shifted into left side

Expression: 1 = 4 &gt;&gt; 2
 Decimal:
  val=4
  res=1
 Binary:
  val=00000000000000000000000000000100
  res=00000000000000000000000000000001

Expression: 0 = 4 &gt;&gt; 3
 Decimal:
  val=4
  res=0
 Binary:
  val=00000000000000000000000000000100
  res=00000000000000000000000000000000
 NOTE: bits shift out right side

Expression: 0 = 4 &gt;&gt; 4
 Decimal:
  val=4
  res=0
 Binary:
  val=00000000000000000000000000000100
  res=00000000000000000000000000000000
 NOTE: same result as above; can not shift beyond 0


--- BIT SHIFT RIGHT ON NEGATIVE INTEGERS ---
Expression: -2 = -4 &gt;&gt; 1
 Decimal:
  val=-4
  res=-2
 Binary:
  val=11111111111111111111111111111100
  res=11111111111111111111111111111110
 NOTE: copy of sign bit shifted into left side

Expression: -1 = -4 &gt;&gt; 2
 Decimal:
  val=-4
  res=-1
 Binary:
  val=11111111111111111111111111111100
  res=11111111111111111111111111111111
 NOTE: bits shift out right side

Expression: -1 = -4 &gt;&gt; 3
 Decimal:
  val=-4
  res=-1
 Binary:
  val=11111111111111111111111111111100
  res=11111111111111111111111111111111
 NOTE: same result as above; can not shift beyond -1


--- BIT SHIFT LEFT ON POSITIVE INTEGERS ---
Expression: 8 = 4 &lt;&lt; 1
 Decimal:
  val=4
  res=8
 Binary:
  val=00000000000000000000000000000100
  res=00000000000000000000000000001000
 NOTE: zeros fill in right side

Expression: 1073741824 = 4 &lt;&lt; 28
 Decimal:
  val=4
  res=1073741824
 Binary:
  val=00000000000000000000000000000100
  res=01000000000000000000000000000000

Expression: -2147483648 = 4 &lt;&lt; 29
 Decimal:
  val=4
  res=-2147483648
 Binary:
  val=00000000000000000000000000000100
  res=10000000000000000000000000000000
 NOTE: sign bits get shifted out

Expression: 0 = 4 &lt;&lt; 30
 Decimal:
  val=4
  res=0
 Binary:
  val=00000000000000000000000000000100
  res=00000000000000000000000000000000
 NOTE: bits shift out left side


--- BIT SHIFT LEFT ON NEGATIVE INTEGERS ---
Expression: -8 = -4 &lt;&lt; 1
 Decimal:
  val=-4
  res=-8
 Binary:
  val=11111111111111111111111111111100
  res=11111111111111111111111111111000
 NOTE: zeros fill in right side

Expression: -2147483648 = -4 &lt;&lt; 29
 Decimal:
  val=-4
  res=-2147483648
 Binary:
  val=11111111111111111111111111111100
  res=10000000000000000000000000000000

Expression: 0 = -4 &lt;&lt; 30
 Decimal:
  val=-4
  res=0
 Binary:
  val=11111111111111111111111111111100
  res=00000000000000000000000000000000
 NOTE: bits shift out left side, including sign bit
</pre></div>
     </div>
     <div class="example-contents"><p>上の例の 64 ビットマシンでの出力は、このようになります。</p></div>
     <div class="example-contents screen">
<div class="cdata"><pre>

--- BIT SHIFT RIGHT ON POSITIVE INTEGERS ---
Expression: 2 = 4 &gt;&gt; 1
 Decimal:
  val=4
  res=2
 Binary:
  val=0000000000000000000000000000000000000000000000000000000000000100
  res=0000000000000000000000000000000000000000000000000000000000000010
 NOTE: copy of sign bit shifted into left side

Expression: 1 = 4 &gt;&gt; 2
 Decimal:
  val=4
  res=1
 Binary:
  val=0000000000000000000000000000000000000000000000000000000000000100
  res=0000000000000000000000000000000000000000000000000000000000000001

Expression: 0 = 4 &gt;&gt; 3
 Decimal:
  val=4
  res=0
 Binary:
  val=0000000000000000000000000000000000000000000000000000000000000100
  res=0000000000000000000000000000000000000000000000000000000000000000
 NOTE: bits shift out right side

Expression: 0 = 4 &gt;&gt; 4
 Decimal:
  val=4
  res=0
 Binary:
  val=0000000000000000000000000000000000000000000000000000000000000100
  res=0000000000000000000000000000000000000000000000000000000000000000
 NOTE: same result as above; can not shift beyond 0


--- BIT SHIFT RIGHT ON NEGATIVE INTEGERS ---
Expression: -2 = -4 &gt;&gt; 1
 Decimal:
  val=-4
  res=-2
 Binary:
  val=1111111111111111111111111111111111111111111111111111111111111100
  res=1111111111111111111111111111111111111111111111111111111111111110
 NOTE: copy of sign bit shifted into left side

Expression: -1 = -4 &gt;&gt; 2
 Decimal:
  val=-4
  res=-1
 Binary:
  val=1111111111111111111111111111111111111111111111111111111111111100
  res=1111111111111111111111111111111111111111111111111111111111111111
 NOTE: bits shift out right side

Expression: -1 = -4 &gt;&gt; 3
 Decimal:
  val=-4
  res=-1
 Binary:
  val=1111111111111111111111111111111111111111111111111111111111111100
  res=1111111111111111111111111111111111111111111111111111111111111111
 NOTE: same result as above; can not shift beyond -1


--- BIT SHIFT LEFT ON POSITIVE INTEGERS ---
Expression: 8 = 4 &lt;&lt; 1
 Decimal:
  val=4
  res=8
 Binary:
  val=0000000000000000000000000000000000000000000000000000000000000100
  res=0000000000000000000000000000000000000000000000000000000000001000
 NOTE: zeros fill in right side

Expression: 4611686018427387904 = 4 &lt;&lt; 60
 Decimal:
  val=4
  res=4611686018427387904
 Binary:
  val=0000000000000000000000000000000000000000000000000000000000000100
  res=0100000000000000000000000000000000000000000000000000000000000000

Expression: -9223372036854775808 = 4 &lt;&lt; 61
 Decimal:
  val=4
  res=-9223372036854775808
 Binary:
  val=0000000000000000000000000000000000000000000000000000000000000100
  res=1000000000000000000000000000000000000000000000000000000000000000
 NOTE: sign bits get shifted out

Expression: 0 = 4 &lt;&lt; 62
 Decimal:
  val=4
  res=0
 Binary:
  val=0000000000000000000000000000000000000000000000000000000000000100
  res=0000000000000000000000000000000000000000000000000000000000000000
 NOTE: bits shift out left side


--- BIT SHIFT LEFT ON NEGATIVE INTEGERS ---
Expression: -8 = -4 &lt;&lt; 1
 Decimal:
  val=-4
  res=-8
 Binary:
  val=1111111111111111111111111111111111111111111111111111111111111100
  res=1111111111111111111111111111111111111111111111111111111111111000
 NOTE: zeros fill in right side

Expression: -9223372036854775808 = -4 &lt;&lt; 61
 Decimal:
  val=-4
  res=-9223372036854775808
 Binary:
  val=1111111111111111111111111111111111111111111111111111111111111100
  res=1000000000000000000000000000000000000000000000000000000000000000

Expression: 0 = -4 &lt;&lt; 62
 Decimal:
  val=-4
  res=0
 Binary:
  val=1111111111111111111111111111111111111111111111111111111111111100
  res=0000000000000000000000000000000000000000000000000000000000000000
 NOTE: bits shift out left side, including sign bit
</pre></div>
     </div>
    </div>
   </p>
   <div class="warning"><strong class="warning">警告</strong>
    <p class="para">
     システムの long 型で扱える範囲以上の整数値をシフトした場合の結果は未定義です。
     32ビットシステム上では、32ビット以上の値をシフトしないようにしましょう。
     同様に、64ビットシステム上では、64ビット以上の値をシフトしないようにしましょう。
    </p>
    <p class="para">
     <em>PHP_INT_MAX</em> を超える数のビット演算には、
     <a href="book.gmp.html" class="link">gmp</a> 拡張モジュールの関数を使いましょう。
    </p>
   </div>
   <p class="para">
    <span class="function"><a href="function.pack.html" class="function">pack()</a></span>,
    <span class="function"><a href="function.unpack.html" class="function">unpack()</a></span>,
    <span class="function"><a href="function.gmp-and.html" class="function">gmp_and()</a></span>,
    <span class="function"><a href="function.gmp-or.html" class="function">gmp_or()</a></span>,
    <span class="function"><a href="function.gmp-xor.html" class="function">gmp_xor()</a></span>,
    <span class="function"><a href="function.gmp-testbit.html" class="function">gmp_testbit()</a></span>,
    <span class="function"><a href="function.gmp-clrbit.html" class="function">gmp_clrbit()</a></span>
    も参照ください。
   </p>
  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115365""></a>
  <div class="note">
   <strong class="user">J. Ketting</strong>
   <a href="#115365" class="date">13-Jul-2014 06:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@zooly<br />
<br />
Don't forget the leading zeros.<br />
It's very important if you want to write a function similar to the assembly instructions 'ror' and 'rol' (Rotate on Right and Rotate on Left), because of dword value; rotating the binary always takes 32 positions and includes the leading zeros!<br />
So this is the right way:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">rotate </span><span class="keyword">(</span><span class="default">$decimal</span><span class="keyword">, </span><span class="default">$bits</span><span class="keyword">) {<br />
<br />
&nbsp; </span><span class="default">$binary </span><span class="keyword">= </span><span class="default">decbin</span><span class="keyword">(</span><span class="default">$decimal</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$binary </span><span class="keyword">= </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$binary</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">, </span><span class="string">'0'</span><span class="keyword">, </span><span class="default">STR_PAD_LEFT</span><span class="keyword">);<br />
&nbsp; return (<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binary</span><span class="keyword">, </span><span class="default">$bits</span><span class="keyword">).</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binary</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$bits</span><span class="keyword">))<br />
&nbsp; );<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Look at this assembly code:<br />
<br />
mov edx, 1bf5616c<br />
ror edx, 8<br />
<br />
After this operation: edx = 0x6c1bf561 (binary: 1101100000110111111010101100001)<br />
But your code returns 0x0d9bf561 (binary: 1101100110111111010101100001)<br />
In order to get the right value you have to add the leading zeros by adding that line with strpad() (see above). Very important!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113284""></a>
  <div class="note">
   <strong class="user">melnikvictorl at gmail dot com</strong>
   <a href="#113284" class="date">21-Sep-2013 12:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Nice example of bitwise operation with strings:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">echo </span><span class="string">'php' </span><span class="keyword">&amp; </span><span class="string">'^_^'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// will output string PHP</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112699""></a>
  <div class="note">
   <strong class="user">sag at ich dot net</strong>
   <a href="#112699" class="date">15-Jul-2013 03:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
me reimplement for bitwise NOT (~)<br />
<br />
&nbsp;&nbsp;&nbsp; protected function flipBin($number) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $bin = str_pad(base_convert($number, 10, 2), 32, 0, STR_PAD_LEFT);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for ($i = 0; $i &lt; 32; $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch ($bin{$i}) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case '0' :<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $bin{$i} = '1';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case '1' :<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $bin{$i} = '0';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return bindec($bin);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
the benefit is, it works with numbers greater MAX_INT</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111683""></a>
  <div class="note">
   <strong class="user">vivekanand dot pathak25 at gmail dot com</strong>
   <a href="#111683" class="date">16-Mar-2013 04:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
$a =&nbsp; &nbsp;&nbsp; 9;<br />
$b =&nbsp; &nbsp;&nbsp; 10;<br />
echo $a &amp; $b;<br />
<br />
place value&nbsp;&nbsp; 128&nbsp; 64&nbsp; 32&nbsp; 16&nbsp;&nbsp; 8&nbsp; 4&nbsp;&nbsp; 2&nbsp;&nbsp; 1<br />
$a&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; 1&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp; 1&nbsp;&nbsp; =9<br />
$b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; 1&nbsp;&nbsp; 0&nbsp; 1&nbsp;&nbsp; 0&nbsp;&nbsp; =10<br />
<br />
result&nbsp;&nbsp; 8&nbsp; <br />
<br />
&nbsp;only bit they share together is the 8 bit. So 8 gets returned.<br />
<br />
&nbsp; $a =&nbsp; &nbsp;&nbsp; 36;<br />
$b =&nbsp; &nbsp;&nbsp; 103;<br />
echo $a &amp; $b;<br />
<br />
place value&nbsp;&nbsp; 128&nbsp; 64&nbsp; 32&nbsp; 16&nbsp;&nbsp; 8&nbsp; &nbsp; 4&nbsp;&nbsp; 2&nbsp;&nbsp; 1<br />
$a&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; 1&nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp; 1&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp; =36<br />
$b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; 1&nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp; 1&nbsp;&nbsp; 1&nbsp;&nbsp; 1&nbsp;&nbsp; =103<br />
<br />
result&nbsp; 32+4 = 36<br />
the only bits these two share together are the bits 32 and 4 which when added together return 36.<br />
<br />
$a =&nbsp; &nbsp;&nbsp; 9;<br />
$b =&nbsp; &nbsp;&nbsp; 10;<br />
echo $a | $b;<br />
<br />
place value&nbsp;&nbsp; 128&nbsp; 64&nbsp; 32&nbsp; 16&nbsp;&nbsp; 8&nbsp; 4&nbsp;&nbsp; 2&nbsp;&nbsp; 1<br />
$a&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; 1&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp; 1&nbsp;&nbsp; =9<br />
$b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; 1&nbsp;&nbsp; 0&nbsp; 1&nbsp;&nbsp; 0&nbsp;&nbsp; =10<br />
<br />
result 8+2+1 = 11<br />
&nbsp;3 bits set, in the 8, 2, and 1 column.add those up 8+2+1 and you get 11<br />
<br />
$a =&nbsp; &nbsp;&nbsp; 9;<br />
$b =&nbsp; &nbsp;&nbsp; 10;<br />
echo $a ^ $b;<br />
<br />
place value&nbsp;&nbsp; 128&nbsp; 64&nbsp; 32&nbsp; 16&nbsp;&nbsp; 8&nbsp; 4&nbsp;&nbsp; 2&nbsp;&nbsp; 1<br />
$a&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; 1&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp; 1&nbsp;&nbsp; =9<br />
$b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; 0&nbsp; &nbsp;&nbsp; 0&nbsp; &nbsp; 1&nbsp;&nbsp; 0&nbsp; 1&nbsp;&nbsp; 0&nbsp;&nbsp; =10<br />
<br />
result&nbsp; 2+1 = 3<br />
the 2 bit and the 1 bit that they each have set but don't share. Soooo 2+1 = 3</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110846""></a>
  <div class="note">
   <strong class="user">erich at seachawaii dot com</strong>
   <a href="#110846" class="date">14-Dec-2012 12:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a note regarding negative shift values, as the documentation states each shift is an integer multiply or divide (left or right respectively) by 2.&nbsp; That means a negative shift value (the right hand operand) effects the sign of the shift and NOT the direction of the shift as I would have expected.&nbsp; <br />
FE. 0xff &gt;&gt; -2 results in 0x0 <br />
and 0xff &lt;&lt; -2 result in 0xFFFFFFFFC0000000 (dependant on PHP_INT_MAX)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109792""></a>
  <div class="note">
   <strong class="user">frankemeks77 at yahoo dot com</strong>
   <a href="#109792" class="date">21-Aug-2012 10:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just learning Bitwise Shift Operators.
<br />

<br />
The easiest way to resolve a bitwise&nbsp; shift operators is my multiply or dividing each step by two for left shift or right shift respectively
<br />

<br />
Example:
<br />

<br />
LEFT SHIFT
<br />
<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">8 </span><span class="keyword">&lt;&lt; </span><span class="default">3</span><span class="keyword">; </span><span class="comment">//64 </span><span class="default">?&gt;
<br />
</span>
<br />
//same as
<br />
<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">8 </span><span class="keyword">* </span><span class="default">2 </span><span class="keyword">* </span><span class="default">2 </span><span class="keyword">* </span><span class="default">2</span><span class="keyword">; </span><span class="default">?&gt;
<br />
</span>
<br />
RIGHT SHIFT
<br />
<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">8 </span><span class="keyword">&gt;&gt; </span><span class="default">3</span><span class="keyword">; </span><span class="comment">//1 </span><span class="default">?&gt;
<br />
</span>
<br />
//same as
<br />
<span class="default">&lt;?php </span><span class="keyword">echo ((</span><span class="default">8</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">)/</span><span class="default">2</span><span class="keyword">)/</span><span class="default">2</span><span class="keyword">; </span><span class="comment">//1 </span><span class="default">?&gt;
<br />
</span>
<br />
//Solving on a paper 8/2 = 4/2 = 2/2 = 1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108679""></a>
  <div class="note">
   <strong class="user">wbcarts at juno dot com</strong>
   <a href="#108679" class="date">17-May-2012 12:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
BITWISE FLAGS for Custom PHP Objects<br />
<br />
Sometimes I need a custom PHP Object that holds several boolean TRUE or FALSE values. I could easily include a variable for each of them, but as always, code has a way to get unweildy pretty fast. A more intelligent approach always seems to be the answer, even if it seems to be overkill at first.<br />
<br />
I start with an abstract base class which will hold a single integer variable called $flags. This simple integer can hold 32 TRUE or FALSE boolean values. Another thing to consider is to just set certain BIT values without disturbing any of the other BITS -- so included in the class definition is the setFlag($flag, $value) function, which will set only the chosen bit. Here's the abstract base class definition: <br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment"># BitwiseFlag.php<br />
<br />
</span><span class="keyword">abstract class </span><span class="default">BitwiseFlag<br />
</span><span class="keyword">{<br />
&nbsp; protected </span><span class="default">$flags</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; * Note: these functions are protected to prevent outside code<br />
&nbsp;&nbsp; * from falsely setting BITS. See how the extending class 'User'<br />
&nbsp;&nbsp; * handles this.<br />
&nbsp;&nbsp; *<br />
&nbsp;&nbsp; */<br />
&nbsp; </span><span class="keyword">protected function </span><span class="default">isFlagSet</span><span class="keyword">(</span><span class="default">$flag</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return ((</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">flags </span><span class="keyword">&amp; </span><span class="default">$flag</span><span class="keyword">) == </span><span class="default">$flag</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; protected function </span><span class="default">setFlag</span><span class="keyword">(</span><span class="default">$flag</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">flags </span><span class="keyword">|= </span><span class="default">$flag</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">flags </span><span class="keyword">&amp;= ~</span><span class="default">$flag</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The class above is abstract and cannot be instantiated, so an extension is required. Below is a simple extension called User -- which is severely truncated for clarity. Notice I am defining const variables AND methods to use them.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment"># User.php<br />
<br />
</span><span class="keyword">require(</span><span class="string">'BitwiseFlag.php'</span><span class="keyword">);<br />
<br />
class </span><span class="default">User </span><span class="keyword">extends </span><span class="default">BitwiseFlag<br />
</span><span class="keyword">{<br />
&nbsp; const </span><span class="default">FLAG_REGISTERED </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="comment">// BIT #1 of $flags has the value 1<br />
&nbsp; </span><span class="keyword">const </span><span class="default">FLAG_ACTIVE </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;&nbsp; &nbsp;&nbsp; </span><span class="comment">// BIT #2 of $flags has the value 2<br />
&nbsp; </span><span class="keyword">const </span><span class="default">FLAG_MEMBER </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;&nbsp; &nbsp;&nbsp; </span><span class="comment">// BIT #3 of $flags has the value 4<br />
&nbsp; </span><span class="keyword">const </span><span class="default">FLAG_ADMIN </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">;&nbsp; &nbsp; &nbsp; </span><span class="comment">// BIT #4 of $flags has the value 8<br />
<br />
&nbsp; </span><span class="keyword">public function </span><span class="default">isRegistered</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isFlagSet</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_REGISTERED</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">isActive</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isFlagSet</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_ACTIVE</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">isMember</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isFlagSet</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_MEMBER</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">isAdmin</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isFlagSet</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_ADMIN</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">setRegistered</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setFlag</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_REGISTERED</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">setActive</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setFlag</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_ACTIVE</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">setMember</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setFlag</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_MEMBER</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">setAdmin</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setFlag</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_ADMIN</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">__toString</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; return </span><span class="string">'User [' </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp;&nbsp; (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isRegistered</span><span class="keyword">() ? </span><span class="string">'REGISTERED' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">) .<br />
&nbsp;&nbsp; &nbsp;&nbsp; (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isActive</span><span class="keyword">() ? </span><span class="string">' ACTIVE' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">) .<br />
&nbsp;&nbsp; &nbsp;&nbsp; (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isMember</span><span class="keyword">() ? </span><span class="string">' MEMBER' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">) .<br />
&nbsp;&nbsp; &nbsp;&nbsp; (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isAdmin</span><span class="keyword">() ? </span><span class="string">' ADMIN' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">) .<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">']'</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
This seems like a lot of work, but we have addressed many issues, for example, using and maintaining the code is easy, and the getting and setting of flag values make sense. With the User class, you can now see how easy and intuitive bitwise flag operations become.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">require(</span><span class="string">'User.php'</span><span class="keyword">)<br />
<br />
</span><span class="default">$user </span><span class="keyword">= new </span><span class="default">User</span><span class="keyword">();<br />
</span><span class="default">$user</span><span class="keyword">-&gt;</span><span class="default">setRegistered</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">$user</span><span class="keyword">-&gt;</span><span class="default">setActive</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">$user</span><span class="keyword">-&gt;</span><span class="default">setMember</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">$user</span><span class="keyword">-&gt;</span><span class="default">setAdmin</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$user</span><span class="keyword">;&nbsp; </span><span class="comment">// outputs: User [REGISTERED ACTIVE MEMBER ADMIN]<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106123""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#106123" class="date">12-Oct-2011 04:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To make very clear why ("18" &amp; "32") is "10".<br />
1) they they are both strings ,<br />
2) "&amp;" operator works on strings by taking each !Character! from each string and make a bit wise &amp; between them and add this value to the resulting string<br />
<br />
So:<br />
"18" is made up of two characters: 0x31, 0x38<br />
"32" is made up of two characters: 0x33, 0x32<br />
----RESULT-----<br />
0x31 &amp; 0x33 = 0x31 =&gt; "1"<br />
0x38 &amp; 0x32 = 0x30 =&gt; "0"<br />
<br />
and the result is "10" which is 100% correct.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105821""></a>
  <div class="note">
   <strong class="user">spencer-p-moy at example dot com</strong>
   <a href="#105821" class="date">18-Sep-2011 03:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The NOT or complement operator ( ~ ) and negative binary numbers can be confusing.<br />
<br />
~2 = -3&nbsp; because you use the formula&nbsp; ~x = -x - 1&nbsp; The bitwise complement of a decimal number is the negation of the number minus 1.<br />
<br />
NOTE: just using 4 bits here for the examples below but in reality PHP uses 32 bits.<br />
<br />
Converting a negative decimal number (ie: -3) into binary takes 3 steps:<br />
1) convert the positive version of the decimal number into binary (ie: 3 = 0011)<br />
2) flips the bits (ie: 0011 becomes 1100)<br />
3) add 1 (ie: 1100&nbsp; + 0001 = 1101)<br />
<br />
You might be wondering how does 1101 = -3. Well PHP uses the method "2's complement" to render negative binary numbers. If the left most bit is a 1 then the binary number is negative and you flip the bits and add 1. If it is 0 then it is positive and you don't have to do anything. So 0010 would be a positive 2. If it is 1101, it is negative and you flip the bits to get 0010. Add 1 and you get 0011 which equals -3.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105370""></a>
  <div class="note">
   <strong class="user">aba at example dot com</strong>
   <a href="#105370" class="date">12-Aug-2011 02:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is true that if both the left-hand and right-hand parameters are strings, the bitwise operator will operate on the characters' ASCII values. However, a complement is necessary to complete this sentence.<br />
It is not irrelevant to point out that the decimal character's ASCII value have different binary values.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if ((</span><span class="string">'18' </span><span class="keyword">&amp; </span><span class="string">'32'</span><span class="keyword">) == </span><span class="string">'10'</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">ord</span><span class="keyword">(</span><span class="string">'18'</span><span class="keyword">); </span><span class="comment">//return decimal value 49, which have binary value 110001<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">ord</span><span class="keyword">(</span><span class="string">'32'</span><span class="keyword">); </span><span class="comment">//return decimal value 51, which have binary value 110011<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">ord</span><span class="keyword">(</span><span class="string">'10'</span><span class="keyword">); </span><span class="comment">//return decimal value 49, which have binary value 110001<br />
&nbsp;&nbsp;&nbsp; //Therefore 110001 &amp; 110011 = 110001<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104291""></a>
  <div class="note">
   <strong class="user">ivoras at gmail dot com</strong>
   <a href="#104291" class="date">06-Jun-2011 01:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As an additional curiosity, for some reason the result of the operation ("18" &amp; "32") is "10". In other words, try avoiding using the binary operators on strings :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102403""></a>
  <div class="note">
   <strong class="user">josh at joshstrike dot com</strong>
   <a href="#102403" class="date">12-Feb-2011 04:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
More referencing this for myself than anything... if you need to iterate through every possible binary combination where $n number of flags are set to 1 in a mask of $bits length:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">echo </span><span class="default">masksOf</span><span class="keyword">(</span><span class="default">3</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">);
<br />

<br />
function </span><span class="default">masksOf</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">,</span><span class="default">$bits</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$u </span><span class="keyword">= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">$bits</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">; </span><span class="comment">//start value, full flags on.
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$masks </span><span class="keyword">= array();
<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$u</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$z </span><span class="keyword">= </span><span class="default">numflags</span><span class="keyword">(</span><span class="default">$u</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$z</span><span class="keyword">==</span><span class="default">$n</span><span class="keyword">) </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$masks</span><span class="keyword">,</span><span class="default">$u</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$u</span><span class="keyword">--;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$masks</span><span class="keyword">);&nbsp; &nbsp; 
<br />
}
<br />

<br />
function </span><span class="default">numflags</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$k </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$n</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$k </span><span class="keyword">+= </span><span class="default">$n </span><span class="keyword">&amp; </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">$n </span><span class="keyword">&gt;&gt; </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$k</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//&nbsp; &nbsp; alternately: 
<br />
//&nbsp; &nbsp; $u = 0;
<br />
//&nbsp; &nbsp; for ($k=1;$k&lt;=$n;$k*=2) {
<br />
//&nbsp; &nbsp; &nbsp; &nbsp; $u+=($n&amp;$k?1:0);
<br />
//&nbsp; &nbsp; }
<br />
//&nbsp; &nbsp; return ($u);
<br />
</span><span class="keyword">}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99589""></a>
  <div class="note">
   <strong class="user">amckenzie4 at gmail dot com</strong>
   <a href="#99589" class="date">25-Aug-2010 05:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If, like me, you've never thought about how PHP deals with binary, the output of the bitwise NOT may confuse you.&nbsp; For instance, this:<br />
<br />
$bin = 2;<br />
$notbin = ~$bin;<br />
<br />
echo "Bin: " . decbin($bin) . "&nbsp; !bin:&nbsp; " . decbin($notbin) . "\n";<br />
<br />
returns this:<br />
<br />
Bin: 10&nbsp; !bin:&nbsp; 1111111111111111111111111111111111111111111111111111111111111101<br />
<br />
The reason is that all binary numbers are treated as 32 bits, even if you've manually entered less.&nbsp; In order to get the result I expected (01), it was necessary to AND the result with the number of bits I wanted:&nbsp; in this case, 2 (the number 3, in decimal).&nbsp; Be aware that all return values will have zeros removed from the left until they reach a bit that is set to 1.&nbsp; Continuing the above example, the following:<br />
<br />
$notbin_2 = ~$bin &amp; '3';<br />
echo "!bin &amp; 3:&nbsp; " . decbin($notbin_2) . "\n";<br />
<br />
returns this:<br />
<br />
!bin &amp; 3:&nbsp; 1<br />
<br />
Note that the actual value was a string of 31 zeros followed by a 1, but the zeros were not shown.&nbsp; This is probably a good thing.<br />
<br />
Furthermore, the NOT operator uses two's complement, which means the number you get may be even stranger than you expect:&nbsp; using two's complement means that ~2 == -3.&nbsp; There are plenty of good explanations of two's complement online, so I won't go into that question here.<br />
<br />
If what you want is just to reverse a string of bits without any interpretation, you can use a function like this:<br />
<br />
function bitnot($bin)<br />
&nbsp;{<br />
&nbsp;&nbsp; $not = "";<br />
&nbsp;&nbsp; for ($i = 0; $i &lt; strlen($bin); $i++)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if($bin[$i] == 0) { $not .= '1'; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; if($bin[$i] == 1) { $not .= '0'; }<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; return $not;<br />
&nbsp;}<br />
<br />
It takes a binary string of any length, reverses the bits, and returns the new string.&nbsp; You can then treat it as a binary number, use bindec() to turn it into a decimal, or whatever you want.<br />
<br />
I hope this helps someone as much as it would have helped me a week ago!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99335""></a>
  <div class="note">
   <strong class="user">Core Xii</strong>
   <a href="#99335" class="date">11-Aug-2010 07:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be very careful when XOR-ing strings! If one of the values is empty (0, '', null) the result will also be empty!<br />
<br />
<span class="default">&lt;?php<br />
var_dump</span><span class="keyword">(</span><span class="default">1234 </span><span class="keyword">^ </span><span class="default">0</span><span class="keyword">); </span><span class="comment">// int(1234)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">1234 </span><span class="keyword">^ </span><span class="string">''</span><span class="keyword">); </span><span class="comment">// int(1234)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">1234 </span><span class="keyword">^ </span><span class="default">null</span><span class="keyword">); </span><span class="comment">// int(1234)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="string">'hello world' </span><span class="keyword">^ </span><span class="default">0</span><span class="keyword">); </span><span class="comment">// int(0)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="string">'hello world' </span><span class="keyword">^ </span><span class="string">''</span><span class="keyword">); </span><span class="comment">// string(0) ""<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="string">'hello world' </span><span class="keyword">^ </span><span class="default">null</span><span class="keyword">); </span><span class="comment">// int(0)<br />
</span><span class="default">?&gt;<br />
</span><br />
This seems rather inconsistent behavior. An integer XOR'd with zero results the original integer. But a string XOR'd with an empty value results an empty value!<br />
<br />
My password hashing function was always returning the same hash... Because I was XOR-ing it with a salt that was sometimes empty!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97917""></a>
  <div class="note">
   <strong class="user">Adam</strong>
   <a href="#97917" class="date">15-May-2010 10:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful of order of operations.<br />
<br />
for example, you may want to check if the second bit is set:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">$x </span><span class="keyword">&amp; </span><span class="default">2 </span><span class="keyword">== </span><span class="default">2</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* code */<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
is different than<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if ((</span><span class="default">$x </span><span class="keyword">&amp; </span><span class="default">2</span><span class="keyword">) == </span><span class="default">2</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* code */<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
and the latter of the two should be used.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95614""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#95614" class="date">12-Jan-2010 07:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware that PHP's &lt;&lt; and &gt;&gt; operators, unlike the other bitwise operators do not work on ASCII values; &lt;&lt; and &gt;&gt; cast their operands to integer (when possible) before shifting and will always return an integer result.<br />
<br />
For example:<br />
<br />
<span class="default">&lt;?php<br />
$foo </span><span class="keyword">= </span><span class="string">"1"</span><span class="keyword">; </span><span class="comment">// chr(49)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$foo </span><span class="keyword">&lt;&lt; </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// Output is int(2)<br />
<br />
</span><span class="default">$foo </span><span class="keyword">= </span><span class="string">"!"</span><span class="keyword">; </span><span class="comment">// chr(33)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$foo </span><span class="keyword">&lt;&lt; </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// Output is int(0)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94552""></a>
  <div class="note">
   <strong class="user">Alex</strong>
   <a href="#94552" class="date">11-Nov-2009 07:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Okay, I'm twelve, and I am new to PHP, but I created the following -simple- functions:
<br />
<span class="default">&lt;?php
<br />

<br />
</span><span class="keyword">function </span><span class="default">Isdec</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">) {
<br />
if(</span><span class="default">round</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">)==</span><span class="default">$num</span><span class="keyword">) {
<br />
return </span><span class="default">false</span><span class="keyword">;
<br />
}
<br />
else {
<br />
return </span><span class="default">true</span><span class="keyword">;
<br />
}
<br />
}
<br />

<br />
function </span><span class="default">decshiftl</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">, </span><span class="default">$amount</span><span class="keyword">){
<br />
if(</span><span class="default">Isdec</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">)) {
<br />
</span><span class="default">$decimal </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">, (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">) - </span><span class="default">round</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">));
<br />
</span><span class="default">$decimal</span><span class="keyword">*=</span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$decimal</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">);
<br />
</span><span class="default">$Shiftl </span><span class="keyword">= (</span><span class="default">$number </span><span class="keyword">&lt;&lt; </span><span class="default">$amount</span><span class="keyword">) + ((</span><span class="default">$decimal </span><span class="keyword">&lt;&lt; </span><span class="default">$amount</span><span class="keyword">) / </span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$decimal</span><span class="keyword">)));
<br />
}
<br />
else {
<br />
</span><span class="default">$Shiftl </span><span class="keyword">= </span><span class="default">$number </span><span class="keyword">&lt;&lt; </span><span class="default">$amount</span><span class="keyword">;
<br />
}
<br />
return </span><span class="default">$Shiftl</span><span class="keyword">;
<br />
}
<br />

<br />
function </span><span class="default">decshiftr</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">, </span><span class="default">$amount</span><span class="keyword">){
<br />
if(</span><span class="default">Isdec</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">)) {
<br />
</span><span class="default">$decimal </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">, (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">) - </span><span class="default">round</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">));
<br />
</span><span class="default">$decimal</span><span class="keyword">*=</span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$decimal</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">);
<br />
</span><span class="default">$Shiftr </span><span class="keyword">= (</span><span class="default">$number </span><span class="keyword">&gt;&gt; </span><span class="default">$amount</span><span class="keyword">) + ((</span><span class="default">$decimal </span><span class="keyword">&gt;&gt; </span><span class="default">$amount</span><span class="keyword">) / </span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$decimal</span><span class="keyword">)));
<br />
}
<br />
else {
<br />
</span><span class="default">$Shiftr </span><span class="keyword">= </span><span class="default">$number </span><span class="keyword">&gt;&gt; </span><span class="default">$amount</span><span class="keyword">;
<br />
}
<br />
return </span><span class="default">$Shiftr</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>Anyway, it's just shoving parameters in to an equation, but sometimes reinventing the wheel and putting rockets on it is a good thing.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94144""></a>
  <div class="note">
   <strong class="user">zooly at globmi dot com</strong>
   <a href="#94144" class="date">19-Oct-2009 04:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an example for bitwise leftrotate and rightrotate.<br />
<br />
Note that this function works only with decimal numbers - other types can be converted with pack().<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">rotate </span><span class="keyword">( </span><span class="default">$decimal</span><span class="keyword">, </span><span class="default">$bits</span><span class="keyword">) {<br />
<br />
&nbsp; </span><span class="default">$binary </span><span class="keyword">= </span><span class="default">decbin</span><span class="keyword">(</span><span class="default">$decimal</span><span class="keyword">);<br />
<br />
&nbsp; return (<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binary</span><span class="keyword">, </span><span class="default">$bits</span><span class="keyword">).</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binary</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$bits</span><span class="keyword">))<br />
&nbsp; );<br />
<br />
}<br />
<br />
</span><span class="comment">// Rotate 124 (1111100) to the left with 1 bits<br />
<br />
</span><span class="keyword">echo </span><span class="default">rotate</span><span class="keyword">(</span><span class="default">124</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
<br />
</span><span class="comment">// = 121 (1111001)<br />
<br />
// Rotate 124 (1111100) to the right with 3 bits<br />
<br />
</span><span class="keyword">echo </span><span class="default">rotate</span><span class="keyword">(</span><span class="default">124</span><span class="keyword">, -</span><span class="default">3</span><span class="keyword">);<br />
<br />
</span><span class="comment">// = 79 (1001111)<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91291""></a>
  <div class="note">
   <strong class="user">grayda dot NOSPAM at DONTSPAM dot solidinc dot org</strong>
   <a href="#91291" class="date">04-Jun-2009 05:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Initially, I found bitmasking to be a confusing concept and found no use for it. So I've whipped up this code snippet in case anyone else is confused:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// The various details a vehicle can have<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hasFourWheels </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hasTwoWheels&nbsp; </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hasDoors&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hasRedColour&nbsp; </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bike&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">$hasTwoWheels</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$golfBuggy&nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">$hasFourWheels</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ford&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">$hasFourWheels </span><span class="keyword">| </span><span class="default">$hasDoors</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ferrari&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">$hasFourWheels </span><span class="keyword">| </span><span class="default">$hasDoors </span><span class="keyword">| </span><span class="default">$hasRedColour</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$isBike&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">$hasFourWheels </span><span class="keyword">&amp; </span><span class="default">$bike</span><span class="keyword">; </span><span class="comment"># False, because $bike doens't have four wheels<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$isGolfBuggy&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">$hasFourWheels </span><span class="keyword">&amp; </span><span class="default">$golfBuggy</span><span class="keyword">; </span><span class="comment"># True, because $golfBuggy has four wheels<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$isFord&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">$hasFourWheels </span><span class="keyword">&amp; </span><span class="default">$ford</span><span class="keyword">; </span><span class="comment"># True, because $ford $hasFourWheels<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
And you can apply this to a lot of things, for example, security:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Security permissions:<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$writePost </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$readPost </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$deletePost </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$addUser </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$deleteUser </span><span class="keyword">= </span><span class="default">16</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// User groups:<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$administrator </span><span class="keyword">= </span><span class="default">$writePost </span><span class="keyword">| </span><span class="default">$readPosts </span><span class="keyword">| </span><span class="default">$deletePosts </span><span class="keyword">| </span><span class="default">$addUser </span><span class="keyword">| </span><span class="default">$deleteUser</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$moderator </span><span class="keyword">= </span><span class="default">$readPost </span><span class="keyword">| </span><span class="default">$deletePost </span><span class="keyword">| </span><span class="default">$deleteUser</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$writer </span><span class="keyword">= </span><span class="default">$writePost </span><span class="keyword">| </span><span class="default">$readPost</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$guest </span><span class="keyword">= </span><span class="default">$readPost</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// function to check for permission<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">checkPermission</span><span class="keyword">(</span><span class="default">$user</span><span class="keyword">, </span><span class="default">$permission</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$user </span><span class="keyword">&amp; </span><span class="default">$permission</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Now we apply all of this!<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">checkPermission</span><span class="keyword">(</span><span class="default">$administrator</span><span class="keyword">, </span><span class="default">$deleteUser</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">deleteUser</span><span class="keyword">(</span><span class="string">"Some User"</span><span class="keyword">); </span><span class="comment"># This is executed because $administrator can $deleteUser<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Once you get your head around it, it's VERY useful! Just remember to raise each value by the power of two to avoid problems</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90850""></a>
  <div class="note">
   <strong class="user">Silver</strong>
   <a href="#90850" class="date">13-May-2009 01:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding what Bob said about flags, I'd like to point out there's a 100% safe way of defining flags, which is using hexadecimal notation for integers:<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">"f0"</span><span class="keyword">, </span><span class="default">0x1</span><span class="keyword">); </span><span class="comment">// 2^0<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"f1"</span><span class="keyword">, </span><span class="default">0x2</span><span class="keyword">); </span><span class="comment">// 2^1<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"f2"</span><span class="keyword">, </span><span class="default">0x4</span><span class="keyword">); </span><span class="comment">// 2^2<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"f3"</span><span class="keyword">, </span><span class="default">0x8</span><span class="keyword">); </span><span class="comment">// 2^3<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"f4"</span><span class="keyword">, </span><span class="default">0x10</span><span class="keyword">); </span><span class="comment">// 2^4<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"f5"</span><span class="keyword">, </span><span class="default">0x20</span><span class="keyword">); </span><span class="comment">// 2^5<br />
// ...<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"f20"</span><span class="keyword">, </span><span class="default">0x1000000</span><span class="keyword">); </span><span class="comment">// 2^20<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"f21"</span><span class="keyword">, </span><span class="default">0x2000000</span><span class="keyword">); </span><span class="comment">// 2^21<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"f22"</span><span class="keyword">, </span><span class="default">0x4000000</span><span class="keyword">); </span><span class="comment">// 2^22<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"f23"</span><span class="keyword">, </span><span class="default">0x8000000</span><span class="keyword">); </span><span class="comment">// 2^23<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"f24"</span><span class="keyword">, </span><span class="default">0x10000000</span><span class="keyword">); </span><span class="comment">// 2^24<br />
// ... up to 2^31<br />
</span><span class="default">?&gt;<br />
</span><br />
I always avoid using decimal notation when I have a large amount of different flags, because it's very easy to misspell numbers like 2^20 (1048576).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90514""></a>
  <div class="note">
   <strong class="user">Bob</strong>
   <a href="#90514" class="date">26-Apr-2009 09:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an easy way to use bitwise operation for 'flag' functionality.<br />
By this I mean managing a set of options which can either be ON or OFF, where zero or more of these options may be set and each option may only be set once. (If you are familiar with MySQL, think 'set' datatype).<br />
Note: to older programmers, this will be obvious.<br />
<br />
Here is the code:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">set_bitflag</span><span class="keyword">(</span><span class="comment">/*variable-length args*/</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">func_get_args</span><span class="keyword">() as </span><span class="default">$flag</span><span class="keyword">) </span><span class="default">$val </span><span class="keyword">= </span><span class="default">$val </span><span class="keyword">| </span><span class="default">$flag</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$val</span><span class="keyword">;<br />
}<br />
function </span><span class="default">is_bitflag_set</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, </span><span class="default">$flag</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; return ((</span><span class="default">$val </span><span class="keyword">&amp; </span><span class="default">$flag</span><span class="keyword">) === </span><span class="default">$flag</span><span class="keyword">);<br />
}<br />
</span><span class="comment">// Define your flags<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'MYFLAGONE'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// 0001<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'MYFLAGTWO'</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">); </span><span class="comment">// 0010<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'MYFLAGTHREE'</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">); </span><span class="comment">// 0100<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'MYFLAGFOUR'</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">); </span><span class="comment">// 1000<br />
</span><span class="default">?&gt;<br />
</span><br />
I should point out: your flags are stored in a single integer. You can store loads of flags in a single integer.<br />
<br />
To use my functions, say you wanted to set MYFLAGONE and MYFLAGTHREE, you would use:<br />
<span class="default">&lt;?php<br />
$myflags </span><span class="keyword">= </span><span class="default">set_bitflags</span><span class="keyword">(</span><span class="default">MYFLAGONE</span><span class="keyword">, </span><span class="default">MYFLAGTHREE</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Note: you can pass set_bitflags() as many flags to set as you want.<br />
<br />
When you want to test later if a certain flag is set, use e.g.:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(</span><span class="default">is_bitflag_set</span><span class="keyword">(</span><span class="default">$myflags</span><span class="keyword">, </span><span class="default">MYFLAGTWO</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"MYFLAGTWO is set!"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
The only tricky part is defining your flags. Here is the process:<br />
1.&nbsp; Write a list of your flags<br />
2.&nbsp; Count them<br />
3.&nbsp; Define the last flag in your list as 1 times 2 to the power of &lt;count&gt; minus one. ( I.E. 1*2^(&lt;count&gt;-1) )<br />
3. Working backwards through your list, from the last to the first, define each one as half of the previous one. You should reach 1 when you get to the first<br />
<br />
If you want to understand binary numbers, bits and bitwise operation better, the wikipedia page explains it well - <a href="http://en.wikipedia.org/wiki/Bitwise_operation." rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Bitwise_operation.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90310""></a>
  <div class="note">
   <strong class="user">cw3theophilus at gmail dot com</strong>
   <a href="#90310" class="date">15-Apr-2009 11:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who are looking for a circular bit shift function in PHP (especially useful for cryptographic functions) that works with negtive values, here is a little function I wrote:<br />
<br />
(Note: It took me almost a whole day to get this to work with negative $num values (I couldn't figure out why it sometimes worked and other times didn't), because PHP only has an arithmatic and not a logical bitwise right shift like I am used to. I.e. 0x80000001&gt;&gt;16 will ouputs (in binary) "1111 1111 1111 1111 1000 0000 0000 0000" instead of "0000 0000 0000 0000 1000 0000 0000 0000" like you would expect. To fix this you have to apply the mask (by bitwise &amp;) equal to 0x7FFFFFFF right shifted one less than the offset you are shifting by.)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">circular_shift</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">,</span><span class="default">$offset</span><span class="keyword">) { </span><span class="comment">//Do a nondestructive circular bitwise shift, if offset positive shift left, if negative shift right<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$num</span><span class="keyword">=(int)</span><span class="default">$num</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mask</span><span class="keyword">=</span><span class="default">0x7fffffff</span><span class="keyword">; </span><span class="comment">//Mask to cater for the fact that PHP only does arithmatic right shifts and not logical i.e. PHP doesn't give expected output when right shifting negative values<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$offset</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num</span><span class="keyword">=(</span><span class="default">$num</span><span class="keyword">&lt;&lt;</span><span class="default">$offset</span><span class="keyword">%</span><span class="default">32</span><span class="keyword">) | ((</span><span class="default">$num</span><span class="keyword">&gt;&gt;(</span><span class="default">32</span><span class="keyword">-</span><span class="default">$offset</span><span class="keyword">%</span><span class="default">32</span><span class="keyword">)) &amp; (</span><span class="default">$mask</span><span class="keyword">&gt;&gt;(</span><span class="default">31</span><span class="keyword">-</span><span class="default">$offset</span><span class="keyword">%</span><span class="default">32</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; elseif (</span><span class="default">$offset</span><span class="keyword">&lt;</span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset</span><span class="keyword">=</span><span class="default">abs</span><span class="keyword">(</span><span class="default">$offset</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num</span><span class="keyword">=((</span><span class="default">$num</span><span class="keyword">&gt;&gt;</span><span class="default">$offset</span><span class="keyword">%</span><span class="default">32</span><span class="keyword">) &amp; (</span><span class="default">$mask</span><span class="keyword">&gt;&gt;(-</span><span class="default">1</span><span class="keyword">+</span><span class="default">$offset</span><span class="keyword">%</span><span class="default">32</span><span class="keyword">))) | (</span><span class="default">$num</span><span class="keyword">&lt;&lt;(</span><span class="default">32</span><span class="keyword">-</span><span class="default">$offset</span><span class="keyword">%</span><span class="default">32</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$num</span><span class="keyword">; <br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84954""></a>
  <div class="note">
   <strong class="user">m0sh at hotmail dot com</strong>
   <a href="#84954" class="date">07-Aug-2008 09:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@greenone - nice function, thanks. I've adapted it for key usage:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">bitxor</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xorWidth </span><span class="keyword">= </span><span class="default">PHP_INT_SIZE</span><span class="keyword">*</span><span class="default">8</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// split<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$o1 </span><span class="keyword">= </span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$xorWidth</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$o2 </span><span class="keyword">= </span><span class="default">str_split</span><span class="keyword">(</span><span class="default">str_pad</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">), </span><span class="default">$key</span><span class="keyword">), </span><span class="default">$xorWidth</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$runs </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$o1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$runs</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">.= </span><span class="default">decbin</span><span class="keyword">(</span><span class="default">bindec</span><span class="keyword">(</span><span class="default">$o1</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) ^ </span><span class="default">bindec</span><span class="keyword">(</span><span class="default">$o2</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]));&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$res</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82344""></a>
  <div class="note">
   <strong class="user">bartbons at debster.nl</strong>
   <a href="#82344" class="date">07-Apr-2008 11:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@kendsnyder at gmail dot com<br />
<br />
Thanx for your great function. But your function is not 100% correct. It should be:<br />
<br />
function safeBitCheck($number,$comparison) {<br />
&nbsp;&nbsp;&nbsp; if( $number &lt; 2147483647 ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ($number &amp; $comparison)==$comparison;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $binNumber = strrev(base_convert($number,10,2));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $binComparison = strrev(base_convert($comparison,10,2));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for( $i=0; $i&lt;strlen($binComparison); $i++ ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( strlen($binNumber) - 1 &lt;$i || ($binComparison{$i}==="1" &amp;&amp; $binNumber{$i}==="0") ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return false;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return true;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
Mind the 'minus 1' on "if( strlen($binNumber) - 1 &lt;$i".<br />
<br />
cheers, Bart</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79662""></a>
  <div class="note">
   <strong class="user">forlamp at msn dot com</strong>
   <a href="#79662" class="date">07-Dec-2007 03:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
two's complement logical operation for 32-bit.<br />
<br />
$x must be (int) when passing it to this function to work properly.<br />
<br />
function comp2($x)&nbsp; &nbsp; &nbsp; // 32bit bitwise complement<br />
{<br />
&nbsp;&nbsp;&nbsp; $mask = 0x80000000;<br />
<br />
&nbsp;&nbsp;&nbsp; if ($x &lt; 0)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $x &amp;= 0x7FFFFFFF;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $x = ~$x;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $x ^ $mask;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $x = $x ^ 0x7FFFFFFF;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $x | $mask;<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73578""></a>
  <div class="note">
   <strong class="user">gcG</strong>
   <a href="#73578" class="date">02-Mar-2007 01:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
function xnor($a, $b) {<br />
&nbsp;&nbsp;&nbsp; return ~($a ^ $b);<br />
}<br />
XNOR is very usefull ;D</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73088""></a>
  <div class="note">
   <strong class="user">bryanagee at gmail dot com</strong>
   <a href="#73088" class="date">08-Feb-2007 08:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found the 31-bit limitation on the bitwise ands to be a bit frustrating in large scale permission control applications. I have a situation involving page-level access with more than 50 pages. I was able to workaround the limitation by adding a loop that dropped 31 bits off of the right until the resource identifier bit is within the first 31. <br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $userlevel </span><span class="keyword">= </span><span class="default">$session</span><span class="keyword">-&gt;</span><span class="default">userlevel </span><span class="keyword">- </span><span class="default">0</span><span class="keyword">;&nbsp; </span><span class="comment"># the subtraction ensures int type <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pg_code </span><span class="keyword">= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,(</span><span class="default">$pg_id</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$pg_code </span><span class="keyword">&gt;= </span><span class="default">2147483648</span><span class="keyword">)&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pg_code </span><span class="keyword">=&nbsp; </span><span class="default">$pg_code</span><span class="keyword">/</span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">31</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$userlevel </span><span class="keyword">= </span><span class="default">$session</span><span class="keyword">-&gt;</span><span class="default">userlevel</span><span class="keyword">/</span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">31</span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!(</span><span class="default">$userlevel </span><span class="keyword">- </span><span class="default">0 </span><span class="keyword">&amp; </span><span class="default">$pg_code</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">#if not authorized, show the unauthorized page<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Location: Unauthorized.php'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72300""></a>
  <div class="note">
   <strong class="user">zewt at hotmail dot com</strong>
   <a href="#72300" class="date">12-Jan-2007 08:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you use bitwise you MUST make sure your variables are integers, otherwise you can get incorrect results.<br />
<br />
I recommend ALWAYS<br />
<br />
(int)$var &amp; (int)$var2<br />
<br />
This will save you many headaches when troubleshooting a completely illogical result.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71145""></a>
  <div class="note">
   <strong class="user">rizal dot almashoor at gmail dot com</strong>
   <a href="#71145" class="date">14-Nov-2006 01:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following function will perform a 32-bit left shift on a 64-bit machine:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">leftshift32</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">, </span><span class="default">$steps</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$binary </span><span class="keyword">= </span><span class="default">decbin</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">).</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"0"</span><span class="keyword">, </span><span class="default">$steps</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$binary </span><span class="keyword">= </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$binary</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">, </span><span class="string">"0"</span><span class="keyword">, </span><span class="default">STR_PAD_LEFT</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$binary </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binary</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$binary</span><span class="keyword">) - </span><span class="default">32</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$binary</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">"1" </span><span class="keyword">? -(</span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">) - </span><span class="default">bindec</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$binary</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">))) : </span><span class="default">bindec</span><span class="keyword">(</span><span class="default">$binary</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61478""></a>
  <div class="note">
   <strong class="user">Xavier Daull</strong>
   <a href="#61478" class="date">04-Feb-2006 10:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Extract part of a binary data - due to windows system limitations (and this code), bit extracted length($firstbit to $lastbit included) is limited to 31 bits<br />
</span><span class="keyword">function </span><span class="default">sub_bindata</span><span class="keyword">(</span><span class="default">$mybindata</span><span class="keyword">, </span><span class="default">$firstbit </span><span class="keyword">= </span><span class="default">7</span><span class="keyword">, </span><span class="default">$lastbit </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$highestbitfirst </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// 1. Create a bit mask of the right size by triming left and right<br />
&nbsp;&nbsp;&nbsp; // 2. select bits by an AND on $mybindata<br />
&nbsp;&nbsp;&nbsp; // 3. shift right to get only length needed<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$highestbitfirst</span><span class="keyword">) return (((</span><span class="default">0x7FFFFFFF </span><span class="keyword">&gt;&gt; (</span><span class="default">30</span><span class="keyword">+</span><span class="default">$lastbit</span><span class="keyword">-</span><span class="default">$firstbit</span><span class="keyword">))&lt;&lt;(</span><span class="default">$lastbit</span><span class="keyword">)) &amp; </span><span class="default">$mybindata</span><span class="keyword">) &gt;&gt; (</span><span class="default">$lastbit</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; else return (((</span><span class="default">0x7FFFFFFF </span><span class="keyword">&gt;&gt; (</span><span class="default">30</span><span class="keyword">-</span><span class="default">$lastbit</span><span class="keyword">+</span><span class="default">$firstbit</span><span class="keyword">))&lt;&lt;(</span><span class="default">30</span><span class="keyword">-</span><span class="default">$lastbit</span><span class="keyword">)) &amp; </span><span class="default">$mybindata</span><span class="keyword">) &gt;&gt; (</span><span class="default">30</span><span class="keyword">-</span><span class="default">$lastbit</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61415""></a>
  <div class="note">
   <strong class="user">John L</strong>
   <a href="#61415" class="date">02-Feb-2006 11:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Bitwise operators are swell, but (a &amp; b &amp; c &amp; d) == a<br />
is not a way to test for four-way equality. If a is zero, it'll always be true, and in general it will be true any time a has no bits not also in the other three values.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58272""></a>
  <div class="note">
   <strong class="user">Nina Cording</strong>
   <a href="#58272" class="date">29-Oct-2005 06:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who were searching for a way to actually rotate the bits of a number, here are some little functions I wrote:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">bitRotate32</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">,</span><span class="default">$amount</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$amount</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$amount </span><span class="keyword">%= </span><span class="default">32</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= (</span><span class="default">$value</span><span class="keyword">&lt;&lt;</span><span class="default">$amount</span><span class="keyword">) | (</span><span class="default">$value</span><span class="keyword">&gt;&gt;(</span><span class="default">32</span><span class="keyword">-</span><span class="default">$amount</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; } elseif (</span><span class="default">$amount</span><span class="keyword">&lt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$amount </span><span class="keyword">= -</span><span class="default">$amount</span><span class="keyword">%</span><span class="default">32</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= (</span><span class="default">$value</span><span class="keyword">&gt;&gt;</span><span class="default">$amount</span><span class="keyword">) | (</span><span class="default">$value</span><span class="keyword">&lt;&lt;(</span><span class="default">32</span><span class="keyword">-</span><span class="default">$amount</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$value</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">bitRotate</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">,</span><span class="default">$amount</span><span class="keyword">,</span><span class="default">$bits</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mask </span><span class="keyword">= (</span><span class="default">$bits</span><span class="keyword">&lt;</span><span class="default">32</span><span class="keyword">) ? </span><span class="default">0x7fffffff </span><span class="keyword">&gt;&gt; (</span><span class="default">31</span><span class="keyword">-</span><span class="default">$bits</span><span class="keyword">) : </span><span class="default">0xffffffff</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$amount</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$amount </span><span class="keyword">%= </span><span class="default">$bits</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= (</span><span class="default">$value</span><span class="keyword">&lt;&lt;</span><span class="default">$amount</span><span class="keyword">) | (</span><span class="default">$value</span><span class="keyword">&gt;&gt;(</span><span class="default">$bits</span><span class="keyword">-</span><span class="default">$amount</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; } elseif (</span><span class="default">$amount</span><span class="keyword">&lt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$amount </span><span class="keyword">= -</span><span class="default">$amount</span><span class="keyword">%</span><span class="default">$bits</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= (</span><span class="default">$value</span><span class="keyword">&gt;&gt;</span><span class="default">$amount</span><span class="keyword">) | (</span><span class="default">$value</span><span class="keyword">&lt;&lt;(</span><span class="default">$bits</span><span class="keyword">-</span><span class="default">$amount</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$value </span><span class="keyword">&amp; </span><span class="default">$mask</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// test the rotation:<br />
<br />
</span><span class="default">$test </span><span class="keyword">= </span><span class="default">4123</span><span class="keyword">;<br />
for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">64</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">bitRotate</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">,-</span><span class="default">$i</span><span class="keyword">,</span><span class="default">8</span><span class="keyword">); </span><span class="comment">// rotates 8 bits to the left (-$amount)<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%032b&lt;br/&gt;"</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58190""></a>
  <div class="note">
   <strong class="user">zlel grxnslxves13 at hotmail dot com~=s/x/ee/g</strong>
   <a href="#58190" class="date">27-Oct-2005 04:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I refer to Eric Swanson's post on Perl VS PHP's implementation of xor. <br />
<br />
Actually, this is not an issue with the implementation of XOR,&nbsp; but a lot more to do with the lose-typing policy that PHP adopts. <br />
<br />
Freely switching between int and float is good for most cases, but problems happen when your value is near the word size of your machine. Which is to say, 32-bit machines will encounter problems with values that hover around 0x80000000 - primarily because PHP does not support unsigned integers.<br />
<br />
using bindec/decbin would address this issue as a work-around to do unsigned-int xor, but here's the real picture (i'm not claiming that this code will perform better, but this would be a better pedagogical code):<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">unsigned_xor32 </span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">) <br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a1 </span><span class="keyword">= </span><span class="default">$a </span><span class="keyword">&amp; </span><span class="default">0x7FFF0000</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a2 </span><span class="keyword">= </span><span class="default">$a </span><span class="keyword">&amp; </span><span class="default">0x0000FFFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a3 </span><span class="keyword">= </span><span class="default">$a </span><span class="keyword">&amp; </span><span class="default">0x80000000</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$b1 </span><span class="keyword">= </span><span class="default">$b </span><span class="keyword">&amp; </span><span class="default">0x7FFF0000</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$b2 </span><span class="keyword">= </span><span class="default">$b </span><span class="keyword">&amp; </span><span class="default">0x0000FFFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$b3 </span><span class="keyword">= </span><span class="default">$b </span><span class="keyword">&amp; </span><span class="default">0x80000000</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= (</span><span class="default">$a3 </span><span class="keyword">!= </span><span class="default">$b3</span><span class="keyword">) ? </span><span class="default">0x80000000 </span><span class="keyword">: </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ((</span><span class="default">$a1 </span><span class="keyword">^ </span><span class="default">$b1</span><span class="keyword">) |(</span><span class="default">$a2 </span><span class="keyword">^ </span><span class="default">$b2</span><span class="keyword">)) + </span><span class="default">$c</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$x </span><span class="keyword">= </span><span class="default">3851235679</span><span class="keyword">;<br />
</span><span class="default">$y </span><span class="keyword">= </span><span class="default">43814</span><span class="keyword">;<br />
echo </span><span class="string">"&lt;br&gt;This is the value we want"</span><span class="keyword">;<br />
echo </span><span class="string">"&lt;br&gt;3851262585"</span><span class="keyword">;<br />
<br />
echo </span><span class="string">"&lt;br&gt;The result of a native xor operation on integer values is treated as a signed integer"</span><span class="keyword">;<br />
echo </span><span class="string">"&lt;br&gt;"</span><span class="keyword">.(</span><span class="default">$x </span><span class="keyword">^ </span><span class="default">$y</span><span class="keyword">);<br />
<br />
echo </span><span class="string">"&lt;br&gt;We therefore perform the MSB separately"</span><span class="keyword">;<br />
echo </span><span class="string">"&lt;br&gt;"</span><span class="keyword">.</span><span class="default">unsigned_xor32</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
This is really foundation stuff, but for those of you who missed this in college, there seems to be something on 2's complement here: <br />
<br />
<a href="http://www.evergreen.edu/biophysics/technotes/program/2s_comp.htm" rel="nofollow" target="_blank">http://www.evergreen.edu/biophysics/technotes/program/2s_comp.htm</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58186""></a>
  <div class="note">
   <strong class="user">zlel</strong>
   <a href="#58186" class="date">27-Oct-2005 02:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here're my 32-bit carry-discarding operations for those of you porting encryption algorithms from C.<br />
<br />
Be warned that some of these are not very efficient compared to the native operations, especially when called by heavy-duty encryption algorithms - but not discarding the carry bit may not land you the same results you get in C, simply because PHP's bitwise operations were not designed to work on fixed-sized registers.<br />
<br />
(If your ported encryption algo still doen't give you the same results, remember to check your Endian-ness!)<br />
<br />
function _BF_SHR32 ($x, $bits)<br />
{<br />
&nbsp;&nbsp;&nbsp; if ($bits==0) return $x;<br />
&nbsp;&nbsp;&nbsp; if ($bits==32) return 0;<br />
&nbsp;&nbsp;&nbsp; $y = ($x &amp; 0x7FFFFFFF) &gt;&gt; $bits;<br />
&nbsp;&nbsp;&nbsp; if (0x80000000 &amp; $x) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $y |= (1&lt;&lt;(31-$bits));&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $y;<br />
}<br />
<br />
function _BF_SHL32 ($x, $bits)<br />
{<br />
&nbsp;&nbsp;&nbsp; if ($bits==0) return $x;<br />
&nbsp;&nbsp;&nbsp; if ($bits==32) return 0;<br />
&nbsp;&nbsp;&nbsp; $mask = (1&lt;&lt;(32-$bits)) - 1;<br />
&nbsp;&nbsp;&nbsp; return (($x &amp; $mask) &lt;&lt; $bits) &amp; 0xFFFFFFFF;<br />
}<br />
<br />
function _BF_GETBYTE ($x, $y) <br />
{<br />
&nbsp;&nbsp;&nbsp; return _BF_SHR32 ($x, 8 * $y) &amp; 0xFF;<br />
}<br />
<br />
function _BF_OR32 ($x, $y)<br />
{<br />
&nbsp;&nbsp;&nbsp; return ($x | $y) &amp; 0xFFFFFFFF;<br />
}<br />
<br />
function _BF_ADD32 ($x, $y)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; $x = $x &amp; 0xFFFFFFFF;<br />
&nbsp;&nbsp;&nbsp; $y = $y &amp; 0xFFFFFFFF;<br />
<br />
&nbsp;&nbsp;&nbsp; $total = 0;<br />
&nbsp;&nbsp;&nbsp; $carry = 0;<br />
&nbsp;&nbsp;&nbsp; for ($i=0; $i&lt;4; $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $byte_x = _BF_GETBYTE($x, $i);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $byte_y = _BF_GETBYTE($y, $i);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $sum = $byte_x + $byte_y;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $result = $sum &amp; 0xFF;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $carryforward = _BF_SHR32($sum, 8); <br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $sum = $result + $carry;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $result = $sum &amp; 0xFF;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $carry = $carryforward + _BF_SHR32($sum, 8); <br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $total = _BF_OR32(_BF_SHL32($result, $i*8), $total); <br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $total;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57281""></a>
  <div class="note">
   <strong class="user">Tbrendstrup</strong>
   <a href="#57281" class="date">29-Sep-2005 02:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
note that the shift operators are arithmetic, not logic like in C. You may get unexpected results with negative numbers, see <a href="http://en.wikipedia.org/wiki/Bitwise_operation" rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Bitwise_operation</a><br />
<br />
here's a function to do logic right shifts.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">lshiftright</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">,</span><span class="default">$amt</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mask </span><span class="keyword">= </span><span class="default">0x40000000</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$var </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$var </span><span class="keyword">&amp;= </span><span class="default">0x7FFFFFFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mask </span><span class="keyword">= </span><span class="default">$mask </span><span class="keyword">&gt;&gt; (</span><span class="default">$amt</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (</span><span class="default">$var </span><span class="keyword">&gt;&gt; </span><span class="default">$amt</span><span class="keyword">) | </span><span class="default">$mask</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$var </span><span class="keyword">&gt;&gt; </span><span class="default">$amt</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$val </span><span class="keyword">= -</span><span class="default">10</span><span class="keyword">;<br />
<br />
</span><span class="default">printf</span><span class="keyword">(</span><span class="string">"arithmetic shift on a negative integer&lt;br&gt;%1\$032b&lt;br&gt;%2\$032b&lt;br&gt;%1\$0d&lt;br&gt;%2\$0d&lt;br&gt;"</span><span class="keyword">,</span><span class="default">$val</span><span class="keyword">, </span><span class="default">$val </span><span class="keyword">&gt;&gt; </span><span class="default">1 </span><span class="keyword">);<br />
<br />
</span><span class="default">printf</span><span class="keyword">(</span><span class="string">"logic shift on a negative integer&lt;br&gt;%1\$032b&lt;br&gt;%2\$032b&lt;br&gt;%1\$0d&lt;br&gt;%2\$0d&lt;br&gt;"</span><span class="keyword">,</span><span class="default">$val</span><span class="keyword">, </span><span class="default">lshiftright</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">));<br />
<br />
</span><span class="default">printf</span><span class="keyword">(</span><span class="string">"logic shift on a positive integer&lt;br&gt;%1\$032b&lt;br&gt;%2\$032b&lt;br&gt;%1\$0d&lt;br&gt;%2\$0d&lt;br&gt;"</span><span class="keyword">,-</span><span class="default">$val</span><span class="keyword">, </span><span class="default">lshiftright</span><span class="keyword">(-</span><span class="default">$val</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
gives the output:<br />
<br />
arithmetic shift on a negative integer<br />
11111111111111111111111111110110<br />
11111111111111111111111111111011<br />
-10<br />
-5<br />
<br />
logic shift on a negative integer<br />
11111111111111111111111111110110<br />
01111111111111111111111111111011<br />
-10<br />
2147483643<br />
<br />
logic shift on a positive integer<br />
00000000000000000000000000001010<br />
00000000000000000000000000000101<br />
10<br />
5</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56382""></a>
  <div class="note">
   <strong class="user">Eric Swanson</strong>
   <a href="#56382" class="date">01-Sep-2005 02:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Perl vs. PHP implementation of the ^ operator:<br />
<br />
After attempting to translate a Perl module into PHP, I realized that Perl's implementation of the ^ operator is different than the PHP implementation.&nbsp; By default, Perl treats the variables as floats and PHP as integers.&nbsp; I was able to verify the PHP use of the operator by stating "use integer;" within the Perl module, which output the exact same result as PHP was using.<br />
<br />
The logical decision would be to cast every variable as (float) when using the ^ operator in PHP.&nbsp; However, this will not yield the same results.&nbsp; After about a half hour of banging my head against the wall, I discovered a gem and wrote a function using the binary-decimal conversions in PHP.<br />
<br />
/*<br />
not having much experience with bitwise operations, I cannot tell you that this is the BEST solution, but it certainly is a solution that finally works and always returns the EXACT same result Perl provides.<br />
*/<br />
function binxor($a, $b) {<br />
&nbsp;&nbsp;&nbsp; return bindec(decbin((float)$a ^ (float)$b));<br />
}<br />
<br />
//normal PHP code will not yeild the same result as Perl<br />
$result = 3851235679 ^ 43814; //= -443704711<br />
<br />
//to get the same result as Perl<br />
$result = binxor(3851235679, 43814); //= 3851262585<br />
//YIPPEE!!!<br />
<br />
//to see the differences, try the following<br />
$a = 3851235679 XOR 43814;<br />
$b = 3851235679 ^ 43814; //integer result<br />
$c = (float)3851235679 ^ (float)43814; //same as $b<br />
$d = binxor(3851235679, 43814); //same as Perl!!<br />
<br />
echo("A: $a&lt;br /&gt;");<br />
echo("B: $b&lt;br /&gt;");<br />
echo("C: $c&lt;br /&gt;");<br />
echo("D: $d&lt;br /&gt;");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52032""></a>
  <div class="note">
   <strong class="user"></strong>
   <a href="#52032" class="date">19-Apr-2005 04:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another practical case...<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; header</span><span class="keyword">(</span><span class="string">'Content-Type: text/plain'</span><span class="keyword">) ;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// We want to know the power-2 based numbers of $x<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">9124 </span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while ( </span><span class="default">$x </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$x </span><span class="keyword">&amp; </span><span class="default">1 </span><span class="keyword">== </span><span class="default">1 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$n</span><span class="keyword">, </span><span class="string">"\n" </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">*= </span><span class="default">2 </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">&gt;&gt;= </span><span class="default">1 </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Will output...<br />
&nbsp;&nbsp;&nbsp; // 4<br />
&nbsp;&nbsp;&nbsp; // 32<br />
&nbsp;&nbsp;&nbsp; // 128<br />
&nbsp;&nbsp;&nbsp; // 256<br />
&nbsp;&nbsp;&nbsp; // 512<br />
&nbsp;&nbsp;&nbsp; // 8192<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50622""></a>
  <div class="note">
   <strong class="user"></strong>
   <a href="#50622" class="date">05-Mar-2005 12:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A bitwise operators practical case :<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// We want to know the red, green and blue values of this color :<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">0xFEA946 </span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$red </span><span class="keyword">= </span><span class="default">$color </span><span class="keyword">&gt;&gt; </span><span class="default">16 </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$green </span><span class="keyword">= (</span><span class="default">$color </span><span class="keyword">&amp; </span><span class="default">0x00FF00</span><span class="keyword">) &gt;&gt; </span><span class="default">8 </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$blue </span><span class="keyword">= </span><span class="default">$color </span><span class="keyword">&amp; </span><span class="default">0x0000FF </span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">'Red : %X (%d), Green : %X (%d), Blue : %X (%d)'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$red</span><span class="keyword">, </span><span class="default">$red</span><span class="keyword">, </span><span class="default">$green</span><span class="keyword">, </span><span class="default">$green</span><span class="keyword">, </span><span class="default">$blue</span><span class="keyword">, </span><span class="default">$blue</span><span class="keyword">) ;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Will display...<br />
&nbsp;&nbsp;&nbsp; // Red : FE (254), Green : A9 (169), Blue : 46 (70)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50299""></a>
  <div class="note">
   <strong class="user">icy at digitalitcc dot com</strong>
   <a href="#50299" class="date">24-Feb-2005 08:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Say... you really want to have say... more than 31 bits available to you in your happy bitmask. And you don't want to use floats. So, one solution would to have an array of bitmasks, that are accessed through some kind of interface.<br />
<br />
Here is my solution for this: A class to store an array of integers being the bitmasks. It can hold up to 66571993087 bits, and frees up unused bitmasks when there are no bits being stored in them.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
&nbsp;&nbsp;&nbsp; Infinite* bits and bit handling in general.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; *Not infinite, sorry.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; Perceivably, the only limit to the bitmask class in storing bits would be<br />
&nbsp;&nbsp;&nbsp; the maximum limit of the index number, on 32 bit integer systems 2^31 - 1,<br />
&nbsp;&nbsp;&nbsp; so 2^31 * 31 - 1 = 66571993087 bits, assuming floats are 64 bit or something.<br />
&nbsp;&nbsp;&nbsp; I'm sure that's enough enough bits for anything.. I hope :D.<br />
*/<br />
<br />
</span><span class="default">DEFINE</span><span class="keyword">(</span><span class="string">'INTEGER_LENGTH'</span><span class="keyword">,</span><span class="default">31</span><span class="keyword">); </span><span class="comment">// Stupid signed bit.<br />
<br />
</span><span class="keyword">class </span><span class="default">bitmask<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$bitmask </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">set</span><span class="keyword">( </span><span class="default">$bit </span><span class="keyword">) </span><span class="comment">// Set some bit<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= (int) (</span><span class="default">$bit </span><span class="keyword">/ </span><span class="default">INTEGER_LENGTH</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bit </span><span class="keyword">= (int) </span><span class="default">fmod</span><span class="keyword">(</span><span class="default">$bit</span><span class="keyword">,</span><span class="default">INTEGER_LENGTH</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] |= </span><span class="default">1 </span><span class="keyword">&lt;&lt; </span><span class="default">$bit</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">remove</span><span class="keyword">( </span><span class="default">$bit </span><span class="keyword">) </span><span class="comment">// Remove some bit<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= (int) (</span><span class="default">$bit </span><span class="keyword">/ </span><span class="default">INTEGER_LENGTH</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bit </span><span class="keyword">= (int) </span><span class="default">fmod</span><span class="keyword">(</span><span class="default">$bit</span><span class="keyword">,</span><span class="default">INTEGER_LENGTH</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] &amp;= ~ (</span><span class="default">1 </span><span class="keyword">&lt;&lt; </span><span class="default">$bit</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">])<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">toggle</span><span class="keyword">( </span><span class="default">$bit </span><span class="keyword">) </span><span class="comment">// Toggle some bit<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= (int) (</span><span class="default">$bit </span><span class="keyword">/ </span><span class="default">INTEGER_LENGTH</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bit </span><span class="keyword">= (int) </span><span class="default">fmod</span><span class="keyword">(</span><span class="default">$bit</span><span class="keyword">,</span><span class="default">INTEGER_LENGTH</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] ^= </span><span class="default">1 </span><span class="keyword">&lt;&lt; </span><span class="default">$bit</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">])<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">read</span><span class="keyword">( </span><span class="default">$bit </span><span class="keyword">) </span><span class="comment">// Read some bit<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= (int) (</span><span class="default">$bit </span><span class="keyword">/ </span><span class="default">INTEGER_LENGTH</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bit </span><span class="keyword">= (int) </span><span class="default">fmod</span><span class="keyword">(</span><span class="default">$bit</span><span class="keyword">,</span><span class="default">INTEGER_LENGTH</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] &amp; (</span><span class="default">1 </span><span class="keyword">&lt;&lt; </span><span class="default">$bit</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">stringin</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) </span><span class="comment">// Read a string of bits that can be up to the maximum amount of bits long.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">str_split</span><span class="keyword">( </span><span class="default">strrev</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">), </span><span class="default">INTEGER_LENGTH </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$value </span><span class="keyword">= </span><span class="default">bindec</span><span class="keyword">(</span><span class="default">strrev</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">stringout</span><span class="keyword">() </span><span class="comment">// Print out a string of your nice little bits<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$keys </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sort</span><span class="keyword">(</span><span class="default">$keys</span><span class="keyword">, </span><span class="default">SORT_NUMERIC</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$keys</span><span class="keyword">);</span><span class="default">$i </span><span class="keyword">&gt;= </span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">--)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">.= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%0" </span><span class="keyword">. </span><span class="default">INTEGER_LENGTH </span><span class="keyword">. </span><span class="string">"b"</span><span class="keyword">,</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">clear</span><span class="keyword">() </span><span class="comment">// Purge!<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">debug</span><span class="keyword">() </span><span class="comment">// See what's going on in your bitmask array<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bitmask</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
It treats a positive integer input as a bit, so you don't have to deal with the powers of 2 yourself.<br />
<br />
<span class="default">&lt;?php<br />
$bitmask </span><span class="keyword">= new </span><span class="default">bitmask</span><span class="keyword">();<br />
<br />
</span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="default">8979879</span><span class="keyword">); </span><span class="comment">// Whatever<br />
<br />
</span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="default">888</span><span class="keyword">);<br />
<br />
if(</span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">read</span><span class="keyword">(</span><span class="default">888</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">'Happy!\n'</span><span class="keyword">;<br />
<br />
</span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">toggle</span><span class="keyword">(</span><span class="default">39393</span><span class="keyword">); </span><span class="comment">// Yadda yadda<br />
<br />
</span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">remove</span><span class="keyword">(</span><span class="default">888</span><span class="keyword">);<br />
<br />
</span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">debug</span><span class="keyword">();<br />
<br />
</span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">stringin</span><span class="keyword">(</span><span class="string">"100101000101001000101010010101010<br />
00000001000001"</span><span class="keyword">);<br />
<br />
print </span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">stringout</span><span class="keyword">() . </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">debug</span><span class="keyword">();<br />
<br />
</span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">clear</span><span class="keyword">();<br />
<br />
</span><span class="default">$bitmask</span><span class="keyword">-&gt;</span><span class="default">debug</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Would produce:<br />
<br />
Happy!<br />
<br />
array(2) {<br />
&nbsp; [289673]=&gt;<br />
&nbsp; int(65536)<br />
&nbsp; [1270]=&gt;<br />
&nbsp; int(8388608)<br />
}<br />
<br />
0000000000000001001010001010010001010100101010100<br />
0000001000001<br />
<br />
array(2) {<br />
&nbsp; [0]=&gt;<br />
&nbsp; int(355106881)<br />
&nbsp; [1]=&gt;<br />
&nbsp; int(37970)<br />
}<br />
<br />
array(0) {<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49231""></a>
  <div class="note">
   <strong class="user">louis /at/ mulliemedia.com</strong>
   <a href="#49231" class="date">20-Jan-2005 11:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the ^ operator, unlike in some other languages, is *not* the same as the pow() function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40107""></a>
  <div class="note">
   <strong class="user">richard-slater.co.uk</strong>
   <a href="#40107" class="date">22-Feb-2004 10:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those (like me) who are trying to do bit masking with very large numbers, here is a useful function to do the work for you.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">function </span><span class="default">isBitSet</span><span class="keyword">(</span><span class="default">$bitMask</span><span class="keyword">, </span><span class="default">$bitMap</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return (bool) </span><span class="default">gmp_intval</span><span class="keyword">(</span><span class="default">gmp_div</span><span class="keyword">(</span><span class="default">gmp_and</span><span class="keyword">(</span><span class="default">$bitMask</span><span class="keyword">, </span><span class="default">$bitMap</span><span class="keyword">),</span><span class="default">$bitMask</span><span class="keyword">));<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38019""></a>
  <div class="note">
   <strong class="user">krang at krang dot org dot uk</strong>
   <a href="#38019" class="date">04-Dec-2003 11:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hopefully this may help someone understand the fun of Bitwise Operators....<br />
<br />
The purpose of this function is to return a value from the GPC (Get, Post and Cookie) and do some basic formatting to it depending on the $VALIDATION value:<br />
<br />
<span class="default">&lt;?PHP<br />
<br />
&nbsp; </span><span class="keyword">function </span><span class="default">RETURN_SUBMITTED_VALUE </span><span class="keyword">(</span><span class="default">$VARIABLE</span><span class="keyword">, </span><span class="default">$METHOD</span><span class="keyword">, </span><span class="default">$VALIDATION</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; </span><span class="comment">//-------------------------------<br />
&nbsp;&nbsp; // Get the value from the<br />
&nbsp;&nbsp; // relevant submit method...<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">$METHOD </span><span class="keyword">== </span><span class="string">'POST'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (!isset(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">$VARIABLE</span><span class="keyword">])) </span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">$VARIABLE</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$VALUE </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">$VARIABLE</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; } elseif (</span><span class="default">$METHOD </span><span class="keyword">== </span><span class="string">'COOKIE'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (!isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$VARIABLE</span><span class="keyword">])) </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$VARIABLE</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$VALUE </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$VARIABLE</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (!isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="default">$VARIABLE</span><span class="keyword">])) </span><span class="default">$_GET</span><span class="keyword">[</span><span class="default">$VARIABLE</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$VALUE </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="default">$VARIABLE</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; </span><span class="comment">//-------------------------------<br />
&nbsp;&nbsp; // If necessary strip the slashes.<br />
&nbsp;&nbsp; // the "GPC" means - GET, POST<br />
&nbsp;&nbsp; // COOKIE.<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">ini_get </span><span class="keyword">(</span><span class="string">'magic_quotes_gpc'</span><span class="keyword">) == </span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$VALUE </span><span class="keyword">= </span><span class="default">stripslashes</span><span class="keyword">(</span><span class="default">$VALUE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; </span><span class="comment">//-------------------------------<br />
&nbsp;&nbsp; // Now for the different types<br />
&nbsp;&nbsp; // of VALIDATION's<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="keyword">if ((</span><span class="default">$VALIDATION </span><span class="keyword">&amp; </span><span class="default">8</span><span class="keyword">) == </span><span class="default">8</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$VALUE </span><span class="keyword">= (int)</span><span class="default">$VALUE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; if ((</span><span class="default">$VALIDATION </span><span class="keyword">&amp; </span><span class="default">4</span><span class="keyword">) == </span><span class="default">4</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$VALUE </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$VALUE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; if ((</span><span class="default">$VALIDATION </span><span class="keyword">&amp; </span><span class="default">2</span><span class="keyword">) == </span><span class="default">2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$VALUE </span><span class="keyword">= </span><span class="default">strip_tags</span><span class="keyword">(</span><span class="default">$VALUE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; if ((</span><span class="default">$VALIDATION </span><span class="keyword">&amp; </span><span class="default">1</span><span class="keyword">) == </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$VALUE </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$VALUE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; </span><span class="comment">//-------------------------------<br />
&nbsp;&nbsp; // Finally return the value<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">$VALUE</span><span class="keyword">;<br />
<br />
&nbsp; }<br />
<br />
&nbsp; echo </span><span class="default">RETURN_SUBMITTED_VALUE </span><span class="keyword">(</span><span class="string">'ID'</span><span class="keyword">, </span><span class="string">'GET'</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">) . </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="comment">// Convert to an Integer<br />
<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">RETURN_SUBMITTED_VALUE </span><span class="keyword">(</span><span class="string">'NAME'</span><span class="keyword">, </span><span class="string">'GET'</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">) . </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="comment">// Trim Whitespace and Strip HTML tags<br />
<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">RETURN_SUBMITTED_VALUE </span><span class="keyword">(</span><span class="string">'GENDER'</span><span class="keyword">, </span><span class="string">'GET'</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">) . </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="comment">// Strip HTML tags and convert to lower case<br />
<br />
&nbsp; //-----------------------------------------------<br />
&nbsp; // If this script was loaded under the URL<br />
&nbsp; // index.php?ID=19a&amp;NAME=Krang&amp;GENDER=MalE<br />
&nbsp; // it would print<br />
&nbsp; //<br />
&nbsp; // 19<br />
&nbsp; // Krang<br />
&nbsp; // male<br />
&nbsp; //-----------------------------------------------<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
For those that don?t understand binary, the numbers you see are not random, they double each time (1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024...) which allows you to mix and match the different function, eg...<br />
<br />
1 + 2 = 3 (Trim Whitespace + Strip HTML)<br />
2 + 4 = 6 (Strip HTML + Convert to lower case)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
