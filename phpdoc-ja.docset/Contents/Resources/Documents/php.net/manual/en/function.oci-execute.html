<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>文を実行する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.oci-error.html">≪ oci_error</a></li>
      <li style="float: right;"><a href="function.oci-fetch-all.html">oci_fetch_all ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.oci8.html">OCI8 関数</a></li>
    <li>文を実行する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.oci-execute" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">oci_execute</h1>
  <p class="verinfo">(PHP 5, PECL OCI8 &gt;= 1.1.0)</p><p class="refpurpose"><span class="refname">oci_execute</span> &mdash; <span class="dc-title">文を実行する</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.oci-execute-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>oci_execute</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$statement</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$mode</code><span class="initializer"> = OCI_COMMIT_ON_SUCCESS</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><a href="function.oci-parse.html" class="function">oci_parse()</a></span> が返した
   <code class="parameter">statement</code> を実行します。
  </p>
  <p class="para">
   実行後、<em>INSERT</em> 文などの場合はデフォルトでデータをデータベースにコミットします。
   <em>SELECT</em> 文などの場合は問い合わせを実行します。
   問い合わせの結果をその後 PHP で取得するには
   <span class="function"><a href="function.oci-fetch-array.html" class="function">oci_fetch_array()</a></span> などの関数を使います。
  </p>
  <p class="para">
   一度パースした文は何度でも実行することができ、
   これを使えば毎回パースするコストを節約することができます。
   この方法は、<span class="function"><a href="function.oci-bind-by-name.html" class="function">oci_bind_by_name()</a></span> でデータをバインドした
   <em>INSERT</em> 文で一般的に使われています。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.oci-execute-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">statement</code></dt>

     <dd>

      <p class="para">
       有効な OCI ステートメント ID。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">mode</code></dt>

     <dd>

      <p class="para">
        オプションの二番目のパラメータは、次の定数のいずれかとなります。
       <table class="doctable table">
        <caption><strong>実行モード</strong></caption>
        
         <thead>
          <tr>
           <th>定数</th>
           <th>説明</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td><strong><code>OCI_COMMIT_ON_SUCCESS</code></strong></td>
           <td>ステートメントの実行に成功すると、
             この接続においてまだ確定していない変更をすべてコミットします。
             これがデフォルトです。</td>
          </tr>

          <tr>
           <td><strong><code>OCI_DESCRIBE_ONLY</code></strong></td>
           <td><span class="function"><a href="function.oci-field-name.html" class="function">oci_field_name()</a></span>
             関数などでクエリのメタデータを使えるようにしますが、
             結果セットは作りません。続けて
             <span class="function"><a href="function.oci-fetch-array.html" class="function">oci_fetch_array()</a></span>
             などをコールすると失敗します。</td>
          </tr>

          <tr>
           <td><strong><code>OCI_NO_AUTO_COMMIT</code></strong></td>
           <td>変更を自動的にはコミットしません。PHP
             5.3.2 (PECL OCI8 1.4) より前のバージョンでは
             <strong><code>OCI_DEFAULT</code></strong> を使います。これは、
             <strong><code>OCI_NO_AUTO_COMMIT</code></strong> と同じ意味です。</td>
          </tr>

         </tbody>
        
       </table>

      </p>
      <p class="para">
       <strong><code>OCI_NO_AUTO_COMMIT</code></strong> モードを使うとトランザクションを開始あるいは続行します。
       接続を閉じたりスクリプトが終了したりしたときに、
       トランザクションは自動的にロールバックされます。
       トランザクションをコミットするには
       <span class="function"><a href="function.oci-commit.html" class="function">oci_commit()</a></span> を、破棄するには
       <span class="function"><a href="function.oci-rollback.html" class="function">oci_rollback()</a></span> をコールします。
      </p>
      <p class="para">
       データを追加したり更新したりする際には、
       リレーショナルデータの一貫性やパフォーマンスなどを考慮して
       トランザクションを使うことを推奨します。
      </p>
      <p class="para">
       <strong><code>OCI_NO_AUTO_COMMIT</code></strong> モードを使った文を実行した後に
       <span class="function"><a href="function.oci-commit.html" class="function">oci_commit()</a></span>
       あるいは <span class="function"><a href="function.oci-rollback.html" class="function">oci_rollback()</a></span> をコールしなかった場合、
       たとえデータが変更されていなくても
       スクリプトの終了時に OCI8 がロールバックを実行します。
       不要なロールバックを避けるために、多くのスクリプトはクエリや PL/SQL で
       <strong><code>OCI_NO_AUTO_COMMIT</code></strong> モードを使いません。
       同じスクリプトの中で異なるモードで
       <span class="function"><strong>oci_execute()</strong></span> を実行する場合は、
       アプリケーション内で適切なトランザクションの一貫性を確保するよう注意しましょう。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.oci-execute-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.oci-execute-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-2066">
    <p><strong>例1 <span class="function"><strong>oci_execute()</strong></span> での問い合わせの例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;employees'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #DD0000">"&lt;table&nbsp;border='1'&gt;\n"</span><span style="color: #007700">;<br />while&nbsp;(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">OCI_ASSOC</span><span style="color: #007700">+</span><span style="color: #0000BB">OCI_RETURN_NULLS</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;tr&gt;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$item</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;"&nbsp;</span><span style="color: #007700">.&nbsp;(</span><span style="color: #0000BB">$item&nbsp;</span><span style="color: #007700">!==&nbsp;</span><span style="color: #0000BB">null&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$item</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">ENT_QUOTES</span><span style="color: #007700">)&nbsp;:&nbsp;</span><span style="color: #DD0000">"&amp;nbsp;"</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;/td&gt;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;/tr&gt;\n"</span><span style="color: #007700">;<br />}<br />echo&nbsp;</span><span style="color: #DD0000">"&lt;/table&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2067">
    <p><strong>例2 モードを指定せずに <span class="function"><strong>oci_execute()</strong></span> を実行する例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">//&nbsp;実行する前にテーブルを作成します。<br />//&nbsp;&nbsp;&nbsp;CREATE&nbsp;TABLE&nbsp;MYTABLE&nbsp;(col1&nbsp;NUMBER);<br /><br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'INSERT&nbsp;INTO&nbsp;mytab&nbsp;(col1)&nbsp;VALUES&nbsp;(123)'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;結果はコミットされ、他のユーザーからもすぐに見えるようになります<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2068">
    <p><strong>例3 <span class="function"><strong>oci_execute()</strong></span> で <strong><code>OCI_NO_AUTO_COMMIT</code></strong> を使う例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">//&nbsp;実行する前にテーブルを作成します。<br />//&nbsp;&nbsp;&nbsp;CREATE&nbsp;TABLE&nbsp;MYTABLE&nbsp;(col1&nbsp;NUMBER);<br /><br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'INSERT&nbsp;INTO&nbsp;mytab&nbsp;(col1)&nbsp;VALUES&nbsp;(:bv)'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_bind_by_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">':bv'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">);<br />for&nbsp;(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;=&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">;&nbsp;++</span><span style="color: #0000BB">$i</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">OCI_NO_AUTO_COMMIT</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;PHP&nbsp;&lt;=&nbsp;5.3.1&nbsp;の場合は&nbsp;OCI_DEFAULT&nbsp;を使います<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">oci_commit</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;新しい値&nbsp;1,&nbsp;2,&nbsp;3,&nbsp;4,&nbsp;5&nbsp;をすべてコミットします<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2069">
    <p><strong>例4 <span class="function"><strong>oci_execute()</strong></span> でさまざまなコミットモードを使う例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">//&nbsp;実行する前にテーブルを作成します。<br />//&nbsp;&nbsp;&nbsp;CREATE&nbsp;TABLE&nbsp;MYTABLE&nbsp;(col1&nbsp;NUMBER);<br /><br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'INSERT&nbsp;INTO&nbsp;mytab&nbsp;(col1)&nbsp;VALUES&nbsp;(123)'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">OCI_NO_AUTO_COMMIT</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;データはコミットされません<br /><br /></span><span style="color: #0000BB">$stid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'INSERT&nbsp;INTO&nbsp;mytab&nbsp;(col1)&nbsp;VALUES&nbsp;(456)'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;123&nbsp;と&nbsp;456&nbsp;が両方コミットされます<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2070">
    <p><strong>例5 <span class="function"><strong>oci_execute()</strong></span> で
     <strong><code>OCI_DESCRIBE_ONLY</code></strong> を使う例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'hr'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'welcome'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'localhost/XE'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;locations'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$s</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">OCI_DESCRIBE_ONLY</span><span style="color: #007700">);<br />for&nbsp;(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;=&nbsp;</span><span style="color: #0000BB">oci_num_fields</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);&nbsp;++</span><span style="color: #0000BB">$i</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">oci_field_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br&gt;\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.oci-execute-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    トランザクションは接続を閉じたとき、
    もしくはスクリプトの終了時のいずれの場合でも
    すぐに自動的にロールバックされます。
    トランザクションをコミットするには
    <span class="function"><a href="function.oci-commit.html" class="function">oci_commit()</a></span> をコールする必要があります。
   </p>
   <p class="para">
    <strong><code>OCI_COMMIT_ON_SUCCESS</code></strong> モードを指定するか、
    あるいはデフォルトの状態で <span class="function"><strong>oci_execute()</strong></span> をコールすると、
    それ以前の未コミットのトランザクションをコミットします。
   </p>
   <p class="para">
    <em>CREATE</em> や <em>DROP</em> といった
    Oracle の DDL は、未コミットのトランザクションを自動的にコミットします。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    <span class="function"><strong>oci_execute()</strong></span> 関数は
    通常はステートメントをデータベースに送信するので、
    ステートメントの構文エラーなどを特定することもできます。
    軽量なローカル版の <span class="function"><a href="function.oci-parse.html" class="function">oci_parse()</a></span> ではこれはできません。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.oci-execute-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.oci-parse.html" class="function" rel="rdfs-seeAlso">oci_parse()</a> - 実行のために Oracle の文をパースする</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="103275""></a>
  <div class="note">
   <strong class="user">filipesampaio at hotmail dot com</strong>
   <a href="#103275" class="date">05-Apr-2011 02:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just to write it down. I was trying to do a simple SELECT on a Cache (<a href="http://www.intersystems.com/cache/" rel="nofollow" target="_blank">http://www.intersystems.com/cache/</a>) table through an Oracle dblink, but always received the error "ORA-01002: fetch out of sequence". The solution was using OCI_NO_AUTO_COMMIT on the oci_execute function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99578""></a>
  <div class="note">
   <strong class="user">tower98 at gmail dot com</strong>
   <a href="#99578" class="date">25-Aug-2010 10:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Notice (PHP 5.2.12-pl0-gentoo):
<br />
You can parse empty query, you can execute empty query (returns true), but you cannot fetch data from empty query. So, if you provide query as variable, make sure it isn't empty.
<br />

<br />
<span class="default">&lt;?php
<br />
$q </span><span class="keyword">= </span><span class="default">oci_parse</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">);
<br />
if(</span><span class="default">$q </span><span class="keyword">!= </span><span class="default">false</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// parsing empty query != false
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">oci_execute</span><span class="keyword">(</span><span class="default">$q</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// executing empty query != false
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">oci_fetch_all</span><span class="keyword">(</span><span class="default">$q</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">OCI_FETCHSTATEMENT_BY_ROW</span><span class="keyword">) == </span><span class="default">false</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// but fetching executed empty query results in error (ORA-24338: statement handle not executed)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">oci_error</span><span class="keyword">(</span><span class="default">$q</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">[</span><span class="string">'message'</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; else{
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">oci_error</span><span class="keyword">(</span><span class="default">$q</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">[</span><span class="string">'message'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
else{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">oci_error</span><span class="keyword">(</span><span class="default">$link</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">[</span><span class="string">'message'</span><span class="keyword">];
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
