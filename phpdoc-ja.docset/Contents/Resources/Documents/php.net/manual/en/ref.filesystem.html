<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>ファイルシステム 関数</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="filesystem.constants.html">≪ 定義済み定数</a></li>
      <li style="float: right;"><a href="function.basename.html">basename ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.filesystem.html">ファイルシステム</a></li>
    <li>ファイルシステム 関数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.filesystem" class="reference">
 <h1 class="title">ファイルシステム 関数</h1>

 <div class="partintro">
  <h1 class="title">参考</h1>
  <p class="simpara">
   関連する関数については、<a href="ref.dir.html" class="link">ディレクトリ
   </a>および<a href="ref.exec.html" class="link">プログラム実行</a>の節を
   参照してください。
  </p>
  <p class="simpara">
   リモートファイルとして使用することができる種々のURLラッパーの一覧
   と説明については、<a href="wrappers.html" class="xref">サポートするプロトコル/ラッパー</a>も参照してください。
  </p>
 </div>














































































































































































































































































































































































































































































































































































































































<h2>目次</h2><ul class="chunklist chunklist_reference"><li><a href="function.basename.html">basename</a> &mdash; パスの最後にある名前の部分を返す</li><li><a href="function.chgrp.html">chgrp</a> &mdash; ファイルのグループを変更する</li><li><a href="function.chmod.html">chmod</a> &mdash; ファイルのモードを変更する</li><li><a href="function.chown.html">chown</a> &mdash; ファイルの所有者を変更する</li><li><a href="function.clearstatcache.html">clearstatcache</a> &mdash; ファイルのステータスのキャッシュをクリアする</li><li><a href="function.copy.html">copy</a> &mdash; ファイルをコピーする</li><li><a href="function.delete.html">delete</a> &mdash; unlink か unset を参照してください</li><li><a href="function.dirname.html">dirname</a> &mdash; 親ディレクトリのパスを返す</li><li><a href="function.disk-free-space.html">disk_free_space</a> &mdash; ファイルシステムあるいはディスクパーティション上で利用可能な領域を返す</li><li><a href="function.disk-total-space.html">disk_total_space</a> &mdash; ファイルシステムあるいはディスクパーティションの全体サイズを返す</li><li><a href="function.diskfreespace.html">diskfreespace</a> &mdash; disk_free_space のエイリアス</li><li><a href="function.fclose.html">fclose</a> &mdash; オープンされたファイルポインタをクローズする</li><li><a href="function.feof.html">feof</a> &mdash; ファイルポインタがファイル終端に達しているかどうか調べる</li><li><a href="function.fflush.html">fflush</a> &mdash; 出力をファイルにフラッシュする</li><li><a href="function.fgetc.html">fgetc</a> &mdash; ファイルポインタから1文字取り出す</li><li><a href="function.fgetcsv.html">fgetcsv</a> &mdash; ファイルポインタから行を取得し、CSVフィールドを処理する</li><li><a href="function.fgets.html">fgets</a> &mdash; ファイルポインタから 1 行取得する</li><li><a href="function.fgetss.html">fgetss</a> &mdash; ファイルポインタから 1 行取り出し、HTML タグを取り除く</li><li><a href="function.file-exists.html">file_exists</a> &mdash; ファイルまたはディレクトリが存在するかどうか調べる</li><li><a href="function.file-get-contents.html">file_get_contents</a> &mdash; ファイルの内容を全て文字列に読み込む</li><li><a href="function.file-put-contents.html">file_put_contents</a> &mdash; 文字列をファイルに書き込む</li><li><a href="function.file.html">file</a> &mdash; ファイル全体を読み込んで配列に格納する</li><li><a href="function.fileatime.html">fileatime</a> &mdash; ファイルの最終アクセス時刻を取得する</li><li><a href="function.filectime.html">filectime</a> &mdash; ファイルの inode 変更時刻を取得する</li><li><a href="function.filegroup.html">filegroup</a> &mdash; ファイルのグループを取得する</li><li><a href="function.fileinode.html">fileinode</a> &mdash; ファイルの inode を取得する</li><li><a href="function.filemtime.html">filemtime</a> &mdash; ファイルの更新時刻を取得する</li><li><a href="function.fileowner.html">fileowner</a> &mdash; ファイルの所有者を取得する</li><li><a href="function.fileperms.html">fileperms</a> &mdash; ファイルのパーミッションを取得する</li><li><a href="function.filesize.html">filesize</a> &mdash; ファイルのサイズを取得する</li><li><a href="function.filetype.html">filetype</a> &mdash; ファイルタイプを取得する</li><li><a href="function.flock.html">flock</a> &mdash; 汎用のファイルロックを行う</li><li><a href="function.fnmatch.html">fnmatch</a> &mdash; ファイル名がパターンにマッチするか調べる</li><li><a href="function.fopen.html">fopen</a> &mdash; ファイルまたは URL をオープンする</li><li><a href="function.fpassthru.html">fpassthru</a> &mdash; ファイルポインタ上に残っているすべてのデータを出力する</li><li><a href="function.fputcsv.html">fputcsv</a> &mdash; 行を CSV 形式にフォーマットし、ファイルポインタに書き込む</li><li><a href="function.fputs.html">fputs</a> &mdash; fwrite のエイリアス</li><li><a href="function.fread.html">fread</a> &mdash; バイナリセーフなファイルの読み込み</li><li><a href="function.fscanf.html">fscanf</a> &mdash; フォーマットに基づきファイルからの入力を処理する</li><li><a href="function.fseek.html">fseek</a> &mdash; ファイルポインタを移動する</li><li><a href="function.fstat.html">fstat</a> &mdash; オープンしたファイルポインタからファイルに関する情報を取得する</li><li><a href="function.ftell.html">ftell</a> &mdash; ファイルの読み書き用ポインタの現在位置を返す</li><li><a href="function.ftruncate.html">ftruncate</a> &mdash; ファイルを指定した長さに丸める</li><li><a href="function.fwrite.html">fwrite</a> &mdash; バイナリセーフなファイル書き込み処理</li><li><a href="function.glob.html">glob</a> &mdash; パターンにマッチするパス名を探す</li><li><a href="function.is-dir.html">is_dir</a> &mdash; ファイルがディレクトリかどうかを調べる</li><li><a href="function.is-executable.html">is_executable</a> &mdash; ファイルが実行可能かどうかを調べる</li><li><a href="function.is-file.html">is_file</a> &mdash; 通常ファイルかどうかを調べる</li><li><a href="function.is-link.html">is_link</a> &mdash; ファイルがシンボリックリンクかどうかを調べる</li><li><a href="function.is-readable.html">is_readable</a> &mdash; ファイルが存在し、読み込み可能であるかどうかを知る</li><li><a href="function.is-uploaded-file.html">is_uploaded_file</a> &mdash; HTTP POST でアップロードされたファイルかどうかを調べる</li><li><a href="function.is-writable.html">is_writable</a> &mdash; ファイルが書き込み可能かどうかを調べる</li><li><a href="function.is-writeable.html">is_writeable</a> &mdash; is_writable のエイリアス</li><li><a href="function.lchgrp.html">lchgrp</a> &mdash; シンボリックリンクのグループ所有権を変更する</li><li><a href="function.lchown.html">lchown</a> &mdash; シンボリックリンクの所有者を変更する</li><li><a href="function.link.html">link</a> &mdash; ハードリンクを作成する</li><li><a href="function.linkinfo.html">linkinfo</a> &mdash; リンクに関する情報を取得する</li><li><a href="function.lstat.html">lstat</a> &mdash; ファイルあるいはシンボリックリンクの情報を取得する</li><li><a href="function.mkdir.html">mkdir</a> &mdash; ディレクトリを作る</li><li><a href="function.move-uploaded-file.html">move_uploaded_file</a> &mdash; アップロードされたファイルを新しい位置に移動する</li><li><a href="function.parse-ini-file.html">parse_ini_file</a> &mdash; 設定ファイルをパースする</li><li><a href="function.parse-ini-string.html">parse_ini_string</a> &mdash; 設定文字列をパースする</li><li><a href="function.pathinfo.html">pathinfo</a> &mdash; ファイルパスに関する情報を返す</li><li><a href="function.pclose.html">pclose</a> &mdash; プロセスのファイルポインタをクローズする</li><li><a href="function.popen.html">popen</a> &mdash; プロセスへのファイルポインタをオープンする</li><li><a href="function.readfile.html">readfile</a> &mdash; ファイルを出力する</li><li><a href="function.readlink.html">readlink</a> &mdash; シンボリックリンク先を返す</li><li><a href="function.realpath-cache-get.html">realpath_cache_get</a> &mdash; realpath キャッシュ・エントリーを取得</li><li><a href="function.realpath-cache-size.html">realpath_cache_size</a> &mdash; realpath キャッシュサイズを取得</li><li><a href="function.realpath.html">realpath</a> &mdash; 絶対パス名を返す</li><li><a href="function.rename.html">rename</a> &mdash; ファイルをリネームする</li><li><a href="function.rewind.html">rewind</a> &mdash; ファイルポインタの位置を先頭に戻す</li><li><a href="function.rmdir.html">rmdir</a> &mdash; ディレクトリを削除する</li><li><a href="function.set-file-buffer.html">set_file_buffer</a> &mdash; stream_set_write_buffer のエイリアス</li><li><a href="function.stat.html">stat</a> &mdash; ファイルに関する情報を取得する</li><li><a href="function.symlink.html">symlink</a> &mdash; シンボリックリンクを作成する</li><li><a href="function.tempnam.html">tempnam</a> &mdash; 一意なファイル名を生成する</li><li><a href="function.tmpfile.html">tmpfile</a> &mdash; テンポラリファイルを作成する</li><li><a href="function.touch.html">touch</a> &mdash; ファイルの最終アクセス時刻および最終更新日をセットする</li><li><a href="function.umask.html">umask</a> &mdash; 現在の umask を変更する</li><li><a href="function.unlink.html">unlink</a> &mdash; ファイルを削除する</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111670""></a>
  <div class="note">
   <strong class="user">ob at babcom dot biz</strong>
   <a href="#111670" class="date">15-Mar-2013 12:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a function based on "tunnelareaten at gmail dot com"s idea to search for files in a given directory by a searchstring or by fileextension.<br />
<br />
I added support to search recursively through all sub-directories an to determine weather the filepath should be returned or not.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// recursive function to get contents of given folder by searchterm or fileextension<br />
// (does not show folders)<br />
// standards: Foldername:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Searchterm:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Searchtype:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ext/search (file-extension or searchterm within filename)<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SaveCompletePath:&nbsp; &nbsp; &nbsp; &nbsp; true/1<br />
// usage:&nbsp; &nbsp;&nbsp; array FileSearch_r($Folder,$Search[,$SearchType,$SavePath])<br />
<br />
</span><span class="keyword">function </span><span class="default">FileSearch_r</span><span class="keyword">(</span><span class="default">$Dir</span><span class="keyword">,</span><span class="default">$Search</span><span class="keyword">,</span><span class="default">$SearchType</span><span class="keyword">=</span><span class="string">"search"</span><span class="keyword">,</span><span class="default">$SavePath</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$Array</span><span class="keyword">=array();<br />
&nbsp; </span><span class="default">$D</span><span class="keyword">=</span><span class="default">dir</span><span class="keyword">(</span><span class="default">$Dir</span><span class="keyword">);<br />
&nbsp; while (</span><span class="default">false</span><span class="keyword">!==(</span><span class="default">$Entry</span><span class="keyword">=</span><span class="default">$D</span><span class="keyword">-&gt;</span><span class="default">read</span><span class="keyword">()))<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$Entry</span><span class="keyword">!=</span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$Entry</span><span class="keyword">!=</span><span class="string">'..'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$Entry</span><span class="keyword">=</span><span class="default">$Dir</span><span class="keyword">.</span><span class="default">$Entry</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$Entry</span><span class="keyword">)) </span><span class="default">$Array</span><span class="keyword">=</span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$Array</span><span class="keyword">,</span><span class="default">FileSearch_r</span><span class="keyword">(</span><span class="default">$Entry</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">$Search</span><span class="keyword">,</span><span class="default">$SearchType</span><span class="keyword">,</span><span class="default">$SavePath</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$SearchType</span><span class="keyword">==</span><span class="string">"search"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">?</span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$Entry</span><span class="keyword">,</span><span class="default">$Search</span><span class="keyword">)&gt;</span><span class="default">0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">:(</span><span class="default">$SearchType</span><span class="keyword">==</span><span class="string">"ext"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">?</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$Entry</span><span class="keyword">,-</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$Search</span><span class="keyword">))===</span><span class="default">$Search<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">:</span><span class="default">true</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Array</span><span class="keyword">[]=</span><span class="default">$Entry</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; </span><span class="default">$D</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
&nbsp; </span><span class="default">sort</span><span class="keyword">(</span><span class="default">$Array</span><span class="keyword">,</span><span class="default">SORT_STRING</span><span class="keyword">);<br />
&nbsp; if(!(bool)</span><span class="default">$SavePath</span><span class="keyword">) </span><span class="default">$Array</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$Dir</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$Array</span><span class="keyword">));<br />
&nbsp; return </span><span class="default">$Array</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91075""></a>
  <div class="note">
   <strong class="user">drapeko.com</strong>
   <a href="#91075" class="date">24-May-2009 03:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You have an array of directories (straightforward list of directories):
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; &nbsp; $array </span><span class="keyword">= array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home/drapeko/var'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home/drapeko/var/y'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home/drapeko'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/home'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'/var/libexec'
<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; );
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
And you would like to transform this array to hierarchy of directories:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;$array </span><span class="keyword">= array (
<br />
&nbsp;&nbsp; &nbsp; </span><span class="string">'home' </span><span class="keyword">=&gt; array (
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'drapeko' </span><span class="keyword">=&gt; array (
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'var' </span><span class="keyword">=&gt; array (
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'y' </span><span class="keyword">=&gt; array()
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; )
<br />
&nbsp;&nbsp; &nbsp; ),
<br />
&nbsp;&nbsp; &nbsp; </span><span class="string">'var' </span><span class="keyword">=&gt; array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'libexec' </span><span class="keyword">=&gt; array()
<br />
&nbsp;&nbsp; &nbsp; )
<br />
&nbsp;);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
How can you do it?
<br />

<br />
First of all the below function will help us.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* This function converts real filesystem path to the string array representation.
<br />
&nbsp;*
<br />
&nbsp;* for example,
<br />
&nbsp;* '/home/drapeko/var/y&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; will be converted to&nbsp; &nbsp; $result_array['home']['drapeko']['var']['y']
<br />
&nbsp;* '/home/drapeko/var/y/file.txt&nbsp;&nbsp; will be converted to&nbsp; &nbsp; &nbsp;&nbsp; $result_array['home']['drapeko']['var']['y']
<br />
&nbsp;*
<br />
&nbsp;* @param $path&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; realpath of the directory
<br />
&nbsp;* @return string&nbsp; &nbsp; &nbsp; &nbsp; string array representation of the path
<br />
&nbsp;*/
<br />
</span><span class="keyword">function </span><span class="default">pathToArrayStr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// TODO constants/configs?
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$res_path </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">':/'</span><span class="keyword">, </span><span class="string">':\\'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">), </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// if the first or last symbol is '/' delete it (e.g. for linux)
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$res_path </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(array(</span><span class="string">"/^\//"</span><span class="keyword">, </span><span class="string">"/\/$/"</span><span class="keyword">), </span><span class="string">''</span><span class="keyword">, </span><span class="default">$res_path</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// create string
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$res_path </span><span class="keyword">= </span><span class="string">'[\''</span><span class="keyword">.</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'\'][\''</span><span class="keyword">, </span><span class="default">$res_path</span><span class="keyword">).</span><span class="string">'\']'</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">$res_path</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
It simply converts the real path of the file to array string representation.
<br />

<br />
How can you use this function? I know it looks like a little confusing. But it's quite simple. Consider the example below:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;$result </span><span class="keyword">= array();
<br />
&nbsp;</span><span class="default">$check </span><span class="keyword">= array();
<br />
&nbsp;foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$val</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">pathToArrayStr</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">, </span><span class="string">'result'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; foreach(</span><span class="default">$check </span><span class="keyword">as </span><span class="default">$ck</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$ck</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue </span><span class="default">2</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }
<br />
&nbsp;&nbsp; &nbsp; }
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$check</span><span class="keyword">[] = </span><span class="default">$str</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; eval(</span><span class="string">'$result'</span><span class="keyword">.</span><span class="default">$str</span><span class="keyword">.</span><span class="string">' = array();'</span><span class="keyword">);
<br />
&nbsp;}
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Heh, how do you find it? This approach has helped me very much. I hope you will find it useful. :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73954""></a>
  <div class="note">
   <strong class="user">Christian</strong>
   <a href="#73954" class="date">17-Mar-2007 06:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just learned that, to specify file names in a portable manner, you DON'T need 'DIRECTORY_SEPARATOR' - just use '/'. This really surprised and shocked me, as until now I typed about a zillion times 'DIRECTORY_SEPARATOR' to stay platform independent - unnecessary. Don't make the same mistake.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50360""></a>
  <div class="note">
   <strong class="user">tunnelareaten at gmail dot com</strong>
   <a href="#50360" class="date">25-Feb-2005 05:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made this function to search and/or display files by extension or for a string occurance in the filename. Any comments or enhancements are welcome offcourse. I'll update this function soon.<br />
<br />
usage: list_files([string], [string], [int 1 | 0], [int 1 | 0]);<br />
<br />
search for extension: list_files([string], [string], [0], [int 1 | 0]);<br />
returns array: $myArray = list_files([string], [string], [0], [0]);<br />
echo result: list_files([string], [string], [0], [1]);<br />
<br />
search for string occurance: list_files([string], [string], [1], [int 1 | 0]);<br />
returns array: $myArray = list_files([string], [string], [1], [0]);<br />
echo result: list_files([string], [string], [1], [1]);<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">list_files</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">, </span><span class="default">$stringSearch</span><span class="keyword">, </span><span class="default">$searchHandler</span><span class="keyword">, </span><span class="default">$outputHandler</span><span class="keyword">) {<br />
&nbsp;</span><span class="default">$errorHandler </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;</span><span class="default">$result </span><span class="keyword">= array();<br />
&nbsp;if (! </span><span class="default">$directoryHandler </span><span class="keyword">= @</span><span class="default">opendir </span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">)) {<br />
&nbsp; echo (</span><span class="string">"&lt;pre&gt;\nerror: directory \"</span><span class="default">$directory</span><span class="string">\" doesn't exist!\n&lt;/pre&gt;\n"</span><span class="keyword">);<br />
&nbsp;return </span><span class="default">$errorHandler </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;}<br />
&nbsp;if (</span><span class="default">$searchHandler </span><span class="keyword">=== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$fileName </span><span class="keyword">= @</span><span class="default">readdir </span><span class="keyword">(</span><span class="default">$directoryHandler</span><span class="keyword">))) {<br />
&nbsp;&nbsp; if(@</span><span class="default">substr </span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, - @</span><span class="default">strlen </span><span class="keyword">(</span><span class="default">$stringSearch</span><span class="keyword">)) === </span><span class="default">$stringSearch</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">array_push </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$fileName</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp;}<br />
&nbsp;if (</span><span class="default">$searchHandler </span><span class="keyword">=== </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp; while(</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$fileName </span><span class="keyword">= @</span><span class="default">readdir </span><span class="keyword">(</span><span class="default">$directoryHandler</span><span class="keyword">))) {<br />
&nbsp;&nbsp; if(@</span><span class="default">substr_count </span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="default">$stringSearch</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">array_push </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$fileName</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp;}<br />
&nbsp;if ((</span><span class="default">$errorHandler </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) &amp;&amp;&nbsp; (@</span><span class="default">count </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">)) {<br />
&nbsp; echo (</span><span class="string">"&lt;pre&gt;\nerror: no filetype \"</span><span class="default">$fileExtension</span><span class="string">\" found!\n&lt;/pre&gt;\n"</span><span class="keyword">);<br />
&nbsp;}<br />
&nbsp;else {<br />
&nbsp; </span><span class="default">sort </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
&nbsp; if (</span><span class="default">$outputHandler </span><span class="keyword">=== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; if (</span><span class="default">$outputHandler </span><span class="keyword">=== </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; echo (</span><span class="string">"&lt;pre&gt;\n"</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">print_r </span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
&nbsp;&nbsp; echo (</span><span class="string">"&lt;/pre&gt;\n"</span><span class="keyword">); <br />
&nbsp; }<br />
&nbsp;}<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35196""></a>
  <div class="note">
   <strong class="user">Gregor Mosheh</strong>
   <a href="#35196" class="date">23-Aug-2003 02:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function searches a directory and returns an array of all files whose filename matches the specified regular expression. It's similar in concept to the Unix find program.<br />
<br />
&nbsp;function findfile($location='',$fileregex='') {<br />
&nbsp;&nbsp;&nbsp; if (!$location or !is_dir($location) or !$fileregex) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; return false;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;<br />
&nbsp;&nbsp;&nbsp; $matchedfiles = array();<br />
&nbsp;<br />
&nbsp;&nbsp;&nbsp; $all = opendir($location);<br />
&nbsp;&nbsp;&nbsp; while ($file = readdir($all)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; if (is_dir($location.'/'.$file) and $file &lt;&gt; ".." and $file &lt;&gt; ".") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $subdir_matches = findfile($location.'/'.$file,$fileregex);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $matchedfiles = array_merge($matchedfiles,$subdir_matches);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset($file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; elseif (!is_dir($location.'/'.$file)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (preg_match($fileregex,$file)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array_push($matchedfiles,$location.'/'.$file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; closedir($all);<br />
&nbsp;&nbsp;&nbsp; unset($all);<br />
&nbsp;&nbsp;&nbsp; return $matchedfiles;<br />
&nbsp;}<br />
<br />
$htmlfiles = findfile('/some/dir','/\.(htm|html)$/');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32089""></a>
  <div class="note">
   <strong class="user">mitra at mitra dot biz</strong>
   <a href="#32089" class="date">16-May-2003 07:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Pollard@php.net contributed this in response to a question on setting these variables ...<br />
This option *IS* settable within your PHP scripts.<br />
Example:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; ini_set</span><span class="keyword">(</span><span class="string">'auto_detect_line_endings'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$contents </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="string">'unknowntype.txt'</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'auto_detect_line_endings'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$content2 </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="string">'unixfile.txt'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Note, with PHP 4.3 anytime Mac files are read using fgets or file you'll need to auto_detect_line_endings since \n is otherwise assumed.&nbsp; However, with PHP 5.0, stream_get_line() will allow you to specify what line ending character to read up to.<br />
<br />
\\ Read a line from a MAC file<br />
stream_get_line($fp, 4096, "\r"); <br />
<br />
\\ Read a line from a UNIX file<br />
stream_get_line($fp, 4096, "\n"); <br />
<br />
\\ Read a line from a DOS file<br />
stream_get_line($fp, 4096, "\r\n"); <br />
<br />
\\ Read a line up to any filesystem line ending<br />
ini_set('auto_detect_line_endings', true); fgets($fp); <br />
<br />
\\ You can also make up your own line ending characters:<br />
\\ Read up to the first instance of ":"<br />
stream_get_line($fp, 4096, ":");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30924""></a>
  <div class="note">
   <strong class="user">regis at webstuff dot com dot br</strong>
   <a href="#30924" class="date">03-Apr-2003 04:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a useful function if you're having trouble writing raw bytes into a file. <br />
<br />
It receives an integer and returns an array containing the ASCII values of the bytes on each index of the array.<br />
<br />
function int2bytes($number){<br />
&nbsp; $byte = $number;<br />
&nbsp; $i=0;<br />
&nbsp; do{<br />
&nbsp;&nbsp;&nbsp; $dec_tmp = $byte;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $byte = bcdiv($byte,256,0);<br />
&nbsp;&nbsp;&nbsp; $resto = $dec_tmp - (256 * $byte);<br />
&nbsp;&nbsp;&nbsp; $return[] = $resto;<br />
&nbsp; } while($byte &gt;= 256);<br />
&nbsp; if($byte) $return[] = $byte;<br />
&nbsp; return array_reverse($return);<br />
}<br />
<br />
Example:<br />
<br />
$arr = int2bytes(75832);<br />
<br />
$arr will contain the following values:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; 40<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; 56<br />
)<br />
<br />
Now, to write this data to the file, just use a fputs() with chr(), just like this:<br />
<br />
fputs($fp,chr($arr[0]).chr($arr[1]).chr($arr[2]))<br />
<br />
-- Regis</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30152""></a>
  <div class="note">
   <strong class="user">jdhurn at uberidx dot com</strong>
   <a href="#30152" class="date">08-Mar-2003 04:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a function I use to determine if a file contains Binary information. I use this for my search engine so that it doesn't try to index files like .zip or .mp3 or any other file that doesn't contain readable information. It makes use of the Character Type Extension if it's loaded, if it's not then it uses Regular Expressions.<br />
<br />
function is_binary($link)<br />
{<br />
&nbsp;&nbsp; &nbsp; $tmpStr&nbsp; = '';<br />
&nbsp;&nbsp; &nbsp; @$fp&nbsp; &nbsp;&nbsp; = fopen($link, 'rb');<br />
&nbsp;&nbsp; &nbsp; @$tmpStr = fread($fp, 256);<br />
&nbsp;&nbsp; &nbsp; @fclose($fp);<br />
<br />
&nbsp;&nbsp; &nbsp; if($tmpStr != '')<br />
&nbsp;&nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tmpStr = str_replace(chr(10), '', $tmpStr);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tmpStr = str_replace(chr(13), '', $tmpStr);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tmpInt = 0;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for($i =0; $i &lt; strlen($tmpStr); $i++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( extension_loaded('ctype') )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( !ctype_print($tmpStr[$i]) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpInt++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( !eregi("[[:print:]]+", $tmpStr[$i]) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpInt++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($tmpInt &gt; 5)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(0);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(1);<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return(0);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
