<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>指定した名前で画像を書き込む</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="imagick.whitethresholdimage.html">≪ Imagick::whiteThresholdImage</a></li>
      <li style="float: right;"><a href="imagick.writeimagefile.html">Imagick::writeImageFile ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.imagick.html">Imagick</a></li>
    <li>指定した名前で画像を書き込む</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="imagick.writeimage" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Imagick::writeImage</h1>
  <p class="verinfo">(PECL imagick 0.9.0-0.9.9)</p><p class="refpurpose"><span class="refname">Imagick::writeImage</span> &mdash; <span class="dc-title">指定した名前で画像を書き込む</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-imagick.writeimage-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>Imagick::writeImage</strong></span>
    ([ <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code><span class="initializer"> = NULL</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   指定した名前で画像を書き込みます。filename パラメータが NULL の場合は、
   Imagick::readImage() あるいは Imagick::setImageFilename()
   で設定した名前で書き込みます。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-imagick.writeimage-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
       画像を書き出すファイル名。ファイルの拡張子で画像形式が決まります。
       &quot;jpg:test.png&quot; のようにプレフィックスをつけると、拡張子が何であっても特定の形式で保存できます。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-imagick.writeimage-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を返します。
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115359""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#115359" class="date">11-Jul-2014 07:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I opened image with Imagick::readImageBlob. When I wanted to save resized image Imagick::writeImage did not work, but Imagick::writeImageFile did.<br />
<br />
$image = new Imagick();<br />
$image-&gt;readImageBlob($image_data);<br />
// $image-&gt;writeImage($fileDst)&nbsp; &nbsp; did not work<br />
if($f=fopen($fileDst, "w")){ <br />
&nbsp; $image-&gt;writeImageFile($f);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114714""></a>
  <div class="note">
   <strong class="user">SkepticaLee</strong>
   <a href="#114714" class="date">27-Mar-2014 11:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When running Imagick as packaged with the Abyss Web Server, neither this method nor writeImages () works. Instead the format has to be declared and the file saved by using another method or procedure, e.g.:<br />
<br />
<span class="default">&lt;?php<br />
$im </span><span class="keyword">= new </span><span class="default">Imagick </span><span class="keyword">();<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">newImage </span><span class="keyword">(</span><span class="default">300</span><span class="keyword">, </span><span class="default">225</span><span class="keyword">, </span><span class="string">"blue"</span><span class="keyword">);<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">writeImage </span><span class="keyword">(</span><span class="string">"test_0.jpg"</span><span class="keyword">); </span><span class="comment">// fails with no error message<br />
//instead<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">setImageFormat </span><span class="keyword">(</span><span class="string">"jpeg"</span><span class="keyword">);<br />
</span><span class="default">file_put_contents </span><span class="keyword">(</span><span class="string">"test_1.jpg"</span><span class="keyword">, </span><span class="default">$im</span><span class="keyword">); </span><span class="comment">// works, or:<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">imageWriteFile </span><span class="keyword">(</span><span class="default">fopen </span><span class="keyword">(</span><span class="string">"test_2.jpg"</span><span class="keyword">, </span><span class="string">"wb"</span><span class="keyword">)); </span><span class="comment">//also works<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110703""></a>
  <div class="note">
   <strong class="user">pfz at pfzone dot org</strong>
   <a href="#110703" class="date">25-Nov-2012 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With Imagick 3.1.0RC2, PHP4.8<br />
If you plan to overwrite the file you're working on, before doing writeImage, consider clearing the file buffer before the write statement : <br />
<br />
<span class="default">&lt;?php<br />
$image </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">(</span><span class="default">$your_file</span><span class="keyword">);<br />
</span><span class="comment">/* some processing */<br />
<br />
</span><span class="default">clearstatcache</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$your_file</span><span class="keyword">));<br />
</span><span class="comment">// or<br />
</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$your_file</span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">writeImage</span><span class="keyword">(</span><span class="default">$your_file</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>It happened to me that the resulting file size was wrong. This could lead to truncation, as the file is not expanded.<br />
This happened while working on JPEG, and PNG. <br />
<br />
this line worked for me without this hack. <br />
<span class="default">&lt;?php<br />
file_put_contents</span><span class="keyword">(</span><span class="default">$your_file</span><span class="keyword">, </span><span class="default">$image</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Do not rely on getImageLength() for sending your image, especially when keepalive is ON. Content length is then relevant, and must be set. If the wrong size is given, your image will be truncated.<br />
Use filesize($your_file_) once written or strlen($image) instead (which renders your image and updates getImageLength() result).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104112""></a>
  <div class="note">
   <strong class="user">icinagle at gmail dot com</strong>
   <a href="#104112" class="date">24-May-2011 03:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are trying to manipulate a uploaded file and then save the file all in the same request with Apache + mod_dav this will fail.<br />
mod_dav puts a lock on the file during the request where the file is uploaded so trying to save the smallest file, e.g. 1kb will fail with a "Failed to allocate memory" error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
