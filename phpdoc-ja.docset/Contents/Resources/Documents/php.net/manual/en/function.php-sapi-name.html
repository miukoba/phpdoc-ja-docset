<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>ウェブサーバーと PHP の間のインターフェイスの型を返す</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.php-logo-guid.html">≪ php_logo_guid</a></li>
      <li style="float: right;"><a href="function.php-uname.html">php_uname ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.info.html">PHP オプション/情報 関数</a></li>
    <li>ウェブサーバーと PHP の間のインターフェイスの型を返す</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.php-sapi-name" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">php_sapi_name</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.1, PHP 5)</p><p class="refpurpose"><span class="refname">php_sapi_name</span> &mdash; <span class="dc-title">ウェブサーバーと PHP の間のインターフェイスの型を返す</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.php-sapi-name-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>php_sapi_name</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   PHP が使用しているインターフェイス (サーバー API、SAPI)
   の型を小文字の文字列で返します。たとえば、CLI 版の PHP ではこの文字列は
   &quot;cli&quot; となります。Apache と組み合わせて使用している場合は、
   実際に使用している SAPI によってさまざまな結果となります。
   返されうる値の一覧を以下にあげます。
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.php-sapi-name-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   インターフェイスの型を小文字の文字列で返します。
  </p>
  <p class="para">
   これがすべてではありませんが、以下のような値が返されます。
   <em>aolserver</em>, <em>apache</em>, 
   <em>apache2filter</em>, <em>apache2handler</em>, 
   <em>caudium</em>, <em>cgi</em> (PHP 5.3 まで), 
   <em>cgi-fcgi</em>, <em>cli</em>, <em>cli-server</em>,
   <em>continuity</em>, <em>embed</em>,
   <em>isapi</em>, <em>litespeed</em>, 
   <em>milter</em>, <em>nsapi</em>, 
   <em>phttpd</em>, <em>pi3web</em>, <em>roxen</em>,
   <em>thttpd</em>, <em>tux</em> そして <em>webjames</em>
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.php-sapi-name-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-526">
    <p><strong>例1 <span class="function"><strong>php_sapi_name()</strong></span> の例</strong></p>
    <div class="example-contents"><p>
     この例では、文字列の一部に <em>cgi</em>
     が含まれるかどうかを調べています。というのも
     <em>cgi-fcgi</em> となることもあり得るからです。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$sapi_type&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">php_sapi_name</span><span style="color: #007700">();<br />if&nbsp;(</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$sapi_type</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #DD0000">'cgi'</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"CGI&nbsp;版の&nbsp;PHP&nbsp;を使用しています\n"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"CGI&nbsp;版の&nbsp;PHP&nbsp;を使用していません\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.php-sapi-name-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <strong>別の方法</strong><br />
   <p class="para">
    PHP の定数 <strong><code>PHP_SAPI</code></strong> は、
    <span class="function"><strong>php_sapi_name()</strong></span> と同じ値となります。
   </p>
  </p></blockquote>
  <div class="tip"><strong class="tip">ヒント</strong>
   <h1 class="title">失敗しがちな点</h1>
   <p class="para">
    定義されている <acronym title="Server Application Programming Interface">SAPI</acronym> は、わかりやすいものばかりではないかもしれません。
    たとえば <em>apache</em> の場合は
    <em>apache2handler</em> や <em>apache2filter</em>
    と定義されることもあります。
   </p>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.php-sapi-name-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><a href="reserved.constants.html#reserved.constants.core" class="link">PHP_SAPI</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="114295""></a>
  <div class="note">
   <strong class="user">hajo-p</strong>
   <a href="#114295" class="date">04-Feb-2014 07:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
some not yet mentioned sapi names:<br />
<br />
cli-server -&gt; php built-in webserver<br />
srv -&gt; hhvm</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89858""></a>
  <div class="note">
   <strong class="user">michal at roszka dot pl</strong>
   <a href="#89858" class="date">26-Mar-2009 10:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The php_sapi_name() function is extremely useful when you want to determine the type of interface. There is, however, one more gotcha you need to be aware of while designing your application or deploying it to an unknown server.<br />
<br />
Whenever something depends on the type of interface, make sure your check is conclusive. Especially when you want to distinguish the command line interface (CLI) from the common gateway interface (CGI).<br />
<br />
Note, that the php-cgi binary can be called from the command line, from a shell script or as a cron job as well! If so, the php_sapi_name() will always return the same value (i.e. "cgi-fcgi") instead of "cli" which you could expect.<br />
<br />
Bad things happen to good people. Do not always expect /usr/bin/php to be a link to php-cli binary.<br />
<br />
Luckily the contents of the $_SERVER and the $_ENV superglobal arrays depends on whether the php-cgi binary is called from the command line interface (by a shell script, by the cron, etc.) or by some HTTP server (i.e. lighttpd).<br />
<br />
<span class="default">&lt;?php<br />
var_dump</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Try to call php-cgi binary from the command line interface and then via HTTP request and compare the output of the script above. There will be plenty options to satisfy almost everyone.<br />
<br />
For the sake of security remember, that contents of the $_SERVER and the $_ENV superglobal arrays (as well as $_GET, $_POST, $_COOKIE, $_FILES and $_REQUEST) should be considered tainted.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85380""></a>
  <div class="note">
   <strong class="user">Ysangkok</strong>
   <a href="#85380" class="date">27-Aug-2008 11:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function can also return "cli" if PHP was launched from CLI. Useful if one wants to behave differently when running in console.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
