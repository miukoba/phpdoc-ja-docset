<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>指定したデータソースに保存されたテーブルの名前のリストを取得する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.odbc-tableprivileges.html">≪ odbc_tableprivileges</a></li>
      <li style="float: right;"><a href="book.pdo.html">PDO ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.uodbc.html">ODBC 関数</a></li>
    <li>指定したデータソースに保存されたテーブルの名前のリストを取得する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.odbc-tables" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">odbc_tables</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">odbc_tables</span> &mdash; <span class="dc-title">指定したデータソースに保存されたテーブルの名前のリストを取得する</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.odbc-tables-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>odbc_tables</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$connection_id</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$qualifier</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$owner</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$name</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$types</code></span>
  ]]]] )</div>

  <p class="para rdfs-comment">
   指定した範囲の全てのテーブルリストを得ます。
  </p>
  <p class="para">
   限定子、所有者、テーブル名を数えるために、
   <code class="parameter">qualifier</code>、<code class="parameter">owner</code>、
   <code class="parameter">name</code>、<code class="parameter">table_type</code>
   について以下のような特別な記号が使用可能です。
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">qualifier</code> がパーセント記号 (%) のみで、
      <code class="parameter">owner</code> および <code class="parameter">name</code>
      が空文字列であった場合、結果にはそのデータソースに関する
      有効な限定子のリスト (<strong><code>NULL</code></strong> を有する TABLE_QUALIFIER カラム以外の
      全てのカラム)が含まれます。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">owner</code> がパーセント記号 (%) のみで、
      <code class="parameter">qualifier</code> および
      <code class="parameter">name</code> が空文字列の場合、結果にはその
      データソースに関する有効な所有者のリスト (<strong><code>NULL</code></strong> を有する
      TABLE_OWNER カラム以外の全てのカラム) が含まれます。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">table_type</code> がパーセント記号 (%) のみで、
      <code class="parameter">qualifier</code>、<code class="parameter">owner</code>、
      <code class="parameter">name</code> が空文字列の場合、結果にはそのデータソースに
      関する有効なテーブル型のリスト (<strong><code>NULL</code></strong> を有する TABLE_TYPE
      カラム以外の全てのカラム) が含まれます。
     </span>
    </li>
   </ul>
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.odbc-tables-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">connection_id</code></dt>

     <dd>

      <p class="para">ODBC 接続 ID。詳細は
<span class="function"><a href="function.odbc-connect.html" class="function">odbc_connect()</a></span> を参照ください。</p>
     </dd>

    
    
     <dt>
<code class="parameter">qualifier</code></dt>

     <dd>

      <p class="para">
       修飾子。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">owner</code></dt>

     <dd>

      <p class="para">
       所有者。
       検索パターン (ゼロ以上の文字にマッチする &#039;%&#039; や単一の文字にマッチする &#039;_&#039;)
       を指定可能です。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">name</code></dt>

     <dd>

      <p class="para">
       名前。
       検索パターン (ゼロ以上の文字にマッチする &#039;%&#039; や単一の文字にマッチする &#039;_&#039;)
       を指定可能です。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">types</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">table_type</code> が空の文字列ではない場合、検索する型に
       ついてカンマで区切った値のリストを指定する必要があります。
       各値は、シングルクオート(&#039;)で括るかまたは括らない形で指定可能です。
       例えば、&quot;&#039;TABLE&#039;,&#039;VIEW&#039;&quot; または &quot;TABLE, VIEW&quot; となります。データソースが
       が指定したテーブル型をサポートしていない場合、
       <span class="function"><strong>odbc_tables()</strong></span> はその型についていかなる結果も
       返しません。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.odbc-tables-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   情報を含んでいる ODBC 結果 ID を返します。
  失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
  <p class="para">
   結果セットのカラムは次のようになります。
   <ul class="itemizedlist">
    <li class="listitem"><span class="simpara">TABLE_QUALIFIER</span></li>
    <li class="listitem"><span class="simpara">TABLE_OWNER</span></li>
    <li class="listitem"><span class="simpara">TABLE_NAME</span></li>
    <li class="listitem"><span class="simpara">TABLE_TYPE</span></li>
    <li class="listitem"><span class="simpara">REMARKS</span></li>
   </ul>
  </p>
  <p class="simpara">
   結果セットは TABLE_TYPE、TABLE_QUALIFIER、TABLE_OWNER、TABLE_NAME
   の順番になります。
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.odbc-tables-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.odbc-tableprivileges.html" class="function" rel="rdfs-seeAlso">odbc_tableprivileges()</a> - 各テーブルのリストおよび関連する権限のリストを取得する</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="58482""></a>
  <div class="note">
   <strong class="user">narcomweb at wanadoo dot fr</strong>
   <a href="#58482" class="date">05-Nov-2005 06:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here a Code for listing Table names<br />
<span class="default">&lt;?php<br />
$dbh </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="default">$dsn</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pwd</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">odbc_tables</span><span class="keyword">(</span><span class="default">$dbh</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; </span><span class="default">$tables </span><span class="keyword">= array();<br />
&nbsp;&nbsp; while (</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; if(</span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,</span><span class="string">"TABLE_TYPE"</span><span class="keyword">)==</span><span class="string">"TABLE"</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo</span><span class="string">"&lt;br&gt;"</span><span class="keyword">.</span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,</span><span class="string">"TABLE_NAME"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span>You don't have views or System tables with.<br />
Only simple tables in your database.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55018""></a>
  <div class="note">
   <strong class="user">pmains at ux dot com</strong>
   <a href="#55018" class="date">22-Jul-2005 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This probably works for a variety of formats, but if you want a list of *just* the table names from an SQL dsn source (I'm using MSSQL), here's the code.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment"># ... assign $dsn, $uid, &amp; $pwd ...<br />
<br />
</span><span class="default">$dbh </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="default">$dsn</span><span class="keyword">, </span><span class="default">$uid</span><span class="keyword">, </span><span class="default">$pwd</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">odbc_tables</span><span class="keyword">(</span><span class="default">$dbh</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tables </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$tables</span><span class="keyword">, </span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="string">"TABLE_NAME"</span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$tables </span><span class="keyword">as </span><span class="default">$t </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$t</span><span class="string">\n"</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40362""></a>
  <div class="note">
   <strong class="user">iggvopvantoodlwin</strong>
   <a href="#40362" class="date">01-Mar-2004 04:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With regard to the note made on results not working.<br />
Test the database with the easy:<br />
<br />
odbc_result_all(odbc_tables($db));<br />
<br />
$db is obviously a connected batadase. Then start to experiment:<br />
<br />
if(!$odbcr=odbc_tables($db,"udb","", "%", "'TABLE'"))<br />
<br />
"udb" is the DNS - aka 'name of my ODBC database in the Windows ODBC thingamy'. In result_all the full path was shown but I just used the name I assigned; either should work.<br />
<br />
The second parameter "" is listed by result_all as "TABLE_SCHEM" and all items were "NULL", so I have put "".<br />
<br />
The third parameter is "%". According to result_all this col is "TABLE_NAME", so I could have put the name of one of my tables, i.e. "Address".<br />
<br />
In my case I have an Access database setup with several tables. In ODBC I have created a link. Running the all on everything result above shows a set of system tables which I do not need to know about at this point so I look at the result and then build my new table check using the "TABLE" string as the tables I am interested in are listed as "TABLE" under their "TABLE_TYPE" column.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27586""></a>
  <div class="note">
   <strong class="user">kthejoker at nospam dot hotmail dot com</strong>
   <a href="#27586" class="date">12-Dec-2002 07:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A bit of an extension on the previous posts:<br />
<br />
I had a whale of a time trying to make this command work .. the parameters were hard to decipher, and frequently my Apache module would just crash and burn when I tried to run it. I FINALLY figured out what was wrong ...<br />
<br />
&lt; -- assuming $conn is your odbc_connect ---&gt;<br />
<br />
$tablelist=odbc_tables($conn);<br />
$tablelist=odbc_result_all($tablelist);<br />
<br />
simply doesn't work. I don't understand the exact logistics of it, but the only way I could get it to post the results was this:<br />
<br />
$tablelist=odbc_result_all(odbc_tables($conn));<br />
<br />
From there it was rather simple to add in parameters that fished out the results I wanted. <br />
<br />
To repeat again: I do not understand why the 2nd method works and the 1st one does not. However, having struggled mightily with this function for almost 24 hours, posting this solution has proven to be greatly satisfying.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="11870""></a>
  <div class="note">
   <strong class="user">liquidicee at hotmail dot com</strong>
   <a href="#11870" class="date">11-Mar-2001 05:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's how to get a list of all the tables in your database.. with an actual example of how its done and how to get the results.. and you don't need to put in schema and all that other crap
<br />

<br />
<span class="default">&lt;?php
<br />
$conn </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="string">"</span><span class="default">$database</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$username</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$password</span><span class="string">"</span><span class="keyword">);
<br />
</span><span class="default">$tablelist </span><span class="keyword">= </span><span class="default">odbc_tables</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);
<br />
while (</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$tablelist</span><span class="keyword">)) {
<br />
if (</span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$tablelist</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">) == </span><span class="string">"TABLE"</span><span class="keyword">)
<br />
echo </span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$tablelist</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">) .</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
to understand what the above is doing,
<br />
use odbc_result_all($tablelist); this will show you EVERYTHING returned by odbc_tables() then you can look through it and see better how odbc_tables() works and what exactly it returns in the string to get a better idea on how to deal with it.
<br />
it would have saved me alot of time if i would have just taken a look at the full string returned by odbc_tables(), so i suggest you take the minute or two and look... here is an example of how to do it..which would have been helpful for me ;x.
<br />

<br />
<span class="default">&lt;?php
<br />
$conn </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="string">"</span><span class="default">$database</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$username</span><span class="string">"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$password</span><span class="string">"</span><span class="keyword">);
<br />
</span><span class="default">$tablelist </span><span class="keyword">= </span><span class="default">odbc_tables</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);
<br />
while (</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$tablelist</span><span class="keyword">)) {
<br />
echo </span><span class="default">odbc_result_all</span><span class="keyword">(</span><span class="default">$tablelist</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
hopefully this will help some people.. i have alot more to add about this but no time :(
<br />
so again hope this helps.
<br />
Liquidice</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="8868""></a>
  <div class="note">
   <strong class="user">fmk at swwwing dot com</strong>
   <a href="#8868" class="date">03-Oct-2000 09:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
use odbc_tables($con, "%") to get a list of all available catalogs (databases).
<br />

<br />
use odbc_tables($con, "", "%") to get a list of all schemas available.
<br />

<br />
use odbc_tables($con, "", "", "", "%") to get a list of all table types available.
<br />

<br />
use odbc_tables($con, "my catalog", "my schema", "%", "'TABLE', 'VIEW'") to get a list of all tables available.
<br />

<br />
using odbc_tables($con, "%", "%", "%", "%") will return an empty array !
<br />

<br />
Before PHP 4.0.3 uou could use this function with 1 or 5 prarms. From 4.0.3 the function matches the documentation.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
