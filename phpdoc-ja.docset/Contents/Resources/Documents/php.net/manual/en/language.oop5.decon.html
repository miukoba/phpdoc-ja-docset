<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>コンストラクタとデストラクタ</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="language.oop5.autoload.html">≪ クラスのオートローディング</a></li>
      <li style="float: right;"><a href="language.oop5.visibility.html">アクセス権 ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.oop5.html">クラスとオブジェクト</a></li>
    <li>コンストラクタとデストラクタ</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="language.oop5.decon" class="sect1">
 <h2 class="title">コンストラクタとデストラクタ</h2>

 <div class="sect2" id="language.oop5.decon.constructor">
  <h3 class="title">コンストラクタ</h3>
   <div class="methodsynopsis dc-description" id="object.construct">
    <span class="type"><span class="type void">void</span></span> <span class="methodname"><strong>__construct</strong></span>
     ([ <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$args</code><span class="initializer"> = &quot;&quot;</span></span>
    [, <span class="methodparam"> <code class="parameter">$...</code></span>
   ]] )</div>

  <p class="para">
   PHP 5 では、開発者がクラスのコンストラクタメソッドを宣言することが
   できます。コンストラクタメソッドを有するクラスは、新たにオブジェクトが
   生成される度にこのメソッドをコールします。これにより、
   そのオブジェクトを使用する前に必要な初期化を行うことができます。
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <span class="simpara">
    子クラスがコンストラクタを有している場合、親クラスのコンストラクタが
    暗黙の内にコールされることはありません。
    親クラスのコンストラクタを実行するには、子クラスのコンストラクタの
    中で <span class="function"><strong>parent::__construct()</strong></span> をコールすることが
    必要です。
    子クラスでコンストラクタを定義していない場合は、親クラスのコンストラクタを継承します
    (ただし、private 宣言されている場合は除く)。
    これは、通常のクラスメソッドと同様です。
   </span>
  </p></blockquote>
  <div class="example" id="example-202">
   <p><strong>例1 新しい統一されたコンストラクタを使用する</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">BaseClass&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"In&nbsp;BaseClass&nbsp;constructor\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;}<br />}<br /><br />class&nbsp;</span><span style="color: #0000BB">SubClass&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">BaseClass&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">parent</span><span style="color: #007700">::</span><span style="color: #0000BB">__construct</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"In&nbsp;SubClass&nbsp;constructor\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;}<br />}<br /><br />class&nbsp;</span><span style="color: #0000BB">OtherSubClass&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">BaseClass&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;BaseClass&nbsp;のコンストラクタを継承します<br /></span><span style="color: #007700">}<br /><br /></span><span style="color: #FF8000">//&nbsp;In&nbsp;BaseClass&nbsp;constructor<br /></span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">BaseClass</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;In&nbsp;BaseClass&nbsp;constructor<br />//&nbsp;In&nbsp;SubClass&nbsp;constructor<br /></span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SubClass</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;In&nbsp;BaseClass&nbsp;constructor<br /></span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">OtherSubClass</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  <p class="para">
   下位互換性を維持するため、PHP 5 が指定されたクラスの
   <a href="language.oop5.decon.html#object.construct" class="link">__construct()</a> 関数をみつけられなくて、
   かつそれが親クラスのコンストラクタを継承していない場合には、
   古い形式のコンストラクタ関数、つまり、そのクラスの名前と同じ関数が探されます。
   実際、互換性の問題が発生する可能性があるのは、
   そのクラスが <a href="language.oop5.decon.html#object.construct" class="link">__construct()</a> という名前のメソッドを
   有しており、それが異なる用途で使用されている場合です。
  </p>
   <p class="para">
    他のメソッドと異なり、親の <a href="language.oop5.decon.html#object.construct" class="link">__construct()</a>
    と異なるパラメータで <a href="language.oop5.decon.html#object.construct" class="link">__construct()</a>
    をオーバーライドしても PHP は
    <strong><code>E_STRICT</code></strong> エラーメッセージを出しません。
   </p>
   <p class="para">
    PHP 5.3.3 以降、名前空間つきのクラス名の最後の部分と同じ名前のメソッドは
    コンストラクタとみなされなくなりました。
    名前空間を使っていないクラスは今までと変わりません。
   </p>
   <div class="example" id="example-203">
    <p><strong>例2 名前空間つきのクラスのコンストラクタ</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">Foo</span><span style="color: #007700">;<br />class&nbsp;</span><span style="color: #0000BB">Bar&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">Bar</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;PHP&nbsp;5.3.0-5.3.2&nbsp;までは、これはコンストラクタとみなされました<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;PHP&nbsp;5.3.3&nbsp;以降は、これはコンストラクタにはなりません<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
 </div>

 <div class="sect2" id="language.oop5.decon.destructor">
  <h3 class="title">デストラクタ</h3>
   <div class="methodsynopsis dc-description" id="object.destruct">
   <span class="type"><span class="type void">void</span></span> <span class="methodname"><strong>__destruct</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="para">
   PHP 5 では、C++ のような他のオブジェクト指向言語に似た概念のデストラクタが
   導入されました。デストラクタメソッドは、
   特定のオブジェクトを参照するリファレンスがひとつもなくなったときにコールされます。
   あるいは、スクリプトの終了時にも順不同でコールされます。
  </p>
  <div class="example" id="example-204">
   <p><strong>例3 デストラクタの例</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">MyDestructableClass&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"In&nbsp;constructor\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"MyDestructableClass"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">__destruct</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"Destroying&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">MyDestructableClass</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  <p class="para">
   コンストラクタと同様、親クラスのデストラクタがエンジンにより暗黙のうちに
   コールされるということはありません。親クラスのデストラクタを実行するには、
   デストラクタの中で明示的に <span class="function"><strong>parent::__destruct()</strong></span>
   をコールする必要があります。
   また、コンストラクタと同様、子クラスでデストラクタを定義していない場合は
   親クラスのデストラクタを継承します。
  </p>
   <p class="para">
    <span class="function"><a href="function.exit.html" class="function">exit()</a></span>
    でスクリプトの実行を止めた場合にもデストラクタはコールされます。
    デストラクタの内部で <span class="function"><a href="function.exit.html" class="function">exit()</a></span> をコールすると、
    それ以降のシャットダウンルーチンを実行しません。
   </p>
   <blockquote class="note"><p><strong class="note">注意</strong>: 
    <p class="para">
     スクリプトのシャットダウン時にデストラクタがコールされた場合は、
     HTTP ヘッダはすでに送信されています。スクリプトのシャットダウン時の作業ディレクトリは、
     SAPI によっては (たとえば Apache など) 異なります。
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">注意</strong>: 
    <p class="para">
     デストラクタの中から (スクリプトの終了処理時に)
     例外をスローしようとすると、致命的なエラーを引き起こします。
    </p>
   </p></blockquote>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115271""></a>
  <div class="note">
   <strong class="user">mattsch at gmail dot com</strong>
   <a href="#115271" class="date">25-Jun-2014 11:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I would advise against the use of exceptions within __construct.&nbsp; If you store the error code for an exception within a function of that class, you have no way of reading that error code to tell what type of exception it is because the object does not exist yet.<br />
<br />
Checking the code cannot be accomplished if an exception is thrown in the construct:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">FooException </span><span class="keyword">extends </span><span class="default">Exception<br />
</span><span class="keyword">{<br />
}<br />
class </span><span class="default">Foo </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$bar</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$baz</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$foo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$foo </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">FooException</span><span class="keyword">(</span><span class="string">'An error occured in construct'</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">errorConstruct</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">setBar</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bar </span><span class="keyword">= </span><span class="string">'baz'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">setBaz</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">baz </span><span class="keyword">= </span><span class="string">'foo'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; final public function </span><span class="default">errorFooNotSet</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
try {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">setBar</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">setBaz</span><span class="keyword">();<br />
} catch (</span><span class="default">FooException $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// This will error because the object doesn't exist yet<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getCode</span><span class="keyword">() == </span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">errorFooNotSet</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'foo is not set'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Checking the code can be accomplished if an exception is not thrown in the construct:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">FooException </span><span class="keyword">extends </span><span class="default">Exception<br />
</span><span class="keyword">{<br />
}<br />
class </span><span class="default">Foo </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$bar</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$baz</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$foo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">init</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$foo </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">FooException</span><span class="keyword">(</span><span class="string">'An error occured in construct'</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">errorConstruct</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">setBar</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">init</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">bar </span><span class="keyword">= </span><span class="string">'baz'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">setBaz</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">init</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">baz </span><span class="keyword">= </span><span class="string">'foo'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; final public function </span><span class="default">errorFooNotSet</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
try {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">setBar</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">setBaz</span><span class="keyword">();<br />
} catch (</span><span class="default">FooException $e</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// This will work because the object does exist<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getCode</span><span class="keyword">() == </span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">errorFooNotSet</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'foo is not set'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114963""></a>
  <div class="note">
   <strong class="user">kayvin86 at live dot com</strong>
   <a href="#114963" class="date">07-May-2014 02:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
putting in more layman's term<br />
<br />
class dad{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function __construct() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo get_class($this) . ' is fair and tall &lt;br&gt;';<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
//inherit and overidding parent constructor<br />
class son extends dad{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function __construct(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; parent::__construct();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo get_class($this) . ' is handsome &lt;br&gt;';<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
//overidding parent constructor<br />
class daughter extends dad{<br />
&nbsp;&nbsp;&nbsp; function __construct(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo get_class($this) . ' is tan like her mother &lt;br&gt;';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo get_class($this) . ' is pretty and has nothing to do with dad &lt;br&gt;';<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
echo 'im dad: &lt;br&gt;';<br />
$dad = new dad();<br />
<br />
echo '&lt;br&gt;';<br />
<br />
echo 'born a son: &lt;br&gt;';<br />
$son = new son();<br />
<br />
echo '&lt;br&gt;';<br />
<br />
echo 'born a daughter: &lt;br&gt;';<br />
$daughter = new daughter();<br />
<br />
/*output<br />
im dad:<br />
dad is fair and tall<br />
<br />
born a son:<br />
son is fair and tall (notice that when parent:: is call inside son, son will be the class inside dad's contructor)<br />
son is handsome<br />
<br />
born a daughter:<br />
daughter is tan like her mother<br />
daughter is pretty and has nothing to do with dad<br />
&nbsp;*/</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113968""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#113968" class="date">23-Dec-2013 10:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
By inheriting from this class, you can do constructor overloading in terms of type hinting.<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">abstract class </span><span class="default">OverloadedConstructors </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp;&nbsp; public final function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$self </span><span class="keyword">= new </span><span class="default">ReflectionClass</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$constructors </span><span class="keyword">= </span><span class="default">array_filter</span><span class="keyword">(</span><span class="default">$self</span><span class="keyword">-&gt;</span><span class="default">getMethods</span><span class="keyword">(</span><span class="default">ReflectionMethod</span><span class="keyword">::</span><span class="default">IS_PUBLIC</span><span class="keyword">), function(</span><span class="default">ReflectionMethod $m</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$m</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">11</span><span class="keyword">) === </span><span class="string">'__construct'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; });<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$constructors</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'The class ' </span><span class="keyword">. </span><span class="default">get_called_class</span><span class="keyword">() . </span><span class="string">' does not provide a valid constructor.'</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$number </span><span class="keyword">= </span><span class="default">func_num_args</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$arguments </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$constructors </span><span class="keyword">as </span><span class="default">$constructor</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if((</span><span class="default">$number </span><span class="keyword">&gt;= </span><span class="default">$constructor</span><span class="keyword">-&gt;</span><span class="default">getNumberOfRequiredParameters</span><span class="keyword">()) &amp;&amp;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="default">$number </span><span class="keyword">&lt;= </span><span class="default">$constructor</span><span class="keyword">-&gt;</span><span class="default">getNumberOfParameters</span><span class="keyword">())) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$parameters </span><span class="keyword">= </span><span class="default">$constructor</span><span class="keyword">-&gt;</span><span class="default">getParameters</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$parameters</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach(</span><span class="default">$arguments </span><span class="keyword">as </span><span class="default">$arg</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parameter </span><span class="keyword">= </span><span class="default">current</span><span class="keyword">(</span><span class="default">$parameters</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$parameter</span><span class="keyword">-&gt;</span><span class="default">isArray</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }elseif((</span><span class="default">$expectedClass </span><span class="keyword">= </span><span class="default">$parameter</span><span class="keyword">-&gt;</span><span class="default">getClass</span><span class="keyword">()) !== </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!(</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">) &amp;&amp; </span><span class="default">$expectedClass</span><span class="keyword">-&gt;</span><span class="default">isInstance</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">next</span><span class="keyword">(</span><span class="default">$parameters</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$constructor</span><span class="keyword">-&gt;</span><span class="default">invokeArgs</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">, </span><span class="default">$arguments</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'The required constructor for the class ' </span><span class="keyword">. </span><span class="default">get_called_class</span><span class="keyword">() . </span><span class="string">' did not exist.'</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span>Simply define a class like this:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">class </span><span class="default">Test </span><span class="keyword">extends </span><span class="default">OverloadedConstructors </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp;&nbsp; public function </span><span class="default">__construct1</span><span class="keyword">(array </span><span class="default">$arg</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; die(</span><span class="string">'First construct'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; public function </span><span class="default">__construct2</span><span class="keyword">(</span><span class="default">stdClass $test</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; die(</span><span class="string">'Second construct'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; public function </span><span class="default">__construct3</span><span class="keyword">(</span><span class="default">$optional </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; die(</span><span class="string">'Third construct'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span>You can define as much constructors as you wish and limit them by php's type hinting. Note that the constructor signatures should be non-ambiguous.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113380""></a>
  <div class="note">
   <strong class="user">kitchin</strong>
   <a href="#113380" class="date">04-Oct-2013 07:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your code has a redundant constructor for PHP 4 compatibility, an E_STRICT error may be raised in PHP 5.x:<br />
<br />
Strict Standards:&nbsp; Redefining already defined constructor for class...<br />
<br />
What is a redundant constructor for PHP 4 compatibility? It looks like<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">Class </span><span class="default">Foo </span><span class="keyword">{<br />
&nbsp; function </span><span class="default">Foo</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">__construct</span><span class="keyword">();<br />
&nbsp; }<br />
&nbsp; function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// whatever<br />
&nbsp; </span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
If you don't need PHP 4, just delete the Foo function. Or you reverse the order of Foo and __construct, the error goes away, so that's probably OK for a single class. Also there was a suggestion to do this in Foo:<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">function </span><span class="default">Foo</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">version_compare</span><span class="keyword">(</span><span class="default">PHP_VERSION</span><span class="keyword">,</span><span class="string">"5.0.0"</span><span class="keyword">,</span><span class="string">"&lt;"</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">__construct</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113052""></a>
  <div class="note">
   <strong class="user">Yousef Ismaeil cliprz[At]gmail[Dot]com</strong>
   <a href="#113052" class="date">23-Aug-2013 06:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* a funny example Mobile class<br />
&nbsp;* <br />
&nbsp;* @author Yousef Ismaeil Cliprz[At]gmail[Dot]com<br />
&nbsp;*/<br />
<br />
</span><span class="keyword">class </span><span class="default">Mobile </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Some device properties<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * @var string<br />
&nbsp;&nbsp; &nbsp; * @access public<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public </span><span class="default">$deviceName</span><span class="keyword">,</span><span class="default">$deviceVersion</span><span class="keyword">,</span><span class="default">$deviceColor</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Set some values for Mobile::properties<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * @param string device name<br />
&nbsp;&nbsp; &nbsp; * @param string device version<br />
&nbsp;&nbsp; &nbsp; * @param string device color<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct </span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">,</span><span class="default">$version</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceName </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceVersion </span><span class="keyword">= </span><span class="default">$version</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceColor </span><span class="keyword">= </span><span class="default">$color</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"The "</span><span class="keyword">.</span><span class="default">__CLASS__</span><span class="keyword">.</span><span class="string">" class is stratup.&lt;br /&gt;&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Some Output<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * @access public<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">printOut </span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'I have a '</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceName<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">.</span><span class="string">' version '</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceVersion<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">.</span><span class="string">' my device color is : '</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceColor</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Umm only for example we will remove Mobile::$deviceName Hum not unset only to check how __destruct working <br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * @access public<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__destruct </span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceName </span><span class="keyword">= </span><span class="string">'Removed'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;br /&gt;&lt;br /&gt;Dumpping Mobile::deviceName to make sure its removed, Olay :'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">deviceName</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;br /&gt;The "</span><span class="keyword">.</span><span class="default">__CLASS__</span><span class="keyword">.</span><span class="string">" class is shutdown."</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
</span><span class="comment">// Oh ya instance<br />
</span><span class="default">$mob </span><span class="keyword">= new </span><span class="default">Mobile</span><span class="keyword">(</span><span class="string">'iPhone'</span><span class="keyword">,</span><span class="string">'5'</span><span class="keyword">,</span><span class="string">'Black'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// print output<br />
</span><span class="default">$mob</span><span class="keyword">-&gt;</span><span class="default">printOut</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The Mobile class is stratup.<br />
<br />
I have a iPhone version 5 my device color is : Black<br />
<br />
Dumpping Mobile::deviceName to make sure its removed, Olay :<br />
string 'Removed' (length=7)<br />
<br />
The Mobile class is shutdown.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108598""></a>
  <div class="note">
   <strong class="user">Per Persson</strong>
   <a href="#108598" class="date">09-May-2012 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As of PHP 5.3.10 destructors are not run on shutdown caused by fatal errors.<br />
<br />
For example:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Logger<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$rows </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__destruct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">save</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">log</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rows</span><span class="keyword">[] = </span><span class="default">$row</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">save</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;ul&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rows </span><span class="keyword">as </span><span class="default">$row</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;li&gt;'</span><span class="keyword">, </span><span class="default">$row</span><span class="keyword">, </span><span class="string">'&lt;/li&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;/ul&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$logger </span><span class="keyword">= new </span><span class="default">Logger</span><span class="keyword">;<br />
</span><span class="default">$logger</span><span class="keyword">-&gt;</span><span class="default">log</span><span class="keyword">(</span><span class="string">'Before'</span><span class="keyword">);<br />
<br />
</span><span class="default">$nonset</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">();<br />
<br />
</span><span class="default">$logger</span><span class="keyword">-&gt;</span><span class="default">log</span><span class="keyword">(</span><span class="string">'After'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Without the $nonset-&gt;foo(); line, Before and After will both be printed, but with the line neither will be printed.<br />
<br />
One can however register the destructor or another method as a shutdown function:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Logger<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$rows </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">register_shutdown_function</span><span class="keyword">(array(</span><span class="default">$this</span><span class="keyword">, </span><span class="string">'__destruct'</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__destruct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">save</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">log</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rows</span><span class="keyword">[] = </span><span class="default">$row</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">save</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;ul&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rows </span><span class="keyword">as </span><span class="default">$row</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;li&gt;'</span><span class="keyword">, </span><span class="default">$row</span><span class="keyword">, </span><span class="string">'&lt;/li&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;/ul&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$logger </span><span class="keyword">= new </span><span class="default">Logger</span><span class="keyword">;<br />
</span><span class="default">$logger</span><span class="keyword">-&gt;</span><span class="default">log</span><span class="keyword">(</span><span class="string">'Before'</span><span class="keyword">);<br />
<br />
</span><span class="default">$nonset</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">();<br />
<br />
</span><span class="default">$logger</span><span class="keyword">-&gt;</span><span class="default">log</span><span class="keyword">(</span><span class="string">'After'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Now Before will be printed, but not After, so you can see that a shutdown occurred after Before.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106968""></a>
  <div class="note">
   <strong class="user">philipwaynerollins at gmail dot com</strong>
   <a href="#106968" class="date">22-Dec-2011 05:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With the destructor if you're going to write to a file make sure you have the full file path and not just the filename, it seems PHP switches the working directory to the apache root directory when exiting the script.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105368""></a>
  <div class="note">
   <strong class="user">david dot scourfield at llynfi dot co dot uk</strong>
   <a href="#105368" class="date">12-Aug-2011 01:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware of potential memory leaks caused by circular references within objects.&nbsp; The PHP manual states "[t]he destructor method will be called as soon as all references to a particular object are removed" and this is precisely true: if two objects reference each other (or even if one object has a field that points to itself as in $this-&gt;foo = $this) then this reference will prevent the destructor being called even when there are no other references to the object at all.&nbsp; The programmer can no longer access the objects, but they still stay in memory.<br />
<br />
Consider the following example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
header</span><span class="keyword">(</span><span class="string">"Content-type: text/plain"</span><span class="keyword">);<br />
<br />
class </span><span class="default">Foo </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * An indentifier<br />
&nbsp;&nbsp; &nbsp; * @var string <br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private </span><span class="default">$name</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * A reference to another Foo object<br />
&nbsp;&nbsp; &nbsp; * @var Foo<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private </span><span class="default">$link</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">setLink</span><span class="keyword">(</span><span class="default">Foo $link</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">link </span><span class="keyword">= </span><span class="default">$link</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'Destroying: '</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">, </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">// create two Foo objects:<br />
</span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">(</span><span class="string">'Foo 1'</span><span class="keyword">);<br />
</span><span class="default">$bar </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">(</span><span class="string">'Foo 2'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// make them point to each other<br />
</span><span class="default">$foo</span><span class="keyword">-&gt;</span><span class="default">setLink</span><span class="keyword">(</span><span class="default">$bar</span><span class="keyword">);<br />
</span><span class="default">$bar</span><span class="keyword">-&gt;</span><span class="default">setLink</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">);<br />
<br />
</span><span class="comment">// destroy the global references to them<br />
</span><span class="default">$foo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">$bar </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
<br />
</span><span class="comment">// we now have no way to access Foo 1 or Foo 2, so they OUGHT to be __destruct()ed<br />
// but they are not, so we get a memory leak as they are still in memory.<br />
//<br />
// Uncomment the next line to see the difference when explicitly calling the GC:<br />
// gc_collect_cycles();<br />
// <br />
// see also: <a href="http://www.php.net/manual/en/features.gc.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/features.gc.php</a><br />
// <br />
<br />
// create two more Foo objects, but DO NOT set their internal Foo references<br />
// so nothing except the vars $foo and $bar point to them:<br />
</span><span class="default">$foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">(</span><span class="string">'Foo 3'</span><span class="keyword">);<br />
</span><span class="default">$bar </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">(</span><span class="string">'Foo 4'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// destroy the global references to them<br />
</span><span class="default">$foo </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">$bar </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
<br />
</span><span class="comment">// we now have no way to access Foo 3 or Foo 4 and as there are no more references<br />
// to them anywhere, their __destruct() methods are automatically called here,<br />
// BEFORE the next line is executed:<br />
<br />
</span><span class="keyword">echo </span><span class="string">'End of script'</span><span class="keyword">, </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
This will output:<br />
<br />
Destroying: Foo 3<br />
Destroying: Foo 4<br />
End of script<br />
Destroying: Foo 1<br />
Destroying: Foo 2<br />
<br />
But if we uncomment the gc_collect_cycles(); function call in the middle of the script, we get:<br />
<br />
Destroying: Foo 2<br />
Destroying: Foo 1<br />
Destroying: Foo 3<br />
Destroying: Foo 4<br />
End of script<br />
<br />
As may be desired.<br />
<br />
NOTE: calling gc_collect_cycles() does have a speed overhead, so only use it if you feel you need to.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103383""></a>
  <div class="note">
   <strong class="user">boukeversteeg at gmail dot com</strong>
   <a href="#103383" class="date">11-Apr-2011 04:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Php 5.3.3 had a very strange bug, related to __destruct, but this bug was fixed in 5.3.6. This bug happened to me and it took me forever to figure it out, so I wanted to share it.<br />
<br />
In short, don't unset properties in __destruct():<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Foobar </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$baz</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># Don't do either of these, if $baz also has a __destruct()!<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">baz </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">baz</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># Instead, don't clear it at all, or do this:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">baz</span><span class="keyword">-&gt;</span><span class="default">__destruct</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
If you made this mistake, this might happen in php&lt;5.3.6:<br />
<span class="default">&lt;?php<br />
</span><span class="comment"># Some function that throws an exception<br />
</span><span class="keyword">function </span><span class="default">fail</span><span class="keyword">(</span><span class="default">$foobar</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Exception A!"</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$foobar </span><span class="keyword">= new </span><span class="default">Foobar</span><span class="keyword">();<br />
</span><span class="default">$foobar</span><span class="keyword">-&gt;</span><span class="default">baz </span><span class="keyword">= new </span><span class="default">Foobar</span><span class="keyword">();<br />
<br />
try {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fail</span><span class="keyword">(</span><span class="default">$foobar</span><span class="keyword">); </span><span class="comment">// Send foobar to func that throws an Exception<br />
</span><span class="keyword">} catch( </span><span class="default">Exception $e </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; print </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">(); </span><span class="comment">// Exception A will be caught and printed, as expected.<br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">$foobar </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">; </span><span class="comment">// clearing foobar, and its property $baz<br />
<br />
</span><span class="keyword">try {<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">'Exception B:'</span><span class="keyword">;</span><span class="comment">// this will be printed<br />
&nbsp;&nbsp;&nbsp; // output stops here.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Exception B!"</span><span class="keyword">);<br />
} catch( </span><span class="default">Exception $e </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; print </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">(); </span><span class="comment">// doesn't happen<br />
</span><span class="keyword">}<br />
print </span><span class="string">'End'</span><span class="keyword">; </span><span class="comment">// this won't be printed<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102882""></a>
  <div class="note">
   <strong class="user">phenixdoc at gmail dot com</strong>
   <a href="#102882" class="date">12-Mar-2011 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
multiple constructors with type signetures (almost overloading):
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">() {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$argsStr </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$args </span><span class="keyword">as </span><span class="default">$arg</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$argsStr </span><span class="keyword">.= </span><span class="string">'_' </span><span class="keyword">. </span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">method_exists</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">, </span><span class="default">$constructor </span><span class="keyword">= </span><span class="string">'__construct' </span><span class="keyword">. </span><span class="default">$argsStr</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">call_user_func_array</span><span class="keyword">(array(</span><span class="default">$this</span><span class="keyword">, </span><span class="default">$constructor</span><span class="keyword">), </span><span class="default">$args</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'NO CONSTRUCTOR: ' </span><span class="keyword">. </span><span class="default">get_class</span><span class="keyword">() . </span><span class="default">$constructor</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
public function </span><span class="default">__construct_integer</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">) {}
<br />
public function </span><span class="default">__construct_string</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">) {}
<br />
public function </span><span class="default">__construct_integer_string</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">) {}
<br />
public function </span><span class="default">__construct_string_integer</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">) {}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101009""></a>
  <div class="note">
   <strong class="user">gratcypalma at gmail dot com</strong>
   <a href="#101009" class="date">19-Nov-2010 08:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
here is my multiple constructor.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">foo </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$mam </span><span class="keyword">= </span><span class="string">'mamam'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'foo'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
class </span><span class="default">bar </span><span class="keyword">extends </span><span class="default">foo </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">:: </span><span class="default">__construct</span><span class="keyword">(); </span><span class="comment">// use parent method to call parent class<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'bar'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
class </span><span class="default">foobar </span><span class="keyword">extends </span><span class="default">bar </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">:: </span><span class="default">__construct</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'foobar'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">$show </span><span class="keyword">= new </span><span class="default">foobar</span><span class="keyword">();<br />
<br />
</span><span class="comment">/* result is foobarfoobar */<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99903""></a>
  <div class="note">
   <strong class="user">rayro at gmx dot de</strong>
   <a href="#99903" class="date">14-Sep-2010 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
the easiest way to use and understand multiple constructors:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">A
<br />
</span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct</span><span class="keyword">()
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">func_num_args</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">method_exists</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">,</span><span class="default">$f</span><span class="keyword">=</span><span class="string">'__construct'</span><span class="keyword">.</span><span class="default">$i</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">call_user_func_array</span><span class="keyword">(array(</span><span class="default">$this</span><span class="keyword">,</span><span class="default">$f</span><span class="keyword">),</span><span class="default">$a</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct1</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo(</span><span class="string">'__construct with 1 param called: '</span><span class="keyword">.</span><span class="default">$a1</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct2</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">,</span><span class="default">$a2</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo(</span><span class="string">'__construct with 2 params called: '</span><span class="keyword">.</span><span class="default">$a1</span><span class="keyword">.</span><span class="string">','</span><span class="keyword">.</span><span class="default">$a2</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct3</span><span class="keyword">(</span><span class="default">$a1</span><span class="keyword">,</span><span class="default">$a2</span><span class="keyword">,</span><span class="default">$a3</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo(</span><span class="string">'__construct with 3 params called: '</span><span class="keyword">.</span><span class="default">$a1</span><span class="keyword">.</span><span class="string">','</span><span class="keyword">.</span><span class="default">$a2</span><span class="keyword">.</span><span class="string">','</span><span class="keyword">.</span><span class="default">$a3</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">$o </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">(</span><span class="string">'sheep'</span><span class="keyword">);
<br />
</span><span class="default">$o </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">(</span><span class="string">'sheep'</span><span class="keyword">,</span><span class="string">'cat'</span><span class="keyword">);
<br />
</span><span class="default">$o </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">(</span><span class="string">'sheep'</span><span class="keyword">,</span><span class="string">'cat'</span><span class="keyword">,</span><span class="string">'dog'</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// results:
<br />
// __construct with 1 param called: sheep
<br />
// __construct with 2 params called: sheep,cat
<br />
// __construct with 3 params called: sheep,cat,dog
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99007""></a>
  <div class="note">
   <strong class="user">maramirezc WHERE star-dev DOTTED com</strong>
   <a href="#99007" class="date">21-Jul-2010 11:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another way to emulate multiple constructors:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">MyClass </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp; </span><span class="comment">// use a unique id for each derived constructor,<br />
&nbsp;&nbsp; // and use a null reference to an array, <br />
&nbsp;&nbsp; // for optional parameters<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$id</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// parent constructor called first ALWAYS<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo </span><span class="string">"main constructor\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// avoid null or other types<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$id </span><span class="keyword">= (string) </span><span class="default">$id</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// allow default constructor<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$id </span><span class="keyword">== </span><span class="string">""</span><span class="keyword">) {&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$id </span><span class="keyword">= </span><span class="string">"default"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// just in case, use lowercase id<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$id </span><span class="keyword">= </span><span class="string">"__cons_" </span><span class="keyword">.&nbsp; </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$id</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$rc </span><span class="keyword">= new </span><span class="default">ReflectionClass</span><span class="keyword">(</span><span class="string">"MyClass"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (!</span><span class="default">$rc</span><span class="keyword">-&gt;</span><span class="default">hasMethod</span><span class="keyword">(</span><span class="default">$id</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"constructor </span><span class="default">$id</span><span class="string"> not defined\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; else { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// using "method references"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">$id</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$rc </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp; } </span><span class="comment">// function __construct<br />
<br />
&nbsp;&nbsp; // ALWAYS HAVE A default constructor,<br />
&nbsp;&nbsp; // that ignores arguments<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">__cons_default</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo </span><span class="string">"Default constructor\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; </span><span class="comment">// may have other constructors that expect different<br />
&nbsp;&nbsp; // argument types or argument count<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">__cons_min</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; if (! </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">) || </span><span class="default">count</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">) != </span><span class="default">2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo </span><span class="string">"Error: Not enough parameters (Constructor min(int </span><span class="default">$a</span><span class="string">, int </span><span class="default">$b</span><span class="string">)) !!!\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$a </span><span class="keyword">= (int) </span><span class="default">$args</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$b </span><span class="keyword">= (int) </span><span class="default">$args</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">min</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Constructor min(): Result = </span><span class="default">$c</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; </span><span class="comment">// may use string index (associative array),<br />
&nbsp;&nbsp; // instead of integer index (standard array) <br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">__cons_fullname</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; if (! </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">) || </span><span class="default">count</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">) &lt; </span><span class="default">2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo </span><span class="string">"Error: Not enough parameters (Constructor fullname(string </span><span class="default">$firstname</span><span class="string">, string </span><span class="default">$lastname</span><span class="string">)) !!!\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$a </span><span class="keyword">= (string) </span><span class="default">$args</span><span class="keyword">[</span><span class="string">"firstname"</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$b </span><span class="keyword">= (string) </span><span class="default">$args</span><span class="keyword">[</span><span class="string">"lastname"</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">$a </span><span class="keyword">. </span><span class="string">" " </span><span class="keyword">. </span><span class="default">$b</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Constructor fullname(): Result = </span><span class="default">$c</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp;&nbsp; }<br />
<br />
} </span><span class="comment">// class<br />
<br />
// --&gt; these two lines are the equivalent<br />
</span><span class="default">$obj1 </span><span class="keyword">= new </span><span class="default">TestClass</span><span class="keyword">();<br />
</span><span class="default">$obj2 </span><span class="keyword">= new </span><span class="default">TestClass</span><span class="keyword">(</span><span class="string">"default"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// --&gt; these two are specialized<br />
<br />
// should be read as "$obj3 = new TestClass, min(99.7, 99.83);"<br />
</span><span class="default">$obj3 </span><span class="keyword">= new </span><span class="default">TestClass</span><span class="keyword">(</span><span class="string">"min"</span><span class="keyword">, array(</span><span class="default">99.7</span><span class="keyword">, </span><span class="default">99.83</span><span class="keyword">));<br />
<br />
</span><span class="comment">// should be read as "$obj4 = new TestClass, fullname("John", "Doe");"<br />
</span><span class="default">$obj4 </span><span class="keyword">= new </span><span class="default">TestClass</span><span class="keyword">(</span><span class="string">"fullname"</span><span class="keyword">, array(</span><span class="string">"firstname" </span><span class="keyword">=&gt; </span><span class="string">"John"</span><span class="keyword">, </span><span class="string">"lastname" </span><span class="keyword">=&gt; </span><span class="string">"Doe"</span><span class="keyword">));<br />
<br />
</span><span class="comment">// --&gt; these&nbsp; two lack parameters<br />
</span><span class="default">$obj5 </span><span class="keyword">= new </span><span class="default">TestClass</span><span class="keyword">(</span><span class="string">"min"</span><span class="keyword">, array());<br />
</span><span class="default">$obj6 </span><span class="keyword">= new </span><span class="default">TestClass</span><span class="keyword">(</span><span class="string">"fullname"</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98514""></a>
  <div class="note">
   <strong class="user">alon dot peer at gmail dot com</strong>
   <a href="#98514" class="date">20-Jun-2010 11:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another way to overcome PHP's lack of multi constructors support is to check for the constructor's parameters' type and variate the operation accordingly. This works well when the number of parameters stays the same in all your constructors' needs.<br />
<br />
Example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">Articles </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$_articles_array</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Initialize articles array with input.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$input </span><span class="keyword">instanceof </span><span class="default">SimpleXMLElement</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Initialize articles array by parsing the XML.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Wrong input type'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96446""></a>
  <div class="note">
   <strong class="user">thomasrutter</strong>
   <a href="#96446" class="date">27-Feb-2010 12:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The manual page says that throwing an exception from a destructor causes a fatal error;&nbsp; I've found that this only happens when the exception is _uncaught_ within the context of that destructor.&nbsp; If you catch it within that same destructor it seems to be fine.<br />
<br />
This is equally true of other contexts, such as:<br />
- shutdown functions set with register_shutdown_function<br />
- destructors<br />
- custom session close functions<br />
- custom error handlers<br />
- perhaps other similar contexts<br />
<br />
An exception normally 'bubbles up' to higher and higher contexts until it is caught, but because a destructor or shutdown function is called not within execution flow but in response to a special PHP event, the exception is unable to be traced back any further than the destructor or shutdown function in which it is called.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95569""></a>
  <div class="note">
   <strong class="user">Jonathon Hibbard</strong>
   <a href="#95569" class="date">10-Jan-2010 01:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please be aware of when using __destruct() in which you are unsetting variables...<br />
<br />
Consider the following code:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">my_class </span><span class="keyword">{<br />
&nbsp; public </span><span class="default">$error_reporting </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
<br />
&nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$error_reporting </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error_reporting </span><span class="keyword">= </span><span class="default">$error_reporting</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error_reporting </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">show_report</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">error_reporting</span><span class="keyword">);<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
The above will result in an error:<br />
Notice: Undefined property: my_class::$error_reporting in my_class.php on line 10<br />
<br />
It appears as though the variable will be unset BEFORE it actually can execute the if statement.&nbsp; Removing the unset will fix this.&nbsp; It's not needed anyways as PHP will release everything anyways, but just in case you run across this, you know why ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94003""></a>
  <div class="note">
   <strong class="user">ruggie0 at yahoo dot com</strong>
   <a href="#94003" class="date">11-Oct-2009 01:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who still ***have*** to deal with php4 (like myself, which sucks), contact at tcknetwork dot com noted below that you can have both __constructor and function [classname] in the script, as __constructor has priority.<br />
<br />
However, to further improve compatability, do a version check in function [classname], as I do in my classes as follows:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">class </span><span class="default">Foo</span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp;&nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="default">$arg</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; function </span><span class="default">Foo</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">version_compare</span><span class="keyword">(</span><span class="default">PHP_VERSION</span><span class="keyword">,</span><span class="string">"5.0.0"</span><span class="keyword">,</span><span class="string">"&lt;"</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">register_shutdown_function</span><span class="keyword">(array(</span><span class="default">$this</span><span class="keyword">,</span><span class="string">"__destruct"</span><span class="keyword">));&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; function </span><span class="default">__destruct</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Ack! I'm being destroyed!"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span> <br />
<br />
This makes it much easier to use your script with fewer compatibility issues.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93097""></a>
  <div class="note">
   <strong class="user">enrico dot modanese at alpj dot com</strong>
   <a href="#93097" class="date">23-Aug-2009 04:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's usefull to note that parent::__construct() is executed like a standalone function called into the new one, and not like a first part of the code. So "return" or "die()" don't have effect on following code. If you want to avoid the execution of the child constructor you have to pass some condition from the parent. Example:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">X </span><span class="keyword">{ 
<br />
&nbsp; function </span><span class="default">X</span><span class="keyword">(){
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'break'</span><span class="keyword">]==</span><span class="string">'yes'</span><span class="keyword">){return;}
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp; }
<br />

<br />
class </span><span class="default">Y </span><span class="keyword">extends </span><span class="default">X</span><span class="keyword">{ 
<br />
&nbsp; function </span><span class="default">Y</span><span class="keyword">(){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; print(</span><span class="string">"Y_constructor_finished"</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp; }
<br />

<br />
</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'break'</span><span class="keyword">]==</span><span class="string">'yes'</span><span class="keyword">;
<br />
</span><span class="default">$new_Y</span><span class="keyword">=new </span><span class="default">Y</span><span class="keyword">();&nbsp; </span><span class="comment">// will print "Y_constructor_finished"
<br />

<br />
</span><span class="default">Solution</span><span class="keyword">:
<br />

<br />
class </span><span class="default">X </span><span class="keyword">{
<br />
&nbsp; function </span><span class="default">X</span><span class="keyword">(){
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'break'</span><span class="keyword">]==</span><span class="string">'yes'</span><span class="keyword">){</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">break</span><span class="keyword">=</span><span class="string">'yes'</span><span class="keyword">;return;}
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp; }
<br />

<br />
class </span><span class="default">Y </span><span class="keyword">extends </span><span class="default">X</span><span class="keyword">{
<br />
&nbsp; function </span><span class="default">Y</span><span class="keyword">(){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">break</span><span class="keyword">==</span><span class="string">'yes'</span><span class="keyword">){return;}
<br />
&nbsp;&nbsp;&nbsp; print(</span><span class="string">"Y_constructor_finished"</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp; }
<br />

<br />
</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'break'</span><span class="keyword">]=</span><span class="string">'yes'</span><span class="keyword">;
<br />
</span><span class="default">$new_Y</span><span class="keyword">=new </span><span class="default">Y</span><span class="keyword">();&nbsp; </span><span class="comment">// will print nothing
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91813""></a>
  <div class="note">
   <strong class="user">ramesh dot rips at gmail dot com</strong>
   <a href="#91813" class="date">26-Jun-2009 03:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Without __constructor constructor will call like this.<br />
Why because, Here Class name and function name are equal.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">baseclass<br />
</span><span class="keyword">{<br />
&nbsp; function </span><span class="default">baseclass</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"constructor is called"</span><span class="keyword">.</span><span class="string">"&lt;br&gt;" </span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
&nbsp;}<br />
&nbsp;class </span><span class="default">deriviedclass </span><span class="keyword">extends </span><span class="default">baseclass<br />
&nbsp;</span><span class="keyword">{<br />
&nbsp;&nbsp; function </span><span class="default">deriviedclass</span><span class="keyword">()<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">baseclass</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp; }<br />
&nbsp;<br />
&nbsp;</span><span class="default">$object_base</span><span class="keyword">=new </span><span class="default">baseclass</span><span class="keyword">();<br />
&nbsp;</span><span class="default">$object_derive</span><span class="keyword">=new </span><span class="default">deriviedclass</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span>Out put is <br />
constructor is called<br />
constructor is called</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91013""></a>
  <div class="note">
   <strong class="user">hyponiq at gmail dot com</strong>
   <a href="#91013" class="date">21-May-2009 03:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just thought I'd share some valuable information that might help novice programmers/scripters in __constructor() functions.<br />
<br />
I've been using PHP for quite a long time, as well as programming and scripting in general.&nbsp; Even with my quite seasoned skillset, I still make obvious, painstaking mistakes.&nbsp; That said, I'd like to point out one major (albeit obvious) common mistake that programmers and scripters (such as myself) make.<br />
<br />
When defining the constructor for an object and using it to populate variables for use throughout the lifetime of the application, do note that if you set a static variable AFTER a dynamic one, the static variable's (intended) contents are not readible inside the assigning functions of a dynamic variable.&nbsp; (That sounded rather cryptic, so an example is in order...)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">ExampleClass<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// assigned a static value using an expression in the constructor<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public </span><span class="default">$myStaticVar</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// assigned a value through a function of the class<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public </span><span class="default">$myDynamicVar</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$myStaticVarValue</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// sets to nothing; $this-&gt;myStaticVar hasn't been assigned to yet<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">myDynamicVar </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setSomeValue</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// sets to 'Static Variable Value in this example<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">myStaticVar </span><span class="keyword">= </span><span class="default">$myStaticVarValue</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">setSomeValue</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// returns null; $this-&gt;myStaticVar hasn't been assigned to, yet<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">myStaticVar</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">// automatically sets $object-&gt;myStaticVar to 'Static Variable Value'<br />
//(but only after setting $object-&gt;myDynamicVar to the unassigned $object-&gt;myStaticVar)<br />
</span><span class="default">$object </span><span class="keyword">= new </span><span class="default">ExampleClass</span><span class="keyword">(</span><span class="string">'Static Variable Value'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// outputs nothing<br />
</span><span class="keyword">print </span><span class="default">$object</span><span class="keyword">-&gt;</span><span class="default">myDynamicVar</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
The above example won't print anything because you're setting the $myDynamicVar to equal the $myStaticVar, but the $myStaticVar hasn't been (technically) assigned to, yet.<br />
<br />
So, if you wish to reference that variable inside the assignment function of a dynamic variable, you have to declare it first and foremost.&nbsp; Otherwise, its value will not be accessible yet.<br />
<br />
The correct way...<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">ExampleClass<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// assigned a static value using an expression in the constructor<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public </span><span class="default">$myStaticVar</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// assigned a value through a function of the class<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public </span><span class="default">$myDynamicVar</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$myStaticVarValue</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// sets to $myStaticVariable (or 'Some Static Variable Value' in this example)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">myStaticVar </span><span class="keyword">= </span><span class="default">$myStaticVarValue</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// sets to newly assigned-to $this-&gt;myStaticVariable<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">myDynamicVar </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setSomeValue</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">setSomeValue</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// returns 'Static Variable Value'<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">myStaticVar</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">// sets $object-&gt;myStaticVar to 'Static Variable Value' automatically before $object-&gt;myDynamicVar<br />
</span><span class="default">$object </span><span class="keyword">= new </span><span class="default">ExampleClass</span><span class="keyword">(</span><span class="string">'Static Variable Value'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// outputs 'Static Variable Value'<br />
</span><span class="keyword">print </span><span class="default">$object</span><span class="keyword">-&gt;</span><span class="default">myDynamicVar</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90746""></a>
  <div class="note">
   <strong class="user">ceo at l-i-e dot com</strong>
   <a href="#90746" class="date">07-May-2009 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As far as I can tell, Connection: close isn't sent until after __destruct is called in shutdown sequence.<br />
I was hoping to get the HTTP connection closed and done, and do some slow non-output processing after that, but no luck.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88575""></a>
  <div class="note">
   <strong class="user">bac2day1 at gmail dot com</strong>
   <a href="#88575" class="date">29-Jan-2009 07:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can also capitalize on singleton for the connection as well.
<br />
Just add the following to your class:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">db </span><span class="keyword">{ 
<br />
&nbsp; </span><span class="comment">//...
<br />
&nbsp; </span><span class="keyword">private static </span><span class="default">$instance</span><span class="keyword">;
<br />
&nbsp; </span><span class="comment">//...
<br />
&nbsp; </span><span class="keyword">public static function </span><span class="default">singleton</span><span class="keyword">() {
<br />
&nbsp;&nbsp;&nbsp; if(!isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$instance</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">__CLASS__</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instance </span><span class="keyword">= new </span><span class="default">$c</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instance</span><span class="keyword">;
<br />
&nbsp; }
<br />
&nbsp; </span><span class="comment">//...
<br />
</span><span class="keyword">}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86423""></a>
  <div class="note">
   <strong class="user">spleen</strong>
   <a href="#86423" class="date">18-Oct-2008 01:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's always the easy things that get you -<br />
<br />
Being new to OOP, it took me quite a while to figure out that there are TWO underscores in front of the word __construct.<br />
<br />
It is __construct<br />
Not _construct<br />
<br />
Extremely obvious once you figure it out, but it can be sooo frustrating until you do.<br />
<br />
I spent quite a bit of needless time debugging working code.<br />
<br />
I even thought about it a few times, thinking it looked a little long in the examples, but at the time that just seemed silly(always thinking "oh somebody would have made that clear if it weren't just a regular underscore...")<br />
<br />
All the manuals I looked at, all the tuturials I read, all the examples I browsed through&nbsp; - not once did anybody mention this!&nbsp; <br />
<br />
(please don't tell me it's explained somewhere on this page and I just missed it,&nbsp; you'll only add to my pain.)<br />
<br />
I hope this helps somebody else!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86348""></a>
  <div class="note">
   <strong class="user">office at kitsoftware dot ro</strong>
   <a href="#86348" class="date">14-Oct-2008 04:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Should be noted that according to the NEWS (in PHP 5.3) file, in PHP 5.3, handling an exception in the __destructor should not output a FATAL error ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86260""></a>
  <div class="note">
   <strong class="user">Jeffrey</strong>
   <a href="#86260" class="date">09-Oct-2008 11:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Constructor Simplicity<br />
<br />
If your class DOES CONTAIN instance members (variables) that need to be set, then your class needs to be initialized... and you should use __construct() to do that.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">MyClassA </span><span class="keyword">{<br />
&nbsp; public </span><span class="default">$data1</span><span class="keyword">, </span><span class="default">$data2</span><span class="keyword">;<br />
<br />
&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$mcd1</span><span class="keyword">, </span><span class="default">$mcd2</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data1 </span><span class="keyword">= </span><span class="default">$mcd1</span><span class="keyword">;&nbsp; </span><span class="comment">// INITIALIZE $data1<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data2 </span><span class="keyword">= </span><span class="default">$mcd2</span><span class="keyword">;&nbsp; </span><span class="comment">// INITIALIZE $data2<br />
&nbsp; </span><span class="keyword">}<br />
}<br />
<br />
</span><span class="default">$obj1 </span><span class="keyword">= new </span><span class="default">MyClassA</span><span class="keyword">(</span><span class="string">"Hello"</span><span class="keyword">, </span><span class="string">"World!"</span><span class="keyword">);&nbsp; </span><span class="comment">// INSTANTIATE MyClassA<br />
</span><span class="default">$d1 </span><span class="keyword">= </span><span class="default">$obj1</span><span class="keyword">-&gt;</span><span class="default">data1</span><span class="keyword">;<br />
</span><span class="default">$d2 </span><span class="keyword">= </span><span class="default">$obj1</span><span class="keyword">-&gt;</span><span class="default">data2</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
If your class DOES NOT CONTAIN instance members or you DO NOT want to instantiate it, then there is no reason to initialize it or use __construct().<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">MyClassB </span><span class="keyword">{<br />
&nbsp; const </span><span class="default">DATA1 </span><span class="keyword">= </span><span class="string">"Hello"</span><span class="keyword">;<br />
&nbsp; public static </span><span class="default">$data2 </span><span class="keyword">= </span><span class="string">"World!"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$obj1 </span><span class="keyword">= new </span><span class="default">MyClassB</span><span class="keyword">();&nbsp; </span><span class="comment">// INSTANTIATE MyClassB - NO error.<br />
</span><span class="default">$d1 </span><span class="keyword">= </span><span class="default">$obj1</span><span class="keyword">::</span><span class="default">DATA1</span><span class="keyword">;&nbsp; &nbsp; &nbsp; </span><span class="comment">// ERROR<br />
</span><span class="default">$d2 </span><span class="keyword">= </span><span class="default">$obj1</span><span class="keyword">::</span><span class="default">data2</span><span class="keyword">;&nbsp; &nbsp; &nbsp; </span><span class="comment">// ERROR<br />
</span><span class="default">$d1 </span><span class="keyword">= </span><span class="default">MyClassB</span><span class="keyword">::</span><span class="default">DATA1</span><span class="keyword">;&nbsp;&nbsp; </span><span class="comment">// ok<br />
</span><span class="default">$d2 </span><span class="keyword">= </span><span class="default">MyClassB</span><span class="keyword">::</span><span class="default">$data2</span><span class="keyword">;&nbsp; </span><span class="comment">// ok<br />
</span><span class="default">?&gt;<br />
</span><br />
The fact that $obj1 is useless and cannot be used as a reference, is further evidence that MyClassB objects should not be instantiated. NOTICE that MyClassB does not use private members or functions to make it behave that way. Rather, it is the collective nature of all the class members + what ISN'T there.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85638""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#85638" class="date">10-Sep-2008 02:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
USE PARENT::CONSTRUCT() to exploit POLYMORPHISM POWERS<br />
<br />
Since we are still in the __construct and __destruct section, alot of emphasis has been on __destruct - which I know nothing about. But I would like to show the power of parent::__construct for use with PHP's OOP polymorphic behavior (you'll see what this is very quickly).<br />
<br />
In my example, I have created a fairly robust base class that does everything that all subclasses need to do. Here's the base class def.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/*<br />
&nbsp;* Animal.php<br />
&nbsp;*<br />
&nbsp;* This class holds all data, and defines all functions that all <br />
&nbsp;* subclass extensions need to use.<br />
&nbsp;*<br />
&nbsp;*/<br />
</span><span class="keyword">abstract class </span><span class="default">Animal<br />
</span><span class="keyword">{<br />
&nbsp; public </span><span class="default">$type</span><span class="keyword">;<br />
&nbsp; public </span><span class="default">$name</span><span class="keyword">;<br />
&nbsp; public </span><span class="default">$sound</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; * called by Dog, Cat, Bird, etc.<br />
&nbsp;&nbsp; */<br />
&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$aType</span><span class="keyword">, </span><span class="default">$aName</span><span class="keyword">, </span><span class="default">$aSound</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">type </span><span class="keyword">= </span><span class="default">$aType</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$aName</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sound </span><span class="keyword">= </span><span class="default">$aSound</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; * define the sorting rules - we will sort all Animals by name.<br />
&nbsp;&nbsp; */ <br />
&nbsp; </span><span class="keyword">public static function </span><span class="default">compare</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">&lt; </span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">) return -</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else if(</span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">== </span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">) return </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else return </span><span class="default">1</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; * a String representation for all Animals.<br />
&nbsp;&nbsp; */<br />
&nbsp; </span><span class="keyword">public function </span><span class="default">__toString</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="string">"</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="string"> the </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">type</span><span class="string"> goes </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sound</span><span class="string">"</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Trying to instantiate an object of type Animal will not work...<br />
<br />
$myPet = new Animal("Parrot", "Captain Jack", "Kaaawww!"); // throws Fatal Error: cannot instantiate abstract class Animal.<br />
<br />
Declaring Animal as abstract is like killing two birds with one stone. 1. We stop it from being instantiated - which means we do not need a private __construct() or a static getInstance() method, and 2. We can use it for polymorphic behavior. In our case here, that means "__construct", "__toString" and "compare" will be called for all subclasses of Animal that have not defined their own implementations.<br />
<br />
The following subclasses use parent::__construct(), which sends all new data to Animal. Our Animal class stores this data and defines functions for polymorphism to work... and the best part is, it keeps our subclass defs super short and even sweeter.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">Dog </span><span class="keyword">extends </span><span class="default">Animal</span><span class="keyword">{<br />
&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="string">"Dog"</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">, </span><span class="string">"woof!"</span><span class="keyword">);<br />
&nbsp; }<br />
}<br />
<br />
class </span><span class="default">Cat </span><span class="keyword">extends </span><span class="default">Animal</span><span class="keyword">{<br />
&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="string">"Cat"</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">, </span><span class="string">"meeoow!"</span><span class="keyword">);<br />
&nbsp; }<br />
}<br />
<br />
class </span><span class="default">Bird </span><span class="keyword">extends </span><span class="default">Animal</span><span class="keyword">{<br />
&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="string">"Bird"</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">, </span><span class="string">"chirp chirp!!"</span><span class="keyword">);<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="comment"># create a PHP Array and initialize it with Animal objects<br />
</span><span class="default">$animals </span><span class="keyword">= array(<br />
&nbsp; new </span><span class="default">Dog</span><span class="keyword">(</span><span class="string">"Fido"</span><span class="keyword">),<br />
&nbsp; new </span><span class="default">Bird</span><span class="keyword">(</span><span class="string">"Celeste"</span><span class="keyword">),<br />
&nbsp; new </span><span class="default">Cat</span><span class="keyword">(</span><span class="string">"Pussy"</span><span class="keyword">),<br />
&nbsp; new </span><span class="default">Dog</span><span class="keyword">(</span><span class="string">"Brad"</span><span class="keyword">),<br />
&nbsp; new </span><span class="default">Bird</span><span class="keyword">(</span><span class="string">"Kiki"</span><span class="keyword">),<br />
&nbsp; new </span><span class="default">Cat</span><span class="keyword">(</span><span class="string">"Abraham"</span><span class="keyword">),<br />
&nbsp; new </span><span class="default">Dog</span><span class="keyword">(</span><span class="string">"Jawbone"</span><span class="keyword">)<br />
);<br />
<br />
</span><span class="comment"># sort $animals with PHP's usort - calls Animal::compare() many many times.<br />
</span><span class="default">usort</span><span class="keyword">(</span><span class="default">$animals</span><span class="keyword">, array(</span><span class="string">"Animal"</span><span class="keyword">, </span><span class="string">"compare"</span><span class="keyword">));<br />
<br />
</span><span class="comment"># print out the sorted results - calls Animal-&gt;__toString().<br />
</span><span class="keyword">foreach(</span><span class="default">$animals </span><span class="keyword">as </span><span class="default">$animal</span><span class="keyword">) echo </span><span class="string">"</span><span class="default">$animal</span><span class="string">&lt;br&gt;\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The results are "sorted by name" and "printed" by the Animal class:<br />
<br />
Abraham the Cat goes meeoow!<br />
Brad the Dog goes woof!<br />
Celeste the Bird goes chirp chirp!!<br />
Fido the Dog goes woof!<br />
Jawbone the Dog goes woof!<br />
Kiki the Bird goes chirp chirp!!<br />
Pussy the Cat goes meeoow!<br />
<br />
Using parent::__construct() in a subclass and a super smart base class, gives your child objects a headstart in life, by alleviating them from having to define or handle several error and exception routines that they have no control over.<br />
<br />
Notice how subclass definitions are really short - no variables or functions at all, and there is no private __construct() method anywhere? Notice how objects of type Dog, Cat, and Bird are all sorted by our base class Animal? All the class definitions above address several issues (keeping objects from being instantiated) and enforces the desired, consistent, and reliable behavior everytime... with the least amount of code. In addition, new extenstions can easily be created. Each subclass is now super easy to redefine or even extend... now that you can see a way to do it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83252""></a>
  <div class="note">
   <strong class="user">KK</strong>
   <a href="#83252" class="date">16-May-2008 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I ran into an interesting (and subtle) code error while porting some code to PHP 5.2.5 from PHP 4.4.8 that I think illustrates a noteworthy semantic.<br />
<br />
I have a hierarchy of classes with both styles of constructors but where one in the middle was missing the __construct() function (it just had the old-style one that called the (nonexistent) __construct()).&nbsp; It worked fine in PHP4 but caused an endless loop (and stack overflow) in PHP5.&nbsp; I believe what happened is that in PHP4 the old-style constructor was not called, but in PHP5 it was (due to the "emulation" of PHP4), and since _construct() wasn't defined for that class, the call to $this-&gt;__construct() caused a looping call to the original (lowest child) constructor.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82577""></a>
  <div class="note">
   <strong class="user">bolshun at mail dot ru</strong>
   <a href="#82577" class="date">17-Apr-2008 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Ensuring that instance of some class will be available in destructor of some other class is easy: just keep a reference to that instance in this other class.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82477""></a>
  <div class="note">
   <strong class="user">ashnazg at php dot net</strong>
   <a href="#82477" class="date">12-Apr-2008 07:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since my last note, I've been instructed to _NEVER_ call "unset($this)", never ever ever.&nbsp; Since my previous testing of behavior did not explicitly show me that it was indeed necessary, I'm inclined to trust those telling me not to do it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81458""></a>
  <div class="note">
   <strong class="user">ashnazg at php dot net</strong>
   <a href="#81458" class="date">28-Feb-2008 11:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While experimenting with destructs and unsets in relation to memory usage, I found what seems to be one useful way to predict when __destruct() gets called... call it manually yourself.<br />
<br />
I had previously assumed that explicitly calling unset($foo) would cause $foo-&gt;__destruct() to run implicitly, but that was not the behavior I saw (php 5.2.5).&nbsp; The destructors weren't running until the script ended, even though I was calling unset($foo) in the middle of my script.&nbsp; So, having $foo-&gt;__destruct() unset all of $foo's component objects was not helping my memory usage since my explicit unset($foo) was _not_ triggering $foo-&gt;__destruct()'s cleanup steps.<br />
<br />
Interestingly, what _did_ appear to happen is that calling unset($bar) from inside a destructor like $foo-&gt;__destruct() _DID_ cause $bar-&gt;__destruct() to be implicitly executed.&nbsp; Perhaps this is because $bar has a "parent" reference of $foo whereas $foo does not, and the object destruction behaves differently... I don't know.<br />
<br />
Lastly, even after explicitly calling $foo-&gt;__destruct() (even when it had "unset($this);" inside it), the reference to the $foo object remained visible.&nbsp; I had to still explicitly call unset($foo) to get rid of it.<br />
<br />
So, my advice based on the behavior I saw in my experiments:<br />
- always unset($bar) your class's component objects from inside that class's __destruct() method;&nbsp; no explicit component destructor calls seem to be required other than those unsets, though.<br />
- always explicitly call $foo-&gt;__destruct() in your code that _uses_ your class<br />
- always explicitly follow $foo-&gt;__destruct() with unset($foo).<br />
<br />
This seems to be the best cleanup approach to take.&nbsp; Just for my own sanity, I also will always keep an unset($this) at the end of each __destruct() method.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80314""></a>
  <div class="note">
   <strong class="user">nerdystudmuffin at gmail dot com</strong>
   <a href="#80314" class="date">09-Jan-2008 08:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Correction to the previous poster about non public constructors. If I wanted to implement Singleton design pattern where I would only want one instance of the class I would want to prevent instantiation of the class from outside of the class by making the constructor private. An example follows:<br />
<br />
class Foo {<br />
<br />
&nbsp; private static $instance;<br />
<br />
&nbsp; private __construct() {<br />
&nbsp;&nbsp;&nbsp; // Do stuff<br />
&nbsp; }<br />
<br />
&nbsp; public static getInstance() {<br />
<br />
&nbsp;&nbsp;&nbsp; if (!isset(self::$instance)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $c = __CLASS__;<br />
&nbsp;&nbsp; &nbsp;&nbsp; $instance = new $c;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return self::$instance;<br />
&nbsp; }<br />
<br />
&nbsp; public function sayHello() {<br />
&nbsp;&nbsp;&nbsp; echo "Hello World!!";<br />
&nbsp; }<br />
<br />
}<br />
<br />
$bar = Foo::getInstance();<br />
<br />
// Prints 'Hello World' on the screen.<br />
$bar -&gt; sayHello();</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80107""></a>
  <div class="note">
   <strong class="user">david at synatree dot com</strong>
   <a href="#80107" class="date">29-Dec-2007 10:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When a script is in the process of die()ing, you can't count on the order in which __destruct() will be called.<br />
<br />
For a script I have been working on, I wanted to do transparent low-level encryption of any outgoing data.&nbsp; To accomplish this, I used a global singleton class configured like this:<br />
<br />
class EncryptedComms<br />
{<br />
&nbsp;&nbsp;&nbsp; private $C;<br />
&nbsp;&nbsp;&nbsp; private $objs = array();<br />
&nbsp;&nbsp;&nbsp; private static $_me;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public static function destroyAfter(&amp;$obj)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; self::getInstance()-&gt;objs[] =&amp; $obj;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; /*<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Hopefully by forcing a reference to another object to exist <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; inside this class, the referenced object will need to be destroyed<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; before garbage collection can occur on this object.&nbsp; This will force <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; this object's destruct method to be fired AFTER the destructors of<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; all the objects referenced here.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; */<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function __construct($key)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;C = new SimpleCrypt($key);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ob_start(array($this,'getBuffer'));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public static function &amp;getInstance($key=NULL)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!self::$_me &amp;&amp; $key)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; self::$_me = new EncryptedComms($key);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return self::$_me;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function __destruct()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ob_end_flush();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function getBuffer($str)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $this-&gt;C-&gt;encrypt($str);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
In this example, I tried to register other objects to always be destroyed just before this object.&nbsp; Like this:<br />
<br />
class A<br />
{<br />
<br />
public function __construct()<br />
{<br />
&nbsp;&nbsp; &nbsp; EncryptedComms::destroyAfter($this);<br />
}<br />
}<br />
<br />
One would think that the references to the objects contained in the singleton would be destroyed first, but this is not the case.&nbsp; In fact, this won't work even if you reverse the paradigm and store a reference to EncryptedComms in every object you'd like to be destroyed before it.<br />
<br />
In short, when a script die()s, there doesn't seem to be any way to predict the order in which the destructors will fire.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79986""></a>
  <div class="note">
   <strong class="user">Typer85 at gmail dot com</strong>
   <a href="#79986" class="date">22-Dec-2007 06:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In regards to a Class Constructor visibility ...<br />
<br />
I too was having the same problem with Class Constructor visibility, in which I had one Class that was extended by several other Classes. The problem that I encountered was in one of the Child Classes, I wanted a weaker visibility. Consider the following example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Public Constructor ...<br />
&nbsp;&nbsp;&nbsp; // No Problems Here.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Class Function.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">functionA</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Public Constructor ... <br />
&nbsp;&nbsp;&nbsp; // Same As Parent Class ...<br />
&nbsp;&nbsp;&nbsp; // Again No Problems Here.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Class Function.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">functionB</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">C </span><span class="keyword">extends </span><span class="default">A </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Private Constructor ...<br />
&nbsp;&nbsp;&nbsp; // Weaker Then Parent Class ...<br />
&nbsp;&nbsp;&nbsp; // PHP Will Throw A Fatal Error.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private function </span><span class="default">__construct</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Class Function.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">functionC</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Nothing new in the above example that we have not seen before. My solution to solve this problem?<br />
<br />
Create an Abstract Class with all the functionality of Class A.&nbsp; Make its Class Constructor have a visibility of Protected, then extend each of the three Classes above from that Abstract Class. In a way, the Abstract Class acts as a dummy Class to get rid of the visibility problem:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">abstract class </span><span class="default">AAbstract </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Protected Constructor ...<br />
&nbsp;&nbsp;&nbsp; // Abstract Class Can Not Be Created Anyway ...<br />
&nbsp;&nbsp;&nbsp; // No Problems Here.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected function </span><span class="default">__construct</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Class Function ...<br />
&nbsp;&nbsp;&nbsp; // Originally In Class A ...<br />
&nbsp;&nbsp;&nbsp; // Which Was Used As A Super Class.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">functionA</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">A </span><span class="keyword">extends </span><span class="default">AAbstract </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Public Constructor ...<br />
&nbsp;&nbsp;&nbsp; // Stronger Than Parent Class ...<br />
&nbsp;&nbsp;&nbsp; // Again No Problems Here.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// By Moving All The Functionality Of<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Class A To Class AAbstract Class A<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Will Automatically Inherit All Of<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Its Functionality. The Only Thing<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Left To Do Is To Create A Constructor<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Which Calls Class AABstract's Constructor<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // To Mimic Similar Behavior.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">( );<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// No Need To Redeclare functionA( ) <br />
&nbsp;&nbsp;&nbsp; // Since It Was Moved To Class<br />
&nbsp;&nbsp;&nbsp; // AAbstract.<br />
</span><span class="keyword">}<br />
<br />
class </span><span class="default">B </span><span class="keyword">extends </span><span class="default">AAbstract&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Public Constructor ...<br />
&nbsp;&nbsp;&nbsp; // Stronger Than Parent Class ...<br />
&nbsp;&nbsp;&nbsp; // Again No Problems Here.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">( );<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Class Function ...<br />
&nbsp;&nbsp;&nbsp; // Specific To This Class.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">functionB</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">C </span><span class="keyword">extends </span><span class="default">AAbstract </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Protected Constructor ...<br />
&nbsp;&nbsp;&nbsp; // Same As Parent Class ...<br />
&nbsp;&nbsp;&nbsp; // Again No Problems Here.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected function </span><span class="default">__construct</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Class Function ...<br />
&nbsp;&nbsp;&nbsp; // Specific To This Class.<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">functionC</span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
As you can see the problem is more or less fixed. Class AAbstract acts a dummy class, containing all the original functionality of Class A. But because it has a protected Constructor, in order to make its functionality available, Class A is redeclared as Child Class with the only difference of it having a public Constructor that automatically calls the Parent Constructor.<br />
<br />
Notice that Class B does not extend from Class A but also from Class AAbstract! If I wanted to change Class B's Constructor to protected, I can easily do it! Notice that an extra Method was added to Class B ... this is because Class B has extra functionality specific to itself. Same applies to Class C.<br />
<br />
Why don't Class B and Class C extend from Class A? Because Class A has a public Constructor, which pretty much defies the point of this solution.<br />
<br />
This solution is not perfect however and has some flaws.<br />
<br />
Good Luck,</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78737""></a>
  <div class="note">
   <strong class="user">James Laver</strong>
   <a href="#78737" class="date">25-Oct-2007 11:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I recently found, while implementing a database backed session class, that PHP has an apparently less than desirably structured destruction order. Basically, my session class which would have saved when destructed, was being destructed after one of the classes it depends on. Apparently we cannot, therefore depend on PHP to use reverse initialisation order.<br />
<br />
My solution was to use register_shutdown_function, which is called before any objects are killed on script end.<br />
<br />
Quick example (if you're going to use it, I recommend tidying up the code somewhat) :<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Session<br />
&nbsp; </span><span class="keyword">function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Initialise the session here...<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; //Register the shutdown function<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">register_shutdown_function</span><span class="keyword">(array(</span><span class="default">$this</span><span class="keyword">,</span><span class="string">"save"</span><span class="keyword">));<br />
&nbsp; }<br />
<br />
&nbsp; function </span><span class="default">save</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Save it here<br />
&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp; function </span><span class="default">__destruct</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Persisting the session here will not work.<br />
&nbsp; </span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78430""></a>
  <div class="note">
   <strong class="user">magus do t xion a t g mail d ot c o m</strong>
   <a href="#78430" class="date">11-Oct-2007 09:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Looking through the notes I noticed a few people expressing concern that PHP5 does not support multiple constructors...<br />
<br />
Here is an example of a method that I use which seems to work fine:<br />
<br />
class Example<br />
{<br />
&nbsp;&nbsp; &nbsp; function __construct()<br />
&nbsp;&nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "do some basic stuff here";<br />
&nbsp;&nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; function Example($arg)<br />
&nbsp;&nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo $arg;<br />
&nbsp;&nbsp; &nbsp; }<br />
}<br />
<br />
You then can call with or without arguments without having notices and/or warnings thrown at you... Of course this is limited but if you don't need something complex this can help to get the job done in some situations.&nbsp; I believe you could also add arguments to the __construct() function and as long as it is different than Example() 's args you would be fine. Although I have yet to test this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76710""></a>
  <div class="note">
   <strong class="user">prieler at abm dot at</strong>
   <a href="#76710" class="date">27-Jul-2007 09:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i have written a quick example about the order of destructors and shutdown functions in php 5.2.1:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">destruction </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; var </span><span class="default">$name</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">destruction</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">register_shutdown_function</span><span class="keyword">(array(&amp;</span><span class="default">$this</span><span class="keyword">, </span><span class="string">"shutdown"</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">shutdown</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'shutdown: '</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'destruct: '</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$a </span><span class="keyword">= new </span><span class="default">destruction</span><span class="keyword">(</span><span class="string">'a: global 1'</span><span class="keyword">);<br />
<br />
function </span><span class="default">test</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= new </span><span class="default">destruction</span><span class="keyword">(</span><span class="string">'b: func 1'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= new </span><span class="default">destruction</span><span class="keyword">(</span><span class="string">'c: func 2'</span><span class="keyword">);<br />
}<br />
</span><span class="default">test</span><span class="keyword">();<br />
<br />
</span><span class="default">$d </span><span class="keyword">= new </span><span class="default">destruction</span><span class="keyword">(</span><span class="string">'d: global 2'</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
this will output:<br />
shutdown: a: global 1<br />
shutdown: b: func 1<br />
shutdown: c: func 2<br />
shutdown: d: global 2<br />
destruct: b: func 1<br />
destruct: c: func 2<br />
destruct: d: global 2<br />
destruct: a: global 1<br />
<br />
conclusions:<br />
destructors are always called on script end.<br />
destructors are called in order of their "context": first functions, then global objects<br />
objects in function context are deleted in order as they are set (older objects first).<br />
objects in global context are deleted in reverse order (older objects last)<br />
<br />
shutdown functions are called before the destructors.<br />
shutdown functions are called in there "register" order. ;)<br />
<br />
regards, J</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76446""></a>
  <div class="note">
   <strong class="user">fredrik at rambris dot com</strong>
   <a href="#76446" class="date">16-Jul-2007 03:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The fact that class names are case-insensitive in PHP5 also applies to constructors. Make sure you don't have any functions named like the class *at all*.<br />
<br />
This has bitten me a few times.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Example </span><span class="keyword">extends </span><span class="default">Base<br />
</span><span class="keyword">{<br />
&nbsp; function </span><span class="default">example</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"This gets called"</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
<br />
class </span><span class="default">Base<br />
</span><span class="keyword">{<br />
&nbsp; function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Not this"</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76361""></a>
  <div class="note">
   <strong class="user">theubaz at gmail dot com</strong>
   <a href="#76361" class="date">12-Jul-2007 01:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
What you could do is write the constructor without any declared arguments, then iterate through the arguments given and check their types/values to determine what other function to use as the constructor.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76235""></a>
  <div class="note">
   <strong class="user">soapthgr8 at gmail dot com</strong>
   <a href="#76235" class="date">06-Jul-2007 04:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is just to clarify that the Singleton pattern is a bit more complex than just making the constructor private. It also involves caching an instance of the object and always returning the cached value. So, in the previous example, the getNewInstance() function would undermine the intent of the Singleton pattern. Instead you would just need a getInstance() function, like so.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />
&nbsp; </span><span class="comment">// cached instance<br />
&nbsp; </span><span class="keyword">private static </span><span class="default">oInst </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; * Prevent an object from being constructed.<br />
&nbsp;&nbsp;&nbsp; */<br />
&nbsp; </span><span class="keyword">private function </span><span class="default">__construct</span><span class="keyword">( ) {}<br />
&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; * Function to return the instance of this class.<br />
&nbsp;&nbsp; */<br />
&nbsp; </span><span class="keyword">public static function </span><span class="default">getInstance</span><span class="keyword">( ) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$oInst</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$oInst </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">( );<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$oInst</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74511""></a>
  <div class="note">
   <strong class="user">frederic dot barboteu at laposte dot net</strong>
   <a href="#74511" class="date">15-Apr-2007 04:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The manual says:<br />
"Like constructors, parent destructors will not be called implicitly by the engine."<br />
<br />
This is true ONLY when a __destruct() function has been defined by the child class.<br />
If no __destruct() function exists in the child class, the parent's one will be implicitly executed.<br />
<br />
So be carefull if you have some ancestor executing a particular task in its __destruct() function, an you plan its childs to execute it or not, wether you include "parent::__destruct()" or not.<br />
If you want the child not to execute its parent __destruct() function, you must ensure that it has its own __destruct() function, even if empty. Then the parent's one will not be executed.<br />
<br />
This can be verified with the following code:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">#<br />
</span><span class="keyword">class </span><span class="default">AncestorClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;br /&gt;AncestorClass: destructing '</span><span class="keyword">.</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="comment">#<br />
</span><span class="keyword">class </span><span class="default">ParentDestructClass </span><span class="keyword">extends </span><span class="default">AncestorClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'ParentDestructClass: destructing itself'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__destruct</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="comment">#<br />
</span><span class="keyword">class </span><span class="default">EmptyDestructClass </span><span class="keyword">extends </span><span class="default">AncestorClass </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'EmptyDestructClass: destructing itself'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="comment">#<br />
</span><span class="keyword">class </span><span class="default">NoDestructClass </span><span class="keyword">extends </span><span class="default">AncestorClass </span><span class="keyword">{<br />
}<br />
</span><span class="comment">#---<br />
</span><span class="keyword">echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">;<br />
</span><span class="default">$p</span><span class="keyword">=new </span><span class="default">ParentDestructClass</span><span class="keyword">();<br />
unset(</span><span class="default">$p</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">;<br />
</span><span class="default">$e</span><span class="keyword">=new </span><span class="default">EmptyDestructClass</span><span class="keyword">();<br />
unset(</span><span class="default">$e</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">;<br />
</span><span class="default">$n</span><span class="keyword">=new </span><span class="default">NoDestructClass</span><span class="keyword">();<br />
unset(</span><span class="default">$n</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span>which displays:<br />
---<br />
ParentDestructClass: destructing itself<br />
AncestorClass: destructing ParentDestructClass<br />
---<br />
EmptyDestructClass: destructing itself<br />
---<br />
<br />
AncestorClass: destructing NoDestructClass<br />
---</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70876""></a>
  <div class="note">
   <strong class="user">phaxius</strong>
   <a href="#70876" class="date">02-Nov-2006 06:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello, I've been messing with php for about a week but am learning a lot.&nbsp; It occurred to me that it might be necessary in some cases to write a class that takes a variable number of arguments.&nbsp; After some experimentation, this example was formed:<br />
<br />
class variableArgs{<br />
public $a = array();<br />
protected $numOfArgs;<br />
public function __construct()<br />
{<br />
&nbsp; $numOfArgs=func_num_args();<br />
&nbsp; if(func_num_args()==0)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; $numOfArgs=1;<br />
&nbsp;&nbsp;&nbsp; $a[0]='No arguments passed';<br />
&nbsp;&nbsp;&nbsp; $this-&gt;Arg[0]=$a[0];<br />
&nbsp; }<br />
&nbsp; else<br />
&nbsp; for($i=0; $i&lt;func_num_args(); $i++)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; $a[$i]=func_get_arg($i);<br />
&nbsp;&nbsp;&nbsp; $this-&gt;Arg[$i]=$a[$i];<br />
&nbsp; }<br />
}<br />
public function showArgs()<br />
{<br />
&nbsp; echo 'showArgs() called &lt;br /&gt;';<br />
&nbsp; for ($i=0; $i&lt;$numOfArgs; $i++)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; echo '$i: ' . $i . '&lt;br /&gt;';<br />
&nbsp;&nbsp;&nbsp; echo $this-&gt;Arg[$i];<br />
&nbsp;&nbsp;&nbsp; echo '&lt;br /&gt;';<br />
&nbsp; }<br />
}<br />
public function __destruct(){}<br />
<br />
}<br />
<br />
$test1 = new variableArgs;<br />
$test2 = new variableArgs("arg1");<br />
$test3 = new variableArgs("arg1", "arg2");<br />
$test4 = new variableArgs("arg1", "arg2", "arg3");<br />
<br />
$test1-&gt;showArgs();<br />
$test2-&gt;showArgs();<br />
$test3-&gt;showArgs();<br />
$test4-&gt;showArgs();<br />
<br />
This outputs the following:<br />
<br />
showArgs() called <br />
$i: 0<br />
No arguments passed<br />
showArgs() called <br />
$i: 0<br />
arg1<br />
showArgs() called <br />
$i: 0<br />
arg1<br />
$i: 1<br />
arg2<br />
showArgs() called <br />
$i: 0<br />
arg1<br />
$i: 1<br />
arg2<br />
$i: 2<br />
arg3<br />
<br />
I have no idea how efficient this is, but it works at any rate.&nbsp; Hopefully this helps someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70051""></a>
  <div class="note">
   
   <a href="#70051" class="date">01-Oct-2006 08:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a simple thing to bear in mind but it's also easy to forget it.&nbsp; When chaining object constructors and destructors, always remember to call the superclass __construct() method in the subclass __construct() so that all superclass members are properly initialized before you start initializing the ones belonging to your subclass.&nbsp; <br />
<br />
Also, you will usually want to do your own cleanup first in your subclass __destruct() method so you will probably want to call the superclass __destruct() as the last thing in your subclass so that you can use resources defined in the superclass during the cleanup phase. <br />
<br />
For example, if your superclass includes a database connection and your subclass __destruct method commits things to the database then if you call the superclass destruct before doing so then the database connection will no longer be valid and you will be unable to commit your changes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69036""></a>
  <div class="note">
   <strong class="user">chanibal at deltasoft dot int dot pl dot SPAMPROTECT</strong>
   <a href="#69036" class="date">21-Aug-2006 06:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that if a class contains another class, the contained class's destructor will be triggered after the destructor of the containing class.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">contained </span><span class="keyword">{<br />
&nbsp;<br />
&nbsp;protected </span><span class="default">$parent</span><span class="keyword">;<br />
<br />
&nbsp;public function </span><span class="default">__construct</span><span class="keyword">(&amp;</span><span class="default">$p</span><span class="keyword">) {<br />
&nbsp; </span><span class="comment"># $this-&gt;parent=&amp;$p;<br />
&nbsp; </span><span class="keyword">}<br />
&nbsp;<br />
&nbsp;public function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp; </span><span class="comment">/* unset $this-&gt;parent */<br />
&nbsp; </span><span class="keyword">print </span><span class="string">'contained '</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp;}<br />
&nbsp;<br />
class </span><span class="default">containing </span><span class="keyword">{<br />
<br />
&nbsp;protected </span><span class="default">$contained</span><span class="keyword">;<br />
<br />
&nbsp;public function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">contained</span><span class="keyword">=new </span><span class="default">contained</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">);<br />
&nbsp; } <br />
<br />
&nbsp;public function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp; </span><span class="comment">// unset($this-&gt;contained);<br />
&nbsp; </span><span class="keyword">print </span><span class="string">'containing '</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp;}<br />
&nbsp;<br />
&nbsp;<br />
new </span><span class="default">containing</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Will output<br />
containing contained<br />
<br />
After uncommenting the // comment, the output will change to<br />
contained containing <br />
<br />
Adding a reference from the contained class to the containing one (the # comment) will not change that, but beware, because it can cause random errors in other destructors in the parts of the script which seem unrelated! (PHP Version 5.1.2)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68028""></a>
  <div class="note">
   <strong class="user">Reza Mahjourian</strong>
   <a href="#68028" class="date">10-Jul-2006 11:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Peter has suggested using static methods to compensate for unavailability of multiple constructors in PHP.&nbsp; This works fine for most purposes, but if you have a class hierarchy and want to delegate parts of initialization to the parent class, you can no longer use this scheme.&nbsp; It is because unlike constructors, in a static method you need to do the instantiation yourself.&nbsp; So if you call the parent static method, you will get an object of parent type which you can't continue to initialize with derived class fields.<br />
<br />
Imagine you have an Employee class and a derived HourlyEmployee class and you want to be able to construct these objects out of some XML input too.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Employee </span><span class="keyword">{<br />
&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$inName</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$inName</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; public static function </span><span class="default">constructFromDom</span><span class="keyword">(</span><span class="default">$inDom</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">$inDom</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; return new </span><span class="default">Employee</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; private </span><span class="default">$name</span><span class="keyword">;<br />
}<br />
<br />
class </span><span class="default">HourlyEmployee </span><span class="keyword">extends </span><span class="default">Employee </span><span class="keyword">{<br />
&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$inName</span><span class="keyword">, </span><span class="default">$inHourlyRate</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$inName</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">hourlyRate </span><span class="keyword">= </span><span class="default">$inHourlyRate</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; public static function </span><span class="default">constructFromDom</span><span class="keyword">(</span><span class="default">$inDom</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// can't call parent::constructFromDom($inDom)<br />
&nbsp;&nbsp; &nbsp; &nbsp; // need to do all the work here again<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">$inDom</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">;&nbsp; </span><span class="comment">// increased coupling<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$hourlyRate </span><span class="keyword">= </span><span class="default">$inDom</span><span class="keyword">-&gt;</span><span class="default">hourlyrate</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; return new </span><span class="default">EmployeeHourly</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$hourlyRate</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; private </span><span class="default">$hourlyRate</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
The only solution is to merge the two constructors in one by adding an optional $inDom parameter to every constructor.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66288""></a>
  <div class="note">
   <strong class="user">Peter Molnar</strong>
   <a href="#66288" class="date">18-May-2006 03:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There were many notes about the inability of defining multiple constructors for the class.<br />
<br />
My solution is to define separate static methods for each type of constructor.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Vector </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$x</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$y</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">createXY</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v </span><span class="keyword">= new </span><span class="default">Vector</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v</span><span class="keyword">-&gt;</span><span class="default">x </span><span class="keyword">= </span><span class="default">$x</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v</span><span class="keyword">-&gt;</span><span class="default">y </span><span class="keyword">= </span><span class="default">$y</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63590""></a>
  <div class="note">
   <strong class="user">jcaplan at bogus dot amazon dot com</strong>
   <a href="#63590" class="date">24-Mar-2006 06:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
__construct and __destruct must be declared public in any class that you intend to instantiate with new.&nbsp;&nbsp; However, in an abstract (or never-instantiated base) class you can declare them private or protected, and subclasses can still refer to them via parent::__construct (!) (tested in PHP 5.1.2).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58426""></a>
  <div class="note">
   <strong class="user">derk AT oneindig DOT com</strong>
   <a href="#58426" class="date">03-Nov-2005 11:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If a constructor is not present in a child class, php5 will try to call a constructor from the parent class. This behaviour can be used to somewhat simulate constructor chaining.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">abstract class </span><span class="default">Parent </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Parent constructor called\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">myConstruct</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">Child </span><span class="keyword">extends </span><span class="default">Parent </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">myConstruct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">" Child 'contructor' called"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$c </span><span class="keyword">= new </span><span class="default">Child</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
will output:<br />
Parent constructor called<br />
Child 'constructor' called</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56996""></a>
  <div class="note">
   <strong class="user">contact at tcknetwork dot com</strong>
   <a href="#56996" class="date">21-Sep-2005 09:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
be careful while trying to access files with __destruct() because the base directory (getcwd()) will be the root of your server and not the path of your script, so add before all your path called in __destruct() :<br />
EITHER&nbsp;&nbsp; dirname($_SERVER["SCRIPT_FILENAME"])."my/path/"<br />
OR&nbsp; &nbsp; &nbsp; dirname(__FILE__)."my/path/"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; (be careful with includes, it will give the path of the file processed and not the main file)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55799""></a>
  <div class="note">
   <strong class="user">php dot net at lk2 dot de</strong>
   <a href="#55799" class="date">13-Aug-2005 06:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It looks like `echo()`ed output from the __destructor() function is displayed onto screen _before_ other output that the class may have have already sent before.<br />
<br />
This can be misleading if you have debug info printed in the destructor but not a problem if you know it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54639""></a>
  <div class="note">
   <strong class="user">dominics at gmail dot com</strong>
   <a href="#54639" class="date">11-Jul-2005 04:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're using E_STRICT error reporting, PHP will tell you if you define both __construct() and an old-style constructor (a function with the same name as the class) together in a class. Note that this occurs even if the old constructor function is abstract or final (for instance, if you were intending to only use it in a sub-class). Be wary of this if you're trying to implement the 'command' design pattern.<br />
<br />
The solution? Either turn E_STRICT off (and possibly forgo some other important notices), rename your function (and possibly make things a little more complicated), or look at using an interface.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51935""></a>
  <div class="note">
   <strong class="user">contact at tcknetwork dot com</strong>
   <a href="#51935" class="date">15-Apr-2005 05:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that php5 use in priority __construct() instead of [classname](). So you could build a constructed/destructed class for php4/5 very easily using this.<br />
&lt;?<br />
class test {<br />
&nbsp;function test() {<br />
&nbsp; $this-&gt;__construct();<br />
&nbsp; register_shutdown_function(array($this,"__destruct"));<br />
&nbsp;}<br />
&nbsp;function __construct() {<br />
&nbsp; echo "construct\n";<br />
&nbsp;}<br />
&nbsp;function __destruct() {<br />
&nbsp; echo "destruct\n";<br />
&nbsp;}<br />
};<br />
$t=new test();<br />
?&gt;<br />
In case you use unset($t) in php4, the destructor is not called. so be careful.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51414""></a>
  <div class="note">
   <strong class="user">apfelsaft</strong>
   <a href="#51414" class="date">30-Mar-2005 10:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
at the end of a script all remaining objects aren't in fact destructed. it is only their __destruct() method, which will be called. the objects still exist after that.<br />
<br />
so, if your database connection object has no __destruct() or at least it doesn't disconnects the database, it will still work.<br />
<br />
in general, there is no need to disconnect the database (especially for persistent connections).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
