<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>よりよい乱数値を生成する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mt-getrandmax.html">≪ mt_getrandmax</a></li>
      <li style="float: right;"><a href="function.mt-srand.html">mt_srand ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.math.html">Math 関数</a></li>
    <li>よりよい乱数値を生成する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mt-rand" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mt_rand</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mt_rand</span> &mdash; <span class="dc-title">よりよい乱数値を生成する</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.mt-rand-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><strong>mt_rand</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><strong>mt_rand</strong></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$min</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$max</code></span>
   )</div>

  <p class="simpara">
   古い libc の多くの乱数発生器は、怪しげであるか特性が不明であったりし、
   また低速でした。デフォルトでは、PHP は
   <span class="function"><a href="function.rand.html" class="function">rand()</a></span> において libc の乱数発生器を使用します。
   <span class="function"><strong>mt_rand()</strong></span> 関数は、その代替品となるものです。
   この関数は、その特性が既知の乱数生成器 <a href="http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html" class="link external" title="Link : http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html">&raquo;&nbsp;
   Mersenne Twister</a> を使用し、
   平均的な libc の rand()よりも 4 倍以上高速に乱数を生成します。
  </p>
  <p class="simpara">
   オプションの引数
   <code class="parameter">min</code>,<code class="parameter">max</code> を付けずに
   コールした場合、<span class="function"><strong>mt_rand()</strong></span> は 0 から
   <span class="function"><a href="function.mt-getrandmax.html" class="function">mt_getrandmax()</a></span> の間の擬似乱数値を返します。
   例えば、5 から 15 まで(端点を含む)の間の乱数値を得たい場合には
   <em>mt_rand(5, 15)</em> としてください。
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.mt-rand-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">min</code></dt>

     <dd>

      <p class="para">
       オプションで指定する、返される値の最小値 (デフォルトは 0)。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">max</code></dt>

     <dd>

      <p class="para">
       オプションで指定する、返される値の最大値 (デフォルトは <span class="function"><a href="function.mt-getrandmax.html" class="function">mt_getrandmax()</a></span>)。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.mt-rand-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   <code class="parameter">min</code> (あるいは 0)
   から <code class="parameter">max</code> (あるいは <span class="function"><a href="function.mt-getrandmax.html" class="function">mt_getrandmax()</a></span>、それぞれ端点を含む)
   までの間のランダムな整数値を返します。
   <code class="parameter">max</code> が <code class="parameter">min</code> より小さい場合は
   <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>

 <div class="refsect1 changelog" id="refsect1-function.mt-rand-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.4</td>
       <td>
        <code class="parameter">max</code> &lt; <code class="parameter">min</code> の場合に
        <strong><code>E_WARNING</code></strong> を発行して <strong><code>FALSE</code></strong> を返すようになりました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.mt-rand-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-3563">
    <p><strong>例1 <span class="function"><strong>mt_rand()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">mt_rand</span><span style="color: #007700">()&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">mt_rand</span><span style="color: #007700">()&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /><br />echo&nbsp;</span><span style="color: #0000BB">mt_rand</span><span style="color: #007700">(</span><span style="color: #0000BB">5</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">15</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は、
たとえば以下のようになります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
1604716014
1478613278
6
</pre></div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 notes" id="refsect1-function.mt-rand-notes">
  <h3 class="title">注意</h3>
  <div class="caution"><strong class="caution">警告</strong><p class="para">この関数が生成する値は、暗号学的に安全ではありません。そのため、これを暗号として使ってはいけません。暗号学的に安全な値が必要な場合は、<span class="function"><a href="function.openssl-random-pseudo-bytes.html" class="function">openssl_random_pseudo_bytes()</a></span> を使いましょう。</p></div>
  <div class="caution"><strong class="caution">警告</strong>
   <p class="para">
    64 ビット版の PHP で
    <code class="parameter">max</code> を <em>2^32</em>
    より大きくすると、<span class="function"><strong>mt_rand()</strong></span>
    の返り値の分布にバイアスがかかり、偶数よりになります。
   </p>
  </div>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.mt-rand-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mt-srand.html" class="function" rel="rdfs-seeAlso">mt_srand()</a> - 改良型乱数生成器にシードを指定する</span></li>
    <li class="member"><span class="function"><a href="function.mt-getrandmax.html" class="function" rel="rdfs-seeAlso">mt_getrandmax()</a> - 乱数値の最大値を表示する</span></li>
    <li class="member"><span class="function"><a href="function.openssl-random-pseudo-bytes.html" class="function" rel="rdfs-seeAlso">openssl_random_pseudo_bytes()</a> - 疑似乱数のバイト文字列を生成する</span></li>
    <li class="member"><span class="function"><a href="function.rand.html" class="function" rel="rdfs-seeAlso">rand()</a> - 乱数を生成する</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115363""></a>
  <div class="note">
   <strong class="user">falkartis at gmail dot com</strong>
   <a href="#115363" class="date">13-Jul-2014 12:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote another function to get a random float, if its not precise enougth jut add some '0' to the $mul parameter.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$max</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">,</span><span class="default">$mul</span><span class="keyword">=</span><span class="default">1000000</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$min</span><span class="keyword">&gt;</span><span class="default">$max</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">*</span><span class="default">$mul</span><span class="keyword">,</span><span class="default">$max</span><span class="keyword">*</span><span class="default">$mul</span><span class="keyword">)/</span><span class="default">$mul</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>I made following&nbsp; tests:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">().</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//0.497153<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">0.5</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//0.857822<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">0.5</span><span class="keyword">,</span><span class="default">0.6</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//0.599956<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//5.801949<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//1.5<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//1.7<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114999""></a>
  <div class="note">
   <strong class="user">bimal at sanjaal dot com</strong>
   <a href="#114999" class="date">11-May-2014 05:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was seeing how much unique and random 5-digits number I can use/generate in one-second's interval of time. (I had another logic for myself to make my number unique based on the date/time stamp value as well).<br />
<br />
I found that the mt_rand() numbers are not quite unique. The repetitions&nbsp; will often occur a lot of times even in the first 50 random numbers generated in a loop.<br />
<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">'Content-Type: text/plain'</span><span class="keyword">);<br />
<br />
</span><span class="default">$errors </span><span class="keyword">= array();<br />
</span><span class="default">$uniques </span><span class="keyword">= array();<br />
for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">500</span><span class="keyword">; ++</span><span class="default">$i</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$random_code </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">10000</span><span class="keyword">, </span><span class="default">99999</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$random_code</span><span class="keyword">, </span><span class="default">$uniques</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$uniques</span><span class="keyword">[] = </span><span class="default">$random_code</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$errors</span><span class="keyword">[] = </span><span class="default">$random_code</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* If you get any data in this array, it is not exactly unique<br />
&nbsp;* Run this script for few times and you may see some repeats<br />
&nbsp;*/<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$errors</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114898""></a>
  <div class="note">
   <strong class="user">github.com/elcodedocle</strong>
   <a href="#114898" class="date">23-Apr-2014 03:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Ever wanted a crypto safe mt_rand()? Not useful for many things I guess (maybe not useful at all), but I recently wanted to build a class able to pick random words from a dictionary in a safe way, so they could be used as passwords. I probably overdid it... The result is my attempt on a "cryptographically secure" mt_rand implementation including a wrapper for selecting and using the best random bytes generator from available extensions and /dev/urandom (about 100 times slower than mt_rand on a single core, by the way, so it's clearly open for improvement if you want to fork it on github.com/elcodedocle/cryptosecureprng, where you can find the docs to it too). Here is the minimized version (note too long):<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Crypto Secure PRNG<br />
&nbsp;* @copyright&nbsp; 2014 elcodedocle<br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">CryptoSecurePRNG </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$intByteCount </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$defaultMax </span><span class="keyword">= </span><span class="default">2147483647</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$mcrypt</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$openssl</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$urandomFileHandler </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getRandomBytesString</span><span class="keyword">(</span><span class="default">$byteCount</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$chars </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">mcrypt</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$chars </span><span class="keyword">= </span><span class="default">mcrypt_create_iv</span><span class="keyword">(</span><span class="default">$byteCount</span><span class="keyword">, </span><span class="default">MCRYPT_DEV_URANDOM</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$chars </span><span class="keyword">&amp;&amp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">openssl</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$chars </span><span class="keyword">= </span><span class="default">openssl_random_pseudo_bytes</span><span class="keyword">(</span><span class="default">$byteCount</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$chars </span><span class="keyword">&amp;&amp; </span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">urandomFileHandler</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$len&nbsp; </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$chars</span><span class="keyword">))&lt; </span><span class="default">$byteCount</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$chars </span><span class="keyword">.= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">urandomFileHandler</span><span class="keyword">, </span><span class="default">$byteCount </span><span class="keyword">- </span><span class="default">$len</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$chars</span><span class="keyword">) &lt; </span><span class="default">$byteCount</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$len</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) { </span><span class="default">$chars</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">$chars</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] ^ </span><span class="default">chr</span><span class="keyword">(</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">)); }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$byteCount</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$chars </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$chars</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">rand</span><span class="keyword">(</span><span class="default">$min </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$max </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$max </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) { </span><span class="default">$max </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">defaultMax</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">)||!</span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$max</span><span class="keyword">)) { throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'$min and $max must be integers'</span><span class="keyword">); }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$min</span><span class="keyword">&gt;</span><span class="default">$max</span><span class="keyword">) { throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'$min must be &lt;= $max'</span><span class="keyword">); }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$chars </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getRandomBytesString</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">intByteCount</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$chars</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++) {</span><span class="default">$n</span><span class="keyword">|=(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$chars</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])&lt;&lt;(</span><span class="default">8</span><span class="keyword">*(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$chars</span><span class="keyword">)-</span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)));}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (</span><span class="default">abs</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">)%(</span><span class="default">$max</span><span class="keyword">-</span><span class="default">$min</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">))+</span><span class="default">$min</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">mcrypt&nbsp; </span><span class="keyword">= </span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'mcrypt_create_iv'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">openssl </span><span class="keyword">= </span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'openssl_random_pseudo_bytes'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_readable</span><span class="keyword">(</span><span class="string">'/dev/urandom'</span><span class="keyword">)){ </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">urandomFileHandler </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/dev/urandom'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">); }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__destruct</span><span class="keyword">(){ <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">urandomFileHandler </span><span class="keyword">)) </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">urandomFileHandler</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
} <br />
<br />
</span><span class="default">$randGen </span><span class="keyword">= new </span><span class="default">CryptoSecurePRNG</span><span class="keyword">();<br />
echo </span><span class="default">$randGen</span><span class="keyword">-&gt;</span><span class="default">rand</span><span class="keyword">();&nbsp; </span><span class="comment">//outputs rand int between 0 and 2^32</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113611""></a>
  <div class="note">
   <strong class="user">Pawe Krawczyk</strong>
   <a href="#113611" class="date">05-Nov-2013 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To reiterate the message about *not* using mt_rand() for anything security related, here's a new tool that has been just posted that recovers the seed value given a single mt_rand() output:<br />
<br />
<a href="http://www.openwall.com/php_mt_seed/README" rel="nofollow" target="_blank">http://www.openwall.com/php_mt_seed/README</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113391""></a>
  <div class="note">
   <strong class="user">simon at labs dot coop</strong>
   <a href="#113391" class="date">06-Oct-2013 04:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Something we discovered in Sydney running BBS Systems before the net advent was here, if we didn't seed of another BBS we would going in circles in our System Physicality Abstraction Layers.. The important thing is to seed from a remote system and easy way at the Centroidal Plexus of the web (Chronolabs Cooperative) we offer a seed feed and the following code will randomise you out of the number cycle:<br />
<br />
<span class="default">&lt;?php<br />
<br />
mt_srand</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'<a href="http://seed.feeds.labs.coop" rel="nofollow" target="_blank">http://seed.feeds.labs.coop</a>'</span><span class="keyword">)); <br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113221""></a>
  <div class="note">
   <strong class="user">hofmann dot johannes at gmail dot com</strong>
   <a href="#113221" class="date">14-Sep-2013 05:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
/dev/urandom provides high entropy, but it is important to remember that it is created by collecting random os garbage from memory - if not enough of that garbage is created reading the file will just block the whole process until there is enough entropy to generate the requested random bytes. in debian-based setups, the rng-tools package can be used to manage entropy.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112889""></a>
  <div class="note">
   <strong class="user">Miller</strong>
   <a href="#112889" class="date">03-Aug-2013 03:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another generic random string function, but very small and fast.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mt_rand_str </span><span class="keyword">(</span><span class="default">$l</span><span class="keyword">, </span><span class="default">$c </span><span class="keyword">= </span><span class="string">'abcdefghijklmnopqrstuvwxyz1234567890'</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$s </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$cl </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">, </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$l</span><span class="keyword">; </span><span class="default">$s </span><span class="keyword">.= </span><span class="default">$c</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$cl</span><span class="keyword">)], ++</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$s</span><span class="keyword">;<br />
}<br />
<br />
echo </span><span class="default">mt_rand_str</span><span class="keyword">(</span><span class="default">8</span><span class="keyword">); </span><span class="comment">// Something like mp2tmpsw<br />
</span><span class="keyword">echo </span><span class="default">mt_rand_str</span><span class="keyword">(</span><span class="default">6</span><span class="keyword">, </span><span class="string">'0123456789ABCDEF'</span><span class="keyword">); </span><span class="comment">// Something like B9CD0F<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111243""></a>
  <div class="note">
   <strong class="user">Hayley Watson</strong>
   <a href="#111243" class="date">30-Jan-2013 07:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another graphical comparison of rand() and mt_rand(). It effectively draws a graph showing how the last generated number affects the next by plotting the numbers in consecutive pairs against each other.<br />
<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
</span><span class="default">$sizex</span><span class="keyword">=</span><span class="default">800</span><span class="keyword">;<br />
</span><span class="default">$sizey</span><span class="keyword">=</span><span class="default">800</span><span class="keyword">;<br />
<br />
</span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">2 </span><span class="keyword">* </span><span class="default">$sizex</span><span class="keyword">,</span><span class="default">$sizey</span><span class="keyword">);<br />
</span><span class="default">$black </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$sizex</span><span class="keyword">, </span><span class="default">$sizey</span><span class="keyword">, </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">));<br />
<br />
</span><span class="default">$p </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">100000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$np </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$sizex</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$p</span><span class="keyword">, </span><span class="default">$np</span><span class="keyword">, </span><span class="default">$black</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p </span><span class="keyword">= </span><span class="default">$np</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$p </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">100000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$np </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$sizex</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$p </span><span class="keyword">+ </span><span class="default">$sizex</span><span class="keyword">, </span><span class="default">$np</span><span class="keyword">, </span><span class="default">$black</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p </span><span class="keyword">= </span><span class="default">$np</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107738""></a>
  <div class="note">
   <strong class="user">cyrax21 at gmail dot com</strong>
   <a href="#107738" class="date">01-Mar-2012 05:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i wanted to spot out the big difference between rand and mt_rand when producing images using randomness as noise.
<br />

<br />
for example this is a comparation between rand and mt_rand on a 400x400 pixel png: <a href="http://oi43.tinypic.com/vwtppl.jpg" rel="nofollow" target="_blank">http://oi43.tinypic.com/vwtppl.jpg</a>
<br />

<br />
code:
<br />
<span class="default">&lt;?php
<br />
header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);
<br />
</span><span class="default">$sizex</span><span class="keyword">=</span><span class="default">800</span><span class="keyword">;
<br />
</span><span class="default">$sizey</span><span class="keyword">=</span><span class="default">400</span><span class="keyword">;
<br />

<br />
</span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$sizex</span><span class="keyword">,</span><span class="default">$sizey</span><span class="keyword">);
<br />
</span><span class="default">$ink </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">);
<br />

<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$sizex</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp; for(</span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$sizey</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">++) {
<br />
&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">$sizex</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">), </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">$sizey</span><span class="keyword">), </span><span class="default">$ink</span><span class="keyword">);
<br />
&nbsp; }
<br />
}
<br />
&nbsp;
<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">$sizex</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$sizex</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp; for(</span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$sizey</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">++) {
<br />
&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">$sizex</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">,</span><span class="default">$sizex</span><span class="keyword">), </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">$sizey</span><span class="keyword">), </span><span class="default">$ink</span><span class="keyword">);
<br />
&nbsp; }
<br />
}
<br />

<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
the differences reduce when reducing the pixels of the image.. infact for a 100x100 pixel image the noise produced from the rand function is much more realistic than how it is for a 400x400 image: <a href="http://oi39.tinypic.com/5k0row.jpg" rel="nofollow" target="_blank">http://oi39.tinypic.com/5k0row.jpg</a>
<br />

<br />
(rand is on the left, mt_rand on the right)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106645""></a>
  <div class="note">
   <strong class="user">contact at sheyd dot fr</strong>
   <a href="#106645" class="date">24-Nov-2011 01:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To quickly build a human-readable random string for a captcha per example :<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">random</span><span class="keyword">(</span><span class="default">$length </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">)<br />
{&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chars </span><span class="keyword">= </span><span class="string">'bcdfghjklmnprstvwxzaeiou'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$p </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$p </span><span class="keyword">&lt; </span><span class="default">$length</span><span class="keyword">; </span><span class="default">$p</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">.= (</span><span class="default">$p</span><span class="keyword">%</span><span class="default">2</span><span class="keyword">) ? </span><span class="default">$chars</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">19</span><span class="keyword">, </span><span class="default">23</span><span class="keyword">)] : </span><span class="default">$chars</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">18</span><span class="keyword">)];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Note that I have removed q and y from $chars to avoid readability problems.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105639""></a>
  <div class="note">
   <strong class="user">j dot s dot shiuan at gmail dot com</strong>
   <a href="#105639" class="date">02-Sep-2011 08:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another good way to get a random float is to divide the result of mt_rand.<br />
Let's say we want a float between 0.75 and 1.25.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$i </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">75</span><span class="keyword">,</span><span class="default">125</span><span class="keyword">) / </span><span class="default">100</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105587""></a>
  <div class="note">
   <strong class="user">rok dot kralj at rok-kralj dot net</strong>
   <a href="#105587" class="date">30-Aug-2011 06:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function has limited entrophy. So, if you want to create random string, it will produce only about 2 billion different strings, no matter the length of the string. This can be serous security issue if you are using such strings for session indentifiers, passwords etc.
<br />

<br />
Many times I have wanted to create *propper* base-64 string (containing only printable characters) of arbitrary length for many purposes. I wrote a function that checks if UNIX random generator is available and uses in that case. If not, it tries to increase the entrophy by accounting in the script execution time.
<br />

<br />
Here is the function, just try it out!
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">random</span><span class="keyword">(</span><span class="default">$len</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; if (@</span><span class="default">is_readable</span><span class="keyword">(</span><span class="string">'/dev/urandom'</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/dev/urandom'</span><span class="keyword">, </span><span class="string">'r'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$urandom</span><span class="keyword">=</span><span class="default">fread</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">$len</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$len</span><span class="keyword">;++</span><span class="default">$i</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$urandom</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$i</span><span class="keyword">%</span><span class="default">2</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">) </span><span class="default">mt_srand</span><span class="keyword">(</span><span class="default">time</span><span class="keyword">()%</span><span class="default">2147 </span><span class="keyword">* </span><span class="default">1000000 </span><span class="keyword">+ (double)</span><span class="default">microtime</span><span class="keyword">() * </span><span class="default">1000000</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rand</span><span class="keyword">=</span><span class="default">48</span><span class="keyword">+</span><span class="default">mt_rand</span><span class="keyword">()%</span><span class="default">64</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else </span><span class="default">$rand</span><span class="keyword">=</span><span class="default">48</span><span class="keyword">+</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$urandom</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])%</span><span class="default">64</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$rand</span><span class="keyword">&gt;</span><span class="default">57</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rand</span><span class="keyword">+=</span><span class="default">7</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$rand</span><span class="keyword">&gt;</span><span class="default">90</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rand</span><span class="keyword">+=</span><span class="default">6</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$rand</span><span class="keyword">==</span><span class="default">123</span><span class="keyword">) </span><span class="default">$rand</span><span class="keyword">=</span><span class="default">45</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$rand</span><span class="keyword">==</span><span class="default">124</span><span class="keyword">) </span><span class="default">$rand</span><span class="keyword">=</span><span class="default">46</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">.=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">$rand</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101564""></a>
  <div class="note">
   <strong class="user">Robin Leffmann</strong>
   <a href="#101564" class="date">25-Dec-2010 03:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Fast, pseudo-random binary data generation using mt_rand():<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">rnd_bin</span><span class="keyword">( </span><span class="default">$length </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; while( @</span><span class="default">$c</span><span class="keyword">++ * </span><span class="default">16 </span><span class="keyword">&lt; </span><span class="default">$length </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">$tmp </span><span class="keyword">.= </span><span class="default">md5</span><span class="keyword">( </span><span class="default">mt_rand</span><span class="keyword">(), </span><span class="default">true </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$tmp</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$length </span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99319""></a>
  <div class="note">
   <strong class="user">Andrew Moore</strong>
   <a href="#99319" class="date">10-Aug-2010 06:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need a predictable set of numbers for a given seed, you may use the following Pure-PHP implementation of a Mersenne Twister<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Mersenne_Twister<br />
</span><span class="keyword">{<br />
&nbsp; private </span><span class="default">$state </span><span class="keyword">= array ();<br />
&nbsp; private </span><span class="default">$index </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$seed </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$seed </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$seed </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setSeed</span><span class="keyword">(</span><span class="default">$seed</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">setSeed</span><span class="keyword">(</span><span class="default">$seed</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">$seed </span><span class="keyword">&amp; </span><span class="default">0xffffffff</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">624</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = (((</span><span class="default">0x6c078965 </span><span class="keyword">* (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] ^ (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] &gt;&gt; </span><span class="default">30</span><span class="keyword">))) + </span><span class="default">$i</span><span class="keyword">)) &amp; </span><span class="default">0xffffffff</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">index </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; private function </span><span class="default">generateTwister</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">624</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= ((</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] &amp; </span><span class="default">0x1</span><span class="keyword">) + (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] &amp; </span><span class="default">0x7fffffff</span><span class="keyword">)) &amp; </span><span class="default">0xffffffff</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[(</span><span class="default">$i </span><span class="keyword">+ </span><span class="default">397</span><span class="keyword">) % </span><span class="default">624</span><span class="keyword">] ^ (</span><span class="default">$y </span><span class="keyword">&gt;&gt; </span><span class="default">1</span><span class="keyword">)) &amp; </span><span class="default">0xffffffff</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ((</span><span class="default">$y </span><span class="keyword">% </span><span class="default">2</span><span class="keyword">) == </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] ^ </span><span class="default">0x9908b0df</span><span class="keyword">) &amp; </span><span class="default">0xffffffff</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
<br />
&nbsp; public function </span><span class="default">getNext</span><span class="keyword">(</span><span class="default">$min </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$max </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if ((</span><span class="default">$min </span><span class="keyword">=== </span><span class="default">null </span><span class="keyword">&amp;&amp; </span><span class="default">$max </span><span class="keyword">!== </span><span class="default">null</span><span class="keyword">) || (</span><span class="default">$min </span><span class="keyword">!== </span><span class="default">null </span><span class="keyword">&amp;&amp; </span><span class="default">$max </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Invalid arguments'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">index </span><span class="keyword">=== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">generateTwister</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">state</span><span class="keyword">[</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">index</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= (</span><span class="default">$y </span><span class="keyword">^ (</span><span class="default">$y </span><span class="keyword">&gt;&gt; </span><span class="default">11</span><span class="keyword">)) &amp; </span><span class="default">0xffffffff</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= (</span><span class="default">$y </span><span class="keyword">^ ((</span><span class="default">$y </span><span class="keyword">&lt;&lt; </span><span class="default">7</span><span class="keyword">) &amp; </span><span class="default">0x9d2c5680</span><span class="keyword">)) &amp; </span><span class="default">0xffffffff</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= (</span><span class="default">$y </span><span class="keyword">^ ((</span><span class="default">$y </span><span class="keyword">&lt;&lt; </span><span class="default">15</span><span class="keyword">) &amp; </span><span class="default">0xefc60000</span><span class="keyword">)) &amp; </span><span class="default">0xffffffff</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= (</span><span class="default">$y </span><span class="keyword">^ (</span><span class="default">$y </span><span class="keyword">&gt;&gt; </span><span class="default">18</span><span class="keyword">)) &amp; </span><span class="default">0xffffffff</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">index </span><span class="keyword">= (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">index </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">) % </span><span class="default">624</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$min </span><span class="keyword">=== </span><span class="default">null </span><span class="keyword">&amp;&amp; </span><span class="default">$max </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$y</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$range </span><span class="keyword">= </span><span class="default">abs</span><span class="keyword">(</span><span class="default">$max </span><span class="keyword">- </span><span class="default">$min</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">min</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">, </span><span class="default">$max</span><span class="keyword">) + (</span><span class="default">$y </span><span class="keyword">% (</span><span class="default">$range </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">));<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97977""></a>
  <div class="note">
   <strong class="user">nilesh at itech7 dot com</strong>
   <a href="#97977" class="date">19-May-2010 09:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A class to generate 99.5% unqiue strings. I found that there is only one or two characters common between two subsequent strings.
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
</span><span class="keyword">class </span><span class="default">Local_RandomString </span><span class="keyword">{
<br />
&nbsp; 
<br />
&nbsp; protected </span><span class="default">$_length</span><span class="keyword">;
<br />
&nbsp; protected </span><span class="default">$_prevRand</span><span class="keyword">;
<br />

<br />
&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$length </span><span class="keyword">= </span><span class="default">15</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length </span><span class="keyword">= </span><span class="default">$length</span><span class="keyword">;
<br />

<br />
&nbsp; }
<br />

<br />
&nbsp; public function </span><span class="default">getRand</span><span class="keyword">() {
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$randStr </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;&nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$args</span><span class="keyword">[] = </span><span class="string">'N' </span><span class="keyword">. </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$args</span><span class="keyword">[] = </span><span class="default">mt_rand</span><span class="keyword">();&nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$randStr </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">base64_encode</span><span class="keyword">((</span><span class="default">call_user_func_array</span><span class="keyword">(</span><span class="string">'pack'</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">))), </span><span class="default">1</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_prevRand </span><span class="keyword">= </span><span class="default">$randStr</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$randStr</span><span class="keyword">;
<br />

<br />
&nbsp; }
<br />

<br />
&nbsp; public function </span><span class="default">setLength</span><span class="keyword">(</span><span class="default">$l</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length </span><span class="keyword">= (int) </span><span class="default">$l</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length </span><span class="keyword">&lt;= </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Invalid random string length'</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp; }
<br />

<br />
&nbsp; public function </span><span class="default">getPrevRand</span><span class="keyword">() {
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_prevRand</span><span class="keyword">;
<br />

<br />
&nbsp; }
<br />

<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96389""></a>
  <div class="note">
   <strong class="user">wayne</strong>
   <a href="#96389" class="date">24-Feb-2010 04:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A little useful function to create a random unique number out of an array of unallowed values:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">rand_except</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">, </span><span class="default">$max</span><span class="keyword">, </span><span class="default">$except</span><span class="keyword">)<br />
&nbsp; </span><span class="comment">//function returns a random integer between min and max, just like function rand() does.<br />
&nbsp; // Difference to rand is that the random generated number will not use any of the values<br />
&nbsp; // placed in $except. ($except must therefore be an array)<br />
&nbsp; // function returns false if $except holds all values between $min and $max.<br />
&nbsp; </span><span class="keyword">{<br />
&nbsp; </span><span class="comment">//first sort array values<br />
&nbsp; </span><span class="default">sort</span><span class="keyword">(</span><span class="default">$except</span><span class="keyword">, </span><span class="default">SORT_NUMERIC</span><span class="keyword">);<br />
&nbsp; </span><span class="comment">//calculate average gap between except-values<br />
&nbsp; </span><span class="default">$except_count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$except</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$avg_gap </span><span class="keyword">= (</span><span class="default">$max </span><span class="keyword">- </span><span class="default">$min </span><span class="keyword">+ </span><span class="default">1 </span><span class="keyword">- </span><span class="default">$except_count</span><span class="keyword">) / (</span><span class="default">$except_count </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">);<br />
&nbsp; if (</span><span class="default">$avg_gap </span><span class="keyword">&lt;= </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp; </span><span class="comment">//now add min and max to $except, so all gaps between $except-values can be calculated<br />
&nbsp; </span><span class="default">array_unshift</span><span class="keyword">(</span><span class="default">$except</span><span class="keyword">, </span><span class="default">$min </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">);<br />
&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$except</span><span class="keyword">, </span><span class="default">$max </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$except_count </span><span class="keyword">+= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp; </span><span class="comment">//iterate through all values of except. If gap between 2 values is higher than average gap,<br />
&nbsp; // create random in this gap<br />
&nbsp; </span><span class="keyword">for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$except_count</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$except</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] - </span><span class="default">$except</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] - </span><span class="default">1 </span><span class="keyword">&gt;= </span><span class="default">$avg_gap</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">$except</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">, </span><span class="default">$except</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] - </span><span class="default">1</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96022""></a>
  <div class="note">
   <strong class="user">ISAWHIM</strong>
   <a href="#96022" class="date">03-Feb-2010 05:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is not trying to dissuade use of this alternative, just trying to expand on the things to "watch-out-for", when using this...<br />
<br />
As per the description assumption...<br />
"Many random number generators of older libcs have dubious or unknown characteristics and are slow."<br />
<br />
You would elude to the assumption that mt_rand() does not have, "dubious or unknown characteristics". It is obvious that it is faster, but that does not count the additional code required to ensure validity of results, or scope of input value checking.<br />
<br />
This function fails horribly, without error, when operating out of the scope of the range. (Key point being, "without error".)<br />
<br />
mt_getrandmax() is NOT the max INTEGER size. It is limited to positive numbers from ZERO to your integers largest value. Thus, it is HALF the size of an INTEGER, since integers are SIGNED, but mt_rand can only correctly randomize from ZERO to mt_getrandmax(). (Though, that is not entirely true. It can do negative numbers, if the min/max range/spread is not greater than the value of mt_getrandmax()... sometimes.)<br />
<br />
Things to watch-out for... (Sort of negates any speed gains.)<br />
<br />
This assumes you "Attempted" to process MIN&gt;=0 and MAX&lt;=mt_getrandmax().<br />
<br />
Returning a negative value = RANDOMIZER FAILED<br />
Returning a vlaue higher than mt_getrandmax() = RANDOMIZER FAILED<br />
Returning SAME_NUMBER from more than one call = Possibly RANDOMIZER FAILED<br />
Returning a number &lt;MIN or &gt;MAX = RANDOMIZER FAILED<br />
<br />
PHP version 5.2.6 on Apechee 2.0.63 on a Linux server.<br />
Specific instances of failure... (All these still return a value.)<br />
With RAND_MAX reporting that it is '2147483647'.<br />
<br />
<span class="default">&lt;?PHP<br />
</span><span class="comment">// Returns negative numbers as if (-2147483647,0)<br />
</span><span class="default">$z </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">2147483648</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Returns mostly 1 or negative numbers<br />
</span><span class="default">$z </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(-</span><span class="default">2147483647</span><span class="keyword">,</span><span class="default">2147483647</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Returns negative numbers, but within range set???<br />
// So much for returning only values from 0 to Max<br />
</span><span class="default">$z </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(-</span><span class="default">2147483647</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Attempt to stay within the range/spread of mt_getrandmax()<br />
// Results are odd, like 180 to 2147478000<br />
</span><span class="default">$z </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">2147483647</span><span class="keyword">,</span><span class="default">4294967294</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Works, but it should not, as the value is not an INT<br />
// Values are converted to floor(x), so range is (0,0)<br />
</span><span class="default">$z </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0.000001</span><span class="keyword">,</span><span class="default">0.9999999</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Code used to test...<br />
<br />
<span class="default">&lt;?PHP<br />
</span><span class="comment">// Reports the MAX possible, which is half of an INT's value<br />
</span><span class="keyword">echo(</span><span class="string">'RAND_MAX: '</span><span class="keyword">.</span><span class="default">mt_getrandmax</span><span class="keyword">());<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">100000</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br />
</span><span class="comment">// RAND_MAX = 2147483647<br />
</span><span class="default">$z </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">2147483647</span><span class="keyword">);<br />
</span><span class="comment">// echo($z.'&lt;BR&gt;'); // Uncomment to see results, lower LOOP values first!<br />
</span><span class="keyword">if(</span><span class="default">$z</span><span class="keyword">&gt;</span><span class="default">$high </span><span class="keyword">|| !isset(</span><span class="default">$high</span><span class="keyword">)){</span><span class="default">$high</span><span class="keyword">=</span><span class="default">$z</span><span class="keyword">;}<br />
if(</span><span class="default">$z</span><span class="keyword">&lt;</span><span class="default">$low </span><span class="keyword">|| !isset(</span><span class="default">$low</span><span class="keyword">)){</span><span class="default">$low</span><span class="keyword">=</span><span class="default">$z</span><span class="keyword">;}<br />
}<br />
echo(</span><span class="string">'HIGH: '</span><span class="keyword">.</span><span class="default">$high</span><span class="keyword">.</span><span class="string">'&lt;BR&gt;LOW: '</span><span class="keyword">.</span><span class="default">$low</span><span class="keyword">.</span><span class="string">'&lt;BR&gt;'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
To get a number that is actually in the full range of an INT, you need to make two separate calls, and add them together. Then convert that unsigned INT value into a signed INT value.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95683""></a>
  <div class="note">
   <strong class="user">armencho at gmail dot com</strong>
   <a href="#95683" class="date">15-Jan-2010 04:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following function generates a string of arbitrary length (with limitations), composed of random PHP characters (i.e. each an 8-bit value - a byte). Suitable for generating random session strings. Encode as Base64 to transmit over network, where required.<br />
<br />
** The function is pretty much one of the fastest (if not THE fastest) methods of generating random strings, as opposed to numerous examples given on this page which go about with char-by-char generation. Sloppy benchmarks estimate a factor of 10 speedup. Keep your websites lean, people. **<br />
<br />
The only thing to keep in mind is that, by design, it outputs 8-bit characters, and thus the generated string is not automatically suitable for transmission with various network protocols, unless altered, f.e. URL- or Base64- encoded. Also, again by design, the length of the string is a multiple of 4 characters/bytes. The version below produces a 24 character long string. This will also give you a clean input to get a 32 character long Base64 encoded variant of it.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">gen_rand_str_24</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'N6'</span><span class="keyword">, </span><span class="default">mt_rand</span><span class="keyword">(), </span><span class="default">mt_rand</span><span class="keyword">(), </span><span class="default">mt_rand</span><span class="keyword">(),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mt_rand</span><span class="keyword">(), </span><span class="default">mt_rand</span><span class="keyword">(), </span><span class="default">mt_rand</span><span class="keyword">());<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I leave it an exercise to the reader to write a generic (i.e. arbitrary double word length, not 6 dwords as in above) version of it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92711""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#92711" class="date">05-Aug-2009 12:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just another random password generator. Assembles passwords such as these:
<br />

<br />
N_v85kA2_s
<br />
8k4jz94_H0
<br />
30824n6VcN
<br />

<br />
useful for... whatever. ;)
<br />

<br />
$underscores holds the maximum allowed number of underscores. Default is two. The function is programmed to not add an underscore at the beginning or end of the password, right after another underscore, or if the maximum # has already been used.
<br />

<br />
$length holds the length you want the password to be. Default is 10 characters long.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">alphanumericPass</span><span class="keyword">()
<br />
{&nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Do not modify anything below here
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$underscores </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">; </span><span class="comment">// Maximum number of underscores allowed in password
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">10</span><span class="keyword">; </span><span class="comment">// Length of password
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p </span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$length</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)
<br />
&nbsp;&nbsp;&nbsp; {&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">7</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">$c</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case (</span><span class="default">$c</span><span class="keyword">&lt;=</span><span class="default">2</span><span class="keyword">):
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Add a number
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p </span><span class="keyword">.= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">);&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case (</span><span class="default">$c</span><span class="keyword">&lt;=</span><span class="default">4</span><span class="keyword">):
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Add an uppercase letter
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">65</span><span class="keyword">,</span><span class="default">90</span><span class="keyword">));&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case (</span><span class="default">$c</span><span class="keyword">&lt;=</span><span class="default">6</span><span class="keyword">):
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Add a lowercase letter
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">97</span><span class="keyword">,</span><span class="default">122</span><span class="keyword">));&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">7</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$p</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$underscores</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">&amp;&amp;</span><span class="default">$len</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">&amp;&amp;</span><span class="default">$len</span><span class="keyword">&lt;(</span><span class="default">$length</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)&amp;&amp;</span><span class="default">$p</span><span class="keyword">[</span><span class="default">$len</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]!=</span><span class="string">"_"</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p </span><span class="keyword">.= </span><span class="string">"_"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$underscores</span><span class="keyword">--;&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">--;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;&nbsp; &nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$p</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89057""></a>
  <div class="note">
   <strong class="user">mark omohundro, ajamyajax dot com</strong>
   <a href="#89057" class="date">19-Feb-2009 06:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
just another example: both of these routines return a random decimal number between -1 and 1... since rand() only returns a max 'integer' value while mt_rand() return a max 'long' value -- at least on some platforms -- mt_rand() could be the better precision choice for some on any variation to this routine (but i don't think it matters here):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">"-1 to 1 rand() value: "</span><span class="keyword">. (</span><span class="default">rand</span><span class="keyword">(</span><span class="default">getrandmax</span><span class="keyword">()*-</span><span class="default">1</span><span class="keyword">,</span><span class="default">getrandmax</span><span class="keyword">())/</span><span class="default">getrandmax</span><span class="keyword">()). </span><span class="string">"\n&lt;br/&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"-1 to 1 mt_rand() value: "</span><span class="keyword">. (</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">mt_getrandmax</span><span class="keyword">()*-</span><span class="default">1</span><span class="keyword">,</span><span class="default">mt_getrandmax</span><span class="keyword">())/</span><span class="default">mt_getrandmax</span><span class="keyword">()). </span><span class="string">"\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85828""></a>
  <div class="note">
   <strong class="user">xphere81 at hotmail dot com</strong>
   <a href="#85828" class="date">19-Sep-2008 01:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@Jonathon<br />
<br />
$id_list = range($min, $max);<br />
shuffle($id_list);<br />
<br />
This is a faster way to obtain a list of unique id's in a random order.<br />
It's always better to use PHP predefined functions, isn't it? ;)<br />
<br />
Also remember that calling mt_rand too many times can downgrade the performance of ANY algorithm.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85386""></a>
  <div class="note">
   <strong class="user">rt</strong>
   <a href="#85386" class="date">28-Aug-2008 02:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Re: euxneks at NOSPAMgmail dot com<br />
<br />
You might also want to add STR_PAD_LEFT and have:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">'#' </span><span class="keyword">. </span><span class="default">str_pad</span><span class="keyword">( </span><span class="default">base_convert</span><span class="keyword">( </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, ( </span><span class="default">255</span><span class="keyword">*</span><span class="default">255</span><span class="keyword">*</span><span class="default">255</span><span class="keyword">) ), </span><span class="default">10</span><span class="keyword">, </span><span class="default">16 </span><span class="keyword">), </span><span class="default">6</span><span class="keyword">, </span><span class="string">'0'</span><span class="keyword">, </span><span class="default">STR_PAD_LEFT</span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85172""></a>
  <div class="note">
   <strong class="user">euxneks at NOSPAMgmail dot com</strong>
   <a href="#85172" class="date">19-Aug-2008 12:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Re: keith at ourwebsite dot ca<br />
<br />
Here's another way to do it, in one line :)<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">'#' </span><span class="keyword">. </span><span class="default">str_pad</span><span class="keyword">( </span><span class="default">base_convert</span><span class="keyword">( </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, ( </span><span class="default">255</span><span class="keyword">*</span><span class="default">255</span><span class="keyword">*</span><span class="default">255</span><span class="keyword">) ), </span><span class="default">10</span><span class="keyword">, </span><span class="default">16 </span><span class="keyword">), </span><span class="default">6</span><span class="keyword">, </span><span class="string">'0' </span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
str_pad is there in case mt_rand chooses a number that will generate a hex value with less than 6 characters. (you could leave that out but it's not a very clean way to write the hex colors is it :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83655""></a>
  <div class="note">
   <strong class="user">Mark Seecof</strong>
   <a href="#83655" class="date">06-Jun-2008 08:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need some pseudorandom bits for security or cryptographic purposes (e.g.g., random IV for block cipher, random salt for password hash) mt_rand() is a poor source.&nbsp; On most Unix/Linux and/or MS-Windows platforms you can get a better grade of pseudorandom bits from the OS or system library, like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// get 128 pseudorandom bits in a string of 16 bytes<br />
<br />
</span><span class="default">$pr_bits </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Unix/Linux platform?<br />
</span><span class="default">$fp </span><span class="keyword">= @</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/dev/urandom'</span><span class="keyword">,</span><span class="string">'rb'</span><span class="keyword">);<br />
if (</span><span class="default">$fp </span><span class="keyword">!== </span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pr_bits </span><span class="keyword">.= @</span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">,</span><span class="default">16</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">// MS-Windows platform?<br />
</span><span class="keyword">if (@</span><span class="default">class_exists</span><span class="keyword">(</span><span class="string">'COM'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// <a href="http://msdn.microsoft.com/en-us/library/aa388176(VS.85" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/aa388176(VS.85</a>).aspx<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">try {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CAPI_Util </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'CAPICOM.Utilities.1'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pr_bits </span><span class="keyword">.= </span><span class="default">$CAPI_Util</span><span class="keyword">-&gt;</span><span class="default">GetRandom</span><span class="keyword">(</span><span class="default">16</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// if we ask for binary data PHP munges it, so we<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // request base64 return value.&nbsp; We squeeze out the<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // redundancy and useless ==CRLF by hashing...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$pr_bits</span><span class="keyword">) { </span><span class="default">$pr_bits </span><span class="keyword">= </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$pr_bits</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">); }<br />
&nbsp;&nbsp;&nbsp; } catch (</span><span class="default">Exception $ex</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// echo 'Exception: ' . $ex-&gt;getMessage();<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
<br />
if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$pr_bits</span><span class="keyword">) &lt; </span><span class="default">16</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// do something to warn system owner that<br />
&nbsp;&nbsp;&nbsp; // pseudorandom generator is missing<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
NB: it is generally safe to leave both the attempt to read /dev/urandom and the attempt to access CAPICOM in your code, though each will fail silently on the other's platform.&nbsp; Leave them both there so your code will be more portable.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82579""></a>
  <div class="note">
   <strong class="user">Jonathon</strong>
   <a href="#82579" class="date">17-Apr-2008 10:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Below, andrei suggested a function for generating a list of unique integers, randomly arranged.&nbsp; In response to a note below that his solution is inefficient, I'm providing an O(N) solution which should be much more efficient, yet still yield a good guarantee of producing randomly ordered integers.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">SwapShuffle</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">, </span><span class="default">$max</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$last </span><span class="keyword">= </span><span class="default">$max </span><span class="keyword">- </span><span class="default">$min</span><span class="keyword">;<br />
<br />
&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">$last</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">$min </span><span class="keyword">+ </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; for (</span><span class="default">$run</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$run</span><span class="keyword">&lt;</span><span class="default">7</span><span class="keyword">; </span><span class="default">$run</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">$last</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$target </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$last</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$swap </span><span class="keyword">= </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$target</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$target</span><span class="keyword">] = </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">$swap</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
<br />
&nbsp; return </span><span class="default">$arr</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// Call as:<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">SwapShuffle</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">);<br />
foreach (</span><span class="default">$result </span><span class="keyword">as </span><span class="default">$num</span><span class="keyword">) {<br />
&nbsp; echo </span><span class="string">"</span><span class="default">$num</span><span class="string">\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82156""></a>
  <div class="note">
   <strong class="user">geompse at yopmail dot com</strong>
   <a href="#82156" class="date">29-Mar-2008 01:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mt_rand() is not faster than rand() !<br />
<br />
Tested over 100'000 iterations, with none/various/random arguments, mt_rand is always 3% slower than rand().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81084""></a>
  <div class="note">
   <strong class="user">William Leslie</strong>
   <a href="#81084" class="date">13-Feb-2008 06:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Do not rely on the strength of any 'home-brewed' cryptographic algorithm, such as the one posted by dmoree at coker dot edu.&nbsp; Algorithms such as MD5 and SHA-1 have been the subject of intense academic research and have known security properties.<br />
<br />
While it is true that MD5 and SHA-1 are generally no longer recommended for use in new cryptosystems, there are newer algorithms such as SHA-256 that address the older algorithms' weaknesses.&nbsp; These newer algorithms have not received quite as much scrutiny as their older counterparts, but have still been studied much more carefully than your home-brewed algorithm, most likely.<br />
<br />
Dmoree at coker dot edu's concern about rainbow tables is best addressed by a properly applied salting technique.&nbsp; Every bit of 'salt' added to a cryptographic hash effectively extends the complexity of the password and thus the size of the rainbow table needed to crack it.<br />
<br />
Furthermore, wisely chosen password strength policies can mitigate such attacks.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79141""></a>
  <div class="note">
   <strong class="user">fabiovh on gmail</strong>
   <a href="#79141" class="date">13-Nov-2007 03:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
performance: for a repetitive task, it's much faster not to use the limit parameters, as shown below. just use the % operator.<br />
<br />
$t=microtime(true);<br />
for($i=0;$i&lt;1000000;$i++)<br />
&nbsp;mt_rand()%3;<br />
echo microtime(true)-$t;<br />
<br />
echo '|';<br />
<br />
$t=microtime(true);<br />
for($i=0;$i&lt;1000000;$i++)<br />
&nbsp;mt_rand(0,2);<br />
echo microtime(true)-$t;<br />
<br />
echo '|';<br />
<br />
$t=microtime(true);<br />
for($i=0;$i&lt;1000000;$i++)<br />
&nbsp;mt_rand();<br />
echo microtime(true)-$t;<br />
<br />
output: 0.316797971725|0.442242145538|0.253082036972</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78235""></a>
  <div class="note">
   <strong class="user">bradpeabody at scientology dot net</strong>
   <a href="#78235" class="date">03-Oct-2007 11:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editorial note: This suggested "security" improvement simply punts the issue to the operating system: there is no guarantee that the operating system will work any better than the Mersenne twister (although it may have more entropy available)]
<br />

<br />
If you want some random text that is more secure than what can get from a built in PHP method, you can simply do:
<br />

<br />
<span class="default">&lt;?php
<br />
$myRandomText </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">'head -c 128 &lt; /dev/urandom'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
That will get around the fact that rand() and mt_rand() are a bad place to start generating something that is supposed to be cryptographically secure.
<br />

<br />
The only down sides to this that I see are:
<br />
a) Ugly
<br />
b) Slow (have to launch external processes)
<br />
c) Not portable (can't do this on Windows)
<br />

<br />
But if you can live with that, this will be much more secure than using rand() or mt_rand().
<br />

<br />
- Brad</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76658""></a>
  <div class="note">
   <strong class="user">www.mrnaz.com</strong>
   <a href="#76658" class="date">25-Jul-2007 07:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function uses mt_rand() to create a random string of specified length from an optionally supplied string of characters. It is good for generating passwords that only consist of alphanumeric characters or codes that must consist of a defined character space such as for barcodes. It can also be used to generate random hexadecimal numbers for things like encryption keys.<br />
<br />
It is very fast, and allows for generation of strings of unlimited length.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">rand_string</span><span class="keyword">(</span><span class="default">$len</span><span class="keyword">, </span><span class="default">$chars </span><span class="keyword">= </span><span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$chars</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">.= </span><span class="default">$chars</span><span class="keyword">{</span><span class="default">$pos</span><span class="keyword">};<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75793""></a>
  <div class="note">
   <strong class="user">rok dot kralj at gmail dot com</strong>
   <a href="#75793" class="date">16-Jun-2007 09:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mt_rand function returns just a whole numbers. If you want a random float, then here's an elegant way:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">random_float </span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">,</span><span class="default">$max</span><span class="keyword">) {<br />
&nbsp;&nbsp; return (</span><span class="default">$min</span><span class="keyword">+</span><span class="default">lcg_value</span><span class="keyword">()*(</span><span class="default">abs</span><span class="keyword">(</span><span class="default">$max</span><span class="keyword">-</span><span class="default">$min</span><span class="keyword">)));<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74036""></a>
  <div class="note">
   <strong class="user">chagenbu at php dot net</strong>
   <a href="#74036" class="date">21-Mar-2007 06:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The algorithm used by mt_rand() changed in PHP 5.2.1. If you are relying on getting the same sequence from mt_rand() after calling mt_srand() with a known seed, upgrading to PHP 5.2.1 will break your code. See <a href="http://bugs.php.net/bug.php?id=40724 for something of an explanation; there is no workaround." rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=40724 for something of an explanation; there is no workaround.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73823""></a>
  <div class="note">
   
   <a href="#73823" class="date">12-Mar-2007 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In one of my forums was a discussion about, how to change an image randomly, so i wrote this code using mt_rand .... <br />
<br />
I hope you can use it .... <br />
<br />
I Forgot something, sorry for that, but here is the correction.<br />
<br />
<span class="default">&lt;?php <br />
&nbsp; </span><span class="comment">//ImageChange.php <br />
<br />
&nbsp; </span><span class="default">error_reporting</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);</span><span class="comment">//hide the notice for the missing $iRand<br />
<br />
&nbsp; </span><span class="default">$sPath2ImageDir </span><span class="keyword">= </span><span class="default">Path</span><span class="keyword">;</span><span class="comment">//preventing redundancy<br />
&nbsp; </span><span class="default">$aImages&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$sBildOrdnerPfad</span><span class="keyword">);</span><span class="comment">//Dir 2 Array<br />
&nbsp; </span><span class="default">$iImageCount&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$aImages</span><span class="keyword">);</span><span class="comment">//preventing redundancy<br />
&nbsp;<br />
&nbsp; </span><span class="keyword">while (</span><span class="default">getimagesize</span><span class="keyword">(</span><span class="string">"{sPath2ImageDir}/</span><span class="keyword">{</span><span class="default">$aImages</span><span class="keyword">[</span><span class="default">$iRand</span><span class="keyword">]}</span><span class="string">"</span><span class="keyword">)) {</span><span class="comment">//recursion to get an image<br />
&nbsp;&nbsp; </span><span class="default">$iRand </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">$iImageCount</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">);</span><span class="comment">//min = 2 because $aImages[0] = "." and $aImages[1] = ".."<br />
&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; <br />
&nbsp; echo </span><span class="string">"&lt;img alt=\"Image</span><span class="keyword">{</span><span class="default">$iRand</span><span class="keyword">}</span><span class="string">\" src=\"{sPath2ImageDir}/</span><span class="keyword">{</span><span class="default">$aImages</span><span class="keyword">[</span><span class="default">$iRand</span><span class="keyword">]}</span><span class="string">\" title=\"Image</span><span class="keyword">{</span><span class="default">$iRand</span><span class="keyword">}</span><span class="string">\" /&gt;"</span><span class="keyword">;</span><span class="comment">//show the image<br />
<br />
&nbsp; </span><span class="keyword">unset(</span><span class="default">$aImages</span><span class="keyword">, </span><span class="default">$iImageCount</span><span class="keyword">, </span><span class="default">$iRand</span><span class="keyword">, </span><span class="default">$sBildOrdnerPfad</span><span class="keyword">);</span><span class="comment">//if this script is used in another script<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73799""></a>
  <div class="note">
   <strong class="user">Rene at mokiba dot de</strong>
   <a href="#73799" class="date">10-Mar-2007 11:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is my Function to generate an Array with unique random Numbers between "$from" and "$to".<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">random_number_array</span><span class="keyword">(</span><span class="default">$count</span><span class="keyword">, </span><span class="default">$from</span><span class="keyword">, </span><span class="default">$to</span><span class="keyword">){<br />
&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">$from</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$to</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; </span><span class="default">$number_array</span><span class="keyword">[] = </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; </span><span class="default">$random_number_array </span><span class="keyword">= array();<br />
&nbsp;&nbsp; </span><span class="default">mt_srand </span><span class="keyword">((double) </span><span class="default">microtime</span><span class="keyword">() * </span><span class="default">1000000</span><span class="keyword">);<br />
&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$count</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$random_number&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">count</span><span class="keyword">(</span><span class="default">$number_array</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$key_to_insert_and_delete </span><span class="keyword">= </span><span class="default">array_search</span><span class="keyword">(</span><span class="default">$random_number</span><span class="keyword">, </span><span class="default">$number_array</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$random_number_array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]&nbsp; &nbsp; = </span><span class="default">$number_array</span><span class="keyword">[</span><span class="default">$key_to_insert_and_delete</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">array_splice</span><span class="keyword">(</span><span class="default">$number_array</span><span class="keyword">, </span><span class="default">$key_to_insert_and_delete</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; </span><span class="comment">// Array $random_number_array with $count random Numbers, between $from and $to<br />
&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$random_number_array</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
I hope its helping you.<br />
<br />
Greetings<br />
<br />
Rene Andris</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73797""></a>
  <div class="note">
   <strong class="user">Rene at mokiba dot de</strong>
   <a href="#73797" class="date">10-Mar-2007 08:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is my Function to generate an Array with unique random Numbers between "$from" and "$to".<br />
<br />
function random_number_array($count, $from, $to){<br />
&nbsp;&nbsp; for($i=$from;$i&lt;$to;$i++){<br />
&nbsp;&nbsp;&nbsp; $number_array[] = $i;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; $random_number_array = array();<br />
&nbsp;&nbsp; mt_srand ((double) microtime() * 1000000);<br />
&nbsp;&nbsp; for($i=0;$i&lt;$count;$i++){<br />
&nbsp;&nbsp; &nbsp;&nbsp; $random_number&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = mt_rand(0,count($number_array)-1);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $key_to_insert_and_delete = array_search($random_number, $number_array);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $random_number_array[$i]&nbsp; &nbsp; = $number_array[$key_to_insert_and_delete];<br />
&nbsp;&nbsp; &nbsp;&nbsp; array_splice($number_array, $key_to_insert_and_delete, 1);<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; // Array $random_number_array with $count random Numbers, between $from and $to<br />
&nbsp;&nbsp; return $random_number_array;<br />
}<br />
<br />
I hope its helping you.<br />
<br />
Greetings<br />
<br />
Rene Andris</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73237""></a>
  <div class="note">
   <strong class="user">heavyraptor</strong>
   <a href="#73237" class="date">14-Feb-2007 12:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
since my mt_rand_n() function isn't too fast I created a faster and easier function:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mt_rand_exclusive</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">,</span><span class="default">$max</span><span class="keyword">,</span><span class="default">$ex</span><span class="keyword">) {<br />
&nbsp; while (</span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$rand </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">,</span><span class="default">$max</span><span class="keyword">),(array)</span><span class="default">$ex</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$rand</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Have fun</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73077""></a>
  <div class="note">
   <strong class="user">zolaar at nothanks dot com</strong>
   <a href="#73077" class="date">08-Feb-2007 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a better (and likely faster) way to generate a random 6-digit hex string:<br />
<br />
<span class="default">&lt;?php<br />
$num </span><span class="keyword">= </span><span class="default">mt_rand </span><span class="keyword">( </span><span class="default">0</span><span class="keyword">, </span><span class="default">0xffffff </span><span class="keyword">); </span><span class="comment">// trust the library, love the library...<br />
</span><span class="default">$output </span><span class="keyword">= </span><span class="default">sprintf </span><span class="keyword">( </span><span class="string">"%06x" </span><span class="keyword">, </span><span class="default">$num </span><span class="keyword">); </span><span class="comment">// muchas smoochas to you, PHP!<br />
</span><span class="keyword">return </span><span class="default">$output</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
The mt_rand function won't give you a number outside the bounds you asked for -- no need to and-off the top bits -- and the sprintf function has params for length-padding &amp; hexidecimal output.&nbsp; It's likely faster because most of the work is being done by the wicked fast C functions that PHP sits on top of, though YMMV in that dept.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71275""></a>
  <div class="note">
   <strong class="user">MagicalTux at ooKoo dot org</strong>
   <a href="#71275" class="date">20-Nov-2006 04:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In answer to David and pHp_n00b, about generating a random 6 characters hexadecimal string...<br />
<br />
Well, the easiest solution would be :<br />
<span class="default">&lt;?php<br />
$rand </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0x000000</span><span class="keyword">, </span><span class="default">0xffffff</span><span class="keyword">); </span><span class="comment">// generate a random number between 0 and 0xffffff<br />
</span><span class="default">$rand </span><span class="keyword">= </span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$rand </span><span class="keyword">&amp; </span><span class="default">0xffffff</span><span class="keyword">); </span><span class="comment">// make sure we're not over 0xffffff, which shouldn't happen anyway<br />
</span><span class="default">$rand </span><span class="keyword">= </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$rand</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">, </span><span class="string">'0'</span><span class="keyword">, </span><span class="default">STR_PAD_LEFT</span><span class="keyword">); </span><span class="comment">// add zeroes in front of the generated string<br />
</span><span class="keyword">echo </span><span class="default">$rand</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Some examples of generated stuff :<br />
8514d2<br />
3188ae<br />
028f3e<br />
444397<br />
1de508<br />
071662<br />
<br />
You can easily make a function from this code.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71075""></a>
  <div class="note">
   <strong class="user">Chris</strong>
   <a href="#71075" class="date">10-Nov-2006 08:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&gt;Running the output of Mersenne Twister through an unkeyed &gt;secure hash is NOT a good way to make it secure, because it'll &gt;still have a relatively small internal state which, if recovered, &gt;would allow reproduction of the keystream.&nbsp; A better idea &gt;would be to encrypt the output with a keyed encryption &gt;algorithm - but if you were going to do that, you wouldn't &gt;need a psuedorandom number generator at all, because a &gt;counter would be just as good.<br />
<br />
Not true. Mersenne Twister has an ENORMOUS amount of internal state - 4992 bits, bigger than practically any cipher's key length. The point of a secure random number generator is that you cannot predict future outputs based on past OUTPUTS, which is why a hash is applied. Clearly you can predict the future output of any pseudorandom number generator if you can acquire the internal state - a better algorithm will never solve this problem. If you use keyed encryption, recovering the key allows you to predict future outputs.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70952""></a>
  <div class="note">
   <strong class="user">David</strong>
   <a href="#70952" class="date">06-Nov-2006 09:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Shouldn't it be a greater than (&gt;) sign rather than a not equal (!=) sign? Because you're just checking to see if it is exactly six. So if it is 7 it, won't try to fix it. So wouldn't this be better?<br />
&lt;?<br />
//....<br />
if (strlen($random_hex) &lt; "6") // sometimes it returns an only 5, or less, char Hex-Code,<br />
&nbsp;&nbsp; hexcode();&nbsp; &nbsp; &nbsp; &nbsp; // so the function has to be repeat<br />
elseif (strlen($random_hex) &gt; "6") // sometimes it returns 7 or more characters<br />
//...I don't know how to make it do only six, but your code seems to only check to make sure it doesn't do less than 6; nothing to counter doing more than 6.... so here would be some code to reduce the size back to 6 if it went over.<br />
else<br />
&nbsp;&nbsp; echo $random_hex; // returns the Hex-Code<br />
}<br />
//...<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69917""></a>
  <div class="note">
   <strong class="user">pHp_n00b</strong>
   <a href="#69917" class="date">26-Sep-2006 04:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Generates a max."6 char" Hex-Code<br />
<br />
</span><span class="keyword">function </span><span class="default">hexcode</span><span class="keyword">()<br />
{<br />
<br />
</span><span class="default">$min </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="string">"000000"</span><span class="keyword">); </span><span class="comment">// result is 0&nbsp; &nbsp; and sets the min-value for mt_rand<br />
</span><span class="default">$max </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="string">"FFFFFF"</span><span class="keyword">); </span><span class="comment">// result is 16777215 and sets the max-value for mt_rand<br />
<br />
</span><span class="default">$random </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">, </span><span class="default">$max</span><span class="keyword">); </span><span class="comment">// creates a radom number between 0 and 16777215<br />
<br />
</span><span class="default">$random_hex </span><span class="keyword">= </span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$random</span><span class="keyword">); </span><span class="comment">// transforms the random number into a Hex-Code<br />
<br />
// now the test, if the result has 6 chars<br />
<br />
</span><span class="keyword">if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$random_hex</span><span class="keyword">) != </span><span class="string">"6"</span><span class="keyword">) </span><span class="comment">// sometimes it returns an only 5, or less, char Hex-Code, <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">hexcode</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// so the function has to be repeat<br />
</span><span class="keyword">else<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$random_hex</span><span class="keyword">; </span><span class="comment">// returns the Hex-Code<br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">hexcode</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69171""></a>
  <div class="note">
   <strong class="user">MagicalTux at ooKoo dot org</strong>
   <a href="#69171" class="date">25-Aug-2006 02:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since many people wrote little scripts to generate random sequences, I'll also give mine (which is slightly faster since it makes use of strlen only once, and uses strings instead of arrays) :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">code</span><span class="keyword">(</span><span class="default">$nc</span><span class="keyword">, </span><span class="default">$a</span><span class="keyword">=</span><span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$l</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">; </span><span class="default">$r</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">$nc</span><span class="keyword">--&gt;</span><span class="default">0</span><span class="keyword">) </span><span class="default">$r</span><span class="keyword">.=</span><span class="default">$a</span><span class="keyword">{</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$l</span><span class="keyword">)};<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$r</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66785""></a>
  <div class="note">
   <strong class="user">arias at elleondeoro dot com</strong>
   <a href="#66785" class="date">29-May-2006 11:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be carefull with: $characters[mt_rand(0, count($characters))];<br />
<br />
"If you want a random number between 5 and 15 (inclusive), for example, use mt_rand (5, 15)."<br />
<br />
Array index are between 0 and n-1, but mt_rand generates a number between 0 and n!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64488""></a>
  <div class="note">
   <strong class="user">James</strong>
   <a href="#64488" class="date">16-Apr-2006 08:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The Developers Resources article mentioned above should be removed as that site has be down for years. The same article by Gregory Boshoff is available at <a href="http://www.phpfive.net/article2.htm" rel="nofollow" target="_blank">http://www.phpfive.net/article2.htm</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57611""></a>
  <div class="note">
   <strong class="user">fahri at konse dot de</strong>
   <a href="#57611" class="date">08-Oct-2005 06:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i did the following, to generate a few random-numbers out of a total amount of numbers, but to create different random-numbers and not double or tripple.<br />
for example i use it to generate 10 random-pics out of 150, and do shurely generate not twice the same...<br />
<br />
<span class="default">&lt;?php<br />
$total </span><span class="keyword">=&nbsp; </span><span class="default">6</span><span class="keyword">; </span><span class="comment">// available numbers (of pictures)<br />
</span><span class="default">$randanzahl </span><span class="keyword">= </span><span class="default">6</span><span class="keyword">; </span><span class="comment">//number of random-number to generate out of $total<br />
<br />
</span><span class="keyword">function </span><span class="default">checkifdouble</span><span class="keyword">(</span><span class="default">$ran</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$j</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$i</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$ran</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">]==</span><span class="default">$ran</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ergebnis</span><span class="keyword">=</span><span class="string">"true"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } </span><span class="comment">//endif<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ergebnis</span><span class="keyword">=</span><span class="string">"false"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } </span><span class="comment">//endelse<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} </span><span class="comment">//endfor<br />
</span><span class="keyword">return </span><span class="default">$ergebnis</span><span class="keyword">;<br />
}<br />
<br />
for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">$randanzahl</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$ran</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">$total</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; if (</span><span class="default">$i</span><span class="keyword">&gt;</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while(</span><span class="default">checkifdouble</span><span class="keyword">(</span><span class="default">$ran</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">)==</span><span class="string">"true"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$ran</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">$total</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$v</span><span class="keyword">=</span><span class="default">checkifdouble</span><span class="keyword">(</span><span class="default">$ran</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo(</span><span class="default">$v</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } </span><span class="comment">//endif<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo(</span><span class="default">$ran</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="string">"&lt;br&gt;"</span><span class="keyword">);<br />
<br />
} </span><span class="comment">//enfor<br />
</span><span class="default">?&gt;<br />
</span><br />
this version is easily for debugging and adaption!<br />
maybe there is a very shorter version...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57409""></a>
  <div class="note">
   <strong class="user">frans-jan at van-steenbeek dot net</strong>
   <a href="#57409" class="date">03-Oct-2005 04:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My try at generating a reasonably secure password:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;</span><span class="keyword">function </span><span class="default">keygen</span><span class="keyword">() {<br />
&nbsp; </span><span class="default">$tempstring </span><span class="keyword">=<br />
&nbsp; </span><span class="string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNO<br />
&nbsp; PQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyzABC<br />
&nbsp; DEFGHIJKLMNOPQRSTUVWXYZ!?@#$%&amp;*[]{}();:,&lt;&gt;~+=-_<br />
&nbsp; /|\\"</span><span class="keyword">;<br />
&nbsp; for(</span><span class="default">$length </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$length </span><span class="keyword">&lt; </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">); </span><span class="default">$length</span><span class="keyword">++) {<br />
&nbsp;&nbsp; </span><span class="default">$temp </span><span class="keyword">= </span><span class="default">str_shuffle</span><span class="keyword">(</span><span class="default">$tempstring</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$char </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$temp</span><span class="keyword">));<br />
&nbsp;&nbsp; </span><span class="default">$pass </span><span class="keyword">.= </span><span class="default">$temp</span><span class="keyword">[</span><span class="default">$char</span><span class="keyword">];<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$pass</span><span class="keyword">;<br />
&nbsp;}<br />
&nbsp;echo(</span><span class="default">keygen</span><span class="keyword">());<br />
&nbsp;echo(</span><span class="string">"\n"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This generates a password of an undefined length (in this case, 10 to 15 chars) consisting of numbers, UPPERCASE letters lowercase letters and a set of signs. I have doubled the chance of number and letters to reduce the confusion with my users.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55013""></a>
  <div class="note">
   <strong class="user">sean at codeaholics dot com</strong>
   <a href="#55013" class="date">22-Jul-2005 03:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You really shouldn't generate a number to determine the _type_ of the char, then the char itself.&nbsp; If security is an issue for you, and you want to maintain as much entropy as possible, you should use a function similar to the one below.&nbsp; Since this seems to be getting repeated over-and-over, I explained (beat into the ground?) the issue on <a href="http://www.codeaholics.com/randomCode.php" rel="nofollow" target="_blank">http://www.codeaholics.com/randomCode.php</a>
<br />

<br />
The code:
<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">////
<br />
// Returns a random code of the specified length, containing characters that are
<br />
// equally likely to be any of the digits, uppercase letters, or&nbsp; lowercase letters.
<br />
//
<br />
// The default length of 10 provides 839299365868340224 (62^10) possible codes.
<br />
//
<br />
// NOTE: Do not call wt_srand().&nbsp; It is handled automatically in PHP 4.2.0 and above
<br />
//&nbsp; &nbsp; &nbsp;&nbsp; and any additional calls are likely to DECREASE the randomness.
<br />
////
<br />
</span><span class="keyword">function </span><span class="default">randomCode</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">=</span><span class="default">10</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$retVal </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$retVal</span><span class="keyword">) &lt; </span><span class="default">$length</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nextChar </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">61</span><span class="keyword">); </span><span class="comment">// 10 digits + 26 uppercase + 26 lowercase = 62 chars
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if((</span><span class="default">$nextChar </span><span class="keyword">&gt;=</span><span class="default">10</span><span class="keyword">) &amp;&amp; (</span><span class="default">$nextChar </span><span class="keyword">&lt; </span><span class="default">36</span><span class="keyword">)){ </span><span class="comment">// uppercase letters
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nextChar </span><span class="keyword">-= </span><span class="default">10</span><span class="keyword">; </span><span class="comment">// bases the number at 0 instead of 10
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nextChar </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$nextChar </span><span class="keyword">+ </span><span class="default">65</span><span class="keyword">); </span><span class="comment">// ord('A') == 65
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} else if(</span><span class="default">$nextChar </span><span class="keyword">&gt;= </span><span class="default">36</span><span class="keyword">){ </span><span class="comment">// lowercase letters
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nextChar </span><span class="keyword">-= </span><span class="default">36</span><span class="keyword">; </span><span class="comment">// bases the number at 0 instead of 36
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nextChar </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$nextChar </span><span class="keyword">+ </span><span class="default">97</span><span class="keyword">); </span><span class="comment">// ord('a') == 97
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} else { </span><span class="comment">// 0-9
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nextChar </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$nextChar </span><span class="keyword">+ </span><span class="default">48</span><span class="keyword">); </span><span class="comment">// ord('0') == 48
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$retVal </span><span class="keyword">.= </span><span class="default">$nextChar</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$retVal</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53158""></a>
  <div class="note">
   <strong class="user">mina86 at nospam dot projektcode dot org</strong>
   <a href="#53158" class="date">25-May-2005 02:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Re: solenoid at hotmail dot united dot kingdom<br />
<br />
In theory method shown by selenoid can lead to infinite loop. The correct method would be:<br />
<br />
<span class="default">&lt;?php<br />
$randomNumbers </span><span class="keyword">= array();<br />
for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">i</span><span class="keyword">&lt;</span><span class="default">30</span><span class="keyword">; ++</span><span class="default">$i</span><span class="keyword">) </span><span class="default">$randomNumbers</span><span class="keyword">[] = </span><span class="default">$i</span><span class="keyword">;<br />
</span><span class="default">shuffle</span><span class="keyword">(</span><span class="default">$randomNumbers</span><span class="keyword">);<br />
for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">20</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">30</span><span class="keyword">; ++</span><span class="default">$i</span><span class="keyword">) unset(</span><span class="default">$randomNumbers</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
</span><span class="default">$randomNumbers </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$randomNumbers</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
The last two lines may be in some cases removed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51948""></a>
  <div class="note">
   <strong class="user">nowhere at where dot net</strong>
   <a href="#51948" class="date">16-Apr-2005 11:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Allows characters 0-9, a-z<br />
Weighted (and tested) ok.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">generate_string </span><span class="keyword">(</span><span class="default">$length </span><span class="keyword">= </span><span class="default">20</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nps </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$length</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nps </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">( (</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">36</span><span class="keyword">) &lt;= </span><span class="default">26</span><span class="keyword">) ? </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">97</span><span class="keyword">, </span><span class="default">122</span><span class="keyword">) : </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">48</span><span class="keyword">, </span><span class="default">57 </span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nps</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49313""></a>
  <div class="note">
   <strong class="user">mskala at ansuz dot sooke dot bc dot ca</strong>
   <a href="#49313" class="date">24-Jan-2005 12:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Running the output of Mersenne Twister through an unkeyed secure hash is NOT a good way to make it secure, because it'll still have a relatively small internal state which, if recovered, would allow reproduction of the keystream.&nbsp; A better idea would be to encrypt the output with a keyed encryption algorithm - but if you were going to do that, you wouldn't need a psuedorandom number generator at all, because a counter would be just as good.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39805""></a>
  <div class="note">
   
   <a href="#39805" class="date">11-Feb-2004 02:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a example of a very small, compact, quite random-random string generator. It will make a string with uppercase &amp; lowercase letters, with numbers. You simply need to set $len in the for() structure, and then the string will be in $r.&nbsp; It has been designed for size, while it's still quite fast.&nbsp; Mind the wrapping, it should be 1 line.<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">for(</span><span class="default">$len</span><span class="keyword">=</span><span class="default">8</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">)&lt;</span><span class="default">$len</span><span class="keyword">;</span><span class="default">$r</span><span class="keyword">.=</span><span class="default">chr</span><span class="keyword">(!</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">)?<br />
</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">48</span><span class="keyword">,</span><span class="default">57</span><span class="keyword">):(!</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)?</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">65</span><span class="keyword">,</span><span class="default">90</span><span class="keyword">):</span><span class="default">mt_rand<br />
</span><span class="keyword">(</span><span class="default">97</span><span class="keyword">,</span><span class="default">122</span><span class="keyword">))));<br />
</span><span class="default">?&gt;<br />
</span><br />
Armond Carroll</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38062""></a>
  <div class="note">
   <strong class="user">tmx at ntlworld dot com</strong>
   <a href="#38062" class="date">06-Dec-2003 10:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using this function, it doesn't matter which order the numbers go in.<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; mt_rand(16,5)<br />
<br />
works just as well as<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; mt_rand(5,16)<br />
<br />
Which can be useful if you are pulling values from a database, that could be negative or positive.<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; mtrand(0,$anyinteger)<br />
<br />
Hope this helps someone</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32698""></a>
  <div class="note">
   <strong class="user">jsheets at shadonet dot com</strong>
   <a href="#32698" class="date">04-Jun-2003 10:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following function will create a random base64 encoded key, this is very useful for password reset schemes or anything where you want a random string.&nbsp; To compare the string either compare the base64 encoded value or base64_decode it and compare that.
<br />

<br />
I do not use md5 because md5 results in only 1-9 and a-f in the string or 32^16 possibilities, by using the extended ASCII table and shuffling the array I am able to get a minimum of 32^127 possibilities with a 32 character string, using a longer string will make your value harder to guess still. A lot of machiens will have 32^255 possibilities in a decoded string.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">MakeResetKey</span><span class="keyword">(</span><span class="default">$min_length </span><span class="keyword">= </span><span class="default">32</span><span class="keyword">, </span><span class="default">$max_length </span><span class="keyword">= </span><span class="default">64</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">// build range and shuffle range using ASCII table
<br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">255</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$range</span><span class="keyword">[] = </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">);
<br />
&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">// shuffle our range 3 times
<br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">3</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">shuffle</span><span class="keyword">(</span><span class="default">$range</span><span class="keyword">);
<br />
&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// loop for random number generation
<br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">$min_length</span><span class="keyword">, </span><span class="default">$max_length</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">.= </span><span class="default">$range</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">count</span><span class="keyword">(</span><span class="default">$range</span><span class="keyword">))];
<br />
&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; if (!empty(</span><span class="default">$return</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;
<br />
&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19541""></a>
  <div class="note">
   <strong class="user">demogracia at metropoliglobal dot com</strong>
   <a href="#19541" class="date">02-Mar-2002 09:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="comment">//
<br />
// Generates a random string with the specified length
<br />
// Chars are chosen from the provided [optional] list
<br />
//
<br />
</span><span class="keyword">function </span><span class="default">simpleRandString</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">=</span><span class="default">16</span><span class="keyword">, </span><span class="default">$list</span><span class="keyword">=</span><span class="string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mt_srand</span><span class="keyword">((double)</span><span class="default">microtime</span><span class="keyword">()*</span><span class="default">1000000</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$newstring</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$length</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$newstring</span><span class="keyword">)&lt;</span><span class="default">$length</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newstring</span><span class="keyword">.=</span><span class="default">$list</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$list</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">)];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$newstring</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="comment">//
<br />
// Generates a random string with the specified length
<br />
// Includes: a-z, A-Z y 0-9
<br />
//
<br />
</span><span class="keyword">function </span><span class="default">randString</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">=</span><span class="default">16</span><span class="keyword">) {
<br />
&nbsp;&nbsp; </span><span class="default">$newstring</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp; if(</span><span class="default">$length</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; while(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$newstring</span><span class="keyword">)&lt;</span><span class="default">$length</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$randnum </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">61</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$randnum </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newstring</span><span class="keyword">.=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">$randnum</span><span class="keyword">+</span><span class="default">48</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } elseif (</span><span class="default">$randnum </span><span class="keyword">&lt; </span><span class="default">36</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newstring</span><span class="keyword">.=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">$randnum</span><span class="keyword">+</span><span class="default">55</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newstring</span><span class="keyword">.=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">$randnum</span><span class="keyword">+</span><span class="default">61</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; }
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; return </span><span class="default">$newstring</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="6875""></a>
  <div class="note">
   <strong class="user">mrdlinux at yahoo dot com</strong>
   <a href="#6875" class="date">21-Jul-2000 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
And for those who prefer scaling:
<br />

<br />
mt_rand() / RAND_MAX * (Max - Min) + Min;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
