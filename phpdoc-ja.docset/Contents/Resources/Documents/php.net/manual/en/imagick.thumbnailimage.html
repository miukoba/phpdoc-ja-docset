<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>画像のサイズを変更する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="imagick.thresholdimage.html">≪ Imagick::thresholdImage</a></li>
      <li style="float: right;"><a href="imagick.tintimage.html">Imagick::tintImage ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.imagick.html">Imagick</a></li>
    <li>画像のサイズを変更する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="imagick.thumbnailimage" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Imagick::thumbnailImage</h1>
  <p class="verinfo">(PECL imagick 2.0.0)</p><p class="refpurpose"><span class="refname">Imagick::thumbnailImage</span> &mdash; <span class="dc-title">画像のサイズを変更する</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-imagick.thumbnailimage-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>Imagick::thumbnailImage</strong></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$columns</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$rows</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$bestfit</code><span class="initializer"> = false</span></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$fill</code><span class="initializer"> = false</span></span>
  ]] )</div>

  <p class="para rdfs-comment">
   画像のサイズを指定したものに変更し、関連付けられたプロパティをすべて削除します。
   ウェブ上での表示に適した小さなサムネイル画像を作成します。

   3 番目のパラメータに <strong><code>TRUE</code></strong> を指定すると、columns や rows
   にそれぞれの最大値を使用します。両方のパラメータが、
   マッチするまであるいは指定したパラメータより小さくなるまで縮小されます。
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
 <span class="simpara">
  パラメータ <code class="parameter">bestfit</code> の挙動は Imagick 3.0.0 で変わりました。
  これより前のバージョンでは、200x150 の画像に対して
  400x400 を指定した場合は何もせずそのままになっていました。
  Imagick 3.0.0 以降では、この画像は 400x300 に拡大されます。これが、
  指定したサイズに対して「ベストフィット」する大きさだからです。
  <code class="parameter">bestfit</code> を使う場合は、幅と高さの両方を指定しなければなりません。
 </span>
</p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-imagick.thumbnailimage-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">columns</code></dt>

     <dd>

      <p class="para">
      画像の幅。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">rows</code></dt>

     <dd>

      <p class="para">
      画像の高さ。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">bestfit</code></dt>

     <dd>

      <p class="para">
      最大値を強制的に使用するかどうか。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-imagick.thumbnailimage-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-imagick.thumbnailimage-errors">
  <h3 class="title">エラー / 例外</h3>
  <p class="para">
   エラー時に ImagickException をスローします。
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="108288""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#108288" class="date">14-Apr-2012 05:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If the 3rd parameter is true, the image will be resized in such a way that it'll be contained within the dimensions mentioned.<br />
It's like changing the dimensions of the image so that it can be contained in a box of given dimension.<br />
<br />
Eg: Image's dimension is 1600*800. If we use thumbnailImage(400, 400, true), the new image's dimension will be 400*200.<br />
<br />
Some of the previous notes in this page mentions that the image is resized proportionally so that its _smallest_ dimension matches the width or height specified, NOT both.<br />
But this is not the case now. Both width &amp; height of the image will be &lt;= that mentioned in thumbnailImage().<br />
Maybe imagick changed/updated the functionality.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108004""></a>
  <div class="note">
   <strong class="user">web at johnbaldock dot com</strong>
   <a href="#108004" class="date">22-Mar-2012 04:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When shrinking a jpg you can get more then double the performance if you use <span class="default">&lt;?php $image</span><span class="keyword">-&gt;</span><span class="default">setOption</span><span class="keyword">(</span><span class="string">'jpeg:size'</span><span class="keyword">, </span><span class="string">'800x532'</span><span class="keyword">) </span><span class="default">?&gt;</span>, exchanging 800x532 to the resolution you want the final image to be. For instance instead of this:<br />
<br />
<span class="default">&lt;?php<br />
$image </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">(</span><span class="string">'foo.jpg'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
You would use this:<br />
<br />
<span class="default">&lt;?php<br />
$image </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">();<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setOption</span><span class="keyword">(</span><span class="string">'jpeg:size'</span><span class="keyword">, </span><span class="string">'800x532'</span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">readImage</span><span class="keyword">(</span><span class="string">'foo.jpg'</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106345""></a>
  <div class="note">
   <strong class="user">jarrod at jarrodchristman dot com</strong>
   <a href="#106345" class="date">29-Oct-2011 05:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Even though thumbnailImage is meant to produce the smallest file size image possible, i found it didn't. I put together this code and bordering different compression settings, found it produced the smallest file size:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Max vert or horiz resolution<br />
</span><span class="default">$maxsize</span><span class="keyword">=</span><span class="default">550</span><span class="keyword">;<br />
<br />
</span><span class="comment">// create new Imagick object<br />
</span><span class="default">$image </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">(</span><span class="string">'input_image_filename_and_location'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Resizes to whichever is larger, width or height<br />
</span><span class="keyword">if(</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">getImageHeight</span><span class="keyword">() &lt;= </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">getImageWidth</span><span class="keyword">())<br />
{<br />
</span><span class="comment">// Resize image using the lanczos resampling algorithm based on width<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">resizeImage</span><span class="keyword">(</span><span class="default">$maxsize</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">FILTER_LANCZOS</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
}<br />
else<br />
{<br />
</span><span class="comment">// Resize image using the lanczos resampling algorithm based on height<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">resizeImage</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$maxsize</span><span class="keyword">,</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">FILTER_LANCZOS</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">// Set to use jpeg compression<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageCompression</span><span class="keyword">(</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">COMPRESSION_JPEG</span><span class="keyword">);<br />
</span><span class="comment">// Set compression level (1 lowest quality, 100 highest quality)<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageCompressionQuality</span><span class="keyword">(</span><span class="default">75</span><span class="keyword">);<br />
</span><span class="comment">// Strip out unneeded meta data<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">stripImage</span><span class="keyword">();<br />
</span><span class="comment">// Writes resultant image to output directory<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">writeImage</span><span class="keyword">(</span><span class="string">'output_image_filename_and_location'</span><span class="keyword">);<br />
</span><span class="comment">// Destroys Imagick object, freeing allocated resources in the process<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">destroy</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I found setCompression to not function at all and had to use setImageCompression. The stripImage call is needed and strips out unneeded meta data. You can choose whatever filter you want, but i found lanczos to be the best for image reduction, though it is more computationally heavy.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84178""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#84178" class="date">02-Jul-2008 01:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a function to calculate the new dimensions of a thumbnail, to fit within the given dimensions on both sides.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Calculate new image dimensions to new constraints<br />
&nbsp;*<br />
&nbsp;* @param Original X size in pixels<br />
&nbsp;* @param Original Y size in pixels<br />
&nbsp;* @return New X maximum size in pixels<br />
&nbsp;* @return New Y maximum size in pixels<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">scaleImage</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,</span><span class="default">$cx</span><span class="keyword">,</span><span class="default">$cy</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Set the default NEW values to be the old, in case it doesn't even need scaling<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">list(</span><span class="default">$nx</span><span class="keyword">,</span><span class="default">$ny</span><span class="keyword">)=array(</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//If image is generally smaller, don't even bother<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$x</span><span class="keyword">&gt;=</span><span class="default">$cx </span><span class="keyword">|| </span><span class="default">$y</span><span class="keyword">&gt;=</span><span class="default">$cx</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Work out ratios<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$x</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) </span><span class="default">$rx</span><span class="keyword">=</span><span class="default">$cx</span><span class="keyword">/</span><span class="default">$x</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$y</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) </span><span class="default">$ry</span><span class="keyword">=</span><span class="default">$cy</span><span class="keyword">/</span><span class="default">$y</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Use the lowest ratio, to ensure we don't go over the wanted image size<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$rx</span><span class="keyword">&gt;</span><span class="default">$ry</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">=</span><span class="default">$ry</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">=</span><span class="default">$rx</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Calculate the new size based on the chosen ratio<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nx</span><span class="keyword">=</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">*</span><span class="default">$r</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ny</span><span class="keyword">=</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$y</span><span class="keyword">*</span><span class="default">$r</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Return the results<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return array(</span><span class="default">$nx</span><span class="keyword">,</span><span class="default">$ny</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Use it like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//Read original image and create Imagick object<br />
</span><span class="default">$thumb</span><span class="keyword">=new </span><span class="default">Imagick</span><span class="keyword">(</span><span class="default">$originalImageFilename</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Work out new dimensions<br />
</span><span class="keyword">list(</span><span class="default">$newX</span><span class="keyword">,</span><span class="default">$newY</span><span class="keyword">)=</span><span class="default">scaleImage</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$thumb</span><span class="keyword">-&gt;</span><span class="default">getImageWidth</span><span class="keyword">(),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$thumb</span><span class="keyword">-&gt;</span><span class="default">getImageHeight</span><span class="keyword">(),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newMaximumWidth</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newMaximumHeight</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Scale the image<br />
</span><span class="default">$thumb</span><span class="keyword">-&gt;</span><span class="default">thumbnailImage</span><span class="keyword">(</span><span class="default">$newX</span><span class="keyword">,</span><span class="default">$newY</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Write the new image to a file<br />
</span><span class="default">$thumb</span><span class="keyword">-&gt;</span><span class="default">writeImage</span><span class="keyword">(</span><span class="default">$thumbnailFilename</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83730""></a>
  <div class="note">
   <strong class="user">n-sw-bit at ya dot ru</strong>
   <a href="#83730" class="date">09-Jun-2008 06:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to resize your picture to fit smallest parameter:<br />
<br />
$fitbyWidth = (($maxWidth/$w)&lt;($maxHeight/$h)) ?true:false;<br />
<br />
if($fitbyWidth){<br />
&nbsp;&nbsp;&nbsp; $im-&gt;thumbnailImage($maxWidth, 0, false);<br />
}else{<br />
&nbsp;&nbsp;&nbsp; $im-&gt;thumbnailImage(0, $maxHeight, false);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78553""></a>
  <div class="note">
   <strong class="user">sgarner at expio dot co dot nz</strong>
   <a href="#78553" class="date">17-Oct-2007 07:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With $fit == true, the image is resized proportionally so that its _smallest_ dimension matches the width or height specified, NOT both.<br />
<br />
For example, if you say thumbnailImage(400, 400, true), on an image of 1600x800, it will be resized to 800x400, NOT 400x200 as you might expect.<br />
<br />
The solution is to compare the original image's dimensions to the specified dimensions, and substitute zero for the smaller dimension, and set $fit = false.<br />
<br />
i.e.: thumbnailImage(400, 0, false) would resize that 1600x800 image to 400x200.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77728""></a>
  <div class="note">
   <strong class="user">raybdbomb . gmail</strong>
   <a href="#77728" class="date">11-Sep-2007 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As noted here<br />
<a href="http://php.net/manual/en/ref.imagick.php" rel="nofollow" target="_blank">http://php.net/manual/en/ref.imagick.php</a><br />
With either of the params as 0, the aspect ratio is maintained.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
