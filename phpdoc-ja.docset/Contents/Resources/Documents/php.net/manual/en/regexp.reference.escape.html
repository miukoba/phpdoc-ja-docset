<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>エスケープシーケンス</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="regexp.reference.meta.html">≪ メタ文字</a></li>
      <li style="float: right;"><a href="regexp.reference.unicode.html">Unicode 文字プロパティ ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="reference.pcre.pattern.syntax.html">PCRE 正規表現構文</a></li>
    <li>エスケープシーケンス</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="regexp.reference.escape" class="section">
  <h2 class="title">エスケープシーケンス</h2>
     <p class="para">
      バックスラッシュ〔日本語環境では円記号となる場合もある〕には、
      いくつかの使用法があります。ひとつめの使用法は、
      非英数字の前に記述する場合で、続く文字が表す特別な意味を取り去ります。
      このエスケープ文字としての使用法は、
      文字クラスの内外部いずれでも可能です。
     </p>
     <p class="para">
      たとえば、&quot;*&quot; 文字とマッチさせたい場合は、パターンを &quot;\*&quot; と記述します。
      続く文字がメタ文字として解釈されるものであるかには関係ありませんので、
      いかなる非英数字に対しても、&quot;\&quot; を付けると、その文字自体が
      表わされることになります。特に、
      バックスラッシュとマッチさせたい場合は、&quot;\\&quot; と記述します。
     </p>
     <blockquote class="note"><p><strong class="note">注意</strong>: 
      <p class="para">
       シングルクォートあるいはダブルクォートで囲まれた PHP の
       <a href="language.types.string.html#language.types.string.syntax" class="link">文字列</a>
       の中では、バックスラッシュは特別な意味を表します。
       そのため、正規表現 \\ を使用して \ とマッチさせたい場合は
       PHP のコード内では &quot;\\\\&quot; あるいは &#039;\\\\&#039; と記述する必要があります。
      </p>
     </p></blockquote>
     <p class="para">
     パターンを、
     <a href="reference.pcre.pattern.modifiers.html" class="link">PCRE_EXTENDED</a>
     オプションを付けてコンパイルすると、（文字クラス内部を除き）
     パターン中の空白文字、および &quot;#&quot; とその次の改行文字との間の文字は
     無視されます。空白文字や &quot;#&quot; をパターン中に含めるには、
     バックスラッシュを用いてエスケープします。
     </p>
     <p class="para">
      バックスラッシュの 2 番目の使用法は、非表示文字〔制御コードなど〕を
      パターン中に目に見える形で記述するための方法です。ヌル文字は
      パターンを終了させてしまうため使えませんが、その他の非表示文字は、
      パターンにそのまま含めても問題はありません。しかし、パターンの編集には、
      バイナリ文字をそのまま用いるよりも、以下に示すエスケープシーケンスを
      用いる方が便利でしょう。
     </p>
     <p class="para">
      <dl>

       
        <dt>
<em class="emphasis">\a</em></dt>

        <dd>

         <span class="simpara">アラーム、ベル文字 (16進 07)</span>
        </dd>

       
       
        <dt>
<em class="emphasis">\cx</em></dt>

        <dd>

         <span class="simpara">&quot;control-x&quot;, ここで x は任意の文字</span>
        </dd>

       
       
        <dt>
<em class="emphasis">\e</em></dt>

        <dd>

         <span class="simpara">エスケープ文字 (16進 1B)</span>
        </dd>

       
       
        <dt>
<em class="emphasis">\f</em></dt>

        <dd>

         <span class="simpara">改ページ (formfeed) (16進 0C)</span>
        </dd>

       
       
        <dt>
<em class="emphasis">\n</em></dt>

        <dd>

         <span class="simpara">改行 (newline) (16進 0A)</span>
        </dd>

       
       
        <dt>
<em class="emphasis">\p{xx}</em></dt>

        <dd>

         <span class="simpara">
          xx プロパティを持つ文字、詳細は
          <a href="regexp.reference.unicode.html" class="link">unicode プロパティ</a>
          を参照
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\P{xx}</em></dt>

        <dd>

         <span class="simpara">
          xx プロパティを持たない文字、詳細は
          <a href="regexp.reference.unicode.html" class="link">unicode プロパティ</a>
          を参照
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\r</em></dt>

        <dd>

         <span class="simpara">復帰 (carriage return) (16進 0D)</span>
        </dd>

       
       
        <dt>
<em class="emphasis">\t</em></dt>

        <dd>

         <span class="simpara">タブ (16進 09)</span>
        </dd>

       
       
        <dt>
<em class="emphasis">\xhh</em></dt>

        <dd>

         <span class="simpara">
          16 進コードで hh の文字
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\ddd</em></dt>

        <dd>

         <span class="simpara">8 進コードで ddd の文字、もしくは、後方参照</span>
        </dd>

       
      </dl>

     </p>
     <p class="para">
      &quot;\cx&quot; の正確な働きは、次の通りです。&quot;x&quot; が小文字の場合、
      大文字に変換されます。続いて、文字の 6 ビット目 (16進数 40) が
      反転されます。つまり、&quot;z&quot; は 16 進数の 1A になり、&quot;{&quot; は 3B になり、
      &quot;;&quot; は 7B になります。
     </p>
     <p class="para">      
      &quot;\x&quot; の後では、2 桁までの 16 進数が読まれます
      （大小文字どちらも可能です）。 &quot;\0&quot; の後では、さらに 2 桁の 8 進数が
      読みこまれます。いずれの場合も、2 桁より少ない場合、桁があるだけ
      読みこまれます。つまり、&quot;\0\x\07&quot; は ヌル文字 2 つの後にベル文字が
      続いたものを表します。8 進数を指定する場合は、必ず最初のゼロに続いて
      残りの 2 桁の数字を指定するように注意してください。
     </p>
     <p class="para">
      バックスラッシュの後に 0 以外の数字が続く場合の処理は複雑です。
      文字クラスの外部では、 PCRE は、続く数字全体を 10 進数として読みます。
      数字が 10 よりも小さい場合、または、正規表現の中に含まれる
      キャプチャ用左カッコの数以下の場合、 後方参照 として解釈されます。
      この動作に関する詳しい説明は、後ほど、カッコによるサブパターンの説明を
      行ってから示します
     </p>
     <p class="para">
      文字クラスの中、または、指定された 10 進数が 9 より大きく、
      キャプチャ用サブパターンの数がこの数に満たない場合は、PCRE は
      バックスラッシュの後から最大 3 文字の 8 進数を再度読みこみ、
      その値の最下位 8 ビットから 1 バイトを生成します。
      その後に続く数字は、それ自体を表します。以下に例を示します。
     </p>
     <p class="para">
      <dl>

       
        <dt>
<em class="emphasis">\040</em></dt>

        <dd>

         <span class="simpara">
          スペースの別の表記法
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\40</em></dt>

        <dd>

         <span class="simpara">
          上と同じ。ただし、キャプチャ用サブパターンが 40 個未満の場合
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\7</em></dt>

           <dd>

         <span class="simpara">
          常に後方参照
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\11</em></dt>

        <dd>

         <span class="simpara">
          後方参照、または、タブの別記法
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\011</em></dt>

        <dd>

         <span class="simpara">
          常にタブ
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\0113</em></dt>

        <dd>

         <span class="simpara">
          タブの後に文字 &quot;3&quot; が続いたもの
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\113</em></dt>

        <dd>

         <span class="simpara">
          8進コードで 113 の文字
          (99 を超える後方参照は存在しないため)
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\377</em></dt>

        <dd>

         <span class="simpara">
          全ビットが 1 である 1 バイト
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\81</em></dt>

           <dd>

         <span class="simpara">
          後方参照、または、ヌル文字の後に 2つの文字 
            &quot;8&quot; および &quot;1&quot; が続いたもの
         </span>
        </dd>

       
     </dl>

    </p>
    <p class="para">
     3 桁を超えて 8 進数は読みこまれないため、100 以上の 8 進数には
     ゼロを前につけてはいけないことに注意してください。
    </p>
    <p class="para">
     これらの 1 バイト値を定義するエスケープシーケンスは、
     文字クラスの内外部のいずれでも使用できます。加えて、文字クラス内では
     エスケープシーケンス &quot;<em>\b</em>&quot; はバックスペース (16進 0x) として解釈されます。
     文字クラス外では、別の意味を有します（別記参照）。
    </p>
    <p class="para">
     バックスラッシュの第 3 の使用法は、包括的な文字型を指定する用途です。
    </p>
    <p class="para">
      <dl>

       
        <dt>
<em class="emphasis">\d</em></dt>

        <dd>

         <span class="simpara">
          10 進数字 
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\D</em></dt>

        <dd>

         <span class="simpara">
           10 進数字でない文字
         </span>
        </dd>

       
       
       <dt>
<em class="emphasis">\h</em></dt>

       <dd>
<span class="simpara">水平方向の空白文字 (PHP 5.2.4 以降)</span></dd>

      
      
       <dt>
<em class="emphasis">\H</em></dt>

       <dd>
<span class="simpara">水平方向の空白文字でない文字 (PHP 5.2.4 以降)</span></dd>

      
      
        <dt>
<em class="emphasis">\s</em></dt>

        <dd>

         <span class="simpara">
          空白文字
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\S</em></dt>

        <dd>

         <span class="simpara">
          空白文字でない文字
         </span>
        </dd>

       
       
       <dt>
<em class="emphasis">\v</em></dt>

       <dd>
<span class="simpara">垂直方向の空白文字 (PHP 5.2.4 以降)</span></dd>

      
      
       <dt>
<em class="emphasis">\V</em></dt>

       <dd>
<span class="simpara">垂直方向の空白文字でない文字 (PHP 5.2.4 以降)</span></dd>

      
      
        <dt>
<em class="emphasis">\w</em></dt>

        <dd>

         <span class="simpara">
          単語構成文字 (word character) 
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\W</em></dt>

        <dd>

         <span class="simpara">
          非単語構成文字 (non-word character)
         </span>
        </dd>

       
      </dl>

     </p>
     <p class="para">
      これらエスケープシーケンスの各組により、文字集合が 2 つに分割されます。
      文字は、各組のどちらか片方だけにマッチします。
     </p>
     <p class="para">
      単語構成文字とは、英字または数字またはアンダースコア文字であり、Perl
      が定義するところの「単語」と成り得る文字のことです。文字および数字の
      定義は、PCRE の文字テーブルにより制御され、ロケールを指定して
      マッチングを行うと変わる可能性があります。
      例えば、&quot;fr&quot; （フランス語）ロケールの場合、128 を超える
      文字コードのいくつかは、アクセント付きの文字に使われており、
      これらは <em>\w</em> とマッチします。
     </p>
     <p class="para">
     これらの文字型表記は、文字クラスの内外によらず使用可能で、
     対応する型のたかだか 1 文字とマッチします。カレントのマッチング位置が
     検索対象文字列の終端である場合、マッチできる文字が無いので、
     マッチは失敗します。
     </p>
     <p class="para">
     バックスラッシュの第 4 の使用法は、簡単な言明 (assertion) です。
     言明とは、マッチがある特定の位置でだけ可能だという条件を指定するもので、
     検索対象文字列から文字を消費 (consume)〔つまり文字自体にマッチ〕
     しません。サブパターンを使ったより複雑な言明の方法もありますが、
     それについての解説は後ほど行います。バックスラッシュを使った言明は、
     次のものがあります
     </p>
     <p class="para">
      <dl>

       
        <dt>
<em class="emphasis">\b</em></dt>

        <dd>

         <span class="simpara">
          単語境界 
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\B</em></dt>

        <dd>

         <span class="simpara">
          非単語境界
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\A</em></dt>

        <dd>

         <span class="simpara">
          検索対象文字列の始端（複数行モードとは独立）
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\Z</em></dt>

        <dd>

         <span class="simpara">
         検索対象文字列の終端、または終端の改行（複数行モードとは独立） 
         </span>
        </dd>

       
       
        <dt>
<em class="emphasis">\z</em></dt>

        <dd>

         <span class="simpara">
          検索対象文字列の終端（複数行モードとは独立）
         </span>
        </dd>

       
       
         <dt>
<em class="emphasis">\G</em></dt>

         <dd>
<span class="simpara">マッチングの開始位置</span></dd>

      
      </dl>

     </p>
     <p class="para">
      これらの言明は、文字クラス内では使用できません（また、文字クラス内では、
       &quot;<em>\b</em>&quot; はバックスペース文字という別の意味を持つので
       注意してください）。
     </p>
     <p class="para">
      単語境界 (word boundary) とは、検索対象文字列において、
      カレントの文字およびその前の文字が同時に <em>\w</em> 
      もしくは <em>\W</em> にマッチしない（すなわち、片方が 
      <em>\w</em> にマッチし、もう片方が <em>\W</em>
      にマッチする）位置、もしくは、文字列の始めか終わりで、
      その始めか終わりの文字が <em>\w</em> にマッチする位置の
      ことです。
     </p>
     <p class="para">      
      言明 <em>\A</em>, <em>\Z</em>, 
      <em>\z</em> は、（以降で説明する）ハット記号やドル記号とは
      異なり、オプション設定によらず、文字列の始端または終端だけに
      マッチします。これらの言明は、<a href="reference.pcre.pattern.modifiers.html" class="link">PCRE_MULTILINE</a> および <a href="reference.pcre.pattern.modifiers.html" class="link">PCRE_DOLLAR_ENDONLY</a> 
      オプションの影響を受けません。
      <em>\Z</em> と <em>\z</em> との違いは、
      <em>\Z</em> は文字列の末尾の改行の前の位置および文字列の
      終端にマッチするのに対し、<em>\z</em> は文字列の終端にのみ
      マッチすることです。
     </p>
     
     <p class="para">
      言明 <em>\G</em> は、カレントのマッチング位置が、
      <span class="function"><a href="function.preg-match.html" class="function">preg_match()</a></span> 関数の <code class="parameter">offset</code>
      引数に指定されたマッチングの開始位置である場合に真になります。
      <code class="parameter">offset</code> が非ゼロの場合は、<em>\A</em>
      と等価ではありません。
     </p>
     
     <p class="para">
      <em>\Q</em> と <em>\E</em> とを使って、
      パターン中のメタ文字を無視させることができます。
      たとえば、
      <pre class="literallayout">
      \w+\Q.$.\E$
      </pre>
      は、文字列の終端において1つ以上の単語構成文字のあとに <em>.$.</em> 
      というリテラルが続いたものにマッチします。
     </p>

     <p class="para">
      <em>\K</em> を使用すると、マッチの開始位置をリセットできます。
      これは PHP 5.2.4 以降で使用可能です。たとえば、パターン
      <em>foo\Kbar</em> は &quot;foobar&quot; にマッチしますが、
      結果は &quot;bar&quot; にマッチしたと報告されます。
      <em>\K</em> を使用しても、キャプチャした部分文字列には影響を及ぼしません。
      たとえば、パターン <em>(foo)\Kbar</em> が
      &quot;foobar&quot; にマッチしたときの最初の部分文字列は &quot;foo&quot; です。
     </p>
     
    </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115224""></a>
  <div class="note">
   <strong class="user">info at maisuma dot jp</strong>
   <a href="#115224" class="date">17-Jun-2014 01:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can use Unicode character escape sequences (tested on PHP 5.3.3 &amp; PCRE 7.8).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//This source is supposed to be written in UTF-8.<br />
</span><span class="default">$a</span><span class="keyword">=</span><span class="string">'?'</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\\x{20ac}/u'</span><span class="keyword">,</span><span class="default">$a</span><span class="keyword">)); </span><span class="comment">//Match!</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114130""></a>
  <div class="note">
   <strong class="user">bluemoehre at gmx dot de</strong>
   <a href="#114130" class="date">14-Jan-2014 09:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using \R in character classes is NOT possible:<br />
<br />
var_dump( preg_match('#\R+#',"\n") ); -&gt; int(1)<br />
var_dump( preg_match('#[\R]+#',"\n") ); -&gt; int(0)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113388""></a>
  <div class="note">
   <strong class="user">collons at ya dot com</strong>
   <a href="#113388" class="date">05-Oct-2013 01:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The pattern "/\\A/" may be replaced by "/\\\A/" in order to match a "\A" string. Any other escaped "\" looks to work fine so you can use "/\\S/", for instance, to match a "\S" string.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112061""></a>
  <div class="note">
   <strong class="user">info at silisoftware dot com</strong>
   <a href="#112061" class="date">28-Apr-2013 12:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Whitespace matched by \s means only these 5 characters:<br />
&nbsp;9 = 0x09 = horizontal tab<br />
10 = 0x0A = line feed<br />
12 = 0x0C = form feed<br />
13 = 0x0D = carriage return<br />
32 = 0x20 = space</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108096""></a>
  <div class="note">
   <strong class="user">mike at eastghost dot com</strong>
   <a href="#108096" class="date">28-Mar-2012 04:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"line break" is ill-defined:<br />
<br />
&nbsp;-- Windows uses CR+LF (\r\n)<br />
&nbsp;-- Linux LF (\n)<br />
&nbsp;-- OSX CR (\r)<br />
<br />
Little-known special character:<br />
\R in preg_* matches all three.<br />
<br />
preg_match( '/^\R$/', "match\nany\\n\rline\r\nending\r" ); // match any line endings</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104553""></a>
  <div class="note">
   <strong class="user">grigor at the domain gatchev.info</strong>
   <a href="#104553" class="date">22-Jun-2011 10:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As \v matches both single char line ends (CR, LF) and double char (CR+LF, LF+CR), it is not a fixed length atom (eg. is not allowed in lookbehind assertions).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
