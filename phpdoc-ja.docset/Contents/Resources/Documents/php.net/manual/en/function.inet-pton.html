<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>人間が読める形式の IP アドレスを、パックされた in_addr 形式に変換する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.inet-ntop.html">≪ inet_ntop</a></li>
      <li style="float: right;"><a href="function.ip2long.html">ip2long ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.network.html">ネットワーク 関数</a></li>
    <li>人間が読める形式の IP アドレスを、パックされた in_addr 形式に変換する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.inet-pton" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">inet_pton</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.1.0)</p><p class="refpurpose"><span class="refname">inet_pton</span> &mdash; <span class="dc-title">人間が読める形式の IP アドレスを、パックされた in_addr 形式に変換する</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.inet-pton-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>inet_pton</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$address</code></span>
   )</div>

  <p class="para rdfs-comment">
   この関数は、人間が読める形式の IPv4 あるいは IPv6
   (PHP が IPv6 サポートを有効にしてビルドされている場合) のアドレスを
   32 ビットあるいは 128 ビットのバイナリ形式に変換します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.inet-pton-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">address</code></dt>

     <dd>

      <p class="para">
       可読形式の IPv4 アドレスあるいは IPv6 アドレス。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.inet-pton-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   指定した <code class="parameter">address</code> を
   <em>in_addr</em> 形式で表したものを返します。
   構文的に無効な <code class="parameter">address</code>
   (ドットのない IPv4 アドレスやコロンのない IPv6 アドレスなど)
   を指定した場合は <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.inet-pton-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-4596">
    <p><strong>例1 <span class="function"><strong>inet_pton()</strong></span> の例</strong></p>
    <div class="example-contents">
 <div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$in_addr&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">inet_pton</span><span style="color: #007700">(</span><span style="color: #DD0000">'127.0.0.1'</span><span style="color: #007700">);<br />&nbsp;<br /></span><span style="color: #0000BB">$in6_addr&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">inet_pton</span><span style="color: #007700">(</span><span style="color: #DD0000">'::1'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>   
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.inet-pton-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.0</td>
       <td>
         この関数は Windows プラットフォームでも使用可能となりました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.inet-pton-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.ip2long.html" class="function" rel="rdfs-seeAlso">ip2long()</a> - ドット表記の (IPv4) IP アドレスを、適切なアドレスに変換する</span></li>
    <li class="member"><span class="function"><a href="function.long2ip.html" class="function" rel="rdfs-seeAlso">long2ip()</a> - (IPv4) インターネットアドレスをインターネット標準ドット表記に変換する</span></li>
    <li class="member"><span class="function"><a href="function.inet-ntop.html" class="function" rel="rdfs-seeAlso">inet_ntop()</a> - パックされたインターネットアドレスを、人間が読める形式に変換する</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115139""></a>
  <div class="note">
   <strong class="user">TuRn3r</strong>
   <a href="#115139" class="date">03-Jun-2014 12:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful, address with leading 0 return false.<br />
<br />
Example : <br />
<span class="default">&lt;?php<br />
inet_pton</span><span class="keyword">(</span><span class="string">'172.27.1.04'</span><span class="keyword">); </span><span class="comment">// return false<br />
</span><span class="default">inet_pton</span><span class="keyword">(</span><span class="string">'172.27.1.4'</span><span class="keyword">) ;</span><span class="comment">// return the good result<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104917""></a>
  <div class="note">
   <strong class="user">francis dot besset at gmail dot com</strong>
   <a href="#104917" class="date">15-Jul-2011 10:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is possible to verify if PHP was compiled with --disable-ipv6 option by AF_INET6 constant.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">if (</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'AF_INET6'</span><span class="keyword">)) {<br />
&nbsp; echo </span><span class="string">"PHP was compiled without --disable-ipv6 option"</span><span class="keyword">;<br />
} else {<br />
&nbsp; echo </span><span class="string">"PHP was compiled with --disable-ipv6 option"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93501""></a>
  <div class="note">
   <strong class="user">strata_ranger at hotmail dot com</strong>
   <a href="#93501" class="date">13-Sep-2009 07:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If the input string is not a readable IP address, inet_pton() generates an E_WARNING and returns FALSE.&nbsp; The same is true for inet_ntop().<br />
<br />
Also, inet_pton() does not recognize netmask notation (e.g: "1.2.3.4/24" or "1:2::3:4/64") in the input string.&nbsp; This differs from how some database systems (like postgreSQL) support IP address types, so if you need that sort of functionality when processing IP addresses in PHP you'll have to write it in yourself.<br />
<br />
A rough example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Sample IP addresses<br />
</span><span class="default">$ipaddr </span><span class="keyword">= </span><span class="string">'1.2.3.4/24'</span><span class="keyword">; </span><span class="comment">// IPv4 with /24 netmask<br />
</span><span class="default">$ipaddr </span><span class="keyword">= </span><span class="string">'1:2::3:4/64'</span><span class="keyword">; </span><span class="comment">// IPv6 with /64 netmask<br />
<br />
// Strip out the netmask, if there is one.<br />
</span><span class="default">$cx </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$ipaddr</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">);<br />
if (</span><span class="default">$cx</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$subnet </span><span class="keyword">= (int)(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$ipaddr</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">));<br />
&nbsp; </span><span class="default">$ipaddr </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$ipaddr</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$cx</span><span class="keyword">);<br />
}<br />
else </span><span class="default">$subnet </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">; </span><span class="comment">// No netmask present<br />
<br />
// Convert address to packed format<br />
</span><span class="default">$addr </span><span class="keyword">= </span><span class="default">inet_pton</span><span class="keyword">(</span><span class="default">$ipaddr</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Let's display it as hexadecimal format<br />
</span><span class="keyword">foreach(</span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$addr</span><span class="keyword">) as </span><span class="default">$char</span><span class="keyword">) echo </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">)), </span><span class="default">2</span><span class="keyword">, </span><span class="string">'0'</span><span class="keyword">, </span><span class="default">STR_PAD_LEFT</span><span class="keyword">);<br />
echo </span><span class="string">"&lt;br /&gt;\n"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Convert the netmask<br />
</span><span class="keyword">if (</span><span class="default">is_integer</span><span class="keyword">(</span><span class="default">$subnet</span><span class="keyword">))<br />
{<br />
&nbsp; </span><span class="comment">// Maximum netmask length = same as packed address<br />
&nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">*</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$addr</span><span class="keyword">);<br />
&nbsp; if (</span><span class="default">$subnet </span><span class="keyword">&gt; </span><span class="default">$len</span><span class="keyword">) </span><span class="default">$subnet </span><span class="keyword">= </span><span class="default">$len</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; </span><span class="comment">// Create a hex expression of the subnet mask<br />
&nbsp; </span><span class="default">$mask&nbsp; </span><span class="keyword">= </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">'f'</span><span class="keyword">, </span><span class="default">$subnet</span><span class="keyword">&gt;&gt;</span><span class="default">2</span><span class="keyword">);<br />
&nbsp; switch(</span><span class="default">$subnet </span><span class="keyword">&amp; </span><span class="default">3</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp; case </span><span class="default">3</span><span class="keyword">: </span><span class="default">$mask </span><span class="keyword">.= </span><span class="string">'e'</span><span class="keyword">; break;<br />
&nbsp; case </span><span class="default">2</span><span class="keyword">: </span><span class="default">$mask </span><span class="keyword">.= </span><span class="string">'c'</span><span class="keyword">; break;<br />
&nbsp; case </span><span class="default">1</span><span class="keyword">: </span><span class="default">$mask </span><span class="keyword">.= </span><span class="string">'8'</span><span class="keyword">; break;<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$mask </span><span class="keyword">= </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$mask</span><span class="keyword">, </span><span class="default">$len</span><span class="keyword">&gt;&gt;</span><span class="default">2</span><span class="keyword">, </span><span class="string">'0'</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">// Packed representation of netmask<br />
&nbsp; </span><span class="default">$mask </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">, </span><span class="default">$mask</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">// Display the netmask as hexadecimal<br />
</span><span class="keyword">foreach(</span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$mask</span><span class="keyword">) as </span><span class="default">$char</span><span class="keyword">) echo </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$char</span><span class="keyword">)), </span><span class="default">2</span><span class="keyword">, </span><span class="string">'0'</span><span class="keyword">, </span><span class="default">STR_PAD_LEFT</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76510""></a>
  <div class="note">
   <strong class="user">eric at vyncke org</strong>
   <a href="#76510" class="date">18-Jul-2007 07:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Not so easy in the function below... It is not handling the case of '::' which can happen in an IPv6 and represents any number of 0, addresses could be as simple as ff05::1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66191""></a>
  <div class="note">
   <strong class="user">me at diogoresende dot net</strong>
   <a href="#66191" class="date">16-May-2006 11:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to use the above function you should test for ':' character before '.'. Meaning, you should check if it's an ipv6 address before checking for ipv4.<br />
Why? IPv6 allows this type of notation:<br />
<br />
::127.0.0.1<br />
<br />
If you check for '.' character you will think this is an ipv4 address and it will fail.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
