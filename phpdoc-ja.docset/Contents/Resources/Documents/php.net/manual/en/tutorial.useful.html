<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>実用的な例</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="tutorial.firstpage.html">≪ PHP を使用する初めてのページ</a></li>
      <li style="float: right;"><a href="tutorial.forms.html">フォームの処理 ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="tutorial.html">簡易チュートリアル</a></li>
    <li>実用的な例</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="tutorial.useful" class="sect1">
   <h2 class="title">実用的な例</h2>
   <p class="para">
    次に、より実用的なことをしてみましょう。
    ページを見ているユーザーが使用しているブラウザの種類を確認してみます。
    これを行なうには、ブラウザが
    HTTP リクエストの一部として送信した user agent 文字列を調べます。
    この情報は、<a href="language.variables.html" class="link">変数</a>
    に保存されています。PHP では、変数名は常にドル記号で始まります。
    ここで使用する変数は、<var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER['HTTP_USER_AGENT']</a></var></var>
    です。
   </p>
   <blockquote class="note"><p><strong class="note">注意</strong>: 
    <p class="para">
     <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER</a></var></var> は、
     Web サーバー関連情報を全て保持する PHP の特別な予約変数です。詳細は、
     <a href="language.variables.superglobals.html" class="link">スーパーグローバル</a>
     を参照してください。
     これらの特別な変数は、<a href="http://www.php.net/releases/4_1_0.php" class="link external" title="Link : http://www.php.net/releases/4_1_0.php">&raquo;&nbsp;4.1.0</a>
     で導入されました。これ以前は、
     <var class="varname"><var class="varname">$HTTP_SERVER_VARS</var></var> のような古い配列
     <var class="varname"><var class="varname">$HTTP_*_VARS</var></var> を代わりに使用していました。
     古いとはいえ、これらの変数はまだ存在しています
     (<a href="tutorial.oldcode.html" class="link">古いコード</a>に関する注記も
     参照してください)。
    </p>
   </p></blockquote>
   <p class="para">
    この変数を表示するには、以下のようにします。
   </p>
   <p class="para">
    <div class="example" id="example-4">
    <p><strong>例1 変数を出力する (配列要素)</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_USER_AGENT'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
      このスクリプトの出力例は以下のようになります。
     <div class="example-contents screen"><br />
Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)<br />
     </div>
    </p></div>
   </div>
   </p>
   <p class="para">
    PHP で利用可能な変数の<a href="language.types.html" class="link">型</a>
    には多くの種類があります。上の例では、
    <a href="language.types.array.html" class="link">配列</a>
    の要素を出力しています。配列は、非常に有用です。
   </p>
   <p class="para">
    <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER</a></var></var> は、PHP
    で自動的に利用可能な変数のひとつに過ぎません。マニュアルの
    <a href="reserved.variables.html" class="link">定義済の変数</a>
    のセクションでリストを参照することができます。
    あるいは、完全なリストを取得するには、さきほどのセクションで使用した
    <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span> 関数の出力を確認します。
   </p>
   <p class="para">
    PHP タグの中に複数の PHP 命令を置くことができ、echo
    文以上のことを行なうコードブロックを作成することができます。
    例えば、インターネット・エクスプローラかどうかを調べたい場合は、
    以下のようにします。
   </p>
   <p class="para">
    <div class="example" id="example-5">
     <p><strong>例2 
      <a href="language.control-structures.html" class="link">制御構造</a> および
      <a href="language.functions.html" class="link">関数</a>の使用例
     </strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_USER_AGENT'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'MSIE'</span><span style="color: #007700">)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'あなたはInternet&nbsp;Explorerを使用しています&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

     <div class="example-contents"><p>
      このスクリプトの出力例は以下のようになります。
      <div class="example-contents screen">
<div class="cdata"><pre>
あなたはInternet Explorerを使用しています&lt;br /&gt;
</pre></div>
      </div>
     </p></div>
    </div>
   </p>
   <p class="para">
    ここで、新しい概念をいくつか導入します。
    <a href="control-structures.if.html" class="link">if</a> 文を使用しています。
    C 言語の基本構文を知っているとしたら、理解できると思います。
    C 言語や上記の構文を使用する他の言語をあまり知らない場合には、
    PHP の入門書を手にとって最初の数章を読むか、このマニュアルの
    <a href="langref.html" class="link">言語リファレンス</a>の部分を読むべきです。
   </p>
   <p class="para">
    二番目の新しい概念は、<span class="function"><a href="function.strpos.html" class="function">strpos()</a></span> 関数のコールです。
    <span class="function"><a href="function.strpos.html" class="function">strpos()</a></span> は PHP に組み込まれた関数で、
    文字列の中である文字列を探します。この場合、
    <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER['HTTP_USER_AGENT']</a></var></var> (いわゆる干し草の山
    【haystack】) の中で
    <em>&quot;MSIE&quot;</em> (いわゆる針【needle】) を探しています。
    この文字列が見つかった場合、
    この関数はこの関数は文字列の相対的な位置を返し、
    見つからなかった場合には <strong><code>FALSE</code></strong> を返します。
    この関数が <strong><code>FALSE</code></strong> を返さなければ、
    <a href="control-structures.if.html" class="link">if</a>
    文は <strong><code>TRUE</code></strong> と評価し、その{波括弧}の中のコードが実行されます。
    そうでない場合は、実行されません。
    <a href="control-structures.if.html" class="link">if</a>,
    <a href="control-structures.else.html" class="link">else</a> と
    <span class="function"><a href="function.strtoupper.html" class="function">strtoupper()</a></span> や <span class="function"><a href="function.strlen.html" class="function">strlen()</a></span>
    のような他の関数で、似たような例を作ってみてください。
    関連するマニュアルの各ページにも例が載っています。
    関数の使用法に自信がない場合には、マニュアルの
    <a href="about.prototypes.html" class="link">関数定義の読み方</a>および
    <a href="language.functions.html" class="link">PHP関数</a>のセクションの両方を
    読んでみると良いでしょう。
   </p>
   <p class="para">
    この例を少し発展させて、PHP ブロックの中からでも PHP
    モードから出たり入ったりすることができることを以下に示します。
   </p>
   <p class="para">
    <div class="example" id="example-6">
     <p><strong>例3 HTML および PHP モードの両方を混在させる</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTP_USER_AGENT'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'MSIE'</span><span style="color: #007700">)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br /></span><span style="color: #0000BB">?&gt;<br /></span>&lt;h3&gt;strposが非falseを返しました&lt;/h3&gt;<br />&lt;center&gt;&lt;b&gt;あなたはInternet&nbsp;Explorerを使用しています&lt;/b&gt;&lt;/center&gt;<br /><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">}&nbsp;else&nbsp;{<br /></span><span style="color: #0000BB">?&gt;<br /></span>&lt;h3&gt;strposがfalseを返しました&lt;/h3&gt;<br />&lt;center&gt;&lt;b&gt;あなたはInternet&nbsp;Explorerを使用していません&lt;/b&gt;&lt;/center&gt;<br /><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

     <div class="example-contents"><p>
      この例の出力は以下のようになります。
      <div class="example-contents screen">
<div class="cdata"><pre>
&lt;h3&gt;strposが非falseを返しました&lt;/h3&gt;
&lt;center&gt;&lt;b&gt;あなたはInternet Explorerを使用しています&lt;/b&gt;&lt;/center&gt;
</pre></div>
      </div>
     </p></div>
    </div>
   </p>
   <p class="para">
    何かを出力する際に PHP の echo 文を使用する代わりに、PHP
    モードを抜けて通常の HTML を送信しています。ここで注意すべき重要で強力な点は、
    スクリプトの論理フローが損なわれないということです。
    <span class="function"><a href="function.strpos.html" class="function">strpos()</a></span> が <strong><code>TRUE</code></strong> または <strong><code>FALSE</code></strong>
    のどちらを返すか、言い換えると<em>MSIE</em>
    が見つかったかどうかに基づき、HTML
    ブロックだけが見る側に送信されることになります。
   </p>
  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115072""></a>
  <div class="note">
   <strong class="user">Declan Kelly</strong>
   <a href="#115072" class="date">22-May-2014 09:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that Internet Explorer 11 no longer contains MSIE in its user agent string, for example on Windows 8 with IE11 I get the following:<br />
<br />
Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko<br />
<br />
So if you want to include a test for IE11, the code above changes to: <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_USER_AGENT'</span><span class="keyword">], </span><span class="string">'MSIE'</span><span class="keyword">) !== </span><span class="default">FALSE </span><span class="keyword">||<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_USER_AGENT'</span><span class="keyword">], </span><span class="string">'Trident'</span><span class="keyword">) !== </span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'You are using Internet Explorer.&lt;br /&gt;'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71871""></a>
  <div class="note">
   <strong class="user">rfantin at coralwood dot com</strong>
   <a href="#71871" class="date">20-Dec-2006 07:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While it's easy to get carried away mixing your logic and presentation together since it's so easy to do, you're better off using PHP within HTML only to fill in values, or include other source files.
<br />

<br />
Keep your actual processing in separate libraries that are called before you send any headers to the page. Try to avoid calling a script that retrieves or sets information, or manipulates it in the middle of your HTML. You'll find it's much easier to maintain.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
