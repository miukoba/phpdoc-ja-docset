<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>ファイル全体を読み込んで配列に格納する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.file-put-contents.html">≪ file_put_contents</a></li>
      <li style="float: right;"><a href="function.fileatime.html">fileatime ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.filesystem.html">ファイルシステム 関数</a></li>
    <li>ファイル全体を読み込んで配列に格納する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.file" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">file</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">file</span> &mdash; <span class="dc-title">ファイル全体を読み込んで配列に格納する</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.file-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>file</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$flags</code><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">resource</span> <code class="parameter">$context</code></span>
  ]] )</div>

  <p class="para rdfs-comment">
   ファイル全体を配列に読み込みます。
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    ファイルの内容を文字列として返すには <span class="function"><a href="function.file-get-contents.html" class="function">file_get_contents()</a></span>
    を使用します。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.file-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
       ファイルへのパス。
      </p>
      <div class="tip"><strong class="tip">ヒント</strong><p class="simpara"><a href="filesystem.configuration.html#ini.allow-url-fopen" class="link">fopen wrappers</a> が有効の場合、この関数のファイル名として
URL を使用することができます。ファイル名の指定方法に関する詳細は
<span class="function"><a href="function.fopen.html" class="function">fopen()</a></span> を参照ください。
<a href="wrappers.html" class="xref">サポートするプロトコル/ラッパー</a> には、さまざまなラッパーの機能やその使用法、
提供される定義済み変数などの情報がまとめられています。</p></div>
     </dd>

    
    
     <dt>
<code class="parameter">flags</code></dt>

     <dd>

      <p class="para">
       オプションのパラメータ <code class="parameter">flags</code>
       は、以下の定数のうちのひとつ、あるいは複数の組み合わせとなります。
       <dl>

        
         <dt>

          <strong><code>FILE_USE_INCLUDE_PATH</code></strong>
         </dt>

         <dd>

          <span class="simpara">
           <a href="ini.core.html#ini.include-path" class="link">include_path</a> のファイルを探します。
          </span>
         </dd>

        
        
         <dt>

          <strong><code>FILE_IGNORE_NEW_LINES</code></strong>
         </dt>

         <dd>

          <span class="simpara">
           配列の各要素の最後に改行文字を追加しません。
          </span>
         </dd>

        
        
         <dt>

          <strong><code>FILE_SKIP_EMPTY_LINES</code></strong>
         </dt>

         <dd>

          <span class="simpara">
           空行を読み飛ばします。
          </span>
         </dd>

        
       </dl>

      </p>
     </dd>

    
    
     <dt>
<code class="parameter">context</code></dt>

     <dd>

      <p class="para">
       <span class="function"><a href="function.stream-context-create.html" class="function">stream_context_create()</a></span> 関数で作成したコンテキストリソース。
      </p>
      <p class="para">
       <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara">コンテキストのサポートは、
PHP 5.0.0 で追加されました。<em>contexts</em> の説明に関しては、
<a href="book.stream.html" class="xref">ストリーム</a> を参照してください。</span></p></blockquote>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.file-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   ファイルを配列に入れて返します。
   配列の各要素はファイルの各行に対応します。改行記号はついたままとなります。
   失敗すると <span class="function"><strong>file()</strong></span> は <strong><code>FALSE</code></strong> を返します。
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    <strong><code>FILE_IGNORE_NEW_LINES</code></strong> を指定しない限り、
    配列に取り込まれた各行は行末文字も含みます。
    行末文字を取り除きたい場合には <span class="function"><a href="function.rtrim.html" class="function">rtrim()</a></span> を使用する必要があります。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara">
マッキントッシュコンピュータ上で作成されたファイルを読み込む際に、
<em>PHP</em> が行末を認識できないという問題が発生した場合、
実行時の設定オプション<a href="filesystem.configuration.html#ini.auto-detect-line-endings" class="link">auto_detect_line_endings</a> を有効にする必要が生じるかもしれません。</span>
</p></blockquote>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.file-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>4.3.0</td>
       <td>
        <span class="function"><strong>file()</strong></span> はバイナリセーフとなりました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.file-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-2463">
    <p><strong>例1 <span class="function"><strong>file()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;ファイルの内容を配列に取り込みます。<br />//&nbsp;この例ではHTTPを通してURL上のHTMLソースを取得します。<br /></span><span style="color: #0000BB">$lines&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://www.example.com/'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;配列をループしてHTMLをHTMLソースとして表示し、行番号もつけます。<br /></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$lines&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$line_num&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$line</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Line&nbsp;#&lt;b&gt;</span><span style="color: #007700">{</span><span style="color: #0000BB">$line_num</span><span style="color: #007700">}</span><span style="color: #DD0000">&lt;/b&gt;&nbsp;:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$line</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;他の例として、Webページを文字列に取り込みます。file_get_contents()も参照してください。<br /></span><span style="color: #0000BB">$html&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">file</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://www.example.com/'</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">//&nbsp;オプションのパラメータは&nbsp;PHP&nbsp;5&nbsp;以降で使用できます<br /></span><span style="color: #0000BB">$trimmed&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file</span><span style="color: #007700">(</span><span style="color: #DD0000">'somefile.txt'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">FILE_IGNORE_NEW_LINES&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">FILE_SKIP_EMPTY_LINES</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.file-notes">
  <h3 class="title">注意</h3>
  <div class="warning"><strong class="warning">警告</strong><p class="para">IIS のような、いくつかの標準に
対応してない Web サーバーは、PHP に警告を発生させるような手順でデータを送信します。
このようなサーバーを使用する場合は、<a href="errorfunc.configuration.html#ini.error-reporting" class="link">
error_reporting</a> を警告を発生しないレベルまで小さくする必要があります。
PHP 4.3.7 以降では、<em>https://</em> ラッパーでストリームをオープンする際に
バグがある IIS サーバーソフトウエアを検出することができ、この警告を抑制することができます。
あなたが <em>ssl://</em> ソケットを作成するために  <span class="function"><a href="function.fsockopen.html" class="function">fsockopen()</a></span> を使用している場合、
自らこの警告を検出し、抑制する必要があります。</p></div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.file-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.readfile.html" class="function" rel="rdfs-seeAlso">readfile()</a> - ファイルを出力する</span></li>
    <li class="member"><span class="function"><a href="function.fopen.html" class="function" rel="rdfs-seeAlso">fopen()</a> - ファイルまたは URL をオープンする</span></li>
    <li class="member"><span class="function"><a href="function.fsockopen.html" class="function" rel="rdfs-seeAlso">fsockopen()</a> - インターネット接続もしくは Unix ドメインソケット接続をオープンする</span></li>
    <li class="member"><span class="function"><a href="function.popen.html" class="function" rel="rdfs-seeAlso">popen()</a> - プロセスへのファイルポインタをオープンする</span></li>
    <li class="member"><span class="function"><a href="function.file-get-contents.html" class="function" rel="rdfs-seeAlso">file_get_contents()</a> - ファイルの内容を全て文字列に読み込む</span></li>
    <li class="member"><span class="function"><a href="function.include.html" class="function" rel="rdfs-seeAlso">include</a> - include</span></li>
    <li class="member"><span class="function"><a href="function.stream-context-create.html" class="function" rel="rdfs-seeAlso">stream_context_create()</a> - ストリームコンテキストを作成する</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115500""></a>
  <div class="note">
   <strong class="user">Martin K.</strong>
   <a href="#115500" class="date">06-Aug-2014 01:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If the file you are reading is in CSV format do not use file(), use fgetcsv().&nbsp; file() will split the file by each newline that it finds, even newlines that appear within a field (i.e. within quotations).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115226""></a>
  <div class="note">
   <strong class="user">marco dot remy at aol dot com</strong>
   <a href="#115226" class="date">17-Jun-2014 04:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's my CSV converter<br />
supports Header and trims all fields<br />
Note: Headers must be not empty!<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">csv2array</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$delim </span><span class="keyword">= </span><span class="string">';'</span><span class="keyword">, </span><span class="default">$encl </span><span class="keyword">= </span><span class="string">'"'</span><span class="keyword">, </span><span class="default">$header </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment"># File does not exist<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment"># Read lines of file to array<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file_lines </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">FILE_IGNORE_NEW_LINES </span><span class="keyword">| </span><span class="default">FILE_SKIP_EMPTY_LINES</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment"># Empty file<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$file_lines </span><span class="keyword">=== array())<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment"># Read headers if you want to<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$header </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line_header </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$file_lines</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array_header </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'trim'</span><span class="keyword">, </span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$line_header</span><span class="keyword">, </span><span class="default">$delim</span><span class="keyword">, </span><span class="default">$encl</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment"># Now line per line (strings)<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$file_lines </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># Skip empty lines<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">) === </span><span class="string">''</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># Convert line to array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array_fields </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'trim'</span><span class="keyword">, </span><span class="default">str_getcsv</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="default">$delim</span><span class="keyword">, </span><span class="default">$encl</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment"># If header present, combine header and fields as key =&gt; value<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$header </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">[] = </span><span class="default">array_combine </span><span class="keyword">(</span><span class="default">$array_header</span><span class="keyword">, </span><span class="default">$array_fields</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">[] = </span><span class="default">$array_fields</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$out</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113986""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#113986" class="date">26-Dec-2013 01:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
("file()'s problem with UTF-16" is wrong. This is updated.<br />
The former may miss the last line of the string.)<br />
<br />
file() seems to have a problem in handling <br />
UTF-16 with or without BOM.<br />
<br />
file() is likely to think "\n"=LF (0A) as a line-ending.<br />
So, not only "000A" but also "010A, 020A,...,FE0A, FF0A,..."<br />
are regarded as line-endings.<br />
<br />
Moreover, file() causes a serious problem in UTF-16LE.<br />
file() loses first "0A" (the first half of "0A00")!<br />
And the next line begins with "00" (the rest of "0A00").<br />
So lines after the first "0A" are totally different.<br />
<br />
To avoid this phenomena,<br />
eg. in case (php_script : UTF-8 , file : UTF-16 with line-ending "\r\n"),<br />
<br />
<span class="default">&lt;?php<br />
<br />
mb_regex_encoding</span><span class="keyword">(</span><span class="string">'UTF-16'</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// to help mb_ereg_..() work properly<br />
</span><span class="default">$str </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$file_path</span><span class="keyword">);<br />
</span><span class="default">$to_encoding </span><span class="keyword">= </span><span class="string">'UTF-16'</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// encoding of string<br />
</span><span class="default">$from_encoding </span><span class="keyword">= </span><span class="string">'UTF-8'</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// encoding of PHP_script<br />
</span><span class="default">$pattern1 </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="string">'[^\r]*\r\n'</span><span class="keyword">, </span><span class="default">$to_encoding</span><span class="keyword">, </span><span class="default">$from_encoding</span><span class="keyword">);<br />
</span><span class="default">mb_ereg_search_init</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$pattern1</span><span class="keyword">);<br />
while (</span><span class="default">$res </span><span class="keyword">= </span><span class="default">mb_ereg_search_regs</span><span class="keyword">()) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file</span><span class="keyword">[] = </span><span class="default">$res</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
}<br />
</span><span class="default">$pattern2 </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="string">'\A.*\r\n(.*)\z'</span><span class="keyword">, </span><span class="default">$to_encoding</span><span class="keyword">, </span><span class="default">$from_encoding</span><span class="keyword">);<br />
</span><span class="default">mb_ereg</span><span class="keyword">(</span><span class="default">$pattern2</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">, </span><span class="default">$match</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file</span><span class="keyword">[] = </span><span class="default">$match</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
instead of <br />
$file = file($file_path);<br />
<br />
If line-ending is "\n",<br />
$pattern1 = mb_convert_encoding('[^\n]*\n', $to_encoding, $from_encoding);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113461""></a>
  <div class="note">
   <strong class="user">bingo at dingo dot com</strong>
   <a href="#113461" class="date">14-Oct-2013 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To write all the lines of the file in other words to read the file line by line you can write the code like this:<br />
<span class="default">&lt;?php<br />
$names</span><span class="keyword">=</span><span class="default">file</span><span class="keyword">(</span><span class="string">'name.txt'</span><span class="keyword">);<br />
</span><span class="comment">// To check the number of lines <br />
</span><span class="keyword">echo </span><span class="default">count</span><span class="keyword">(</span><span class="default">$names</span><span class="keyword">).</span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
foreach(</span><span class="default">$names </span><span class="keyword">as </span><span class="default">$name</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; echo </span><span class="default">$name</span><span class="keyword">.</span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
this example is so basic to understand how it's working. I hope it will help many beginners.<br />
<br />
Regards,<br />
Bingo</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105772""></a>
  <div class="note">
   <strong class="user">twichi at web dot de</strong>
   <a href="#105772" class="date">13-Sep-2011 09:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
read from CSV data (file) into an array with named keys<br />
<br />
... with or without 1st row = header (keys) <br />
(see 4th parameter of function call as&nbsp; true / false) <br />
<br />
<span class="default">&lt;?php <br />
</span><span class="comment">// --------------------------------------------------------------<br />
<br />
</span><span class="keyword">function </span><span class="default">csv_in_array</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">$delm</span><span class="keyword">=</span><span class="string">";"</span><span class="keyword">,</span><span class="default">$encl</span><span class="keyword">=</span><span class="string">"\""</span><span class="keyword">,</span><span class="default">$head</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) { <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$csvxrow </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);&nbsp;&nbsp; </span><span class="comment">// ---- csv rows to array ----<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$csvxrow</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">chop</span><span class="keyword">(</span><span class="default">$csvxrow</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$csvxrow</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$encl</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$csvxrow</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$keydata </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$delm</span><span class="keyword">,</span><span class="default">$csvxrow</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$keynumb </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$keydata</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$head </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) { <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$anzdata </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$csvxrow</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$z</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">$anzdata</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++) { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$csvxrow</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">] = </span><span class="default">chop</span><span class="keyword">(</span><span class="default">$csvxrow</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">]); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$csvxrow</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">] = </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$encl</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$csvxrow</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">]); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$csv_data</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">] = </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$delm</span><span class="keyword">,</span><span class="default">$csvxrow</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">]); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$keydata </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">[</span><span class="default">$z</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$csv_data</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">]; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$z</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$csvxrow </span><span class="keyword">as </span><span class="default">$item</span><span class="keyword">) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">chop</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$encl</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$item</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$csv_data </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$delm</span><span class="keyword">,</span><span class="default">$item</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">$keynumb</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$y</span><span class="keyword">] = </span><span class="default">$csv_data</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">]; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
return </span><span class="default">$out</span><span class="keyword">; <br />
}<br />
<br />
</span><span class="comment">// --------------------------------------------------------------<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
fuction call with 4 parameters: <br />
<br />
(1) = the file with CSV data (url / string)<br />
(2) = colum delimiter (e.g: ; or | or , ...)<br />
(3) = values enclosed by (e.g: ' or " or ^ or ...)<br />
(4) = with or without 1st row = head (true/false) <br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// ----- call ------ <br />
</span><span class="default">$csvdata </span><span class="keyword">= </span><span class="default">csv_in_array</span><span class="keyword">( </span><span class="default">$yourcsvfile</span><span class="keyword">, </span><span class="string">";"</span><span class="keyword">, </span><span class="string">"\""</span><span class="keyword">, </span><span class="default">true </span><span class="keyword">); <br />
</span><span class="comment">// ----------------- <br />
<br />
// ----- view ------ <br />
</span><span class="keyword">echo </span><span class="string">"&lt;pre&gt;\r\n"</span><span class="keyword">; <br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$csvdata</span><span class="keyword">);<br />
echo </span><span class="string">"&lt;/pre&gt;\r\n"</span><span class="keyword">; <br />
</span><span class="comment">// -----------------<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
PS: also see: <a href="http://php.net/manual/de/function.fgetcsv.php to read CSV data into an array" rel="nofollow" target="_blank">http://php.net/manual/de/function.fgetcsv.php to read CSV data into an array</a><br />
... and other file-handling methods <br />
<br />
^</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94067""></a>
  <div class="note">
   <strong class="user">d basin</strong>
   <a href="#94067" class="date">15-Oct-2009 12:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this may be obvious, but it took me a while to figure out what I was doing wrong. So I wanted to share. I have a file on my "c:\" drive. How do I file() it? <br />
<br />
Don't forget the backslash is special and you have to "escape" the backslash i.e. "\\":<br />
<br />
<span class="default">&lt;?php<br />
<br />
$lines </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="string">"C:\\Documents and Settings\\myfile.txt"</span><span class="keyword">);<br />
<br />
foreach(</span><span class="default">$lines </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; echo(</span><span class="default">$line</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span> <br />
<br />
hope this helps...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82548""></a>
  <div class="note">
   <strong class="user">jon+spamcheck at phpsitesolutions dot com</strong>
   <a href="#82548" class="date">16-Apr-2008 10:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A user suggested using rtrim always, due to the line ending conflict with files that have an EOL that differs from the server EOL.<br />
<br />
Using rtrim with it's default character replacement is a bad solution though, as it removes all whitespace in addition to the '\r' and '\n' characters.<br />
<br />
A good solution using rtrim follows:<br />
<br />
<span class="default">&lt;?php<br />
$line </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="string">"\r\n"</span><span class="keyword">) . </span><span class="default">PHP_EOL</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
This removes only EOL characters, and replaces with the server's EOL character, thus making preg_* work fine when matching the EOL ($)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81164""></a>
  <div class="note">
   <strong class="user">vbchris at gmail dot com</strong>
   <a href="#81164" class="date">16-Feb-2008 10:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're getting "failed to open stream: Permission denied" when trying to use either file() or fopen() to access files on another server. Check your host doesn't have any firewall restrictions in-place which prevent outbound connections. This is the case with my host Aplus.net</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76367""></a>
  <div class="note">
   <strong class="user">Reversed: moc dot liamg at senroc dot werdna</strong>
   <a href="#76367" class="date">12-Jul-2007 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This note applies to PHP 5.1.6 under Windows (although may apply to other versions).<br />
<br />
It appears that the 'FILE_IGNORE_NEW_LINES' flag doesn't remove newlines properly when reading Windows-style text files, i.e. files whose lines end in '\r\n'.<br />
<br />
Solution: Always use 'rtrim()' in preference to 'FILE_IGNORE_NEW_LINES'.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71419""></a>
  <div class="note">
   <strong class="user">info at carstanje dot com</strong>
   <a href="#71419" class="date">28-Nov-2006 09:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using file() for reading large text files &gt; 10 Mb gives problems, therefore you should use this instead. It is much slower but it works fine. $lines will return an array with all the lines.
<br />

<br />
<span class="default">&lt;?php
<br />
$handle </span><span class="keyword">= @</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'yourfile...'</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);
<br />
if (</span><span class="default">$handle</span><span class="keyword">) {
<br />
&nbsp;&nbsp; while (!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$lines</span><span class="keyword">[] = </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">4096</span><span class="keyword">);
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30503""></a>
  <div class="note">
   <strong class="user">justin at visunet dot ie</strong>
   <a href="#30503" class="date">20-Mar-2003 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note: Now that file() is binary safe it is 'much' slower than it used to be. If you are planning to read large files it may be worth your while using fgets() instead of file() For example:
<br />

<br />
<span class="default">&lt;?php
<br />
$fd </span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">(</span><span class="string">"log_file.txt"</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);
<br />
while (!</span><span class="default">feof </span><span class="keyword">(</span><span class="default">$fd</span><span class="keyword">)) 
<br />
{
<br />
&nbsp;&nbsp; </span><span class="default">$buffer </span><span class="keyword">= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fd</span><span class="keyword">, </span><span class="default">4096</span><span class="keyword">);
<br />
&nbsp;&nbsp; </span><span class="default">$lines</span><span class="keyword">[] = </span><span class="default">$buffer</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">fclose </span><span class="keyword">(</span><span class="default">$fd</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
The resulting array is $lines.
<br />

<br />
I did a test on a 200,000 line file. It took seconds with fgets()&nbsp; compared to minutes with file().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19955""></a>
  <div class="note">
   <strong class="user">andrea at brancatelli dot it</strong>
   <a href="#19955" class="date">16-Mar-2002 08:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
file() has a strange behaviour when reading file with both \n and \r as line delimitator (DOS files), since it will return an array with every single line but with just a \n in the end. It seems like \r just disappears.<br />
<br />
This is happening with PHP 4.0.4 for OS/2. Don't know about the Windows version.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
