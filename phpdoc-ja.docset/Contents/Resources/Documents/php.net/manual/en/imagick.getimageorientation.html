<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>画像の方向を取得する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="imagick.getimagemattecolor.html">≪ Imagick::getImageMatteColor</a></li>
      <li style="float: right;"><a href="imagick.getimagepage.html">Imagick::getImagePage ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.imagick.html">Imagick</a></li>
    <li>画像の方向を取得する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="imagick.getimageorientation" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Imagick::getImageOrientation</h1>
  <p class="verinfo">(PECL imagick 2.0.0)</p><p class="refpurpose"><span class="refname">Imagick::getImageOrientation</span> &mdash; <span class="dc-title">画像の方向を取得する</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-imagick.getimageorientation-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><strong>Imagick::getImageOrientation</strong></span>
    ( <span class="methodparam">void</span>
   )</div>


  <p class="para rdfs-comment">
   画像の方向を取得します。返り値は
   <a href="imagick.constants.html#imagick.constants.orientation" class="link">方向定数</a>
   のいずれかとなります。
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-imagick.getimageorientation-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に整数値を返します。
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-imagick.getimageorientation-errors">
  <h3 class="title">エラー / 例外</h3>
  <p class="para">
   エラー時に ImagickException をスローします。
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111448""></a>
  <div class="note">
   <strong class="user">orrd101 at yahoo dot com</strong>
   <a href="#111448" class="date">21-Feb-2013 06:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's how you can use the getImageOrientation() information to auto-rotate images to their correct orientation...
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// Note: $image is an Imagick object, not a filename! See example use below.
<br />
</span><span class="keyword">function </span><span class="default">autoRotateImage</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$orientation </span><span class="keyword">= </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">getImageOrientation</span><span class="keyword">();
<br />

<br />
&nbsp;&nbsp;&nbsp; switch(</span><span class="default">$orientation</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">ORIENTATION_BOTTOMRIGHT</span><span class="keyword">: 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">rotateimage</span><span class="keyword">(</span><span class="string">"#000"</span><span class="keyword">, </span><span class="default">180</span><span class="keyword">); </span><span class="comment">// rotate 180 degrees
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">ORIENTATION_RIGHTTOP</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">rotateimage</span><span class="keyword">(</span><span class="string">"#000"</span><span class="keyword">, </span><span class="default">90</span><span class="keyword">); </span><span class="comment">// rotate 90 degrees CW
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">ORIENTATION_LEFTBOTTOM</span><span class="keyword">: 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">rotateimage</span><span class="keyword">(</span><span class="string">"#000"</span><span class="keyword">, -</span><span class="default">90</span><span class="keyword">); </span><span class="comment">// rotate 90 degrees CCW
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Now that it's auto-rotated, make sure the EXIF data is correct in case the EXIF gets saved with the image!
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageOrientation</span><span class="keyword">(</span><span class="default">imagick</span><span class="keyword">::</span><span class="default">ORIENTATION_TOPLEFT</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Example use:
<br />

<br />
<span class="default">&lt;?php
<br />
$image </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">(</span><span class="string">'my-image-file.jpg'</span><span class="keyword">);
<br />
</span><span class="default">autoRotateImage</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);
<br />
</span><span class="comment">// - Do other stuff to the image here -
<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">writeImage</span><span class="keyword">(</span><span class="string">'result-image.jpg'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109271""></a>
  <div class="note">
   <strong class="user">holdoffhunger at gmail dot com</strong>
   <a href="#109271" class="date">01-Jul-2012 11:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using the getImageOrientation function, you'll get the Orientation value for an image as defined within the EXIF file format.&nbsp; That means you will get back an integer representation one of the Orientation constants for ImageMagick, which looks like " imagick::ORIENTATION_UNDEFINED", with "_VALUE" values of: undefined (0), topleft (1), topright (2), bottomright (3), bottomleft (4), lefttop (5), righttop (6), rightbottom (7), and leftbottom (8).&nbsp; When printed out directly, these predefined constants produce the number in parenthesis.&nbsp; The undefined being set to 0 makes sense, since -- according to Wikipedia -- EXIF allows for eight possible values for an image (and not every image has a set of EXIF properties).<br />
<br />
The EXIF Orientation is also called "the Rotation," again, according to Wikipedia: <a href="http://en.wikipedia.org/wiki/Exchangeable_image_file_format .&nbsp; What" rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Exchangeable_image_file_format .&nbsp; What</a>'s the point of that?&nbsp; According to the official ImageMagick documentation, it's to rotate a photograph so that it is properly oriented after the shot.&nbsp; This really seems to be a camera thing, since the ImageMagick documentation mentions: "If you pointed your camera almost straight up or down, the EXIF orientation setting may not resolve correctly. The same goes for angled or slanted shots. The orientation (and cameras) just have no senses for these situations." ( <a href="http://www.imagemagick.org/Usage/photos/ " rel="nofollow" target="_blank">http://www.imagemagick.org/Usage/photos/ </a>)<br />
<br />
If you're having trouble getting this function to show the value for Image Orientation, then use the function and parameters of getImageProperties('*', FALSE); .&nbsp; This produces an array of all properties associated with an image, and one of them will have the key value of exif:Orientation.&nbsp; If it doesn't, then that means you will be getting back a zero from this function, indicating an "Undefined" orientation.<br />
<br />
Some sample code :<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Author: holdoffhunger@gmail.com<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Imagick Type<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ---------------------------------------------<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$imagick_type </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Open File<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ---------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file_to_grab </span><span class="keyword">= </span><span class="string">"image_workshop_directory/test.jpg"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file_handle_for_viewing_image_file </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$file_to_grab</span><span class="keyword">, </span><span class="string">'a+'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Grab File<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ---------------------------------------------<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$imagick_type</span><span class="keyword">-&gt;</span><span class="default">readImageFile</span><span class="keyword">(</span><span class="default">$file_handle_for_viewing_image_file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Get Orientation Values<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ---------------------------------------------<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$imagick_orientation </span><span class="keyword">= </span><span class="default">$imagick_type</span><span class="keyword">-&gt;</span><span class="default">getImageOrientation</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; switch(</span><span class="default">$imagick_orientation</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'0'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$imagick_orientation_evaluated </span><span class="keyword">= </span><span class="string">"Undefined"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'1'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$imagick_orientation_evaluated </span><span class="keyword">= </span><span class="string">"Top-Left"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'2'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$imagick_orientation_evaluated </span><span class="keyword">= </span><span class="string">"Top-Right"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'3'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$imagick_orientation_evaluated </span><span class="keyword">= </span><span class="string">"Bottom-Right"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'4'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$imagick_orientation_evaluated </span><span class="keyword">= </span><span class="string">"Bottom-Left"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'5'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$imagick_orientation_evaluated </span><span class="keyword">= </span><span class="string">"Left-Top"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'6'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$imagick_orientation_evaluated </span><span class="keyword">= </span><span class="string">"Right-Top"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'7'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$imagick_orientation_evaluated </span><span class="keyword">= </span><span class="string">"Right-Bottom"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'8'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$imagick_orientation_evaluated </span><span class="keyword">= </span><span class="string">"Left-Bottom"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Print Orientation Values<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ---------------------------------------------<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">print(</span><span class="string">"# </span><span class="default">$imagick_orientation</span><span class="string"> - </span><span class="default">$imagick_orientation_evaluated</span><span class="string">"</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
