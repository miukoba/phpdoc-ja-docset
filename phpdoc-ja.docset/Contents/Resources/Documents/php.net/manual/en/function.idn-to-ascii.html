<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>ドメイン名をIDNAのASCII形式に変換する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="ref.intl.idn.html">≪ IDN 関数</a></li>
      <li style="float: right;"><a href="function.idn-to-unicode.html">idn_to_unicode ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.intl.idn.html">IDN 関数</a></li>
    <li>ドメイン名をIDNAのASCII形式に変換する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.idn-to-ascii" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">idn_to_ascii</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.3.0, PECL intl &gt;= 1.0.2, PECL idn &gt;= 0.1)</p><p class="refpurpose"><span class="refname">idn_to_ascii</span> &mdash; <span class="dc-title">ドメイン名をIDNAのASCII形式に変換する</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.idn-to-ascii-description">
  <h3 class="title">説明</h3>
  <p class="para">手続き型</p>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>idn_to_ascii</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$domain</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$variant</code><span class="initializer"> = INTL_IDNA_VARIANT_2003</span></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter reference">&$idna_info</code></span>
  ]]] )</div>

  <p class="para rdfs-comment">
   Unicode のドメイン名を、IDNAが定めたASCII形式に変換します。
  </p> 
  </div>


 <div class="refsect1 parameters" id="refsect1-function.idn-to-ascii-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">domain</code></dt>

     <dd>

      <p class="para">
       変換するドメイン名 PHP5 では、UTF-8にエンコードされている必要があります。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       変換オプション - IDNA_ ではじまる定数
       (IDNA_ERROR_* 定数を除く) の組み合わせです。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">variant</code></dt>

     <dd>

      <p class="para">
       IDNA 2003 の場合は <strong><code>INTL_IDNA_VARIANT_2003</code></strong>、あるいは
       UTS #46 の場合は <strong><code>INTL_IDNA_VARIANT_UTS46</code></strong>。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">idna_info</code></dt>

     <dd>

      <p class="para">
       このパラメータを使うのは、<code class="parameter">variant</code> が
       <strong><code>INTL_IDNA_VARIANT_UTS46</code></strong> の場合だけです。
       このとき、このパラメータには <em>&#039;result&#039;</em>、
       <em>&#039;isTransitionalDifferent&#039;</em>、そして
       <em>&#039;errors&#039;</em> の三つのキーを含む配列が入ります。
       <em>&#039;result&#039;</em> にはおそらく不正だと考えられる変換結果、
       <em>&#039;isTransitionalDifferent&#039;</em> には
       UTS #46 の非移行的な機能を使って結果を変更したかどうかをあらわす boolean 値、そして
       <em>&#039;errors&#039;</em> はエラー定数 IDNA_ERROR_*
       のビットセットを表します。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.idn-to-ascii-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   IDNA のASCII形式でエンコードされたドメイン名。失敗した場合に <strong><code>FALSE</code></strong> を返します
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.idn-to-ascii-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.4.0/PECL 2.0.0b1</td>
       <td>
        パラメータ <code class="parameter">variant</code> と
        <code class="parameter">idna_info</code> が追加され、UTS #46 をサポートするようになりました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.idn-to-ascii-examples">
  <h3 class="title">例</h3>
  <div class="example" id="example-2779">
   <p><strong>例1 <span class="function"><strong>idn_to_ascii()</strong></span> の例</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">idn_to_ascii</span><span style="color: #007700">(</span><span style="color: #DD0000">'tast.de'</span><span style="color: #007700">);&nbsp;<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  <p class="para">上の例の出力は以下となります。</p>
  <div class="example-contents screen">
<div class="cdata"><pre>
xn--tst-qla.de
</pre></div>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.idn-to-ascii-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.idn-to-unicode.html" class="function" rel="rdfs-seeAlso">idn_to_unicode()</a> - idn_to_utf8 のエイリアス</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="108900""></a>
  <div class="note">
   <strong class="user">edible dot email at gmail dot com</strong>
   <a href="#108900" class="date">03-Jun-2012 02:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The notes on this function are not very clear and a little misleading.
<br />

<br />
Firstly, &lt;=5.3, you will need to make use of one of several scripts or classes available on the internet which might, or might not, require the installation of of the intl and idn PECL extensions ...and you will need to have !&lt;4.0 in order to be able to install both.
<br />

<br />
Secondly, if you have &gt;=5.4 you will not require the PECL extensions.
<br />

<br />
Third, use of utf8_encode() is not necessary.&nbsp; In fact, it will potentially prevent idn_to_ascii() from working at all.
<br />

<br />
On my setup it was necessary to change the charset in the script meta tags to UTF-8:
<br />

<br />
&lt;meta http-equiv="Content-Type" content="text/html; CHARSET=shift-jis" /&gt;
<br />

<br />
...and to change charset_default in the php.ini file (/usr/local/lib/php.ini, whereis php.ini, find / -name php.ini):
<br />

<br />
default_charset = "UTF-8"
<br />

<br />
The above changes mean that idn_to_ascii() can now be used with that syntax (no need for utf8_encode()).&nbsp; Previously, the function worked to convert some IDNs, but failed to convert Japanese and Cyrillic IDNs.&nbsp; Further, no additional locales were enabled or added, and Apache's charset file was left unmodified.
<br />

<br />
It is also important to remember only to apply the function where required, eg:
<br />

<br />
idn_to_ascii(casino.com) // is wrong
<br />

<br />
...whereas...
<br />

<br />
iden_to_ascii(casino) // is right
<br />

<br />
...and also be aware of text editors that don't support UTF-8 encoding, or the $domain = 'casino' value will end up as $domain = '??????' ...and the function will fail.
<br />

<br />
I have found that Notepad++ easily and reliably handles UTF-8 encoding that works for this function using UTF-8 as the encoding option, not UTF-8 without BOM.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100860""></a>
  <div class="note">
   <strong class="user">Eman</strong>
   <a href="#100860" class="date">11-Nov-2010 01:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With PHP 5.3 I started to recieve <br />
<br />
Fatal error: Only variables can be passed by reference <br />
<br />
when trying to call idn_to_ascii with second optional parameter (IDNA_DEFAULT). <br />
Moreover these IDNA_* constants are seem to be undefined in PHP 5.3. + PECL idn 0.0.2<br />
<br />
When I tried to uninstall PECL idn and install PECL intl (1.1.1) i recieved this:<br />
<br />
/tmp/pear/temp/intl/collator/collator_class.c:92: error: duplicate 'static'<br />
/tmp/pear/temp/intl/collator/collator_class.c:96: error: duplicate 'static'<br />
/tmp/pear/temp/intl/collator/collator_class.c:101: error: duplicate 'static'<br />
/tmp/pear/temp/intl/collator/collator_class.c:107: error: duplicate 'static'<br />
make: *** [collator/collator_class.lo] Error 1<br />
<br />
So probably compiling PHP 5.3. from sources with --enable-intl will help, but it only means that PHP 5.3. intl version differs from the one available at PECL, which isn't good, I think.<br />
<br />
I've made my code working again by giving second idn_to_ascii parameter as simple integer variable (with value 0), but something bad is going on here and i will not be surprised if it'll break again after another PHP update...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
