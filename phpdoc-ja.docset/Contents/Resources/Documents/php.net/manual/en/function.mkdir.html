<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>ディレクトリを作る</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.lstat.html">≪ lstat</a></li>
      <li style="float: right;"><a href="function.move-uploaded-file.html">move_uploaded_file ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.filesystem.html">ファイルシステム 関数</a></li>
    <li>ディレクトリを作る</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mkdir" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mkdir</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mkdir</span> &mdash; <span class="dc-title">ディレクトリを作る</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.mkdir-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>mkdir</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$pathname</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$mode</code><span class="initializer"> = 0777</span></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$recursive</code><span class="initializer"> = false</span></span>
   [, <span class="methodparam"><span class="type">resource</span> <code class="parameter">$context</code></span>
  ]]] )</div>

  <p class="para rdfs-comment">
   指定したディレクトリを作成します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mkdir-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">pathname</code></dt>

     <dd>

      <p class="para">
       ディレクトリのパス。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">mode</code></dt>

     <dd>

      <p class="para">
       モードは 0777 がデフォルトです。
       これは最も緩やかなアクセス制限を意味します。
       モードに関する詳細は <span class="function"><a href="function.chmod.html" class="function">chmod()</a></span> をご覧ください。
      </p>
      <blockquote class="note"><p><strong class="note">注意</strong>: 
       <p class="para">
        Windows では <code class="parameter">mode</code> は無視されます。
       </p>
      </p></blockquote>
      <p class="para">
       モードを八進数で指定したくなることもあるかもしれません。
       その場合は先頭にゼロをつける必要があります。
       また、モードは、現在設定されている umask の影響も受けます。
       umask を変更するには <span class="function"><a href="function.umask.html" class="function">umask()</a></span> を使用します。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">recursive</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">pathname</code> で、入れ子構造のディレクトリの作成を許可します。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">context</code></dt>

     <dd>

      <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara">コンテキストのサポートは、
PHP 5.0.0 で追加されました。<em>contexts</em> の説明に関しては、
<a href="book.stream.html" class="xref">ストリーム</a> を参照してください。</span></p></blockquote>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mkdir-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mkdir-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-2503">
    <p><strong>例1 <span class="function"><strong>mkdir()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />mkdir</span><span style="color: #007700">(</span><span style="color: #DD0000">"/path/to/my/dir"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0700</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2504">
    <p><strong>例2 <span class="function"><strong>mkdir()</strong></span> での <code class="parameter">recursive</code> パラメータの使用例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;作りたいフォルダ構造<br /></span><span style="color: #0000BB">$structure&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'./depth1/depth2/depth3/'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;入れ子構造を作るには、$recursive&nbsp;パラメータを<br />//&nbsp;mkdir()&nbsp;に指定しなければなりません<br /><br /></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">mkdir</span><span style="color: #007700">(</span><span style="color: #0000BB">$structure</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0777</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">'Failed&nbsp;to&nbsp;create&nbsp;folders...'</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;...<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-function.mkdir-errors">
  <h3 class="title">エラー / 例外</h3>
  <p class="para">
   ディレクトリが既に存在する場合は <strong><code>E_WARNING</code></strong> レベルのエラーが発生します。
  </p>
  <p class="para">
   ディレクトリの作成権限がない場合は <strong><code>E_WARNING</code></strong> レベルのエラーが発生します。
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mkdir-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara"> <a href="features.safe-mode.html" class="link">セーフモード</a> が有効の場合、PHP は、
操作を行うディレクトリが、実行するスクリプトと同じ UID (所有者)を有しているか
どうかを確認します。</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mkdir-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.rmdir.html" class="function" rel="rdfs-seeAlso">rmdir()</a> - ディレクトリを削除する</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115151""></a>
  <div class="note">
   <strong class="user">haclong</strong>
   <a href="#115151" class="date">04-Jun-2014 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using the SPL FileInfo object and then try to create the path with mkdir, don't forget that mkdir expects a string as the first argument and NOT an object...<br />
<br />
I have forgotten that very important rules and get only a permission deny to mkdir to create new directories but in fact, the issue was the fact that i wasn't passing a string to mkdir<br />
<br />
$my_file = new SplFileInfo('path/to/file.txt') ;<br />
<br />
// get path from file<br />
$parent = $my_file-&gt;getPathInfo() ;<br />
<br />
// check if path is directory or not<br />
if($parent-&gt;isDir())<br />
{<br />
// create / open file.txt file<br />
} else {<br />
// if path/to does not exists, create the directory recursively<br />
mkdir($parent, 0755, true) ; // THIS WON'T WORK because $parent is a SplFileInfo object.<br />
<br />
// instead, get the path as a string <br />
$path = $parent-&gt;getPathname() ;<br />
mkdir($path, 0755, true) ; // THIS WILL WORK<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114960""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#114960" class="date">06-May-2014 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't forget to use the recursive option on Windows if creating a folder below a folder that already exists. Otherwise you may get a very confusing error message, "Warning: mkdir(): No such file or directory in d:\path\to\file" where you think the folder should exist but you forgot to create the parent(s).<br />
<br />
For example, if d:\path exists but there is nothing in it:<br />
<br />
<span class="default">&lt;?php<br />
$path </span><span class="keyword">= </span><span class="string">'d:\path\to\my\file'</span><span class="keyword">;<br />
</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">null</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105227""></a>
  <div class="note">
   <strong class="user">matt at imaketheweb dot com</strong>
   <a href="#105227" class="date">04-Aug-2011 03:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're getting a Permission Denied error, but are certain the permissions and ownership where you are trying to create the directory are correct, check again:<br />
<br />
The location where you are trying to create the directory in must have the Execute permission for the owner trying to create it, regardless of if the folder is Readable, or Writable.<br />
<br />
This may be obvious to some, but was not to me at first. Hopefully this will save you the trouble I went through.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104752""></a>
  <div class="note">
   <strong class="user">pz</strong>
   <a href="#104752" class="date">05-Jul-2011 06:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mkdir works with stream wrappers, so it's ok to write mkdir('<a href="ftp://user:pass@server/mydir" rel="nofollow" target="_blank">ftp://user:pass@server/mydir</a>');<br />
<br />
which really made my day</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104301""></a>
  <div class="note">
   <strong class="user">toppi at kacke dot de</strong>
   <a href="#104301" class="date">07-Jun-2011 05:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have problems with the SAFE MODE Restriction in effect i.e. if you try to create and access to subdirectorys recursive you can use ftp-lib like this.<br />
<br />
<span class="default">&lt;?php<br />
<br />
DEFINE </span><span class="keyword">(</span><span class="string">'FTP_USER'</span><span class="keyword">,</span><span class="string">'yourUser'</span><span class="keyword">); <br />
</span><span class="default">DEFINE </span><span class="keyword">(</span><span class="string">'FTP_PASS'</span><span class="keyword">,</span><span class="string">'yourPassword'</span><span class="keyword">);<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Returns the created directory or false.<br />
&nbsp;*<br />
&nbsp;* @param Directory to create (String)<br />
&nbsp;* @return Created directory or false;<br />
&nbsp;*/<br />
<br />
</span><span class="keyword">function </span><span class="default">mkDirFix </span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">,</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$conn_id </span><span class="keyword">= @</span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="string">"localhost"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$conn_id</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (@</span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">FTP_USER</span><span class="keyword">, </span><span class="default">FTP_PASS</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$path </span><span class="keyword">as </span><span class="default">$dir</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$dir</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$currPath</span><span class="keyword">.=</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!@</span><span class="default">ftp_chdir</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">,</span><span class="default">$currPath</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!@</span><span class="default">ftp_mkdir</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">,</span><span class="default">$currPath</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">ftp_chmod</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">$currPath</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$currPath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Maybe it helps.<br />
Toppi</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104153""></a>
  <div class="note">
   <strong class="user">nickcarenza at gmail dot com</strong>
   <a href="#104153" class="date">26-May-2011 10:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having trouble with the pathname, use:<br />
<br />
echo dirname( __FILE__ );<br />
<br />
That will show you the pathname of the current script and you will be able to use that to see where you have to start your pathname.<br />
<br />
I tried forever to do mkdir('dirname') and was getting permission denied. I can see now its because it was trying to create that folder up at home when i wanted it down in public_html.<br />
<br />
I hope this saves someone some time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103772""></a>
  <div class="note">
   <strong class="user">[Rakesh Verma] rakeshnsony at gmail dot com</strong>
   <a href="#103772" class="date">03-May-2011 08:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you are unable to create recursive folder(s) using 0755 mode in your php script.<br />
<br />
Then try it by changing your current user to apache and test it again. <br />
<br />
Hopefully you will get positive results</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102823""></a>
  <div class="note">
   <strong class="user">julius - grantzau - c-o-m</strong>
   <a href="#102823" class="date">08-Mar-2011 05:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Remember to use clearstatcache()<br />
<br />
... when working with filesystem functions.<br />
<br />
Otherwise, as an example, you can get an error creating a folder (using mkdir) just after deleting it (using rmdir).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101213""></a>
  <div class="note">
   <strong class="user">Benjamin Rack</strong>
   <a href="#101213" class="date">02-Dec-2010 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be mentioned that - at least on Windows - when using UNC paths with mkdir the 2nd parameter $mode should not be specified. Otherwise mkdir fails to create the directory on the given UNC path.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99810""></a>
  <div class="note">
   <strong class="user">satis at clankiller dot com</strong>
   <a href="#99810" class="date">08-Sep-2010 03:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that in a shared environment I failed to take into account an existing umask when I did a mkdir(dirname, 0755).&nbsp; This ended up creating the directory (function returned true), but I didn't have rights to do anything inside the folder, nor could I even view that it existed via ftp.<br />
<br />
However, file_exists(dirname) returned true.&nbsp; Eventually I figured out what happened and was able to rmdir(dirname), then created the directory correctly.<br />
<br />
So, when writing scripts you expect to be portable, either use umask to set your umask accordingly, or do a straight mkdir(dirname) followed by chmod(dirname, 0755) (or whatever it is you're looking for).&nbsp; If you make the same mistake I did, you should be able to rmdir() or chmod() the folder so it's accessible.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96990""></a>
  <div class="note">
   <strong class="user">jack dot sleight at gmail dot com</strong>
   <a href="#96990" class="date">26-Mar-2010 12:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using the recursive parameter bear in mind that if you're using chmod() after mkdir() to set the mode without it being modified by the value of uchar() you need to call chmod() on all created directories. ie:<br />
<br />
<span class="default">&lt;?php<br />
mkdir</span><span class="keyword">(</span><span class="string">'/test1/test2'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">chmod</span><span class="keyword">(</span><span class="string">'/test1/test2'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span> <br />
<br />
May result in "/test1/test2" having a mode of 0777 but "/test1" still having a mode of 0755 from the mkdir() call. You'd need to do:<br />
<br />
<span class="default">&lt;?php<br />
mkdir</span><span class="keyword">(</span><span class="string">'/test1/test2'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">chmod</span><span class="keyword">(</span><span class="string">'/test1'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">);<br />
</span><span class="default">chmod</span><span class="keyword">(</span><span class="string">'/test1/test2'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95891""></a>
  <div class="note">
   <strong class="user">michael at neo dot co dot il</strong>
   <a href="#95891" class="date">27-Jan-2010 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
sometimes the directory created with another mode than specified ( 0755 instead 0777&nbsp; etc).
<br />
to solve that use :
<br />

<br />
<span class="default">&lt;?php
<br />
$old </span><span class="keyword">= </span><span class="default">umask</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);
<br />
</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">);
<br />
</span><span class="default">umask</span><span class="keyword">(</span><span class="default">$old</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92678""></a>
  <div class="note">
   <strong class="user">ethaizone at hotmail dot com</strong>
   <a href="#92678" class="date">03-Aug-2009 10:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When I created folder on windows with mkdir, I found some problem from folder nam so I write this function.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">filename_safe</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$except </span><span class="keyword">= array(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="string">':'</span><span class="keyword">, </span><span class="string">'*'</span><span class="keyword">, </span><span class="string">'?'</span><span class="keyword">, </span><span class="string">'"'</span><span class="keyword">, </span><span class="string">'&lt;'</span><span class="keyword">, </span><span class="string">'&gt;'</span><span class="keyword">, </span><span class="string">'|'</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$except</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
It can use with another functions about file system as file_put_contents to clean up file name.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89390""></a>
  <div class="note">
   <strong class="user">vlad at todosv dot com</strong>
   <a href="#89390" class="date">05-Mar-2009 05:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that you should NOT enter the $mode value with "" or '' sorrounding it.<br />
<br />
So, this should be valid:<br />
<span class="default">&lt;?php mkdir</span><span class="keyword">(</span><span class="string">"dir1/dir2"</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
But this is not:<br />
<span class="default">&lt;?php mkdir</span><span class="keyword">(</span><span class="string">"dir1/dir2"</span><span class="keyword">,</span><span class="string">"0777"</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
Nor this:<br />
<span class="default">&lt;?php mkdir</span><span class="keyword">(</span><span class="string">"dir1/dir2"</span><span class="keyword">,</span><span class="string">'0777'</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">); </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89069""></a>
  <div class="note">
   <strong class="user">d dot kok at kadova dot nl</strong>
   <a href="#89069" class="date">20-Feb-2009 09:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that when specifying the recursive option the function returns false anyway if the directory already exists. <br />
<br />
For some reason however I expected it to behave like `mkdir -p` on the command line which succeeds if the directory already exists.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87696""></a>
  <div class="note">
   <strong class="user">t-k-r at o2 dot pl</strong>
   <a href="#87696" class="date">17-Dec-2008 10:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Very simple script, may be useful to someone.<br />
Creating a directory structure liki this:<br />
<br />
0 ------ 0<br />
1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1<br />
2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2 -------- 0<br />
3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 1<br />
4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 2<br />
5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3<br />
6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...<br />
7<br />
[....]<br />
e<br />
f<br />
<br />
Used by my as structure to store uploaded files:<br />
someone upload file -&gt; its name + microtime is md5 -&gt; first 3 letters of md5 string are first 3 subfolders in this folder structure, and at least file is stroed with md5 name.<br />
Naturally SQL- or other type - Database is needed to store infos about files position in this structure.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">for (</span><span class="default">$a</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">&lt;=</span><span class="default">15</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">),</span><span class="default">0755</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$b</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$b</span><span class="keyword">&lt;=</span><span class="default">15</span><span class="keyword">;</span><span class="default">$b</span><span class="keyword">++) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">).</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">),</span><span class="default">0755</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$c</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$c</span><span class="keyword">&lt;=</span><span class="default">15</span><span class="keyword">;</span><span class="default">$c</span><span class="keyword">++) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">).</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">).</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">dechex</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">),</span><span class="default">0755</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85821""></a>
  <div class="note">
   <strong class="user">hinom - iMasters</strong>
   <a href="#85821" class="date">19-Sep-2008 07:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mkdir simple test with "exception handler"<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">handleError</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'MY ERROR'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/** usage sample<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @handleError();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $php_errormsg;<br />
&nbsp;&nbsp;&nbsp; */<br />
</span><span class="keyword">}<br />
<br />
</span><span class="comment">// detect slash/backslash nomenclature dirname<br />
</span><span class="default">$path </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">( </span><span class="default">__FILE__ </span><span class="keyword">);<br />
</span><span class="default">$slash </span><span class="keyword">= </span><span class="string">'/'</span><span class="keyword">; </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$slash </span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="default">$slash </span><span class="keyword">= </span><span class="string">'\\'</span><span class="keyword">;<br />
</span><span class="default">define</span><span class="keyword">( </span><span class="string">'BASE_DIR'</span><span class="keyword">, </span><span class="default">$path </span><span class="keyword">. </span><span class="default">$slash </span><span class="keyword">);<br />
<br />
</span><span class="default">$folder&nbsp; </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// folder name<br />
</span><span class="default">$dirPath </span><span class="keyword">= </span><span class="default">BASE_DIR </span><span class="keyword">. </span><span class="default">$folder</span><span class="keyword">;&nbsp;&nbsp; </span><span class="comment">// folder path<br />
<br />
// print results<br />
</span><span class="keyword">echo </span><span class="default">$slash</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;hr&gt;'</span><span class="keyword">;<br />
<br />
</span><span class="default">$rs </span><span class="keyword">= @</span><span class="default">mkdir</span><span class="keyword">( </span><span class="default">$dirPath</span><span class="keyword">, </span><span class="string">'0777' </span><span class="keyword">);<br />
@</span><span class="default">handleError</span><span class="keyword">();<br />
if( </span><span class="default">$rs </span><span class="keyword">)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// print success information<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'was done!'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;folder: &lt;a href="' </span><span class="keyword">. </span><span class="default">$folder </span><span class="keyword">. </span><span class="string">'"&gt;' </span><span class="keyword">. </span><span class="default">$folder </span><span class="keyword">. </span><span class="string">'&lt;/a&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;dirPath: ' </span><span class="keyword">. </span><span class="default">$dirPath</span><span class="keyword">;<br />
<br />
}else{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// print error information<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'an error was occurred. Attempting create folder'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;dirPath: ' </span><span class="keyword">. </span><span class="default">$dirPath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;br&gt;php_errormsg: ' </span><span class="keyword">. </span><span class="default">$php_errormsg</span><span class="keyword">;<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84458""></a>
  <div class="note">
   <strong class="user">php at mike2k dot com</strong>
   <a href="#84458" class="date">15-Jul-2008 10:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that all of the recursive mkdir functions coded below are no longer required - as of 5.0.0 it says the "recursive" flag is available. I just tested it, it properly works (and I would assume it works for streams and Windows as well, if not, then it would be a bug)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83265""></a>
  <div class="note">
   <strong class="user">GelaMu at GMail dot com</strong>
   <a href="#83265" class="date">18-May-2008 02:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Makes directory and returns BOOL(TRUE) if exists OR made.<br />
&nbsp;*<br />
&nbsp;* @param&nbsp; $path Path name<br />
&nbsp;* @return bool<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">rmkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$mode </span><span class="keyword">= </span><span class="default">0755</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">preg_replace</span><span class="keyword">(array(</span><span class="string">"/\\\\/"</span><span class="keyword">, </span><span class="string">"/\/{2,}/"</span><span class="keyword">), </span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">), </span><span class="string">"/"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">ltrim</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) == </span><span class="string">"/"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$e</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$e</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cp </span><span class="keyword">= </span><span class="default">$e</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$c</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$cp</span><span class="keyword">) &amp;&amp; !@</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$cp</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cp </span><span class="keyword">.= </span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return @</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81119""></a>
  <div class="note">
   <strong class="user">code at ashleyhunt dot co dot uk</strong>
   <a href="#81119" class="date">14-Feb-2008 08:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a script to create a recursive directory path on NAS or another server using Common Internet File System (CIFS)<br />
<br />
e.g. you already have a directory on a server<br />
\\server/share/dir1/dir2<br />
<br />
you want to create some more directories<br />
\\server/share/dir1/dir2/dir3/dir4<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">remote_mkpath</span><span class="keyword">(</span><span class="default">$server</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">)&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/(\/){2,}|(\\\){1,}/'</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">$path</span><span class="keyword">); </span><span class="comment">//only forward-slash<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="string">"\\\\" </span><span class="keyword">. </span><span class="default">$server </span><span class="keyword">. </span><span class="string">"/"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$dirs </span><span class="keyword">AS </span><span class="default">$element</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">.= </span><span class="default">$element </span><span class="keyword">. </span><span class="string">"/"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; </span><span class="default">$i </span><span class="keyword">!= </span><span class="default">0</span><span class="keyword">) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)){ <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"something was wrong at : " </span><span class="keyword">. </span><span class="default">$path</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$path</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// example usage<br />
</span><span class="default">remote_mkpath</span><span class="keyword">(</span><span class="string">"SERVER"</span><span class="keyword">, </span><span class="string">"share/dir1/dir2/dir3/dir4"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Good luck!<br />
<br />
Ashley</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80553""></a>
  <div class="note">
   <strong class="user">david dot NOSPAM at ajnewmedia dot NOSPAM dot co dot uk</strong>
   <a href="#80553" class="date">22-Jan-2008 06:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
p-garcia : since PHP 5, setting the recursive flag (which currently has no notes in the manual entry) will allow you to create nested directories in the same way as Windows / Linux mkdir -p, so long as the webserver has permissions to write in the root directory of the path specified<br />
eg:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; mkdir </span><span class="keyword">(</span><span class="string">"./newdir1/newdir2/newdir3/"</span><span class="keyword">, </span><span class="default">0755</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">// Returns TRUE if you have permission to write to the current directory <br />
&nbsp; //&nbsp;&nbsp; and creates nested directories with permissionsrwxr-xr-x<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77383""></a>
  <div class="note">
   <strong class="user">Michal Nazarewicz, mina86 at mina86 dot com</strong>
   <a href="#77383" class="date">27-Aug-2007 04:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On the other hand, splitting path on something else then a DIRECTORY_SEPARATOR may give unexpected results when someone accualy wants a file name with backslash in it! Moreover, neither Alan's nor pluto's code check for errors or return any value. Also, I don't like the isset($folder[$i]) technique -- there is a count() function you know.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">recursive_mkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$mode </span><span class="keyword">= </span><span class="default">0777</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$dirs</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$count</span><span class="keyword">; ++</span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">.= </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">$dirs</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) &amp;&amp; !</span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
It will only fail if someone specifies a mode which does not allow owner to create new entries in directory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73760""></a>
  <div class="note">
   <strong class="user">sean at pedlr dot com</strong>
   <a href="#73760" class="date">09-Mar-2007 05:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that although the documentation says that&nbsp; the default permissions for mkdir are 0777, this is not always the case.<br />
<br />
I'm running LAMP and without explicitly setting the permissions, the directories created had permissions of 0755.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71880""></a>
  <div class="note">
   <strong class="user">fantasysportswire at yahoo dot com</strong>
   <a href="#71880" class="date">21-Dec-2006 03:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One small correction on a note from Frank in June 2006 on recursive directories under Windows.<br />
<br />
First - this should be in the documentation as its the only function that I know of that php does not fix the slashes automatically.<br />
<br />
Franks note stated:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $mypath</span><span class="keyword">=</span><span class="string">"testdir\subdir\test"</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$mypath</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This doesn't work in windows:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $mypath</span><span class="keyword">=</span><span class="string">"testdir/subdir/test"</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$mypath</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span> <br />
<br />
----<br />
<br />
This will work a bit better :)<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $mypath</span><span class="keyword">=</span><span class="string">"testdir\\subdir\\test"</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$mypath</span><span class="keyword">,</span><span class="default">0777</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68207""></a>
  <div class="note">
   <strong class="user">kungla at gmail dot com</strong>
   <a href="#68207" class="date">18-Jul-2006 02:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Somehow the recursive version of mkdir didn't work for me on Mac and the workaraounds listed below alsow didn't work for me, so heres my solution:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mkdir_r</span><span class="keyword">(</span><span class="default">$dirName</span><span class="keyword">, </span><span class="default">$rights</span><span class="keyword">=</span><span class="default">0777</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$dirName</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$dirs </span><span class="keyword">as </span><span class="default">$part</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir</span><span class="keyword">.=</span><span class="default">$part</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) &amp;&amp; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$rights</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Tested and works ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64136""></a>
  <div class="note">
   <strong class="user">jamespilcher1hotmail</strong>
   <a href="#64136" class="date">08-Apr-2006 02:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
one small gotcha:<br />
<br />
mkdir(""), mkdir(false), and mkdir(null) give a "file exists" error. this is also true of a directory name consisting of any string that only contains space characters.<br />
<br />
(this was on php 5.1.2 on Windows 2000)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62852""></a>
  <div class="note">
   <strong class="user">Ali Baba</strong>
   <a href="#62852" class="date">10-Mar-2006 10:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Greg, your code does not work for me; maybe it has a bug or we have configuration changes. Anyway, this one works to create recursively the directory DIRECTORY. <br />
<br />
&lt;?<br />
define ("DIRECTORY", "/tmp/mydir/mysubdir");<br />
<br />
do {<br />
&nbsp;&nbsp;&nbsp; $dir = DIRECTORY;<br />
&nbsp;&nbsp;&nbsp; while (!is_dir($dir)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $basedir = dirname($dir);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($basedir == '/' || is_dir($basedir))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; mkdir($dir,0777);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $dir=$basedir;<br />
&nbsp;&nbsp; }<br />
} while ($dir != DIRECTORY);<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60861""></a>
  <div class="note">
   
   <a href="#60861" class="date">18-Jan-2006 06:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
function mkdirs($dir, $mode = 0777, $recursive = true) {<br />
&nbsp; if( is_null($dir) || $dir === "" ){<br />
&nbsp;&nbsp;&nbsp; return FALSE;<br />
&nbsp; }<br />
&nbsp; if( is_dir($dir) || $dir === "/" ){<br />
&nbsp;&nbsp;&nbsp; return TRUE;<br />
&nbsp; }<br />
&nbsp; if( mkdirs(dirname($dir), $mode, $recursive) ){<br />
&nbsp;&nbsp;&nbsp; return mkdir($dir, $mode);<br />
&nbsp; }<br />
&nbsp; return FALSE;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58393""></a>
  <div class="note">
   <strong class="user">Kevin Cook</strong>
   <a href="#58393" class="date">02-Nov-2005 06:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I could not get the sticky bit set properly using the octal mode: 2775 (rwxrwsr-x)<br />
<br />
$foo='my_directory';<br />
<br />
$old_umask = umask(0);<br />
mkdir($foo,2775);<br />
umask($old_umask);<br />
<br />
using the above lines renders a directory with permissions:<br />
<br />
d-wx-wSrwt&nbsp; 2 www www 4096 Nov&nbsp; 2 11:43 my_directory<br />
<br />
Not exactly what I was looking for.<br />
<br />
This gets closer to the mark:<br />
<br />
$foo='my_directory';<br />
<br />
$old_umask = umask(0);<br />
mkdir($foo,0777); // the default chmod<br />
umask($old_umask);<br />
<br />
drwxrwsrwx&nbsp; 2 www www 4096 Nov&nbsp; 2 11:46 my_directory</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53075""></a>
  <div class="note">
   <strong class="user">roth at egotec dot com</strong>
   <a href="#53075" class="date">23-May-2005 08:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The 'mkdir' function doesn't function correctly on Windows when the path<br />
contains forward slashes. The part of the path with the forward slashes<br />
doesn't get created.<br />
<br />
mkdir('c:/a/b/c/d', 0775, true);<br />
<br />
You get the error message:<br />
Warning: mkdir() [function.mkdir]: No such file or directory<br />
<br />
Please use backslashes under Windows or use the constant DIRECTORY_SEPARATOR.<br />
<br />
mkdir('c:\a\b\c\d', 0775, true);<br />
mkdir('c:'.DIRECTORY_SEPARATOR.'a'.<br />
DIRECTORY_SEPARATOR.'b'.<br />
DIRECTORY_SEPARATOR.'c'.<br />
DIRECTORY_SEPARATOR.'d', 0775, true);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52355""></a>
  <div class="note">
   <strong class="user">webmaster2007 at home dot nl</strong>
   <a href="#52355" class="date">28-Apr-2005 05:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Maybe you can use this:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">open_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$newdir</span><span class="keyword">){&nbsp; &nbsp; </span><span class="comment">//The function that will copy the files<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) &amp;&amp; </span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$open_dir</span><span class="keyword">=</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$open_dir</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">) &amp;&amp; </span><span class="default">filetype</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">) != </span><span class="string">"dir"</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">filetype</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">) == </span><span class="string">"dir"</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">open_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">copy</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$newdir</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">open_dir</span><span class="keyword">(</span><span class="string">"Your source map"</span><span class="keyword">, </span><span class="string">"Your destination map"</span><span class="keyword">); </span><span class="comment">//Here you can fill in your source en destination map<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50568""></a>
  <div class="note">
   <strong class="user">Protik Mukherjee</strong>
   <a href="#50568" class="date">03-Mar-2005 06:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mkdir, file rw, permission related notes for Fedora 3////<br />
If you are using Fedora 3 and are facing permission problems, better check if SElinux is enabled on ur system. It add an additional layer of security and as a result PHP cant write to the folder eventhough it has 777 permissions. It took me almost a week to deal with this!<br />
<br />
If you are not sure google for SElinux or 'disabling SELinux' and it may be the cure! Best of luck!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="1207""></a>
  <div class="note">
   <strong class="user">aulbach at unter dot franken dot de</strong>
   <a href="#1207" class="date">22-Jul-1999 11:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an annotation from Stig Bakken:
<br />

<br />
The mode on your directory is affected by your current umask.&nbsp; It will end
<br />
up having (&lt;mkdir-mode&gt; and (not &lt;umask&gt;)).&nbsp; If you want to create one
<br />
that is publicly readable, do something like this:
<br />

<br />
<span class="default">&lt;?php
<br />
$oldumask </span><span class="keyword">= </span><span class="default">umask</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);
<br />
</span><span class="default">mkdir</span><span class="keyword">(</span><span class="string">'mydir'</span><span class="keyword">, </span><span class="default">0777</span><span class="keyword">); </span><span class="comment">// or even 01777 so you get the sticky bit set
<br />
</span><span class="default">umask</span><span class="keyword">(</span><span class="default">$oldumask</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
