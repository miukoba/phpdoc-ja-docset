<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>URL を解釈し、その構成要素を返す</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.http-build-query.html">≪ http_build_query</a></li>
      <li style="float: right;"><a href="function.rawurldecode.html">rawurldecode ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.url.html">URL 関数</a></li>
    <li>URL を解釈し、その構成要素を返す</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.parse-url" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">parse_url</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">parse_url</span> &mdash; <span class="dc-title">URL を解釈し、その構成要素を返す</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.parse-url-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <span class="methodname"><strong>parse_url</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$url</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$component</code><span class="initializer"> = -1</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   この関数は、URL の様々な構成要素のうち特定できるものに関して
   連想配列にして返します。
  </p>
  <p class="para">
   この関数は、指定された URL が有効かどうかを調べるためのもの
   <em class="emphasis">ではなく</em>、単に URL を上で示した
   要素に分解するだけのものです。不完全な URL であっても受け入れられますし、
   そのような場合でも <span class="function"><strong>parse_url()</strong></span> は可能な限り
   正しく解析しようとします。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.parse-url-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">url</code></dt>

     <dd>

      <p class="para">
       パースする URL。無効な文字は
       <em>_</em> に置換されます。
      </p>
     </dd>

    
   </dl>

   <dl>

    
     <dt>
<code class="parameter">component</code></dt>

     <dd>

      <p class="para">
       <strong><code>PHP_URL_SCHEME</code></strong>、
       <strong><code>PHP_URL_HOST</code></strong>、<strong><code>PHP_URL_PORT</code></strong>、
       <strong><code>PHP_URL_USER</code></strong>、<strong><code>PHP_URL_PASS</code></strong>、
       <strong><code>PHP_URL_PATH</code></strong>、<strong><code>PHP_URL_QUERY</code></strong>
       あるいは <strong><code>PHP_URL_FRAGMENT</code></strong> のうちのいずれかを指定し、
       特定の URL コンポーネントのみを文字列
       (<strong><code>PHP_URL_PORT</code></strong> を指定した場合だけは整数値)
       で取得するようにします。
      </p>
     </dd>

    
   </dl>


  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.parse-url-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   完全におかしな形式の URL については、<span class="function"><strong>parse_url()</strong></span> は
   <strong><code>FALSE</code></strong> を返します。
  </p>
  <p class="para">
   <code class="parameter">component</code> を省略した場合は、連想配列を返します。
   連想配列の中には少なくともひとつの要素が含まれます。
   この配列に含まれる可能性のある要素は次のとおりです。
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      <var class="varname"><var class="varname">scheme</var></var> - 例: http
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <var class="varname"><var class="varname">host</var></var> 
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <var class="varname"><var class="varname">port</var></var>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <var class="varname"><var class="varname">user</var></var>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <var class="varname"><var class="varname">pass</var></var>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <var class="varname"><var class="varname">path</var></var>
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <var class="varname"><var class="varname">query</var></var> - クエスチョンマーク <em>?</em> 以降
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <var class="varname"><var class="varname">fragment</var></var> - ハッシュマーク <em>#</em> 以降
     </span>
    </li>
   </ul>
  </p>
  <p class="para">
   <code class="parameter">component</code> が指定されている場合、
   <span class="function"><strong>parse_url()</strong></span> は配列ではなく文字列
   (<strong><code>PHP_URL_PORT</code></strong> の場合は整数値) を返します。
   要求したコンポーネントが指定した URL の中にない場合は
   <strong><code>NULL</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.parse-url-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.4.7</td>
       <td>
        <em class="emphasis">host</em> の認識方法を修正し、
        <em class="emphasis">scheme</em> を省略してコンポーネント区切りから始まる場合にも対応するようになりました。
       </td>
      </tr>

      <tr>
       <td>5.3.3</td>
       <td>
        URL のパースに失敗したときに
        <strong><code>E_WARNING</code></strong> を発生させないようになりました。
       </td>
      </tr>

      <tr>
       <td>5.1.2</td>
       <td>パラメータ <code class="parameter">component</code> が追加されました。</td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.parse-url-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-4212">
    <p><strong>例1 <span class="function"><strong>parse_url()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$url&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'http://username:password@hostname/path?arg=value#anchor'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">parse_url</span><span style="color: #007700">(</span><span style="color: #0000BB">$url</span><span style="color: #007700">));<br /><br />echo&nbsp;</span><span style="color: #0000BB">parse_url</span><span style="color: #007700">(</span><span style="color: #0000BB">$url</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PHP_URL_PATH</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [scheme] =&gt; http
    [host] =&gt; hostname
    [user] =&gt; username
    [pass] =&gt; password
    [path] =&gt; /path
    [query] =&gt; arg=value
    [fragment] =&gt; anchor
)
/path
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-4213">
    <p><strong>例2 <span class="function"><strong>parse_url()</strong></span> でスキームを省略した例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$url&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'//www.example.com/path?googleguy=googley'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;5.4.7&nbsp;より前のバージョンでは、パスを&nbsp;"//www.example.com/path"&nbsp;のように表示していました<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">parse_url</span><span style="color: #007700">(</span><span style="color: #0000BB">$url</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
array(3) {
  [&quot;host&quot;]=&gt;
  string(15) &quot;www.example.com&quot;
  [&quot;path&quot;]=&gt;
  string(5) &quot;/path&quot;
  [&quot;query&quot;]=&gt;
  string(17) &quot;googleguy=googley&quot;
}
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.parse-url-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    この関数は相対 URL では動作しません。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    <span class="function"><strong>parse_url()</strong></span> は URL をパースするための関数であり、
    URI をパースするものではありません。しかし、PHP の後方互換性を満たすため、
    例外として file:// スキームについては 3 重スラッシュ(file:///...)
    が認められています。他のスキームにおいては、これは無効な形式となります。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.parse-url-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.pathinfo.html" class="function" rel="rdfs-seeAlso">pathinfo()</a> - ファイルパスに関する情報を返す</span></li>
    <li class="member"><span class="function"><a href="function.parse-str.html" class="function" rel="rdfs-seeAlso">parse_str()</a> - 文字列を処理し、変数に代入する</span></li>
    <li class="member"><span class="function"><a href="function.http-build-query.html" class="function" rel="rdfs-seeAlso">http_build_query()</a> - URL エンコードされたクエリ文字列を生成する</span></li>
    <li class="member"><span class="function"><a href="function.http-build-url.html" class="function" rel="rdfs-seeAlso">http_build_url()</a> - URL を組み立てる</span></li>
    <li class="member"><span class="function"><a href="function.dirname.html" class="function" rel="rdfs-seeAlso">dirname()</a> - 親ディレクトリのパスを返す</span></li>
    <li class="member"><span class="function"><a href="function.basename.html" class="function" rel="rdfs-seeAlso">basename()</a> - パスの最後にある名前の部分を返す</span></li>
    <li class="member"><a href="http://www.faqs.org/rfcs/rfc3986" class="link external" title="Link : http://www.faqs.org/rfcs/rfc3986">&raquo;&nbsp;RFC 3986</a></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="114817""></a>
  <div class="note">
   <strong class="user">lauris () lauris ! lv</strong>
   <a href="#114817" class="date">09-Apr-2014 05:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is utf-8 compatible parse_url() replacement function based on "laszlo dot janszky at gmail dot com" work. Original incorrectly handled URLs with user:pass. Also made PHP 5.5 compatible (got rid of now deprecated regex /e modifier).<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * UTF-8 aware parse_url() replacement.<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * @return array<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">mb_parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$enc_url </span><span class="keyword">= </span><span class="default">preg_replace_callback</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'%[^:/@?&amp;=#]+%usD'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; function (</span><span class="default">$matches</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; },<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$enc_url</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$parts </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new \</span><span class="default">InvalidArgumentException</span><span class="keyword">(</span><span class="string">'Malformed URL: ' </span><span class="keyword">. </span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$parts </span><span class="keyword">as </span><span class="default">$name </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$parts</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114704""></a>
  <div class="note">
   <strong class="user">ivijan dot stefan at gmail dot com</strong>
   <a href="#114704" class="date">27-Mar-2014 01:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a good way to using parse_url () gets the youtube link.<br />
This function I used in many works:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">youtube</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">=</span><span class="default">560</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">=</span><span class="default">315</span><span class="keyword">, </span><span class="default">$fullscreen</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parse_str</span><span class="keyword">( </span><span class="default">parse_url</span><span class="keyword">( </span><span class="default">$url</span><span class="keyword">, </span><span class="default">PHP_URL_QUERY </span><span class="keyword">), </span><span class="default">$my_array_of_vars </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$youtube</span><span class="keyword">= </span><span class="string">'&lt;iframe allowtransparency="true" scrolling="no" width="'</span><span class="keyword">.</span><span class="default">$width</span><span class="keyword">.</span><span class="string">'" height="'</span><span class="keyword">.</span><span class="default">$height</span><span class="keyword">.</span><span class="string">'" src="//www.youtube.com/embed/'</span><span class="keyword">.</span><span class="default">$my_array_of_vars</span><span class="keyword">[</span><span class="string">'v'</span><span class="keyword">].</span><span class="string">'" frameborder="0"'</span><span class="keyword">.(</span><span class="default">$fullscreen</span><span class="keyword">?</span><span class="string">' allowfullscreen'</span><span class="keyword">:</span><span class="default">NULL</span><span class="keyword">).</span><span class="string">'&gt;&lt;/iframe&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$youtube</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// show youtube on my page<br />
</span><span class="default">$url</span><span class="keyword">=</span><span class="string">'<a href="http://www.youtube.com/watch?v=yvTd6XxgCBE" rel="nofollow" target="_blank">http://www.youtube.com/watch?v=yvTd6XxgCBE</a>'</span><span class="keyword">;<br />
&nbsp;</span><span class="default">youtube</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">560</span><span class="keyword">, </span><span class="default">315</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
parse_url () allocates a unique youtube code and&nbsp; put into iframe link and displayed on your page. The size of the videos choose yourself.<br />
<br />
Enjoy.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114307""></a>
  <div class="note">
   <strong class="user">webmaster at bigbirdmedia dot com</strong>
   <a href="#114307" class="date">06-Feb-2014 01:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple function using "parse_url" to find the base URL of the given link.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">getPrimaryDomain</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$tld </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">,</span><span class="default">PHP_URL_HOST</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$tldArray </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">,</span><span class="default">$tld</span><span class="keyword">);<br />
&nbsp; <br />
&nbsp; </span><span class="comment">// COUNTS THE POSITION IN THE ARRAY TO IDENTIFY THE TOP LEVEL DOMAIN (TLD)<br />
&nbsp; </span><span class="default">$l1 </span><span class="keyword">= </span><span class="string">'0'</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; foreach(</span><span class="default">$tldArray </span><span class="keyword">as </span><span class="default">$s</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// CHECKS THE POSITION IN THE ARRAY TO SEE IF IT MATCHES ANY OF THE KNOWN TOP LEVEL DOMAINS (YOU CAN ADD TO THIS LIST)<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$s </span><span class="keyword">== </span><span class="string">'com' </span><span class="keyword">|| </span><span class="default">$s </span><span class="keyword">== </span><span class="string">'net' </span><span class="keyword">|| </span><span class="default">$s </span><span class="keyword">== </span><span class="string">'info' </span><span class="keyword">|| </span><span class="default">$s </span><span class="keyword">== </span><span class="string">'biz' </span><span class="keyword">|| </span><span class="default">$s </span><span class="keyword">== </span><span class="string">'us' </span><span class="keyword">|| </span><span class="default">$s </span><span class="keyword">== </span><span class="string">'co' </span><span class="keyword">|| </span><span class="default">$s </span><span class="keyword">== </span><span class="string">'org' </span><span class="keyword">|| </span><span class="default">$s </span><span class="keyword">== </span><span class="string">'me'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// CALCULATES THE SECOND LEVEL DOMAIN POSITION IN THE ARRAY ONCE THE POSITION OF THE TOP LEVEL DOMAIN IS IDENTIFIED<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$l2 </span><span class="keyword">= </span><span class="default">$l1 </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// INCREMENTS THE COUNTER FOR THE TOP LEVEL DOMAIN POSITION IF NO MATCH IS FOUND<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$l1</span><span class="keyword">++;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; <br />
&nbsp; </span><span class="comment">// RETURN THE SECOND LEVEL DOMAIN AND THE TOP LEVEL DOMAIN IN THE FORMAT LIKE "SOMEDOMAIN.COM"<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">$tldArray</span><span class="keyword">[</span><span class="default">$l2</span><span class="keyword">] . </span><span class="string">'.' </span><span class="keyword">. </span><span class="default">$tldArray</span><span class="keyword">[</span><span class="default">$l1</span><span class="keyword">];<br />
}<br />
<br />
</span><span class="comment">// CALL THE FUNCTION - THIS EXAMPLE RETURNS "BITLY.COM"<br />
</span><span class="default">getPrimaryDomain</span><span class="keyword">(</span><span class="string">'<a href="http://www.enterprise.bitly.com/?utm_source=homepage" rel="nofollow" target="_blank">http://www.enterprise.bitly.com/?utm_source=homepage</a>);<br />
<br />
?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112571""></a>
  <div class="note">
   <strong class="user">utilmind</strong>
   <a href="#112571" class="date">01-Jul-2013 09:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
parse_url doesn't works if the protocol doesn't specified. This seems like sandard, even the youtube doesn't gives the protocol name when generates code for embedding which have a look like "//youtube.com/etc".<br />
<br />
So, to avoid bug, you must always check, whether the provided url has the protocol, and if not (starts with 2 slashes) -- add the "http:" prefix.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108787""></a>
  <div class="note">
   <strong class="user">laszlo dot janszky at gmail dot com</strong>
   <a href="#108787" class="date">25-May-2012 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Created another parse_url utf-8 compatible function.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mb_parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$encodedUrl </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'%[^:/?#&amp;=\.]+%usDe'</span><span class="keyword">, </span><span class="string">'urlencode(\'$0\')'</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$components </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$encodedUrl</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$components </span><span class="keyword">as &amp;</span><span class="default">$component</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$component </span><span class="keyword">= </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$component</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$components</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107291""></a>
  <div class="note">
   <strong class="user">therselman at gmail</strong>
   <a href="#107291" class="date">28-Jan-2012 10:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
UTF-8 aware parse_url() replacement.
<br />

<br />
I've realized that even though UTF-8 characters are not allowed in URL's, I have to work with a lot of them and parse_url() will break.
<br />

<br />
Based largely on the work of "mallluhuct at gmail dot com", I added parse_url() compatible "named values" which makes the array values a lot easier to work with (instead of just numbers). I also implemented detection of port, username/password and a back-reference to better detect URL's like this: //en.wikipedia.com
<br />
... which, although is technically an invalid URL, it's used extensively on sites like wikipedia in the href of anchor tags where it's valid in browsers (one of the types of URL's you have to support when crawling pages). This will be accurately detected as the host name instead of "path" as in all other examples.
<br />

<br />
I will submit my complete function (instead of just the RegExp) which is an almost "drop-in" replacement for parse_url(). It returns a cleaned up array (or false) with values compatible with parse_url(). I could have told the preg_match() not to store the unused extra values, but it would complicate the RegExp and make it more difficult to read, understand and extend. The key to detecting UTF-8 characters is the use of the "u" parameter in preg_match().
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">parse_utf8_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$keys </span><span class="keyword">= array(</span><span class="string">'scheme'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">,</span><span class="string">'user'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">,</span><span class="string">'pass'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">,</span><span class="string">'host'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">,</span><span class="string">'port'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">,</span><span class="string">'path'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">,</span><span class="string">'query'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">,</span><span class="string">'fragment'</span><span class="keyword">=&gt;</span><span class="default">0</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">) &amp;&amp; </span><span class="default">preg_match</span><span class="keyword">(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'~^((?P&lt;scheme&gt;[^:/?#]+):(//))?((\\3|//)?(?:(?P&lt;user&gt;[^:]+):(?P&lt;pass&gt;[^@]+)@)?(?P&lt;host&gt;[^/?:#]*))(:(?P&lt;port&gt;\\d+))?' </span><span class="keyword">.
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'(?P&lt;path&gt;[^?#]*)(\\?(?P&lt;query&gt;[^#]*))?(#(?P&lt;fragment&gt;.*))?~u'</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">))
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$matches </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$keys</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) || empty(</span><span class="default">$value</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$matches</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
UTF-8 URL's can/should be "normalized" after extraction with this function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106731""></a>
  <div class="note">
   <strong class="user">thomas at gielfeldt dot com</strong>
   <a href="#106731" class="date">02-Dec-2011 11:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[If you haven't yet] been able to find a simple conversion back to string from a parsed url, here's an example:
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
$url </span><span class="keyword">= </span><span class="string">'<a href="http://usr:pss@example.com:81/mypath/myfile.html?a=b&amp;b[]=2&amp;b[]=3#myfragment" rel="nofollow" target="_blank">http://usr:pss@example.com:81/mypath/myfile.html?a=b&amp;b[]=2&amp;b[]=3#myfragment</a>'</span><span class="keyword">;
<br />
if (</span><span class="default">$url </span><span class="keyword">=== </span><span class="default">unparse_url</span><span class="keyword">(</span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">))) {
<br />
&nbsp; print </span><span class="string">"YES, they match!\n"</span><span class="keyword">;
<br />
}
<br />

<br />
function </span><span class="default">unparse_url</span><span class="keyword">(</span><span class="default">$parsed_url</span><span class="keyword">) {
<br />
&nbsp; </span><span class="default">$scheme&nbsp;&nbsp; </span><span class="keyword">= isset(</span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">]) ? </span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">] . </span><span class="string">'://' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$host&nbsp; &nbsp;&nbsp; </span><span class="keyword">= isset(</span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]) ? </span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$port&nbsp; &nbsp;&nbsp; </span><span class="keyword">= isset(</span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]) ? </span><span class="string">':' </span><span class="keyword">. </span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$user&nbsp; &nbsp;&nbsp; </span><span class="keyword">= isset(</span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">]) ? </span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$pass&nbsp; &nbsp;&nbsp; </span><span class="keyword">= isset(</span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">]) ? </span><span class="string">':' </span><span class="keyword">. </span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">]&nbsp; : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$pass&nbsp; &nbsp;&nbsp; </span><span class="keyword">= (</span><span class="default">$user </span><span class="keyword">|| </span><span class="default">$pass</span><span class="keyword">) ? </span><span class="string">"</span><span class="default">$pass</span><span class="string">@" </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$path&nbsp; &nbsp;&nbsp; </span><span class="keyword">= isset(</span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]) ? </span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$query&nbsp; &nbsp; </span><span class="keyword">= isset(</span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]) ? </span><span class="string">'?' </span><span class="keyword">. </span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$fragment </span><span class="keyword">= isset(</span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">]) ? </span><span class="string">'#' </span><span class="keyword">. </span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp; return </span><span class="string">"</span><span class="default">$scheme$user$pass$host$port$path$query$fragment</span><span class="string">"</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104874""></a>
  <div class="note">
   <strong class="user">gustavo dot andriuolo at vulcabras dot com dot ar</strong>
   <a href="#104874" class="date">13-Jul-2011 03:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a method to get the REAL name of a domain. This return just the domain name, not the rest. First check if is not an IP, then return the name:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">esip</span><span class="keyword">(</span><span class="default">$ip_addr</span><span class="keyword">)
<br />
{
<br />
&nbsp; </span><span class="comment">//first of all the format of the ip address is matched
<br />
&nbsp; </span><span class="keyword">if(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/"</span><span class="keyword">,</span><span class="default">$ip_addr</span><span class="keyword">))
<br />
&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//now all the intger values are separated
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">,</span><span class="default">$ip_addr</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//now we need to check each part can range from 0-255
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$parts </span><span class="keyword">as </span><span class="default">$ip_parts</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$ip_parts</span><span class="keyword">)&gt;</span><span class="default">255 </span><span class="keyword">|| </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$ip_parts</span><span class="keyword">)&lt;</span><span class="default">0</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">; </span><span class="comment">//if number is not within range of 0-255
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">TRUE</span><span class="keyword">;
<br />
&nbsp; }
<br />
&nbsp; else
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">; </span><span class="comment">//if format of ip address doesn't matches
<br />
</span><span class="keyword">}
<br />

<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">domain</span><span class="keyword">(</span><span class="default">$domainb</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bits </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$domainb</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$bits</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]==</span><span class="string">'http:' </span><span class="keyword">|| </span><span class="default">$bits</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]==</span><span class="string">'https:'</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$domainb</span><span class="keyword">= </span><span class="default">$bits</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$domainb</span><span class="keyword">= </span><span class="default">$bits</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; unset(</span><span class="default">$bits</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bits </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$domainb</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$idz</span><span class="keyword">=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$bits</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$idz</span><span class="keyword">-=</span><span class="default">3</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bits</span><span class="keyword">[(</span><span class="default">$idz</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">)])==</span><span class="default">2</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url</span><span class="keyword">=</span><span class="default">$bits</span><span class="keyword">[</span><span class="default">$idz</span><span class="keyword">].</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$bits</span><span class="keyword">[(</span><span class="default">$idz</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">)].</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$bits</span><span class="keyword">[(</span><span class="default">$idz</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">)];
<br />
&nbsp;&nbsp;&nbsp; } else if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bits</span><span class="keyword">[(</span><span class="default">$idz</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">)])==</span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url</span><span class="keyword">=</span><span class="default">$bits</span><span class="keyword">[(</span><span class="default">$idz</span><span class="keyword">)].</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$bits</span><span class="keyword">[(</span><span class="default">$idz</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">)];
<br />
&nbsp;&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url</span><span class="keyword">=</span><span class="default">$bits</span><span class="keyword">[(</span><span class="default">$idz</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">)].</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$bits</span><span class="keyword">[(</span><span class="default">$idz</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">)];
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$url</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$address</span><span class="keyword">=</span><span class="string">'clients1.sub3.google.co.uk'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$parsed_url </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$address</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$check </span><span class="keyword">= </span><span class="default">esip</span><span class="keyword">(</span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$host </span><span class="keyword">= </span><span class="default">$parsed_url</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$check </span><span class="keyword">== </span><span class="default">FALSE</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$host </span><span class="keyword">!= </span><span class="string">""</span><span class="keyword">){ 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$host </span><span class="keyword">= </span><span class="default">domain</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$host </span><span class="keyword">= </span><span class="default">domain</span><span class="keyword">(</span><span class="default">$address</span><span class="keyword">);&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$host</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">?&gt;
<br />
</span>This return: google.co.uk
<br />
'<a href="http://sub1.sub2.sub3.example.com:443" rel="nofollow" target="_blank">http://sub1.sub2.sub3.example.com:443</a>';
<br />
return: example.com
<br />
'example.com';
<br />
return: example.com
<br />

<br />
Many times&nbsp; parse_url return nothing when domain is google.com only for example.
<br />

<br />
Now, google.com, or google.co.uk will return the same.
<br />

<br />
Maybe is a little dirty, but works well for me, i use it to group internet access log from squid.
<br />

<br />
Regards.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104527""></a>
  <div class="note">
   <strong class="user">Simon D</strong>
   <a href="#104527" class="date">21-Jun-2011 03:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To get the params (url query) as Associative array, use this function:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* Returns the url query as associative array
<br />
&nbsp;*
<br />
&nbsp;* @param&nbsp; &nbsp; string&nbsp; &nbsp; query
<br />
&nbsp;* @return&nbsp; &nbsp; array&nbsp; &nbsp; params
<br />
&nbsp;*/
<br />
</span><span class="keyword">function </span><span class="default">convertUrlQuery</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$queryParts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$query</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$params </span><span class="keyword">= array();
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$queryParts </span><span class="keyword">as </span><span class="default">$param</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">$param</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$params</span><span class="keyword">[</span><span class="default">$item</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = </span><span class="default">$item</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$params</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103297""></a>
  <div class="note">
   <strong class="user">Egor Chernodarov</strong>
   <a href="#103297" class="date">06-Apr-2011 10:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Noticed the following differences in error handling:<br />
<br />
<span class="default">&lt;?php <br />
&nbsp;&nbsp;&nbsp; print_r</span><span class="keyword">(</span><span class="default">parse_url</span><span class="keyword">(</span><span class="string">'<a href="ftp://user:password@host:port" rel="nofollow" target="_blank">ftp://user:password@host:port</a>'</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
In PHP 5.2.6 returns:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [scheme] =&gt; ftp<br />
&nbsp;&nbsp;&nbsp; [host] =&gt; host<br />
&nbsp;&nbsp;&nbsp; [user] =&gt; user<br />
&nbsp;&nbsp;&nbsp; [pass] =&gt; password<br />
)<br />
<br />
port is just skipped.<br />
<br />
But in PHP 5.3.6 returns NULL without any warnings.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101433""></a>
  <div class="note">
   <strong class="user">bahtiar at gadimov dot de</strong>
   <a href="#101433" class="date">16-Dec-2010 02:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi,<br />
<br />
if you have problems with UTF8 encoded urls please see <a href="http://bugs.php.net/bug.php?id=52923 . parse_url breaks the utf8. :( You have to implement it yourself." rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=52923 . parse_url breaks the utf8. :( You have to implement it yourself.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101331""></a>
  <div class="note">
   <strong class="user">Mark Dobrinic</strong>
   <a href="#101331" class="date">10-Dec-2010 11:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems the host-part strips off the last [:port] off the end of the hostname
<br />

<br />
When something is wrong in the actual request, this proves to be the wrong way to do things.
<br />

<br />
It would be better to not strip off the [:port], but to keep the string *before* the first [:port] as the hostname.
<br />

<br />
Problem with (maybe malformed) provided HTTP_HOST
<br />
hostname:443:443
<br />
that resolved in
<br />
'host' =&gt; 'hostname:443'
<br />

<br />
Which gave me problems.
<br />

<br />
Solution would be to enforce this yourself, explicitly:
<br />

<br />
<span class="default">&lt;?php
<br />
$p </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">( </span><span class="default">$url </span><span class="keyword">);
<br />
</span><span class="default">$host </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">, </span><span class="default">$p</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]);
<br />
</span><span class="default">$hostname </span><span class="keyword">= </span><span class="default">$host</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100114""></a>
  <div class="note">
   <strong class="user">jesse at example dot com</strong>
   <a href="#100114" class="date">26-Sep-2010 04:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@ solenoid: Your code was very helpful, but it fails when the current URL has no query string (it appends '&amp;' instead of '?' before the query).&nbsp; Below is a fixed version that catches this edge case and corrects it.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">modify_url</span><span class="keyword">(</span><span class="default">$mod</span><span class="keyword">) <br />
{ <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="string">"<a href="http://" rel="nofollow" target="_blank">http://</a>"</span><span class="keyword">.</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">].</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REQUEST_URI'</span><span class="keyword">]; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"&amp;"</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'QUERY_STRING'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'QUERY_STRING'</span><span class="keyword">]) {</span><span class="default">$queryStart </span><span class="keyword">= </span><span class="string">"?"</span><span class="keyword">;} else {</span><span class="default">$queryStart </span><span class="keyword">= </span><span class="string">"&amp;"</span><span class="keyword">;}<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// modify/delete data <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$query </span><span class="keyword">as </span><span class="default">$q</span><span class="keyword">) <br />
&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$q</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$mod</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$mod</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">$mod</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="default">$url</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/&amp;?'</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// add new data <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$mod </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) <br />
&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$value </span><span class="keyword">&amp;&amp; !</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'=/'</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">.= </span><span class="default">$queryStart</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$url</span><span class="keyword">; <br />
} <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99973""></a>
  <div class="note">
   <strong class="user">martin at planio dot com</strong>
   <a href="#99973" class="date">17-Sep-2010 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of you sending URLs in HTML emails with a redirect address in the query string, note that Hotmail unescapes / and : characters in the query string. So that breaks the parse_url() function call. Take this as an example:<br />
href="<a href="http://example.com/redirect?url=http%3A%2F%2Fplanio.com" rel="nofollow" target="_blank">http://example.com/redirect?url=http%3A%2F%2Fplanio.com</a>"<br />
Hotmail will transform it to this:<br />
href="<a href="http://example.com/redirect?url=http://planio.com" rel="nofollow" target="_blank">http://example.com/redirect?url=http://planio.com</a>"<br />
<br />
The solution is to be preventive before the call to parse_url():<br />
<span class="default">&lt;?php<br />
$q_index </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$uri</span><span class="keyword">, </span><span class="string">'?'</span><span class="keyword">);<br />
if (</span><span class="default">$q_index </span><span class="keyword">!== </span><span class="default">FALSE </span><span class="keyword">&amp;&amp; <br />
&nbsp; (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$uri</span><span class="keyword">, </span><span class="string">':'</span><span class="keyword">, </span><span class="default">$q_index</span><span class="keyword">) !== </span><span class="default">FALSE </span><span class="keyword">|| </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$uri</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$q_index</span><span class="keyword">) !== </span><span class="default">FALSE</span><span class="keyword">)) {<br />
&nbsp; </span><span class="default">$begin </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$uri</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$q_index</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$end </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$uri</span><span class="keyword">, </span><span class="default">$q_index</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$uri</span><span class="keyword">)-</span><span class="default">$q_index</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$end </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'%2F'</span><span class="keyword">, </span><span class="default">$end</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$end </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">, </span><span class="string">'%3A'</span><span class="keyword">, </span><span class="default">$end</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$uri </span><span class="keyword">= </span><span class="default">$begin</span><span class="keyword">.</span><span class="default">$end</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99490""></a>
  <div class="note">
   <strong class="user">przemek at sobstel dot org</strong>
   <a href="#99490" class="date">19-Aug-2010 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to get host, function will return NULL if you pass only host.<br />
<br />
Example:<br />
<br />
<span class="default">&lt;?php<br />
parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">PHP_URL_HOST</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
$url =&gt; value returned<br />
<br />
<a href="http://example.com =&gt; string " rel="nofollow" target="_blank">http://example.com =&gt; string </a>'example.com' (length=11)<br />
<a href="http://www.example.com =&gt;string " rel="nofollow" target="_blank">http://www.example.com =&gt;string </a>'www.example.com' (length=15)<br />
<a href="http://www.example.com:8080 =&gt; string " rel="nofollow" target="_blank">http://www.example.com:8080 =&gt; string </a>'www.example.com' (length=15)<br />
example.com =&gt; null<br />
www.example.com =&gt; null<br />
example.com:8080 =&gt; string 'example.com' (length=11)<br />
www.example.com:8080 =&gt; string 'www.example.com' (length=15)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97496""></a>
  <div class="note">
   <strong class="user">solenoid at example dot com</strong>
   <a href="#97496" class="date">23-Apr-2010 01:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a piece of code that modifies, replaces or removes the url query. This can typically used in paging situations where there are more parameters than the page.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">modify_url</span><span class="keyword">(</span><span class="default">$mod</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="string">"<a href="http://" rel="nofollow" target="_blank">http://</a>"</span><span class="keyword">.</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">].</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REQUEST_URI'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"&amp;"</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'QUERY_STRING'</span><span class="keyword">]);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// modify/delete data
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$query </span><span class="keyword">as </span><span class="default">$q</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">, </span><span class="default">$q</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$mod</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$mod</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">])
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">$mod</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="default">$url</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/&amp;?'</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// add new data
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$mod </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$value </span><span class="keyword">&amp;&amp; !</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'=/'</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">.= </span><span class="string">'&amp;'</span><span class="keyword">.</span><span class="default">$key</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$url</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="comment">// page url: "<a href="http://www.example.com/page.php?p=5&amp;show=list&amp;style=23" rel="nofollow" target="_blank">http://www.example.com/page.php?p=5&amp;show=list&amp;style=23</a>"
<br />

<br />
</span><span class="default">$url </span><span class="keyword">= </span><span class="default">modify_url</span><span class="keyword">(array(</span><span class="string">'p' </span><span class="keyword">=&gt; </span><span class="default">4</span><span class="keyword">, </span><span class="string">'show' </span><span class="keyword">=&gt; </span><span class="string">'column'</span><span class="keyword">));
<br />

<br />
</span><span class="comment">// $url = "<a href="http://www.example.com/page.php?p=4&amp;show=column&amp;style=23" rel="nofollow" target="_blank">http://www.example.com/page.php?p=4&amp;show=column&amp;style=23</a>"
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96433""></a>
  <div class="note">
   <strong class="user">james at roundeights dot com</strong>
   <a href="#96433" class="date">26-Feb-2010 08:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was writing unit tests and needed to cause this function to kick out an error and return FALSE in order to test a specific execution path. If anyone else needs to force a failure, the following inputs will work:
<br />

<br />
<span class="default">&lt;?php
<br />
parse_url</span><span class="keyword">(</span><span class="string">"<a href="http:///example.com" rel="nofollow" target="_blank">http:///example.com</a>"</span><span class="keyword">);
<br />
</span><span class="default">parse_url</span><span class="keyword">(</span><span class="string">"<a href="http://:80" rel="nofollow" target="_blank">http://:80</a>"</span><span class="keyword">);
<br />
</span><span class="default">parse_url</span><span class="keyword">(</span><span class="string">"<a href="http://user@:80" rel="nofollow" target="_blank">http://user@:80</a>"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95304""></a>
  <div class="note">
   <strong class="user">need_sunny at yahoo dot com</strong>
   <a href="#95304" class="date">25-Dec-2009 02:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks to xellisx for his parse_query function. I used it in one of my projects and it works well. But it has an error. I fixed the error and improved it a little bit. Here is my version of it:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Originally written by xellisx<br />
</span><span class="keyword">function </span><span class="default">parse_query</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">)<br />
&nbsp;{<br />
&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; *&nbsp; Use this function to parse out the query array element from<br />
&nbsp;&nbsp; *&nbsp; the output of parse_url().<br />
&nbsp;&nbsp; */<br />
&nbsp; </span><span class="default">$var&nbsp; </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">, </span><span class="default">PHP_URL_QUERY</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$var&nbsp; </span><span class="keyword">= </span><span class="default">html_entity_decode</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$var&nbsp; </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$arr&nbsp; </span><span class="keyword">= array();<br />
<br />
&nbsp; foreach(</span><span class="default">$var </span><span class="keyword">as </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = </span><span class="default">$x</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; }<br />
&nbsp; unset(</span><span class="default">$val</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">$arr</span><span class="keyword">;<br />
&nbsp;}<br />
</span><span class="default">?&gt;<br />
</span><br />
At the first line there was parse_query($val), I made it $var. It used to return a null array before this fix.<br />
<br />
I have added the parse_url line. So now the function will only focus in the query part, not the whole URL. This is useful if something like below is done:<br />
<span class="default">&lt;?php<br />
$my_GET </span><span class="keyword">= </span><span class="default">parse_query</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REQUEST_URI'</span><span class="keyword">]);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93983""></a>
  <div class="note">
   <strong class="user">nirazuelos at gmail dot com</strong>
   <a href="#93983" class="date">09-Oct-2009 11:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello, for some odd reason, parse_url returns the host (ex. example.com) as the path when no scheme is provided in the input url. So I've written a quick function to get the real host:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">getHost</span><span class="keyword">(</span><span class="default">$Address</span><span class="keyword">) {
<br />
&nbsp;&nbsp; </span><span class="default">$parseUrl </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$Address</span><span class="keyword">));
<br />
&nbsp;&nbsp; return </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$parseUrl</span><span class="keyword">[</span><span class="default">host</span><span class="keyword">] ? </span><span class="default">$parseUrl</span><span class="keyword">[</span><span class="default">host</span><span class="keyword">] : </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$parseUrl</span><span class="keyword">[</span><span class="default">path</span><span class="keyword">], </span><span class="default">2</span><span class="keyword">)));
<br />
}
<br />

<br />
</span><span class="default">getHost</span><span class="keyword">(</span><span class="string">"example.com"</span><span class="keyword">); </span><span class="comment">// Gives example.com
<br />
</span><span class="default">getHost</span><span class="keyword">(</span><span class="string">"<a href="http://example.com" rel="nofollow" target="_blank">http://example.com</a>"</span><span class="keyword">); </span><span class="comment">// Gives example.com
<br />
</span><span class="default">getHost</span><span class="keyword">(</span><span class="string">"www.example.com"</span><span class="keyword">); </span><span class="comment">// Gives www.example.com
<br />
</span><span class="default">getHost</span><span class="keyword">(</span><span class="string">"<a href="http://example.com/xyz" rel="nofollow" target="_blank">http://example.com/xyz</a>"</span><span class="keyword">); </span><span class="comment">// Gives example.com
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
You could try anything! It gives the host (including the subdomain if exists).
<br />

<br />
Hope it helped you.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92230""></a>
  <div class="note">
   <strong class="user">ap dot public1 at gmail dot com</strong>
   <a href="#92230" class="date">15-Jul-2009 05:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple static library that allows easy manipulation of url parameters:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * File provides easy way to manipulate url parameters<br />
&nbsp;&nbsp; &nbsp; * @author Alexander Podgorny<br />
&nbsp;&nbsp; &nbsp; */<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">class </span><span class="default">Url </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * Splits url into array of it's pieces as follows:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * [scheme]://[user]:[pass]@[host]/[path]?[query]#[fragment]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * In addition it adds 'query_params' key which contains array of <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * url-decoded key-value pairs<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @param String $sUrl Url<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @return Array Parsed url pieces<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$sUrl</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$sUrl</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query_params'</span><span class="keyword">] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aPairs </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">DU</span><span class="keyword">::</span><span class="default">show</span><span class="keyword">(</span><span class="default">$aPairs</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$aPairs </span><span class="keyword">as </span><span class="default">$sPair</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$sPair</span><span class="keyword">) == </span><span class="string">''</span><span class="keyword">) { continue; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$sKey</span><span class="keyword">, </span><span class="default">$sValue</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">$sPair</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query_params'</span><span class="keyword">][</span><span class="default">$sKey</span><span class="keyword">] = </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$sValue</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$aUrl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * Compiles url out of array of it's pieces (returned by explodeUrl)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * 'query' is ignored if 'query_params' is present<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @param Array $aUrl Array of url pieces<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">implode</span><span class="keyword">(</span><span class="default">$aUrl</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//[scheme]://[user]:[pass]@[host]/[path]?[query]#[fragment]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sQuery </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Compile query<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (isset(</span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query_params'</span><span class="keyword">]) &amp;&amp; </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query_params'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aPairs </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query_params'</span><span class="keyword">] as </span><span class="default">$sKey</span><span class="keyword">=&gt;</span><span class="default">$sValue</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aPairs</span><span class="keyword">[] = </span><span class="default">$sKey</span><span class="keyword">.</span><span class="string">'='</span><span class="keyword">.</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$sValue</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sQuery </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$aPairs</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sQuery </span><span class="keyword">= </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Compile url<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sUrl </span><span class="keyword">= <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">] . </span><span class="string">'://' </span><span class="keyword">. (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; isset(</span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">]) &amp;&amp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">] != </span><span class="string">'' </span><span class="keyword">&amp;&amp; isset(</span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">]) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">] . </span><span class="string">':' </span><span class="keyword">. </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">] . </span><span class="string">'@' <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">: </span><span class="string">''<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">) .<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] . (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; isset(</span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]) &amp;&amp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] != </span><span class="string">''<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">? </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : </span><span class="string">''<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">) . (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$sQuery </span><span class="keyword">!= </span><span class="string">''<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">? </span><span class="string">'?' </span><span class="keyword">. </span><span class="default">$sQuery<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">: </span><span class="string">''<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">) . (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isset(</span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">]) &amp;&amp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">] != </span><span class="string">''<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">? </span><span class="string">'#' </span><span class="keyword">. </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : </span><span class="string">''<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$sUrl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * Parses url and returns array of key-value pairs of url params<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @param String $sUrl<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @return Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">getParams</span><span class="keyword">(</span><span class="default">$sUrl</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">explode</span><span class="keyword">(</span><span class="default">$sUrl</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query_params'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * Removes existing url params and sets them to those specified in $aParams<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @param String $sUrl Url<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @param Array $aParams Array of Key-Value pairs to set url params to<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @return&nbsp; String Newly compiled url <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">setParams</span><span class="keyword">(</span><span class="default">$sUrl</span><span class="keyword">, </span><span class="default">$aParams</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">explode</span><span class="keyword">(</span><span class="default">$sUrl</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query_params'</span><span class="keyword">] = </span><span class="default">$aParams</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">implode</span><span class="keyword">(</span><span class="default">$aUrl</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * Updates values of existing url params and/or adds (if not set) those specified in $aParams<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @param String $sUrl Url<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @param Array $aParams Array of Key-Value pairs to set url params to<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * @return&nbsp; String Newly compiled url <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">updateParams</span><span class="keyword">(</span><span class="default">$sUrl</span><span class="keyword">, </span><span class="default">$aParams</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">explode</span><span class="keyword">(</span><span class="default">$sUrl</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query_params'</span><span class="keyword">] = </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$aUrl</span><span class="keyword">[</span><span class="string">'query_params'</span><span class="keyword">], </span><span class="default">$aParams</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">implode</span><span class="keyword">(</span><span class="default">$aUrl</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90365""></a>
  <div class="note">
   <strong class="user">theoriginalmarksimpson at gmail dot com</strong>
   <a href="#90365" class="date">18-Apr-2009 02:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
An update to the function by FredLudd at gmail dot com.&nbsp; I added IPv6 functionality as well.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">j_parseUrl</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$r&nbsp; </span><span class="keyword">= </span><span class="string">"(?:([a-z0-9+-._]+)://)?"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.=&nbsp;&nbsp; </span><span class="string">"(?:((?:[a-z0-9-._~!$&amp;'()*+,;=:]|%[0-9a-f]{2})*)@)?"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.=&nbsp;&nbsp; </span><span class="string">"(?:\[((?:[a-z0-9:])*)\])?"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.=&nbsp;&nbsp; </span><span class="string">"((?:[a-z0-9-._~!$&amp;'()*+,;=]|%[0-9a-f]{2})*)"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.=&nbsp;&nbsp; </span><span class="string">"(?::(\d*))?"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.=&nbsp;&nbsp; </span><span class="string">"(/(?:[a-z0-9-._~!$&amp;'()*+,;=:@/]|%[0-9a-f]{2})*)?"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.=&nbsp;&nbsp; </span><span class="string">"|"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.=&nbsp;&nbsp; </span><span class="string">"(/?"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.=&nbsp; &nbsp;&nbsp; </span><span class="string">"(?:[a-z0-9-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})+"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.=&nbsp; &nbsp;&nbsp; </span><span class="string">"(?:[a-z0-9-._~!$&amp;'()*+,;=:@\/]|%[0-9a-f]{2})*"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.=&nbsp; &nbsp; </span><span class="string">")?"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">")"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:\?((?:[a-z0-9-._~!$&amp;'()*+,;=:\/?@]|%[0-9a-f]{2})*))?"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:#((?:[a-z0-9-._~!$&amp;'()*+,;=:\/?@]|%[0-9a-f]{2})*))?"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"`</span><span class="default">$r</span><span class="string">`i"</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">, </span><span class="default">$match</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$parts </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"scheme"</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"userinfo"</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"authority"</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"host"</span><span class="keyword">=&gt; </span><span class="string">''</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"port"</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"path"</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"query"</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"fragment"</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">);<br />
&nbsp; switch (</span><span class="default">count </span><span class="keyword">(</span><span class="default">$match</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">10</span><span class="keyword">: </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">] = </span><span class="default">$match</span><span class="keyword">[</span><span class="default">9</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">9</span><span class="keyword">: </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] = </span><span class="default">$match</span><span class="keyword">[</span><span class="default">8</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">8</span><span class="keyword">: </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] =&nbsp; </span><span class="default">$match</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">7</span><span class="keyword">: </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] =&nbsp; </span><span class="default">$match</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] . </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">6</span><span class="keyword">: </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] =&nbsp; </span><span class="default">$match</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">5</span><span class="keyword">: </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] =&nbsp; </span><span class="default">$match</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">]?</span><span class="string">"["</span><span class="keyword">.</span><span class="default">$match</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">].</span><span class="string">"]"</span><span class="keyword">:</span><span class="default">$match</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">4</span><span class="keyword">: </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'userinfo'</span><span class="keyword">] =&nbsp; </span><span class="default">$match</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">3</span><span class="keyword">: </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">] =&nbsp; </span><span class="default">$match</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'authority'</span><span class="keyword">] = (</span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'userinfo'</span><span class="keyword">]?</span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'userinfo'</span><span class="keyword">].</span><span class="string">"@"</span><span class="keyword">:</span><span class="string">""</span><span class="keyword">).<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (</span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]?</span><span class="string">":"</span><span class="keyword">.</span><span class="default">$parts</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]:</span><span class="string">""</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">$parts</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
When using the url<br />
<br />
&nbsp; /* line too long for this site's comment handler */<br />
&nbsp; "foo://username:password@[2001:4860:0:2001::68]:8042".<br />
&nbsp;&nbsp; &nbsp;&nbsp; "/over/there/index.dtb;type=animal?name=ferret#nose"<br />
<br />
The original would return<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [scheme] =&gt; foo<br />
&nbsp;&nbsp;&nbsp; [userinfo] =&gt; username:password<br />
&nbsp;&nbsp;&nbsp; [authority] =&gt; username:password@<br />
&nbsp;&nbsp;&nbsp; [host] =&gt; <br />
&nbsp;&nbsp;&nbsp; [port] =&gt; <br />
&nbsp;&nbsp;&nbsp; [path] =&gt; <br />
&nbsp;&nbsp;&nbsp; [query] =&gt; <br />
&nbsp;&nbsp;&nbsp; [fragment] =&gt; <br />
)<br />
<br />
The new one returns<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [scheme] =&gt; foo<br />
&nbsp;&nbsp;&nbsp; [userinfo] =&gt; username:password<br />
&nbsp;&nbsp;&nbsp; [authority] =&gt; username:password@[2001:4860:0:2001::68]:8042<br />
&nbsp;&nbsp;&nbsp; [host] =&gt; [2001:4860:0:2001::68]<br />
&nbsp;&nbsp;&nbsp; [port] =&gt; 8042<br />
&nbsp;&nbsp;&nbsp; [path] =&gt; /over/there/index.dtb;type=animal<br />
&nbsp;&nbsp;&nbsp; [query] =&gt; name=ferret<br />
&nbsp;&nbsp;&nbsp; [fragment] =&gt; nose<br />
)<br />
<br />
All of the other examples FredLudd used below still work exactly the same.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86611""></a>
  <div class="note">
   <strong class="user">pbcomm at gmail dot com</strong>
   <a href="#86611" class="date">26-Oct-2008 06:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Modification to the code from:<br />
theoriginalmarksimpson at gmail dot com<br />
<br />
Change:<br />
$r .= "(?:(?P&lt;login&gt;\w+):(?P&lt;pass&gt;\w+)@)?";<br />
<br />
Replace with:<br />
$r .= "(?:(?P&lt;login&gt;\w+):?(?P&lt;pass&gt;\w+)?@)?";<br />
<br />
This will cover the case the only username is present in the url:<br />
<br />
<a href="http://username@subdomain.domain.com/index.php?arg1=test#anchor" rel="nofollow" target="_blank">http://username@subdomain.domain.com/index.php?arg1=test#anchor</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86413""></a>
  <div class="note">
   <strong class="user">vdklah at hotmail dot com</strong>
   <a href="#86413" class="date">17-Oct-2008 11:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some example that determines the URL port. 
<br />
When port not specified, it derives it from the scheme.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">getUrlPort</span><span class="keyword">( </span><span class="default">$urlInfo </span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; if( isset(</span><span class="default">$urlInfo</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]) ) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= </span><span class="default">$urlInfo</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; } else { </span><span class="comment">// no port specified; get default port
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (isset(</span><span class="default">$urlInfo</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">]) ) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch( </span><span class="default">$urlInfo</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">] ) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'http'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= </span><span class="default">80</span><span class="keyword">; </span><span class="comment">// default for http
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'https'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= </span><span class="default">443</span><span class="keyword">; </span><span class="comment">// default for https
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'ftp'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= </span><span class="default">21</span><span class="keyword">; </span><span class="comment">// default for ftp
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'ftps'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= </span><span class="default">990</span><span class="keyword">; </span><span class="comment">// default for ftps
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="comment">// error; unsupported scheme
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$port </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="comment">// error; unknown scheme
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$port</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">$url </span><span class="keyword">= </span><span class="string">"<a href="http://nl3.php.net/manual/en/function.parse-url.php" rel="nofollow" target="_blank">http://nl3.php.net/manual/en/function.parse-url.php</a>"</span><span class="keyword">;
<br />
</span><span class="default">$urlInfo </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">( </span><span class="default">$url </span><span class="keyword">);
<br />
</span><span class="default">$urlPort </span><span class="keyword">= </span><span class="default">getUrlPort</span><span class="keyword">( </span><span class="default">$urlInfo </span><span class="keyword">);
<br />
if( </span><span class="default">$urlPort </span><span class="keyword">!== </span><span class="default">0 </span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">'Found URL port: '</span><span class="keyword">.</span><span class="default">$urlPort</span><span class="keyword">;
<br />
} else {
<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">'ERROR: Could not find port at URL: '</span><span class="keyword">.</span><span class="default">$url</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86378""></a>
  <div class="note">
   <strong class="user">gautam at rogers dot com</strong>
   <a href="#86378" class="date">15-Oct-2008 08:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
What about using something like this to safely encoding all the values that are passed in the query portion?<br />
<br />
Example input:<br />
<a href="http://www.example.com/?first=john&amp;last=smith&amp;email=john@smith.com" rel="nofollow" target="_blank">http://www.example.com/?first=john&amp;last=smith&amp;email=john@smith.com</a><br />
<br />
Result:<br />
<a href="http://www.example.com/?first=john&amp;last=smith&amp;email=john%40smith.com" rel="nofollow" target="_blank">http://www.example.com/?first=john&amp;last=smith&amp;email=john%40smith.com</a><br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">safe_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">) {<br />
&nbsp; </span><span class="comment">// Make sure we have a string to work with<br />
&nbsp; </span><span class="keyword">if(!empty(</span><span class="default">$url</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Explode into URL keys<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$urllist</span><span class="keyword">=</span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Make sure we have a valid result set and a query field<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$urllist</span><span class="keyword">) &amp;&amp; isset(</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"query"</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Explode into key/value array<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$keyvalue_list</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"&amp;"</span><span class="keyword">,(</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"query"</span><span class="keyword">]));<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Store resulting key/value pairs<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$keyvalue_result</span><span class="keyword">=array();<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$keyvalue_list </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Explode each individual key/value into an array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$keyvalue</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Make sure we have a "key=value" array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$keyvalue</span><span class="keyword">)==</span><span class="default">2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Encode the value portion<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$keyvalue</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]=</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$keyvalue</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Add our key and encoded value into the result<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$keyvalue_result</span><span class="keyword">,</span><span class="default">implode</span><span class="keyword">(</span><span class="string">"="</span><span class="keyword">,</span><span class="default">$keyvalue</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Repopulate our query key with encoded results<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"query"</span><span class="keyword">]=</span><span class="default">implode</span><span class="keyword">(</span><span class="string">"&amp;"</span><span class="keyword">,</span><span class="default">$keyvalue_result</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Build the the final output URL<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$url</span><span class="keyword">=(isset(</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"scheme"</span><span class="keyword">])?</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"scheme"</span><span class="keyword">].</span><span class="string">"://"</span><span class="keyword">:</span><span class="string">""</span><span class="keyword">).<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (isset(</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"user"</span><span class="keyword">])?</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"user"</span><span class="keyword">].</span><span class="string">":"</span><span class="keyword">:</span><span class="string">""</span><span class="keyword">).<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (isset(</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"pass"</span><span class="keyword">])?</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"pass"</span><span class="keyword">].</span><span class="string">"@"</span><span class="keyword">:</span><span class="string">""</span><span class="keyword">).<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (isset(</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"host"</span><span class="keyword">])?</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"host"</span><span class="keyword">]:</span><span class="string">""</span><span class="keyword">).<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (isset(</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"port"</span><span class="keyword">])?</span><span class="string">":"</span><span class="keyword">.</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"port"</span><span class="keyword">]:</span><span class="string">""</span><span class="keyword">).<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (isset(</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"path"</span><span class="keyword">])?</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"path"</span><span class="keyword">]:</span><span class="string">""</span><span class="keyword">).<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (isset(</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"query"</span><span class="keyword">])?</span><span class="string">"?"</span><span class="keyword">.</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"query"</span><span class="keyword">]:</span><span class="string">""</span><span class="keyword">).<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (isset(</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"fragment"</span><span class="keyword">])?</span><span class="string">"#"</span><span class="keyword">.</span><span class="default">$urllist</span><span class="keyword">[</span><span class="string">"fragment"</span><span class="keyword">]:</span><span class="string">""</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; <br />
&nbsp; return </span><span class="default">$url</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86115""></a>
  <div class="note">
   <strong class="user">FredLudd at gmail dot com</strong>
   <a href="#86115" class="date">03-Oct-2008 08:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another shot at trying to find a better parser. I noticed that the laulibrius/theoriginalmarksimpson functions didn't quite handle the URL for the page they were displayed on. For my mirror, ca3, this is<br />
&nbsp; <a href="http://ca3.php.net/manual/en/function.parse-url.php" rel="nofollow" target="_blank">http://ca3.php.net/manual/en/function.parse-url.php</a><br />
<br />
Run it through the function and it parses to<br />
&nbsp; scheme =&gt; http<br />
&nbsp; login =&gt;<br />
&nbsp; pass =&gt;<br />
&nbsp; host =&gt; ca3.php.net<br />
&nbsp; ip =&gt;<br />
&nbsp; subdomain =&gt; ca3<br />
&nbsp; domain =&gt; php.<br />
&nbsp; extension =&gt; net<br />
&nbsp; port =&gt;<br />
&nbsp; path =&gt; /manual/en/function.parse<br />
&nbsp; file =&gt; function.parse<br />
that is, the file name gets a bit mangled<br />
<br />
Rather than tweak the function's regular expression yet again, I opted to adapt a RegExp that served me well in Javascript:<br />
<br />
function j_parseUrl($url) {<br />
&nbsp; $r&nbsp; = "(?:([a-z0-9+-._]+)://)?";<br />
&nbsp; $r .= "(?:";<br />
&nbsp; $r .=&nbsp;&nbsp; "(?:((?:[a-z0-9-._~!$&amp;'()*+,;=:]|%[0-9a-f]{2})*)@)?";<br />
&nbsp; $r .=&nbsp;&nbsp; "((?:[a-z0-9-._~!$&amp;'()*+,;=]|%[0-9a-f]{2})*)";<br />
&nbsp; $r .=&nbsp;&nbsp; "(?::(\d*))?";<br />
&nbsp; $r .=&nbsp;&nbsp; "(/(?:[a-z0-9-._~!$&amp;'()*+,;=:@/]|%[0-9a-f]{2})*)?";<br />
&nbsp; $r .=&nbsp;&nbsp; "|";<br />
&nbsp; $r .=&nbsp;&nbsp; "(/?";<br />
&nbsp; $r .=&nbsp; &nbsp;&nbsp; "(?:[a-z0-9-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})+";<br />
&nbsp; $r .=&nbsp; &nbsp;&nbsp; "(?:[a-z0-9-._~!$&amp;'()*+,;=:@\/]|%[0-9a-f]{2})*";<br />
&nbsp; $r .=&nbsp; &nbsp; ")?";<br />
&nbsp; $r .= ")";<br />
&nbsp; $r .= "(?:\?((?:[a-z0-9-._~!$&amp;'()*+,;=:\/?@]|%[0-9a-f]{2})*))?";<br />
&nbsp; $r .= "(?:#((?:[a-z0-9-._~!$&amp;'()*+,;=:\/?@]|%[0-9a-f]{2})*))?";<br />
&nbsp; preg_match("`$r`i", $url, $match);<br />
&nbsp; $parts = array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "scheme"=&gt;'',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "userinfo"=&gt;'',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "authority"=&gt;'',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "host"=&gt; '',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "port"=&gt;'',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "path"=&gt;'',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "query"=&gt;'',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "fragment"=&gt;'');<br />
&nbsp; switch (count ($match)) {<br />
&nbsp;&nbsp;&nbsp; case 9: $parts['fragment'] = $match[8];<br />
&nbsp;&nbsp;&nbsp; case 8: $parts['query'] = $match[7];<br />
&nbsp;&nbsp;&nbsp; case 7: $parts['path'] =&nbsp; $match[6];<br />
&nbsp;&nbsp;&nbsp; case 6: $parts['path'] =&nbsp; $match[5] . $parts['path'];<br />
&nbsp;&nbsp;&nbsp; case 5: $parts['port'] =&nbsp; $match[4];<br />
&nbsp;&nbsp;&nbsp; case 4: $parts['host'] =&nbsp; $match[3];<br />
&nbsp;&nbsp;&nbsp; case 3: $parts['userinfo'] =&nbsp; $match[2];<br />
&nbsp;&nbsp;&nbsp; case 2: $parts['scheme'] =&nbsp; $match[1];<br />
&nbsp; }<br />
&nbsp; $parts['authority'] = ($parts['userinfo']?$parts['userinfo']."@":"").<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $parts['host'].<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ($parts['port']?":".$parts['port']:"");<br />
&nbsp; return $parts;<br />
}<br />
<br />
This function, when fed "<a href="http://ca3.php.net/manual/en/function.parse-url.php" rel="nofollow" target="_blank">http://ca3.php.net/manual/en/function.parse-url.php</a>", returns<br />
&nbsp; scheme =&gt; http<br />
&nbsp; userinfo =&gt;<br />
&nbsp; authority =&gt; ca3.php.net<br />
&nbsp; host =&gt; ca3.php.net<br />
&nbsp; port =&gt;<br />
&nbsp; path =&gt; /manual/en/function.parse-url.php<br />
&nbsp; query =&gt;<br />
&nbsp; fragment =&gt; <br />
which is somewhat closer to my needs.<br />
<br />
But everything should be tested against the two examples provided by RFC3986,<br />
<br />
&nbsp; /* line too long for this site's commnet handler */<br />
&nbsp; "foo://username:password@example.com:8042".<br />
&nbsp;&nbsp; &nbsp;&nbsp; "/over/there/index.dtb;type=animal?name=ferret#nose"<br />
and<br />
&nbsp; "urn:example:animal:ferret:nose"<br />
<br />
Here the native function parse_url() performs admirably on that "urn:" example. Mine fails to pick out the path ("example:animal:ferret:nose") and the laulibrius/theoriginalmarksimpson function can't decipher anything there. On the "foo:" example, both my function and parse_url() get it right, while the other examples on this page don't.<br />
<br />
The laulibrius/theoriginalmarksimpson function delivers<br />
&nbsp; scheme =&gt; foo<br />
&nbsp; login =&gt; username<br />
&nbsp; pass =&gt; password<br />
&nbsp; host =&gt; example.com<br />
&nbsp; ip =&gt;<br />
&nbsp; subdomain =&gt;<br />
&nbsp; domain =&gt; example.<br />
&nbsp; extension =&gt; com<br />
&nbsp; port =&gt; 8042<br />
&nbsp; path =&gt; /over/there/index.dtb<br />
&nbsp; file =&gt; index.dtb<br />
<br />
As you can see, the query string ("name=ferret") and fragment ("nose") have dropped off, as well as the parameter ("type=animal").</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86060""></a>
  <div class="note">
   <strong class="user">xellisx</strong>
   <a href="#86060" class="date">01-Oct-2008 05:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I need to parse out the query string from the referrer, so I created this function.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">parse_query</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)
<br />
&nbsp;{
<br />
&nbsp; </span><span class="comment">/** 
<br />
&nbsp;&nbsp; *&nbsp; Use this function to parse out the query array element from
<br />
&nbsp;&nbsp; *&nbsp; the output of parse_url().
<br />
&nbsp;&nbsp; */
<br />
&nbsp; </span><span class="default">$var&nbsp; </span><span class="keyword">= </span><span class="default">html_entity_decode</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$var&nbsp; </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$arr&nbsp; </span><span class="keyword">= array();
<br />

<br />
&nbsp; foreach(</span><span class="default">$var </span><span class="keyword">as </span><span class="default">$val</span><span class="keyword">)
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$x</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = </span><span class="default">$x</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];
<br />
&nbsp;&nbsp; }
<br />
&nbsp; unset(</span><span class="default">$val</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">);
<br />
&nbsp; return </span><span class="default">$arr</span><span class="keyword">;
<br />
&nbsp;}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85963""></a>
  <div class="note">
   <strong class="user">ilja at radusch dot com</strong>
   <a href="#85963" class="date">26-Sep-2008 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an update to the glue_url() function.
<br />

<br />
It can now handle relative URLs if only 'path' is provided.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">glue_url</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">]) ? </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.((</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">]) == </span><span class="string">'mailto'</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'//'</span><span class="keyword">) : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">]) ? </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">].(isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">]) ? </span><span class="string">':'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">).</span><span class="string">'@' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]) ? </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]) ? </span><span class="string">':'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">], </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) == </span><span class="string">'/'</span><span class="keyword">) ?
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] : ((!empty(</span><span class="default">$uri</span><span class="keyword">) ? </span><span class="string">'/' </span><span class="keyword">: </span><span class="string">'' </span><span class="keyword">) . </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]) ? </span><span class="string">'?'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">]) ? </span><span class="string">'#'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$uri</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85608""></a>
  <div class="note">
   <strong class="user">nospam at spellingcow dot com</strong>
   <a href="#85608" class="date">08-Sep-2008 11:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
URL's in the query string of a relative URL will cause a problem<br />
<br />
fails:<br />
/page.php?foo=bar&amp;url=<a href="http://www.example.com" rel="nofollow" target="_blank">http://www.example.com</a><br />
<br />
parses:<br />
<a href="http://www.foo.com/page.php?foo=bar&amp;url=http://www.example.com" rel="nofollow" target="_blank">http://www.foo.com/page.php?foo=bar&amp;url=http://www.example.com</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85276""></a>
  <div class="note">
   <strong class="user">marco panichi</strong>
   <a href="#85276" class="date">23-Aug-2008 10:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
my function catch the url written on the browser by the user and does the same thing of parse_url. but better, I think. I don't like parse_url because it says nothing about elements that it doesn't find in the url. my function instead return an empty string.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">get_url</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REQUEST_URI'</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// query<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">array_pad</span><span class="keyword">( </span><span class="default">explode</span><span class="keyword">( </span><span class="string">'?'</span><span class="keyword">, </span><span class="default">$uri </span><span class="keyword">), </span><span class="default">2</span><span class="keyword">, </span><span class="default">false </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] = ( </span><span class="default">$x</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] )? </span><span class="default">$x</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] : </span><span class="string">'' </span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// resource<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">array_pad</span><span class="keyword">( </span><span class="default">explode</span><span class="keyword">( </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] ), </span><span class="default">2</span><span class="keyword">, </span><span class="default">false </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x_last </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">( </span><span class="default">$x </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$x_last</span><span class="keyword">, </span><span class="string">'.' </span><span class="keyword">) === </span><span class="default">false </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'resource'</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x</span><span class="keyword">[] = </span><span class="default">$x_last</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'resource'</span><span class="keyword">] = </span><span class="default">$x_last</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// path&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] = </span><span class="default">implode</span><span class="keyword">( </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$x </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">], -</span><span class="default">1 </span><span class="keyword">) !== </span><span class="string">'/' </span><span class="keyword">) </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] .= </span><span class="string">'/'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// domain<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'domain'</span><span class="keyword">]&nbsp; &nbsp; = </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SERVER_NAME'</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// scheme<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$server_prt&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">( </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SERVER_PROTOCOL'</span><span class="keyword">] );<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">]&nbsp; &nbsp; = </span><span class="default">strtolower</span><span class="keyword">( </span><span class="default">$server_prt</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] );<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// url<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'url'</span><span class="keyword">] = </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">].</span><span class="string">'://'</span><span class="keyword">.</span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'domain'</span><span class="keyword">].</span><span class="default">$uri</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$arr</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
PS: I found working with explode is faster than using preg_match (I tryed with getmicrotime function and 'for' cycles).<br />
<br />
PPS: I used array_pad to prevent any notice.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84119""></a>
  <div class="note">
   <strong class="user">andrewtheartist at hotmail dot com</strong>
   <a href="#84119" class="date">29-Jun-2008 02:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's the easiest way to get the URL to the path that your script is in (so not the actual script name itself, just the complete URL to the folder it's in)<br />
<br />
echo "<a href="http://" rel="nofollow" target="_blank">http://</a>".$_SERVER['HTTP_HOST'].dirname($_SERVER['PHP_SELF']);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83998""></a>
  <div class="note">
   <strong class="user">Cool Coyote</strong>
   <a href="#83998" class="date">23-Jun-2008 02:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
based on the "laulibrius at hotmail dot com" function, this work for relatives url only:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parseUrl</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">) {<br />
</span><span class="default">$r </span><span class="keyword">= </span><span class="string">"^(?:(?P&lt;path&gt;[\.\w/]*/)?"</span><span class="keyword">;<br />
</span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?P&lt;file&gt;\w+(?:\.\w+)?)?)\.(?P&lt;extension&gt;\w+)?"</span><span class="keyword">;<br />
</span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:\?(?P&lt;arg&gt;[\w=&amp;]+))?"</span><span class="keyword">;<br />
</span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:#(?P&lt;anchor&gt;\w+))?"</span><span class="keyword">;<br />
</span><span class="default">$r </span><span class="keyword">= </span><span class="string">"!</span><span class="default">$r</span><span class="string">!"</span><span class="keyword">;<br />
<br />
</span><span class="default">preg_match </span><span class="keyword">( </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">, </span><span class="default">$out </span><span class="keyword">);<br />
return </span><span class="default">$out</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">parseUrl</span><span class="keyword">(</span><span class="string">"../test/f.aq.php?p=1&amp;v=blabla#X1"</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
returns:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; ../test/faq.php?p=1&amp;v=blabla#X1<br />
&nbsp;&nbsp;&nbsp; [path] =&gt; ../test/<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; ../test/<br />
&nbsp;&nbsp;&nbsp; [file] =&gt; faq<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; faq<br />
&nbsp;&nbsp;&nbsp; [extension] =&gt; php<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; php<br />
&nbsp;&nbsp;&nbsp; [arg] =&gt; p=1&amp;v=blabla<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; p=1&amp;v=blabla<br />
&nbsp;&nbsp;&nbsp; [anchor] =&gt; X1<br />
&nbsp;&nbsp;&nbsp; [5] =&gt; X1<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83875""></a>
  <div class="note">
   <strong class="user">laulibrius at hotmail dot com</strong>
   <a href="#83875" class="date">16-Jun-2008 06:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There was one thing missing in the function dropped by "to1ne at hotmail dot com" when i tried it : domain and subdomain couldn't have a dash "-". So i add it in the regexp and the function looks like this now :<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">parseUrl</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r&nbsp; </span><span class="keyword">= </span><span class="string">"^(?:(?P&lt;scheme&gt;\w+)://)?"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:(?P&lt;login&gt;\w+):(?P&lt;pass&gt;\w+)@)?"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?P&lt;host&gt;(?:(?P&lt;subdomain&gt;[-\w\.]+)\.)?" </span><span class="keyword">. </span><span class="string">"(?P&lt;domain&gt;[-\w]+\.(?P&lt;extension&gt;\w+)))"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?::(?P&lt;port&gt;\d+))?"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?P&lt;path&gt;[\w/]*/(?P&lt;file&gt;\w+(?:\.\w+)?)?)?"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:\?(?P&lt;arg&gt;[\w=&amp;]+))?"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:#(?P&lt;anchor&gt;\w+))?"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="string">"!</span><span class="default">$r</span><span class="string">!"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Delimiters<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match </span><span class="keyword">( </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">, </span><span class="default">$out </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$out</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Btw, thanks for the function, it helps me a lot.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83828""></a>
  <div class="note">
   <strong class="user">to1ne at hotmail dot com</strong>
   <a href="#83828" class="date">13-Jun-2008 08:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Based on the idea of "jbr at ya-right dot com" have I been working on a new function to parse the url:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parseUrl</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r&nbsp; </span><span class="keyword">= </span><span class="string">"^(?:(?P&lt;scheme&gt;\w+)://)?"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:(?P&lt;login&gt;\w+):(?P&lt;pass&gt;\w+)@)?"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?P&lt;host&gt;(?:(?P&lt;subdomain&gt;[\w\.]+)\.)?" </span><span class="keyword">. </span><span class="string">"(?P&lt;domain&gt;\w+\.(?P&lt;extension&gt;\w+)))"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?::(?P&lt;port&gt;\d+))?"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?P&lt;path&gt;[\w/]*/(?P&lt;file&gt;\w+(?:\.\w+)?)?)?"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:\?(?P&lt;arg&gt;[\w=&amp;]+))?"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">"(?:#(?P&lt;anchor&gt;\w+))?"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="string">"!</span><span class="default">$r</span><span class="string">!"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Delimiters<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match </span><span class="keyword">( </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">, </span><span class="default">$out </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$out</span><span class="keyword">;<br />
}<br />
</span><span class="default">print_r </span><span class="keyword">( </span><span class="default">parseUrl </span><span class="keyword">( </span><span class="string">'me:you@sub.site.org:29000/pear/validate.html?happy=me&amp;sad=you#url' </span><span class="keyword">) );<br />
</span><span class="default">?&gt;<br />
</span><br />
This returns:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; me:you@sub.site.org:29000/pear/validate.html?happy=me&amp;sad=you#url<br />
&nbsp;&nbsp;&nbsp; [scheme] =&gt; <br />
&nbsp;&nbsp;&nbsp; [1] =&gt; <br />
&nbsp;&nbsp;&nbsp; [login] =&gt; me<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; me<br />
&nbsp;&nbsp;&nbsp; [pass] =&gt; you<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; you<br />
&nbsp;&nbsp;&nbsp; [host] =&gt; sub.site.org<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; sub.site.org<br />
&nbsp;&nbsp;&nbsp; [subdomain] =&gt; sub<br />
&nbsp;&nbsp;&nbsp; [5] =&gt; sub<br />
&nbsp;&nbsp;&nbsp; [domain] =&gt; site.org<br />
&nbsp;&nbsp;&nbsp; [6] =&gt; site.org<br />
&nbsp;&nbsp;&nbsp; [extension] =&gt; org<br />
&nbsp;&nbsp;&nbsp; [7] =&gt; org<br />
&nbsp;&nbsp;&nbsp; [port] =&gt; 29000<br />
&nbsp;&nbsp;&nbsp; [8] =&gt; 29000<br />
&nbsp;&nbsp;&nbsp; [path] =&gt; /pear/validate.html<br />
&nbsp;&nbsp;&nbsp; [9] =&gt; /pear/validate.html<br />
&nbsp;&nbsp;&nbsp; [file] =&gt; validate.html<br />
&nbsp;&nbsp;&nbsp; [10] =&gt; validate.html<br />
&nbsp;&nbsp;&nbsp; [arg] =&gt; happy=me&amp;sad=you<br />
&nbsp;&nbsp;&nbsp; [11] =&gt; happy=me&amp;sad=you<br />
&nbsp;&nbsp;&nbsp; [anchor] =&gt; url<br />
&nbsp;&nbsp;&nbsp; [12] =&gt; url<br />
)<br />
<br />
So both named and numbered array keys are possible.<br />
<br />
It's quite advanced, but I think it works in any case... Let me know if it doesn't...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82948""></a>
  <div class="note">
   <strong class="user">jbr at ya-right dot com</strong>
   <a href="#82948" class="date">03-May-2008 05:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function never works the way you think it should...<br />
<br />
Example....<br />
<br />
<span class="default">&lt;?php<br />
<br />
print_r </span><span class="keyword">( </span><span class="default">parse_url </span><span class="keyword">( </span><span class="string">'me:you@sub.site.org/pear/validate.html?happy=me&amp;sad=you#url' </span><span class="keyword">) );<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Returns...<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [scheme] =&gt; me<br />
&nbsp;&nbsp;&nbsp; [path] =&gt; you@sub.site.org/pear/validate.html<br />
&nbsp;&nbsp;&nbsp; [query] =&gt; happy=me&amp;sad=you<br />
&nbsp;&nbsp;&nbsp; [fragment] =&gt; url<br />
)<br />
<br />
Here my way of doing parse_url<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">parseUrl </span><span class="keyword">( </span><span class="default">$url </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r&nbsp; </span><span class="keyword">= </span><span class="string">'!(?:(\w+)://)?(?:(\w+)\:(\w+)@)?([^/:]+)?'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">.= </span><span class="string">'(?:\:(\d*))?([^#?]+)?(?:\?([^#]+))?(?:#(.+$))?!i'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match </span><span class="keyword">( </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">, </span><span class="default">$out </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$out</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">print_r </span><span class="keyword">( </span><span class="default">parseUrl </span><span class="keyword">( </span><span class="string">'me:you@sub.site.org/pear/validate.html?happy=me&amp;sad=you#url' </span><span class="keyword">) );<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Returns...<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; me:you@sub.site.org/pear/validate.html?happy=me&amp;sad=you#url<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; <br />
&nbsp;&nbsp;&nbsp; [2] =&gt; me<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; you<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; sub.site.org<br />
&nbsp;&nbsp;&nbsp; [5] =&gt; <br />
&nbsp;&nbsp;&nbsp; [6] =&gt; /pear/validate.html<br />
&nbsp;&nbsp;&nbsp; [7] =&gt; happy=me&amp;sad=you<br />
&nbsp;&nbsp;&nbsp; [8] =&gt; url<br />
)<br />
<br />
Where as...<br />
<br />
out[0] = full url<br />
out[1] = scheme or '' if no scheme was found<br />
out[2] = username or '' if no auth username was found<br />
out[3] = password or '' if no auth password was found<br />
out[4] = domain name or '' if no domain name was found<br />
out[5] = port number or '' if no port number was found<br />
out[6] = path or '' if no path was found<br />
out[7] = query or '' if no query was found<br />
out[8] = fragment or '' if no fragment was found</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81822""></a>
  <div class="note">
   <strong class="user">Nicolas Merlet - admin(at)merletn.org</strong>
   <a href="#81822" class="date">14-Mar-2008 04:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that parse_url seems not to produce always the same results when passing non-standard urls.<br />
<br />
Eg. I was using this code since 2005 (both under PHP 4.3.10 and PHP 5.2.3) :<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp; $p </span><span class="keyword">= </span><span class="default">parse_url </span><span class="keyword">( </span><span class="string">'<a href="http://domain.tld/tcp://domain2.tld/dir/file" rel="nofollow" target="_blank">http://domain.tld/tcp://domain2.tld/dir/file</a>' </span><span class="keyword">) ;<br />
<br />
&nbsp; </span><span class="default">$d2 </span><span class="keyword">= </span><span class="default">parse_url </span><span class="keyword">( </span><span class="default">$p</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] ) ;<br />
<br />
&nbsp; echo </span><span class="default">$d2 </span><span class="keyword">;&nbsp; </span><span class="comment">// returns '/dir/file'<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Of course my example is very specific, as URL is not really correct. But using parse_url was a great trick to split URL easily (without using regular expressions).<br />
<br />
Unfortunately under PHP 5.2.0-8 (+etch10), parse_url will fail as it does not accept the slash (/) at the beginning of URL.<br />
<br />
Here is a possible patch :<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp; $p </span><span class="keyword">= </span><span class="default">parse_url </span><span class="keyword">( </span><span class="string">'<a href="http://domain.tld/tcp://domain2.tld/dir/file" rel="nofollow" target="_blank">http://domain.tld/tcp://domain2.tld/dir/file</a>' </span><span class="keyword">) ;<br />
<br />
&nbsp; </span><span class="default">$d2 </span><span class="keyword">= </span><span class="default">parse_url </span><span class="keyword">( </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$p</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] , </span><span class="default">1 </span><span class="keyword">) ) ;<br />
<br />
&nbsp; echo </span><span class="default">$d2 </span><span class="keyword">;&nbsp; </span><span class="comment">// returns '/dir/file'<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
However this last code is not optimized at all, and should be replaced by a regular expression to split URL (so that parse_url would be no longer used).<br />
<br />
So you should use parse_url very carefully, and verify that you pass only standard URLs...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77591""></a>
  <div class="note">
   <strong class="user">Nick Smith</strong>
   <a href="#77591" class="date">05-Sep-2007 11:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that older versions of PHP (e.g., 4.1) returned an blank string as the path for URLs without any path, such as <a href="http://www.php.net" rel="nofollow" target="_blank">http://www.php.net</a><br />
<br />
However more recent versions of PHP (e.g., 4.4.7) don't set the path element in the array, so old code will get a PHP warning about an undefined index.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77384""></a>
  <div class="note">
   <strong class="user">Michael Muryn</strong>
   <a href="#77384" class="date">27-Aug-2007 05:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another update to the glue_url function: applied the "isset" treatment to $parsed['pass'].<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">glue_url</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">]) ? </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.((</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">]) == </span><span class="string">'mailto'</span><span class="keyword">) ? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">'//'</span><span class="keyword">) : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">]) ? </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">].(isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">]) ? </span><span class="string">':'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">).</span><span class="string">'@' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]) ? </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]) ? </span><span class="string">':'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">], </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) == </span><span class="string">'/'</span><span class="keyword">) ? </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] : (</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]) ? </span><span class="string">'?'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">]) ? </span><span class="string">'#'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$uri</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77053""></a>
  <div class="note">
   <strong class="user">stevenlewis at hotmail dot com</strong>
   <a href="#77053" class="date">13-Aug-2007 12:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
an update to the glue url function.<br />
<br />
you are able to put a host and a path without a slash at the beginning of the path<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">glue_url</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">) <br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if (! </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">]) ? </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">].</span><span class="string">':'</span><span class="keyword">.((</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">]) == </span><span class="string">'mailto'</span><span class="keyword">) ? </span><span class="string">''</span><span class="keyword">:</span><span class="string">'//'</span><span class="keyword">): </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">]) ? </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">].(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">]? </span><span class="string">':'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">]:</span><span class="string">''</span><span class="keyword">).</span><span class="string">'@'</span><span class="keyword">:</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]) ? </span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]) ? </span><span class="string">':'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">) == </span><span class="string">'/'</span><span class="keyword">)?</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]:</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]) ? </span><span class="string">'?'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$uri </span><span class="keyword">.= isset(</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">]) ? </span><span class="string">'#'</span><span class="keyword">.</span><span class="default">$parsed</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$uri</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76979""></a>
  <div class="note">
   <strong class="user">spam at paulisageek dot com</strong>
   <a href="#76979" class="date">08-Aug-2007 09:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In reply to adrian,<br />
<br />
Thank you very much for your function. There is a small issue with your relative protocol function. You need to remove the // when making the url the path. Here is the new function.<br />
<br />
function resolve_url($base, $url) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!strlen($base)) return $url;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Step 2<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!strlen($url)) return $base;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Step 3<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (preg_match('!^[a-z]+:!i', $url)) return $url;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $base = parse_url($base);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($url{0} == "#") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Step 2 (fragment)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $base['fragment'] = substr($url, 1);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return unparse_url($base);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset($base['fragment']);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset($base['query']);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (substr($url, 0, 2) == "//") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Step 4<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return unparse_url(array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'scheme'=&gt;$base['scheme'],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'path'=&gt;substr($url,2),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else if ($url{0} == "/") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Step 5<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $base['path'] = $url;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Step 6<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $path = explode('/', $base['path']);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $url_path = explode('/', $url);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Step 6a: drop file from base<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array_pop($path);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Step 6b, 6c, 6e: append url while removing "." and ".." from<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // the directory portion<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $end = array_pop($url_path);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach ($url_path as $segment) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($segment == '.') {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // skip<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else if ($segment == '..' &amp;&amp; $path &amp;&amp; $path[sizeof($path)-1] != '..') {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array_pop($path);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $path[] = $segment;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Step 6d, 6f: remove "." and ".." from file portion<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($end == '.') {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $path[] = '';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else if ($end == '..' &amp;&amp; $path &amp;&amp; $path[sizeof($path)-1] != '..') {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $path[sizeof($path)-1] = '';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $path[] = $end;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Step 6h<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $base['path'] = join('/', $path);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Step 7<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return unparse_url($base);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76883""></a>
  <div class="note">
   <strong class="user">christian at resource-it dot dk</strong>
   <a href="#76883" class="date">03-Aug-2007 09:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I searched for an implementation of rfc3986, which is a newer version of rfc 2392. I may find it here : &lt;<a href="http://www.chrsen.dk/fundanemt/files/scripter/php/misc/rfc3986.php&gt; - read the rfc at &lt;http://rfc.net/rfc3986.html&gt;" rel="nofollow" target="_blank">http://www.chrsen.dk/fundanemt/files/scripter/php/misc/rfc3986.php&gt; - read the rfc at &lt;http://rfc.net/rfc3986.html&gt;</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76682""></a>
  <div class="note">
   <strong class="user">adrian-php at sixfingeredman dot net</strong>
   <a href="#76682" class="date">25-Jul-2007 11:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a function which implements resolving a relative URL according to RFC 2396 section 5.2. No doubt there are more efficient implementations, but this one tries to remain close to the standard for clarity. It relies on a function called "unparse_url" to implement section 7, left as an exercise for the reader (or you can substitute the "glue_url" function posted earlier).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Resolve a URL relative to a base path. This happens to work with POSIX<br />
&nbsp;* filenames as well. This is based on RFC 2396 section 5.2.<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">resolve_url</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">)) return </span><span class="default">$url</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 2<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">)) return </span><span class="default">$base</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 3<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'!^[a-z]+:!i'</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">)) return </span><span class="default">$url</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$url</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">"#"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 2 (fragment)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">] = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">unparse_url</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$base</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$base</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">) == </span><span class="string">"//"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 4<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">unparse_url</span><span class="keyword">(array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'scheme'</span><span class="keyword">=&gt;</span><span class="default">$base</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'path'</span><span class="keyword">=&gt;</span><span class="default">$url</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">$url</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">"/"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 5<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] = </span><span class="default">$url</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 6<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$base</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url_path </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 6a: drop file from base<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 6b, 6c, 6e: append url while removing "." and ".." from<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // the directory portion<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$end </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$url_path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$url_path </span><span class="keyword">as </span><span class="default">$segment</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$segment </span><span class="keyword">== </span><span class="string">'.'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// skip<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} else if (</span><span class="default">$segment </span><span class="keyword">== </span><span class="string">'..' </span><span class="keyword">&amp;&amp; </span><span class="default">$path </span><span class="keyword">&amp;&amp; </span><span class="default">$path</span><span class="keyword">[</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">] != </span><span class="string">'..'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path</span><span class="keyword">[] = </span><span class="default">$segment</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 6d, 6f: remove "." and ".." from file portion<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$end </span><span class="keyword">== </span><span class="string">'.'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path</span><span class="keyword">[] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">$end </span><span class="keyword">== </span><span class="string">'..' </span><span class="keyword">&amp;&amp; </span><span class="default">$path </span><span class="keyword">&amp;&amp; </span><span class="default">$path</span><span class="keyword">[</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">] != </span><span class="string">'..'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path</span><span class="keyword">[</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path</span><span class="keyword">[] = </span><span class="default">$end</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 6h<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">] = </span><span class="default">join</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Step 7<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">unparse_url</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75523""></a>
  <div class="note">
   <strong class="user">Elliott Brueggeman</strong>
   <a href="#75523" class="date">04-Jun-2007 12:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that if you pass this function a url without a scheme (www.php.net, as opposed to <a href="http://www.php.net" rel="nofollow" target="_blank">http://www.php.net</a>), the function will incorrectly parse the results. In my test case it returned the domain under the ['path'] element and nothing in the ['host'] element.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73883""></a>
  <div class="note">
   <strong class="user">Marc-Antoine Ross</strong>
   <a href="#73883" class="date">14-Mar-2007 05:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Do not look for the fragment in $_SERVER['QUERY_STRING'], you will not find it. You should read the fragment in JavaScript for example.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70690""></a>
  <div class="note">
   <strong class="user">alistair at 21degrees dot com dot au</strong>
   <a href="#70690" class="date">24-Oct-2006 04:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Heres a simple function to add the $component option in for PHP4. Haven't done exhaustive testing, but should work ok.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">## Defines only available in PHP 5, created for PHP4<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(!</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'PHP_URL_SCHEME'</span><span class="keyword">)) </span><span class="default">define</span><span class="keyword">(</span><span class="string">'PHP_URL_SCHEME'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'PHP_URL_HOST'</span><span class="keyword">)) </span><span class="default">define</span><span class="keyword">(</span><span class="string">'PHP_URL_HOST'</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'PHP_URL_PORT'</span><span class="keyword">)) </span><span class="default">define</span><span class="keyword">(</span><span class="string">'PHP_URL_PORT'</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'PHP_URL_USER'</span><span class="keyword">)) </span><span class="default">define</span><span class="keyword">(</span><span class="string">'PHP_URL_USER'</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'PHP_URL_PASS'</span><span class="keyword">)) </span><span class="default">define</span><span class="keyword">(</span><span class="string">'PHP_URL_PASS'</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'PHP_URL_PATH'</span><span class="keyword">)) </span><span class="default">define</span><span class="keyword">(</span><span class="string">'PHP_URL_PATH'</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'PHP_URL_QUERY'</span><span class="keyword">)) </span><span class="default">define</span><span class="keyword">(</span><span class="string">'PHP_URL_QUERY'</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'PHP_URL_FRAGMENT'</span><span class="keyword">)) </span><span class="default">define</span><span class="keyword">(</span><span class="string">'PHP_URL_FRAGMENT'</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">parse_url_compat</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$component</span><span class="keyword">=</span><span class="default">NULL</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$component</span><span class="keyword">) return </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">## PHP 5<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">phpversion</span><span class="keyword">() &gt;= </span><span class="default">5</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$component</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">## PHP 4<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bits </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch(</span><span class="default">$component</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">PHP_URL_SCHEME</span><span class="keyword">: return </span><span class="default">$bits</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">PHP_URL_HOST</span><span class="keyword">: return </span><span class="default">$bits</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">PHP_URL_PORT</span><span class="keyword">: return </span><span class="default">$bits</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">PHP_URL_USER</span><span class="keyword">: return </span><span class="default">$bits</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">PHP_URL_PASS</span><span class="keyword">: return </span><span class="default">$bits</span><span class="keyword">[</span><span class="string">'pass'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">PHP_URL_PATH</span><span class="keyword">: return </span><span class="default">$bits</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">PHP_URL_QUERY</span><span class="keyword">: return </span><span class="default">$bits</span><span class="keyword">[</span><span class="string">'query'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">PHP_URL_FRAGMENT</span><span class="keyword">: return </span><span class="default">$bits</span><span class="keyword">[</span><span class="string">'fragment'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48574""></a>
  <div class="note">
   <strong class="user">TheShadow</strong>
   <a href="#48574" class="date">30-Dec-2004 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You may want to check out the PEAR NET_URL class. It provides easy means to manipulate URL strings.<br />
<br />
<a href="http://pear.php.net/package/Net_URL" rel="nofollow" target="_blank">http://pear.php.net/package/Net_URL</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
