<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>現在のセッションに1つ以上の変数を登録する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.session-register-shutdown.html">≪ session_register_shutdown</a></li>
      <li style="float: right;"><a href="function.session-save-path.html">session_save_path ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.session.html">セッション関数</a></li>
    <li>現在のセッションに1つ以上の変数を登録する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.session-register" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">session_register</h1>
  <p class="verinfo">(PHP 4, PHP 5 &lt; 5.4.0)</p><p class="refpurpose"><span class="refname">session_register</span> &mdash; <span class="dc-title">現在のセッションに1つ以上の変数を登録する</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.session-register-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>session_register</strong></span>
    ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$name</code></span>
   [, <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$...</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>session_register()</strong></span> の引数の数は可変であり、
   各引数は変数名を保持する文字列または変数名からなる配列
   とすることが可能です。
   各変数名が処理される毎に、<span class="function"><strong>session_register()</strong></span>
   は、その変数名のグローバル変数を現在のセッションに登録します。
  </p>
  <p class="para">
   配列 <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var> または
   <var class="varname"><var class="varname">$HTTP_SESSION_VARS</var></var> (PHP &lt; 4.1.0)
   の適当なメンバに設定をするだけでもセッション変数を作成することが可能です。
   <div class="informalexample">
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;session_register()&nbsp;の使用は推奨されません。<br /></span><span style="color: #0000BB">$barney&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"A&nbsp;big&nbsp;purple&nbsp;dinosaur."</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">session_register</span><span style="color: #007700">(</span><span style="color: #DD0000">"barney"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;PHP&nbsp;4.1.0以降では$_SESSIONの使用が推奨されます。<br /></span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">"zim"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"An&nbsp;invader&nbsp;from&nbsp;another&nbsp;planet."</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;古い手法としては&nbsp;$HTTP_SESSION_VARS&nbsp;があります。<br /></span><span style="color: #0000BB">$HTTP_SESSION_VARS</span><span style="color: #007700">[</span><span style="color: #DD0000">"spongebob"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"He's&nbsp;got&nbsp;square&nbsp;pants."</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   この関数をコールする前に <span class="function"><a href="function.session-start.html" class="function">session_start()</a></span>
   をコールしていない場合、暗黙のうちに引数を付けずに
   <span class="function"><a href="function.session-start.html" class="function">session_start()</a></span> がコールされます。
   <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var> を使う場合はこの動作とは違い、
   使用前に必ず <span class="function"><a href="function.session-start.html" class="function">session_start()</a></span> をコールする必要があります。
  </p>
  <div class="warning"><strong class="warning">警告</strong><p class="simpara">この関数は PHP 5.3.0 で
<em class="emphasis">非推奨</em>となり、
PHP 5.4.0 で<em class="emphasis">削除</em>されました。</p></div>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.session-register-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">name</code></dt>

     <dd>

      <p class="para">
       変数名を含む文字列、
       あるいは変数名や配列を含む配列。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">...</code></dt>

     <dd>

      <p class="para">
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.session-register-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.session-register-notes">
  <h3 class="title">注意</h3>
  <div class="caution"><strong class="caution">警告</strong>
   <p class="para">
    <a href="ini.core.html#ini.register-globals" class="link">register_globals</a>
    を考慮することなくスクリプトを書きたい場合には、
    <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var>
    配列を代わりに使用する必要があります。
    <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var> のエントリは自動的に登録されます。
    スクリプトで <span class="function"><strong>session_register()</strong></span>
    を使用している場合には、それは
    <a href="ini.core.html#ini.register-globals" class="link">register_globals</a>
    を不可としている環境下では動作しません。
   </p>
  </div>
  <blockquote class="note"><p><strong class="note">注意</strong>: <strong>register_globals:
重要な注意</strong><br /><p class="para">PHP 4.2.0 以降、PHP ディレクティブ
<a href="ini.core.html#ini.register-globals" class="link">register_globals</a>
のデフォルト値は <em class="emphasis">off</em> となっています。
PHP コミュニティは、ユーザーがこのディレクティブの設定に依存せず、
<a href="language.variables.predefined.html" class="link">superglobals</a> のような他の手段を使用することを推奨します。
</p></p></blockquote>
  <div class="caution"><strong class="caution">警告</strong>
   <p class="para">
    この関数は、<em class="emphasis">global</em>変数を登録します。
    セッション変数を関数の内部で登録したい場合、
    <a href="language.variables.scope.html" class="link"><strong class="command">global</strong></a>
    キーワードあるいは <var class="varname"><var class="varname"><a href="reserved.variables.globals.html" class="classname">$GLOBALS[]</a></var></var>
    配列を用いてその変数をグローバルとするか、下記のように
    session 配列を使用してください。
   </p>
  </div>
  <div class="caution"><strong class="caution">警告</strong>
   <p class="para">
    <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var>
    (あるいは <var class="varname"><var class="varname">$HTTP_SESSION_VARS</var></var>) を使用する場合は
    <span class="function"><strong>session_register()</strong></span>、
    <span class="function"><a href="function.session-is-registered.html" class="function">session_is_registered()</a></span> および
    <span class="function"><a href="function.session-unregister.html" class="function">session_unregister()</a></span> を使用しないでください。
   </p>
  </div>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    セッションにリソース変数を登録することは現在できません。例えば、
    データベースへの接続を生成し、接続IDをセッション変数として登録し、
    セッションが回復された時点で、接続が有効であることを期待することはできません。
    リソースを返すPHP関数は、その関数定義に
    <em>resource</em>型の返り値を有することが示されている。
    リソースを返す関数のリストは、付録
    <a href="resource.html" class="link">リソース型の一覧</a> で見ることができます。
   </p>
   <p class="para">
    <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var> (あるいは PHP 4.0.6 以前なら
    <var class="varname"><var class="varname">$HTTP_SESSION_VARS</var></var>) を使用する場合は、値を
    <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var> に代入します。
    たとえば $_SESSION[&#039;var&#039;] = &#039;ABC&#039;; などのようにします。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.session-register-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.session-is-registered.html" class="function" rel="rdfs-seeAlso">session_is_registered()</a> - 変数がセッションに登録されているかどうかを調べる</span></li>
    <li class="member"><span class="function"><a href="function.session-unregister.html" class="function" rel="rdfs-seeAlso">session_unregister()</a> - 現在のセッションから変数の登録を削除する</span></li>
    <li class="member"><var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113099""></a>
  <div class="note">
   <strong class="user">tecnico at overant dot com</strong>
   <a href="#113099" class="date">29-Aug-2013 08:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have many websites with these functions in the source code (like me) you can include the following functions in some kind of include.php that you have:<br />
<br />
function session_register($session)<br />
{<br />
&nbsp; //<br />
}<br />
<br />
function session_unregister($session)<br />
{<br />
&nbsp; unset($_SESSION[$session]);<br />
}<br />
<br />
In this way the PHP interpreter detects the functions and do not return the error, and the maintenance work is minimized.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104663""></a>
  <div class="note">
   <strong class="user">klein at sup4u dot de</strong>
   <a href="#104663" class="date">29-Jun-2011 01:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
in addition to function set_session_vars instead of replacing all $var with $_SESSION['var'],
<br />
&nbsp;you could get all set session-vars in prevoius scripts with this function
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">get_session_vars</span><span class="keyword">() {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nb_args</span><span class="keyword">=</span><span class="default">func_num_args</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arg_list</span><span class="keyword">=</span><span class="default">func_get_args</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$nb_args</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; global $</span><span class="default">$arg_list</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$arg_list</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]];
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100206""></a>
  <div class="note">
   <strong class="user">yarco dot w at gmail dot com</strong>
   <a href="#100206" class="date">01-Oct-2010 05:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You *MUST* notice that<br />
<br />
session_register($var)<br />
<br />
*IS NOT* <br />
<br />
$_SESSION[$var] = $$var;<br />
<br />
it is <br />
<br />
if (!isset($_SESSION[$var]))<br />
&nbsp; $_SESSION[$var] = $$var;<br />
<br />
when migrating from old style code.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96241""></a>
  <div class="note">
   <strong class="user">Ezion oudpapierdoos at gmail dot com</strong>
   <a href="#96241" class="date">17-Feb-2010 03:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Below is a fix that may be included in older code to make it work with PHP6. 
<br />
When needed it recreates the functions
<br />
- session_register()
<br />
- session_is_registered()
<br />
- session_unregister()
<br />

<br />
The functions inside the function fix_session_register() are only available&nbsp; after fix_session_register() has run.
<br />
Therefore in PHP&lt;6 where there already is a session_register() nothing happens.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// Fix for removed Session functions
<br />
</span><span class="keyword">function </span><span class="default">fix_session_register</span><span class="keyword">(){
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">session_register</span><span class="keyword">(){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$args </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]=</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">session_is_registered</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">session_unregister</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'session_register'</span><span class="keyword">)) </span><span class="default">fix_session_register</span><span class="keyword">();
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />

<br />
[EDIT BY danbrown AT php DOT net: Bugfix provided by "dr3w" on 02-APR-2010: "its [sic] function_exists with an S at the end".]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94593""></a>
  <div class="note">
   <strong class="user">Scarab</strong>
   <a href="#94593" class="date">13-Nov-2009 10:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to store an&nbsp; object into the session, you have to check up that object can be serialized at all. <br />
For example, if your object contains aggregated PDO object (which can't be serialized), you will get an error and no data would be stored.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92909""></a>
  <div class="note">
   <strong class="user">rob at akrabat dot com</strong>
   <a href="#92909" class="date">14-Aug-2009 11:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you remove session_register() calls and replace with $_SESSION assignments, make sure that it wasn't being used in place of session_start(). If it was, you'll need to add a call to session_start() too, before you assign to $_SESSION.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91124""></a>
  <div class="note">
   <strong class="user">david dot demri at gmail dot com</strong>
   <a href="#91124" class="date">26-May-2009 04:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have an old code with a lot of call to the function session_register(), and you would like to make it compatible with PHP5 or PHP6, instead of rewriting all your code by replacing this function by $_SESSION['var']="val"; you could use the function set_session_vars(), that is used exactly the same way than session_register() (but there is no implicit call to session_start() ).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">set_session_vars</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nb_args</span><span class="keyword">=</span><span class="default">func_num_args</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arg_list</span><span class="keyword">=</span><span class="default">func_get_args</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$nb_args</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; global $</span><span class="default">$arg_list</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$arg_list</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]] = $</span><span class="default">$arg_list</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90991""></a>
  <div class="note">
   <strong class="user">kavih7 at yahoo dot com</strong>
   <a href="#90991" class="date">20-May-2009 01:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of you who use this function (session_register that is), even though the manual does specify that this function implicitly calls session_start(), I just wanted to reiterate that fact. It is also important to know that if you ever switch from session_register to using $_SESSION, make sure to call session_start before adding items to the $_SESSION variable, because unlike session_register, no implicit call to session_start is done.<br />
<br />
Another reason I explain this is because I ran into a problem in which you can add items to the $_SESSION variable all you want, but if session_start is not called before adding them, they will not actually be saved to the session. Using the same code, though, and replacing the $_SESSION assignments with session_register without calling session_start WILL save that info to the session.<br />
<br />
It would be nice to have PHP check for writes to the $_SESSION variable and complain with a warning if session_start hasn't been called.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66974""></a>
  <div class="note">
   <strong class="user">guideng at unlv dot nevada dot edu</strong>
   <a href="#66974" class="date">01-Jun-2006 10:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Make sure you put session_start() at the beggining of your script.<br />
<br />
My sessions kept unsetting and I finally figured out why.<br />
<br />
On my script, session_start() has to be said and uses cookies to set the session. <br />
<br />
But I was outputting html prior to calling session_start(), which prevented it from succeeding becouse it uses the header function to place the cookies.<br />
<br />
Once html has been outputed, session_start() can't use the header function to set cookies, hence session_start() fails and no session can be started.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64295""></a>
  <div class="note">
   <strong class="user">martijn at brothersinart dot net</strong>
   <a href="#64295" class="date">11-Apr-2006 11:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that if you use a "|" sign in a variable name your entire session will be cleared, so the example below will clear out all the contents of your session. <br />
<br />
<span class="default">&lt;?php<br />
session_start</span><span class="keyword">();<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"foo|bar"</span><span class="keyword">] = </span><span class="string">"foo"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
It took me quite some time finding out why my session data kept disappearing. According to this bugreport this behaviour is intended.<br />
<a href="http://bugs.php.net/bug.php?id=33786" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=33786</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47574""></a>
  <div class="note">
   <strong class="user">mikej</strong>
   <a href="#47574" class="date">21-Nov-2004 10:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've noticed that if you try to assign a value to a session variable with a numeric name, the variable will not exist in future sessions.<br />
For example, if you do something like:<br />
session_start();<br />
$_SESSION['14'] = "blah";<br />
print_r($_SESSION);<br />
<br />
It'll display:<br />
Array ( [14] =&gt; "blah" )<br />
<br />
But if on another page (with same session) you try<br />
session_start();<br />
print_r($_SESSION);<br />
<br />
$_SESSION[14] will no longer exist.<br />
<br />
Maybe everyone else already knows this, but I didn't realize it until messing around with a broken script for quite a while.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47353""></a>
  <div class="note">
   <strong class="user">baldanders</strong>
   <a href="#47353" class="date">12-Nov-2004 08:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using sessions and use session_register()&nbsp; to register objects, these objects are serialized automatically at the end of each PHP page, and are unserialized automatically on each of the following pages. This basically means that these objects can show up on any of your pages once they become part of your session.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
