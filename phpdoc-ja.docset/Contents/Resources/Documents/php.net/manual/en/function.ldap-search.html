<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>LDAP ツリーを探索する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.ldap-sasl-bind.html">≪ ldap_sasl_bind</a></li>
      <li style="float: right;"><a href="function.ldap-set-option.html">ldap_set_option ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.ldap.html">LDAP 関数</a></li>
    <li>LDAP ツリーを探索する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.ldap-search" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">ldap_search</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">ldap_search</span> &mdash; <span class="dc-title">LDAP ツリーを探索する</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.ldap-search-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>ldap_search</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$link_identifier</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$base_dn</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$filter</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$attributes</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$attrsonly</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$sizelimit</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$timelimit</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$deref</code></span>
  ]]]]] )</div>

  <p class="para rdfs-comment">
   指定したフィルタを使用し、
   スコープ <strong><code>LDAP_SCOPE_SUBTREE</code></strong>
   でディレクトリを検索します。これは、ディレクトリ全体を検索するのと同じ意味です。
  </p>
  <p class="para">
   4.0.5 以降、並列検索も可能となっています。並列検索を行うには、単一の
   ID を使うのではなく、リンク ID の配列を使用します。
   同じベース DN を使用したくない場合や全ての検索について同じフィルタを
   使用したくない場合、ベース DN の配列またはフィルタの配列を使用する
   ことが可能です。これらの配列は、リンク ID の配列と同じ大きさである
   必要があります。これは、その配列の最初が一回の検索で使用され、2 番目の
   エントリが他の検索で使用されるといったようになるからです。並列検索を
   実行する際、エラーの場合を除き、検索結果 ID の配列が返されます。
   エラーの場合は対応する検索のエントリは <strong><code>FALSE</code></strong> となります。これは
   通常返される値とよく似ていますが、検索が行われた際に結果 ID が常に
   返されます。まれに、並列検索は ID を返すにもかかわらず通常の検索は
   <strong><code>FALSE</code></strong> を返すということがあります。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.ldap-search-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">link_identifier</code></dt>

     <dd>

      <p class="para">
       <span class="function"><a href="function.ldap-connect.html" class="function">ldap_connect()</a></span> が返す LDAP リンク ID。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">base_dn</code></dt>

     <dd>

      <p class="para">
       ディレクトリのベース DN。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">filter</code></dt>

     <dd>

      <p class="para">
       検索フィルタは、LDAP ドキュメントに記述されたフォーマットの論理
       演算子を用いて、簡単なものまたは高度なものとすることができます
       (フィルタに関する詳細な情報については、
       <a href="http://www.mozilla.org/directory/csdk-docs/filter.htm" class="link external" title="Link : http://www.mozilla.org/directory/csdk-docs/filter.htm">&raquo;&nbsp;Netscape Directory SDK</a>
       を参照ください)。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">attributes</code></dt>

     <dd>

      <p class="para">
       必要な属性を、
       <em>array(&quot;mail&quot;, &quot;sn&quot;, &quot;cn&quot;)</em> のような通常の PHP 文字列配列で保持します。
       &quot;dn&quot; は要求された属性の型によらず常に返されることに注意してください。
      </p>
      <p class="para">
       このパラメータを使用すると、デフォルトの動作よりもかなり効率的になります
       (デフォルトでは、すべての属性とその値を返します)。
       したがって、これを使用することを推奨します。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">attrsonly</code></dt>

     <dd>

      <p class="para">
       属性の型のみを取得したい場合は 1 を設定します。
       属性の型および値の両方を取得したい場合は 0
       を設定します (これがデフォルトの挙動です)。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">sizelimit</code></dt>

     <dd>

      <p class="para">
       取得するエントリ数の制限を設定します。
       0 は無制限であることを表します。
      </p>
      <blockquote class="note"><p><strong class="note">注意</strong>: 
       <p class="para">
        このパラメータは、サーバー側で事前に設定されている
        sizelimit を上書きすることはできません。それ以下の値を指定することはできます。
       </p>
       <p class="para">
        ディレクトリサーバーのホストによっては、
        事前に設定された数以上のエントリを返さないようになっているものもあります。
        この場合、サーバーでは、それが結果セットのすべてではないことを通知します。
        このパラメータでエントリ数を制限した場合にも、同じことが起こります。
       </p>
      </p></blockquote>
     </dd>

    
    
     <dt>
<code class="parameter">timelimit</code></dt>

     <dd>

      <p class="para">
       検索に要する最大秒数を設定します。
       これを 0 にすると無制限であることを表します。
      </p>
      <blockquote class="note"><p><strong class="note">注意</strong>: 
       <p class="para">
        このパラメータは、サーバー側で事前に設定されている
        timelimit を上書きすることはできません。それ以下の値を指定することはできます。
       </p>
      </p></blockquote>
     </dd>

    
    
     <dt>
<code class="parameter">deref</code></dt>

     <dd>

      <p class="para">
       検索時のエイリアスの扱いについて指定します。
       以下のいずれかとなります。
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>LDAP_DEREF_NEVER</code></strong> - (デフォルト)
          エイリアスは参照されません。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>LDAP_DEREF_SEARCHING</code></strong> -
          エイリアスを参照しますが、検索のベースオブジェクト上にいるときは参照しません。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>LDAP_DEREF_FINDING</code></strong> -
          エイリアスの参照は、ベースオブジェクト上にいて検索中でない場合に行われます。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>LDAP_DEREF_ALWAYS</code></strong> - エイリアスを常に参照します。
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.ldap-search-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   検索結果 ID を返します。エラーの場合は、<strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.ldap-search-examples">
  <h3 class="title">例</h3>
  <p class="para">
   以下の例は、&quot;My Company&quot; の全員について姓または名の一部に文字列
   <var class="varname"><var class="varname">$person</var></var> を含む人の組織単位、姓、名、電子メールアドレスを取得します。
   この例は、複数の属性に関する情報についてサーバーに検索をかける論理
   フィルタを使用します。
   <div class="example" id="example-4508">
    <p><strong>例1 LDAP 検索</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;$ds&nbsp;は、ディレクトリサーバーの有効なリンク&nbsp;ID<br /><br />//&nbsp;$person&nbsp;は、人名またはその一部。例&nbsp;"Jo"<br /><br /></span><span style="color: #0000BB">$dn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"o=My&nbsp;Company,&nbsp;c=US"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$filter</span><span style="color: #007700">=</span><span style="color: #DD0000">"(|(sn=</span><span style="color: #0000BB">$person</span><span style="color: #DD0000">*)(givenname=</span><span style="color: #0000BB">$person</span><span style="color: #DD0000">*))"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$justthese&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"ou"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"sn"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"givenname"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"mail"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$sr</span><span style="color: #007700">=</span><span style="color: #0000BB">ldap_search</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$dn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$filter</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$justthese</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$info&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ldap_get_entries</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sr</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"count"</span><span style="color: #007700">].</span><span style="color: #DD0000">"&nbsp;個のエントリが返されました\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="112191""></a>
  <div class="note">
   <strong class="user">jayleno at yahoo dot com</strong>
   <a href="#112191" class="date">16-May-2013 03:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
set_time_limit</span><span class="keyword">(</span><span class="default">30</span><span class="keyword">);<br />
</span><span class="default">error_reporting</span><span class="keyword">(</span><span class="default">E_ALL</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'error_reporting'</span><span class="keyword">, </span><span class="default">E_ALL</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'display_errors'</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
<br />
</span><span class="comment">// config<br />
</span><span class="default">$ldapserver </span><span class="keyword">= </span><span class="string">'svr.domain.com'</span><span class="keyword">;<br />
</span><span class="default">$ldapuser&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">'administrator'</span><span class="keyword">;&nbsp; <br />
</span><span class="default">$ldappass&nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="string">'PASSWORD_HERE'</span><span class="keyword">;<br />
</span><span class="default">$ldaptree&nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">"OU=SBSUsers,OU=Users,OU=MyBusiness,DC=myDomain,DC=local"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// connect <br />
</span><span class="default">$ldapconn </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">(</span><span class="default">$ldapserver</span><span class="keyword">) or die(</span><span class="string">"Could not connect to LDAP server."</span><span class="keyword">);<br />
<br />
if(</span><span class="default">$ldapconn</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// binding to ldap server<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ldapbind </span><span class="keyword">= </span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">, </span><span class="default">$ldapuser</span><span class="keyword">, </span><span class="default">$ldappass</span><span class="keyword">) or die (</span><span class="string">"Error trying to bind: "</span><span class="keyword">.</span><span class="default">ldap_error</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// verify binding<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$ldapbind</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"LDAP bind successful...&lt;br /&gt;&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">,</span><span class="default">$ldaptree</span><span class="keyword">, </span><span class="string">"(cn=*)"</span><span class="keyword">) or die (</span><span class="string">"Error in search query: "</span><span class="keyword">.</span><span class="default">ldap_error</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// SHOW ALL DATA<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'&lt;h1&gt;Dump all data&lt;/h1&gt;&lt;pre&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// iterate over array and print data for each entry<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'&lt;h1&gt;Show me the users&lt;/h1&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$data</span><span class="keyword">[</span><span class="string">"count"</span><span class="keyword">]; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo "dn is: ". $data[$i]["dn"] ."&lt;br /&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"User: "</span><span class="keyword">. </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">"cn"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] .</span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">"mail"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Email: "</span><span class="keyword">. </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">"mail"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] .</span><span class="string">"&lt;br /&gt;&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Email: None&lt;br /&gt;&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// print number of entries found<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"Number of entries found: " </span><span class="keyword">. </span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"LDAP bind failed..."</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
</span><span class="comment">// all done? clean up<br />
</span><span class="default">ldap_close</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107340""></a>
  <div class="note">
   <strong class="user">Jean-Loup</strong>
   <a href="#107340" class="date">02-Feb-2012 03:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example of parallel search :<br />
<br />
<span class="default">&lt;?php<br />
$basedn</span><span class="keyword">=array(</span><span class="string">'dmdName=users,dc=foo,dc=fr'</span><span class="keyword">,</span><span class="string">'dmdName=users,dc=bar,dc=com'</span><span class="keyword">);&nbsp; </span><span class="comment">// two basedn<br />
</span><span class="default">$filter</span><span class="keyword">=</span><span class="string">'(&amp;(objectClass=inetOrgPerson)(uid=*))'</span><span class="keyword">;&nbsp; </span><span class="comment">// single filter<br />
</span><span class="default">$attributes</span><span class="keyword">=array(</span><span class="string">'dn'</span><span class="keyword">,</span><span class="string">'uid'</span><span class="keyword">,</span><span class="string">'sn'</span><span class="keyword">);<br />
<br />
</span><span class="default">$cnx </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">,</span><span class="default">389</span><span class="keyword">); </span><span class="comment">// single connection<br />
</span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$cnx</span><span class="keyword">, </span><span class="default">LDAP_OPT_PROTOCOL_VERSION</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
<br />
</span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$cnx</span><span class="keyword">,</span><span class="string">'uid=root,dc=foo,dc=fr'</span><span class="keyword">,</span><span class="string">'password'</span><span class="keyword">);&nbsp; </span><span class="comment">// authentication on two BDB<br />
</span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$cnx</span><span class="keyword">,</span><span class="string">'uid=root,dc=bar,dc=com'</span><span class="keyword">,</span><span class="string">'password'</span><span class="keyword">);<br />
<br />
</span><span class="default">$search </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(array(</span><span class="default">$cnx</span><span class="keyword">,</span><span class="default">$cnx</span><span class="keyword">),</span><span class="default">$basedn</span><span class="keyword">,</span><span class="default">$filter</span><span class="keyword">,</span><span class="default">$attributes</span><span class="keyword">);&nbsp; </span><span class="comment">// search<br />
<br />
// result<br />
</span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$cnx</span><span class="keyword">,</span><span class="default">$search</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]));<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105836""></a>
  <div class="note">
   <strong class="user">info at acpower dot biz</strong>
   <a href="#105836" class="date">19-Sep-2011 12:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm a newbie, so I hope this helps some other newbie with a head scratcher...<br />
<br />
This code returned an error of 'No Such Object':<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; $search </span><span class="keyword">= </span><span class="default">ldap_search </span><span class="keyword">(</span><span class="default">$ldapcon</span><span class="keyword">, </span><span class="string">"cn=admin,dc=acpower,dc=biz"</span><span class="keyword">, </span><span class="string">"(filters)"</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I took out the cn, and magic! it works:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; $search </span><span class="keyword">= </span><span class="default">ldap_search </span><span class="keyword">(</span><span class="default">$ldapcon</span><span class="keyword">, </span><span class="string">"dc=acpower,dc=biz"</span><span class="keyword">, </span><span class="string">"(filters)"</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105631""></a>
  <div class="note">
   <strong class="user">nick</strong>
   <a href="#105631" class="date">02-Sep-2011 08:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Results from ActiveDirectory may be ordered by objectSid.<br />
We can get all users for each page size by modify filter.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// ... connect to ldap<br />
</span><span class="default">$lastsid</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br />
while (</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$filter </span><span class="keyword">= </span><span class="string">'(objectClass=user)'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$lastsid</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$v</span><span class="keyword">)=</span><span class="default">array_values</span><span class="keyword">(</span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'V'</span><span class="keyword">,</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$lastsid</span><span class="keyword">,</span><span class="default">24</span><span class="keyword">))); </span><span class="comment">// id for user.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$lastsid</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">24</span><span class="keyword">).</span><span class="default">pack</span><span class="keyword">(</span><span class="string">'V'</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">+</span><span class="default">$v</span><span class="keyword">); </span><span class="comment">// next sid.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/../'</span><span class="keyword">,</span><span class="string">'\\\\$0'</span><span class="keyword">,</span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">)); </span><span class="comment">// escape for fiter<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filter </span><span class="keyword">= </span><span class="string">'(&amp;'</span><span class="keyword">.</span><span class="default">$filter</span><span class="keyword">.</span><span class="string">'(objectSid&gt;='</span><span class="keyword">.</span><span class="default">$s</span><span class="keyword">.</span><span class="string">'))'</span><span class="keyword">; </span><span class="comment">// fiter for next entries.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$res </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ldap</span><span class="keyword">,</span><span class="default">$basedn</span><span class="keyword">,</span><span class="default">$filter</span><span class="keyword">,array(</span><span class="string">'objectSid'</span><span class="keyword">,</span><span class="string">'cn'</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ldap</span><span class="keyword">,</span><span class="default">$res</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$ent</span><span class="keyword">=</span><span class="default">ldap_first_entry</span><span class="keyword">(</span><span class="default">$ldap</span><span class="keyword">,</span><span class="default">$res</span><span class="keyword">); </span><span class="default">$ent</span><span class="keyword">; </span><span class="default">$ent</span><span class="keyword">=</span><span class="default">ldap_next_entry</span><span class="keyword">(</span><span class="default">$ldap</span><span class="keyword">,</span><span class="default">$ent</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$lastsid</span><span class="keyword">) = </span><span class="default">ldap_get_values_len</span><span class="keyword">(</span><span class="default">$ldap</span><span class="keyword">,</span><span class="default">$ent</span><span class="keyword">,</span><span class="string">'objectSid'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103918""></a>
  <div class="note">
   <strong class="user">Arnold</strong>
   <a href="#103918" class="date">11-May-2011 10:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have been working on a script where I needed to get all the users who were member of a specific MS AD group. Because of PHP bug #42060 ( <a href="http://bugs.php.net/bug.php?id=42060 " rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=42060 </a>) I could not get all the users back who were member of the group.
<br />
After googling for a day I found an article and a patch but it required that I downloaded the source code for php 5.1.6 or 5.2.10 run the patch and than recompile the code to fix the problem. 
<br />
Problem was 
<br />
1) I am not a Linux goeroe so I was not very comfortable doing this....
<br />
2) I am running the script on a production machine with other code using PHP and did not know what the consequence would bee for that code.
<br />
3) I could not update PHP anymore because in newer versions this patch would probably not work any more.
<br />

<br />
But yesterday I saw the light and wrote some code to get around this problem, maybe other people can use it that have the same problem.
<br />

<br />
<span class="default">&lt;?PHP
<br />
$startFilter&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">"(&amp;(memberOf=" </span><span class="keyword">.</span><span class="default">$ADGroup</span><span class="keyword">. </span><span class="string">"))"</span><span class="keyword">;
<br />
</span><span class="default">$startResults&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">, </span><span class="default">$userBase</span><span class="keyword">, </span><span class="default">$startFilter</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">);
<br />
</span><span class="default">$countResult&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$startResults</span><span class="keyword">);
<br />

<br />
IF(</span><span class="default">$countResult </span><span class="keyword">== </span><span class="default">1000 </span><span class="keyword">OR </span><span class="default">$countResult </span><span class="keyword">== </span><span class="default">1500</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// loop trough the number 97-122 (ASCII number for the characters a-z)
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">For(</span><span class="default">$a</span><span class="keyword">=</span><span class="default">97</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">&lt;=</span><span class="default">122</span><span class="keyword">;</span><span class="default">$a</span><span class="keyword">++)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// translate the number to a character
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$character&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">); 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// the new search filter withs returns all users with a last name starting with $character
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filter&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">"(&amp;(sn=</span><span class="default">$character</span><span class="string">*)(memberOf=</span><span class="default">$ADGroup</span><span class="string">))"</span><span class="keyword">; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$results&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">, </span><span class="default">$userBase</span><span class="keyword">, </span><span class="default">$filter</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$countResult2&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$results</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// See if the search for all users starting with a specific character still hits the search limit
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // if so than do a new search to find all the users where the last name starts with "aa" and 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // than with "ab", "ac" etc. etc
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // In the best case we can now find 675.324 users per group when the search limit is 1000
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ((26 * 999&nbsp; for the fist character) * 26 for the second character)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // and 1.013.324 when the search limit is 1500
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">If(</span><span class="default">$countResult2 </span><span class="keyword">== </span><span class="default">1000 </span><span class="keyword">or </span><span class="default">$countResult2 </span><span class="keyword">== </span><span class="default">1500</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; For(</span><span class="default">$b</span><span class="keyword">=</span><span class="default">97</span><span class="keyword">;</span><span class="default">$b</span><span class="keyword">&lt;=</span><span class="default">122</span><span class="keyword">;</span><span class="default">$b</span><span class="keyword">++)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$character2&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filter2&nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">"(&amp;(sn=</span><span class="default">$character$character2</span><span class="string">*)(memberOf=</span><span class="default">$ADGroup</span><span class="string">))"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$results2&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">, </span><span class="default">$userBase</span><span class="keyword">, </span><span class="default">$filter2</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$count2&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$results2</span><span class="keyword">);&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$entries2&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$results2</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do your thing
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Else
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$entries&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$results</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do your thing
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
else
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$entries&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ldapconnect</span><span class="keyword">,</span><span class="default">$startResults</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// do your thing
<br />
</span><span class="keyword">}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95746""></a>
  <div class="note">
   <strong class="user">ben _at_ onshop.co.uk</strong>
   <a href="#95746" class="date">19-Jan-2010 11:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Following from my note of 11-Nov-2009 06:56 regarding DN issues when using LDAP instead of the Global Catalog when querying AD, further investigation was showing that although the results were in the packet, I was getting an error instead:<br />
<br />
'Search: Can't contact LDAP server' AKA Error 81.<br />
<br />
Using more detailed analysis:<br />
<br />
ldap_get_option($ds,LDAP_OPT_ERROR_STRING,$error);<br />
<br />
echo $error<br />
<br />
Displayed:<br />
<br />
Referral: ldap://DomainDnsZones.defg.de.bc.ac.uk/ DC=DomainDnsZonesDC=defg,DC=de,DC=abc,DC=ac,DC=uk<br />
<br />
By using trial and error, the error went away and results returned when using:<br />
<br />
ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94554""></a>
  <div class="note">
   <strong class="user">ben _at_ onshop_co_uk</strong>
   <a href="#94554" class="date">11-Nov-2009 07:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example to illustrate searching more than one DN (multiple DNs):
<br />

<br />
<span class="default">&lt;?php
<br />
$ds</span><span class="keyword">=</span><span class="default">ldap_connect</span><span class="keyword">(</span><span class="default">$ldapserver</span><span class="keyword">);
<br />

<br />
</span><span class="default">$dn</span><span class="keyword">[]=</span><span class="string">'OU=ABC,DC=xyz,DC=ac,DC=uk'</span><span class="keyword">;
<br />
</span><span class="default">$dn</span><span class="keyword">[]=</span><span class="string">'OU=DEF,DC=xyz,DC=ac,DC=uk'</span><span class="keyword">;
<br />

<br />
</span><span class="default">$id</span><span class="keyword">[] = </span><span class="default">$ds</span><span class="keyword">;
<br />
</span><span class="default">$id</span><span class="keyword">[] = </span><span class="default">$ds</span><span class="keyword">;
<br />

<br />
</span><span class="default">$filter </span><span class="keyword">= </span><span class="string">'samaccountname='</span><span class="keyword">.</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">];
<br />
&nbsp;
<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$id</span><span class="keyword">,</span><span class="default">$dn</span><span class="keyword">,</span><span class="default">$filter</span><span class="keyword">);
<br />

<br />
</span><span class="default">$search </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />

<br />
foreach (</span><span class="default">$result </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">ldap_count_entries</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$search </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />

<br />
if(</span><span class="default">$search</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ds</span><span class="keyword">, </span><span class="default">$search</span><span class="keyword">);
<br />
}else{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="string">'No results found'</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76982""></a>
  <div class="note">
   <strong class="user">chrisbloom7 at gmail dot com</strong>
   <a href="#76982" class="date">08-Aug-2007 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here are a couple of resources for proper construction of filters. <br />
<br />
<a href="http://msdn2.microsoft.com/En-US/library/aa746475.aspx" rel="nofollow" target="_blank">http://msdn2.microsoft.com/En-US/library/aa746475.aspx</a><br />
<br />
<a href="http://technet.microsoft.com/en-us/library/aa996205.aspx" rel="nofollow" target="_blank">http://technet.microsoft.com/en-us/library/aa996205.aspx</a><br />
<br />
Before finding these I had been stumped for hours on how to do something like "all users starting with "a" except those from OU 'foo'"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73693""></a>
  <div class="note">
   <strong class="user">Allie</strong>
   <a href="#73693" class="date">06-Mar-2007 11:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just posted on the ldap_bind, but I figured it couldn't hurt here since this was the first place I stopped when trying to figure out my problem.&nbsp; My error pointed to ldap_search, but specifying the ldap_connect port was the fix.<br />
<br />
When you want to search the entire directory for MS AD, you must specify port 3268 in your bind.&nbsp; This is also true for apache auth_ldap.<br />
<br />
&nbsp;$ldapserver = ldap_connect($server,3268);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61173""></a>
  <div class="note">
   
   <a href="#61173" class="date">27-Jan-2006 12:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
HOWTO list LDAP users.<br />
<br />
This CODE list one user from LDAP tree, but I' like list all user from LDAP one ou=Organization<br />
<br />
<span class="default">&lt;?php<br />
<br />
$ldaprdn </span><span class="keyword">= </span><span class="string">'cn=user,dc=domain,dc=org'</span><span class="keyword">; <br />
</span><span class="default">$ldappass </span><span class="keyword">= </span><span class="string">'password'</span><span class="keyword">;<br />
</span><span class="default">$sdn </span><span class="keyword">= </span><span class="string">'cn=user,ou=group,dc=domain,dc=org'</span><span class="keyword">;<br />
<br />
</span><span class="default">$ldapconn </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">(</span><span class="string">"ldap://localhost"</span><span class="keyword">, </span><span class="default">389</span><span class="keyword">) <br />
or die(</span><span class="string">"Not connect: </span><span class="default">$ldaphost</span><span class="string"> "</span><span class="keyword">);<br />
<br />
if (</span><span class="default">$ldapconn</span><span class="keyword">) {<br />
<br />
</span><span class="comment">// binding to ldap server<br />
</span><span class="default">$ldapbind </span><span class="keyword">= </span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">, </span><span class="default">$ldaprdn</span><span class="keyword">, </span><span class="default">$ldappass</span><span class="keyword">);<br />
<br />
</span><span class="comment">// verify binding<br />
</span><span class="keyword">if (</span><span class="default">$ldapbind</span><span class="keyword">) {<br />
</span><span class="default">$filter</span><span class="keyword">=</span><span class="string">"uid=*"</span><span class="keyword">; <br />
</span><span class="default">$justthese </span><span class="keyword">= array(</span><span class="string">"uid"</span><span class="keyword">); <br />
<br />
</span><span class="default">$sr</span><span class="keyword">=</span><span class="default">ldap_read</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">, </span><span class="default">$srdn</span><span class="keyword">, </span><span class="default">$filter</span><span class="keyword">, </span><span class="default">$justthese</span><span class="keyword">);<br />
</span><span class="default">$entry </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">, </span><span class="default">$sr</span><span class="keyword">);<br />
<br />
} else {<br />
echo </span><span class="string">"LDAP conn ok..."</span><span class="keyword">;<br />
}<br />
<br />
}<br />
<br />
</span><span class="default">ldap_close</span><span class="keyword">(</span><span class="default">$ldapconn</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span> <br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="default">$entry</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">"mail"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] . </span><span class="string">" mail adress "</span><span class="keyword">;<br />
echo </span><span class="default">$entry</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">"sn"</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] . </span><span class="string">" Name "</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56320""></a>
  <div class="note">
   <strong class="user">cruzfern at chuchuwa dot com dot ar</strong>
   <a href="#56320" class="date">30-Aug-2005 06:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The internal attributes (like createTimestamp, modifyTimestamp, etc), don't come by default (when the optional parameter attributes is not set). You have to specify it:<br />
<br />
&lt;?<br />
$r=ldap_search($ds,$base,$filter,array("createTimestamp"));<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50483""></a>
  <div class="note">
   <strong class="user">fmouse at fmp dot com</strong>
   <a href="#50483" class="date">01-Mar-2005 07:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It appears that the Netscape Directory SDK (developer.netscape.com) referenced for LDAP filter information is no longer accepting connections.&nbsp;&nbsp; The A copy of RFC 2254 which defines the standard for string representations of LDAP filters can be found&nbsp; at <a href="http://www.ietf.org/rfc/rfc2254.txt" rel="nofollow" target="_blank">http://www.ietf.org/rfc/rfc2254.txt</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49905""></a>
  <div class="note">
   <strong class="user">openldap at mail dot doris dot cc</strong>
   <a href="#49905" class="date">11-Feb-2005 04:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP 4.3.10<br />
<br />
I was trying to do an ldapsearch without a basedn.&nbsp; First, I tried with ' ', as suggested above, but it gave me invalid dn syntax error. <br />
<br />
ie: <br />
$sr=ldap_search($ds, ' ', $filter);<br />
Warning: ldap_search(): Search: Invalid DN syntax in ...<br />
<br />
Then I changed it to<br />
$sr=ldap_search($ds, "", $filter);<br />
<br />
Which gave me the following error:<br />
Warning: ldap_search(): Search: No such object in ...<br />
<br />
With that I then modified my ldap.conf file and commented out the BASE field<br />
#BASE&nbsp;&nbsp; dc=example, dc=com<br />
<br />
Then it worked!<br />
<br />
So it looks like if you supply a blank basedn, then it will use your default basedn in ldap.conf.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49889""></a>
  <div class="note">
   <strong class="user">rsu_friend at yahoo dot com</strong>
   <a href="#49889" class="date">11-Feb-2005 10:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was doing a ldap_search with<br />
$searchbasedn = "miDomainName=" . $_SESSION['selectDomain'] ."," . LDAP_DOMAINBASE;<br />
$filter = "(&amp;(mpsAccountNumber=". $acctNumber .")(objectclass=mpsAccountDetails))";&nbsp; &nbsp; <br />
$attributes = array("mpsparentchild");<br />
<br />
&nbsp;$sr = ldap_search($ldapconn, $searchbasedn, $filter,$attributes);&nbsp; <br />
<br />
For some reasone this search was failing<br />
but I was able to do successful search only when I gave the search filter as<br />
$filter = "(&amp;(mpsAccountNumber= $acctNumber )(objectclass=mpsAccountDetails))";&nbsp; &nbsp; <br />
<br />
I did not get why the ldap_search was not able to search in the first case.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45388""></a>
  <div class="note">
   <strong class="user">sema at technion dot ac dot il</strong>
   <a href="#45388" class="date">04-Sep-2004 07:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In order to perform the searches on Windows 2003 Server Active Directory you have to set the LDAP_OPT_REFERRALS option to 0:<br />
<br />
ldap_set_option($ldap, LDAP_OPT_REFERRALS, 0);<br />
<br />
Without this, you will get "Operations error" if you try to search the whole AD schema (using root of the domain as a $base_dn).<br />
<br />
As opposed to Windows 2000 Server, where this option was optional and only increased the performance.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37582""></a>
  <div class="note">
   <strong class="user">chester at the dot underground dot com dot au</strong>
   <a href="#37582" class="date">20-Nov-2003 10:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are searching active directory and are experiencing lag or time outs, it may be that you are being given ldap referrals from the ldap server. The following code will disable this.<br />
<br />
&lt;?<br />
ldap_set_option($connect, LDAP_OPT_REFERRALS, 0);<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37475""></a>
  <div class="note">
   <strong class="user">sembiance at cosmicrealms dot com</strong>
   <a href="#37475" class="date">17-Nov-2003 03:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When searching for BINARY data (such as an Active Directory objectGUID) you need to escape each hexadecimal character with a backslash.<br />
<br />
The following command line run of ldapsearch shows:<br />
ldapsearch -b "dc=blahblah,dc=com" "(objectGUID=\AE\C3\23\35\F7)"<br />
<br />
In PHP, you need to escape the escape for the backslash:<br />
ldap_search($ds,"dc=blahblah,dc=com", "(objectGUID=\\AE\\C3\\23\\35\\F7)");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37317""></a>
  <div class="note">
   <strong class="user">francis dot tyers at hp dot com</strong>
   <a href="#37317" class="date">10-Nov-2003 04:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
it seems that all fields must be used in lower case even if they are mixed case in the ldapsearch output.<br />
<br />
example:<br />
<br />
gidNumber: 1010<br />
homeDirectory: /home/dnt<br />
<br />
must be:<br />
<br />
echo "gid: " . $info[$i]["gidnumber"][0] . "&lt;br&gt;";<br />
echo "home directory: ". $info[$i]["homedirectory"][0] ."&lt;br&gt;";<br />
<br />
not ( $info[$i]["homeDirectory"][0] ) etc.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35095""></a>
  <div class="note">
   <strong class="user">nicolas at atanis dot net</strong>
   <a href="#35095" class="date">19-Aug-2003 08:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a little script that make a complete subtree search ( i know a script above seems do that but it doesnt work fine)<br />
This is my version:<br />
<br />
Voila ce que j'ai fait aujourd'hui ...<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $ldap_host = "192.168.0.50";<br />
&nbsp;&nbsp;&nbsp; $ldap_port = "389";<br />
&nbsp;&nbsp;&nbsp; $base_dn = "dc=fr";<br />
&nbsp;&nbsp;&nbsp; $filter = "(cn=*)";<br />
&nbsp;&nbsp;&nbsp; $ldap_user ="cn=admin,dc=fr";<br />
&nbsp;&nbsp;&nbsp; $ldap_pass = "hellodelu";<br />
&nbsp;&nbsp;&nbsp; $connect = ldap_connect( $ldap_host, $ldap_port);<br />
&nbsp;&nbsp;&nbsp; ldap_set_option($connect, LDAP_OPT_PROTOCOL_VERSION, 3);<br />
<br />
&nbsp;&nbsp;&nbsp; $bind = ldap_bind($connect, $ldap_user, $ldap_pass);<br />
&nbsp;&nbsp;&nbsp; $read = ldap_search($connect, $base_dn, $filter);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $info = ldap_get_entries($connect, $read); <br />
&nbsp;&nbsp;&nbsp; echo $info["count"]." entrees retournees&lt;BR&gt;&lt;BR&gt;"; <br />
&nbsp;&nbsp;&nbsp; for($ligne = 0; $ligne&lt;$info["count"]; $ligne++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for($colonne = 0; $colonne&lt;$info[$ligne]["count"]; $colonne++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $data = $info[$ligne][$colonne];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo $data.":".$info[$ligne][$data][0]."&lt;BR&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "&lt;BR&gt;";<br />
&nbsp;&nbsp;&nbsp; }<br />
ldap_close($connect);<br />
<br />
--------<br />
nicolas</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35019""></a>
  <div class="note">
   <strong class="user">me at gavinadams dot org</strong>
   <a href="#35019" class="date">15-Aug-2003 10:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Minor clarification on AD LDAP searchs. Small typo in previous example, and does not display multiple values per attribute. Here's the for loop to enumerate all entries, attributes, and values:<br />
<br />
$bind = ldap_bind($connect) // asume anon connect or add user/pass<br />
&nbsp;&nbsp; &nbsp; or exit("&gt;&gt;Could not bind to $ldap_host&lt;&lt;");<br />
$read = ldap_search($connect, $base_dn, $filter)<br />
&nbsp;&nbsp; &nbsp; or exit("&gt;&gt;Unable to search ldap server&lt;&lt;");<br />
$info = ldap_get_entries($connect, $read);<br />
echo $info["count"]." entries returned&lt;br&gt;";<br />
// $i = entries<br />
// $ii = attributes for entry<br />
// $iii = values per attribute<br />
for ($i = 0; $i&lt;$info["count"]; $i++) {<br />
&nbsp; for ($ii=0; $ii&lt;$info[$i]["count"]; $ii++){<br />
&nbsp;&nbsp; &nbsp; $data = $info[$i][$ii];<br />
&nbsp;&nbsp; &nbsp; for ($iii=0; $iii&lt;$info[$i][$data]["count"]; $iii++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo $data.":&amp;nbsp;&amp;nbsp;".$info[$i][$data][$iii]."&lt;br&gt;";<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp; }<br />
echo "&lt;p&gt;"; // separate entries</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31171""></a>
  <div class="note">
   <strong class="user">php @ fccfurn dot com</strong>
   <a href="#31171" class="date">12-Apr-2003 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To do subtree search from top DN in Active Directory, Make sure you do your ldap_set_option().<br />
<br />
<span class="default">&lt;?php<br />
$ldap_host </span><span class="keyword">= </span><span class="string">"pdc.php.net"</span><span class="keyword">;<br />
</span><span class="default">$base_dn </span><span class="keyword">= </span><span class="string">"DC=php,DC=net"</span><span class="keyword">;<br />
</span><span class="default">$filter </span><span class="keyword">= </span><span class="string">"(cn=Joe User)"</span><span class="keyword">;<br />
</span><span class="default">$ldap_user&nbsp; </span><span class="keyword">= </span><span class="string">"CN=Joe User,OU=Sales,DC=php,DC=net"</span><span class="keyword">;<br />
</span><span class="default">$ldap_pass </span><span class="keyword">= </span><span class="string">"pass"</span><span class="keyword">;<br />
</span><span class="default">$connect </span><span class="keyword">= </span><span class="default">ldap_connect</span><span class="keyword">( </span><span class="default">$ldap_host</span><span class="keyword">, </span><span class="default">$ldap_port</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; or exit(</span><span class="string">"&gt;&gt;Could not connect to LDAP server&lt;&lt;"</span><span class="keyword">);<br />
</span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">LDAP_OPT_PROTOCOL_VERSION</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
</span><span class="default">ldap_set_option</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">LDAP_OPT_REFERRALS</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">$bind </span><span class="keyword">= </span><span class="default">ldap_bind</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">$ldap_user</span><span class="keyword">, </span><span class="default">$ldap_pass</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; or exit(</span><span class="string">"&gt;&gt;Could not bind to </span><span class="default">$ldap_host</span><span class="string">&lt;&lt;"</span><span class="keyword">);<br />
</span><span class="default">$read </span><span class="keyword">= </span><span class="default">ldap_search</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">$base_dn</span><span class="keyword">, </span><span class="default">$filter</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; or exit(</span><span class="string">"&gt;&gt;Unable to search ldap server&lt;&lt;"</span><span class="keyword">);<br />
</span><span class="default">$info </span><span class="keyword">= </span><span class="default">ldap_get_entries</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">$read</span><span class="keyword">);<br />
echo </span><span class="default">$info</span><span class="keyword">[</span><span class="string">"count"</span><span class="keyword">].</span><span class="string">" entries returned&lt;p&gt;"</span><span class="keyword">;<br />
</span><span class="default">$ii</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$ii</span><span class="keyword">&lt;</span><span class="default">$info</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">"count"</span><span class="keyword">]; </span><span class="default">$ii</span><span class="keyword">++){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">$info</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$ii</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$data</span><span class="keyword">.</span><span class="string">":&amp;nbsp;&amp;nbsp;"</span><span class="keyword">.</span><span class="default">$info</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$data</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
}<br />
</span><span class="default">ldap_close</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29838""></a>
  <div class="note">
   <strong class="user">Kamil Kukura &lt;kamk at nexen dot cz&gt;</strong>
   <a href="#29838" class="date">26-Feb-2003 06:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When I tried to search with empty base DN on OpenLDAP server which had "" namingContext I got result "no such object". In the log file there was query for dn: dc=example,dc=com (!).<br />
As a workaround, it seems it's enough to feed it with space (' ') as base DN - ldap_search($ds, ' ', '(...filter...)', ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28991""></a>
  <div class="note">
   <strong class="user">neumeyed at city dot bloomington dot in dot us</strong>
   <a href="#28991" class="date">30-Jan-2003 01:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A previous comment noted: "I've also noticed that the departmentNumber, employeeNumber (and maybe others in inetorgperson.schema) are not returned from a search."<br />
<br />
This is incorrect. These attributes are returned, but you must reference them with lowercase names. That is, instead of doing this:<br />
<br />
$entries[0]["departmentNumber"][0]<br />
<br />
Do this:<br />
<br />
$entries[0]["departmentnumber"][0]<br />
<br />
This doesn't seem like "correct" behavior to me, but I don't know enough about LDAP to say for sure.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28593""></a>
  <div class="note">
   <strong class="user">nick dot veitch at futurenet dot co dot</strong>
   <a href="#28593" class="date">17-Jan-2003 05:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It might be useful to list here the operators that work:<br />
<br />
=&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; - matches exact value<br />
=*xxx&nbsp; - matches values ending xxx<br />
=xxx*&nbsp; - matches values beginning xxx<br />
=*xxx* - matches values containing xxx<br />
=*&nbsp; &nbsp; &nbsp;&nbsp; - matches all values (if set - NULLS are not returned)<br />
<br />
&gt;=xxx&nbsp; - matches everthing from xxx to end of directory<br />
&lt;=xxx&nbsp; - matches everything up to xxx in directory<br />
<br />
~=xxx&nbsp; &nbsp; &nbsp; - matches similar entries (not all systems)<br />
<br />
Boolean operators for constructing complex search<br />
<br />
&amp;(term1)(term2)&nbsp; - matches term1 AND term2<br />
| (term1)(term2)&nbsp; - matches term1 OR term2<br />
!(term1)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; - matches NOT term1<br />
&amp;(|(term1)(term2))(!(&amp;(term1)(term2)) - matches XOR term1 term2<br />
<br />
some of the more compelx constructions seem to work with varying&nbsp; degrees of efficiency - sometimes it can be better to filter some of the results with the search and do further filtering in PHP.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25629""></a>
  <div class="note">
   <strong class="user">emrecio at netscape dot net</strong>
   <a href="#25629" class="date">01-Oct-2002 05:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
implode(", ",$uentry[0]["rfc822mailalias"]);<br />
<br />
doesn't work as expected because "count" is in there... one /must/ use the 'for' loop to cycle through results (discarding "count" element).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25050""></a>
  <div class="note">
   <strong class="user">jpdalbec at ysu dot edu</strong>
   <a href="#25050" class="date">09-Sep-2002 04:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've found that spaces need to be escaped in search filters ("\20"), at least using the Red Hat PHP 4.1.2 package.&nbsp; Otherwise no results are returned.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22728""></a>
  <div class="note">
   <strong class="user">john_taylor_1973 at yahoo dot com</strong>
   <a href="#22728" class="date">27-Jun-2002 11:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Try to use ldap_list(), if possible.&nbsp; It is much faster.&nbsp; ldap_search searches a scope of LDAP_SCOPE_SUBTREE, but ldap_list searches a scope of just LDAP_SCOPE_ONELEVEL.&nbsp; This made a big difference on Novell eDirectory 8.6.1, even for a query that only returned 130 objects.&nbsp; Using an attribute list, the 4th function parameter (of either function), also made queries faster.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15215""></a>
  <div class="note">
   
   <a href="#15215" class="date">01-Sep-2001 04:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I used the following to retrieve all entries from an ILS (Netmeeting) Server:&lt;p&gt;&nbsp; &nbsp; $sr=ldap_search($ds, "objectclass=rtperson","(&amp;(cn=%)(objectclass=rtperson))");
<br />
&lt;p&gt;Have fun!
<br />
&lt;p&gt;Kees</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="10421""></a>
  <div class="note">
   <strong class="user">cdaveb at csua dot berkeley dot edu</strong>
   <a href="#10421" class="date">03-Jan-2001 02:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
FYI, for those doing LDAP searches on Exchange servers, there seems to be some preference in Exchange to disallow searches that aren't initial searches (i.e. only x* will work, not * or *x). I'd been going nuts trying to figure out why I kept getting errors doing * searches.
<br />

<br />
More info at:
<br />
<a href="http://www.microsoft.com/Exchange/en/55/help/documents/server/XOG16007.HTM" rel="nofollow" target="_blank">http://www.microsoft.com/Exchange/en/55/help/documents/server/XOG16007.HTM</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="2376""></a>
  <div class="note">
   <strong class="user">aa529 at nospamchebucto dot ns dot ca</strong>
   <a href="#2376" class="date">22-Nov-1999 10:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful of special characters when generating filters from user input.
<br />

<br />
*, (, ), \ and NUL should be backslash-escaped. See section 4 of RFC 2254 (I found it here:
<br />
<a href="http://www.cis.ohio-state.edu/htbin/rfc/rfc2254.html" rel="nofollow" target="_blank">http://www.cis.ohio-state.edu/htbin/rfc/rfc2254.html</a>)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
