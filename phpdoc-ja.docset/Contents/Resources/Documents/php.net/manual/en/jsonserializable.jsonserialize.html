<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>JSON にシリアライズしたいデータを指定する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="class.jsonserializable.html">≪ JsonSerializable</a></li>
      <li style="float: right;"><a href="ref.json.html">JSON 関数 ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.jsonserializable.html">JsonSerializable</a></li>
    <li>JSON にシリアライズしたいデータを指定する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="jsonserializable.jsonserialize" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">JsonSerializable::jsonSerialize</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.4.0)</p><p class="refpurpose"><span class="refname">JsonSerializable::jsonSerialize</span> &mdash; <span class="dc-title">JSON にシリアライズしたいデータを指定する</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-jsonserializable.jsonserialize-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">abstract</span> <span class="modifier">public</span> <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <span class="methodname"><strong>JsonSerializable::jsonSerialize</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="para rdfs-comment">
   オブジェクトをシリアライズして、
   <span class="function"><a href="function.json-encode.html" class="function">json_encode()</a></span> がネイティブにシリアライズできる値にします。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-jsonserializable.jsonserialize-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">この関数にはパラメータはありません。</p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-jsonserializable.jsonserialize-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   <span class="function"><a href="function.json-encode.html" class="function">json_encode()</a></span> でシリアライズするデータを返します。
   <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span> 型以外の任意の型になります。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-jsonserializable.jsonserialize-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-3873">
    <p><strong>例1 
     <span class="methodname"><strong>JsonSerializable::jsonSerialize()</strong></span> で配列を返す例
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">ArrayValue&nbsp;</span><span style="color: #007700">implements&nbsp;</span><span style="color: #0000BB">JsonSerializable&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(array&nbsp;</span><span style="color: #0000BB">$array</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$array</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">jsonSerialize</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">array</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$array&nbsp;</span><span style="color: #007700">=&nbsp;[</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">];<br />echo&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(new&nbsp;</span><span style="color: #0000BB">ArrayValue</span><span style="color: #007700">(</span><span style="color: #0000BB">$array</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">JSON_PRETTY_PRINT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
[
    1,
    2,
    3
]
</pre></div>
    </div>
   </div>
   <div class="example" id="example-3874">
    <p><strong>例2 
     <span class="methodname"><strong>JsonSerializable::jsonSerialize()</strong></span> で連想配列を返す例
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">ArrayValue&nbsp;</span><span style="color: #007700">implements&nbsp;</span><span style="color: #0000BB">JsonSerializable&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(array&nbsp;</span><span style="color: #0000BB">$array</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$array</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">jsonSerialize</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">array</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$array&nbsp;</span><span style="color: #007700">=&nbsp;[</span><span style="color: #DD0000">'foo'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'bar'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'quux'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'baz'</span><span style="color: #007700">];<br />echo&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(new&nbsp;</span><span style="color: #0000BB">ArrayValue</span><span style="color: #007700">(</span><span style="color: #0000BB">$array</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">JSON_PRETTY_PRINT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
{
    &quot;foo&quot;: &quot;bar&quot;,
    &quot;quux&quot;: &quot;baz&quot;
}
</pre></div>
    </div>
   </div>
   <div class="example" id="example-3875">
    <p><strong>例3 
     <span class="methodname"><strong>JsonSerializable::jsonSerialize()</strong></span> で整数値を返す例
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">IntegerValue&nbsp;</span><span style="color: #007700">implements&nbsp;</span><span style="color: #0000BB">JsonSerializable&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$number</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">number&nbsp;</span><span style="color: #007700">=&nbsp;(integer)&nbsp;</span><span style="color: #0000BB">$number</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">jsonSerialize</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">number</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />echo&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(new&nbsp;</span><span style="color: #0000BB">IntegerValue</span><span style="color: #007700">(</span><span style="color: #0000BB">1</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">JSON_PRETTY_PRINT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
1
</pre></div>
    </div>
   </div>
   <div class="example" id="example-3876">
    <p><strong>例4 
     <span class="methodname"><strong>JsonSerializable::jsonSerialize()</strong></span> で文字列を返す例
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">StringValue&nbsp;</span><span style="color: #007700">implements&nbsp;</span><span style="color: #0000BB">JsonSerializable&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$string</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">string&nbsp;</span><span style="color: #007700">=&nbsp;(string)&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">jsonSerialize</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">string</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />echo&nbsp;</span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(new&nbsp;</span><span style="color: #0000BB">StringValue</span><span style="color: #007700">(</span><span style="color: #DD0000">'Hello!'</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">JSON_PRETTY_PRINT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
&quot;Hello!&quot;
</pre></div>
    </div>
   </div>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115249""></a>
  <div class="note">
   <strong class="user">dimstefan83 at gmail dot com</strong>
   <a href="#115249" class="date">20-Jun-2014 05:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
simple functions to make life easier.<br />
I wanted a way to have a as property value the return value of a method in order to have it initialized. example<br />
<br />
class portItem implements JsonSerializable{<br />
&nbsp;&nbsp;&nbsp; private $idPort;<br />
&nbsp;&nbsp;&nbsp; private $location;<br />
&nbsp;&nbsp;&nbsp; private $portLanguages;<br />
<br />
&nbsp;&nbsp;&nbsp; public function getLocation() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!isset($this-&gt;location)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return new locationItem();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $this-&gt;location;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function setLocation($location) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;location = $location;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; public function setidPort($idPort){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;idPort=$idPort;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function getidPort(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!isset($this-&gt;idPort)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return intval($this-&gt;idPort);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; public function setPortLanguages($portLanguages){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;portLanguages=$portLanguages;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function getPortLanguages(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!isset($this-&gt;portLanguages)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return new genericItems();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $this-&gt;portLanguages;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function getCategoryLanguages(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!isset($this-&gt;portLanguages)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return new genericItems();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $this-&gt;portLanguages;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function getPortLanguageAtIndex($index=false){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!$index){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $index=0;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $this-&gt;portLanguages[$index];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function setPortLanguageAtIndex($index,$language){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;portLanguages[$index]=$language;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function jsonSerialize() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $dataConverter = new dataConverter();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $dataConverter-&gt;convertToJson($this);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
Wit 2 ways you can automatically convert for json.<br />
1.by reading properties<br />
public function convertToJson($object){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; /*approch by using object properties*/<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $class = get_class($this);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $json = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $properties = get_class_vars($class);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $keys = array_keys($properties);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $plength = count($keys);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for($i=0;$i&lt;$plength;$i++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $method =&nbsp; "get".$keys[$i];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(method_exists ($this,$method)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $json[$keys[$i]] = $this-&gt;$method();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
return $json;<br />
}<br />
<br />
public function convertToJson($object){&nbsp; &nbsp;&nbsp; <br />
/*approch by using object methods*/<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $class = get_class($object);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $json = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $methods = get_class_methods($class);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $plength = count($methods);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $json = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for($i=0;$i&lt;$plength;$i++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(stripos($methods[$i], "get")!==FALSE){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $property = mb_substr($methods[$i], 3,mb_strlen($methods[$i],'UTF-8'),'UTF-8');<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $setter = "set".mb_substr($methods[$i], 3,mb_strlen($methods[$i],'UTF-8'),'UTF-8');<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(method_exists($object,$setter)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $json[$property] = $object-&gt;$methods[$i]();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $json;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
By using this method the result will be a json with value for properties initialized according to each method. <br />
<br />
Things to note<br />
1.if you are using the reading properties approach the code cant' work outside of the class for private properties, because they are nto visible, you have to put it the code directly to public function jsonSerialize() {} in order to work.<br />
2.For both approaches has method seems not to be case sensitive else you are going to have problems, i strongly suggest to pay attention in naming convention between property names and method names idPort =&gt;setIdPort() =&gt;getIdPort() (i know my class is done not that way).<br />
3.both approaches since you call method without knowing the arguments you need to pay attention in arguments for getter methods where applicable, check my example <br />
public function getPortLanguageAtIndex($index=false){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!$index){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $index=0;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $this-&gt;portLanguages[$index];<br />
&nbsp;&nbsp;&nbsp; }<br />
that's why i have set it to optional argument. If you don't do that php will complain about missing argument parameter in method XXX.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114688""></a>
  <div class="note">
   <strong class="user">simonsimcity at gmail dot com</strong>
   <a href="#114688" class="date">22-Mar-2014 08:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can't throw exceptions in here. If you do, you'll get an exception with the message "Failed calling FooClass::jsonSerialize()" and the stacktrace will start at where you called the json_encode() method.<br />
<br />
Here's a code-example:<br />
<br />
class Foo implements JsonSerializable {<br />
&nbsp;&nbsp;&nbsp; private $triggerError = true;<br />
<br />
&nbsp;&nbsp;&nbsp; public function jsonSerialize()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($this-&gt;triggerError) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new RuntimeException("It failed!");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (array)$this;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
// Will throw an exception like new Exception("Failed calling Foo::jsonSerialize()")<br />
json_encode(new Foo());</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111263""></a>
  <div class="note">
   <strong class="user">benkuhl at gmail dot com</strong>
   <a href="#111263" class="date">01-Feb-2013 01:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A good example on when you would use functionality like this is when working with objects.<br />
<br />
json_encode() will take a DateTime and convert it to:<br />
<br />
{<br />
&nbsp;&nbsp;&nbsp; "date":"2013-01-31 11:14:05",<br />
&nbsp;&nbsp;&nbsp; "timezone_type":3,<br />
&nbsp;&nbsp;&nbsp; "timezone":"America\/Los_Angeles"<br />
}<br />
<br />
This is great when working with PHP, but if the Date is being read by Java.&nbsp; The Java date parser doesn't know what to do with that.&nbsp; But it does know what to do with the ISO8601 format...<br />
<br />
<span class="default">&lt;?php<br />
<br />
date_default_timezone_set</span><span class="keyword">(</span><span class="string">'America/Los_Angeles'</span><span class="keyword">);<br />
<br />
class </span><span class="default">Fruit </span><span class="keyword">implements </span><span class="default">JsonSerializable </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="string">'Apple'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastEaten </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">lastEaten </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">jsonSerialize</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return [<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'type' </span><span class="keyword">=&gt; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">type</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'lastEaten' </span><span class="keyword">=&gt; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">lastEaten</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="default">DateTime</span><span class="keyword">::</span><span class="default">ISO8601</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ];<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
echo </span><span class="default">json_encode</span><span class="keyword">(new </span><span class="default">Fruit</span><span class="keyword">()); </span><span class="comment">//which outputs: {"type":"Apple","lastEaten":"2013-01-31T11:17:07-0500"}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
