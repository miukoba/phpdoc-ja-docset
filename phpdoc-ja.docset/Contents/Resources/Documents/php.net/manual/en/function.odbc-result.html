<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>結果データを得る</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.odbc-result-all.html">≪ odbc_result_all</a></li>
      <li style="float: right;"><a href="function.odbc-rollback.html">odbc_rollback ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.uodbc.html">ODBC 関数</a></li>
    <li>結果データを得る</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.odbc-result" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">odbc_result</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">odbc_result</span> &mdash; <span class="dc-title">結果データを得る</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.odbc-result-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <span class="methodname"><strong>odbc_result</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result_id</code></span>
   , <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$field</code></span>
   )</div>

  <p class="para rdfs-comment">
   結果データを取得します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.odbc-result-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">result_id</code></dt>

     <dd>

      <p class="para">
       ODBC リソース。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">field</code></dt>

     <dd>

      <p class="para">
       取得するフィールド。
       カラム番号を表す整数またはフィールド名を表す文字列のどちらを指定できます。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.odbc-result-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   フィールドの内容を表す文字列を返します。エラー時には <strong><code>FALSE</code></strong>、NULL
   データの場合は <strong><code>NULL</code></strong>、そしてバイナリデータの場合は <strong><code>TRUE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.odbc-result-examples">
  <h3 class="title">例</h3>
  <p class="para">
   最初の <span class="function"><strong>odbc_result()</strong></span> コールにより、クエリー結果の
   現在のレコードにおける 3 番目のフィールドの値が返されます。
   2 番目の <span class="function"><strong>odbc_result()</strong></span> コールにより、クエリーの
   結果の現在のレコードにおける &quot;val&quot; というフィールド名のフィールドの
   値を返します。あるフィールドのカラム番号パラメータが 1 より小さいか
   現在のレコードのカラム(またはフィールド)の数を超える場合、
   エラーを生じます。同様に、クエリーを行ったテーブルのフィールド名には
   ない名前をフィールドとして指定した場合にもエラーを生じます。
  </p>
  <p class="para">
   <div class="example" id="example-942">
    <p><strong>例1 <span class="function"><strong>odbc_result()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$item_3&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">odbc_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$Query_ID</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$item_val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">odbc_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$Query_ID</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"val"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.odbc-result-notes">
  <h3 class="title">注意</h3>
  <p class="para">
   フィールドインデックスは 1 から始まります。
   バイナリまたはロングカラムデータの返し方に関しては、
   <span class="function"><a href="function.odbc-binmode.html" class="function">odbc_binmode()</a></span> および 
   <span class="function"><a href="function.odbc-longreadlen.html" class="function">odbc_longreadlen()</a></span> を参照ください。
   
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="108330""></a>
  <div class="note">
   <strong class="user">cgray at develop4 dot us</strong>
   <a href="#108330" class="date">18-Apr-2012 06:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
FYI: odbc_result contains the following values: TABLE_QUALIFIER&nbsp; &nbsp; TABLE_OWNER&nbsp; &nbsp; TABLE_NAME&nbsp; &nbsp; COLUMN_NAME&nbsp; &nbsp; DATA_TYPE&nbsp; &nbsp; TYPE_NAME&nbsp; &nbsp; PRECISION&nbsp; &nbsp; LENGTH&nbsp; &nbsp; SCALE&nbsp; &nbsp; RADIX&nbsp; &nbsp; NULLABLE&nbsp; &nbsp; REMARKS&nbsp; &nbsp; COLUMN_FLAGS<br />
<br />
I wrote the following to dump these values onto the page. I needed this to determine if the data-type for a column was something specific (eg: blob) to show a different result, instead of the actual contents. <br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $connection_string = 'OPTIM_BLOB';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $user = '';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $pass = '';&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!($connect = odbc_pconnect($connection_string, $user, $pass))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo 'Connecting to DSN, loading tables&lt;br /&gt;&lt;br /&gt;';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result = odbc_tables($myconn);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tables = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (odbc_fetch_row($result)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(odbc_result($result,"TABLE_TYPE")=="TABLE") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $TableName = odbc_result($result,"TABLE_NAME");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '&lt;span id="tableName"&gt;Table: '.$TableName.'&lt;/span&gt; ....&lt;br /&gt;&lt;br /&gt; ';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //--------- Show Columns in that table ---------------<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result2 = odbc_columns($myconn, '', "%", $TableName, "%");&nbsp; //db connection, DB name, schema, table name, column_name);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(odbc_fetch_row($result2)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //TABLE_QUALIFIER&nbsp; &nbsp; TABLE_OWNER&nbsp; &nbsp; TABLE_NAME&nbsp; &nbsp; COLUMN_NAME&nbsp; &nbsp; DATA_TYPE&nbsp; &nbsp; TYPE_NAME&nbsp; &nbsp; PRECISION&nbsp; &nbsp; LENGTH&nbsp; &nbsp; SCALE&nbsp; &nbsp; RADIX&nbsp; &nbsp; NULLABLE&nbsp; &nbsp; REMARKS&nbsp; &nbsp; COLUMN_FLAGS<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $COLUMN_NAME = odbc_result($result2, 4); // COLUMN_NAME<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $DataType = odbc_result($result2, 6);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '&lt;b&gt;Column name: '.$COLUMN_NAME.'&lt;/b&gt; Type: '.$DataType.'&lt;br /&gt;&lt;br /&gt;';<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // everything<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '1: '.odbc_result($result2, 1).'&lt;br /&gt;';&nbsp; &nbsp; // TABLE_QUALIFIER<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '2: '.odbc_result($result2, 2).'&lt;br /&gt;';&nbsp; &nbsp; // TABLE_OWNER<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '3: '.odbc_result($result2, 3).'&lt;br /&gt;';&nbsp; &nbsp; // TABLE_NAME<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '4: '.odbc_result($result2, 4).'&lt;br /&gt;';&nbsp; &nbsp; // COLUMN_NAME<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '5: '.odbc_result($result2, 5).'&lt;br /&gt;';&nbsp; &nbsp; // DATA_TYPE (Number)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '6: '.odbc_result($result2, 6).'&lt;br /&gt;';&nbsp; &nbsp; // TYPE_NAME (String)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '7: '.odbc_result($result2, 7).'&lt;br /&gt;';&nbsp; &nbsp; // PRECISION<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '8: '.odbc_result($result2, 8).'&lt;br /&gt;';&nbsp; &nbsp; // LENGTH<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '9: '.odbc_result($result2, 9).'&lt;br /&gt;';&nbsp; &nbsp; // SCALE<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '10: '.odbc_result($result2, 10).'&lt;br /&gt;';&nbsp; &nbsp; // RADIX<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '11: '.odbc_result($result2, 11).'&lt;br /&gt;';&nbsp; &nbsp; // NULLABLE<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '12: '.odbc_result($result2, 12).'&lt;br /&gt;';&nbsp; &nbsp; // REMARKS<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '13: '.odbc_result($result2, 13).'&lt;br /&gt;';&nbsp; &nbsp; // COLUMN_FLAGS<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '&lt;br /&gt;&lt;br /&gt;';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94364""></a>
  <div class="note">
   <strong class="user">lucas at bizzfone dot nl</strong>
   <a href="#94364" class="date">30-Oct-2009 12:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The odbc_result() function has an apparently little known feature that comes in very handy when retrieving large text or binary fields.<br />
Consider this code snippet to retrieve a large value into a temporary file (error testing left out for clarity):<br />
<br />
<span class="default">&lt;?php<br />
$con</span><span class="keyword">=</span><span class="default">odbc_connect</span><span class="keyword">(...);<br />
</span><span class="default">$query</span><span class="keyword">=</span><span class="string">"set textsize 2147483647 "</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="string">"select someLargeField from ..."</span><span class="keyword">;<br />
</span><span class="default">$resultset</span><span class="keyword">=</span><span class="default">odbc_exec</span><span class="keyword">(</span><span class="default">$con</span><span class="keyword">,</span><span class="default">$query</span><span class="keyword">);<br />
</span><span class="default">odbc_binmode</span><span class="keyword">(</span><span class="default">$resultset</span><span class="keyword">,</span><span class="default">ODBC_BINMODE_RETURN</span><span class="keyword">);<br />
</span><span class="default">odbc_longreadlen</span><span class="keyword">(</span><span class="default">$resultset</span><span class="keyword">,</span><span class="default">4096</span><span class="keyword">);<br />
while (</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$resultset</span><span class="keyword">)) {<br />
&nbsp;&nbsp; </span><span class="default">$fileHandle</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/tmp/myfile'</span><span class="keyword">,</span><span class="string">'wb'</span><span class="keyword">);<br />
&nbsp;&nbsp; while ((</span><span class="default">$chunk</span><span class="keyword">=</span><span class="default">odbc_result</span><span class="keyword">(</span><span class="default">$resultset</span><span class="keyword">,</span><span class="string">'someLargeField'</span><span class="keyword">))!==</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fileHandle</span><span class="keyword">,</span><span class="default">$chunk</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fileHandle</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="comment">//do something with the file<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
There are a few key points to make it work:<br />
- Make sure to include "set textsize 2147483647 " in your query.<br />
&nbsp; Without it, MSSQL truncates large values to 4096 bytes by default.<br />
&nbsp; Other databases may have a similar small limit.<br />
- The odbc_binmode() and odbc_longreadlen() calls are just for safety.<br />
&nbsp; Their defaults in php.ini are usually correct.<br />
- Each odbc_result() call on a large field apparently returns the next chunk.<br />
&nbsp; Of course you have to read all chunks before the next odbc_fetch_row() call.<br />
- When all of the large value has been read, odbc_result() will return false.<br />
<br />
Note: Using mssql_ instead of odbc_ functions is not a viable alternative. They don't work with chunks (AFAIK) and even crash php (overflow, segmentation fault) when the query result contains a large value.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51039""></a>
  <div class="note">
   <strong class="user">baoshenyi at hotmail dot com</strong>
   <a href="#51039" class="date">17-Mar-2005 07:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use one store procedure to retrieve value of identifier, other, name, section,data and datecreated coulmns to variable from SQL server table <br />
<br />
using $odbc_result = odbc_exec($connect,$query); function.<br />
<br />
After that, I using following code,<br />
for($f=1;$f&lt;=odbc_num_fields($odbc_result);$f++) {echo "&lt;td style=\"font-weight:bold\"&gt;$f ".odbc_field_name($odbc_result,$f)."&lt;/td&gt;";}<br />
echo "&lt;/tr&gt;&lt;/table&gt;";<br />
odbc_fetch_row($odbc_result);<br />
echo odbc_result($odbc_result,1)."&lt;br&gt;";<br />
echo odbc_result($odbc_result,2)."&lt;br&gt;";<br />
echo odbc_result($odbc_result,3)."&lt;br&gt;";<br />
echo odbc_result($odbc_result,4)."&lt;br&gt;";<br />
echo odbc_result($odbc_result,5)."&lt;br&gt;";<br />
echo odbc_result($odbc_result,6)."&lt;br&gt;";<br />
<br />
The result is as following,<br />
1 identifier 2 other 3 name 4 section 5 data 6 datecreated <br />
id1<br />
other2<br />
name3<br />
section4<br />
Warning: odbc_result() [function.odbc-result]: SQL error: [Microsoft][ODBC SQL Server Driver]Invalid Descriptor Index, SQL state S1002 in SQLGetData in d:\lawdepot_test\contracts\common\LicensingSQL.php on line 630<br />
2005-03-16 18:12:00<br />
<br />
I can not get "data"(Text column) back. Firstly, I think "data" column is too long for odbc_result($odbc_result,5) function, but after I check my old colde, I found I can get the "data" back using same function odbc_result().<br />
<br />
I would like to hear any suggestions from you. Depressed on this question.<br />
<br />
Michael</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31746""></a>
  <div class="note">
   <strong class="user">vlad dot posea at mymail dot ro</strong>
   <a href="#31746" class="date">02-May-2003 01:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i use odbc and mysql and i noticed after losing a lot of time that if you write something like this:<br />
echo odbc_result($result,1); <br />
....<br />
echo odbc_result($result,1);<br />
the second echo will fail. so it's more useful to save the result of odbc_result in a variable and use it later<br />
like that: $var=odbc_result($result,1);<br />
i hope this will be useful!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28722""></a>
  <div class="note">
   
   <a href="#28722" class="date">22-Jan-2003 03:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
From <a href="http://www.php.net/manual/en/function.odbc-longreadlen.php but relevant here, also. " rel="nofollow" target="_blank">http://www.php.net/manual/en/function.odbc-longreadlen.php but relevant here, also. </a><br />
<br />
An alternative is to adjust your php.ini file and set:<br />
odbc.defaultlrl=65536<br />
Or something else sufficiently large.<br />
lrl = long read length<br />
<br />
to get around the limit on returned chars.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28678""></a>
  <div class="note">
   <strong class="user">fate at doityourself dot com</strong>
   <a href="#28678" class="date">20-Jan-2003 06:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you want to quickly change a website from odbc- to mysql-data-access, you could use a simple function like this one:<br />
function myresult ($cur,$nr) { <br />
&nbsp;&nbsp; return mysql_result($cur,0,mysql_field_name($cur,$nr-1)); <br />
}<br />
and just do a global replace from "odbc_result" to "myresult".<br />
<br />
beware, you should only use this if you don't care too much about performance, as this will start a query for every field you request - the better way is of course using mysql_fetch_row!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="23299""></a>
  <div class="note">
   <strong class="user">murat at nospam dot robcol dot k12 dot tr</strong>
   <a href="#23299" class="date">15-Jul-2002 11:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When trying to get a date/time field from an Access database, odbc_result returns the date as text (e.g. 1998-07-11 21:12:23). You may use strtotime function to convert this into a format which can be used with PHP.<br />
<br />
e.g.<br />
echo "The date is "<br />
&nbsp;.date("r",strtotime(odbc_result($myquery,"mydate")));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="14445""></a>
  <div class="note">
   <strong class="user">huevo dot SP at M dot earthling dot net</strong>
   <a href="#14445" class="date">01-Aug-2001 12:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With an Access 2K database, odbc_result will only work the first time it is called on a memo field (odbc_field_type returns 'LONGCHAR').
<br />

<br />
$good = odbc_result($result,'Description');
<br />
# $good holds the field value
<br />
$fail = odbc_result($result,'Description');
<br />
# $fail holds false
<br />

<br />
This tripped me up when I did something like this:
<br />

<br />
for ($i=1; $i&lt;=odbc_num_fields($result); $i++) {
<br />
&nbsp; if(odbc_result($result,$i)){
<br />
&nbsp;&nbsp;&nbsp; ... more code ...
<br />
&nbsp;&nbsp;&nbsp; echo odbc_result($result,$i);
<br />
&nbsp;&nbsp;&nbsp; ... snip ...
<br />
&nbsp; }
<br />
}
<br />

<br />
For any field type except memo, this code works perfectly.&nbsp; But on memo fields, odbc_result returns false on the second call and nothing is echoed.
<br />

<br />
Be careful, use a temporary variable instead of multiple calls to odbc_result.&nbsp; (It's good programming practice anyway)
<br />

<br />
for (...) {
<br />
&nbsp; $temp = odbc_result($result,$i);
<br />
&nbsp; if($temp){
<br />
&nbsp;&nbsp;&nbsp; ...
<br />
&nbsp;&nbsp;&nbsp; echo $temp;
<br />
&nbsp;&nbsp;&nbsp; ...
<br />
&nbsp; }
<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13147""></a>
  <div class="note">
   <strong class="user">user at frosch dot org</strong>
   <a href="#13147" class="date">30-May-2001 05:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hopefully useful note on accessing TEXT fields on Windows, using PHP's ODBC support to access Sybase*. With the following code:
<br />

<br />
"SELECT status AS projstatus,oid AS projident,LOWER(title) AS projtitel,startsOn AS projanfang,terminatesOn AS projende,description AS projinfo FROM Project ORDER BY projtitel ASC"
<br />

<br />
I was getting a strange error:
<br />

<br />
&nbsp; Warning: SQL error: [INTERSOLV][ODBC SQL Server driver][SQL Server]Invalid column name 'projanfang'. , SQL state S0022 in SQLGetData in [**scriptname and path removed**] on line 126
<br />

<br />
even though I was clearly selecting a field as 'projanfang'. The reason I worked out eventually is that Sybase/ODBC attempts to do a conversion on the TEXT field 'description', which fails since the limit for CONVERT is 255 characters, and TEXT is a field type with a&nbsp; 2 GB limit. I am not sure why it doesn't work implicitly, but it does explicitly. The following code will work without errors:
<br />

<br />
&nbsp; "SELECT status AS projstatus,oid AS projident,LOWER(title) AS projtitel,startsOn AS projanfang,terminatesOn AS projende,CONVERT(CHAR(255),description) AS projinfo FROM Project ORDER BY projtitel ASC"
<br />

<br />
What you do if you have a need for more than 255 characters of your text field, I do not know :(. I have also tried longreadlen, but I couldn't work out how it could be used.
<br />

<br />
* System details: Windows NT 4.0 SP6a, IIS 4.0, Sybase 11.5 Adaptive Enteprise, PHP 4.0.5.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="9956""></a>
  <div class="note">
   <strong class="user">nomail at nomail dot nomail</strong>
   <a href="#9956" class="date">04-Dec-2000 02:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Problem: Function returns a max of 4095 bytes of a cell with one call.
<br />

<br />
Tip: If you have a cell containing more than 4095 bytes, write a loop and call the cell over and over as long return is not "". All returns can be added up to the whole string.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="9324""></a>
  <div class="note">
   <strong class="user">dac at felspar dot com</strong>
   <a href="#9324" class="date">28-Oct-2000 04:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
FWIW, ADO and similar ODBC-using interfaces also cannot distinguish between A.id and B.id. The easy solution is aliasing in SQL:
<br />

<br />
Consider a table "A" consisting only of the column "id". Next, consider the following query:
<br />

<br />
SELECT * FROM A JOIN B ON A.id=B.id
<br />

<br />
With ODBC, you'd be forced to use the numerical index, rather than the name. However, you could rewrite the query, too:
<br />

<br />
SELECT A.id AS A_id, B.id AS B_id FROM A JOIN B ON A.id=B.id
<br />

<br />
This can be better on three counts:
<br />

<br />
Firstly, unless you really want everything in the result set, it might be faster. SQL servers can be faster with "*", but often the networking will benefit from less data (Or a smaller tuple width, if you're into database jargon).
<br />

<br />
Secondly, since you're forced into thinking about what you want out of the query, you'll probably write better SQL as a result.
<br />

<br />
Thirdly, if you change the query - or tables - slightly, you don't have to revisit all your code to cope with the change.
<br />

<br />
Aplogies for stating the obvious, and having no imagination with my examples.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="6908""></a>
  <div class="note">
   <strong class="user">dinin at fas dot harvard dot edu</strong>
   <a href="#6908" class="date">22-Jul-2000 06:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a limitation that isn't mentioned anywhere (that I could see) and gave me a rather large headache for a couple of hours trying to figure out why my database wasn't initializing correctly.
<br />
If you are trying to retrieve a large collection of fields from a database, be aware that odbc_result may only return up to 33 result columns.&nbsp; Any more than that, and it generates a "result out of range" warning in your script.
<br />
(I tried adjusting to have 32 fields, with the same bug.) It generates an error "Warning: Field index is larger than the number of fields inyour-script.php on line 70" ANY time you try to retrieve the last field of a sufficiently large record. What worked for me was just to write the last column twice... that way, the query has 34 fields, but the last two are the same. You know it'll crash if you ask for #34, but just use ODBC_result(current_query, 33) and you won't have a problem. Good luck
<br />

<br />
-D</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="6599""></a>
  <div class="note">
   <strong class="user">dave at quiver dot com</strong>
   <a href="#6599" class="date">14-Jul-2000 09:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If I use and MS Access 2000 database with fields of type memo, I get:
<br />
"Warning: SQL error: [Microsoft][ODBC Driver Manager] Invalid cursor state, SQL state 24000 in SQLGetData in D:\Inetpub\wwwroot\xxx\xxx.php on line XxX." If I change to type "text," everything's cool.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="669""></a>
  <div class="note">
   <strong class="user">jniels23 at csc dot com</strong>
   <a href="#669" class="date">24-Mar-1999 05:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware if you have fields with the same name in a result
<br />

<br />
<span class="default">&lt;?php 
<br />
$res </span><span class="keyword">= </span><span class="default">odbc_exec</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">,</span><span class="string">"select * from PeopleMR,People,Role,Organisation"</span><span class="keyword">.
<br />
</span><span class="string">" WHERE PeopleMR.MeetingID = </span><span class="default">$MeetingID</span><span class="string">" </span><span class="keyword">.
<br />
</span><span class="string">" ORDER BY People.Surname"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
I have the field "Name" from both TABLE Role and TABLE Organisation, as for MySQL you would do :
<br />

<br />
<span class="default">&lt;?php
<br />
mysql_result</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">,</span><span class="default">$count</span><span class="keyword">,</span><span class="string">"Role.Name"</span><span class="keyword">);&nbsp;&nbsp; 
<br />
</span><span class="default">mysql_result</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">,</span><span class="default">$count</span><span class="keyword">,</span><span class="string">"Organisation.Name"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
but with odbc you do :
<br />

<br />
<span class="default">&lt;?php odbc_result</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">,</span><span class="default">$count</span><span class="keyword">,</span><span class="string">"Name"</span><span class="keyword">); </span><span class="default">?&gt;
<br />
</span>
<br />
this gives you the result of TABLE Role "Name" so you have to find the Field Number for the Organisation"Name" to have the correct result.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
