<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>バックトレースを生成する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="ref.errorfunc.html">≪ エラー処理関数</a></li>
      <li style="float: right;"><a href="function.debug-print-backtrace.html">debug_print_backtrace ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.errorfunc.html">エラー処理関数</a></li>
    <li>バックトレースを生成する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.debug-backtrace" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">debug_backtrace</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5)</p><p class="refpurpose"><span class="refname">debug_backtrace</span> &mdash; <span class="dc-title">バックトレースを生成する</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.debug-backtrace-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>debug_backtrace</strong></span>
    ([ <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code><span class="initializer"> = DEBUG_BACKTRACE_PROVIDE_OBJECT</span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$limit</code><span class="initializer"> = 0</span></span>
  ]] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>debug_backtrace()</strong></span> は PHP バックトレースを生成します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.debug-backtrace-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       PHP 5.3.6 以降、このパラメータは次のオプションのビットマスクとなります。
       <table class="doctable table">
        <caption><strong><span class="function"><strong>debug_backtrace()</strong></span> のオプション</strong></caption>
        
         <tbody class="tbody">
          <tr>
           <td>DEBUG_BACKTRACE_PROVIDE_OBJECT</td>
           <td>
            &quot;object&quot; インデックスを埋めるかどうか。
           </td>
          </tr>

          <tr>
           <td>DEBUG_BACKTRACE_IGNORE_ARGS</td>
           <td>
            &quot;args&quot; インデックスを無視してすべての関数/メソッドの引数をメモリに格納するかどうか。
           </td>
          </tr>

         </tbody>
        
       </table>

       5.3.6 より前のバージョンでは <strong><code>TRUE</code></strong> あるいは <strong><code>FALSE</code></strong> しか指定できませんでした。これは
       <strong><code>DEBUG_BACKTRACE_PROVIDE_OBJECT</code></strong> オプションを指定するかしないかを意味します。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">limit</code></dt>

     <dd>

      <p class="para">
       5.4.0 以降、このパラメータを使ってスタックフレームの数を制限できるようになりました。
       デフォルト (<code class="parameter">limit</code>=<em>0</em>) は、すべてのスタックフレームを返します。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.debug-backtrace-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   連想配列の配列を返します。連想配列の要素として返される可能性があるものは以下のとおりです。
  </p>
  <p class="para">
   <table class="doctable table">
    <caption><strong>
     <span class="function"><strong>debug_backtrace()</strong></span> から返される可能性がある要素
    </strong></caption>
    
     <thead>
      <tr>
       <th>名前</th>
       <th>型</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>function</td>
       <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td>
       <td>
        カレントの関数名。
        <a href="language.constants.predefined.html" class="link">__FUNCTION__</a>
        も参照してください。
       </td>
      </tr>

      <tr>
       <td>line</td>
       <td><span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span></td>
       <td>
        カレントの行番号。
        <a href="language.constants.predefined.html" class="link">__LINE__</a>
        も参照してください。
       </td>
      </tr>

      <tr>
       <td>file</td>
       <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td>
       <td>
        カレントのファイル名。
        <a href="language.constants.predefined.html" class="link">__FILE__</a>
        も参照してください。
       </td>
      </tr>

      <tr>
       <td>class</td>
       <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td>
       <td>
        カレントの<a href="language.oop5.html" class="link">クラス</a>名。
        <a href="language.constants.predefined.html" class="link">__CLASS__</a>
        も参照してください。
       </td>
      </tr>

      <tr>
       <td>object</td>
       <td><span class="type"><a href="language.types.object.html" class="type object">object</a></span></td>
       <td>
        カレントの<a href="language.oop5.html" class="link">オブジェクト</a>。
       </td>
      </tr>

      <tr>
       <td>type</td>
       <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td>
       <td>
        カレントのコール方式。メソッド呼び出しの場合は &quot;-&gt;&quot;、
        静的なメソッド呼び出しの場合は &quot;::&quot; が返されます。
        関数呼び出しの場合は何も返されません。
       </td>
      </tr>

      <tr>
       <td>args</td>
       <td><span class="type"><a href="language.types.array.html" class="type array">array</a></span></td>
       <td>
        関数の内部の場合、関数の引数のリストとなります。
        インクルードされたファイル内では、
        読み込まれたファイルの名前となります。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.debug-backtrace-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.4.0</td>
       <td>
        オプションのパラメータ <code class="parameter">limit</code> が追加されました。
       </td>
      </tr>

      <tr>
       <td>5.3.6</td>
       <td>
        <code class="parameter">provide_object</code> パラメータが <code class="parameter">options</code>
        パラメータに変わり、オプション
        <strong><code>DEBUG_BACKTRACE_IGNORE_ARGS</code></strong> が追加されました。
       </td>
      </tr>

      <tr>
       <td>5.2.5</td>
       <td>
        オプションのパラメータ <code class="parameter">provide_object</code> が追加されました。
       </td>
      </tr>

      <tr>
       <td>5.1.1</td>
       <td>
        現在の<span class="type"><span class="type オブジェクト">オブジェクト</span></span>を返せるようになりました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.debug-backtrace-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-467">
    <p><strong>例1 <span class="function"><strong>debug_backtrace()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;ファイル名:&nbsp;/tmp/a.php<br /><br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">a_test</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"\nHi:&nbsp;</span><span style="color: #0000BB">$str</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">debug_backtrace</span><span style="color: #007700">());<br />}<br /><br /></span><span style="color: #0000BB">a_test</span><span style="color: #007700">(</span><span style="color: #DD0000">'friend'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;<br /></span><br /><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;ファイル名:&nbsp;/tmp/b.php<br /></span><span style="color: #007700">include_once&nbsp;</span><span style="color: #DD0000">'/tmp/a.php'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
    <var class="filename">/tmp/b.php</var>
    を実行した際の結果は以下のようになります。
    </p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Hi: friend
array(2) {
[0]=&gt;
array(4) {
    [&quot;file&quot;] =&gt; string(10) &quot;/tmp/a.php&quot;
    [&quot;line&quot;] =&gt; int(10)
    [&quot;function&quot;] =&gt; string(6) &quot;a_test&quot;
    [&quot;args&quot;]=&gt;
    array(1) {
      [0] =&gt; &amp;string(6) &quot;friend&quot;
    }
}
[1]=&gt;
array(4) {
    [&quot;file&quot;] =&gt; string(10) &quot;/tmp/b.php&quot;
    [&quot;line&quot;] =&gt; int(2)
    [&quot;args&quot;] =&gt;
    array(1) {
      [0] =&gt; string(10) &quot;/tmp/a.php&quot;
    }
    [&quot;function&quot;] =&gt; string(12) &quot;include_once&quot;
  }
}
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.debug-backtrace-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.trigger-error.html" class="function" rel="rdfs-seeAlso">trigger_error()</a> - ユーザーレベルのエラー/警告/通知メッセージを生成する</span></li>
    <li class="member"><span class="function"><a href="function.debug-print-backtrace.html" class="function" rel="rdfs-seeAlso">debug_print_backtrace()</a> - バックトレースを表示する</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113278""></a>
  <div class="note">
   <strong class="user">jonas at faceways dot se</strong>
   <a href="#113278" class="date">20-Sep-2013 04:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using debug_backtrace() to check if you're being accessed from another caller, please remember to ask debug_backtrace to only go as far as needed in depth and skip taking the entire debug object as return parameter:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">debug_backtrace</span><span class="keyword">(</span><span class="default">FALSE</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">)) == </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Do something<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112238""></a>
  <div class="note">
   <strong class="user">jurchiks101 at gmail dot com</strong>
   <a href="#112238" class="date">21-May-2013 07:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a function I just wrote for getting a nice and comprehensible call trace. It is probably more resource-intensive than some other alternatives but it is short, understandable, and gives nice output (Exception-&gt;getTraceAsString()).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">generateCallTrace</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= new </span><span class="default">Exception</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getTraceAsString</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// reverse array to make steps line up chronologically<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace </span><span class="keyword">= </span><span class="default">array_reverse</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">); </span><span class="comment">// remove {main}<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">); </span><span class="comment">// remove call to this method<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$length</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[] = (</span><span class="default">$i </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">)&nbsp; . </span><span class="string">')' </span><span class="keyword">. </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="string">' '</span><span class="keyword">)); </span><span class="comment">// replace '#someNum' with '$i)', set the right ordering<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="string">"\t" </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">"\n\t"</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Example output:<br />
&nbsp;&nbsp;&nbsp; 1) /var/www/test/test.php(15): SomeClass-&gt;__construct()<br />
&nbsp;&nbsp;&nbsp; 2) /var/www/test/SomeClass.class.php(36): SomeClass-&gt;callSomething()</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111581""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#111581" class="date">06-Mar-2013 06:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A usual entry looks like this:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">array(</span><span class="default">6</span><span class="keyword">) {<br />
&nbsp; </span><span class="string">'file' </span><span class="keyword">=&gt;<br />
&nbsp; </span><span class="default">string</span><span class="keyword">(</span><span class="default">87</span><span class="keyword">) </span><span class="string">"DbSelector.php"<br />
&nbsp; 'line' </span><span class="keyword">=&gt;<br />
&nbsp; </span><span class="default">int</span><span class="keyword">(</span><span class="default">171</span><span class="keyword">)<br />
&nbsp; </span><span class="string">'function' </span><span class="keyword">=&gt;<br />
&nbsp; </span><span class="default">string</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">) </span><span class="string">"error"<br />
&nbsp; 'class' </span><span class="keyword">=&gt;<br />
&nbsp; </span><span class="default">string</span><span class="keyword">(</span><span class="default">42</span><span class="keyword">) </span><span class="string">"LoggingService"<br />
&nbsp; 'type' </span><span class="keyword">=&gt;<br />
&nbsp; </span><span class="default">string</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">) </span><span class="string">"::"<br />
&nbsp; 'args' </span><span class="keyword">=&gt;<br />
&nbsp; array(</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">0</span><span class="keyword">] =&gt;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">string</span><span class="keyword">(</span><span class="default">27</span><span class="keyword">) </span><span class="string">"Connecting to DB: unittests"<br />
&nbsp; </span><span class="keyword">}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Be warned though that 'file' and 'class' do not reference the same thing!<br />
'file' means which file calls the next step.<br />
'class' is the next step being called.<br />
<br />
So 'file' is the caller, 'class' is the callee.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111355""></a>
  <div class="note">
   <strong class="user">Gemorroj</strong>
   <a href="#111355" class="date">11-Feb-2013 06:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another variation formatting backtrace.
<br />
Parameter $ignore to ignore the extra calls.
<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* Getting backtrace
<br />
&nbsp;*
<br />
&nbsp;* @param int $ignore ignore calls
<br />
&nbsp;*
<br />
&nbsp;* @return string
<br />
&nbsp;*/
<br />
</span><span class="keyword">protected function </span><span class="default">getBacktrace</span><span class="keyword">(</span><span class="default">$ignore </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">debug_backtrace</span><span class="keyword">() as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$k </span><span class="keyword">&lt; </span><span class="default">$ignore</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_walk</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">], function (&amp;</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; });
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trace </span><span class="keyword">.= </span><span class="string">'#' </span><span class="keyword">. (</span><span class="default">$k </span><span class="keyword">- </span><span class="default">$ignore</span><span class="keyword">) . </span><span class="string">' ' </span><span class="keyword">. </span><span class="default">$v</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">] . </span><span class="string">'(' </span><span class="keyword">. </span><span class="default">$v</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">] . </span><span class="string">'): ' </span><span class="keyword">. (isset(</span><span class="default">$v</span><span class="keyword">[</span><span class="string">'class'</span><span class="keyword">]) ? </span><span class="default">$v</span><span class="keyword">[</span><span class="string">'class'</span><span class="keyword">] . </span><span class="string">'-&gt;' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">) . </span><span class="default">$v</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] . </span><span class="string">'(' </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">', '</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">]) . </span><span class="string">')' </span><span class="keyword">. </span><span class="string">"\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$trace</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111264""></a>
  <div class="note">
   <strong class="user">nyoung55 at that_google_mail.com</strong>
   <a href="#111264" class="date">01-Feb-2013 01:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a function to cleanly output the debug_backtrace to the error_log
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/*
<br />
&nbsp;* Send the output from a backtrace to the error_log
<br />
&nbsp;* @param string $message Optional message that will be sent the the error_log before the backtrace
<br />
&nbsp;*/
<br />
</span><span class="keyword">function </span><span class="default">log_trace</span><span class="keyword">(</span><span class="default">$message </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$message</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">$message</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$caller </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$function_name </span><span class="keyword">= </span><span class="default">$caller</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%s: Called from %s:%s'</span><span class="keyword">, </span><span class="default">$function_name</span><span class="keyword">, </span><span class="default">$caller</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">], </span><span class="default">$caller</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">]));
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$trace </span><span class="keyword">as </span><span class="default">$entry_id </span><span class="keyword">=&gt; </span><span class="default">$entry</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">] = </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">] ? : </span><span class="string">'-'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">] = </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">] ? : </span><span class="string">'-'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (empty(</span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'class'</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%s %3s. %s() %s:%s'</span><span class="keyword">, </span><span class="default">$function_name</span><span class="keyword">, </span><span class="default">$entry_id </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">, </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">], </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">], </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">]));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%s %3s. %s-&gt;%s() %s:%s'</span><span class="keyword">, </span><span class="default">$function_name</span><span class="keyword">, </span><span class="default">$entry_id </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">, </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'class'</span><span class="keyword">], </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">], </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">], </span><span class="default">$entry</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">]));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111255""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#111255" class="date">31-Jan-2013 05:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple function to get a string in form "filename: [class-&gt;][function(): ]"<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">get_caller_info</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$trace</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$func</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">) == </span><span class="string">'include'</span><span class="keyword">) || (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$func</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">) == </span><span class="string">'require'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } else if (isset(</span><span class="default">$trace</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$trace</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">][</span><span class="string">'class'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">][</span><span class="string">'class'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; } else if (isset(</span><span class="default">$trace</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="string">'class'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="string">'class'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">''</span><span class="keyword">) </span><span class="default">$file </span><span class="keyword">= </span><span class="default">basename</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">$file </span><span class="keyword">. </span><span class="string">": "</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">.= (</span><span class="default">$class </span><span class="keyword">!= </span><span class="string">''</span><span class="keyword">) ? </span><span class="string">":" </span><span class="keyword">. </span><span class="default">$class </span><span class="keyword">. </span><span class="string">"-&gt;" </span><span class="keyword">: </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">.= (</span><span class="default">$func </span><span class="keyword">!= </span><span class="string">''</span><span class="keyword">) ? </span><span class="default">$func </span><span class="keyword">. </span><span class="string">"(): " </span><span class="keyword">: </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return(</span><span class="default">$c</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Usage like:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">debug</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">get_caller_info</span><span class="keyword">() . </span><span class="default">$str </span><span class="keyword">. </span><span class="string">"&lt;br&gt;\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
get_caller_info() will return info about the function /class-&gt;method that called debug().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110917""></a>
  <div class="note">
   <strong class="user">root at jackyyf dot com</strong>
   <a href="#110917" class="date">22-Dec-2012 09:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When use register_shutdown_function, and the function called when shutting down, there are no line number nor filename information about this function, only function, class(if possible), type(if possible) and args are provided.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110648""></a>
  <div class="note">
   <strong class="user">Phil Hilton</strong>
   <a href="#110648" class="date">17-Nov-2012 03:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Super simple example to output where your function was called from (file, function, line number):
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// Prints the file name, function name, and 
<br />
// line number which called your function
<br />
// (not this function, then one that&nbsp; called 
<br />
// it to begin with) 
<br />
</span><span class="keyword">function </span><span class="default">debugPrintCallingFunction </span><span class="keyword">() {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="string">'n/a'</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="string">'n/a'</span><span class="keyword">; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="string">'n/a'</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$debugTrace </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$debugTrace</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$debugTrace</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">] ? </span><span class="default">$debugTrace</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">] : </span><span class="string">'n/a'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">$debugTrace</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'line'</span><span class="keyword">] ? </span><span class="default">$debugTrace</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'line'</span><span class="keyword">] : </span><span class="string">'n/a'</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$debugTrace</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">])) </span><span class="default">$func </span><span class="keyword">= </span><span class="default">$debugTrace</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">] ? </span><span class="default">$debugTrace</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">] : </span><span class="string">'n/a'</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;pre&gt;\n</span><span class="default">$file</span><span class="string">, </span><span class="default">$func</span><span class="string">, </span><span class="default">$line</span><span class="string">\n&lt;/pre&gt;"</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110237""></a>
  <div class="note">
   <strong class="user">d at rren dot me</strong>
   <a href="#110237" class="date">04-Oct-2012 04:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Howdy guys, just a note really - The ['args'] data within the resulting array is supplied by reference. I found myself editing the reference unknowingly which in turn shows its ugly head further down the line if you call multiple backtrace.
<br />

<br />
<span class="default">&lt;?php
<br />
$trace </span><span class="keyword">= </span><span class="default">array_reverse</span><span class="keyword">(</span><span class="default">debug_backtrace</span><span class="keyword">());
<br />

<br />
</span><span class="comment">// LOOP BACKTRACE
<br />
</span><span class="default">$la </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
</span><span class="default">$lb </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">);
<br />
while (</span><span class="default">$la</span><span class="keyword">&lt;</span><span class="default">$lb</span><span class="keyword">){
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// DATA FROM BACKTRACE
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$la</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$la</span><span class="keyword">][</span><span class="string">'line'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$la</span><span class="keyword">][</span><span class="string">'args'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$la</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// DATA FROM BACKTRACE
<br />

<br />
&nbsp;&nbsp;&nbsp; // LOOP ARGUMENTS ARRAY
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ba </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bb </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$la</span><span class="keyword">][</span><span class="string">'args'</span><span class="keyword">]);
<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$ba</span><span class="keyword">&lt;</span><span class="default">$bb</span><span class="keyword">){
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$la</span><span class="keyword">][</span><span class="string">'args'</span><span class="keyword">][</span><span class="default">$ba</span><span class="keyword">] = </span><span class="string">"EDITING A REFERENCE/POINTER"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ba</span><span class="keyword">++;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; unset(</span><span class="default">$bb</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; unset(</span><span class="default">$ba</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// LOOP ARGUMENTS ARRAY
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$la</span><span class="keyword">++;
<br />
}
<br />
unset(</span><span class="default">$lb</span><span class="keyword">);
<br />
unset(</span><span class="default">$la</span><span class="keyword">);
<br />
</span><span class="comment">// LOOP BACKTRACE
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110066""></a>
  <div class="note">
   <strong class="user">kexianbin at diyism dot com</strong>
   <a href="#110066" class="date">16-Sep-2012 11:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
need no Xdebug or dbg.so on server, return more detailed message:<br />
<br />
diyism_trace.php:<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="default">TRACES_MODE</span><span class="keyword">, </span><span class="string">'TEXTAREA'</span><span class="keyword">);</span><span class="comment">//'TEXTAREA' or 'FIREPHP'<br />
</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'traces.pre'</span><span class="keyword">]=array();<br />
function </span><span class="default">my_array_diff</span><span class="keyword">(</span><span class="default">$arr1</span><span class="keyword">, </span><span class="default">$arr2</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {foreach (</span><span class="default">$arr1 </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$v</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {if (</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">, </span><span class="default">$arr2</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {unset(</span><span class="default">$arr1</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$arr1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
function </span><span class="default">my_var_export</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">, </span><span class="default">$is_str</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {</span><span class="default">$rtn</span><span class="keyword">=</span><span class="default">preg_replace</span><span class="keyword">(array(</span><span class="string">'/Array\s+\(/'</span><span class="keyword">, </span><span class="string">'/\[(\d+)\] =&gt; (.*)\n/'</span><span class="keyword">, </span><span class="string">'/\[([^\d].*)\] =&gt; (.*)\n/'</span><span class="keyword">), array(</span><span class="string">'array ('</span><span class="keyword">, </span><span class="string">'\1 =&gt; \'\2\''</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">, </span><span class="string">'\'\1\' =&gt; \'\2\''</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">), </span><span class="default">substr</span><span class="keyword">(</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rtn</span><span class="keyword">=</span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$rtn</span><span class="keyword">, array(</span><span class="string">"=&gt; 'array ('"</span><span class="keyword">=&gt;</span><span class="string">'=&gt; array ('</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rtn</span><span class="keyword">=</span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$rtn</span><span class="keyword">, array(</span><span class="string">")\n\n"</span><span class="keyword">=&gt;</span><span class="string">")\n"</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rtn</span><span class="keyword">=</span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$rtn</span><span class="keyword">, array(</span><span class="string">"'\n"</span><span class="keyword">=&gt;</span><span class="string">"',\n"</span><span class="keyword">, </span><span class="string">")\n"</span><span class="keyword">=&gt;</span><span class="string">"),\n"</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rtn</span><span class="keyword">=</span><span class="default">preg_replace</span><span class="keyword">(array(</span><span class="string">'/\n +/e'</span><span class="keyword">), array(</span><span class="string">'strtr(\'\0\', array(\'&nbsp; &nbsp; \'=&gt;\'&nbsp; \'))'</span><span class="keyword">), </span><span class="default">$rtn</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rtn</span><span class="keyword">=</span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$rtn</span><span class="keyword">, array(</span><span class="string">" Object',"</span><span class="keyword">=&gt;</span><span class="string">" Object'&lt;-"</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$is_str</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {return </span><span class="default">$rtn</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {echo </span><span class="default">$rtn</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
function </span><span class="default">tick_handler</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {</span><span class="default">$tmp</span><span class="keyword">=</span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">=</span><span class="default">my_array_diff</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">, </span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'traces.pre'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//echo '&lt;pre&gt;';var_export($trace);echo '&lt;/pre&gt;';echo '&lt;br/&gt;'; //for debug diyism_trace.php<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">=</span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'traces.pre'</span><span class="keyword">]=</span><span class="default">$tmp</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">)&gt;</span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">].</span><span class="string">'/'</span><span class="keyword">.@</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">]!==@</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'traces'</span><span class="keyword">][</span><span class="default">count</span><span class="keyword">(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'traces'</span><span class="keyword">])-</span><span class="default">1</span><span class="keyword">][</span><span class="string">'key'</span><span class="keyword">]) </span><span class="comment">//filter empty array and rearrange array_values(), because some lines will trigger two tick events per line, for example: 1.last line is "some code;questmark&gt;" 2.error_reporting(...<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">{for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&gt;=</span><span class="default">0</span><span class="keyword">; --</span><span class="default">$i</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'traces'</span><span class="keyword">][]=</span><span class="default">$tmp_fb</span><span class="keyword">=</span><span class="default">array_merge</span><span class="keyword">(array(</span><span class="string">'key'</span><span class="keyword">=&gt;</span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">].</span><span class="string">'/'</span><span class="keyword">.@</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">]), </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], array(</span><span class="string">'function'</span><span class="keyword">=&gt;</span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">], array(</span><span class="string">'tick_handler'</span><span class="keyword">=&gt;</span><span class="string">'CONTINUE'</span><span class="keyword">)), </span><span class="string">'in_function'</span><span class="keyword">=&gt;@</span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">]));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">TRACES_MODE</span><span class="keyword">===</span><span class="string">'FIREPHP'</span><span class="keyword">?</span><span class="default">fb</span><span class="keyword">(</span><span class="default">trace_output</span><span class="keyword">(</span><span class="default">$tmp_fb</span><span class="keyword">), </span><span class="string">'diyism_trace:'</span><span class="keyword">.++</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'diyism_trace_no'</span><span class="keyword">]):</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
function </span><span class="default">trace_output</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {</span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'in_function'</span><span class="keyword">]=</span><span class="default">strtr</span><span class="keyword">(@</span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'in_function'</span><span class="keyword">], array(</span><span class="string">'require'</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">, </span><span class="string">'require_once'</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">, </span><span class="string">'include'</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">, </span><span class="string">'include_once'</span><span class="keyword">=&gt;</span><span class="string">''</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">]=</span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">]?</span><span class="default">strtr</span><span class="keyword">(</span><span class="default">preg_replace</span><span class="keyword">(array(</span><span class="string">'/\n +/'</span><span class="keyword">), array(</span><span class="string">''</span><span class="keyword">), </span><span class="default">preg_replace</span><span class="keyword">(array(</span><span class="string">'/\n&nbsp; \d+ =&gt; /'</span><span class="keyword">), array(</span><span class="string">''</span><span class="keyword">), </span><span class="default">substr</span><span class="keyword">(</span><span class="default">my_var_export</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">], </span><span class="default">true</span><span class="keyword">), </span><span class="default">7</span><span class="keyword">, -</span><span class="default">3</span><span class="keyword">))), array(</span><span class="string">"\r"</span><span class="keyword">=&gt;</span><span class="string">'\r'</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">=&gt;</span><span class="string">'\n'</span><span class="keyword">)):</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">].(</span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'in_function'</span><span class="keyword">]?</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'in_function'</span><span class="keyword">].</span><span class="string">'()'</span><span class="keyword">:</span><span class="string">''</span><span class="keyword">).</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">].</span><span class="string">': '</span><span class="keyword">.</span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">].</span><span class="string">'('</span><span class="keyword">.</span><span class="default">$trace</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">].</span><span class="string">')'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
function </span><span class="default">traces_output</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {echo </span><span class="string">'&lt;textarea style="width:100%;height:300px;"&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'traces'</span><span class="keyword">]=</span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'traces'</span><span class="keyword">], </span><span class="default">2</span><span class="keyword">);</span><span class="comment">//remove registering tick line and requiring 'diyism_trace.php' line<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'traces'</span><span class="keyword">] as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$trace</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {echo </span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">trace_output</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;/textarea&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
</span><span class="default">register_tick_function</span><span class="keyword">(</span><span class="string">'tick_handler'</span><span class="keyword">);<br />
</span><span class="default">TRACES_MODE</span><span class="keyword">===</span><span class="string">'TEXTAREA'</span><span class="keyword">?</span><span class="default">register_shutdown_function</span><span class="keyword">(</span><span class="string">'traces_output'</span><span class="keyword">):</span><span class="string">''</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
test.php:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">declare(</span><span class="default">ticks</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">);<br />
require </span><span class="string">'diyism_trace.php'</span><span class="keyword">;<br />
<br />
</span><span class="default">a</span><span class="keyword">(</span><span class="string">'a'</span><span class="keyword">, array(</span><span class="string">'hello'</span><span class="keyword">));<br />
</span><span class="default">1</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">;<br />
</span><span class="default">b</span><span class="keyword">();<br />
function </span><span class="default">a</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {</span><span class="default">$d</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">b</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
function </span><span class="default">b</span><span class="keyword">()<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {</span><span class="default">1</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106572""></a>
  <div class="note">
   <strong class="user">ciprian dot stingu at gmail dot com</strong>
   <a href="#106572" class="date">19-Nov-2011 09:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A function that i use for debug<br />
I shortened variables name and i eliminated the spaces from second function in order fit in post :(<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">"LFP"</span><span class="keyword">, </span><span class="string">'./lt.log'</span><span class="keyword">);<br />
function </span><span class="default">LogTrace</span><span class="keyword">(</span><span class="default">$Argument</span><span class="keyword">, </span><span class="default">$lfn </span><span class="keyword">= </span><span class="default">LFP</span><span class="keyword">, </span><span class="default">$itw </span><span class="keyword">= </span><span class="string">'&nbsp; '</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="string">"=====\r"</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="default">$lfn</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="string">"[BEGIN BACKTRACE]\r"</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="default">$lfn</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$it </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Ts </span><span class="keyword">= </span><span class="default">array_reverse</span><span class="keyword">(</span><span class="default">debug_backtrace</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$Ts </span><span class="keyword">as </span><span class="default">$T</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; {&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$T</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] != </span><span class="string">'include' </span><span class="keyword">&amp;&amp; </span><span class="default">$T</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] != </span><span class="string">'require' </span><span class="keyword">&amp;&amp; </span><span class="default">$T</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] != </span><span class="string">'include_once' </span><span class="keyword">&amp;&amp; </span><span class="default">$T</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] != </span><span class="string">'require_once'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ft </span><span class="keyword">= </span><span class="default">$it </span><span class="keyword">. </span><span class="string">'&lt;'</span><span class="keyword">. </span><span class="default">basename</span><span class="keyword">(</span><span class="default">$T</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">]) . </span><span class="string">'&gt; on line ' </span><span class="keyword">. </span><span class="default">$T</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">];&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$T</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] != </span><span class="string">'LogTrace'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset(</span><span class="default">$T</span><span class="keyword">[</span><span class="string">'class'</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ft </span><span class="keyword">.= </span><span class="string">' in method ' </span><span class="keyword">. </span><span class="default">$T</span><span class="keyword">[</span><span class="string">'class'</span><span class="keyword">] . </span><span class="default">$T</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ft </span><span class="keyword">.= </span><span class="string">' in function '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ft </span><span class="keyword">.= </span><span class="default">$Trace</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] . </span><span class="string">'('</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ft </span><span class="keyword">.= </span><span class="string">'('</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset(</span><span class="default">$T</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$T</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] != </span><span class="string">'LogTrace'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ct </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$T</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">] as </span><span class="default">$A</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ft </span><span class="keyword">.= </span><span class="default">$ct </span><span class="keyword">. </span><span class="default">LogVar</span><span class="keyword">(</span><span class="default">$A</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$it</span><span class="keyword">, </span><span class="default">$itw</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ct </span><span class="keyword">= </span><span class="default">$it </span><span class="keyword">. </span><span class="default">$itw </span><span class="keyword">. </span><span class="string">','</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ft </span><span class="keyword">.= </span><span class="default">LogVar</span><span class="keyword">(</span><span class="default">$T</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">], </span><span class="string">''</span><span class="keyword">, </span><span class="default">$it</span><span class="keyword">, </span><span class="default">$itw</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ft </span><span class="keyword">.= </span><span class="default">$it </span><span class="keyword">. </span><span class="string">")\r"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">$ft</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="default">$lfn</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$it </span><span class="keyword">.= </span><span class="default">$itw</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">error_log</span><span class="keyword">(</span><span class="string">"[END BACKTRACE]\r"</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">, </span><span class="default">$lfn</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">LogVar</span><span class="keyword">(&amp;</span><span class="default">$Var</span><span class="keyword">, </span><span class="default">$vn</span><span class="keyword">, </span><span class="default">$pit</span><span class="keyword">, </span><span class="default">$itw</span><span class="keyword">, </span><span class="default">$nlvl</span><span class="keyword">, </span><span class="default">$m </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$nlvl</span><span class="keyword">&gt;=</span><span class="default">16</span><span class="keyword">) return;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$nlvl</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">){</span><span class="default">$tv</span><span class="keyword">=</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$Var</span><span class="keyword">);</span><span class="default">$tv</span><span class="keyword">=</span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">);}<br />
&nbsp;&nbsp;&nbsp; else </span><span class="default">$tv</span><span class="keyword">=&amp;</span><span class="default">$Var</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$it</span><span class="keyword">=</span><span class="default">$pit</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$nlvl</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) </span><span class="default">$it</span><span class="keyword">.=</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;</span><span class="default">$nl</span><span class="keyword">=</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$vn</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="default">$m</span><span class="keyword">.</span><span class="string">'&lt;array&gt; $'</span><span class="keyword">.</span><span class="default">$vn</span><span class="keyword">.</span><span class="string">' = ('</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">"\r"</span><span class="keyword">.</span><span class="default">$it</span><span class="keyword">.</span><span class="default">$m</span><span class="keyword">.</span><span class="string">'&lt;array&gt; = ('</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.= </span><span class="default">$nl</span><span class="keyword">;</span><span class="default">$AK</span><span class="keyword">=</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$AK </span><span class="keyword">as </span><span class="default">$AN</span><span class="keyword">) {</span><span class="default">$AV</span><span class="keyword">=&amp;</span><span class="default">$tv</span><span class="keyword">[</span><span class="default">$AN</span><span class="keyword">];</span><span class="default">$o</span><span class="keyword">.=</span><span class="default">LogVar</span><span class="keyword">(</span><span class="default">$AV</span><span class="keyword">,</span><span class="default">$AN</span><span class="keyword">,</span><span class="default">$pit</span><span class="keyword">,</span><span class="default">$itw</span><span class="keyword">,</span><span class="default">$nlvl</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="string">')'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else if(</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$vn</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">)</span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="default">$m</span><span class="keyword">.</span><span class="string">'&lt;string&gt; $'</span><span class="keyword">.</span><span class="default">$vn</span><span class="keyword">.</span><span class="string">' = '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">' '</span><span class="keyword">.</span><span class="default">$m</span><span class="keyword">.</span><span class="string">'&lt;string&gt; = '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$tv</span><span class="keyword">===</span><span class="default">null</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">'NULL'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">'"'</span><span class="keyword">.</span><span class="default">$tv</span><span class="keyword">.</span><span class="string">'"'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else if(</span><span class="default">is_bool</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$vn</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="default">$m</span><span class="keyword">.</span><span class="string">'&lt;boolean&gt; $'</span><span class="keyword">.</span><span class="default">$vn</span><span class="keyword">.</span><span class="string">' = '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">' '</span><span class="keyword">.</span><span class="default">$m</span><span class="keyword">.</span><span class="string">'&lt;boolean&gt; = '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$tv</span><span class="keyword">===</span><span class="default">true</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">'TRUE'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">'FALSE'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else if(</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$vn</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$pit</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$nlvl</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$m</span><span class="keyword">.</span><span class="string">'&lt;'</span><span class="keyword">.</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">).</span><span class="string">'::$'</span><span class="keyword">.</span><span class="default">$vn</span><span class="keyword">.</span><span class="string">'&gt; = {'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">' '</span><span class="keyword">.</span><span class="default">$m</span><span class="keyword">.</span><span class="string">'&lt;'</span><span class="keyword">.</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">).</span><span class="string">'::&gt; = {'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$R</span><span class="keyword">=new </span><span class="default">ReflectionClass</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">.</span><span class="string">'Class methods {'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CM</span><span class="keyword">=</span><span class="default">$R</span><span class="keyword">-&gt;</span><span class="default">getMethods</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$CM </span><span class="keyword">as </span><span class="default">$MN </span><span class="keyword">=&gt; </span><span class="default">$MV</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">.</span><span class="default">implode</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">,</span><span class="default">Reflection</span><span class="keyword">::</span><span class="default">getModifierNames</span><span class="keyword">(</span><span class="default">$MV</span><span class="keyword">-&gt;</span><span class="default">getModifiers</span><span class="keyword">())).</span><span class="string">' '</span><span class="keyword">.</span><span class="default">$MV</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">().</span><span class="string">'('</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$MP</span><span class="keyword">=</span><span class="default">$MV</span><span class="keyword">-&gt;</span><span class="default">getParameters</span><span class="keyword">(); </span><span class="default">$ct</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$MP </span><span class="keyword">as </span><span class="default">$MPN </span><span class="keyword">=&gt; </span><span class="default">$MPV</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$ct</span><span class="keyword">; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">isOptional</span><span class="keyword">()?</span><span class="string">'['</span><span class="keyword">:</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">isArray</span><span class="keyword">()) </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">'&lt;array&gt; '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if(</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">getClass</span><span class="keyword">()!==</span><span class="default">null</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">'&lt;'</span><span class="keyword">.</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">getClass</span><span class="keyword">()-&gt;</span><span class="default">getName</span><span class="keyword">().</span><span class="string">'::&gt; '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">isPassedByReference</span><span class="keyword">()?</span><span class="string">'&amp;'</span><span class="keyword">:</span><span class="string">''</span><span class="keyword">; </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">'$'</span><span class="keyword">.</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">isDefaultValueAvailable</span><span class="keyword">())<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">getDefaultValue</span><span class="keyword">()===</span><span class="default">null</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">' = NULL'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if(</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">getDefaultValue</span><span class="keyword">()===</span><span class="default">true</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">' = TRUE'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if(</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">getDefaultValue</span><span class="keyword">()===</span><span class="default">false</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">' = FALSE'</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">' = '</span><span class="keyword">.</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">getDefaultValue</span><span class="keyword">();&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$MPV</span><span class="keyword">-&gt;</span><span class="default">isOptional</span><span class="keyword">()?</span><span class="string">']'</span><span class="keyword">:</span><span class="string">''</span><span class="keyword">; </span><span class="default">$ct</span><span class="keyword">=</span><span class="string">', '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">')'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">.</span><span class="string">'}'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">.</span><span class="string">'Class properties {'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CV</span><span class="keyword">=</span><span class="default">$R</span><span class="keyword">-&gt;</span><span class="default">getProperties</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$CV </span><span class="keyword">as </span><span class="default">$CN </span><span class="keyword">=&gt; </span><span class="default">$CV</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$M</span><span class="keyword">=</span><span class="default">implode</span><span class="keyword">(</span><span class="string">' '</span><span class="keyword">,</span><span class="default">Reflection</span><span class="keyword">::</span><span class="default">getModifierNames</span><span class="keyword">(</span><span class="default">$CV</span><span class="keyword">-&gt;</span><span class="default">getModifiers</span><span class="keyword">())).</span><span class="string">' '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CV</span><span class="keyword">-&gt;</span><span class="default">setAccessible</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">LogVar</span><span class="keyword">(</span><span class="default">$CV</span><span class="keyword">-&gt;</span><span class="default">getValue</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">),</span><span class="default">$CV</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(),</span><span class="default">$pit</span><span class="keyword">,</span><span class="default">$itw</span><span class="keyword">,</span><span class="default">$nlvl</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">,</span><span class="default">$M</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">.</span><span class="string">'}'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">.</span><span class="string">'Object variables {'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$OVs</span><span class="keyword">=</span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$OVs </span><span class="keyword">as </span><span class="default">$ON </span><span class="keyword">=&gt; </span><span class="default">$OV</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">LogVar</span><span class="keyword">(</span><span class="default">$OV</span><span class="keyword">,</span><span class="default">$ON</span><span class="keyword">,</span><span class="default">$pit</span><span class="keyword">,</span><span class="default">$itw</span><span class="keyword">,</span><span class="default">$nlvl</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">.</span><span class="string">'}'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$pit</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$nlvl</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)&nbsp; &nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">'.'</span><span class="keyword">.</span><span class="default">$itw</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">'}'</span><span class="keyword">.</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$vn</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$it</span><span class="keyword">.</span><span class="default">$m</span><span class="keyword">.</span><span class="string">'&lt;'</span><span class="keyword">.</span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">).</span><span class="string">'&gt; $'</span><span class="keyword">.</span><span class="default">$vn</span><span class="keyword">.</span><span class="string">' = '</span><span class="keyword">.</span><span class="default">$tv</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$o</span><span class="keyword">.=</span><span class="string">' '</span><span class="keyword">.</span><span class="default">$m</span><span class="keyword">.</span><span class="string">'&lt;'</span><span class="keyword">.</span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$tv</span><span class="keyword">).</span><span class="string">'&gt; = '</span><span class="keyword">.</span><span class="default">$tv</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">.=</span><span class="default">$nl</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$o</span><span class="keyword">;&nbsp; &nbsp; <br />
}<br />
</span><span class="comment">//test<br />
</span><span class="default">date_default_timezone_set</span><span class="keyword">(</span><span class="string">'Europe/Bucharest'</span><span class="keyword">);<br />
</span><span class="default">$date </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">'2010-01-28'</span><span class="keyword">);<br />
</span><span class="default">LogTrace</span><span class="keyword">(</span><span class="default">$date</span><span class="keyword">); <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101498""></a>
  <div class="note">
   <strong class="user">Bill Getas</strong>
   <a href="#101498" class="date">21-Dec-2010 12:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's my little updated contribution - it prints colorful output in the way I prefer.&nbsp; Define a helper function isRootIp() that contains an array including your IP; then calls to bt() simply return, so you can sprinkle backtraces in live sites w/o anyone knowing.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">bt</span><span class="keyword">()
<br />
{
<br />
&nbsp;&nbsp;&nbsp; if( ! </span><span class="default">isRootIp</span><span class="keyword">() )
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_walk</span><span class="keyword">( </span><span class="default">debug_backtrace</span><span class="keyword">(), </span><span class="default">create_function</span><span class="keyword">( </span><span class="string">'$a,$b'</span><span class="keyword">, </span><span class="string">'print "&lt;br /&gt;&lt;b&gt;". basename( $a[\'file\'] ). "&lt;/b&gt; &amp;nbsp; &lt;font color=\"red\"&gt;{$a[\'line\']}&lt;/font&gt; &amp;nbsp; &lt;font color=\"green\"&gt;{$a[\'function\']} ()&lt;/font&gt; &amp;nbsp; -- ". dirname( $a[\'file\'] ). "/";' </span><span class="keyword">) );
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100350""></a>
  <div class="note">
   <strong class="user">henzeberkheij at gmail dot com</strong>
   <a href="#100350" class="date">10-Oct-2010 11:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I find it useful to know if a function is being called. in Java for instance you usually print a line with the functionname and arguments in the beginning of the function. I wanted to achieve the same thing in php thus i wrote the following class:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">Debug 
<br />
</span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; private static </span><span class="default">$calls</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">log</span><span class="keyword">(</span><span class="default">$message </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$calls</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$calls </span><span class="keyword">= array();
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$call </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$call </span><span class="keyword">= (isset(</span><span class="default">$call</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]))?</span><span class="default">$call</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]:</span><span class="default">$call</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$call</span><span class="keyword">[</span><span class="string">'message'</span><span class="keyword">] = </span><span class="default">$message</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$calls</span><span class="keyword">, </span><span class="default">$call</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
include this class before anything else
<br />
usage: Debug::log($message); at the beginning of your function.
<br />

<br />
write yourself a nice printout of the data;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99796""></a>
  <div class="note">
   <strong class="user">kenorb at gmail dot com</strong>
   <a href="#99796" class="date">07-Sep-2010 04:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One line of code to print simplest and shortest human readable backtrace:)<br />
<span class="default">&lt;?php<br />
array_walk</span><span class="keyword">(</span><span class="default">debug_backtrace</span><span class="keyword">(),</span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$a,$b'</span><span class="keyword">,</span><span class="string">'print "{$a[\'function\']}()(".basename($a[\'file\']).":{$a[\'line\']}); ";'</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99752""></a>
  <div class="note">
   <strong class="user">php noob</strong>
   <a href="#99752" class="date">03-Sep-2010 05:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Surprisingly, no one has described one of the best uses of this: dumping a variable and showing the location. When debugging, especially a big and unfamiliar system, it's a pain remembering where I added those var dumps. Also, this way there is a separator between multiple dump calls.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">dump</span><span class="keyword">( </span><span class="default">$var </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">var_export</span><span class="keyword">( </span><span class="default">$var</span><span class="keyword">, </span><span class="default">true </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$loc </span><span class="keyword">= </span><span class="default">whereCalled</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; return </span><span class="string">"\n&lt;pre&gt;Dump: </span><span class="default">$loc</span><span class="string">\n</span><span class="default">$result</span><span class="string">&lt;/pre&gt;"</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">whereCalled</span><span class="keyword">( </span><span class="default">$level </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$level</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$line&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$level</span><span class="keyword">][</span><span class="string">'line'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$object </span><span class="keyword">= </span><span class="default">$trace</span><span class="keyword">[</span><span class="default">$level</span><span class="keyword">][</span><span class="string">'object'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">)) { </span><span class="default">$object </span><span class="keyword">= </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$object</span><span class="keyword">); }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="string">"Where called: line </span><span class="default">$line</span><span class="string"> of </span><span class="default">$object</span><span class="string"> \n(in </span><span class="default">$file</span><span class="string">)"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
In addition, calling 'whereCalled()' from any function will quickly identify locations that are doing something unexpected (e.g., updating a property at the wrong time). I'm new to PHP, but have used the equivalent in Perl for years.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98909""></a>
  <div class="note">
   <strong class="user">jlammertink at gmail dot com</strong>
   <a href="#98909" class="date">15-Jul-2010 11:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use this simple but effective function so i can see which method in the child class called the current method (in the parent class).
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">get_caller_method</span><span class="keyword">()
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$traces </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();
<br />

<br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$traces</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]))
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$traces</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">null</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96418""></a>
  <div class="note">
   <strong class="user">john dot risken at gmail dot com</strong>
   <a href="#96418" class="date">26-Feb-2010 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Everybody seems to have their favorite use.&nbsp; I substitute this function for die().&nbsp; It gives a message 
<br />
to the user and emails me a PrettyPrint of what went wrong.&nbsp; $info is set by me, 
<br />
and it does a special check in the database object.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// var_format
<br />

<br />
</span><span class="keyword">function </span><span class="default">var_format</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">) </span><span class="comment">// pretty-print var_export
<br />
</span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">"\n"</span><span class="keyword">,</span><span class="string">" "</span><span class="keyword">,</span><span class="string">"array"</span><span class="keyword">),
<br />
array(</span><span class="string">"&lt;br&gt;"</span><span class="keyword">,</span><span class="string">"&amp;nbsp;"</span><span class="keyword">,</span><span class="string">"&amp;nbsp;&lt;i&gt;array&lt;/i&gt;"</span><span class="keyword">),
<br />
</span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">)).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">);
<br />
}
<br />
function </span><span class="default">myDie</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">) 
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mysqlerr</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">,</span><span class="string">"ERROR=You have an error in your SQL syntax"</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$mysqlerr</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">)</span><span class="default">$info</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$mysqlerr</span><span class="keyword">).</span><span class="string">" mySql format error"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">=</span><span class="string">"&lt;br&gt;MSG='</span><span class="default">$info</span><span class="string">'&lt;br&gt;"</span><span class="keyword">.</span><span class="default">var_format</span><span class="keyword">(</span><span class="default">$_REQUEST</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bt</span><span class="keyword">=</span><span class="default">debug_backtrace</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sp</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$bt </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$v</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">extract</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">+</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="string">"/"</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$file</span><span class="keyword">==</span><span class="string">"db.php"</span><span class="keyword">)continue; </span><span class="comment">// the db object
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">.=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"&amp;nbsp;"</span><span class="keyword">,++</span><span class="default">$sp</span><span class="keyword">); </span><span class="comment">//spaces(++$sp);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trace</span><span class="keyword">.=</span><span class="string">"file=</span><span class="default">$file</span><span class="string">, line=</span><span class="default">$line</span><span class="string">, function=</span><span class="default">$function</span><span class="string">&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; } 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">.=</span><span class="string">"&lt;br&gt;"</span><span class="keyword">.</span><span class="default">backTrace</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">)==</span><span class="string">"XXX "</span><span class="keyword">) </span><span class="comment">// special errrors when db is inaccessible
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"&lt;br&gt;"</span><span class="keyword">,</span><span class="string">"\n"</span><span class="keyword">,</span><span class="default">$out</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"&amp;nbsp;"</span><span class="keyword">,</span><span class="string">" "</span><span class="keyword">,</span><span class="default">$out</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">mail</span><span class="keyword">(</span><span class="string">"me@example.com"</span><span class="keyword">,</span><span class="string">"Database Execution Error for user "</span><span class="keyword">.</span><span class="default">$REMOTE_ADDR</span><span class="keyword">,</span><span class="string">"</span><span class="default">$out</span><span class="string">"</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit(</span><span class="string">"Database Access Error. Please try again later."</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mail</span><span class="keyword">(</span><span class="string">"me@example.com"</span><span class="keyword">,</span><span class="string">'Error Monitor'</span><span class="keyword">,</span><span class="string">'Execution Error'</span><span class="keyword">,</span><span class="default">$out</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; exit(</span><span class="string">"DANG! An execution error in the program has been sent to the webmaster. 
<br />
If you don't get an email from him soon, please call him."</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
This produces an output like this
<br />

<br />
&nbsp;file=badmode.php, line=5, function=backTrace
<br />
&nbsp; file=login.php, line=209, function=require
<br />
&nbsp;&nbsp; file=midScreen.php, line=264, function=require
<br />
&nbsp;&nbsp;&nbsp; file=masterindex.php, line=161, function=require
<br />
&nbsp;&nbsp; &nbsp; file=production2.php, line=121, function=require
<br />
&nbsp;&nbsp; &nbsp;&nbsp; file=index.php, line=16, function=require</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94156""></a>
  <div class="note">
   <strong class="user">michael dot schramm at gmail dot com</strong>
   <a href="#94156" class="date">20-Oct-2009 09:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be carefull if you are using objects as arguments for function calls!<br />
<br />
<span class="default">&lt;?php<br />
error_reporting</span><span class="keyword">(</span><span class="default">E_ALL</span><span class="keyword">);<br />
<br />
function </span><span class="default">myPrint</span><span class="keyword">(</span><span class="default">$trace</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$trace </span><span class="keyword">as </span><span class="default">$i</span><span class="keyword">=&gt;</span><span class="default">$call</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * THIS IS NEEDED! If all your objects have a __toString function it's not needed!<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * Catchable fatal error: Object of class B could not be converted to string<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * Catchable fatal error: Object of class A could not be converted to string<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; * Catchable fatal error: Object of class B could not be converted to string<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$call</span><span class="keyword">[</span><span class="string">'object'</span><span class="keyword">])) { </span><span class="default">$call</span><span class="keyword">[</span><span class="string">'object'</span><span class="keyword">] = </span><span class="string">'CONVERTED OBJECT OF CLASS '</span><span class="keyword">.</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$call</span><span class="keyword">[</span><span class="string">'object'</span><span class="keyword">]); }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$call</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$call</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">] AS &amp;</span><span class="default">$arg</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">)) { </span><span class="default">$arg </span><span class="keyword">= </span><span class="string">'CONVERTED OBJECT OF CLASS '</span><span class="keyword">.</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$arg</span><span class="keyword">); }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trace_text</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="string">"#"</span><span class="keyword">.</span><span class="default">$i</span><span class="keyword">.</span><span class="string">" "</span><span class="keyword">.</span><span class="default">$call</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">].</span><span class="string">'('</span><span class="keyword">.</span><span class="default">$call</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">].</span><span class="string">') '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trace_text</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].= (!empty(</span><span class="default">$call</span><span class="keyword">[</span><span class="string">'object'</span><span class="keyword">])?</span><span class="default">$call</span><span class="keyword">[</span><span class="string">'object'</span><span class="keyword">].</span><span class="default">$call</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">]:</span><span class="string">''</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trace_text</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].= </span><span class="default">$call</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">].</span><span class="string">'('</span><span class="keyword">.</span><span class="default">implode</span><span class="keyword">(</span><span class="string">', '</span><span class="keyword">,</span><span class="default">$call</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">]).</span><span class="string">')'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$trace_text</span><span class="keyword">);<br />
}<br />
<br />
class </span><span class="default">A</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">test</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">B</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">test</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">myPrint</span><span class="keyword">(</span><span class="default">debug_backtrace</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$A </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">();<br />
</span><span class="default">$B </span><span class="keyword">= new </span><span class="default">B</span><span class="keyword">();<br />
<br />
</span><span class="default">$A</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">(</span><span class="default">$B</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83033""></a>
  <div class="note">
   <strong class="user">frank at frank dot com</strong>
   <a href="#83033" class="date">07-May-2008 08:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is my simple example:<br />
Code printing variable of class which instatiates the printing class.<br />
<br />
Well, I am sure you understand when looking at the code:<br />
Print result is: jippii<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">A </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; function </span><span class="default">something</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$callingObject </span><span class="keyword">= </span><span class="default">$s</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'object'</span><span class="keyword">]; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$test </span><span class="keyword">= </span><span class="default">$callingObject</span><span class="keyword">-&gt;</span><span class="default">jip</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="default">$test</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
}<br />
<br />
class </span><span class="default">B </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp;&nbsp; var </span><span class="default">$jip</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; function </span><span class="default">execute</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a </span><span class="keyword">= new </span><span class="default">A</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">jip </span><span class="keyword">= </span><span class="string">"jippii"</span><span class="keyword">;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">-&gt;</span><span class="default">something</span><span class="keyword">(); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">$control </span><span class="keyword">= new </span><span class="default">B</span><span class="keyword">();<br />
</span><span class="default">$control</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81013""></a>
  <div class="note">
   <strong class="user">samthor</strong>
   <a href="#81013" class="date">11-Feb-2008 09:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a way to get the arguments for an upstream function in your stack (works with class methods, static methods and non-class methods):<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* getArgs - find arguments of upstream method<br />
&nbsp;* can be called with, e.g. "funcname", "class::staticmethod", "class-&gt;instancemethod".<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">getArgs</span><span class="keyword">( </span><span class="default">$target</span><span class="keyword">, </span><span class="default">$subclass_ok </span><span class="keyword">= </span><span class="default">true </span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$target</span><span class="keyword">, </span><span class="string">"::" </span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; list( </span><span class="default">$class</span><span class="keyword">, </span><span class="default">$target </span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">( </span><span class="string">"::"</span><span class="keyword">, </span><span class="default">$target</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="string">"::"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else if( </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$target</span><span class="keyword">, </span><span class="string">"-&gt;" </span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; list( </span><span class="default">$class</span><span class="keyword">, </span><span class="default">$target </span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">( </span><span class="string">"-&gt;"</span><span class="keyword">, </span><span class="default">$target</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="string">"-&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">and </span><span class="default">$class </span><span class="keyword">= new </span><span class="default">ReflectionClass</span><span class="keyword">( </span><span class="default">$class </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">debug_backtrace</span><span class="keyword">() as </span><span class="default">$obj </span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$obj</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] == </span><span class="default">$target </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$type </span><span class="keyword">and </span><span class="default">$obj</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">] == </span><span class="default">$type </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_cl </span><span class="keyword">= new </span><span class="default">ReflectionClass</span><span class="keyword">( </span><span class="default">$obj</span><span class="keyword">[</span><span class="string">'class'</span><span class="keyword">] );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$_cl</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">() == </span><span class="default">$class</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">() or ( </span><span class="default">$subclass_ok </span><span class="keyword">and </span><span class="default">$_cl</span><span class="keyword">-&gt;</span><span class="default">isSubclassOf</span><span class="keyword">( </span><span class="default">$class </span><span class="keyword">) ) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$obj</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset( </span><span class="default">$_cl </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if( !</span><span class="default">$type </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$obj</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">NULL</span><span class="keyword">;<br />
<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Some example usage:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Foo </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">test</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">= </span><span class="default">getArgs</span><span class="keyword">( </span><span class="string">"Foo-&gt;base" </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; print( </span><span class="string">"the parameter 'v' to my call of base was: </span><span class="keyword">{</span><span class="default">$args</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]}</span><span class="string">\n" </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">base</span><span class="keyword">( </span><span class="default">$v </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$f </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">();<br />
</span><span class="default">$f</span><span class="keyword">-&gt;</span><span class="default">base</span><span class="keyword">( </span><span class="default">713 </span><span class="keyword">); </span><span class="comment">// will print.. ".. my call of base was: 713"<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Trust me, there are some reasons for why you might want to do this :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80712""></a>
  <div class="note">
   <strong class="user">aryel at iku dot com dot br</strong>
   <a href="#80712" class="date">29-Jan-2008 11:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
An easy function to pull all details of the debug backtrace:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getDebugBacktrace</span><span class="keyword">(</span><span class="default">$NL </span><span class="keyword">= </span><span class="string">"&lt;BR&gt;"</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dbgTrace </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dbgMsg </span><span class="keyword">.= </span><span class="default">$NL</span><span class="keyword">.</span><span class="string">"Debug backtrace begin:</span><span class="default">$NL</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$dbgTrace </span><span class="keyword">as </span><span class="default">$dbgIndex </span><span class="keyword">=&gt; </span><span class="default">$dbgInfo</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dbgMsg </span><span class="keyword">.= </span><span class="string">"\t at </span><span class="default">$dbgIndex</span><span class="string">&nbsp; "</span><span class="keyword">.</span><span class="default">$dbgInfo</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">].</span><span class="string">" (line </span><span class="keyword">{</span><span class="default">$dbgInfo</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">]}</span><span class="string">) -&gt; </span><span class="keyword">{</span><span class="default">$dbgInfo</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">]}</span><span class="string">("</span><span class="keyword">.</span><span class="default">join</span><span class="keyword">(</span><span class="string">","</span><span class="keyword">,</span><span class="default">$dbgInfo</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">])</span><span class="string">")</span><span class="default">$NL</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dbgMsg </span><span class="keyword">.= </span><span class="string">"Debug backtrace end"</span><span class="keyword">.</span><span class="default">$NL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$dbgMsg</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Then you can call it anywhere you want to get a string with the debug backtrace in readable format (i.e. your error handling function)<br />
<br />
<span class="default">&lt;?php<br />
$backtrace </span><span class="keyword">= </span><span class="default">getDebugBacktrace</span><span class="keyword">();<br />
echo </span><span class="string">"Fatal error! Cannot connect to database!"</span><span class="keyword">;<br />
echo </span><span class="default">$backtrace</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
If you're running on command line, you might want to replace the line split. You can do that thru the function argument:<br />
<br />
<span class="default">&lt;?php<br />
$backtrace </span><span class="keyword">= </span><span class="default">getDebugBacktrace</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">);<br />
echo </span><span class="string">"Error! Server is running out of foos! Dumping error backtrace"</span><span class="keyword">;<br />
echo </span><span class="default">$backtrace</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope that helps,<br />
Aryel</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75892""></a>
  <div class="note">
   <strong class="user">php at kennel17 dot co dot uk</strong>
   <a href="#75892" class="date">20-Jun-2007 06:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Further to my previous note, the 'object' element of the array can be used to get the parent object.&nbsp; So changing the get_class_static() function to the following will make the code behave as expected:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">get_class_static</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bt </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'object'</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$bt</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'object'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'class'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
HOWEVER, it still fails when being called statically.&nbsp; Changing the last two lines of my previous example to<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; foo</span><span class="keyword">::</span><span class="default">printClassName</span><span class="keyword">();<br />
&nbsp; </span><span class="default">bar</span><span class="keyword">::</span><span class="default">printClassName</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
...still gives the same problematic result in PHP5, but in this case the 'object' property is not set, so that technique is unavailable.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75890""></a>
  <div class="note">
   <strong class="user">php at kennel17 dot co dot uk</strong>
   <a href="#75890" class="date">20-Jun-2007 06:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The value of the class argument has changed slightly between PHP4 and PHP5:<br />
<br />
Here's an example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp; </span><span class="keyword">function </span><span class="default">get_class_static</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bt </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'class'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$name</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; class </span><span class="default">foo </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">printClassName</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp;&nbsp; print(</span><span class="default">get_class_static</span><span class="keyword">() . </span><span class="string">"\n"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; }<br />
&nbsp; }<br />
<br />
&nbsp; class </span><span class="default">bar </span><span class="keyword">extends </span><span class="default">foo </span><span class="keyword">{<br />
&nbsp; }<br />
<br />
</span><span class="default">$f </span><span class="keyword">= new </span><span class="default">foo</span><span class="keyword">();<br />
</span><span class="default">$b </span><span class="keyword">= new </span><span class="default">bar</span><span class="keyword">();<br />
</span><span class="default">$f</span><span class="keyword">-&gt;</span><span class="default">printClassName</span><span class="keyword">();<br />
</span><span class="default">$b</span><span class="keyword">-&gt;</span><span class="default">printClassName</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
In PHP4 you get:<br />
<br />
&nbsp; foo<br />
&nbsp; bar<br />
<br />
In PHP5 you get:<br />
<br />
&nbsp; foo<br />
&nbsp; foo<br />
<br />
debug_backtrace() now sets the 'class' parameter to be the class that the function is actually defined in, not the name of the instantiated class.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75456""></a>
  <div class="note">
   <strong class="user">jsnell at e-normous dot com</strong>
   <a href="#75456" class="date">30-May-2007 11:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using the backtrace function in an error handler, avoid using var_export() on the args, as you will cause fatal errors in some situations, preventing you from seeing your stack trace.&nbsp; Some structures will cause PHP to generate the fatal error "Nesting level too deep - recursive dependency?" This is a design feature of php, not a bug (see <a href="http://bugs.php.net/bug.php?id=30471" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=30471</a>)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72534""></a>
  <div class="note">
   <strong class="user">kroczu AT interia DOT pl</strong>
   <a href="#72534" class="date">23-Jan-2007 07:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&lt;?<br />
// useful and comfortable debug function<br />
// it's show memory usage and time flow between calls, so we can quickly find a block of code that need optimisation...<br />
// example result:<br />
/*<br />
debug example.php&gt; initialize<br />
debug example.php&gt; code-lines: 39-41 time: 2.0002 mem: 19 KB<br />
debug example.php&gt; code-lines: 41-44 time: 0.0000 mem: 19 KB<br />
debug example.php&gt; code-lines: 44-51 time: 0.6343 mem: 9117 KB<br />
debug example.php&gt; code-lines: 51-53 time: 0.1003 mem: 9117 KB<br />
debug example.php&gt; code-lines: 53-55 time: 0.0595 mem: 49 KB<br />
&nbsp;*/<br />
<br />
function debug()<br />
{<br />
&nbsp;&nbsp; static $start_time = NULL;<br />
&nbsp;&nbsp; static $start_code_line = 0;<br />
<br />
&nbsp;&nbsp; $call_info = array_shift( debug_backtrace() );<br />
&nbsp;&nbsp; $code_line = $call_info['line'];<br />
&nbsp;&nbsp; $file = array_pop( explode('/', $call_info['file']));<br />
<br />
&nbsp;&nbsp; if( $start_time === NULL )<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; print "debug ".$file."&gt; initialize\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; $start_time = time() + microtime();<br />
&nbsp;&nbsp; &nbsp; &nbsp; $start_code_line = $code_line;<br />
&nbsp;&nbsp; &nbsp; &nbsp; return 0;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; printf("debug %s&gt; code-lines: %d-%d time: %.4f mem: %d KB\n", $file, $start_code_line, $code_line, (time() + microtime() - $start_time), ceil( memory_get_usage()/1024));<br />
&nbsp;&nbsp; $start_time = time() + microtime();<br />
&nbsp;&nbsp; $start_code_line = $code_line;<br />
}<br />
<br />
////////////////////////////////////////////////<br />
// example:<br />
<br />
debug();<br />
sleep(2);<br />
debug();<br />
// soft-code...<br />
$a = 3 + 5;<br />
debug();<br />
<br />
// hard-code<br />
for( $i=0; $i&lt;100000; $i++)<br />
{<br />
&nbsp;&nbsp;&nbsp; $dummy['alamakota'.$i] = 'alamakota'.$i;<br />
}<br />
debug();<br />
usleep(100000);<br />
debug();<br />
unset($dummy);<br />
debug();<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71770""></a>
  <div class="note">
   <strong class="user">seaside dot ki at mac dot com</strong>
   <a href="#71770" class="date">15-Dec-2006 01:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've started creating an external debug server for PHP. A PHP app require_once's a TADebugger(), which communicates with the debug sever. Find the OS X universal binary here [PHP source sample included]:<br />
<br />
&nbsp;&nbsp; <a href="http://www.turingart.com/downloads/phpDebugger.zip" rel="nofollow" target="_blank">http://www.turingart.com/downloads/phpDebugger.zip</a><br />
<br />
Currently, TADebugger allows to post these properties back to the debug server:<br />
<br />
- Call backtraces<br />
- String messages<br />
- Source files, which were referenced by a backtrace call<br />
<br />
Note, that the binary is a early version.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69854""></a>
  <div class="note">
   <strong class="user">icefragment at gmail dot com</strong>
   <a href="#69854" class="date">23-Sep-2006 06:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple python-like backtrace. Note that I don't recurse into arrays if they are passed as arguments to functions.<br />
<br />
function backtrace()<br />
{<br />
&nbsp;&nbsp;&nbsp; $bt = debug_backtrace();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo("&lt;br /&gt;&lt;br /&gt;Backtrace (most recent call last):&lt;br /&gt;&lt;br /&gt;\n");&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; for($i = 0; $i &lt;= count($bt) - 1; $i++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!isset($bt[$i]["file"]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo("[PHP core called function]&lt;br /&gt;");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo("File: ".$bt[$i]["file"]."&lt;br /&gt;");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(isset($bt[$i]["line"]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo("&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;line ".$bt[$i]["line"]."&lt;br /&gt;");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo("&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;function called: ".$bt[$i]["function"]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if($bt[$i]["args"])<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo("&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;args: ");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for($j = 0; $j &lt;= count($bt[$i]["args"]) - 1; $j++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(is_array($bt[$i]["args"][$j]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print_r($bt[$i]["args"][$j]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo($bt[$i]["args"][$j]);&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if($j != count($bt[$i]["args"]) - 1)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo(", ");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo("&lt;br /&gt;&lt;br /&gt;");<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69786""></a>
  <div class="note">
   <strong class="user">zmorris at mac dot com</strong>
   <a href="#69786" class="date">21-Sep-2006 04:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi, I got tired of using a trace( $message, __FILE__, __LINE__ ) function I made.&nbsp; It forced me to include the file and line params (since php doesn't have macros) so I decided to make an alternative.<br />
<br />
Simply call this new version using trace( 'my message' ); and it prints out a stack trace in a clearer way than the one stored in the debug_backtrace() array.&nbsp; It handles traces from outside of functions, traces in nested functions, and traces in included files, and also displays the function in a way that can be pasted right back into your php code for faster testing!<br />
<br />
NOTE - be sure to save your files with the correct line endings for the line numbers to work correctly, which for Mac OS X is unix.&nbsp; You can get to this option in the popup menu in the toolbar at the top of each window in BBEdit.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function&nbsp; &nbsp; </span><span class="default">print_var</span><span class="keyword">( </span><span class="default">$var </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; if( </span><span class="default">is_string</span><span class="keyword">( </span><span class="default">$var </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; return( </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">str_replace</span><span class="keyword">( array(</span><span class="string">"\x00"</span><span class="keyword">, </span><span class="string">"\x0a"</span><span class="keyword">, </span><span class="string">"\x0d"</span><span class="keyword">, </span><span class="string">"\x1a"</span><span class="keyword">, </span><span class="string">"\x09"</span><span class="keyword">), array(</span><span class="string">'\0'</span><span class="keyword">, </span><span class="string">'\n'</span><span class="keyword">, </span><span class="string">'\r'</span><span class="keyword">, </span><span class="string">'\Z'</span><span class="keyword">, </span><span class="string">'\t'</span><span class="keyword">), </span><span class="default">$var </span><span class="keyword">).</span><span class="string">'"' </span><span class="keyword">);<br />
&nbsp;&nbsp; else if( </span><span class="default">is_bool</span><span class="keyword">( </span><span class="default">$var </span><span class="keyword">) )<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; if( </span><span class="default">$var </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return( </span><span class="string">'true' </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return( </span><span class="string">'false' </span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; else if( </span><span class="default">is_array</span><span class="keyword">( </span><span class="default">$var </span><span class="keyword">) )<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="string">'array( '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$comma </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; foreach( </span><span class="default">$var </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">.= </span><span class="default">$comma</span><span class="keyword">.</span><span class="default">print_var</span><span class="keyword">( </span><span class="default">$key </span><span class="keyword">).</span><span class="string">' =&gt; '</span><span class="keyword">.</span><span class="default">print_var</span><span class="keyword">( </span><span class="default">$val </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$comma </span><span class="keyword">= </span><span class="string">', '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">.= </span><span class="string">' )'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; return( </span><span class="default">$result </span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; return( </span><span class="default">var_export</span><span class="keyword">( </span><span class="default">$var</span><span class="keyword">, </span><span class="default">true </span><span class="keyword">) );&nbsp; &nbsp; </span><span class="comment">// anything else, just let php try to print it<br />
</span><span class="keyword">}<br />
<br />
function&nbsp; &nbsp; </span><span class="default">trace</span><span class="keyword">( </span><span class="default">$msg </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; echo </span><span class="string">"&lt;pre&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; </span><span class="comment">//var_export( debug_backtrace() ); echo "&lt;/pre&gt;\n"; return;&nbsp; &nbsp; // this line shows what is going on underneath<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; </span><span class="default">$trace </span><span class="keyword">= </span><span class="default">array_reverse</span><span class="keyword">( </span><span class="default">debug_backtrace</span><span class="keyword">() );<br />
&nbsp;&nbsp; </span><span class="default">$indent </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; echo </span><span class="default">$msg</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; foreach( </span><span class="default">$trace </span><span class="keyword">as </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; echo </span><span class="default">$indent</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">].</span><span class="string">' on line '</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; if( </span><span class="default">$func </span><span class="keyword">) echo </span><span class="string">' in function '</span><span class="keyword">.</span><span class="default">$func</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; if( </span><span class="default">$val</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] == </span><span class="string">'include' </span><span class="keyword">||<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$val</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] == </span><span class="string">'require' </span><span class="keyword">||<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$val</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] == </span><span class="string">'include_once' </span><span class="keyword">||<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$val</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">] == </span><span class="string">'require_once' </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="default">$val</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">].</span><span class="string">'('</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if( isset( </span><span class="default">$val</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$func </span><span class="keyword">.= </span><span class="string">' '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$comma </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach( </span><span class="default">$val</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">] as </span><span class="default">$val </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$func </span><span class="keyword">.= </span><span class="default">$comma</span><span class="keyword">.</span><span class="default">print_var</span><span class="keyword">( </span><span class="default">$val </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$comma </span><span class="keyword">= </span><span class="string">', '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$func </span><span class="keyword">.= </span><span class="string">' '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$func </span><span class="keyword">.= </span><span class="string">')'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; echo </span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$indent </span><span class="keyword">.= </span><span class="string">"\t"</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; echo </span><span class="string">"&lt;/pre&gt;\n"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">trace</span><span class="keyword">( </span><span class="string">'error outside function' </span><span class="keyword">);<br />
<br />
function&nbsp; &nbsp; </span><span class="default">test</span><span class="keyword">( </span><span class="default">$param1</span><span class="keyword">, </span><span class="default">$param2</span><span class="keyword">, </span><span class="default">$param3</span><span class="keyword">, </span><span class="default">$param4 </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; </span><span class="default">trace</span><span class="keyword">( </span><span class="string">'error in test()' </span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">test</span><span class="keyword">( </span><span class="default">1.1</span><span class="keyword">, </span><span class="string">"param2\n"</span><span class="keyword">, array( </span><span class="default">1 </span><span class="keyword">=&gt; </span><span class="string">"a\n"</span><span class="keyword">, </span><span class="string">"b\n" </span><span class="keyword">=&gt; </span><span class="default">2 </span><span class="keyword">), </span><span class="default">false </span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68850""></a>
  <div class="note">
   <strong class="user">admin at sgssweb dot com</strong>
   <a href="#68850" class="date">13-Aug-2006 11:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Surprizingly, debug_backtrace() cannot aquire arguments from the function that is used as the second or later argument of a function.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">a</span><span class="keyword">(</span><span class="default">$p</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$backtrace </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$backtrace</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">'args'</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">var_export</span><span class="keyword">(</span><span class="default">$backtrace</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="string">'args'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Cannot aquire arguments"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$p</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">b</span><span class="keyword">(</span><span class="default">$p1</span><span class="keyword">, </span><span class="default">$p2</span><span class="keyword">, </span><span class="default">$p3</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$p1</span><span class="string">, </span><span class="default">$p2</span><span class="string">, </span><span class="default">$p3</span><span class="string">"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// This outputs:<br />
//&nbsp; &nbsp; array ( 0 =&gt; 'First a', )<br />
//&nbsp; &nbsp; Cannot aquire arguments<br />
//&nbsp; &nbsp; Cannot aquire arguments<br />
//&nbsp; &nbsp; First a, Second a, Third a<br />
</span><span class="default">b</span><span class="keyword">(</span><span class="default">a</span><span class="keyword">(</span><span class="string">"First a"</span><span class="keyword">), </span><span class="default">a</span><span class="keyword">(</span><span class="string">"Second a"</span><span class="keyword">), </span><span class="default">a</span><span class="keyword">(</span><span class="string">"Third a"</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65433""></a>
  <div class="note">
   <strong class="user">tiwen at rpgame dot de</strong>
   <a href="#65433" class="date">30-Apr-2006 10:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another debug output. This is a short function that does not display the args (sometimes password are in arguments ...) and shows the callstack clearly in a table. In most cases i don't need more ...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">dieDebug</span><span class="keyword">(</span><span class="default">$sError</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;hr /&gt;&lt;div&gt;"</span><span class="keyword">.</span><span class="default">$sError</span><span class="keyword">.</span><span class="string">"&lt;br /&gt;&lt;table border='1'&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sOut</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">; </span><span class="default">$aCallstack</span><span class="keyword">=</span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;thead&gt;&lt;tr&gt;&lt;th&gt;file&lt;/th&gt;&lt;th&gt;line&lt;/th&gt;&lt;th&gt;function&lt;/th&gt;"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;/tr&gt;&lt;/thead&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$aCallstack </span><span class="keyword">as </span><span class="default">$aCall</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$aCall</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">])) </span><span class="default">$aCall</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">] = </span><span class="string">'[PHP Kernel]'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$aCall</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">])) </span><span class="default">$aCall</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;&lt;td&gt;</span><span class="keyword">{</span><span class="default">$aCall</span><span class="keyword">[</span><span class="string">"file"</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;&lt;td&gt;</span><span class="keyword">{</span><span class="default">$aCall</span><span class="keyword">[</span><span class="string">"line"</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;td&gt;</span><span class="keyword">{</span><span class="default">$aCall</span><span class="keyword">[</span><span class="string">"function"</span><span class="keyword">]}</span><span class="string">&lt;/td&gt;&lt;/tr&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;/table&gt;&lt;/div&gt;&lt;hr /&gt;&lt;/p&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; die();<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
To use it, simply do something like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(...) </span><span class="default">dieDebug</span><span class="keyword">(</span><span class="string">"another error found!"</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59713""></a>
  <div class="note">
   <strong class="user">http://synergy8.com</strong>
   <a href="#59713" class="date">14-Dec-2005 07:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that if an internal php function such as call_user_func in the backtrace, the 'file' and 'line' entries will not be set.<br />
<br />
Most debug tracers will use these entries.&nbsp; You should place a check to see if the key exists in the array before using this function.&nbsp; Otherwise notices will be generated.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$arrTrace </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
<br />
foreach (</span><span class="default">$arrTrace </span><span class="keyword">as </span><span class="default">$arr</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (!isset (</span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">]))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">] = </span><span class="string">'[PHP Kernel]'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if (!isset (</span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">]))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Do something<br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54993""></a>
  <div class="note">
   <strong class="user">tb</strong>
   <a href="#54993" class="date">21-Jul-2005 08:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use this for debugging in my object oriented systems.&nbsp; It allows me to output a debug/error/warning function with exact information about the location that the error was thrown, which is useful.&nbsp; Check it:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">abstract class </span><span class="default">Debugger </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Throw a debug message.<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">abstract function </span><span class="default">debug</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Throw an error message.<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">abstract function </span><span class="default">error</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Throw a warning message.<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">abstract function </span><span class="default">warning</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Wrap a message with information about class, function, file and line<br />
&nbsp;&nbsp; &nbsp; * number and return it.<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected function </span><span class="default">getMsg</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bt </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// get class, function called by caller of caller of caller<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class </span><span class="keyword">= </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="string">'class'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$function </span><span class="keyword">= </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="string">'function'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// get file, line where call to caller of caller was made<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'file'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">$bt</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="string">'line'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// build &amp; return the message<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="string">"</span><span class="default">$class</span><span class="string">::</span><span class="default">$function</span><span class="string">: </span><span class="default">$msg</span><span class="string"> in </span><span class="default">$file</span><span class="string"> at </span><span class="default">$line</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Implement different debuggers for different scenarios (development, testing, production).&nbsp; Each debugger extends Debugger; each of its methods (debug/error/warning) calls $this-&gt;getMsg($msg) to get a message with class, function, file, and line information.&nbsp; Then it can either log it, email it, die with it, etc.<br />
<br />
Then, just give each object (perhaps using a common superclass Object) a concrete debugger.&nbsp; Then, from any object method, do something like:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Foo </span><span class="keyword">extends </span><span class="default">Object </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; function </span><span class="default">bar</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">debugger</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">(</span><span class="string">"This is an error"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Which produces something like:<br />
<br />
Foo::bar: This is an error in /some/file at X</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47658""></a>
  <div class="note">
   <strong class="user">diz at ysagoon dot com</strong>
   <a href="#47658" class="date">24-Nov-2004 11:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Ok as spagmoid already said, I just realized that my function has a similar bug than jlim's function.<br />
<br />
So just add the following line:<br />
if (is_array($bt['args']))<br />
before line:<br />
foreach ($bt['args'] as $a) {<br />
<br />
This way you avoid the warning from being displayed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47644""></a>
  <div class="note">
   <strong class="user">diz at ysagoon dot com</strong>
   <a href="#47644" class="date">23-Nov-2004 11:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
And here are my two cents for a useful and good looking backtrace function.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">backtrace</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="string">"&lt;div style='text-align: left; font-family: monospace;'&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">"&lt;b&gt;Backtrace:&lt;/b&gt;&lt;br /&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$backtrace </span><span class="keyword">= </span><span class="default">debug_backtrace</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$backtrace </span><span class="keyword">as </span><span class="default">$bt</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$bt</span><span class="keyword">[</span><span class="string">'args'</span><span class="keyword">] as </span><span class="default">$a</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$args</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">.= </span><span class="string">', '</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'integer'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'double'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">.= </span><span class="default">$a</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'string'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a </span><span class="keyword">= </span><span class="default">htmlspecialchars</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">64</span><span class="keyword">)).((</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">) &gt; </span><span class="default">64</span><span class="keyword">) ? </span><span class="string">'...' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">.= </span><span class="string">"\"</span><span class="default">$a</span><span class="string">\""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'array'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">.= </span><span class="string">'Array('</span><span class="keyword">.</span><span class="default">count</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">).</span><span class="string">')'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'object'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">.= </span><span class="string">'Object('</span><span class="keyword">.</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">).</span><span class="string">')'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'resource'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">.= </span><span class="string">'Resource('</span><span class="keyword">.</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="string">'#'</span><span class="keyword">).</span><span class="string">')'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'boolean'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">.= </span><span class="default">$a </span><span class="keyword">? </span><span class="string">'True' </span><span class="keyword">: </span><span class="string">'False'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'NULL'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">.= </span><span class="string">'Null'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">.= </span><span class="string">'Unknown'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">"&lt;br /&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">"&lt;b&gt;file:&lt;/b&gt; </span><span class="keyword">{</span><span class="default">$bt</span><span class="keyword">[</span><span class="string">'line'</span><span class="keyword">]}</span><span class="string"> - </span><span class="keyword">{</span><span class="default">$bt</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">]}</span><span class="string">&lt;br /&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">"&lt;b&gt;call:&lt;/b&gt; </span><span class="keyword">{</span><span class="default">$bt</span><span class="keyword">[</span><span class="string">'class'</span><span class="keyword">]}{</span><span class="default">$bt</span><span class="keyword">[</span><span class="string">'type'</span><span class="keyword">]}{</span><span class="default">$bt</span><span class="keyword">[</span><span class="string">'function'</span><span class="keyword">]}</span><span class="string">(</span><span class="default">$args</span><span class="string">)&lt;br /&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="string">"&lt;/div&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$output</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
And here's a sample of how the output looks like (the last call is on the top):<br />
<br />
Backtrace:<br />
<br />
file: 56 - /tmp/test.php<br />
call: backtrace()<br />
<br />
file: 53 - /tmp/test.php<br />
call: test-&gt;bar(15.4, Array(4))<br />
<br />
file: 61 - /tmp/test.php<br />
call: test-&gt;test("making new object", True)<br />
<br />
file: 65 - /tmp/test.php<br />
call: foo(Resource(#2), Null)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42041""></a>
  <div class="note">
   <strong class="user">ad-rotator.com</strong>
   <a href="#42041" class="date">30-Apr-2004 06:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To simply print out the file/function trace (chain of calls, file and line number before the error):<br />
<br />
function getTrace() {<br />
&nbsp;$vDebug = debug_backtrace();<br />
&nbsp;$vFiles = array();<br />
&nbsp;for ($i=0;$i&lt;count($vDebug);$i++) {<br />
&nbsp;&nbsp; // skip the first one, since it's always this func<br />
&nbsp;&nbsp; if ($i==0) { continue; }<br />
&nbsp;&nbsp; $aFile = $vDebug[$i];<br />
&nbsp;&nbsp; $vFiles[] = '('.basename($aFile['file']).':'.$aFile['line'].')';<br />
&nbsp;} // for<br />
&nbsp;$vTraceStr = implode(',',$vFiles);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38133""></a>
  <div class="note">
   <strong class="user">spagmoid at yahoo dot NOSPAMcom</strong>
   <a href="#38133" class="date">09-Dec-2003 08:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
ATTN: jlim#natsoft.com.my<br />
<br />
Great function, but you have a few bugs.<br />
<br />
At the line: <br />
foreach($arr['args'] as $v)<br />
<br />
Change it to:<br />
$args = array();<br />
if(!empty($arr['args'])) foreach($arr['args'] as $v)<br />
<br />
And since line &amp; file are not present in the array if calling from the error handler,<br />
<br />
$Line = (isset($arr['line'])? $arr['line'] : "unknown");<br />
$File = (isset($arr['file'])? $arr['file'] : "unknown");<br />
<br />
and substitute accordingly.<br />
<br />
Here's my version of it, alas with different formatting:<br />
----------------------------------------<br />
<br />
function DBG_GetBacktrace()<br />
{<br />
&nbsp;&nbsp;&nbsp; $s = '';<br />
&nbsp;&nbsp;&nbsp; $MAXSTRLEN = 64;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $s = '&lt;pre align=left&gt;';<br />
&nbsp;&nbsp;&nbsp; $traceArr = debug_backtrace();<br />
&nbsp;&nbsp;&nbsp; array_shift($traceArr);<br />
&nbsp;&nbsp;&nbsp; $tabs = sizeof($traceArr)-1;<br />
&nbsp;&nbsp;&nbsp; foreach($traceArr as $arr)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for ($i=0; $i &lt; $tabs; $i++) $s .= ' &amp;nbsp; ';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $tabs -= 1;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $s .= '&lt;font face="Courier New,Courier"&gt;';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset($arr['class'])) $s .= $arr['class'].'.';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $args = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!empty($arr['args'])) foreach($arr['args'] as $v)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (is_null($v)) $args[] = 'null';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (is_array($v)) $args[] = 'Array['.sizeof($v).']';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (is_object($v)) $args[] = 'Object:'.get_class($v);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (is_bool($v)) $args[] = $v ? 'true' : 'false';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $v = (string) @$v;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $str = htmlspecialchars(substr($v,0,$MAXSTRLEN));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (strlen($v) &gt; $MAXSTRLEN) $str .= '...';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $args[] = "\"".$str."\"";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $s .= $arr['function'].'('.implode(', ',$args).')&lt;/font&gt;';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $Line = (isset($arr['line'])? $arr['line'] : "unknown");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $File = (isset($arr['file'])? $arr['file'] : "unknown");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $s .= sprintf("&lt;font color=#808080 size=-1&gt; # line %4d, file: &lt;a href=\"file:/%s\"&gt;%s&lt;/a&gt;&lt;/font&gt;",<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $Line, $File, $File);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $s .= "\n";<br />
&nbsp;&nbsp;&nbsp; }&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; $s .= '&lt;/pre&gt;';<br />
&nbsp;&nbsp;&nbsp; return $s;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35437""></a>
  <div class="note">
   <strong class="user">Fabian dot Kraetzer at gmx dot de</strong>
   <a href="#35437" class="date">01-Sep-2003 03:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I coded a function, too. Just call debug() evertime you think you could encounter an error:<br />
&lt;?<br />
&nbsp;&nbsp;&nbsp; function debug()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $debug_array = debug_backtrace();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $counter = count($debug_array);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for($tmp_counter = 0; $tmp_counter != $counter; ++$tmp_counter)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ?&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;table width="558" height="116" border="1" cellpadding="0" cellspacing="0" bordercolor="#000000"&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;tr&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;td height="38" bgcolor="#D6D7FC"&gt;&lt;font color="#000000"&gt;function &lt;font color="#FF3300"&gt;&lt;?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo($debug_array[$tmp_counter]["function"]);?&gt;(&lt;/font&gt; &lt;font color="#2020F0"&gt;&lt;?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //count how many args a there<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $args_counter = count($debug_array[$tmp_counter]["args"]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //print them<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for($tmp_args_counter = 0; $tmp_args_counter != $args_counter; ++$tmp_args_counter)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo($debug_array[$tmp_counter]["args"][$tmp_args_counter]);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(($tmp_args_counter + 1) != $args_counter)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo(", ");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo(" ");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ?&gt;&lt;/font&gt;&lt;font color="#FF3300"&gt;)&lt;/font&gt;&lt;/font&gt;&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;/tr&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;tr&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;td bgcolor="#5F72FA"&gt;&lt;font color="#FFFFFF"&gt;{&lt;/font&gt;&lt;br&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;font color="#FFFFFF"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;file: &lt;?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo($debug_array[$tmp_counter]["file"]);?&gt;&lt;/font&gt;&lt;br&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;font color="#FFFFFF"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;line: &lt;?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo($debug_array[$tmp_counter]["line"]);?&gt;&lt;/font&gt;&lt;br&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;font color="#FFFFFF"&gt;}&lt;/font&gt;&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;/tr&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;/table&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if(($tmp_counter + 1) != $counter)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo("&lt;br&gt;was called by:&lt;br&gt;");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit();<br />
&nbsp;&nbsp;&nbsp; }<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="34843""></a>
  <div class="note">
   <strong class="user">bernyregeling AT hotmail DOT com</strong>
   <a href="#34843" class="date">08-Aug-2003 01:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote this function, in addition to jlim, for a nice NO-HTML output. 
<br />

<br />
Thee result has similarities to a Java-error. Hope you like it. 
<br />

<br />
(BTW, this function exits the script too, if debug_backtrace is displayed)
<br />
------------------------------
<br />
&nbsp;&nbsp;&nbsp; function debug_bt()
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!function_exists('debug_backtrace'))
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo 'function debug_backtrace does not exists'."\r\n";
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //echo '&lt;pre&gt;';
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "\r\n".'----------------'."\r\n";
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo 'Debug backtrace:'."\r\n";
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo '----------------'."\r\n";
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(debug_backtrace() as $t)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo "\t" . '@ ';
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset($t['file'])) echo basename($t['file']) . ':' . $t['line'];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // if file was not set, I assumed the functioncall
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // was from PHP compiled source (ie XML-callbacks).
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo '&lt;PHP inner-code&gt;';
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo ' -- ';
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset($t['class'])) echo $t['class'] . $t['type'];
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo $t['function'];
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset($t['args']) &amp;&amp; sizeof($t['args']) &gt; 0) echo '(...)';
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else echo '()';
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo "\r\n";
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //echo '&lt;/pre&gt;';
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30296""></a>
  <div class="note">
   <strong class="user">jlim#natsoft.com.my</strong>
   <a href="#30296" class="date">13-Mar-2003 02:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Pretty print the backtrace(). Functions are indented based on call value, and file is linked using file:// for convenience. <br />
<br />
Enjoy, John Lim<br />
<br />
&nbsp;&nbsp;&nbsp; function adodb_backtrace($print=true)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $s = '';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (PHPVERSION() &gt;= 4.3) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $MAXSTRLEN = 64;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $s = '&lt;pre align=left&gt;';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $traceArr = debug_backtrace();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array_shift($traceArr);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tabs = sizeof($traceArr)-1;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach ($traceArr as $arr) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for ($i=0; $i &lt; $tabs; $i++) $s .= ' &amp;nbsp; ';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $tabs -= 1;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $s .= '&lt;font face="Courier New,Courier"&gt;';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (isset($arr['class'])) $s .= $arr['class'].'.';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach($arr['args'] as $v) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (is_null($v)) $args[] = 'null';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (is_array($v)) $args[] = 'Array['.sizeof($v).']';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (is_object($v)) $args[] = 'Object:'.get_class($v);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (is_bool($v)) $args[] = $v ? 'true' : 'false';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $v = (string) @$v;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $str = htmlspecialchars(substr($v,0,$MAXSTRLEN));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (strlen($v) &gt; $MAXSTRLEN) $str .= '...';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $args[] = $str;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $s .= $arr['function'].'('.implode(', ',$args).')';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $s .= sprintf("&lt;/font&gt;&lt;font color=#808080 size=-1&gt; # line %4d,".<br />
&nbsp; " file: &lt;a href=\"file:/%s\"&gt;%s&lt;/a&gt;&lt;/font&gt;",<br />
&nbsp; $arr['line'],$arr['file'],$arr['file']);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $s .= "\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $s .= '&lt;/pre&gt;';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($print) print $s;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $s;<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
