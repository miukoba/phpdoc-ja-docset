<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>新規の XSLT プロセッサを作成する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.xslt-backend-version.html">≪ xslt_backend_version</a></li>
      <li style="float: right;"><a href="function.xslt-errno.html">xslt_errno ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.xslt.html">XSLT (PHP 4) 関数</a></li>
    <li>新規の XSLT プロセッサを作成する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.xslt-create" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">xslt_create</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.3)</p><p class="refpurpose"><span class="refname">xslt_create</span> &mdash; <span class="dc-title">新規の XSLT プロセッサを作成する</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.xslt-create-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>xslt_create</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="para rdfs-comment">
   新規に XSLT プロセッサリソースを作成し、返します。このリソースは、
   他の XSLT 関数による処理で使用されます。
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.xslt-create-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <acronym title="eXtensible Stylesheet Language Transformations">XSLT</acronym> プロセッサリンク ID、
   エラー時に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.xslt-create-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-5632">
    <p><strong>例1 <span class="function"><strong>xslt_create()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">xml2html</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmldata</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$xsl</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;$xmldata&nbsp;-&gt;&nbsp;あなたの&nbsp;XML&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;$xsl&nbsp;-&gt;&nbsp;XSLT&nbsp;ファイル&nbsp;*/<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$path&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'include'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$arguments&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'/_xml'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$xmldata</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$xsltproc&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">xslt_create</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">xslt_set_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$xsltproc</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'ISO-8859-1'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$html&nbsp;</span><span style="color: #007700">=<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">xslt_process</span><span style="color: #007700">(</span><span style="color: #0000BB">$xsltproc</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'arg:/_xml'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$path</span><span style="color: #DD0000">/</span><span style="color: #0000BB">$xsl</span><span style="color: #DD0000">"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">NULL</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$arguments</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(empty(</span><span style="color: #0000BB">$html</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">'XSLT&nbsp;processing&nbsp;error:&nbsp;'</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">xslt_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$xsltproc</span><span style="color: #007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">xslt_free</span><span style="color: #007700">(</span><span style="color: #0000BB">$xsltproc</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$html</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.xslt-create-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.xslt-free.html" class="function" rel="rdfs-seeAlso">xslt_free()</a> - XSLT プロセッサを開放する</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="85390""></a>
  <div class="note">
   <strong class="user">LW</strong>
   <a href="#85390" class="date">28-Aug-2008 10:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello,<br />
<br />
I changed the function from myadzel (?) a little bit, so that it now correctly uses either a file OR a string as parameter - WITHOUT producing PHP warnings. See here:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">xslt </span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$xsl</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xh </span><span class="keyword">= @</span><span class="default">xslt_create</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$args</span><span class="keyword">[</span><span class="string">'xml'</span><span class="keyword">] = ( </span><span class="default">file_exists</span><span class="keyword">( </span><span class="default">$xml </span><span class="keyword">) )?</span><span class="default">join </span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="default">file </span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">)):</span><span class="default">$xml</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$args</span><span class="keyword">[</span><span class="string">'xsl'</span><span class="keyword">] = ( </span><span class="default">file_exists</span><span class="keyword">( </span><span class="default">$xsl </span><span class="keyword">) )?</span><span class="default">join </span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="default">file </span><span class="keyword">(</span><span class="default">$xsl</span><span class="keyword">)):</span><span class="default">$xsl</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// try with a string<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= @</span><span class="default">xslt_process </span><span class="keyword">(</span><span class="default">$xh</span><span class="keyword">, </span><span class="string">'arg:/xml'</span><span class="keyword">, </span><span class="string">'arg:/xsl'</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// try with resource<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$result</span><span class="keyword">) { </span><span class="default">$result </span><span class="keyword">= @</span><span class="default">xslt_process </span><span class="keyword">(</span><span class="default">$xh</span><span class="keyword">, </span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$xsl</span><span class="keyword">); }<br />
<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">xslt_free </span><span class="keyword">(</span><span class="default">$xh</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Examples:<br />
echo xslt ('./index.xml', './index.xsl');<br />
echo xslt ('&lt;test&gt;&lt;example&gt;An example!&lt;/example&gt;&lt;/test&gt;', './index.xsl');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83651""></a>
  <div class="note">
   <strong class="user">sxguard-1trail(At)yahoo dot com</strong>
   <a href="#83651" class="date">06-Jun-2008 05:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hardly can I find this. But, those required dll is not included in the package and no link for download. <br />
<br />
It's a pitty that no discussion about this within php.net<br />
<br />
&nbsp; Note&nbsp;&nbsp; to&nbsp;&nbsp; Win32&nbsp;&nbsp; Users:&nbsp; &nbsp;&nbsp; In&nbsp;&nbsp; order&nbsp;&nbsp; to&nbsp;&nbsp; enable&nbsp;&nbsp; this&nbsp;&nbsp; module&nbsp;&nbsp; on&nbsp;&nbsp; a&nbsp;&nbsp; Windows&nbsp;&nbsp; environment,&nbsp;&nbsp; you&nbsp;&nbsp; must&nbsp;&nbsp; copy&nbsp;&nbsp; several&nbsp;&nbsp; files&nbsp;&nbsp; from&nbsp;&nbsp; the&nbsp;&nbsp; DLL&nbsp;&nbsp; folder&nbsp;&nbsp; of&nbsp;&nbsp; the&nbsp;&nbsp; PHP/Win32&nbsp;&nbsp; binary&nbsp;&nbsp; package&nbsp;&nbsp; to&nbsp;&nbsp; the&nbsp;&nbsp; SYSTEM32&nbsp;&nbsp; folder&nbsp;&nbsp; of&nbsp;&nbsp; your&nbsp;&nbsp; windows&nbsp;&nbsp; machine.&nbsp;&nbsp; (Ex:&nbsp;&nbsp; C:\WINNT\SYSTEM32&nbsp;&nbsp; or&nbsp;&nbsp; C:\WINDOWS\SYSTEM32).&nbsp;&nbsp; For&nbsp;&nbsp; PHP&nbsp;&nbsp; &lt;=&nbsp;&nbsp; 4.2.0&nbsp;&nbsp; copy&nbsp;&nbsp; sablot.dll&nbsp; &nbsp;&nbsp; and&nbsp;&nbsp; expat.dll&nbsp;&nbsp; to&nbsp;&nbsp; your&nbsp;&nbsp; SYSTEM32&nbsp;&nbsp; folder.&nbsp;&nbsp; For&nbsp;&nbsp; PHP&nbsp;&nbsp; &gt;=&nbsp;&nbsp; 4.2.1&nbsp;&nbsp; copy&nbsp;&nbsp; sablot.dll,&nbsp;&nbsp; expat.dll&nbsp;&nbsp; and&nbsp;&nbsp; iconv.dll&nbsp;&nbsp; to&nbsp;&nbsp; your&nbsp;&nbsp; SYSTEM32&nbsp;&nbsp; folder.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74003""></a>
  <div class="note">
   <strong class="user">myadzel at gmail dot com</strong>
   <a href="#74003" class="date">20-Mar-2007 05:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
All for a long time know about a problem xslt-transformation in php.<br />
We shall try a trivial way, knowing, that xslt_process () accepts string or resources in it's parameters.<br />
<br />
function xslt ($xml, $xsl) {<br />
<br />
&nbsp;&nbsp;&nbsp; $xh = @xslt_create();<br />
<br />
&nbsp;&nbsp;&nbsp; $args['xml'] = join ('', file ($xml));<br />
&nbsp;&nbsp;&nbsp; $args['xsl'] = join ('', file ($xsl));<br />
<br />
&nbsp;&nbsp;&nbsp; // try with a string<br />
&nbsp;&nbsp;&nbsp; $result = @xslt_process ($xh, 'arg:/xml', 'arg:/xsl', NULL, $args);<br />
<br />
&nbsp;&nbsp;&nbsp; // try with resource<br />
&nbsp;&nbsp;&nbsp; if (!$result) { $result = @xslt_process ($xh, $xml, $xsl); }<br />
<br />
&nbsp;&nbsp;&nbsp; @xslt_free ($xh);<br />
&nbsp;&nbsp;&nbsp; return $result;<br />
<br />
}<br />
<br />
For example: echo xslt ('./index.xml', './index.xsl');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51372""></a>
  <div class="note">
   <strong class="user">Kerry Kobashi</strong>
   <a href="#51372" class="date">29-Mar-2005 04:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It should be noted that xslt_create() will return FALSE in the case of failure (Sablotron processor could not be created). <br />
<br />
This, obtained from looking at the source code extension.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35891""></a>
  <div class="note">
   <strong class="user">garth at webconexion dot net</strong>
   <a href="#35891" class="date">18-Sep-2003 02:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In order to pass PHP variables into an XSL document you need to do the following:<br />
<br />
Firstly I created the following function to use:<br />
<br />
function GetXHTML($sXML, $sXSL, $aParameters)<br />
{<br />
&nbsp;&nbsp;&nbsp; $hXML = xslt_create();<br />
&nbsp;&nbsp;&nbsp; $aArguments = array('/_xml' =&gt; $sXML, '/_xsl' =&gt; $sXSL);<br />
&nbsp;&nbsp;&nbsp; $sXHTML = xslt_process($hXML, 'arg:/_xml', 'arg:/_xsl', NULL, $aArguments, $aParameters);<br />
&nbsp;&nbsp;&nbsp; xslt_free($hXML);<br />
&nbsp;&nbsp;&nbsp; return $sXHTML;<br />
}<br />
<br />
Then call it like thus, passing the XML and XSL as a string with the final parameter being an array which can contain as many values as you wish to pass in:<br />
<br />
$sXHTML = GetXHTML($sXML, $sXSL, array("age"=&gt;"26"));<br />
<br />
Then in the XSL document you need the following:<br />
<br />
&lt;xsl:param name="age" /&gt;<br />
<br />
Then where you want to display the value of age you do this:<br />
<br />
&lt;xsl:value-of select="$age" /&gt;<br />
<br />
Thanks now.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
