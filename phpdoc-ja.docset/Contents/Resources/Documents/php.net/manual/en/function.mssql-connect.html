<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>MS SQL サーバー接続をオープンする</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mssql-close.html">≪ mssql_close</a></li>
      <li style="float: right;"><a href="function.mssql-data-seek.html">mssql_data_seek ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mssql.html">Mssql 関数</a></li>
    <li>MS SQL サーバー接続をオープンする</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mssql-connect" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mssql_connect</h1>
  <p class="verinfo">(PHP 4, PHP 5, PECL odbtp &gt;= 1.1.1)</p><p class="refpurpose"><span class="refname">mssql_connect</span> &mdash; <span class="dc-title">MS SQL サーバー接続をオープンする</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.mssql-connect-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>mssql_connect</strong></span>
    ([ <span class="methodparam"><span class="type">string</span> <code class="parameter">$servername</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$username</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$password</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$new_link</code><span class="initializer"> = false</span></span>
  ]]]] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>mssql_connect()</strong></span> はMS SQL サーバーへの接続を確立します。
  </p>
  <p class="para">
   サーバーへのリンクは、事前に <span class="function"><a href="function.mssql-close.html" class="function">mssql_close()</a></span> により
   明示的に閉じられていない限り、スクリプト終了後すぐに閉じられます。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mssql-connect-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">servername</code></dt>

     <dd>

      <p class="para">
       MS SQL サーバー。
       <em>hostname:port</em> (Linux) あるいは
       <em>hostname,port</em> (Windows)
       のようにしてポート番号を含めることもできます。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">username</code></dt>

     <dd>

      <p class="para">
       ユーザー名。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">password</code></dt>

     <dd>

      <p class="para">
       パスワード。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">new_link</code></dt>

     <dd>

      <p class="para">
       同じ引数で <span class="function"><strong>mssql_connect()</strong></span> が再度コールされた場合、
       新規のリンクは作成されず、代わりに既にオープンされたリンク ID が返されます。
       このパラメータは、この振る舞いを変更し、<span class="function"><strong>mssql_connect()</strong></span>
       が常に新しいリンクを返すようにします。同じパラメータで事前に
       <span class="function"><strong>mssql_connect()</strong></span> がコールされていたとしても、
       新しいリンクを返します。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mssql-connect-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功時に MS SQL リンク ID、エラー発生時に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.mssql-connect-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.1.0</td>
       <td>
        パラメータ <code class="parameter">new_link</code> が追加されました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mssql-connect-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-1602">
    <p><strong>例1 <span class="function"><strong>mssql_connect()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;サーバーの書式は&nbsp;&lt;computer&gt;\&lt;instance&nbsp;name&gt;、<br />//&nbsp;あるいはデフォルト以外のポートを使う場合は&nbsp;&lt;server&gt;,&lt;port&gt;&nbsp;となります<br /></span><span style="color: #0000BB">$server&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'KALLESPC\SQLEXPRESS'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;MSSQL&nbsp;に接続します<br /></span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mssql_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$server</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sa'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'phpfi'</span><span style="color: #007700">);<br /><br />if&nbsp;(!</span><span style="color: #0000BB">$link</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">'Something&nbsp;went&nbsp;wrong&nbsp;while&nbsp;connecting&nbsp;to&nbsp;MSSQL'</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mssql-connect-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mssql-close.html" class="function" rel="rdfs-seeAlso">mssql_close()</a> - MS SQL Server への接続を閉じる</span></li>
    <li class="member"><span class="function"><a href="function.mssql-pconnect.html" class="function" rel="rdfs-seeAlso">mssql_pconnect()</a> - 持続的 MS SQL 接続をオープンする</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111627""></a>
  <div class="note">
   <strong class="user">parikhnirav dot aits at gmail dot com</strong>
   <a href="#111627" class="date">10-Mar-2013 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Cent OS - Remote SQL server connection<br />
$link = mssql_connect(72.xx.xxx.xxx, username, password);<br />
<br />
If you are not getting success, please check <br />
<br />
There is certainly a php-mssql package available in the extras repository so just a `yum install php-mssql` should sort that out - it pulls in freetds as a dependency too. If you already have those installed but it doesn't seem to be connecting, the one possibility is that you are being blocked by SELinux. To check that run<br />
<br />
# getsebool -a | grep httpd_can_network_connect<br />
httpd_can_network_connect --&gt; on<br />
httpd_can_network_connect_db --&gt; on<br />
<br />
and to enable them if they are not on, do<br />
<br />
setsebool -P httpd_can_network_connect 1<br />
setsebool -P httpd_can_network_connect_db 1<br />
<br />
taken from<br />
https://www.centos.org/modules/newbb/print.php?form=1&amp;topic_id=29646&amp;forum=38&amp;order=DESC&amp;start=0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106718""></a>
  <div class="note">
   <strong class="user">herrwil at gmail dot com</strong>
   <a href="#106718" class="date">30-Nov-2011 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following method: server\instance<br />
does'nt work on unix systems...<br />
<br />
An instance is nothing more than specific port address different than 1433... so just discover the port on mssql server and then try to connect using:<br />
<br />
ip:port<br />
<br />
In unix the port is specified by : not by ,</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105132""></a>
  <div class="note">
   <strong class="user">benjamin at mysteriousquilt dot se</strong>
   <a href="#105132" class="date">29-Jul-2011 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If someone encounters the interesting problem in which PHP can connect to a MSSQL server from the command line but not when running as an Apache module: SELinux prevents Apache (and therefore all Apache modules) from making remote connections by default.<br />
<br />
This solved the problem in CentOS:<br />
# setsebool -P httpd_can_network_connect=1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104247""></a>
  <div class="note">
   <strong class="user">ben at adworkshop dot com</strong>
   <a href="#104247" class="date">03-Jun-2011 02:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Connecting to a named instance of MSSQL.<br />
Our environment is a Windows 2003 server.<br />
Connecting to a dedicated MSSQL server running two instances of SQL SERVER 2005. The default instance and then a second named instance.<br />
My issue was in finding the syntax to properly identify the port of the named instance server.<br />
I found the answer finally in this thread, where a comma is used to separate the IP and PORT number.<br />
<br />
So, the code:<br />
<br />
mssql_connect('192.0.0.0,3456','USERNAME','PASSWORD');<br />
<br />
In this case we used the internal IP of the server, followed by the static port number assigned to the named instance, in this example 3456. The port number can be dynamic or static, obviously choosing static is the route to take.<br />
<br />
Hope this helps someone!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100066""></a>
  <div class="note">
   <strong class="user">me at pazuzusfate dot de</strong>
   <a href="#100066" class="date">23-Sep-2010 10:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I didn't get it working with PHP 5.2.9 and MS SQL 2008, so I used this article <a href="http://msdn.microsoft.com/en-us/library/cc793139(SQL.90" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/cc793139(SQL.90</a>).aspx and with SQL login (not Windows authentication!) it works fine!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99862""></a>
  <div class="note">
   <strong class="user">Sarke</strong>
   <a href="#99862" class="date">11-Sep-2010 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
By far the easiest way that I've found to connect to a SQL server is to route it through a ODBC connection.<br />
<br />
1. Administrative Tools -&gt; Data Sources (ODBC)<br />
2. System DNS<br />
3. Add... "SQL Server"<br />
<br />
Then just use odbc_connect("sql_test", "user", "pass") instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99806""></a>
  <div class="note">
   <strong class="user">aksingh at netlink dot com</strong>
   <a href="#99806" class="date">08-Sep-2010 01:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I added to registry following entry:<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ MSSQLServer\Client\ConnectTo] (strip space)<br />
"DSQUERY"="DBNETLIB"<br />
<br />
It worked! Just specify servername in form "host" or "host,port". I successfully connected to remote MSSQL7 and MSSQL2000.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98743""></a>
  <div class="note">
   <strong class="user">pgeier AT international-capital DOTcom</strong>
   <a href="#98743" class="date">04-Jul-2010 08:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have an application which requires MSSQL as interface (and not the new SQLSRV) you have to look for an alternative method. The old (now rightly unsupported) way from Microsoft does not work with PHP 5.3.<br />
After spending several days and nights with trying to connect <br />
here is an easy solution which worked great with all applicatins expecting mssql: FreeTDS for Windows. Here is a great how to with installer links on the Moodle site: <a href="http://docs.moodle.org/en/Installing_MSSQL_for_PHP" rel="nofollow" target="_blank">http://docs.moodle.org/en/Installing_MSSQL_for_PHP</a><br />
<br />
Couple of hints:<br />
- Make sure you have set up a user with "SQL SERVER authentication" who has rights to connect.<br />
- Also make sure after you install and still have problems to run PHPinfo and check that you find the below:<br />
<br />
PHPINFO: mssql<br />
MSSQL Support enabled <br />
...<br />
Library version&nbsp; FreeTDS&nbsp; <br />
<br />
That works perfect for me on Windows 2003 with IIS6 and PHP 5.3 (non threadsafe, VC9).<br />
Hope this is helpful</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96481""></a>
  <div class="note">
   <strong class="user">dju @ work</strong>
   <a href="#96481" class="date">01-Mar-2010 03:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On a windows 2000 server, i have php 2.6 and apache<br />
It's been 2 days i'm trying to connect it to mssql server 2K5.<br />
i tried everything, of course getting the last version of the sql library (ntwdblib.dll), check the permissions, the dll version etc...&nbsp; but no way....<br />
Finally, i installed the last version of MDAC 2.8<br />
(there's an old one on win2000, even with all the updates...)<br />
And now it works perfectly :-))</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96134""></a>
  <div class="note">
   <strong class="user">Micio2</strong>
   <a href="#96134" class="date">10-Feb-2010 05:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you try to connect to SQL Server 2008 Express, you always have to name the instance you are trying to connect to, even if you installed SQL2008express as "Default" instance instead of named instance. If your instance is SQLExpress and server name is myServer, the server parameter must be: "myServer\SQLExpress". If you installed Default instance of Standard (not express) version of SQL2008 instead, you don't need to name the instance. To connect using TCP/IP, you need also to check server network configuration, enable TCP/IP (listen all: yes), then go to addresses tab and setup port 1433 in all addresses you want the server listen on (by default, port is blank and server don't listen). Libraries involved in TCP/IP are ntwdblib.dll and dbnetlib.dll. Have fun!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95100""></a>
  <div class="note">
   <strong class="user">thornhawk</strong>
   <a href="#95100" class="date">13-Dec-2009 11:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After months of searching, I have discovered the most simple way of connecting Php to MS Sql Express / Enterprise: <br />
-- Use the Microsoft SQL Server Driver for PHP! --<br />
<br />
1) Download from <a href="http://tiny.cc/fkGzf" rel="nofollow" target="_blank">http://tiny.cc/fkGzf</a><br />
<br />
2) Place php_sqlsrv_ts.dll in your php extensions folder.<br />
<br />
3) Enable php_sqlsrv_ts.dll in your php.ini -&gt; extension=php_sqlsrv_ts.dll<br />
<br />
4) Follow the documentation and api reference at <a href="http://msdn.microsoft.com/en-us/library/cc296152%28SQL.90%29.aspx" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/cc296152%28SQL.90%29.aspx</a><br />
<br />
This works on apache, lighttpd, wampserver (haven't tested on IIS). <br />
<br />
You no longer need to worry about the ntwdblib.dll or whether your web server is in FastCGI mode or not. <br />
<br />
Absolutely simple and it connects straight away! <br />
<br />
Just remember to use the correct server name: $serverName = "&lt;computer name&gt;\SQLEXPRESS";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92564""></a>
  <div class="note">
   <strong class="user">kparmelee at NOSPAM dot montgomerygeneral dot com</strong>
   <a href="#92564" class="date">29-Jul-2009 05:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For my setup (Windows Server 2003, IIS 6, PHP 5.2.6, SQL Server 2005 Enterprise) the key to getting a successful connection using mssql_connect was changing PHP from ISAPI mode to FastCGI mode.<br />
<br />
1)&nbsp; &nbsp; I downloaded and installed FastCGI for IIS 6 from Microsoft <a href="http://www.iis.net/downloads/default.aspx?tabid=34&amp;g=6&amp;i=1521" rel="nofollow" target="_blank">http://www.iis.net/downloads/default.aspx?tabid=34&amp;g=6&amp;i=1521</a><br />
2)&nbsp; &nbsp; I modified my PHP install so it runs in FastCGI mode.<br />
3)&nbsp; &nbsp; Opened fcgiext.ini and added this to the end.<br />
<br />
[Types] <br />
php=PHP <br />
<br />
[PHP] <br />
ExePath=c:\PHP\php-cgi.exe <br />
InstanceMaxRequests=10000 <br />
EnvironmentVars=PHP_FCGI_MAX_REQUESTS:10000<br />
<br />
4)&nbsp; &nbsp; I added cgi.force_redirect=0 to the "; Default timeout for socket based streams (seconds)" section of PHP.ini<br />
5)&nbsp; &nbsp; I made sure my SQL database was set to Windows authentication mode and I also switched mssql.secure_connection in php.ini to on.<br />
6)&nbsp; &nbsp; Created an SQL login for NT AUTHORITY\NETWORK SERVICE and gave it the appropriate permissions to my database.<br />
7)&nbsp; &nbsp; Rebooted the server</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91559""></a>
  <div class="note">
   <strong class="user">Iuri Jacob</strong>
   <a href="#91559" class="date">17-Jun-2009 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was trying to connect to a remote SQL2000 server (located on Internet, not on the local network), then php always returned an "Unable to connect" error or something.
<br />

<br />
After waste a lot of time, by searching among foruns, blogs and logs, I finally discovered&nbsp; the problem. I was monitoring the TCP connections between the server and my machine when I realized that it wasn't been done. For some reason, my Apache 2.2 was "denying" php module from doing remote connections.
<br />

<br />
So I changed the php configuration on apache to CGI mode rather than as module mode. Well, it worked fine since that.
<br />

<br />
In despite of security holes that it involves, it was the only way I've found to make that remote connection works between Apache2.2/PHP5 and MSSQL Server 2000.
<br />

<br />
Strangely, connections inside local network worked in any case (in CGI or module mode).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89761""></a>
  <div class="note">
   <strong class="user">pesadelo at death dot fm</strong>
   <a href="#89761" class="date">21-Mar-2009 11:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a remind: Although it is not present here in this page, the parameter **$new_link** holds for mssql_connect() and mssql_pconnect(). The correspondent mysql functions documentation describes it though.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89760""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#89760" class="date">21-Mar-2009 11:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a remind: Although it is not present here in this page, the parameter **$new_link** holds for mssql_connect() and mssql_pconnect(). The correspondent mysql functions documentation describes it though.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89271""></a>
  <div class="note">
   <strong class="user">b56w</strong>
   <a href="#89271" class="date">01-Mar-2009 12:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After a great deal of testing various things I finally found a solution for connecting to a named instance of MS SQL Express.&nbsp; I first had to download version 200.80.194.0 of ntwdblib.dll and overwrite the existing version in c:\PHP.&nbsp; I then tried an instance name that was posted by "chop_01 at yahoo dot com" in this thread.&nbsp; The instance name is ".\SQLEXPRESS".
<br />

<br />
For example:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp; $dbconnect </span><span class="keyword">= </span><span class="default">mssql_connect</span><span class="keyword">(</span><span class="string">".\SQLEXPRESS"</span><span class="keyword">, </span><span class="default">$dbUser</span><span class="keyword">, </span><span class="default">$dbPass</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88637""></a>
  <div class="note">
   <strong class="user">wwang at moultonlogistics dot com</strong>
   <a href="#88637" class="date">02-Feb-2009 02:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For anyone who have to connect to crappy SQL SERVER with \\computer_name\instance_name and failed to connect. There are couple of thing you need do.
<br />

<br />
1). There's no needs to install SQL client software in your app server. This would keep your server clean.
<br />
2). run cliconfg.exe setup alias in case you needed
<br />
3). last and most important, do NOT use ntwdblib.dll came with PHP 4.4.x. It's not most current. The version I'm using is: 8.00.194 with 274,489 Bytes. And make sure you put this file in your system32 folder.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86372""></a>
  <div class="note">
   <strong class="user">hetland at website dot no</strong>
   <a href="#86372" class="date">15-Oct-2008 02:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello,<br />
<br />
My solution was to install MSSQL Server Native Client<br />
<br />
Info:<br />
<a href="http://msdn.microsoft.com/en-us/data/aa937733.aspx" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/data/aa937733.aspx</a><br />
<br />
System:<br />
W2003 w/PHP 5.2.1 and SQL Server 2008 on Win 2008<br />
(Should also work on 2005)<br />
<br />
My problem was that mssql_connect() failed.<br />
<br />
Installed the native client, restarted IIS and everything went smoothly.<br />
<br />
Helge Hetland</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86132""></a>
  <div class="note">
   <strong class="user">robert dot johnson at icap dot com</strong>
   <a href="#86132" class="date">04-Oct-2008 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I sympathise with all users trying to make SQL Server 2005 work, but that old ntwdblib api was depracated when SQL Server 2000 was released.&nbsp; Newer data types and features are not available through that old api.<br />
<br />
It seems that there are still some people that don't know, and this is my third post on the subject, but there is a&nbsp; Microsoft SQL Server 2005 driver for php.<br />
<br />
It's easy to use and efficient.&nbsp; I don't know if there's a version for Unix servers, but the person who spent 10 hours seems to be using Windows.&nbsp; It's not identical to mssql, but not much different, and I think simple to port.<br />
<br />
You download the extension from Microsoft, put the dll in your extensions folder, and enable it in php.ini (or load it dynamically with dl()).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85783""></a>
  <div class="note">
   <strong class="user">rcgandara at gmail dot com</strong>
   <a href="#85783" class="date">17-Sep-2008 07:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your are trying to connect to a MSSQLServer 8 and got this error: Unabled to connect to: [SERVER_NAME] <br />
and u r using Server authentication, make sure 2 set up mssql.secure_connection to Off in da php.ini<br />
<br />
RCGP <br />
<br />
Making this world better everyday... peace out</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85676""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#85676" class="date">11-Sep-2008 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This might be obvious to some, but here is a quick tidbit that might save you some time if you're using FreeTDS in Linux:<br />
<br />
Be sure that you have these two lines in freetds.conf:<br />
dump file = /tmp/freetds.log<br />
dump file append = yes<br />
<br />
so you can tail -f it in the background of debugging the problem.&nbsp; This helped me find my issue on on CentOS Linux:&nbsp; <br />
&nbsp;<br />
1) tsql test works<br />
2) php-mssql connection in php also works WHEN RUN FROM THE SHELL<br />
3) running PHP through apache does NOT work.<br />
<br />
my /tmp/freetds.log file told me: <br />
net.c:168:Connecting to MYDBSERVER port MYDBPORT<br />
net.c:237:tds_open_socket: MYDBSERVER:MYDBPORT: Permission denied<br />
<br />
and the answer was my firewall/SELinux was denying the Apache processes access to connect to the remote MSSQL DB port, but my shell accounts were fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84307""></a>
  <div class="note">
   <strong class="user">getzeroedin at hotmail dot com</strong>
   <a href="#84307" class="date">08-Jul-2008 08:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those trying to connect PHP 5.2 to a 2005 Microsoft SQL Server Analysis Services (SSAS) cube and execute MDX queries, you have to establish a link via a trusted connection from the Database Service to SSAS using a stored procedure, then execute the stored procedure via PHP. <br />
<br />
Here is an example stored procedure that retrieves records from the Adventure Works sample cube that ships with SSAS.&nbsp;&nbsp; <br />
<br />
From SQL Server Query Analyzer, you could test it as:&nbsp; <br />
<br />
exec testMDX <br />
<br />
From PHP, you would execute something like the following:<br />
<br />
$resultset = mssql_query("exec testMDX",$res_id);<br />
<br />
then loop thorugh the result set.<br />
<br />
-- STORED PROCEDURE BEGIN<br />
<br />
set ANSI_NULLS ON -- Must be enabled at time Stored Proc is created<br />
set QUOTED_IDENTIFIER ON -- Must be enabled at time Stored Proc is created<br />
GO<br />
<br />
Create Procedure [dbo].[testMDX] <br />
as<br />
BEGIN<br />
SET ANSI_WARNINGS ON:&nbsp; -- Must be enabled<br />
SET ANSI_NULLS ON; -- Must be enabled<br />
<br />
Declare <br />
@SQL varchar(1200),&nbsp; -- Variable to hold SQL query<br />
@MDX varchar (1000), -- Variable to hold MDX query<br />
;<br />
<br />
-- Establish a link to Analysis Server<br />
exec sp_addlinkedserver <br />
@server='linked_olap', -- Alias used to reference the link<br />
@srvproduct='', -- Not used<br />
@provider='MSOLAP.3', -- OLAP driver<br />
@datasrc='servername', -- Database server name<br />
@catalog='Adventure Works DW Standard Edition' -- Database name<br />
;<br />
<br />
-- Analysis Server requires a TRUSTED connection<br />
exec sp_addlinkedsrvlogin <br />
@rmtsrvname = 'linked_olap', -- Alias used to reference the link<br />
@useself = 'false', -- Use own credentials<br />
@locallogin = NULL, -- Apply to all local logins<br />
@rmtuser = 'domain\username', -- Remote user name<br />
@rmtpassword = 'xyz123' -- Remote user password<br />
;<br />
<br />
-- Create a temporary table that will be used to hold the MDX output<br />
create table #temp_table (column1 text null, column2 text null);<br />
<br />
-- Setup a string to hold the MDX so that the precompiler does not try to validate the syntax<br />
SET @MDX = 'SELECT [Product].[Category].members ON ROWS,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {Measures.[Internet Order Count]} ON COLUMNS&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; FROM [Adventure Works]&nbsp; &nbsp; ' ;<br />
<br />
-- Setup a string to insert the MDX results into the temporary table<br />
SET @SQL = 'Insert into #temp_table SELECT * FROM OpenQuery(linked_olap,'''+@MDX+''')';<br />
<br />
-- Execute the SQL and remote MDX query<br />
EXEC (@SQL) ;<br />
<br />
-- Select the results from the temporary table to return to the calling program<br />
Select column1, column2 from #temp_table ;<br />
<br />
-- Drop the temporary table<br />
drop table #temp_table;<br />
<br />
-- Release the TRUSTED connection <br />
exec sp_droplinkedsrvlogin 'linked_olap', NULL ;<br />
<br />
-- Release the link to the Analysis Server<br />
exec sp_dropserver 'linked_olap' ;<br />
<br />
END<br />
<br />
-- STORED PROCEDURE END</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81780""></a>
  <div class="note">
   <strong class="user">simonhukin at gmail dot com</strong>
   <a href="#81780" class="date">13-Mar-2008 12:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After a couple of days (seems to be the common theme) trying to get my code to connect to our new clustered 2005 SQL server instance. I finally did it. :-)<br />
<br />
For the following setup:<br />
<br />
PHP 5.2.4 (hosted on a Windows Server 2003 box)<br />
connecting to MSSQL 2005 in a clustered environment<br />
(was already connecting to MSSQL 2000 with no problems)<br />
<br />
I was about to get the client tools installed on the server, but this would have required a trip down to the data center by our IT guys (last resort - well actually last resort was to write a data access service in Java, which was connecting fine).<br />
<br />
Anyway, after making sure all the ntwdblib.dll were of the 2000.80.194.0 version. It was still not working.<br />
<br />
The thing which made it work was simply to specify the port.<br />
<br />
yes after 2days of looking into alternatives (incidently freetds - a windows compiled version, was working very intermittently) I found all I had to do was specify the port!<br />
<br />
I guess this is because I needed to connect via TCP/IP, our network admin didn't want named pipes used (as it's non-standard). Although, named pipes were enabled anyway. Specifying the port must have made the default behavour to connect via TCP/IP. Also the port was '1433' which I assumed was default anyway, hence hadn't specified before.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79561""></a>
  <div class="note">
   <strong class="user">edortizq at gmail dot com</strong>
   <a href="#79561" class="date">03-Dec-2007 04:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For connecting Linux + Apache + SQLEXPRESS 2005 take care about it:<br />
<br />
- Don´t use the standard MS-SQL port (1433), use the MS-SQL dinamic port under SQL Server Configuration Manager -&gt; SQL Express Protocols -&gt; TCP/IP properties -&gt; IP Adresses -&gt; IPAll<br />
<br />
- You can do a direct connection (without FreeTDS) using the following statemt:<br />
&nbsp; $db=mssql_connect('192.168.xxx.xxx:1541','usrxxxx','pwdxxxx');<br />
<br />
-You can use FreeTDS configuring the freetds.conf file as follow:<br />
&nbsp; [connect2k5]<br />
&nbsp; host = 192.168.xxx.xxx<br />
&nbsp; port = 1541<br />
&nbsp; tds version = 8.0<br />
With the following PHP statement:<br />
&nbsp; $db=mssql_connect('connect2k5','usrxxxx','pwdxxxx');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77437""></a>
  <div class="note">
   <strong class="user">chop_01 at yahoo dot com</strong>
   <a href="#77437" class="date">29-Aug-2007 10:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
1. Installed the SQLServer in mixed auth mode<br />
2. Checked that the mssql.secure_connection = Off was present in the php.ini<br />
3. Copied the ntwdblib.dll file into<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; o WINDOWS\SYSTEM32<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; o program files\apache2\bin<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; o php<br />
4. Started the SQL Server Browser Service<br />
5. Enabled all of the IPs in Protocols &gt; TCP/IP<br />
6. Restarted the following services:<br />
&nbsp;&nbsp; &nbsp; &nbsp; o Apache<br />
&nbsp;&nbsp; &nbsp; &nbsp; o SQL Service<br />
&nbsp;&nbsp; &nbsp; &nbsp; o SQL Browser Service<br />
<br />
This allowed me to connect with no problems using the following parameters within my mssql_connect call<br />
<br />
HOST=.\SQLEXPRESS<br />
USERNAME=sa<br />
PASSWORD=&lt;MYPASS&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77150""></a>
  <div class="note">
   <strong class="user">Colin</strong>
   <a href="#77150" class="date">17-Aug-2007 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had lots of issues with trying to get SQL Server '05 (NOT Express) to work with PHP 5.1.2 on Windows Server '03 SP2 running IIS 6. This is what finally worked:<br />
- Uncomment the php_mssql.dll line in php.ini<br />
- Replace the ntwdblib.dll file in /php/ext/ with the (smaller) downloadable file from webzila.com<br />
- Set SQL Server to mix-mode authentication ("Windows and SQL Server Auth")<br />
- Create IUSR_&lt;computer_name&gt; account in SQL Server using Windows authentication<br />
- Grant read/write access to the IUSR_&lt;computer_name&gt; in SQL Server<br />
- Create SQL auth account using SQL authentication<br />
- Grant read/write access to the SQL auth account in SQL Server<br />
- Restart the system<br />
<br />
I'd imagine that creating a way for IUSR to get into the SQL Server is NOT a good idea, but this is the only way I could get it to work. Hopefully, a future update to SQL Server will fix this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76516""></a>
  <div class="note">
   <strong class="user">hao dot wang at outsourcing dot org</strong>
   <a href="#76516" class="date">19-Jul-2007 02:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those poor people (like myself) who have to use MS SH*T SQL 2005 and cannot connect it.<br />
<br />
I have to use sql server 2005 (another piece of sh*t from MS) at work. It takes me hours to connect this garbage. I end up find I have to enable TCP/IP under "Protocols for MSSQLSERVER". To do this, you need go to <br />
START &gt;&gt; PROGRAMS &gt;&gt; MS Sql server 2005 &gt;&gt; Configuration Tools &gt;&gt; Sql Server configuration Manger <br />
<br />
Click "+" sign next to "Sql server 2005 network configuration" then<br />
click to highlight "Protocols for MSSQLSERVER" then<br />
in right panel right click "TCP/IP" and enable it. <br />
<br />
DO NOT for get restart you sql server service and pray to dear God your company will dump MS one day.<br />
<br />
DO NOT install "ActiveScript engine" as MS suggested. You don't want extra trouble and junk.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76441""></a>
  <div class="note">
   <strong class="user">streamkid {) at (} gmail {) dot (} com</strong>
   <a href="#76441" class="date">16-Jul-2007 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I encountered this while developing applications for Cisco IP Phones.<br />
<br />
The phones require the Connection header to be set to close:<br />
header("Connection: close");<br />
<br />
But, with this header, mssql_connect won't work.<br />
A possible workaround for this is to have another php file that interacts with the database, and returns the results in xml format so you can use it in the application.<br />
<br />
Hope this saves someones time.<br />
streamkid</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76256""></a>
  <div class="note">
   <strong class="user">animefan1003 at yahoo dot com</strong>
   <a href="#76256" class="date">08-Jul-2007 06:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you cannot connect to an SQL Server instance after trying all of the above, look in the registry using regedit.exe at HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\SQLEXPRESS\MSSQLServer\SuperSocketNetLib\Tcp. One of the nameValue pairs has name TcpPort and a value, which is the port that the SQL Server is listening on (mine was set to 1030). <br />
<br />
Now in the SQL Server Configuration Manager, under SQL Server native client configuration-&gt;Client protcols-&gt;TCP\IP, the default port is listed as 1433. It seems that this registry value is overriding the setting in the SQL Server Config manager. <br />
<br />
I changed the port number in my call to mssql_connect() to 1030 and I was able to connect. An example string is:<br />
<span class="default">&lt;?php $database </span><span class="keyword">= </span><span class="default">mssql_connect</span><span class="keyword">(</span><span class="string">'laptop2,1030'</span><span class="keyword">, </span><span class="string">'sa'</span><span class="keyword">, </span><span class="string">'password'</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">); </span><span class="default">?&gt;</span>. Note that for the server name, it can be the machine name, the string "localhost" or an IP Address such as 127.0.0.1. You do not have to append "\SQLEXPRESS" to the end of it.<br />
<br />
Before I did this, I enabled TCP\IP connections using the SQL Server Config Manager. I also enabled the IP address under TCP/IP to be sure it worked. In php.ini, I had the mssql.secure_connection key set to "Off" (hence why I pass the username and pasword to mssql_connect()). I enabled mixed authentication is SQL Server and granted logins to user "sa". I also put the updated ntwdblib.dll in both the system32 directory and the php directory to be sure it would work. <br />
<br />
Also, the webzilla site for the updated ntwdblib.dll file seems to be having connection issues with their MySQL database. Instead, try <a href="http://www.userscape.com/helpdesk/index.php?pg=kb.page&amp;id=13 ." rel="nofollow" target="_blank">http://www.userscape.com/helpdesk/index.php?pg=kb.page&amp;id=13 .</a><br />
<br />
I hope that this saves someone a few hours :-) .</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76141""></a>
  <div class="note">
   <strong class="user">Anders Simonsen</strong>
   <a href="#76141" class="date">02-Jul-2007 06:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Finally, I made it work... Using Windows 2003, ISS 6.0, PHP5-CGI and SQL express<br />
<br />
It's a good idea to set your environment variables to path=%path%;c:\php and phprc=c:\php first.<br />
<br />
1. Fire up SQL Server Configuration Manager<br />
2. Drill down to "Protocols for SQLEXPRESS"<br />
3. Enable Named Pipes (God knows why)<br />
4. Enable TCP, I have everything enabled in the "IP Addresses" tab<br />
5. Restart SQL Express (Or the computer ;)<br />
6. Start SQL Browser service. Remember to set it to automatic.<br />
<br />
The final detail is the need to use (host)\SQLEXPRESS in the connection string. This is a little problematic when using MDB2, but it works if you break the connection string into an array like this:<br />
<br />
$dsn = array(<br />
'phptype'&nbsp; =&gt; 'mssql', <br />
'username' =&gt; 'user', <br />
'password' =&gt; 'yourpass', <br />
'hostspec' =&gt; 'localhost\SQLEXPRESS',<br />
'database' =&gt; 'yourdb',<br />
);<br />
<br />
require_once 'MDB2.php'; $mdb2 =&amp; MDB2::connect($dsn);<br />
if (PEAR::isError($mdb2)) {<br />
echo $mdb2-&gt;getUserinfo();<br />
}<br />
<br />
Of course, you'll also need extension=php_mssql.dll in the PHP.ini and that ntwdblib.dll 2000.80.194.0 file mentioned bellow.<br />
<br />
Have fun</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75349""></a>
  <div class="note">
   <strong class="user">rossco at hotpop dot com</strong>
   <a href="#75349" class="date">25-May-2007 06:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A small problem I had when connecting to SQL 2000 Ent named instance (from W2003 Std, IIS6, PHP5).<br />
<br />
I had to supply the instance name AND port<br />
$sql = mssql_connect ("SERVER\INSTANCE,PORT", "username", "password")<br />
<br />
And also add registry entry as per previous comments:<br />
<br />
HKEY_LOCAL_MACHINE \SOFTWARE\ Microsoft\ MSSQLServer\ Client\ ConnectTo:<br />
"SERVER\INSTANCE"="DBMSSOCN,SERVER\INSTANCE,PORT"<br />
<br />
(Just export the key from a PC with SQL client tools)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71645""></a>
  <div class="note">
   <strong class="user">raul at tarkus dot com dot mx</strong>
   <a href="#71645" class="date">10-Dec-2006 12:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When trying Linux + PHP 5.2.0 + SQL express 2005, use dinamic port specified in TCP/IP properties of SQL server configuration. The default port (1433) didn't work for me.<br />
This is my freetds.conf file:<br />
<br />
[JRZMERC176]<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; host = 10.12.51.176<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; port = 1396<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; tds version = 8.0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69857""></a>
  <div class="note">
   <strong class="user">kamikazie at comcast dot net</strong>
   <a href="#69857" class="date">23-Sep-2006 10:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Ok, so after many many many hours of searching (somewhere around the ballpark of 2 weeks, on and off) and reading these pages, I've found the answer to my unspoken question (although there was much cursing).<br />
<br />
Background:<br />
<br />
A Windows Server 2003 box running as a router and a webserver using IIS6 and the latest PHP 5 as of 23 Sep 2006.<br />
<br />
A Windows Server 2003 box running SQL 2000 Enterprise with one instance<br />
<br />
Using a named pipe, the code to connect was:<br />
"$connection = mssql_connect("\\.\pipe\MSSQL$instance\sql\query", "user", "pass") or die("Message"); "<br />
<br />
I recieved the error that $instance was not a defined variable, so I changed it to<br />
"\\.\pipe\MSSQLinstance\sql\query"<br />
both on the connection string and the SQL server<br />
<br />
When passed on to the server, I still recieved connection errors, so I changed it again, this time to:<br />
"$connection = mssql_connect("\\\\.\pipe\\MSSQLinstance\\sql\\query", "user", "pass") or die("Message"); "<br />
<br />
With this new code, I recieved a successful connection, but a bad login saying that my IUSR_ account did not have permissions on the database, although I used a separate username in the connection string.<br />
<br />
Using SQL, I setup windows authentication for the IUSR_ account and I was able to establish a connection and successfully run a query.<br />
<br />
I still can't find out why it was trying to pass the IUSR_ account as the login though.&nbsp; If anyone has an answer drop me a line.<br />
<br />
Now using windows groups it should be easy to create a login page that uses groups to connect to databases rather than setting up each user individually.<br />
<br />
I just wanted to share with everyone my long awaited success story.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68115""></a>
  <div class="note">
   <strong class="user">munckfish.net</strong>
   <a href="#68115" class="date">13-Jul-2006 07:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Further to the following posts on Windows 2003 + PHP5 + SQL Server Express.<br />
<br />
<a href="http://php.net/manual/en/function.mssql-connect.php#58787" rel="nofollow" target="_blank">http://php.net/manual/en/function.mssql-connect.php#58787</a><br />
<a href="http://uk2.php.net/manual/en/function.mssql-connect.php#61971" rel="nofollow" target="_blank">http://uk2.php.net/manual/en/function.mssql-connect.php#61971</a><br />
<br />
I ran into another problem when I updated the version of ntwdblib.dll. I picked up version 2000.80.2039.0 from an SQL Server 2000 installation. However, when I replaced the PHP 5 provided version with this one and restarted IIS, phpinfo() showed that the mssql extension wasn't loading anymore. I couldn't see any errors reported in browser nor the system error logs.<br />
<br />
By chance I decided to run 'php -i' on the command line. This was lucky because running it this way a system error dialog popped up a warning about a missing DLL dependency.<br />
<br />
The problem was that the new ntwdblib.dll had a dependency on MSVCR71.DLL which couldn't be found in IIS' path. I did a search for msvcr*.dll in C:\\WINDOWS and found a copy of this DLL in C:\\WINDOWS\\Microsoft.NET\\Framework\\v1.1.4322\\. I copied it into my PHP install dir and restarted IIS. Then when I ran phpinfo() the extension showed up again.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59692""></a>
  <div class="note">
   <strong class="user">gwkeeper at eljoy dot xxx</strong>
   <a href="#59692" class="date">13-Dec-2005 05:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm running PHP 5.x.x on IIS5 + Windows 2000 server and connecting to remote SQL Server 2000 with error : Login failed for user (sa). Reason: Not associated with a trusted SQL Server connection. (severity 14).<br />
<br />
I found that even though I had "SQL and Windows Authentication" selected, and mssql.secure_connection = On in php.ini it did not work. It was due to another software instalation. <br />
<br />
For me was solution to install SP4 on MS SQL 2000 and it started to work pretty well.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58787""></a>
  <div class="note">
   <strong class="user">lbowerh at netscape dot net</strong>
   <a href="#58787" class="date">16-Nov-2005 04:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The recently released SQL Server 2005 Express will work with MSSQL functions. Here are some caveats:<br />
<br />
1) The version of ntwdblib.dll supplied with PHP will not work with Server 2005 (Win32 only). You must use a newer version. The version supplied with SQL Sever 2000 (2000.80.194.0) seems to work well.<br />
2) You must set up mssql_connect to reference the server AND the instance name, eg:<br />
mssql_connect("MyPC\SQLEXPRESS","MyUser","MyPwd");<br />
<br />
Although the MSSQL functions work, you might want to consider using the new 'pdo_odbc' (PHP 5.1) with SQL Server 2005 Express for any new code you are writing.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57973""></a>
  <div class="note">
   <strong class="user">dave at phantomfish dot co dot uk</strong>
   <a href="#57973" class="date">20-Oct-2005 03:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have spent the last 2 days trying to get PHP to connect to MSDE on Windows 2003 Web Edition.<br />
<br />
Although initally PHP would connect to the database without a problem, it would then refuse to connect, hitting F5 enough times would eventually connect to the database. As you can imagine this intermittent problem was hard to trace.<br />
<br />
I was using PHP 5.0.5 (although 5.0.4 has the same problem) on a Windows 2003 Web Edition SP1 server, and was trying to connect to MSDE Rel A.<br />
<br />
Solution:<br />
~~~~~~~~~<br />
<br />
Firstly MSDE needed to be installed with the following arguments: SECURITYMODE=SQL DISABLENETWORKPROTOCOLS=0.<br />
<br />
Secondly it was necessary to delete ntwdblib.dll from c:\php<br />
<br />
Thirdly I downloaded the SQL 2000 evaluation and installed only the client tools on a seperate PC (Ent. Manager will now connect to the database).<br />
<br />
Lastly I copied the version of ntwdblib.dll from the PC with Ent. Manager on it (ver 2000.80.2039.0) to c:\windows\system32\<br />
<br />
After a re-boot no more connection problems.<br />
<br />
Pls note that this is only for 2003 Web Edition with MSDE, this problem does not seem to occour with Standard Edition</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57880""></a>
  <div class="note">
   <strong class="user">mckoin at example dot com</strong>
   <a href="#57880" class="date">18-Oct-2005 05:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use PHP on Windows with Apache as a web server, you may get problems with authentication to MS SQL Server even when you supply all valid credentials. <br />
<br />
Check your php.ini file:<br />
; Use NT authentication when connecting to the server<br />
mssql.secure_connection = On<br />
<br />
If you have secure_connection = On, make sure that you provide valid credentials in the properties for Apache service in the System Services box. Then you should not send DB username and password from your script to MSSQL Server.<br />
<br />
If you want to use specific credentials from a PHP script, then set mssql.secure_connection = Off in your php.ini</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57120""></a>
  <div class="note">
   <strong class="user">j3d</strong>
   <a href="#57120" class="date">24-Sep-2005 02:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After struggling for 6 hours trying to fix the dreaded "Not associated with a trusted SQL Server connection." error I have finally solved it after following the suggestions presented here: 
<br />
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;839569" rel="nofollow" target="_blank">http://support.microsoft.com/default.aspx?scid=kb;en-us;839569</a>
<br />

<br />
&lt;sarcasm&gt; Who would have thought that microsoft's article would be useful &lt;/sarcasm&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56929""></a>
  <div class="note">
   <strong class="user">dale dot liszka at gmail dot com</strong>
   <a href="#56929" class="date">19-Sep-2005 09:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are trying to use Sybase and MSSQL on the same WIN32 box you will probably have headaches.&nbsp; There are multiple declaration errors when you enable php_sybase_ct.dll and php_mssql.dll in the php.ini at the same time.<br />
<br />
The specific error for all functions starts like this:<br />
PHP Warning: Function registration failed - duplicate name - mssql_connect<br />
<br />
There is a way around this! On a windows box I have done this successfully several times.<br />
<br />
1. Make a backup copy of php_sybase_ct.dll (never hurts!)<br />
2. Open php_sybase_ct.dll in a HEX editor (fhred is a nice free one <a href="http://www.kibria.de/frhed.html " rel="nofollow" target="_blank">http://www.kibria.de/frhed.html </a>)<br />
3. Replace all instances of 'mssql' with 'sysql'.&nbsp; It doesn't have to be 'sysql', just anything but 'mssql' or 'sybase'.<br />
4. Save the file.&nbsp; (Alternately you could save as something like php_sybase_ct_modified.dll and cite that in your php.ini)<br />
<br />
All the constructs are still declared for the sybase_* functions and now you can use MSSQL and Sybase instead of switching php.ini files, etc.&nbsp; I have had this work under php 4.3+ and php 5.0.5.<br />
<br />
PS. I decided to place this under mssql_connect because its the first error thrown in this case.&nbsp; I believe it should make the information easier to find via google/search/browsing.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55211""></a>
  <div class="note">
   <strong class="user">Marcel Laverdet</strong>
   <a href="#55211" class="date">27-Jul-2005 10:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was having problems connecting to a SQL cluster with mssql_connect, but any other program could connect just fine. I ended up using a PHP ADODB driver to work around the connectivity problem I was having. Later, however, I discovered my problem was a mismatched name in the server table.<br />
<br />
To see if you have this problem, "SELECT * FROM [master].[sysservers]". If the srvname, and datasource don't match the cluster's virtual SQL name... then you will have a problem. My virtual SQL server's name was 'SQL-SERV', however in the sysservers table it was listed as 'SQLSERV'.<br />
<br />
To remedy this problem, simply issue the following queries: "EXECUTE sp_dropserver wrongName" and then "EXECUTE sp_addserver rightName, 'local'". After running these 2 procedures, restart the server and PHP should connect just fine using the native libraries.<br />
<br />
If it still doesn't connect, make sure you update the ntwdblib.dll file as explained in prior comments.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53808""></a>
  <div class="note">
   <strong class="user">Robert at realjax dot com</strong>
   <a href="#53808" class="date">14-Jun-2005 03:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A view that worked fine when queried from any other environment was giving me strange results when queried from PHP.&nbsp; The problem is that the MS SQL database settings are not set to the ANSI defaults as when connecting through Microsoft products.&nbsp; The setting CONCAT_NULL_YIELDS_NULL defaults to ON when connecting with ODBC or SQL Query Analyzer, which complies with the ANSI standard.&nbsp; However, this defaults to OFF when connecting through PHP.&nbsp; There are many other settings which may also need to be explicitly set.<br />
<span class="default">&lt;?php<br />
mssql_query</span><span class="keyword">(</span><span class="string">'SET CONCAT_NULL_YIELDS_NULL ON'</span><span class="keyword">, </span><span class="default">$hd</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53620""></a>
  <div class="note">
   <strong class="user">pelanne at gmail dot com</strong>
   <a href="#53620" class="date">07-Jun-2005 04:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just in case it helps people here...&nbsp; We were being run ragged by extremely slow connections from IIS6 --&gt; SQL Server 2000.&nbsp; Switching from CGI to ISAPI fixed it somewhat, but the initial connection still took along the lines of 10 seconds, and eventually the connections wouldn't work any more.<br />
<br />
The solution was to add the database server IP address to the HOST file on the server, pointing it to the internal machine name.&nbsp; Looks like some kind of DNS lookup was the culprit.&nbsp; <br />
<br />
Now connections and queries are flying, and the world is once again right.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53552""></a>
  <div class="note">
   <strong class="user">jack dot rauta at tiscali dot dk</strong>
   <a href="#53552" class="date">06-Jun-2005 01:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I couldn't connect to a remote MSSQL database using Windows Server 2003, IIS 6, PHP 5 and mssql_connect. It worked with odbc_connect and with DSN-less connection through ADODB COM object.<br />
<br />
The solution was to change a registry entry, as follows:<br />
1) Open regedit.exe<br />
2) Browse to the key named HKEY_LOCAL_MACHINE\\SOFTWARE \\Microsoft\\MSSQLServer\\Client\\ConnectTo<br />
3) There should be one or more keys in the format "SERVER" = "LIBRARY,SERVER,PORT"<br />
&nbsp;&nbsp;&nbsp; where SERVER is a NetBIOS name, Named Pipe alias or the server's IP address, and PORT is usually 1433.<br />
4) If LIBRARY is set to DBMSSOCN, try changing it to DBNETLIB. That worked for me.<br />
5) Restart IIS</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52922""></a>
  <div class="note">
   <strong class="user">bass28</strong>
   <a href="#52922" class="date">17-May-2005 09:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When connecting to a SQL 2000 DB from an Apache/PHP setup on a Windows box you must connect using a SQL user login (type=standard).&nbsp; If you add Windows users or groups to SQL security logins and try connecting using that login the connection will fail.&nbsp; If the connection works for SA but not for your login, this may be your answer (it was for me!).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52249""></a>
  <div class="note">
   <strong class="user">ta_bg at NOSPAM dot mail dot ru</strong>
   <a href="#52249" class="date">26-Apr-2005 10:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I spent about a day until get working mssql_connect() function. I tried to connect PHP to MSDE. The solution is Server Network Utility (it is not installed on MSDE + Client tools configuration, only on SQL Server Standard/Enterprise). The necessary file SVRNETCN.EXE exists on the installation disk.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51783""></a>
  <div class="note">
   <strong class="user">kryltsov at yahoo dot com</strong>
   <a href="#51783" class="date">11-Apr-2005 10:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you connect to MSSQL and&nbsp; get error 515 (INSERT NULL INTO NOT NULL VALUE). <br />
Execute following statement after connection to DB.<br />
"set ANSI_NULL_DFLT_ON ON". There are lots of code arround where SP creates, for example, temp tables. There is no specification 'NOT NULL' on columns. Many people beleive that it means that nulls will be allowed.<br />
After 5 days of debugging one of the software monsters SQL code I found that PHP connects to MSSQL (at least on my server) without setting "ANSI_NULL_DFLT_ON" which caused SP fired by insert trigger failed with 515 error because temp tables had been created with all columns 'NOT NULL'.<br />
QA and from ASP everything was working just fine.<br />
<br />
After I set ANSI_NULL_DFLT_ON to ON. Everything started working fine.<br />
Hope it wil help.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51346""></a>
  <div class="note">
   <strong class="user">yurtesen at ispro dot net dot tr</strong>
   <a href="#51346" class="date">28-Mar-2005 04:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using FreeBSD you shouldnt forget to copy freetds.conf.dist to freetds.conf and edit. Otherwise you will get:<br />
PHP Warning:&nbsp; mssql_connect(): Unable to connect to server:&nbsp; BLAH in</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50793""></a>
  <div class="note">
   <strong class="user">nospam_bg at pumkinhed dot com</strong>
   <a href="#50793" class="date">10-Mar-2005 04:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On freebsd I edited the Makefile in /usr/ports/lang/php5 and added&nbsp; --with-mssql=/usr/local to the CONFIGURE_ARGS= section (ensure to put a \ in front of the previous line), then it will use tds.h correctly....&nbsp; hth</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49461""></a>
  <div class="note">
   <strong class="user">Ilmars Poikans</strong>
   <a href="#49461" class="date">28-Jan-2005 08:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Connecting to MS SQL server over TCP/IP.<br />
<br />
I'm working on Windows XP with PHP5 (should work with PHP4 also because ntwdblib.dll is the same).<br />
<br />
My problem was that I needed to connect to remote MS SQL server over TCP/IP (named pipes weren't an option), but I couldn't, because named pipes were used all the time.<br />
<br />
One of the possible solutions is to install SQL Client Tools and configure TCP/IP support. I hadn't SQL Server installation disk, so I found fast solution with registry editing.<br />
<br />
I added to registry following entry:<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ MSSQLServer\Client\ConnectTo] (strip space)<br />
"DSQUERY"="DBNETLIB"<br />
<br />
It worked! Just specify servername in form "host" or "host,port". I successfully connected to remote MSSQL7 and MSSQL2000.<br />
<br />
I have found on Internet alternative solution that you need to add "DSQUERY"="DBMSSOCN", but it didn't work for me.<br />
<br />
If you need more connection tweaking like <br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ MSSQLServer\Client\DB-Lib] (strip space)<br />
"AutoAnsiToOem"="ON" <br />
"UseIntlSettings"="ON" <br />
<br />
and more, then better find and install SQL Client Tools.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49087""></a>
  <div class="note">
   <strong class="user">petr /*dot*/ havlicek at phlab [dot) net</strong>
   <a href="#49087" class="date">16-Jan-2005 01:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had problems connecting to multiple instance of MSSQL so I tried solution suggested by guilherme_cruz at uol dot com dot br 29-Aug-2002 07:45. It works great but I had to change line \\SERVER_NAME\pipe\MSSQL$INSTANCE_NAME\sql\query<br />
&nbsp;to \\.\pipe\MSSQL$INSTANCE_NAME\sql\query.<br />
Regards<br />
Petr</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48457""></a>
  <div class="note">
   <strong class="user">henry aluede</strong>
   <a href="#48457" class="date">24-Dec-2004 02:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if u plan to connect to mssql, and u had previously worked on sybase, u will get a duplicate error. to correct this just exclude the sybase dll in your php.ini file</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48247""></a>
  <div class="note">
   <strong class="user">bartlewis at gmail dot com</strong>
   <a href="#48247" class="date">16-Dec-2004 03:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am yet another person who had problems getting php[5] to play nicely with SQL Server 2000 [MSDE] on WinXP SP2 w/IIS. Following the notes on this page from previous users did get me closer, but I still could not connect. I was getting an error that said, in essence:<br />
<br />
"MACHINENAME\IUSR_MACHINENAME" could not connect to the server.<br />
<br />
Through some painstaking googeling I was able to resolve the problem by following this MSKB article:<br />
<a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;319930" rel="nofollow" target="_blank">http://support.microsoft.com/default.aspx?scid=kb;en-us;319930</a><br />
<br />
It seems that my default install of MSDE did NOT "Enable Mixed Mode Authentication" which is required for this kind of connection. To make matters worse, the only way to change this with MSDE is to go mucking with the registry (which always freaks me out a bit). The above article explains how to do this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48150""></a>
  <div class="note">
   <strong class="user">cbunk at arescorporation dot com</strong>
   <a href="#48150" class="date">13-Dec-2004 11:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was having problems connecting a IIS6 Webserver on a 2003 windows box to a MSSQL Installation running windows 2000.&nbsp; After suspecting ntwdblib.dll I tried updating the file but with no luck.&nbsp; Finally I figured out the problem by noticing that in addition to a copy of the file living in the windows directory there was one in the PHP directory as well (from the zip package).&nbsp; Although I had an up to date version of the file in my windows directory the one in the php directory was getting read instead.&nbsp; I simply removed the file from my php installation directory and all worked well.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47493""></a>
  <div class="note">
   <strong class="user">chrisputnam at gmail dot com</strong>
   <a href="#47493" class="date">18-Nov-2004 04:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're having trouble getting PHP to connect to a SQL 2000 Server (the MSDE, specifically), try running the Server Network Client usually located at C:\Program Files\Microsoft SQL Server\80\Tools\Binn\SVRNETCN.exe<br />
<br />
Disable all protocols but Named Pipes. Then Apply your changes, click OK, and restart the SQL service with these commands at a command prompt:<br />
<br />
net stop mssqlserver [if it says the agent will stop too, let it happen]<br />
net start mssqlserver<br />
net start sqlserveragent<br />
<br />
That fixed it all for me.<br />
<br />
Also note that named pipes has a huge performance difference against TCP/IP. Named pipes are a tremendous amount faster.<br />
<br />
I have been working on this for two days now and I hope someone else stumbles across my solution!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46641""></a>
  <div class="note">
   <strong class="user">paul at ensigma dot com dot au</strong>
   <a href="#46641" class="date">19-Oct-2004 02:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems a lot of people are having trouble connecting to MSDE - so did I. Eventually I got it working. The trick was to change to registered server name from (local) to be the same as the machine name (ie in the Enterprise Manager, delete the registration and then re-register it). Also, make sure TCP/IP is enabled (and I actually removed named pipes for good measure). Viola - connection successful.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46220""></a>
  <div class="note">
   <strong class="user">mworku at securiant dot com</strong>
   <a href="#46220" class="date">03-Oct-2004 01:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It looks like by default libphp5 ignores freetd's conf file if you 
<br />
specify your SQL server's ip address within the mssql_connect() function.
<br />

<br />
If you need to utilize freetds.conf file for connection parameters use the putenv function as follows
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp; putenv</span><span class="keyword">(</span><span class="string">'FREETDSCONF='</span><span class="default">path to your freetds conf</span><span class="keyword">. </span><span class="default">file</span><span class="string">')
<br />

<br />
&nbsp; /* 
<br />
&nbsp;&nbsp;&nbsp; SQL CODE
<br />
&nbsp;&nbsp;&nbsp; mssql_connect('</span><span class="default">MSSQL_2000</span><span class="keyword">, </span><span class="string">'user' </span><span class="keyword">, </span><span class="string">'pwd'</span><span class="keyword">); 
<br />
&nbsp;&nbsp;&nbsp; ....
<br />
&nbsp;&nbsp;&nbsp; ....
<br />
&nbsp; */
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
All connection parameters should now be read from the conf file. Also don't enable logging unless you're debugging, performace will suffer.
<br />

<br />
/* freetds.conf
<br />
&nbsp;[MSSQL_2000]
<br />
&nbsp;&nbsp;&nbsp; host = 192.168.10.10
<br />
&nbsp;&nbsp;&nbsp; port = 1433
<br />
&nbsp;&nbsp;&nbsp; tds version = 8.0
<br />
;&nbsp; &nbsp; dump file = /etc/freetds/log/freetds.log
<br />
;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dump file append = yes
<br />
;&nbsp; &nbsp; debug level = 99
<br />
*/</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42296""></a>
  <div class="note">
   <strong class="user">jonord at cfl dot se</strong>
   <a href="#42296" class="date">11-May-2004 03:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had problems connecting to an SQL 2000 database running on a W2K server from IIS6 on an Windows 2003 server. I got an error message saying&nbsp; "Unable to connect to server: &lt;server name&gt;" all the time. <br />
<br />
&nbsp;The 2003 server didn't have the MDAC components installed, installing the latest version (2.8 as of writing) seems to solve that problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41163""></a>
  <div class="note">
   <strong class="user">bianco at bluetone dot com</strong>
   <a href="#41163" class="date">01-Apr-2004 02:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Little idea about 255 characters limitation. :)<br />
<br />
In tables I'm using column type "varchar" or "nvarchar" instead "text". And also I use for example varchar(8000). And there is "a bug". :) PHP will read this column only as varchar(255). So how to read more then 255 chars from varchar(8000)? It is very easy, use CAST to convert varchar type to text type.<br />
<br />
select CAST(Comment as TEXT) from Job<br />
<br />
PHP will read it. Check php.ini section [MSSQL] and set maximum text length. Check parameters<br />
<br />
mssql.textlimit = 4096<br />
mssql.textsize = 4096<br />
<br />
Maximum length is 2147483647<br />
<br />
Bye</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40802""></a>
  <div class="note">
   <strong class="user">nuying117 at 163 dot com</strong>
   <a href="#40802" class="date">15-Mar-2004 04:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I came across the same question as jack,but there was no effect when i use his method.and then ,I created a user named IUSER_YOUR_COMPUTER_NAME which is the same as the user who start the IIS process,it works!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40055""></a>
  <div class="note">
   <strong class="user">markus dot amsler at oribi dot org</strong>
   <a href="#40055" class="date">20-Feb-2004 04:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Make sure you disable ANSI to OEM Conversion in your SQL Server Client Network Utility -&gt; DB Library Options if you are using these extension from the CLI. Otherwise you get encoding problems with special characters. For further information look at <a href="http://bugs.php.net/bug.php?id=27324" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=27324</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33988""></a>
  <div class="note">
   <strong class="user">jeremyirons at genevus dot com</strong>
   <a href="#33988" class="date">13-Jul-2003 02:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using MSSQL 2000 and Windows Server 2003 Enterprise running on a separate machine from the web server, I was unable to get PHP to connect to MSSQL with default Windows Server 2003 settings.&nbsp; I got it working the following way:<br />
<br />
From the Windows Server 2003 machine:<br />
Control Panel -&gt; Local Security Settings -&gt; Security Settings -&gt; Local Policies -&gt; Security Options<br />
Set "Network access: Let Everyone permissions apply to anonymous users" to Enabled<br />
<br />
There is probably a better way, but this works</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33624""></a>
  <div class="note">
   <strong class="user">S.A. Tan</strong>
   <a href="#33624" class="date">02-Jul-2003 12:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a little comment that I would like to add:<br />
<br />
If you intend to access MS SQL server remotely, you need to install SQL Server Client Tools on the system which hosts your PHP code.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32661""></a>
  <div class="note">
   <strong class="user">php at burntpopcorn dot net</strong>
   <a href="#32661" class="date">04-Jun-2003 04:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I don't see it mentioned here, but if you are using SQL Server 2000, then you should use a comma instead of a colon to specify the port, for example:<br />
<br />
$sql = mssql_connect ("192.168.1.2,1433", "username", "password") or die ("Could not connect to database: ".mssql_get_last_message());<br />
<br />
instead of:<br />
<br />
$sql = mssql_connect ("192.168.1.2:1433", "username", "password") or die ("Could not connect to database: ".mssql_get_last_message());</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29421""></a>
  <div class="note">
   <strong class="user">Gordon McCague</strong>
   <a href="#29421" class="date">13-Feb-2003 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am running PHP 4.2.1, Windows 2000, with a MSSQL Server 7.0 isolated from our web DMZ (separate DMZ for our SQL Server).<br />
<br />
mssql_connect in version 4.2.1 seems to insist on using named pipes to connect to the SQL Server. This is not secure as it requires netbios browsing (tcp/udp ports 137, 139, and 445 (with windows2000)). This is an unacceptable security risk.<br />
<br />
To resolve this issue use your MSSQL 7.0 CD to perform a&nbsp; install on your web server. Select a custom install. You will be prompted to select your components. Uncheck the "Server Components" box to avoid installing the full server offering. Leave "Client Connectivity" checked. <br />
<br />
You can leave "Management Tools" selected as well if you wish to test your connection or run queries against the database engine. Installing them may pose a security risk so some might not choose to do so. <br />
<br />
Don't forget to install the latest service pack and MDAC components once the initial installtion is complete. The MDAC components can be obtained from <a href="http://www.microsoft.com/data/ " rel="nofollow" target="_blank">http://www.microsoft.com/data/ </a><br />
<br />
SQL Service Packs can be obtained from <a href="http://www.microsoft.com/sql" rel="nofollow" target="_blank">http://www.microsoft.com/sql</a><br />
<br />
Once you have installed the updates and patchs then you need to run the "Client Network Utility" to enable TCPIP as the network protocol for connectivity to your SQL Server. <br />
<br />
You will need to enable TCPIP and also create an alias to your SQL Server for TCPIP. This process should be self-evident once you run the utility. You may want to consult the SQL online manuals for assistance if uncomfortable with the configuration.<br />
<br />
This should now allow you to access your SQL Server via ports 1433 and 1434 (or whatever you have enable as the port of communication). It is a best practice to consider changing the ports of communication to the SQL Server and I believe this can be done with the Network Client Utility (to something other than 1433 and 1434). <br />
<br />
You can always build a little test file to check your connectivity once your system is up and running.<br />
<br />
Good luck!<br />
<br />
P.S. I have not looked to see if PHP 4.3.0 resolves this issue but I don't plan to test too much. I like to know how the web servers are connected to the SQL server.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28616""></a>
  <div class="note">
   <strong class="user">Filipus</strong>
   <a href="#28616" class="date">18-Jan-2003 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Linux MDK 9.0, PHP 4.3.0 MSSQL 2000 on remote host
<br />
We used freetds (www.freetds.org) compiled with parameter:
<br />
./configure --prefix=/usr/local/freetds
<br />
PHP was compiled with parameter: 
<br />
./configure --with-mssql=/usr/local/freetds [and some others]
<br />

<br />
We added our section in /usr/local/freetds/freetds.conf
<br />
----------------------------------
<br />
[MyServer70]
<br />
host = 172.16.20.81
<br />
port = 1433
<br />
tds version = 7.0
<br />
----------------------------------
<br />
in mssql_connect() you have to provide as a hostname the name you put between [] brackets in freetds.conf OR specify host:port
<br />

<br />
$connection = mssql_connect("MyServer70", "d", "d");
<br />
or
<br />
$connection = mssql_connect("172.16.20.81:1433", "d", "d");
<br />

<br />
Remember to specify port!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26785""></a>
  <div class="note">
   <strong class="user">damien at mightyoaks dot com</strong>
   <a href="#26785" class="date">13-Nov-2002 01:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SQL Server 2000 may be listening on port 2433, instead of the default port 1433 that the MSSQL client libraries and old MSSQL servers use.&nbsp; In this case, you might end up with mssql_connect() using port 1433 and SQL Server denying the connection.<br />
<br />
If you are unable to connect, you can start by verifying the port SQL Server is listening on.&nbsp; From the database server, run Start-&gt;Program Files-&gt;Microsoft SQL Server-&gt;Server Network Utility.&nbsp; Select TCP/IP from the list of protocols and press Properties... - it will say what port the server is listening on (usually 1433 or 2433).<br />
<br />
With SQL Server 2000 SP2 I was unable to change the default TCP/IP port on the server side.&nbsp; But you can still change the default port the client libraries are using.&nbsp; On your PHP machine, first make sure you have the MS SQL server Client utilities installed, then run Start-&gt;Program Files-&gt;Microsoft SQL Server-&gt;Client Network Utility.&nbsp; Choose "TCP/IP" from the Enabled protocols list and press "Properties...".&nbsp; Enter the port number that the server is listening on here (2433 in my case).<br />
<br />
Once server and client are using the same port, PHP will be able to connect properly.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="24888""></a>
  <div class="note">
   <strong class="user">s dot westermayer at nospam-netnnet dot de</strong>
   <a href="#24888" class="date">04-Sep-2002 02:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SQL Server Authentication Mode must be set to "SQL Server and Windows" or your SQL Server will not accept a connection and diplay: <br />
Warning: MS SQL message: Login failed for user 'myuser'. Reason: Not associated with a trusted SQL Server connection. (severity 14) in...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
