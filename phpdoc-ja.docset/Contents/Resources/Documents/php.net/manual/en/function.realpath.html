<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>絶対パス名を返す</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.realpath-cache-size.html">≪ realpath_cache_size</a></li>
      <li style="float: right;"><a href="function.rename.html">rename ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.filesystem.html">ファイルシステム 関数</a></li>
    <li>絶対パス名を返す</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.realpath" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">realpath</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">realpath</span> &mdash; <span class="dc-title">絶対パス名を返す</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.realpath-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>realpath</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$path</code></span>
   )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>realpath()</strong></span> は、
   入力 <code class="parameter">path</code> のシンボリックリンクをすべて展開し、
   「/./」「/../」「/」などの参照をすべて解決することにより、正規化した絶対パスを返します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.realpath-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">path</code></dt>

     <dd>

      <p class="para">
       調べたいパス。
      </p>
       <blockquote class="note"><p><strong class="note">注意</strong>: 
        <p class="para">
         path の指定は必須ですが、空白や <strong><code>NULL</code></strong> を指定することもできます。
         その場合はカレントディレクトリを指定したものとみなします。
        </p>
       </p></blockquote>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.realpath-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合は正規化した絶対パス名を返します。
   返されるパスはシンボリックリンクや「/./」「/../」要素を含みません。
  </p>
  <p class="para">
   <span class="function"><strong>realpath()</strong></span> は、
   たとえばファイルが存在しないなどの失敗時に <strong><code>FALSE</code></strong> を返します。
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    指定した階層にあるすべてのディレクトリに対して、
    実行中のスクリプトからの実行権限が必要です。もし権限がなければ
    <span class="function"><strong>realpath()</strong></span> は <strong><code>FALSE</code></strong> を返します。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara">
    PHP の数値型は符号付整数であり、
    多くのプラットフォームでは 32 ビットの整数を取るため、
    ファイルシステム関数の中には
    2GB より大きなファイルについては期待とは違う値を返すものがあります。
   </span></p></blockquote>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.realpath-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.0</td>
       <td>
        これより前のバージョンでは、*BSD システムでは <span class="function"><strong>realpath()</strong></span>
        は最後の <code class="parameter">path</code>
        コンポーネントのみが存在しない場合には失敗となりませんでした。
        このバージョン以降では失敗となります。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>



 <div class="refsect1 examples" id="refsect1-function.realpath-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-2518">
    <p><strong>例1 <span class="function"><strong>realpath()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />chdir</span><span style="color: #007700">(</span><span style="color: #DD0000">'/var/www/'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">realpath</span><span style="color: #007700">(</span><span style="color: #DD0000">'./../../etc/passwd'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
/etc/passwd
</pre></div>
    </div>
   </div>
   <div class="example" id="example-2519">
    <p><strong>例2 Windows 上での <span class="function"><strong>realpath()</strong></span></strong></p>
    <div class="example-contents"><p>
     Windows 上で <span class="function"><strong>realpath()</strong></span>
     を実行すると、Unix 形式のパスを Windows 形式に変更します。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">realpath</span><span style="color: #007700">(</span><span style="color: #DD0000">'/windows/system32'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
C:\WINDOWS\System32
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.realpath-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.basename.html" class="function" rel="rdfs-seeAlso">basename()</a> - パスの最後にある名前の部分を返す</span></li>
    <li class="member"><span class="function"><a href="function.dirname.html" class="function" rel="rdfs-seeAlso">dirname()</a> - 親ディレクトリのパスを返す</span></li>
    <li class="member"><span class="function"><a href="function.pathinfo.html" class="function" rel="rdfs-seeAlso">pathinfo()</a> - ファイルパスに関する情報を返す</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115620""></a>
  <div class="note">
   <strong class="user">ilya-direct at ya dot ru</strong>
   <a href="#115620" class="date">27-Aug-2014 03:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's strange, but&nbsp; realpath('C:/wamp/www/sdo-test/data') sometime retuns false, use // or \ instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112724""></a>
  <div class="note">
   <strong class="user">Leonard Challis</strong>
   <a href="#112724" class="date">17-Jul-2013 04:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using realpath (and similar functions) remember that PHP will take in to account open_basedir restrictions. So, if you do something like:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// test.php in httpdocs folder<br />
</span><span class="default">$path </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) . </span><span class="string">'/../application'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
where your open_basedir setting is set to the httpdocs folder and tmp, this will return false. You must set it to the level above (or off) for this to work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112367""></a>
  <div class="note">
   <strong class="user">runeimp at gmail dot com</strong>
   <a href="#112367" class="date">07-Jun-2013 08:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Needed a method to normalize a virtual path that could handle .. references that go beyond the initial folder reference. So I created the following.<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">normalizePath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$parts </span><span class="keyword">= array();</span><span class="comment">// Array to build a new path from the good parts<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);</span><span class="comment">// Replace backslashes with forwardslashes<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\/+/'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);</span><span class="comment">// Combine multiple slashes into a single slash<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$segments </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);</span><span class="comment">// Collect path segments<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$test </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;</span><span class="comment">// Initialize testing variable<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$segments </span><span class="keyword">as </span><span class="default">$segment</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$segment </span><span class="keyword">!= </span><span class="string">'.'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$test </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$parts</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$segment</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if(</span><span class="default">$segment </span><span class="keyword">== </span><span class="string">'..'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$test </span><span class="keyword">== </span><span class="string">'..'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$test</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$test </span><span class="keyword">== </span><span class="string">'..' </span><span class="keyword">|| </span><span class="default">$test </span><span class="keyword">== </span><span class="string">''</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$segment</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$test</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$segment</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$parts</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Will convert /path/to/test/.././..//..///..///../one/two/../three/filename<br />
to ../../one/three/filename</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108879""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#108879" class="date">01-Jun-2012 01:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note: If you use this to check if a file exists, it's path will be cached, and returns true even if the file is removed (use file_exists instead).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107116""></a>
  <div class="note">
   <strong class="user">dbags</strong>
   <a href="#107116" class="date">08-Jan-2012 10:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If using Windows junction.exe to create a symlink, it seems impossible to get the real path to the file. Even __FILE__ contains the symlinked path, not the actual path of the file.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106207""></a>
  <div class="note">
   <strong class="user">php at keith tyler dot com</strong>
   <a href="#106207" class="date">18-Oct-2011 09:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that under Windows, a slash-rooted path will resolve on the local drive, and *not* necessarily C:\.<br />
<br />
For example:<br />
<br />
M:\&gt;php -r "print realpath('/AUTOEXEC.BAT');"<br />
[prints nothing, because there is no M:\AUTOEXEC.BAT]<br />
<br />
But:<br />
<br />
M:\&gt;C:<br />
C:\&gt;php -r "print realpath('/AUTOEXEC.BAT');"<br />
C:\AUTOEXEC.BAT<br />
<br />
Same script, different response depending on current drive.<br />
<br />
I'm inclined to argue that this function *should* use the value of %SystemDrive% as the "slash root" base.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105876""></a>
  <div class="note">
   <strong class="user">imagiro</strong>
   <a href="#105876" class="date">21-Sep-2011 11:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a small and handy method to calculate the relative path from $from to $to. Note: On Windows it does not work when $from and $to are on different drives.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">relativePath</span><span class="keyword">(</span><span class="default">$from</span><span class="keyword">, </span><span class="default">$to</span><span class="keyword">, </span><span class="default">$ps </span><span class="keyword">= </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$arFrom </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$ps</span><span class="keyword">, </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$from</span><span class="keyword">, </span><span class="default">$ps</span><span class="keyword">));<br />
&nbsp; </span><span class="default">$arTo </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$ps</span><span class="keyword">, </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">$ps</span><span class="keyword">));<br />
&nbsp; while(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$arFrom</span><span class="keyword">) &amp;&amp; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$arTo</span><span class="keyword">) &amp;&amp; (</span><span class="default">$arFrom</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] == </span><span class="default">$arTo</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]))<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$arFrom</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$arTo</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">str_pad</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">, </span><span class="default">count</span><span class="keyword">(</span><span class="default">$arFrom</span><span class="keyword">) * </span><span class="default">3</span><span class="keyword">, </span><span class="string">'..'</span><span class="keyword">.</span><span class="default">$ps</span><span class="keyword">).</span><span class="default">implode</span><span class="keyword">(</span><span class="default">$ps</span><span class="keyword">, </span><span class="default">$arTo</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103440""></a>
  <div class="note">
   <strong class="user">netmosfera at gmail dot com</strong>
   <a href="#103440" class="date">13-Apr-2011 06:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
please note that realpath is a performance killer<br />
<br />
on my sys listing 100 files with realpath takes 0.2 sec (core2quad 6600 x64 4gbddr2)<br />
<br />
in most cases, its better to use getcwd() instead and work with dirname() to resolve ".."</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98372""></a>
  <div class="note">
   <strong class="user">Jrg Wagner</strong>
   <a href="#98372" class="date">11-Jun-2010 09:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please be aware that this function does NOT always strip a trailing slash!:<br />
<br />
LINUX (tested with PHP 5.2.11):<br />
---<br />
realpath('.')<br />
: string = "/myhttpdfolder" <br />
realpath('./')<br />
: string = "/myhttpdfolder" <br />
realpath('fileadmin')<br />
: string = "/myhttpdfolder/fileadmin" <br />
realpath('fileadmin/')<br />
: string = "/myhttpdfolder/fileadmin" <br />
<br />
WINDOWS (tested with PHP 5.2.5):<br />
---<br />
realpath('.')<br />
: string = "C:\\myhttpdfolder" <br />
realpath('./')<br />
: string = "C:\\myhttpdfolder\\" <br />
realpath('fileadmin')<br />
: string = "C:\\myhttpdfolder\\fileadmin" <br />
realpath('fileadmin/')<br />
: string = "C:\\myhttpdfolder\\fileadmin\\"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97885""></a>
  <div class="note">
   <strong class="user">jpic</strong>
   <a href="#97885" class="date">13-May-2010 09:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is no native function that does the opposite.<br />
<br />
Pure-php implementation:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getRelativePath</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$compareTo </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// clean arguments by removing trailing and prefixing slashes<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">) == </span><span class="string">'/' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">) == </span><span class="string">'/' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$compareTo</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">) == </span><span class="string">'/' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$compareTo </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$compareTo</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$compareTo</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">) == </span><span class="string">'/' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$compareTo </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$compareTo</span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// simple case: $compareTo is in $path<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$compareTo </span><span class="keyword">) === </span><span class="default">0 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">( </span><span class="default">$compareTo </span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$relative&nbsp; </span><span class="keyword">= array(&nbsp; );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pathParts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">( </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$compareToParts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">( </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$compareTo </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$compareToParts </span><span class="keyword">as </span><span class="default">$index </span><span class="keyword">=&gt; </span><span class="default">$part </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( isset( </span><span class="default">$pathParts</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] ) &amp;&amp; </span><span class="default">$pathParts</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] == </span><span class="default">$part </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$relative</span><span class="keyword">[] = </span><span class="string">'..'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$pathParts </span><span class="keyword">as </span><span class="default">$index </span><span class="keyword">=&gt; </span><span class="default">$part </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( isset( </span><span class="default">$compareToParts</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] ) &amp;&amp; </span><span class="default">$compareToParts</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] == </span><span class="default">$part </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$relative</span><span class="keyword">[] = </span><span class="default">$part</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">implode</span><span class="keyword">( </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$relative </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Some tests forr phpunit:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">static public function </span><span class="default">getRelativePathProvider</span><span class="keyword">(&nbsp; )&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/foo/bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'foo/bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/foo/bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'foo/bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/foo/bar/'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'foo/bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/foo/bar/'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'foo/bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/foo/bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/test'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'../foo/bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/foo/bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/test/fool'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'../../foo/bar'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/mad/xp/mad/model/static/css/uni-form.css'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'/srv/mad/xp/liria/'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'../mad/model/static/css/uni-form.css'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; );<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * @dataProvider getRelativePathProvider<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">testGetRelativePath</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$compareTo</span><span class="keyword">, </span><span class="default">$expected </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">getRelativePath</span><span class="keyword">( </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$compareTo </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">( </span><span class="default">$expected</span><span class="keyword">, </span><span class="default">$result </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94942""></a>
  <div class="note">
   <strong class="user">roman dot vasicek at email dot cz</strong>
   <a href="#94942" class="date">03-Dec-2009 06:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You may want to change script behavior depending on the way how its code is invoked (included by another script / called directly). Following code do the job<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) == </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SCRIPT_FILENAME'</span><span class="keyword">])) {<br />
&nbsp; </span><span class="comment">// called directly<br />
&nbsp; </span><span class="keyword">...<br />
} else {<br />
&nbsp; </span><span class="comment">// included<br />
&nbsp; </span><span class="keyword">...<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94891""></a>
  <div class="note">
   <strong class="user">hrcerqueira at gmail dot com</strong>
   <a href="#94891" class="date">01-Dec-2009 01:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you just need to resolve a path that is not on your system, or you don't want to chdir to it, a simple regular expression can do the trick:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$p </span><span class="keyword">= </span><span class="string">'/cool/yeah/../zzz'</span><span class="keyword">;<br />
<br />
</span><span class="default">$p </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/\w+\/\.\.\//'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$p</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$p</span><span class="keyword">; </span><span class="comment">//outputs /cool/zzz<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90337""></a>
  <div class="note">
   <strong class="user">orssey</strong>
   <a href="#90337" class="date">16-Apr-2009 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">Class </span><span class="default">RealPath<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$ServerPath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$ScriptPath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$AddSlashEnd</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">AddSlashEnd </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ServerPath </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ScriptPath </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SCRIPT_FILENAME'</span><span class="keyword">]), </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ServerPath</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">Server</span><span class="keyword">(</span><span class="default">$adress</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ThisPath </span><span class="keyword">= @</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$adress</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ThisPathLength </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$ThisPath</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$ThisPath</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ServerPath</span><span class="keyword">), </span><span class="default">$ThisPathLength</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">Absolute</span><span class="keyword">(</span><span class="default">$adress</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SERVER_NAME'</span><span class="keyword">] . </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Server</span><span class="keyword">(</span><span class="default">$adress</span><span class="keyword">) . </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">AddSlashEnd</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">RelativeServer</span><span class="keyword">(</span><span class="default">$adress</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Server</span><span class="keyword">(</span><span class="default">$adress</span><span class="keyword">) . </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">AddSlashEnd</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">RelativeScript</span><span class="keyword">(</span><span class="default">$adress</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ScriptExplode </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ScriptPath</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ServerExplode </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">Server</span><span class="keyword">(</span><span class="default">$adress</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$TmpCount </span><span class="keyword">= </span><span class="default">$ScriptCount </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$ScriptExplode</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ServerCount </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$ServerExplode</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ReturnPath </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$TmpCount</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$ScriptExplode</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] == </span><span class="default">$ServerExplode</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; --</span><span class="default">$ScriptCount</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$ScriptCount</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ReturnPath </span><span class="keyword">.= </span><span class="string">"/.."</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$TmpCount </span><span class="keyword">- </span><span class="default">$ScriptCount </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$ServerCount</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ReturnPath </span><span class="keyword">.= </span><span class="string">"/" </span><span class="keyword">. </span><span class="default">$ServerExplode</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$ReturnPath </span><span class="keyword">. </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">AddSlashEnd</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">AddSlash</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_bool</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">AddSlashEnd </span><span class="keyword">= (</span><span class="default">$value</span><span class="keyword">)? </span><span class="string">"/" </span><span class="keyword">: </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
</span><span class="default">example</span><span class="keyword">:<br />
<br />
</span><span class="default">$ObjectPath </span><span class="keyword">= new </span><span class="default">RealPath</span><span class="keyword">;<br />
</span><span class="default">$ObjectPath</span><span class="keyword">-&gt;</span><span class="default">RelativeScript</span><span class="keyword">(</span><span class="string">"../a/b../c/d/f../g../h"</span><span class="keyword">);</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88964""></a>
  <div class="note">
   <strong class="user">info[at]adico.co.il</strong>
   <a href="#88964" class="date">15-Feb-2009 11:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
for those who want to start realpath on windows platform and looking for example.
<br />

<br />
OR
<br />

<br />
for those who want to run zend framework on windows platform using the quick start guide 
<br />

<br />
<span class="default">&lt;?php
<br />
define</span><span class="keyword">( </span><span class="string">"_CUR_OS"</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">( </span><span class="default">php_uname</span><span class="keyword">( ), </span><span class="default">0</span><span class="keyword">, </span><span class="default">7 </span><span class="keyword">) == </span><span class="string">"Windows" </span><span class="keyword">? </span><span class="string">"Win" </span><span class="keyword">: </span><span class="string">"_Nix" </span><span class="keyword">);
<br />

<br />
function </span><span class="default">checkCurrentOS</span><span class="keyword">( </span><span class="default">$_OS </span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">strcmp</span><span class="keyword">( </span><span class="default">$_OS</span><span class="keyword">, </span><span class="default">_CUR_OS </span><span class="keyword">) == </span><span class="default">0 </span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="comment">// public/index.php
<br />
//
<br />
// Step 1: APPLICATION_PATH is a constant pointing to our
<br />
// application/subdirectory. We use this to add our "library" directory
<br />
// to the include_path, so that PHP can find our Zend Framework classes.
<br />

<br />
</span><span class="keyword">if ( </span><span class="default">checkCurrentOS</span><span class="keyword">( </span><span class="string">"Win" </span><span class="keyword">) ) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mappath </span><span class="keyword">= </span><span class="string">'/' </span><span class="keyword">. </span><span class="default">str_replace</span><span class="keyword">( </span><span class="string">"\\"</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="default">str_replace</span><span class="keyword">( </span><span class="string">"C:\\"</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">, </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) ) );
<br />
}
<br />
else {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mappath </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">);
<br />
}
<br />

<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'APPLICATION_PATH'</span><span class="keyword">, </span><span class="default">realpath</span><span class="keyword">(&nbsp; </span><span class="default">$mappath </span><span class="keyword">. </span><span class="string">'/../_privateadico/application/'</span><span class="keyword">) );
<br />
</span><span class="default">set_include_path</span><span class="keyword">(
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">APPLICATION_PATH </span><span class="keyword">. </span><span class="string">'/../library' 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">. </span><span class="default">PATH_SEPARATOR </span><span class="keyword">. </span><span class="default">get_include_path</span><span class="keyword">()
<br />
);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
I took the index.php for zend which is was written for unix and ported it to windows.
<br />

<br />
The porting problem was with realpath function not understanding dirname(__FILE__) syntex on windows</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85388""></a>
  <div class="note">
   <strong class="user">Isaac Z. Schlueter i at foohack dot com</strong>
   <a href="#85388" class="date">28-Aug-2008 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need to resolve a url against a base url, as the browser does with anchor tags, then realpath won't help, because it's not on your file system.
<br />

<br />
This function does that:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">resolve_href </span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">, </span><span class="default">$href</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// href="" ==&gt; current url.
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$href</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$base</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// href="<a href="http://..." rel="nofollow" target="_blank">http://...</a>" ==&gt; href isn't relative
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rel_parsed </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="default">$href</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="string">'scheme'</span><span class="keyword">, </span><span class="default">$rel_parsed</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$href</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// add an extra character so that, if it ends in a /, we don't lose the last piece.
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$base_parsed </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="string">"</span><span class="default">$base</span><span class="string"> "</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// if it's just server.com and no path, then put a / there.
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="string">'path'</span><span class="keyword">, </span><span class="default">$base_parsed</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base_parsed </span><span class="keyword">= </span><span class="default">parse_url</span><span class="keyword">(</span><span class="string">"</span><span class="default">$base</span><span class="string">/ "</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// href="/ ==&gt; throw away current path.
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$href</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} === </span><span class="string">"/"</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">$href</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$base_parsed</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">]) . </span><span class="string">"/</span><span class="default">$href</span><span class="string">"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// bla/./bloo ==&gt; bla/bloo
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'~/\./~'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// resolve /../
<br />
&nbsp;&nbsp;&nbsp; // loop through all the parts, popping whenever there's a .., pushing otherwise.
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts </span><span class="keyword">= array();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'~/+~'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">)) as </span><span class="default">$part
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">) if (</span><span class="default">$part </span><span class="keyword">=== </span><span class="string">".."</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$parts</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } elseif (</span><span class="default">$part</span><span class="keyword">!=</span><span class="string">""</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts</span><span class="keyword">[] = </span><span class="default">$part</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; return (
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="string">'scheme'</span><span class="keyword">, </span><span class="default">$base_parsed</span><span class="keyword">)) ?
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base_parsed</span><span class="keyword">[</span><span class="string">'scheme'</span><span class="keyword">] . </span><span class="string">'://' </span><span class="keyword">. </span><span class="default">$base_parsed</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">] : </span><span class="string">""
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">) . </span><span class="string">"/" </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$parts</span><span class="keyword">);
<br />

<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
[EDIT BY danbrown AT php DOT net:&nbsp; Code contains a bugfix supplied by (Zhenya DOT Morozov AT gmail DOT com) on 23-JAN-09, to address the following issue:
<br />
'If your path contains "0" (or any "false" string) directory name, the function removes that directory from the path.']</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84012""></a>
  <div class="note">
   <strong class="user">Sven Arduwie</strong>
   <a href="#84012" class="date">24-Jun-2008 12:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Because realpath() does not work on files that do not<br />
exist, I wrote a function that does.<br />
It replaces (consecutive) occurences of / and \\ with<br />
whatever is in DIRECTORY_SEPARATOR, and processes /. and /.. fine.<br />
Paths returned by get_absolute_path() contain no<br />
(back)slash at position 0 (beginning of the string) or<br />
position -1 (ending)<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">get_absolute_path</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">'/'</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">), </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parts </span><span class="keyword">= </span><span class="default">array_filter</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">), </span><span class="string">'strlen'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$absolutes </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$parts </span><span class="keyword">as </span><span class="default">$part</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="string">'.' </span><span class="keyword">== </span><span class="default">$part</span><span class="keyword">) continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="string">'..' </span><span class="keyword">== </span><span class="default">$part</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$absolutes</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$absolutes</span><span class="keyword">[] = </span><span class="default">$part</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$absolutes</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
A test:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; var_dump</span><span class="keyword">(</span><span class="default">get_absolute_path</span><span class="keyword">(</span><span class="string">'this/is/../a/./test/.///is'</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span>Returns: string(14) "this/a/test/is" <br />
<br />
As you can so, it also produces Yoda-speak. :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83705""></a>
  <div class="note">
   <strong class="user">waldemar dot axdorph at gmail dot com</strong>
   <a href="#83705" class="date">08-Jun-2008 05:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made this function so that I could see if a user was trying to go above the current directory.<br />
<br />
My top dir:<br />
/var/www/dir/<br />
<br />
User wanted<br />
/var/www/<br />
<br />
This comes in handy when you're making a php explorer/filemanager and you want your files in the directory above to be private.<br />
<br />
Here it is<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//usage<br />
//$dir is the dir you are in<br />
//$dir_top is the highest dir allowed.<br />
<br />
//example<br />
/*<br />
if(above_dir('../', '/var/www/filemgr'))<br />
&nbsp;&nbsp;&nbsp; die('Not allowed. Please stick to your directories');<br />
*/<br />
</span><span class="keyword">function </span><span class="default">above_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$dir_top</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$dir </span><span class="keyword">== </span><span class="default">$dir_top</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir_top </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$dir_top</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$dir</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir_top </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$dir_top</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$dir </span><span class="keyword">&lt;= </span><span class="default">$dir_top</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81935""></a>
  <div class="note">
   <strong class="user">131 dot php at cloudyks dot org</strong>
   <a href="#81935" class="date">20-Mar-2008 02:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="comment">//rp like, working with absolute/relative path &amp; a little bit shorter :p 
<br />

<br />
</span><span class="keyword">function </span><span class="default">rp</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">=array();
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">) as </span><span class="default">$i</span><span class="keyword">=&gt;</span><span class="default">$fold</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$fold</span><span class="keyword">==</span><span class="string">'' </span><span class="keyword">|| </span><span class="default">$fold</span><span class="keyword">==</span><span class="string">'.'</span><span class="keyword">) continue;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$fold</span><span class="keyword">==</span><span class="string">'..' </span><span class="keyword">&amp;&amp; </span><span class="default">$i</span><span class="keyword">&gt;</span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">end</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">)!=</span><span class="string">'..'</span><span class="keyword">) </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; else </span><span class="default">$out</span><span class="keyword">[]= </span><span class="default">$fold</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; } return (</span><span class="default">$path</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">}==</span><span class="string">'/'</span><span class="keyword">?</span><span class="string">'/'</span><span class="keyword">:</span><span class="string">''</span><span class="keyword">).</span><span class="default">join</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$out</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78224""></a>
  <div class="note">
   <strong class="user">alex at bartl dot net</strong>
   <a href="#78224" class="date">03-Oct-2007 05:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes it is helpful to check for the existance of a file
<br />
which might be found by using the include_path like in 
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">include(</span><span class="string">"file_from_include_path.php"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
A simple function iterates the include_path and tries all
<br />
possibilites, returns translated_local_path on success or false
<br />
if not found.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">mappath</span><span class="keyword">(</span><span class="default">$path_to_translate</span><span class="keyword">){
<br />
&nbsp; </span><span class="default">$IncludePath</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="default">PATH_SEPARATOR</span><span class="keyword">,</span><span class="default">get_include_path</span><span class="keyword">());
<br />
&nbsp; foreach(</span><span class="default">$IncludePath </span><span class="keyword">as </span><span class="default">$prefix</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$prefix</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">)==</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$prefix</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$prefix</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$try_path</span><span class="keyword">=</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%s%s%s"
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">,</span><span class="default">$prefix</span><span class="keyword">,</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">,</span><span class="default">$path_to_translate</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$try_path</span><span class="keyword">))return(</span><span class="default">$try_path</span><span class="keyword">);
<br />
&nbsp; }
<br />
&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77968""></a>
  <div class="note">
   <strong class="user">alban dot lopez+php dot net at gmail dot com</strong>
   <a href="#77968" class="date">21-Sep-2007 09:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a little function to return the shortest relative path between dest folder and current folder (you can be replace $_SERVER['PHP_SEFL'] by your variable folder) :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// if you run in /var/www/<br />
<br />
</span><span class="keyword">echo </span><span class="default">UnRealPath </span><span class="keyword">(</span><span class="string">'./'</span><span class="keyword">); </span><span class="comment">// return "./"<br />
</span><span class="keyword">echo </span><span class="default">UnRealPath </span><span class="keyword">(</span><span class="string">'./ajax-browser/AJAX-B/scripts/'</span><span class="keyword">); </span><span class="comment">// return "./ajax-browser/AJAX-B/scripts/"<br />
</span><span class="keyword">echo </span><span class="default">UnRealPath </span><span class="keyword">(</span><span class="string">'/var/'</span><span class="keyword">); </span><span class="comment">// return "./../"<br />
</span><span class="keyword">echo </span><span class="default">UnRealPath </span><span class="keyword">(</span><span class="string">'/opt/picasa/wine/'</span><span class="keyword">); </span><span class="comment">// return "./../../opt/picasa/wine/"<br />
<br />
</span><span class="keyword">function </span><span class="default">UnRealPath </span><span class="keyword">(</span><span class="default">$dest</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Ahere </span><span class="keyword">= </span><span class="default">explode </span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SEFL'</span><span class="keyword">]));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Adest </span><span class="keyword">= </span><span class="default">explode </span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$dest</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">; </span><span class="comment">// le chemin retoune dois forcement commance par ./&nbsp;&nbsp; c'est le but<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">while (</span><span class="default">implode </span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$Adest</span><span class="keyword">) != </span><span class="default">implode </span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$Ahere</span><span class="keyword">))</span><span class="comment">// &amp;&amp; count ($Adest)&gt;0 &amp;&amp; count($Ahere)&gt;0 )<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$Ahere</span><span class="keyword">)&gt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$Adest</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$Ahere</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">.= </span><span class="string">'/..'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$Adest</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'//'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">.</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">implode </span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$Adest</span><span class="keyword">), </span><span class="string">''</span><span class="keyword">, </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$dest</span><span class="keyword">)).(@</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$dest</span><span class="keyword">))?</span><span class="string">'/'</span><span class="keyword">:</span><span class="string">''</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77203""></a>
  <div class="note">
   <strong class="user">Santosh Patnaik</strong>
   <a href="#77203" class="date">20-Aug-2007 11:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Given real paths of two files, this function finds the relative path of one ($dest) with respect to the other ($root).
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">echo </span><span class="default">rel_path</span><span class="keyword">(</span><span class="string">'a/b/c'</span><span class="keyword">, </span><span class="string">'d/e'</span><span class="keyword">); </span><span class="comment">// './../../a/b/c'
<br />
</span><span class="keyword">echo </span><span class="default">rel_path</span><span class="keyword">(</span><span class="string">'a/b/c'</span><span class="keyword">, </span><span class="string">'a/b/c/d/e'</span><span class="keyword">); </span><span class="comment">// './../..'
<br />
</span><span class="keyword">echo </span><span class="default">rel_path</span><span class="keyword">(</span><span class="string">'a/b/c/d/e'</span><span class="keyword">, </span><span class="string">'a/b/c'</span><span class="keyword">); </span><span class="comment">// './d/e'
<br />

<br />
</span><span class="keyword">function </span><span class="default">rel_path</span><span class="keyword">(</span><span class="default">$dest</span><span class="keyword">, </span><span class="default">$root </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$dir_sep </span><span class="keyword">= </span><span class="string">'/'</span><span class="keyword">)
<br />
{
<br />
&nbsp;</span><span class="default">$root </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$dir_sep</span><span class="keyword">, </span><span class="default">$root</span><span class="keyword">);
<br />
&nbsp;</span><span class="default">$dest </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$dir_sep</span><span class="keyword">, </span><span class="default">$dest</span><span class="keyword">);
<br />
&nbsp;</span><span class="default">$path </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">;
<br />
&nbsp;</span><span class="default">$fix </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;</span><span class="default">$diff </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;for(</span><span class="default">$i </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">; ++</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">max</span><span class="keyword">((</span><span class="default">$rC </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$root</span><span class="keyword">)), (</span><span class="default">$dC </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$dest</span><span class="keyword">)));)
<br />
&nbsp;{
<br />
&nbsp; if(isset(</span><span class="default">$root</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) and isset(</span><span class="default">$dest</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])) 
<br />
&nbsp; {
<br />
&nbsp;&nbsp; if(</span><span class="default">$diff</span><span class="keyword">)
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">.= </span><span class="default">$dir_sep</span><span class="keyword">. </span><span class="string">'..'</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fix </span><span class="keyword">.= </span><span class="default">$dir_sep</span><span class="keyword">. </span><span class="default">$dest</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; continue;
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; if(</span><span class="default">$root</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] != </span><span class="default">$dest</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$diff </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">.= </span><span class="default">$dir_sep</span><span class="keyword">. </span><span class="string">'..'</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fix </span><span class="keyword">.= </span><span class="default">$dir_sep</span><span class="keyword">. </span><span class="default">$dest</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; continue;
<br />
&nbsp;&nbsp; }
<br />
&nbsp; }
<br />
&nbsp; elseif(!isset(</span><span class="default">$root</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) and isset(</span><span class="default">$dest</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]))
<br />
&nbsp; {
<br />
&nbsp;&nbsp; for(</span><span class="default">$j </span><span class="keyword">= </span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">; ++</span><span class="default">$j </span><span class="keyword">&lt; </span><span class="default">$dC</span><span class="keyword">;)
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fix </span><span class="keyword">.= </span><span class="default">$dir_sep</span><span class="keyword">. </span><span class="default">$dest</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">];
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; break;
<br />
&nbsp; }
<br />
&nbsp; elseif(isset(</span><span class="default">$root</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) and !isset(</span><span class="default">$dest</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]))
<br />
&nbsp; {
<br />
&nbsp;&nbsp; for(</span><span class="default">$j </span><span class="keyword">= </span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">; ++</span><span class="default">$j </span><span class="keyword">&lt; </span><span class="default">$rC</span><span class="keyword">;)
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fix </span><span class="keyword">= </span><span class="default">$dir_sep</span><span class="keyword">. </span><span class="string">'..'</span><span class="keyword">. </span><span class="default">$fix</span><span class="keyword">;
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; break;
<br />
&nbsp; } 
<br />
&nbsp;}
<br />
&nbsp; return </span><span class="default">$path</span><span class="keyword">. </span><span class="default">$fix</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76646""></a>
  <div class="note">
   <strong class="user">berglov1 at hotmail dot com</strong>
   <a href="#76646" class="date">24-Jul-2007 04:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There might be other solutions like mine in here, <br />
but here is one more.<br />
<br />
This function converts Virtual Paths into Relative Paths. <br />
I needed that at one time, and I did'nt have much luck finding a solution amongst the PHP Functions in the manual.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">GetPath</span><span class="keyword">(</span><span class="default">$RedPath</span><span class="keyword">) {<br />
<br />
&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$RedPath</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) == </span><span class="string">"/"</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$SysPath </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">]); <br />
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$RedPath</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">) == </span><span class="string">"/"</span><span class="keyword">) </span><span class="default">$RedPath </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$RedPath</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$SysPath</span><span class="keyword">) == </span><span class="default">1</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="string">"."</span><span class="keyword">.</span><span class="default">$RedPath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; elseif(</span><span class="default">strcmp</span><span class="keyword">(</span><span class="default">$SysPath</span><span class="keyword">,</span><span class="default">$RedPath</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="string">"./"</span><span class="keyword">;&nbsp; <br />
<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$s_tmp </span><span class="keyword">= </span><span class="default">split</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$SysPath</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$r_tmp </span><span class="keyword">= </span><span class="default">split</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$RedPath</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; while((</span><span class="default">$r_tmp</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] == </span><span class="default">$s_tmp</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) &amp;&amp; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$t_RedPath </span><span class="keyword">= </span><span class="default">end</span><span class="keyword">(</span><span class="default">split</span><span class="keyword">(</span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$RedPath</span><span class="keyword">, (</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">)));&nbsp; <br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(</span><span class="default">$i </span><span class="keyword">== </span><span class="default">count</span><span class="keyword">(</span><span class="default">$s_tmp</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">"./"</span><span class="keyword">.</span><span class="default">$t_RedPath</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"../"</span><span class="keyword">, </span><span class="default">count</span><span class="keyword">(</span><span class="default">$s_tmp</span><span class="keyword">)-</span><span class="default">$i</span><span class="keyword">).</span><span class="default">$t_RedPath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; else<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$RedPath</span><span class="keyword">;<br />
<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76453""></a>
  <div class="note">
   <strong class="user">julabz at laposte dot net</strong>
   <a href="#76453" class="date">16-Jul-2007 08:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a little function to return the relative path between two urls:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">get_relative_path</span><span class="keyword">(</span><span class="default">$start_dir</span><span class="keyword">, </span><span class="default">$final_dir</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$firstPathParts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$start_dir</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$secondPathParts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$final_dir</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sameCounter </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">min</span><span class="keyword">( </span><span class="default">count</span><span class="keyword">(</span><span class="default">$firstPathParts</span><span class="keyword">), </span><span class="default">count</span><span class="keyword">(</span><span class="default">$secondPathParts</span><span class="keyword">) ); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$firstPathParts</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) !== </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$secondPathParts</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sameCounter</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$sameCounter </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$final_dir</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newPath </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$sameCounter</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$firstPathParts</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$i </span><span class="keyword">&gt; </span><span class="default">$sameCounter </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newPath </span><span class="keyword">.= </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newPath </span><span class="keyword">.= </span><span class="string">".."</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">count</span><span class="keyword">(</span><span class="default">$newPath</span><span class="keyword">) == </span><span class="default">0 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newPath </span><span class="keyword">= </span><span class="string">"."</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$sameCounter</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$secondPathParts</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newPath </span><span class="keyword">.= </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newPath </span><span class="keyword">.= </span><span class="default">$secondPathParts</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$newPath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75992""></a>
  <div class="note">
   <strong class="user">richpageau at yahoo dot co dot uk</strong>
   <a href="#75992" class="date">26-Jun-2007 08:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is my attempt at writing a realpath replacement. I needed to to run some Adobe code on a server with realpath disabled and this seemed to do the job. It is written for a unix server, I suppose it could be made cross platform using DIRECTORY_SEPARATOR. (With thanks to Marc Noirot for his code).
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">myRealPath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) {
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// check if path begins with "/" ie. is absolute
<br />
&nbsp;&nbsp;&nbsp; // if it isnt concat with script path
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="string">"/"</span><span class="keyword">) !== </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base</span><span class="keyword">=</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SCRIPT_FILENAME'</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path</span><span class="keyword">=</span><span class="default">$base</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$path</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// canonicalize
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$newpath</span><span class="keyword">=array();
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$path</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]===</span><span class="string">'' </span><span class="keyword">|| </span><span class="default">$path</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]===</span><span class="string">'.'</span><span class="keyword">) continue;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$path</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]===</span><span class="string">'..'</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$newpath</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_push</span><span class="keyword">(</span><span class="default">$newpath</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$finalpath</span><span class="keyword">=</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">implode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$newpath</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// check then return valid path or filename
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$finalpath</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return (</span><span class="default">$finalpath</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; else return </span><span class="default">FALSE</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71334""></a>
  <div class="note">
   <strong class="user">David Beck</strong>
   <a href="#71334" class="date">23-Nov-2006 04:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a function to canonicalize a URL containing relative paths. Ran into the problem when pulling links from a remote page.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">canonicalize</span><span class="keyword">(</span><span class="default">$address</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$address </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$address</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$keys </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$address</span><span class="keyword">, </span><span class="string">'..'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$keys </span><span class="keyword">AS </span><span class="default">$keypos </span><span class="keyword">=&gt; </span><span class="default">$key</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_splice</span><span class="keyword">(</span><span class="default">$address</span><span class="keyword">, </span><span class="default">$key </span><span class="keyword">- (</span><span class="default">$keypos </span><span class="keyword">* </span><span class="default">2 </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">), </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$address </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$address</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$address </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'./'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$address</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$url </span><span class="keyword">= </span><span class="string">'<a href="http://www.example.com/something/../else" rel="nofollow" target="_blank">http://www.example.com/something/../else</a>'</span><span class="keyword">;<br />
echo </span><span class="default">canonicalize</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">); </span><span class="comment">//<a href="http://www.example.com/else" rel="nofollow" target="_blank">http://www.example.com/else</a><br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54951""></a>
  <div class="note">
   <strong class="user">php.netatjulian-lemburg.de</strong>
   <a href="#54951" class="date">20-Jul-2005 05:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You have a realpath.<br />
Now you want a htmlpath.<br />
<br />
First Suggestion:<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">htmlpath</span><span class="keyword">(</span><span class="default">$relative_path</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="default">$realpath</span><span class="keyword">=</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$relative_path</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$htmlpath</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">],</span><span class="string">''</span><span class="keyword">,</span><span class="default">$realpath</span><span class="keyword">);<br />
&nbsp;&nbsp; return </span><span class="default">$htmlpath</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
But this does not work on some servers.<br />
<br />
Second Suggestion:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">htmlpath</span><span class="keyword">(</span><span class="default">$realpath</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$_ENV</span><span class="keyword">[</span><span class="string">"SCRIPT_URL"</span><span class="keyword">],</span><span class="string">'/'</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">$baserealpath</span><span class="keyword">=</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">'../'</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp; </span><span class="default">$htmlpath</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$baserealpath</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$realpath</span><span class="keyword">);<br />
&nbsp;&nbsp; return </span><span class="default">$htmlpath</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53668""></a>
  <div class="note">
   <strong class="user">Lars Scheithauer &lt;l dot scheithauer at gmx dot de&gt;</strong>
   <a href="#53668" class="date">08-Jun-2005 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function is also nice to test for security-breaches. You can forbid the script to access files below a certain directory to prevent "../../../etc/shadow" and similar attacks:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// declare the basic directory for security reasons<br />
// Please do NOT attach a "/"-suffix !<br />
</span><span class="default">$basedir </span><span class="keyword">= </span><span class="string">'/var/www/cgi-bin/scriptfolder'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// compare the entered path with the basedir<br />
</span><span class="default">$path_parts </span><span class="keyword">= </span><span class="default">pathinfo</span><span class="keyword">(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'file_to_get'</span><span class="keyword">]);<br />
if (</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$path_parts</span><span class="keyword">[</span><span class="string">'dirname'</span><span class="keyword">]) != </span><span class="default">$basedir</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* appropriate action against crack-attempt*/<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">die (</span><span class="string">'coding good - h4x1ng bad!'</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The url "script.php?file_to_get=../../../etc/shadow" will now result in an error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48361""></a>
  <div class="note">
   <strong class="user">pulstar at ig dot com dot br</strong>
   <a href="#48361" class="date">20-Dec-2004 10:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes you may need to refer to the absolute path of a file in your website instead of a relative path, but the realpath() function returns the path relative to the server's filesystem, not a path relative to your website root directory. <br />
<br />
For example, realpath() may return something like this:<br />
<br />
/home/yoursite/public_html/dir1/file.ext<br />
<br />
You can't use this in an HTML document, because the web server will not find the file. To do so, you can use:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">htmlpath</span><span class="keyword">(</span><span class="default">$relative_path</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$realpath</span><span class="keyword">=</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$relative_path</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$htmlpath</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">],</span><span class="string">''</span><span class="keyword">,</span><span class="default">$realpath</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$htmlpath</span><span class="keyword">;<br />
}<br />
<br />
echo </span><span class="string">'&lt;img src="'</span><span class="keyword">,</span><span class="default">htmlpath</span><span class="keyword">(</span><span class="string">'../../relative/path/to/file.ext'</span><span class="keyword">),</span><span class="string">'" border=1&gt;'</span><span class="keyword">; <br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
It will return something like:<br />
<br />
&lt;img src="/dir1/relative/path/to/file.ext" border=1&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="23415""></a>
  <div class="note">
   <strong class="user">eric at themepark dot com</strong>
   <a href="#23415" class="date">18-Jul-2002 03:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
note that realpath() will chop any trailing delimiter like \ or / ...don't forget to add it back on if you need it.<br />
<br />
Eric Mueller - themepark.com</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13842""></a>
  <div class="note">
   <strong class="user">jemptyg at rwmc dot net</strong>
   <a href="#13842" class="date">06-Jul-2001 12:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
realpath() seems to be equivalent to ASP's Server.MapPath.&nbsp; On my Win2k box I have successfully used realpath() to give me the full path for a file outside of the document_root.&nbsp; This will be very useful in conjunction with is_dir and/or is_file, which require a full path.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="8126""></a>
  <div class="note">
   <strong class="user">jerome at dot451 dot com</strong>
   <a href="#8126" class="date">28-Aug-2000 09:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mkdir (and realpath) did not work because i'd used virtual() function to replace server side include in my file.
<br />
And i've just seen that virtual() function changes the current directory ... that's why !
<br />

<br />
jerome ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
