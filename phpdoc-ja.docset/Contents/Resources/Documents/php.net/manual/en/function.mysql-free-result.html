<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>結果保持用メモリを開放する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mysql-field-type.html">≪ mysql_field_type</a></li>
      <li style="float: right;"><a href="function.mysql-get-client-info.html">mysql_get_client_info ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mysql.html">MySQL 関数</a></li>
    <li>結果保持用メモリを開放する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mysql-free-result" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysql_free_result</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mysql_free_result</span> &mdash; <span class="dc-title">結果保持用メモリを開放する</span></p>

 </div>

 <div id="function.mysql-free-result-refsynopsisdiv">
  <div class="warning"><strong class="warning">警告</strong>
   <p class="para">
この拡張モジュールは PHP 5.5.0 で非推奨になりました。将来のバージョンで削除される予定です。
<a href="book.mysqli.html" class="link">MySQLi</a> あるいは
<a href="ref.pdo-mysql.html" class="link">PDO_MySQL</a> を使うべきです。詳細な情報は
<a href="mysqlinfo.api.choosing.html" class="link">MySQL: API の選択</a> や
<a href="faq.databases.html#faq.databases.mysql.deprecated" class="link">それに関連する FAQ</a> を参照ください。
この関数の代替として、これらが使えます。</p>
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli-result.free.html" class="function">mysqli_free_result()</a></span></li>
    <li class="member"><strong><code>NULL</code></strong> を PDO オブジェクトに代入、あるいは <span class="methodname"><a href="pdostatement.closecursor.html" class="methodname">PDOStatement::closeCursor()</a></span></li>
   </ul>
  </div>
 </div>

 <div class="refsect1 description" id="refsect1-function.mysql-free-result-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>mysql_free_result</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result</code></span>
   )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>mysql_free_result()</strong></span> は、結果 ID <code class="parameter">result</code>
   に関するすべてのメモリを開放します。
  </p>
  <p class="para">
   <span class="function"><strong>mysql_free_result()</strong></span> は、
   スクリプト実行のメモリの使用量が多すぎると懸念される場合にのみ
   必要になります。指定した結果 ID に関する全ての結果保持用メモリは、
   スクリプトの実行後に自動的に開放されます。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mysql-free-result-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>
<code class="parameter">
result</code></dt>
<dd>
<p class="para">評価された結果 <span class="type"><span class="type リソース">リソース</span></span>。
この結果は、<span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span> のコールにより得られたものです。</p>
</dd>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysql-free-result-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
  <p class="para">
   <code class="parameter">result</code> がリソースではなかった場合、
   E_WARNING レベルのエラーが発生します。
   <span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span> が <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>
   を返すのは SELECT, SHOW, EXPLAIN, そして DESCRIBE
   の場合だけであることに注意しましょう。
  </p>
 </div>

 
  <div class="refsect1 examples" id="refsect1-function.mysql-free-result-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-1672">
    <p><strong>例1 <span class="function"><strong>mysql_free_result()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;id,email&nbsp;FROM&nbsp;people&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;'42'"</span><span style="color: #007700">);<br />if&nbsp;(!</span><span style="color: #0000BB">$result</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Could&nbsp;not&nbsp;run&nbsp;query:&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /></span><span style="color: #FF8000">/*&nbsp;結果を利用する。ここでは、その後結果を利用したものと仮定する&nbsp;*/<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;結果を開放し、さらにスクリプトの処理を進める&nbsp;*/<br /></span><span style="color: #0000BB">mysql_free_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'id'</span><span style="color: #007700">];<br />echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">'email'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mysql-free-result-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    下位互換のために、次の非推奨別名を使用してもいいでしょう。
    <span class="function"><strong>mysql_freeresult()</strong></span>
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysql-free-result-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mysql-query.html" class="function" rel="rdfs-seeAlso">mysql_query()</a> - MySQL クエリを送信する</span></li>
    <li class="member"><span class="function"><a href="function.is-resource.html" class="function" rel="rdfs-seeAlso">is_resource()</a> - 変数がリソースかどうかを調べる</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="102949""></a>
  <div class="note">
   <strong class="user">webmaster at bluesting dot co dot za</strong>
   <a href="#102949" class="date">16-Mar-2011 01:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mysql_query() also returns a resource for "OPTIMIZE TABLE" statements!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83880""></a>
  <div class="note">
   <strong class="user">webmaster at wforums dot net</strong>
   <a href="#83880" class="date">16-Jun-2008 10:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I agree with Joachim Kruyswijk (posted on 14-Jun-2005 11:42). I just did the test on my beta version of my new site (who needs to get dynamically news and user login from a database) and i use 1000kb less memory when i do not use mysql_free_result. I guess it is because the data it needs to load are not that large (for news: date, short description and for the user login: username, password). It may only be in the user control panel that it will be more, but since that isn't developed totally yet, i'll have to test :p</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81891""></a>
  <div class="note">
   <strong class="user">admin at ifyouwantblood dot de</strong>
   <a href="#81891" class="date">18-Mar-2008 09:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
yes this function may increase the memory usage if you use unbuffered querys and if you have not fetched all the data from mysql. in this case the mysql api has a problem: you want to free the result but do not want to close the connection. now mysql will only accept another query if all data has been fetched, so the api now must fetch the rest of the data when calling mysql_free_result().<br />
<br />
so only use unbuffered querys if you fetch all the data (and need it).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71289""></a>
  <div class="note">
   
   <a href="#71289" class="date">21-Nov-2006 11:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're seeing warnings like "Warning: Unknown: 6 result set(s) not freed. Use mysql_free_result to free result sets which were requested using mysql_query() in Unknown on line 0" and want to turn them off, set mysql.trace_mode = Off in your php.ini</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56958""></a>
  <div class="note">
   <strong class="user">mdeininger at jyujin dot de</strong>
   <a href="#56958" class="date">20-Sep-2005 01:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
yes, i encountered that too. as far as i could tell, that's because the script is stored in memory after being compiled and that's as much more memory as it needs for a call to that function.<br />
<br />
if you always get lotsa data in your results, using this function will decrease memory usage tho, unless you use non-buffered queries (which are preferable unless you absolutely *have* to use mysql_seek(), or you need to do another query while the last one hasn't finished reporting back, as they can provide a small speedup)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54390""></a>
  <div class="note">
   <strong class="user">macronesia at macronesia dot net</strong>
   <a href="#54390" class="date">02-Jul-2005 09:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You not need to use this if you are using PHP 4.<br />
<br />
The comment below this comment may explain why it's actually costing more memory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53816""></a>
  <div class="note">
   <strong class="user">Joachim Kruyswijk</strong>
   <a href="#53816" class="date">14-Jun-2005 11:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using this function may actually increase the amount of memory used. In my case, the script used 208 bytes less memory when *not* using mysql_free_result().<br />
Check for yourself: call memory_get_usage() at the end of the script.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
