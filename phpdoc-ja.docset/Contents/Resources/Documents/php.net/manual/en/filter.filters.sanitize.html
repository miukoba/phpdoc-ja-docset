<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>除去フィルタ</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="filter.filters.validate.html">≪ 検証フィルタ</a></li>
      <li style="float: right;"><a href="filter.filters.misc.html">その他のフィルタ ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="filter.filters.html">フィルタの型</a></li>
    <li>除去フィルタ</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="filter.filters.sanitize" class="section">
  <h2 class="title">除去フィルタ</h2>
   <p class="para">
    <table class="doctable table">
     <caption><strong>除去フィルタの一覧</strong></caption>
     
      <thead>
       <tr>
        <th>ID</th>
        <th>名前</th>
        <th>オプション</th>
        <th>フラグ</th>
        <th>説明</th>
       </tr>

      </thead>

      <tbody class="tbody">
       <tr>
        <td><strong><code>FILTER_SANITIZE_EMAIL</code></strong></td>
        <td>&quot;email&quot;</td>
        <td class="empty">&nbsp;</td>
        <td class="empty">&nbsp;</td>
        <td>
         英字、数字および
         <em>!#$%&amp;&#039;*+-/=?^_`{|}~@.[]</em>
         以外のすべての文字を取り除きます。
        </td>
       </tr>

       <tr>
        <td><strong><code>FILTER_SANITIZE_ENCODED</code></strong></td>
        <td>&quot;encoded&quot;</td>
        <td class="empty">&nbsp;</td>
        <td>
         <strong><code>FILTER_FLAG_STRIP_LOW</code></strong>,
         <strong><code>FILTER_FLAG_STRIP_HIGH</code></strong>,
         <strong><code>FILTER_FLAG_ENCODE_LOW</code></strong>,
         <strong><code>FILTER_FLAG_ENCODE_HIGH</code></strong>
        </td>
        <td>
         文字列を URL エンコードします。オプションで、
         特殊文字を取り除いたりエンコードしたりします。
        </td>
       </tr>

       <tr>
        <td><strong><code>FILTER_SANITIZE_MAGIC_QUOTES</code></strong></td>
        <td>&quot;magic_quotes&quot;</td>
        <td class="empty">&nbsp;</td>
        <td class="empty">&nbsp;</td>
        <td><span class="function"><a href="function.addslashes.html" class="function">addslashes()</a></span> を適用します。</td>
       </tr>

       <tr>
        <td><strong><code>FILTER_SANITIZE_NUMBER_FLOAT</code></strong></td>
        <td>&quot;number_float&quot;</td>
        <td class="empty">&nbsp;</td>
        <td>
         <strong><code>FILTER_FLAG_ALLOW_FRACTION</code></strong>,
         <strong><code>FILTER_FLAG_ALLOW_THOUSAND</code></strong>,
         <strong><code>FILTER_FLAG_ALLOW_SCIENTIFIC</code></strong>
        </td>
        <td>
         数字、<em>+-</em> および
         オプションで <em>.,eE</em>
         以外のすべての文字を取り除きます。
        </td>
       </tr>

       <tr>
        <td><strong><code>FILTER_SANITIZE_NUMBER_INT</code></strong></td>
        <td>&quot;number_int&quot;</td>
        <td class="empty">&nbsp;</td>
        <td class="empty">&nbsp;</td>
        <td>
         数字、プラス記号、マイナス記号
         以外のすべての文字を取り除きます。
        </td>
       </tr>

       <tr>
        <td><strong><code>FILTER_SANITIZE_SPECIAL_CHARS</code></strong></td>
        <td>&quot;special_chars&quot;</td>
        <td class="empty">&nbsp;</td>
        <td>
         <strong><code>FILTER_FLAG_STRIP_LOW</code></strong>,
         <strong><code>FILTER_FLAG_STRIP_HIGH</code></strong>,
         <strong><code>FILTER_FLAG_ENCODE_HIGH</code></strong>
        </td>
        <td>
         <em>&#039;&quot;&lt;&gt;&amp;</em> および
         ASCII 値が 32 未満の文字を HTML エスケープします。オプションで、
         特殊文字を取り除いたりエンコードしたりします。
        </td>
       </tr>

       <tr>
        <td><strong><code>FILTER_SANITIZE_FULL_SPECIAL_CHARS</code></strong></td>
        <td>&quot;full_special_chars&quot;</td>
        <td class="empty">&nbsp;</td>
        <td>
         <strong><code>FILTER_FLAG_NO_ENCODE_QUOTES</code></strong>,
        </td>
        <td>
         <span class="function"><a href="function.htmlspecialchars.html" class="function">htmlspecialchars()</a></span> に <strong><code>ENT_QUOTES</code></strong> を指定してコールするのと同じです。
         クォートのエンコードを無効にするには
         <strong><code>FILTER_FLAG_NO_ENCODE_QUOTES</code></strong> を設定します。
         <span class="function"><a href="function.htmlspecialchars.html" class="function">htmlspecialchars()</a></span> と同様、このフィルタは
         <a href="ini.core.html#ini.default-charset" class="link">default_charset</a> に対応しています。
         現在の文字セットで無効な文字となるバイトシーケンスが検出されると文字列全体を拒否し、
         結果は長さ 0 の文字列となります。
         このフィルタをデフォルトのフィルタとして使う場合は、以下の警告を参考にして
         デフォルトのフラグを 0 に設定しましょう。
        </td>
       </tr>

       <tr>
        <td><strong><code>FILTER_SANITIZE_STRING</code></strong></td>
        <td>&quot;string&quot;</td>
        <td class="empty">&nbsp;</td>
        <td>
         <strong><code>FILTER_FLAG_NO_ENCODE_QUOTES</code></strong>,
         <strong><code>FILTER_FLAG_STRIP_LOW</code></strong>,
         <strong><code>FILTER_FLAG_STRIP_HIGH</code></strong>,
         <strong><code>FILTER_FLAG_ENCODE_LOW</code></strong>,
         <strong><code>FILTER_FLAG_ENCODE_HIGH</code></strong>,
         <strong><code>FILTER_FLAG_ENCODE_AMP</code></strong>
        </td>
        <td>
         タグを取り除きます。オプションで、
         特殊文字を取り除いたりエンコードしたりします。
        </td>
       </tr>

       <tr>
        <td><strong><code>FILTER_SANITIZE_STRIPPED</code></strong></td>
        <td>&quot;stripped&quot;</td>
        <td class="empty">&nbsp;</td>
        <td class="empty">&nbsp;</td>
        <td>&quot;string&quot; フィルタのエイリアス。</td>
       </tr>

       <tr>
        <td><strong><code>FILTER_SANITIZE_URL</code></strong></td>
        <td>&quot;url&quot;</td>
        <td class="empty">&nbsp;</td>
        <td class="empty">&nbsp;</td>
        <td>
         英字、数字および
         <em>$-_.+!*&#039;(),{}|\\^~[]`&lt;&gt;#%&quot;;/?:@&amp;=</em>
         以外のすべての文字を取り除きます。
        </td>
       </tr>

       <tr>
        <td><strong><code>FILTER_UNSAFE_RAW</code></strong></td>
        <td>&quot;unsafe_raw&quot;</td>
        <td class="empty">&nbsp;</td>
        <td>
         <strong><code>FILTER_FLAG_STRIP_LOW</code></strong>,
         <strong><code>FILTER_FLAG_STRIP_HIGH</code></strong>,
         <strong><code>FILTER_FLAG_ENCODE_LOW</code></strong>,
         <strong><code>FILTER_FLAG_ENCODE_HIGH</code></strong>,
         <strong><code>FILTER_FLAG_ENCODE_AMP</code></strong>
        </td>
        <td>何もせず、オプションで特殊文字を取り除いたりエンコードしたりします。</td>
       </tr>

      </tbody>
     
    </table>

   </p>
   <div class="warning"><strong class="warning">警告</strong>
     <p class="para">
       これらのフィルタのいずれかを ini ファイルやウェブサーバーの設定でデフォルトフィルタとして使用すると、
       デフォルトのフラグは
       <strong><code>FILTER_FLAG_NO_ENCODE_QUOTES</code></strong> となります。
       デフォルトでクォートをエンコードさせるには、
       明示的に filter.default_flags を 0 としなければなりません。
       <div class="example" id="example-5195">
         <p><strong>例1 デフォルトのフィルタを htmlspecialchars と同様の挙動にする設定</strong></p>
         <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
filter.default&nbsp;=&nbsp;full_special_chars<br />filter.default_flags&nbsp;=&nbsp;0</span>
</code></div>
         </div>

       </div>
     </p>
   </div>
 </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="114484""></a>
  <div class="note">
   <strong class="user">david dot drakulovski at gmail dot com</strong>
   <a href="#114484" class="date">26-Feb-2014 04:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a simpler and a better presented ASCII list for the &lt;32 or 127&gt; filters <br />
(if wikipedia confused the hell out of you):<br />
<br />
<a href="http://www.danshort.com/ASCIImap/" rel="nofollow" target="_blank">http://www.danshort.com/ASCIImap/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111542""></a>
  <div class="note">
   <strong class="user">galvao at galvao dot eti dot br</strong>
   <a href="#111542" class="date">02-Mar-2013 03:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just to clarify, since this may be unknown for a lot of people:
<br />

<br />
ASCII characters above 127 are known as "Extended" and they represent characters such as greek letters and accented letters in latin alphabets, used in languages such as pt_BR.
<br />

<br />
A good ASCII quick reference (aside from the already mentioned Wikipedia article) can be found at: <a href="http://www.asciicodes.com/" rel="nofollow" target="_blank">http://www.asciicodes.com/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111398""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#111398" class="date">16-Feb-2013 04:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Support for FILTER_SANITIZE_FULL_SPECIAL_CHARS was added from version 5.3.3</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110103""></a>
  <div class="note">
   <strong class="user">googlybash24 at aol dot com</strong>
   <a href="#110103" class="date">20-Sep-2012 02:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Remember to trim() the $_POST before your filters are applied:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// We trim the $_POST data before any spaces get encoded to "%20"<br />
<br />
// Trim array values using this function "trim_value"<br />
</span><span class="keyword">function </span><span class="default">trim_value</span><span class="keyword">(&amp;</span><span class="default">$value</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// this removes whitespace and related characters from the beginning and end of the string<br />
</span><span class="keyword">}<br />
</span><span class="default">array_filter</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">, </span><span class="string">'trim_value'</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// the data in $_POST is trimmed<br />
<br />
</span><span class="default">$postfilter </span><span class="keyword">=&nbsp; &nbsp; </span><span class="comment">// set up the filters to be used with the trimmed post array<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'user_tasks'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; array(</span><span class="string">'filter' </span><span class="keyword">=&gt; </span><span class="default">FILTER_SANITIZE_STRING</span><span class="keyword">, </span><span class="string">'flags' </span><span class="keyword">=&gt; !</span><span class="default">FILTER_FLAG_STRIP_LOW</span><span class="keyword">),&nbsp; &nbsp; </span><span class="comment">// removes tags. formatting code is encoded -- add nl2br() when displaying<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'username'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; array(</span><span class="string">'filter' </span><span class="keyword">=&gt; </span><span class="default">FILTER_SANITIZE_ENCODED</span><span class="keyword">, </span><span class="string">'flags' </span><span class="keyword">=&gt; </span><span class="default">FILTER_FLAG_STRIP_LOW</span><span class="keyword">),&nbsp; &nbsp; </span><span class="comment">// we are using this in the url<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'mod_title'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; array(</span><span class="string">'filter' </span><span class="keyword">=&gt; </span><span class="default">FILTER_SANITIZE_ENCODED</span><span class="keyword">, </span><span class="string">'flags' </span><span class="keyword">=&gt; </span><span class="default">FILTER_FLAG_STRIP_LOW</span><span class="keyword">),&nbsp; &nbsp; </span><span class="comment">// we are using this in the url<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
<br />
</span><span class="default">$revised_post_array </span><span class="keyword">= </span><span class="default">filter_var_array</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">, </span><span class="default">$postfilter</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// must be referenced via a variable which is now an array that takes the place of $_POST[]<br />
</span><span class="keyword">echo (</span><span class="default">nl2br</span><span class="keyword">(</span><span class="default">$revised_post_array</span><span class="keyword">[</span><span class="string">'user_tasks'</span><span class="keyword">]));&nbsp; &nbsp; </span><span class="comment">//-- use nl2br() upon output like so, for the ['user_tasks'] array value so that the newlines are formatted, since this is our HTML &lt;textarea&gt; field and we want to maintain newlines<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110026""></a>
  <div class="note">
   <strong class="user">googlybash24 at aol dot com</strong>
   <a href="#110026" class="date">13-Sep-2012 05:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This should help with most simple "textarea" fields in post forms.<br />
<br />
Removing user html tags while maintaining text formatting such as newlines and carriage returns involves using the FILTER_SANITIZE_STRING filter ID with the flag !FILTER_FLAG_STRIP_LOW. The formatting text (the low ASCII values under decimal 32) are encoded because of the included FILTER_FLAG_ENCODE_LOW flag, but you are now preventing these from being removed. When you want to display the value on the page back in its intended format, use nl2br() so the encoded newlines are formatted properly on the page.<br />
<br />
This example cleans $_POST data from a textarea field with the name "user_tasks" on a previous html form, stripping tags but maintaining formatting (at least for newlines):<br />
<br />
<span class="default">&lt;?php<br />
$postfilter </span><span class="keyword">=<br />
&nbsp;&nbsp;&nbsp; array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'user_tasks'&nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; array(</span><span class="string">'filter' </span><span class="keyword">=&gt; </span><span class="default">FILTER_SANITIZE_STRING</span><span class="keyword">, </span><span class="string">'flags' </span><span class="keyword">=&gt; !</span><span class="default">FILTER_FLAG_STRIP_LOW</span><span class="keyword">),&nbsp; &nbsp; </span><span class="comment">// removes tags. formatting code is encoded -- add nl2br() when displaying<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
<br />
</span><span class="default">$revised_post_array </span><span class="keyword">= </span><span class="default">filter_input_array</span><span class="keyword">(</span><span class="default">INPUT_POST</span><span class="keyword">, </span><span class="default">$postfilter</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// must be referenced via a variable which is now an array that takes the place of $_POST[]<br />
</span><span class="keyword">echo (</span><span class="default">nl2br</span><span class="keyword">(</span><span class="default">$revised_post_array</span><span class="keyword">[</span><span class="string">'user_tasks'</span><span class="keyword">]));&nbsp; &nbsp; </span><span class="comment">// here we use nl2br() for the displayed value, for the ['user_tasks'] array value so that the newlines are formatted<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109350""></a>
  <div class="note">
   <strong class="user">adellemfrank at hotmail dot com</strong>
   <a href="#109350" class="date">10-Jul-2012 04:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A good list of which ASCII characters are &lt; 32 and &gt; 127 can be found at: <a href="http://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters" rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105279""></a>
  <div class="note">
   <strong class="user">scamber256 at hotmail dot de</strong>
   <a href="#105279" class="date">06-Aug-2011 11:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a hint I tested,<br />
<br />
You can obtain all the chars &lt;32 (so newline and c.return), by using not operator &gt; !FILTER_FLAG_STRIP_LOW as the last argument.<br />
<br />
Example:<br />
filter_input(INPUT_GET,'test',FILTER_SANITIZE_STRING,!FILTER_FLAG_STRIP_LOW);<br />
<br />
The filter keeps working as before removing anything else as before apart from FILTER_FLAG_STRIP_LOW.<br />
Just filter those "bad" chars &lt;32 manually you don't want.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103379""></a>
  <div class="note">
   <strong class="user">Dmitry Snytkine</strong>
   <a href="#103379" class="date">11-Apr-2011 01:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware that FILTER_FLAG_STRIP_LOW strips NEWLINE and TAG and CARRIAGE RETURN chars. If you have a form that accepts user input in plaintext format, all the submitted text will lose all the line breaks, making it appear all on one line. This basically renders this filter useless for parsing user-submitted text, even in plain text.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94828""></a>
  <div class="note">
   <strong class="user">marcus at synchromedia dot co dot uk</strong>
   <a href="#94828" class="date">27-Nov-2009 10:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's not entirely clear what the LOW and HIGH ranges are. LOW is characters below 32, HIGH is those above 127, i.e. outside the ASCII range.<br />
<br />
<span class="default">&lt;?php<br />
$a </span><span class="keyword">= </span><span class="string">"\tcafe\n"</span><span class="keyword">;<br />
</span><span class="comment">//This will remove the tab and the line break<br />
</span><span class="keyword">echo </span><span class="default">filter_var</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">FILTER_SANITIZE_STRING</span><span class="keyword">, </span><span class="default">FILTER_FLAG_STRIP_LOW</span><span class="keyword">);<br />
</span><span class="comment">//This will remove the e.<br />
</span><span class="keyword">echo </span><span class="default">filter_var</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">FILTER_SANITIZE_STRING</span><span class="keyword">, </span><span class="default">FILTER_FLAG_STRIP_HIGH</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
