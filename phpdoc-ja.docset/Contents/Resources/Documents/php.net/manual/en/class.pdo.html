<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>PDO クラス</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="pdo.lobs.html">≪ ラージオブジェクト (LOB)</a></li>
      <li style="float: right;"><a href="pdo.begintransaction.html">PDO::beginTransaction ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.pdo.html">PDO</a></li>
    <li>PDO クラス</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="class.pdo" class="reference">
 <h1 class="title">PDO クラス</h1>
 
 
 <div class="partintro"><p class="verinfo">(PHP 5 &gt;= 5.1.0, PECL pdo &gt;= 0.1.0)</p>
 

  <div class="section" id="pdo.intro">
   <h2 class="title">導入</h2>
   <p class="para">
    PHP とデータベースサーバーの間の接続を表します。
   </p>
  </div>

 
  <div class="section" id="pdo.synopsis">
   <h2 class="title">クラス概要</h2>
 

   <div class="classsynopsis">
    <div class="ooclass"></div>
 

    <div class="classsynopsisinfo">
     <span class="ooclass">
      <strong class="classname">PDO</strong>
     </span>
     {</div>

 
    <div class="constructorsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><a href="pdo.construct.html" class="methodname">__construct</a></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$dsn</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$username</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$password</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code></span>
  ]]] )</div>

    <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">bool</span> <span class="methodname"><a href="pdo.begintransaction.html" class="methodname">beginTransaction</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">bool</span> <span class="methodname"><a href="pdo.commit.html" class="methodname">commit</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">mixed</span> <span class="methodname"><a href="pdo.errorcode.html" class="methodname">errorCode</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">array</span> <span class="methodname"><a href="pdo.errorinfo.html" class="methodname">errorInfo</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">int</span> <span class="methodname"><a href="pdo.exec.html" class="methodname">exec</a></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$statement</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">mixed</span> <span class="methodname"><a href="pdo.getattribute.html" class="methodname">getAttribute</a></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$attribute</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="modifier">static</span> <span class="type">array</span> <span class="methodname"><a href="pdo.getavailabledrivers.html" class="methodname">getAvailableDrivers</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">bool</span> <span class="methodname"><a href="pdo.intransaction.html" class="methodname">inTransaction</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">string</span> <span class="methodname"><a href="pdo.lastinsertid.html" class="methodname">lastInsertId</a></span>
    ([ <span class="methodparam"><span class="type">string</span> <code class="parameter">$name</code><span class="initializer"> = <strong><code>NULL</code></strong></span></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">PDOStatement</span> <span class="methodname"><a href="pdo.prepare.html" class="methodname">prepare</a></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$statement</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$driver_options</code><span class="initializer"> = array()</span></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">PDOStatement</span> <span class="methodname"><a href="pdo.query.html" class="methodname">query</a></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$statement</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">string</span> <span class="methodname"><a href="pdo.quote.html" class="methodname">quote</a></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$string</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$parameter_type</code><span class="initializer"> = PDO::PARAM_STR</span></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">bool</span> <span class="methodname"><a href="pdo.rollback.html" class="methodname">rollBack</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">bool</span> <span class="methodname"><a href="pdo.setattribute.html" class="methodname">setAttribute</a></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$attribute</code></span>
   , <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$value</code></span>
   )</div>


 
   }</div>
  </div>
 
 </div>
 
 
























































































































 
<h2>目次</h2><ul class="chunklist chunklist_reference"><li><a href="pdo.begintransaction.html">PDO::beginTransaction</a> &mdash; トランザクションを開始する</li><li><a href="pdo.commit.html">PDO::commit</a> &mdash; トランザクションをコミットする</li><li><a href="pdo.construct.html">PDO::__construct</a> &mdash; データベースへの接続を表す PDO インスタンスを生成する</li><li><a href="pdo.errorcode.html">PDO::errorCode</a> &mdash; データベースハンドラにおける直近の操作に関連する SQLSTATE を取得する</li><li><a href="pdo.errorinfo.html">PDO::errorInfo</a> &mdash; データベースハンドラにおける直近の操作に関連する拡張エラー情報を取得する</li><li><a href="pdo.exec.html">PDO::exec</a> &mdash; SQL ステートメントを実行し、作用した行数を返す</li><li><a href="pdo.getattribute.html">PDO::getAttribute</a> &mdash; データベース接続の属性を取得する</li><li><a href="pdo.getavailabledrivers.html">PDO::getAvailableDrivers</a> &mdash; 利用可能な PDO ドライバの配列を返す</li><li><a href="pdo.intransaction.html">PDO::inTransaction</a> &mdash; トランザクション内かどうかを調べる</li><li><a href="pdo.lastinsertid.html">PDO::lastInsertId</a> &mdash; 最後に挿入された行の ID あるいはシーケンスの値を返す</li><li><a href="pdo.prepare.html">PDO::prepare</a> &mdash; 文を実行する準備を行い、文オブジェクトを返す</li><li><a href="pdo.query.html">PDO::query</a> &mdash; SQL ステートメントを実行し、結果セットを PDOStatement オブジェクトとして返す</li><li><a href="pdo.quote.html">PDO::quote</a> &mdash; クエリ用の文字列をクオートする</li><li><a href="pdo.rollback.html">PDO::rollBack</a> &mdash; トランザクションをロールバックする</li><li><a href="pdo.setattribute.html">PDO::setAttribute</a> &mdash; 属性を設定する</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="112418""></a>
  <div class="note">
   <strong class="user">thz at plista dot com</strong>
   <a href="#112418" class="date">14-Jun-2013 10:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Starting with PHP 5.4 you are unable to use persistent connections when you have your own database class derived from the native PDO class. If your code uses this combination, you will encounter segmentation faults during the cleanup of the PHP process.<br />
You can still use _either_ a derived PDO class _or_ persistent connections.<br />
<br />
For more information, please see this bug report: https://bugs.php.net/bug.php?id=63176</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106125""></a>
  <div class="note">
   <strong class="user">williambarry007 at gmail dot com</strong>
   <a href="#106125" class="date">12-Oct-2011 10:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PDO and Dependency Injection<br />
<br />
Dependency injection is good for testing.&nbsp; But for anyone wanting various data mapper objects to have a database connection, dependency injection can make other model code very messy because database objects have to be instantiated all over the place and given to the data mapper objects.<br />
<br />
The code below is a good way to maintain dependency injection while keeping clean and minimal model code.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">DataMapper<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public static </span><span class="default">$db</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">init</span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$db </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">VendorMapper </span><span class="keyword">extends </span><span class="default">DataMapper<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">add</span><span class="keyword">(</span><span class="default">$vendor</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$st </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"insert into vendors set<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; first_name = :first_name,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; last_name = :last_name"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$st</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">(array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">':first_name' </span><span class="keyword">=&gt; </span><span class="default">$vendor</span><span class="keyword">-&gt;</span><span class="default">first_name</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">':last_name' </span><span class="keyword">=&gt; </span><span class="default">$vendor</span><span class="keyword">-&gt;</span><span class="default">last_name<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">// In your bootstrap<br />
</span><span class="default">$db </span><span class="keyword">= new </span><span class="default">PDO</span><span class="keyword">(...);<br />
</span><span class="default">DataMapper</span><span class="keyword">::</span><span class="default">init</span><span class="keyword">(</span><span class="default">$db</span><span class="keyword">);<br />
<br />
</span><span class="comment">// In your model logic<br />
</span><span class="default">$vendor </span><span class="keyword">= new </span><span class="default">Vendor</span><span class="keyword">(</span><span class="string">'John'</span><span class="keyword">, </span><span class="string">'Doe'</span><span class="keyword">);<br />
</span><span class="default">VendorMapper</span><span class="keyword">::</span><span class="default">add</span><span class="keyword">(</span><span class="default">$vendor</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97682""></a>
  <div class="note">
   <strong class="user">kcleung at kcleung dot no-ip dot org</strong>
   <a href="#97682" class="date">03-May-2010 12:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an singleton PDO example:<br />
<br />
###### config.ini ######<br />
db_driver=mysql<br />
db_user=root<br />
db_password=924892xp<br />
<br />
[dsn]<br />
host=localhost<br />
port=3306<br />
dbname=localhost<br />
<br />
[db_options]<br />
PDO::MYSQL_ATTR_INIT_COMMAND=set names utf8<br />
<br />
[db_attributes]<br />
ATTR_ERRMODE=ERRMODE_EXCEPTION<br />
############<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">class </span><span class="default">Database </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private static </span><span class="default">$link </span><span class="keyword">= </span><span class="default">null </span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; private static function </span><span class="default">getLink </span><span class="keyword">( ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">self </span><span class="keyword">:: </span><span class="default">$link </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self </span><span class="keyword">:: </span><span class="default">$link </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ini </span><span class="keyword">= </span><span class="default">_BASE_DIR </span><span class="keyword">. </span><span class="string">"config.ini" </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parse </span><span class="keyword">= </span><span class="default">parse_ini_file </span><span class="keyword">( </span><span class="default">$ini </span><span class="keyword">, </span><span class="default">true </span><span class="keyword">) ;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$driver </span><span class="keyword">= </span><span class="default">$parse </span><span class="keyword">[ </span><span class="string">"db_driver" </span><span class="keyword">] ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dsn </span><span class="keyword">= </span><span class="string">"</span><span class="keyword">${</span><span class="default">driver</span><span class="keyword">}</span><span class="string">:" </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$user </span><span class="keyword">= </span><span class="default">$parse </span><span class="keyword">[ </span><span class="string">"db_user" </span><span class="keyword">] ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$password </span><span class="keyword">= </span><span class="default">$parse </span><span class="keyword">[ </span><span class="string">"db_password" </span><span class="keyword">] ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$options </span><span class="keyword">= </span><span class="default">$parse </span><span class="keyword">[ </span><span class="string">"db_options" </span><span class="keyword">] ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$attributes </span><span class="keyword">= </span><span class="default">$parse </span><span class="keyword">[ </span><span class="string">"db_attributes" </span><span class="keyword">] ;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ( </span><span class="default">$parse </span><span class="keyword">[ </span><span class="string">"dsn" </span><span class="keyword">] as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dsn </span><span class="keyword">.= </span><span class="string">"</span><span class="keyword">${</span><span class="default">k</span><span class="keyword">}</span><span class="string">=</span><span class="keyword">${</span><span class="default">v</span><span class="keyword">}</span><span class="string">;" </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self </span><span class="keyword">:: </span><span class="default">$link </span><span class="keyword">= new </span><span class="default">PDO </span><span class="keyword">( </span><span class="default">$dsn</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">, </span><span class="default">$options </span><span class="keyword">) ;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ( </span><span class="default">$attributes </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self </span><span class="keyword">:: </span><span class="default">$link </span><span class="keyword">-&gt; </span><span class="default">setAttribute </span><span class="keyword">( </span><span class="default">constant </span><span class="keyword">( </span><span class="string">"PDO::</span><span class="keyword">{</span><span class="default">$k</span><span class="keyword">}</span><span class="string">" </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; , </span><span class="default">constant </span><span class="keyword">( </span><span class="string">"PDO::</span><span class="keyword">{</span><span class="default">$v</span><span class="keyword">}</span><span class="string">" </span><span class="keyword">) ) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self </span><span class="keyword">:: </span><span class="default">$link </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">__callStatic </span><span class="keyword">( </span><span class="default">$name</span><span class="keyword">, </span><span class="default">$args </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$callback </span><span class="keyword">= array ( </span><span class="default">self </span><span class="keyword">:: </span><span class="default">getLink </span><span class="keyword">( ), </span><span class="default">$name </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">call_user_func_array </span><span class="keyword">( </span><span class="default">$callback </span><span class="keyword">, </span><span class="default">$args </span><span class="keyword">) ;<br />
&nbsp;&nbsp;&nbsp; }<br />
} </span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php </span><span class="comment">// examples<br />
</span><span class="default">$stmt </span><span class="keyword">= </span><span class="default">Database </span><span class="keyword">:: </span><span class="default">prepare </span><span class="keyword">( </span><span class="string">"SELECT 'something' ;" </span><span class="keyword">) ;<br />
</span><span class="default">$stmt </span><span class="keyword">-&gt; </span><span class="default">execute </span><span class="keyword">( ) ;<br />
</span><span class="default">var_dump </span><span class="keyword">( </span><span class="default">$stmt </span><span class="keyword">-&gt; </span><span class="default">fetchAll </span><span class="keyword">( ) ) ;<br />
</span><span class="default">$stmt </span><span class="keyword">-&gt; </span><span class="default">closeCursor </span><span class="keyword">( ) ;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89019""></a>
  <div class="note">
   <strong class="user">Megaloman</strong>
   <a href="#89019" class="date">18-Feb-2009 04:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"And storing username/password inside class is not a very good idea for production code."<br />
<br />
Good idea is to store database connection settings in *.ini files but you have to restrict access to them. For example this way:<br />
<br />
my_setting.ini:<br />
[database]<br />
driver = mysql<br />
host = localhost<br />
;port = 3306<br />
schema = db_schema<br />
username = user<br />
password = secret<br />
<br />
Database connection:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">MyPDO </span><span class="keyword">extends </span><span class="default">PDO<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$file </span><span class="keyword">= </span><span class="string">'my_setting.ini'</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$settings </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">)) throw new </span><span class="default">exception</span><span class="keyword">(</span><span class="string">'Unable to open ' </span><span class="keyword">. </span><span class="default">$file </span><span class="keyword">. </span><span class="string">'.'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dns </span><span class="keyword">= </span><span class="default">$settings</span><span class="keyword">[</span><span class="string">'database'</span><span class="keyword">][</span><span class="string">'driver'</span><span class="keyword">] .<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">':host=' </span><span class="keyword">. </span><span class="default">$settings</span><span class="keyword">[</span><span class="string">'database'</span><span class="keyword">][</span><span class="string">'host'</span><span class="keyword">] .<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ((!empty(</span><span class="default">$settings</span><span class="keyword">[</span><span class="string">'database'</span><span class="keyword">][</span><span class="string">'port'</span><span class="keyword">])) ? (</span><span class="string">';port=' </span><span class="keyword">. </span><span class="default">$settings</span><span class="keyword">[</span><span class="string">'database'</span><span class="keyword">][</span><span class="string">'port'</span><span class="keyword">]) : </span><span class="string">''</span><span class="keyword">) .<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">';dbname=' </span><span class="keyword">. </span><span class="default">$settings</span><span class="keyword">[</span><span class="string">'database'</span><span class="keyword">][</span><span class="string">'schema'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$dns</span><span class="keyword">, </span><span class="default">$settings</span><span class="keyword">[</span><span class="string">'database'</span><span class="keyword">][</span><span class="string">'username'</span><span class="keyword">], </span><span class="default">$settings</span><span class="keyword">[</span><span class="string">'database'</span><span class="keyword">][</span><span class="string">'password'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Database connection parameters are accessible via human readable ini file for those who screams even if they see one PHP/HTML/any_other command.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85256""></a>
  <div class="note">
   <strong class="user">anrdaemon at freemail dot ru</strong>
   <a href="#85256" class="date">22-Aug-2008 10:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Keep in mind, you MUST NOT use 'root' user in your applications, unless your application designed to do a database maintenance.<br />
<br />
And storing username/password inside class is not a very good idea for production code. You would need to edit the actual working code to change settings, which is bad.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84751""></a>
  <div class="note">
   <strong class="user">schizo_mind at hotmail dot com</strong>
   <a href="#84751" class="date">28-Jul-2008 07:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">PDOConfig </span><span class="keyword">extends </span><span class="default">PDO </span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$engine</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$host</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$database</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$user</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$pass</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">engine </span><span class="keyword">= </span><span class="string">'mysql'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">host </span><span class="keyword">= </span><span class="string">'localhost'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">database </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">user </span><span class="keyword">= </span><span class="string">'root'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pass </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dns </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">engine</span><span class="keyword">.</span><span class="string">':dbname='</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">database</span><span class="keyword">.</span><span class="string">";host="</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">host</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">( </span><span class="default">$dns</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">user</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pass </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
