<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>ファイルのモードを変更する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.chgrp.html">≪ chgrp</a></li>
      <li style="float: right;"><a href="function.chown.html">chown ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.filesystem.html">ファイルシステム 関数</a></li>
    <li>ファイルのモードを変更する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.chmod" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">chmod</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">chmod</span> &mdash; <span class="dc-title">ファイルのモードを変更する</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.chmod-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>chmod</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$mode</code></span>
   )</div>

  <p class="para rdfs-comment">
   指定されたファイルのモードを
   <code class="parameter">mode</code> で指定したものに変更しようと試みます。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.chmod-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
       ファイルへのパス。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">mode</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">mode</code>
       は自動的には 8 進数と見なされないので注意してください。
       意図した操作を行うには、<code class="parameter">mode</code>
       の前にゼロ(0)を付ける必要があります。
       &quot;g+w&quot; のような文字列は正常に動作しません。
      </p>
      <p class="para">
       <div class="informalexample">
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />chmod</span><span style="color: #007700">(</span><span style="color: #DD0000">"/somedir/somefile"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">755</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;10&nbsp;進数;&nbsp;おそらく間違い<br /></span><span style="color: #0000BB">chmod</span><span style="color: #007700">(</span><span style="color: #DD0000">"/somedir/somefile"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"u+rwx,go+rx"</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;文字列;&nbsp;正しくない<br /></span><span style="color: #0000BB">chmod</span><span style="color: #007700">(</span><span style="color: #DD0000">"/somedir/somefile"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0755</span><span style="color: #007700">);&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;8&nbsp;進数;&nbsp;正しいモードの値<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

       </div>
      </p>
      <p class="para">
       <code class="parameter">mode</code> 引数は 3 つの 8 進法による数値で構成され、
       所有者自身、所有者が属するグループ、その他のユーザーの順で
       アクセス制限を設定します。一つ一つの数字はそのターゲットに対し
       許可を与えます。1 は実行権限、2 はファイルに対する書き込み権限、
       4 はファイルに対する読み込み権限を与えます。
       必要な権限にあわせ数値を加算してください。
       許可モードに関する詳細は Unix システムの
       「<strong class="command">man 1 chmod</strong>」や「<strong class="command">man 2 chmod</strong>」をご覧ください。
      </p>
      <p class="para">
       <div class="informalexample">
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;所有者に読み込み、書き込みの権限を与え、その他には何も許可しない。<br /></span><span style="color: #0000BB">chmod</span><span style="color: #007700">(</span><span style="color: #DD0000">"/somedir/somefile"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0600</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;所有者に読み込み、書き込みの権限を与え、その他には読み込みだけ許可する。<br /></span><span style="color: #0000BB">chmod</span><span style="color: #007700">(</span><span style="color: #DD0000">"/somedir/somefile"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0644</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;所有者に全ての権限を与え、その他には読み込みと実行を許可する。<br /></span><span style="color: #0000BB">chmod</span><span style="color: #007700">(</span><span style="color: #DD0000">"/somedir/somefile"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0755</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;所有者に全ての権限を与え、所有者が属するグループに読み込みと実行を許可する。<br /></span><span style="color: #0000BB">chmod</span><span style="color: #007700">(</span><span style="color: #DD0000">"/somedir/somefile"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0750</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

       </div>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.chmod-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.chmod-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    現在のユーザーは PHP を実行しているユーザーです。
    これは普通のシェルや FTP アクセスでのユーザーとはたいてい違います。
    たいていのシステムでは、ファイルの所有者のみがそのモードを
    変更可能です。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara">この関数では、
<a href="features.remote-files.html" class="link">リモートファイル</a> を
使用することはできません。これは、処理されるファイルがサーバーの
ファイルシステムによりアクセスできる必要があるためです。</span></p></blockquote>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">セーフモード</a> が有効な場合、操作しようとしているファイルあるいは
    ディレクトリの UID（所有者）がスクリプトの実行ユーザーと同じかどうかを
    PHP がチェックします。さらに、SUID・SGID や sticky ビットを
    設定することはできません。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.chmod-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.chown.html" class="function" rel="rdfs-seeAlso">chown()</a> - ファイルの所有者を変更する</span></li>
    <li class="member"><span class="function"><a href="function.chgrp.html" class="function" rel="rdfs-seeAlso">chgrp()</a> - ファイルのグループを変更する</span></li>
    <li class="member"><span class="function"><a href="function.fileperms.html" class="function" rel="rdfs-seeAlso">fileperms()</a> - ファイルのパーミッションを取得する</span></li>
    <li class="member"><span class="function"><a href="function.stat.html" class="function" rel="rdfs-seeAlso">stat()</a> - ファイルに関する情報を取得する</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="114947""></a>
  <div class="note">
   <strong class="user">roger at imovelavenda dot com dot br</strong>
   <a href="#114947" class="date">03-May-2014 04:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
function chmod777($f) { chmod($f, 0777); }<br />
array_map('chmod777', glob('/home/user/public_html/pdf/*/*/*/*'));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105570""></a>
  <div class="note">
   <strong class="user">h dot kuppens at cs dot ru dot nl</strong>
   <a href="#105570" class="date">29-Aug-2011 11:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For recursive chmod'ing both files and directories in one step you can use the function below. Note that this function has one argument for directory permissions and one for file permissions.
<br />
In this way you can apply the 'x' permission on directories, and skip it on directories. This function also skips links.
<br />

<br />
Example usage :
<br />

<br />
&nbsp;&nbsp; chmod_R( 'mydir', 0666, 0777);
<br />

<br />
Makes all files and directories within mydir/ directory accessible for everyone, but doesn't make the files executable.
<br />

<br />
I guess for very deeply nested directories the recursion with php can become problematic, but I can be wrong because I never investigated this.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">chmod_R</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$filemode</span><span class="keyword">, </span><span class="default">$dirmode</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) ) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">chmod</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$dirmode</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dirmode_str</span><span class="keyword">=</span><span class="default">decoct</span><span class="keyword">(</span><span class="default">$dirmode</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"Failed applying filemode '</span><span class="default">$dirmode_str</span><span class="string">' on directory '</span><span class="default">$path</span><span class="string">'\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"&nbsp; `-&gt; the directory '</span><span class="default">$path</span><span class="string">' will be skipped from recursive chmod\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dh </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'..'</span><span class="keyword">) {&nbsp; </span><span class="comment">// skip self and parent pointing directories
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fullpath </span><span class="keyword">= </span><span class="default">$path</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">chmod_R</span><span class="keyword">(</span><span class="default">$fullpath</span><span class="keyword">, </span><span class="default">$filemode</span><span class="keyword">,</span><span class="default">$dirmode</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_link</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"link '</span><span class="default">$path</span><span class="string">' is skipped\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">chmod</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$filemode</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filemode_str</span><span class="keyword">=</span><span class="default">decoct</span><span class="keyword">(</span><span class="default">$filemode</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"Failed applying filemode '</span><span class="default">$filemode_str</span><span class="string">' on file '</span><span class="default">$path</span><span class="string">'\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102716""></a>
  <div class="note">
   <strong class="user">Andrey P.</strong>
   <a href="#102716" class="date">01-Mar-2011 11:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was trying to change permissions of a folder with chmod command with FTP connection. (I needed a writable folder to upload pictures with php)
<br />

<br />
I got the following respond:
<br />
"SITE CHMOD 777 uploads: command not understood"
<br />

<br />
The reason: Server is running under Windows system that does not allow to set file permissions via FTP. Conversely, the UNIX-running servers allow that.
<br />

<br />
Solutions:
<br />

<br />
1. If your web hosting provider has a web-based control panel that lets you set file permissions, then you need to login there and make changes.
<br />

<br />
2. It is possible to contact the hosting provider and ask them about this issue; maybe they can make the changes.
<br />

<br />
3. It is possible to change the hosting provider that has servers run on UNIX, and keep the site there.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99747""></a>
  <div class="note">
   <strong class="user">MethodicalFool</strong>
   <a href="#99747" class="date">02-Sep-2010 06:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
BEWARE, a couple of the examples in the comments suggest doing something like this:<br />
<br />
chmod(file_or_dir_name, intval($mode, 8));<br />
<br />
However, if $mode is an integer then intval( ) won't modify it.&nbsp; So, this code...<br />
<br />
$mode = 644;<br />
chmod('/tmp/test', intval($mode, 8));<br />
<br />
...produces permissions that look like this:<br />
<br />
1--w----r-T<br />
<br />
Instead, use octdec( ), like this:<br />
<br />
chmod(file_or_dir_name, octdec($mode));<br />
<br />
See also: <a href="http://www.php.net/manual/en/function.octdec.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/function.octdec.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96086""></a>
  <div class="note">
   <strong class="user">Geoff W</strong>
   <a href="#96086" class="date">08-Feb-2010 11:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
BEWARE using quotes around the second parameter...<br />
<br />
If you use quotes eg<br />
<br />
chmod (file, "0644");<br />
<br />
php will not complain but will do an implicit conversion to an int before running chmod. Unfortunately the implicit conversion doesn't take into account the octal string so you end up with an integer version 644, which is 1204 octal</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91794""></a>
  <div class="note">
   <strong class="user">sander</strong>
   <a href="#91794" class="date">25-Jun-2009 08:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you want to chmod directories too, use this 
<br />

<br />
<span class="default">&lt;?php
<br />
$iterator </span><span class="keyword">= new </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">(new </span><span class="default">RecursiveDirectoryIterator</span><span class="keyword">(</span><span class="default">$pathname</span><span class="keyword">), </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">::</span><span class="default">SELF_FIRST</span><span class="keyword">);
<br />

<br />
foreach(</span><span class="default">$iterator </span><span class="keyword">as </span><span class="default">$item</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">chmod</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$filemode</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87826""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#87826" class="date">24-Dec-2008 11:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Changes file mode recursive in $pathname to $filemode<br />
<br />
<span class="default">&lt;?php<br />
<br />
$iterator </span><span class="keyword">= new </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">(new </span><span class="default">RecursiveDirectoryIterator</span><span class="keyword">(</span><span class="default">$pathname</span><span class="keyword">));<br />
<br />
foreach(</span><span class="default">$iterator </span><span class="keyword">as </span><span class="default">$item</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">chmod</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$filemode</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84273""></a>
  <div class="note">
   <strong class="user">nicolas at infosoft dot inf dot br</strong>
   <a href="#84273" class="date">07-Jul-2008 02:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use the code of haasje@welmers.net, but have a lite alteration. (linux symlink)
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">chmod_R</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$filemode</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">chmod</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$filemode</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dh </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'..'</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fullpath </span><span class="keyword">= </span><span class="default">$path</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_link</span><span class="keyword">(</span><span class="default">$fullpath</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif(!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$fullpath</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">chmod</span><span class="keyword">(</span><span class="default">$fullpath</span><span class="keyword">, </span><span class="default">$filemode</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif(!</span><span class="default">chmod_R</span><span class="keyword">(</span><span class="default">$fullpath</span><span class="keyword">, </span><span class="default">$filemode</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">chmod</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$filemode</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">TRUE</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>thanks alls</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82751""></a>
  <div class="note">
   <strong class="user">paul maybe at squirrel mail org</strong>
   <a href="#82751" class="date">24-Apr-2008 02:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that info at rvgate dot nl's chmodnum function produces INCORRECT results.&nbsp; The resutls are base-10 numbers that only LOOK like they are octal numbers.&nbsp; The function also ignores setuid, setgid and sticky bits, and will produce incorrect numbers if such a file is encountered.&nbsp; Instead, this brute-force code works.&nbsp; Maybe there is something more slick, but this isn't too CPU-intensive (note that it assumes you've error-checked that you indeed have a 10-character string!):
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $permissions </span><span class="keyword">= </span><span class="string">'drwxr-xr-x'</span><span class="keyword">;&nbsp; </span><span class="comment">// or whatever
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$mode </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] == </span><span class="string">'r'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">0400</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] == </span><span class="string">'w'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">0200</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">] == </span><span class="string">'x'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">0100</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">] == </span><span class="string">'s'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">04100</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">] == </span><span class="string">'S'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">04000</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">] == </span><span class="string">'r'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">040</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">] == </span><span class="string">'w'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">020</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] == </span><span class="string">'x'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">010</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] == </span><span class="string">'s'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">02010</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] == </span><span class="string">'S'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">02000</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">] == </span><span class="string">'r'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">04</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">8</span><span class="keyword">] == </span><span class="string">'w'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">02</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">9</span><span class="keyword">] == </span><span class="string">'x'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">01</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">9</span><span class="keyword">] == </span><span class="string">'t'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">01001</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if (</span><span class="default">$permissions</span><span class="keyword">[</span><span class="default">9</span><span class="keyword">] == </span><span class="string">'T'</span><span class="keyword">) </span><span class="default">$mode </span><span class="keyword">+= </span><span class="default">01000</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">'Mode is %d decimal and %o octal'</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74107""></a>
  <div class="note">
   <strong class="user">Ambriel_Angel at www dot ambriels dot net/entry</strong>
   <a href="#74107" class="date">25-Mar-2007 03:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
error_reporting</span><span class="keyword">(</span><span class="default">E_ERROR </span><span class="keyword">| </span><span class="default">E_PARSE</span><span class="keyword">);
<br />
</span><span class="comment">/* Makes is so Directories are not browseable to the public,
<br />
removing only the Public = Read permission, while leaving 
<br />
the other chmod permissions for the file in tact.
<br />

<br />
If you have exectue already on, and read off, public viewers will only
<br />
be able to view files through links, but not browse
<br />
around to see what's inside of directories and see what
<br />
you've got laying around. */
<br />
//-------------------------------------------------------
<br />
// Get file mode
<br />
// Get file permissions supported by chmod
<br />
</span><span class="keyword">function </span><span class="default">getmod</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; </span><span class="default">$perms </span><span class="keyword">= </span><span class="default">fileperms</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);
<br />
&nbsp;&nbsp; </span><span class="comment">// Owner; User
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0100</span><span class="keyword">) ? </span><span class="default">0x0100 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Read
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0080</span><span class="keyword">) ? </span><span class="default">0x0080 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Write
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0040</span><span class="keyword">) ? </span><span class="default">0x0040 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Execute
<br />
&nbsp;
<br />
&nbsp;&nbsp; // Group
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0020</span><span class="keyword">) ? </span><span class="default">0x0020 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Read
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0010</span><span class="keyword">) ? </span><span class="default">0x0010 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Write
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0008</span><span class="keyword">) ? </span><span class="default">0x0008 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Execute
<br />
&nbsp;
<br />
&nbsp;&nbsp; // Global; World
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0004</span><span class="keyword">) ? </span><span class="default">0x0004 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Read
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0002</span><span class="keyword">) ? </span><span class="default">0x0002 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Write
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0001</span><span class="keyword">) ? </span><span class="default">0x0001 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Execute
<br />

<br />
&nbsp;&nbsp; // Misc
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x40000</span><span class="keyword">) ? </span><span class="default">0x40000 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//temporary file (01000000)
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x80000</span><span class="keyword">) ? </span><span class="default">0x80000 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//compressed file (02000000)
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x100000</span><span class="keyword">) ? </span><span class="default">0x100000 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//sparse file (04000000)
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0800</span><span class="keyword">) ? </span><span class="default">0x0800 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Hidden file (setuid bit) (04000)
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0400</span><span class="keyword">) ? </span><span class="default">0x0400 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//System file (setgid bit) (02000)
<br />
&nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">+= ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">0x0200</span><span class="keyword">) ? </span><span class="default">0x0200 </span><span class="keyword">: </span><span class="default">0x0000</span><span class="keyword">); </span><span class="comment">//Archive bit (sticky bit) (01000)
<br />

<br />
&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$val</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="comment">//-------------------------------------------------------
<br />
// Find out if file has mode
<br />
</span><span class="keyword">function </span><span class="default">hasmod</span><span class="keyword">(</span><span class="default">$perms</span><span class="keyword">, </span><span class="default">$permission</span><span class="keyword">) {
<br />

<br />
</span><span class="comment"># User Read = 0400 (256), Write = 0200 (128), Execute = 0100 (64)
<br />
# Group Read = 0040 (32), Write = 0020 (16), Execute = 0010 (8)
<br />
# Public Read = 0004 (4), Write = 0002 (2), Execute = 0001 (1)
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return ((</span><span class="default">$perms </span><span class="keyword">&amp; </span><span class="default">$permission</span><span class="keyword">) == </span><span class="default">$permission</span><span class="keyword">);
<br />
}
<br />

<br />
</span><span class="comment">//-------------------------------------------------------
<br />
// Take the read option off of all the subdirectories of the included path
<br />
</span><span class="keyword">function </span><span class="default">pathlock</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$listall </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$testrun </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">) {
<br />
&nbsp;&nbsp; echo </span><span class="string">"START @ " </span><span class="keyword">. </span><span class="default">date</span><span class="keyword">(</span><span class="string">"F j, Y, h:i:s A"</span><span class="keyword">) . </span><span class="string">"&lt;br&gt;&lt;br&gt;"</span><span class="keyword">;
<br />
&nbsp;&nbsp; echo (</span><span class="default">$testrun </span><span class="keyword">? </span><span class="string">'**Test Run Activated (no changes will be made).**&lt;br&gt;&lt;br&gt;' </span><span class="keyword">: </span><span class="string">'**Live Run Activated.**&lt;br&gt;&lt;br&gt;'</span><span class="keyword">);
<br />
&nbsp;&nbsp; echo </span><span class="default">$dir </span><span class="keyword">. </span><span class="string">" is our directory.&lt;br&gt;&lt;br&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; echo </span><span class="string">"[...IN PROGRESS...]&lt;br&gt;&lt;br&gt;"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; </span><span class="default">$file_list </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp; </span><span class="default">$stack</span><span class="keyword">[] = </span><span class="default">$dir</span><span class="keyword">;
<br />
&nbsp; 
<br />
&nbsp;&nbsp; while (</span><span class="default">$stack</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$current_dir </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$dh </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$current_dir</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$file </span><span class="keyword">!== </span><span class="string">'.' </span><span class="keyword">AND </span><span class="default">$file </span><span class="keyword">!== </span><span class="string">'..'</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$current_file </span><span class="keyword">= </span><span class="string">"</span><span class="keyword">{</span><span class="default">$current_dir</span><span class="keyword">}</span><span class="string">/</span><span class="keyword">{</span><span class="default">$file</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$current_file</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// BEG ADD PATH&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$mode </span><span class="keyword">= </span><span class="default">getmod</span><span class="keyword">(</span><span class="default">$current_file</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">//Get the mode
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$HasPubRead </span><span class="keyword">= </span><span class="default">hasmod</span><span class="keyword">(</span><span class="default">$mode</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$HasPubRead </span><span class="keyword">|| </span><span class="default">$listall</span><span class="keyword">) {&nbsp; &nbsp; </span><span class="comment">// Can the public read this dir?
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //======================================
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$take </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Change the mode:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">$HasPubRead</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$take </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Value for Public Read. 4 is the same in octal and decimal.
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$testrun</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">chmod</span><span class="keyword">(</span><span class="default">$current_file</span><span class="keyword">, </span><span class="default">$mode</span><span class="keyword">-</span><span class="default">$take</span><span class="keyword">); 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } 
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$current_file </span><span class="keyword">. </span><span class="string">",current=" </span><span class="keyword">. </span><span class="default">decoct</span><span class="keyword">(</span><span class="default">$mode</span><span class="keyword">) . 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((</span><span class="default">$mode</span><span class="keyword">!==</span><span class="default">$mode</span><span class="keyword">-</span><span class="default">$take</span><span class="keyword">) ? </span><span class="string">",new=" </span><span class="keyword">. </span><span class="default">decoct</span><span class="keyword">(</span><span class="default">$mode</span><span class="keyword">-</span><span class="default">$take</span><span class="keyword">) : </span><span class="string">''</span><span class="keyword">) .
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (</span><span class="default">$ch </span><span class="keyword">? </span><span class="string">'' </span><span class="keyword">: </span><span class="string">',FAILED'</span><span class="keyword">) . </span><span class="string">"&lt;br&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } </span><span class="comment">// end if hasmod
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // END ADD PATH&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stack</span><span class="keyword">[] = </span><span class="default">$current_file</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } </span><span class="comment">// if if_dir
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} </span><span class="comment">//if ($file !== '.' AND $file !== '..')
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">} </span><span class="comment">//while (($file = readdir($dh)) !== false)
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">} </span><span class="comment">//if ($dh = opendir($current_dir))
<br />
</span><span class="keyword">} </span><span class="comment">// while ($stack)
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"&lt;br&gt;COMPLETE @ " </span><span class="keyword">. </span><span class="default">date</span><span class="keyword">(</span><span class="string">"F j, Y, h:i:s A"</span><span class="keyword">) . </span><span class="string">"&lt;br&gt;\n"</span><span class="keyword">;
<br />
return;
<br />
&nbsp;&nbsp; </span><span class="comment">//return $path_list;
<br />
</span><span class="keyword">} </span><span class="comment">// end function
<br />

<br />
//-------------------------------------------------------
<br />
&nbsp;&nbsp;&nbsp; //listall Show all folders, even one's we're not going to process?
<br />
&nbsp;&nbsp;&nbsp; //testrun Do a test run without making any changes
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">pathlock</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">"DOCUMENT_ROOT"</span><span class="keyword">],</span><span class="default">false</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">); </span><span class="comment">// listall?=false, testrun?=true
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72151""></a>
  <div class="note">
   <strong class="user">info at web-in-time dot eu</strong>
   <a href="#72151" class="date">04-Jan-2007 10:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As you might have noticed there is a minor bug in webmaster at danopia dot 5gigs dot com's code:<br />
<br />
You have to set $ftp_root variable outside the function chmod_open() and have to set it as global within the chmod_file() function.<br />
<br />
With these patches the code really works fine. THX!<br />
<br />
Ben</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72103""></a>
  <div class="note">
   <strong class="user">webmaster at danopia dot 5gigs dot com</strong>
   <a href="#72103" class="date">03-Jan-2007 03:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks for your code, "imoldgreg at o2 dot co dot uk". I am using it for an instalation script that has to CHMOD a bunch of files. I have found it faster to use the same connectino for each, as shown below.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Thanks to "imoldgreg at o2 dot co dot uk" for the base 'CHMOD via FTP' script.<br />
<br />
</span><span class="keyword">function </span><span class="default">chmod_open</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Use your own FTP info<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftp_user_name </span><span class="keyword">= </span><span class="string">'chmod@XXXXXXXXX.com'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftp_user_pass </span><span class="keyword">= </span><span class="string">'XXXXXXXXXX'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftp_root </span><span class="keyword">= </span><span class="string">'/'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftp_server </span><span class="keyword">= </span><span class="string">'localhost'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$conn_id </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="default">$ftp_server</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$login_result </span><span class="keyword">= </span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$ftp_user_name</span><span class="keyword">, </span><span class="default">$ftp_user_pass</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$conn_id</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">chmod_file</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$permissions</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">ftp_site</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="string">'CHMOD ' </span><span class="keyword">. </span><span class="default">$permissions </span><span class="keyword">. </span><span class="string">' ' </span><span class="keyword">. </span><span class="default">$ftp_root </span><span class="keyword">. </span><span class="default">$path</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
function </span><span class="default">chmod_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">// CHMOD the required setup files<br />
<br />
// Connect to the FTP<br />
</span><span class="default">$conn_id </span><span class="keyword">= </span><span class="default">chmod_open</span><span class="keyword">();<br />
<br />
</span><span class="comment">// CHMOD each file and echo the results<br />
</span><span class="keyword">echo </span><span class="default">chmod_file</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">777</span><span class="keyword">, </span><span class="string">'master/cache/'</span><span class="keyword">) ? </span><span class="string">'CHMODed successfully!' </span><span class="keyword">: </span><span class="string">'Error'</span><span class="keyword">;<br />
echo </span><span class="default">chmod_file</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">777</span><span class="keyword">, </span><span class="string">'master/files/'</span><span class="keyword">) ? </span><span class="string">'CHMODed successfully!' </span><span class="keyword">: </span><span class="string">'Error'</span><span class="keyword">;<br />
echo </span><span class="default">chmod_file</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">777</span><span class="keyword">, </span><span class="string">'master/store/'</span><span class="keyword">) ? </span><span class="string">'CHMODed successfully!' </span><span class="keyword">: </span><span class="string">'Error'</span><span class="keyword">;<br />
echo </span><span class="default">chmod_file</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">766</span><span class="keyword">, </span><span class="string">'master/config.php'</span><span class="keyword">) ? </span><span class="string">'CHMODed successfully!' </span><span class="keyword">: </span><span class="string">'Error'</span><span class="keyword">;<br />
echo </span><span class="default">chmod_file</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">777</span><span class="keyword">, </span><span class="string">'master/images/avatars/upload/'</span><span class="keyword">) ? </span><span class="string">'CHMODed successfully!' </span><span class="keyword">: </span><span class="string">'Error'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Close the connection<br />
</span><span class="default">chmod_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Here, the same FTP connection is used for each CHMOD command, making the execute time lower. This is essential for me, since my script is also copying a bunch of files.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71485""></a>
  <div class="note">
   <strong class="user">imoldgreg at o2 dot co dot uk</strong>
   <a href="#71485" class="date">01-Dec-2006 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
an update to 'neil at 11 out of 10's code for changing mode using FTP.
<br />

<br />
changes: proper array added within the function (better for those of us who only need to connect to one ftp server) so only the mode and directory name need to be passed.
<br />

<br />
the octal added, for completeness and predictable stability.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">changemode</span><span class="keyword">(</span><span class="default">$xcite</span><span class="keyword">)
<br />
{
<br />
</span><span class="default">$ftp_details </span><span class="keyword">= array(
<br />
</span><span class="default">ftp_user_name </span><span class="keyword">=&gt; </span><span class="string">'username'</span><span class="keyword">, 
<br />
</span><span class="default">ftp_user_pass </span><span class="keyword">=&gt; </span><span class="string">'password'</span><span class="keyword">, 
<br />
</span><span class="default">ftp_user_root </span><span class="keyword">=&gt; </span><span class="string">'/public_html/'</span><span class="keyword">, 
<br />
</span><span class="default">ftp_server </span><span class="keyword">=&gt; </span><span class="string">'ftp.something.org' 
<br />
</span><span class="keyword">);
<br />

<br />
</span><span class="default">$path </span><span class="keyword">= </span><span class="string">"public"</span><span class="keyword">;
<br />
</span><span class="default">$mod </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$xcite</span><span class="keyword">, </span><span class="default">8</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">// extract ftp details (array keys as variable names)
<br />
&nbsp;&nbsp; </span><span class="default">extract </span><span class="keyword">(</span><span class="default">$ftp_details</span><span class="keyword">);
<br />
&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; </span><span class="comment">// set up basic connection
<br />
&nbsp;&nbsp; </span><span class="default">$conn_id </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="default">$ftp_server</span><span class="keyword">);
<br />
&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; </span><span class="comment">// login with username and password
<br />
&nbsp;&nbsp; </span><span class="default">$login_result </span><span class="keyword">= </span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$ftp_user_name</span><span class="keyword">, </span><span class="default">$ftp_user_pass</span><span class="keyword">);
<br />
&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; </span><span class="comment">// try to chmod $path directory
<br />
&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">ftp_site</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="string">'CHMOD '</span><span class="keyword">.</span><span class="default">$mod</span><span class="keyword">.</span><span class="string">' '</span><span class="keyword">.</span><span class="default">$ftp_root</span><span class="keyword">.</span><span class="default">$path</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$success</span><span class="keyword">=</span><span class="default">TRUE</span><span class="keyword">;
<br />
&nbsp;&nbsp; } 
<br />
&nbsp;&nbsp; else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$success</span><span class="keyword">=</span><span class="default">FALSE</span><span class="keyword">;
<br />
&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; </span><span class="comment">// close the connection
<br />
&nbsp;&nbsp; </span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$success</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
for those of you, like me, who were looking for a way to make an 'un-hackable' uploader, here's the closest i got, now for a field test, good luck!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56077""></a>
  <div class="note">
   <strong class="user">memp</strong>
   <a href="#56077" class="date">23-Aug-2005 12:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are storing your mode in a variable like<br />
<br />
$mode = 0755;<br />
<br />
you will run into the inevitable octal mode problem.&nbsp; An easy way around that is to use the octdec() function.<br />
<br />
chmod("some_filename.ext", octdec($mode));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54640""></a>
  <div class="note">
   <strong class="user">masha at mail dot ru</strong>
   <a href="#54640" class="date">11-Jul-2005 06:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Usefull reference:<br />
<br />
Value&nbsp; &nbsp; Permission Level<br />
400&nbsp; &nbsp; Owner Read<br />
200&nbsp; &nbsp; Owner Write<br />
100&nbsp; &nbsp; Owner Execute<br />
40&nbsp; &nbsp; Group Read<br />
20&nbsp; &nbsp; Group Write<br />
10&nbsp; &nbsp; Group Execute<br />
4&nbsp; &nbsp; Global Read<br />
2&nbsp; &nbsp; Global Write<br />
1&nbsp; &nbsp; Global Execute<br />
<br />
(taken from <a href="http://www.onlamp.com/pub/a/php/2003/02/06/php_foundations.html" rel="nofollow" target="_blank">http://www.onlamp.com/pub/a/php/2003/02/06/php_foundations.html</a>)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51498""></a>
  <div class="note">
   <strong class="user">alex at feidesign dot com</strong>
   <a href="#51498" class="date">01-Apr-2005 01:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you cannot chmod files/directories with PHP because of safe_mode restrictions, but you can use FTP to chmod them, simply use PHP's FTP-functions (eg. ftp_chmod or ftp_site) instead. Not as efficient, but works.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47620""></a>
  <div class="note">
   <strong class="user">PerfectWeb</strong>
   <a href="#47620" class="date">23-Nov-2004 04:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As noted by others below... 1) you cannot pass a string to chmod() as the mode, and 2) decimals work as well as octals for the mode.<br />
<br />
If you need to come up with the mode on the fly (maybe based on user input) and want to use something like:<br />
<br />
$mode = '0'.$owner.$group.$public;<br />
<br />
you can use your $mode (which is a string) with chmod like this:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;</span><span class="comment">// octal mode in a string i.e. '0755'<br />
&nbsp;</span><span class="default">$mode </span><span class="keyword">= </span><span class="string">'0'</span><span class="keyword">.</span><span class="default">$owner</span><span class="keyword">.</span><span class="default">$group</span><span class="keyword">.</span><span class="default">$public</span><span class="keyword">;<br />
<br />
&nbsp;</span><span class="default">$mode_dec </span><span class="keyword">= </span><span class="default">octdec</span><span class="keyword">(</span><span class="default">$mode</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// convert octal mode to decimal<br />
&nbsp;</span><span class="default">chmod</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$mode_dec</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47350""></a>
  <div class="note">
   <strong class="user">fernando at gym-group dot com</strong>
   <a href="#47350" class="date">12-Nov-2004 04:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
about chmod,<br />
Problably you have a local server to simulate your scripts before upload them to the server. No matter if you use Apache under windows or IIS ,&nbsp; a chmod instruction like chmod($filename,O777) may not work because windows does not handle that kind of permission's format.<br />
So being in your local server, if you have a only read file and you try to erase, it will show that you dont have permissions even when you have already executed your chmod instrucction correctly. Just up the script it must work well in your internet server if it is a linux machine<br />
<br />
sobre chmod,<br />
Probablemente usas un servidor local para probar tus scripts antes de subirlos al servidor en internet. No importa si usas Apache bajo windows o IIS, una instruccion como chmod(nombre_archivo,O777) podr? no trabajar por que windows no maneja esa estructura para definir los permisos.<br />
Estando en tu servidor local, si tienes un archivo de solo lectura y tratas de borrarlo,&nbsp; se mostrar? un error diciendo que no tienes permisos a?n desp?es de haber ejecutado chmod correctamente. Sube tu script, si tu servidor es una m?quina linux, el script trabajar? sin problemas en internet.<br />
<br />
Fernando Yepes C.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43727""></a>
  <div class="note">
   <strong class="user">Oliver Hankeln</strong>
   <a href="#43727" class="date">01-Jul-2004 05:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Well, you don't need octals.<br />
You need a value that can easily computed and remembered if printed in octal. <br />
511 (decimal) is the same as 777 (octal).<br />
So it's the same wether you write<br />
chmod("foo",511)<br />
or <br />
chmod("foo",0777)<br />
<br />
The latter is just better readable.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41197""></a>
  <div class="note">
   <strong class="user">agrenier at assertex dot com</strong>
   <a href="#41197" class="date">02-Apr-2004 02:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function will chmod a $filename before writing to it if:<br />
<br />
1 - It exists<br />
2 - It is not writeable<br />
3 - PHP has permission to chmod files<br />
<br />
If PHP can't chmod, then the script will end. Otherwise it will attempt to write to a new file.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">file_write</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$flag</span><span class="keyword">, &amp;</span><span class="default">$content</span><span class="keyword">) { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_writable</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">chmod</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">0666</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Cannot change the mode of file (</span><span class="default">$filename</span><span class="string">)"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$fp </span><span class="keyword">= @</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$flag</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Cannot open file (</span><span class="default">$filename</span><span class="string">)"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$content</span><span class="keyword">) === </span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Cannot write to file (</span><span class="default">$filename</span><span class="string">)"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Cannot close file (</span><span class="default">$filename</span><span class="string">)"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31383""></a>
  <div class="note">
   <strong class="user">pmichaud at pobox dot com</strong>
   <a href="#31383" class="date">20-Apr-2003 12:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In the previous post, stickybit avenger writes:
<br />
&nbsp;&nbsp;&nbsp; Just a little hint. I was once adwised to set the 'sticky bit', i.e. use 1777 as chmod-value...
<br />

<br />
Note that in order to set the sticky bit on a file one must use '01777' (oct) and not '1777' (dec) as the parameter to chmod:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; chmod</span><span class="keyword">(</span><span class="string">"file"</span><span class="keyword">,</span><span class="default">01777</span><span class="keyword">);&nbsp;&nbsp; </span><span class="comment">// correct
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">chmod</span><span class="keyword">(</span><span class="string">"file"</span><span class="keyword">,</span><span class="default">1777</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// incorrect, same as chmod("file",01023), causing no owner permissions!
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Rule of thumb: always prefix octal mode values with a zero.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30248""></a>
  <div class="note">
   <strong class="user">sticky bit avenger</strong>
   <a href="#30248" class="date">12-Mar-2003 12:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a little hint. I was once adwised to set the 'sticky bit', i.e. use 1777 as chmod-value. Do NOT do this if you don't have root privileges. When 'sticky bit' is set ONLY the fileuser can delete it afterwards, typically 'httpd' or something like that in case of an upload-script for example. I was unaware of this and actually had to make a script for deleting these files as I could not do this from ftp/ssh even though I did have read/write/execute access to both files and folders. Use simply '0777' or similiar.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26651""></a>
  <div class="note">
   <strong class="user">Half-Dead at nospam dot com</strong>
   <a href="#26651" class="date">08-Nov-2002 11:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editor's note:
<br />
That is due the fact Win32 systems treat premissions. You do not really have any other levels but read-only.
<br />

<br />
Maxim]
<br />

<br />

<br />
On WinME with apache chmod also works to a certain limit.
<br />

<br />
What happens is that apparently only the first number is counted, so 0666 (read-write) is the same as 0777, 0644, 0600, etc, and 0444 (read-only) is the same as 477, 400, etc.
<br />

<br />
..didn't test 0500 series</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="16064""></a>
  <div class="note">
   <strong class="user">jon at zend dot com</strong>
   <a href="#16064" class="date">15-Oct-2001 05:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if 'mode' is held in a variable and is and octal value you need to convert it to decimal before passing it to the function:
<br />
chmod ($filename, octdec($mode))</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15021""></a>
  <div class="note">
   <strong class="user">gnettles2 at home dot com</strong>
   <a href="#15021" class="date">24-Aug-2001 08:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Usually when you're trying to write to af file, you'll need to chmod the file to something like 666 or 755. You can use a command to chmod the file for you, which is especially useful when you're making a script where you're setting it up so that your users don't have to peform a bunch of actions to setup the script. When i wrote my news program script, I only had two files. install.php and config.php. All you had to do was chmod install.php to 666 and open it up in a web browser and answer a few questions. The script itself setup the rest of the files and chmodded them for you.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
