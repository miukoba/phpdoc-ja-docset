<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>接続リソースあるいはステートメントリソースのオプションを設定する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.db2-server-info.html">≪ db2_server_info</a></li>
      <li style="float: right;"><a href="function.db2-special-columns.html">db2_special_columns ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.ibm-db2.html">IBM DB2 関数</a></li>
    <li>接続リソースあるいはステートメントリソースのオプションを設定する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.db2-set-option" class="refentry">
  <div class="refnamediv">
    <h1 class="refname">db2_set_option</h1>
    <p class="verinfo">(PECL ibm_db2 &gt;= 1.0.0)</p><p class="refpurpose"><span class="refname">db2_set_option</span> &mdash; <span class="dc-title">接続リソースあるいはステートメントリソースのオプションを設定する</span></p>

  </div>
  <div class="refsect1 description" id="refsect1-function.db2-set-option-description">
    <h3 class="title">説明</h3>
    <div class="methodsynopsis dc-description">
      <span class="type">bool</span> <span class="methodname"><strong>db2_set_option</strong></span>
       ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$resource</code></span>      
      , <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code></span>
      , <span class="methodparam"><span class="type">int</span> <code class="parameter">$type</code></span>
     )</div>

    <p class="para rdfs-comment">
     ステートメントリソースあるいは接続リソースのオプションを設定します。
     結果セットリソースのオプションを設定することはできません。
    </p>
  </div>

  <div class="refsect1 parameters" id="refsect1-function.db2-set-option-parameters">
    <h3 class="title">パラメータ</h3>
    <p class="para">
      <dl>

        
          <dt>
<code class="parameter">resource</code></dt>

          <dd>

            <p class="para">
             <span class="function"><a href="function.db2-prepare.html" class="function">db2_prepare()</a></span> が返す有効なステートメントリソースか、
             あるいは <span class="function"><a href="function.db2-connect.html" class="function">db2_connect()</a></span> や
             <span class="function"><a href="function.db2-pconnect.html" class="function">db2_pconnect()</a></span> が返す有効な接続リソース。
            </p>
          </dd>

        
        
          <dt>
<code class="parameter">options</code></dt>

          <dd>

            <p class="para">
             ステートメントあるいは接続のオプションを含む連想配列。
             このパラメータは、自動コミットの値を変更したりカーソルの型を
             (スクロール可能、あるいは前進のみに) 変更したり、結果セットに表示されるカラム名を
             (小文字、大文字、あるいは元のままに) 設定したりする際に使用します。
              <dl>

                
                  <dt>
<code class="parameter">autocommit</code></dt>

                  <dd>

                    <p class="para">
                     <em>DB2_AUTOCOMMIT_ON</em> を渡すと、
                     指定した接続リソースの自動コミットをオンにします。
                    </p>
                    <p class="para">
                     <em>DB2_AUTOCOMMIT_OFF</em> を渡すと、
                     指定した接続リソースの自動コミットをオフにします。
                    </p>
                  </dd>

                
                
                  <dt>
<code class="parameter">cursor</code></dt>

                  <dd>

                    <p class="para">
                     <em>DB2_FORWARD_ONLY</em> を渡すと、
                     ステートメントリソースに前進のみのカーソルを指定します。
                     これはデフォルトのカーソル型であり、
                     すべてのデータベースサーバーでサポートされています。
                    </p>
                    <p class="para">
                     <em>DB2_SCROLLABLE</em> を渡すと、
                     ステートメントリソースにスクロール可能なカーソルを指定します。
                     このカーソルは、順番どおり以外の方法で結果セットの行にアクセス可能です。
                     しかし、IBM DB2 Universal Database でしかサポートされていません。
                    </p>
                  </dd>

                
                
                  <dt>
<code class="parameter">binmode</code></dt>

                  <dd>

                    <p class="para">
                     <em>DB2_BINARY</em> を渡すと、
                     バイナリデータがそのままの形式で返されるようになります。
                     これはデフォルトのモードです。<var class="filename">php.ini</var> で
                     <em>ibm_db2.binmode=1</em> とするのと同じことです。
                    </p>
                    <p class="para">
                     <em>DB2_CONVERT</em> を渡すと、
                     バイナリデータを十六進エンコーディングで変換して返します。
                     これは、<var class="filename">php.ini</var> で
                     <em>ibm_db2.binmode=2</em> とするのと同じことです。
                    </p>
                    <p class="para">
                     <em>DB2_PASSTHRU</em> を渡すと、
                     バイナリデータを <strong><code>NULL</code></strong> に変換するようになります。これは
                     <var class="filename">php.ini</var> で <em>ibm_db2.binmode=3</em>
                     とするのと同じことです。
                    </p>
                  </dd>

                
                
                  <dt>
<code class="parameter">db2_attr_case</code></dt>

                  <dd>

                    <p class="para">
                     <em>DB2_CASE_LOWER</em> を渡すと、
                     結果セットのカラム名を小文字で返します。
                    </p>
                    <p class="para">
                     <em>DB2_CASE_UPPER</em> を渡すと、
                     結果セットのカラム名を大文字で返します。
                    </p>
                    <p class="para">
                     <em>DB2_CASE_NATURAL</em> を渡すと、
                     結果セットのカラム名をそのまま何もせずに返します。
                    </p>
                  </dd>

                
                
                 <dt>
<code class="parameter">deferred_prepare</code></dt>

                 <dd>

                  <p class="para">
                   <em>DB2_DEFERRED_PREPARE_ON</em> を渡すと、
                   指定したステートメントリソースについて遅延プリペアを有効にします。
                  </p>
                  <p class="para">
                   <em>DB2_DEFERRED_PREPARE_OFF</em> を渡すと、
                   指定したステートメントリソースについて遅延プリペアを無効にします。
                  </p>
                 </dd>

                                
              </dl>

            </p>
            <p class="para">
             以下の新しい i5/OS オプションは、ibm_db2 のバージョン 1.5.1 以降で使用可能です。
             これらのオプションが適用されるのは、PHP と ibm_db2 が
             i5 システム上でネイティブに動作している場合のみです。
              <dl>

                
                  <dt>
<code class="parameter">i5_fetch_only</code></dt>

                  <dd>

                    <p class="para">
                     <em>DB2_I5_FETCH_ON</em> - 
                     カーソルは読み込み専用となり、場所を指定しての更新や削除には使用できません。
                     これは、<em>SQL_ATTR_FOR_FETCH_ONLY</em>
                     が <em>SQL_FALSE</em> に設定されていない場合のデフォルト設定です。
                    </p>
                    <p class="para">
                     <em>DB2_I5_FETCH_OFF</em> -
                     カーソルは、場所を指定しての更新や削除に使用できるようになります。
                    </p>
                  </dd>

                
               </dl>

            </p>
            <p class="para">
             以下の新しいオプションが、ibm_db2 バージョン 1.8.0 以降で使用可能です。
              <dl>

                
                  <dt>
<code class="parameter">rowcount</code></dt>

                  <dd>

                    <p class="para">
                     <em>DB2_ROWCOUNT_PREFETCH_ON</em> -
                     クライアントは、取得する前に全行数を問い合わせることができます。つまり、
                     <em>ROLLFORWARD_ONLY</em> カーソルを使っている場合でも
                     選択された行数を <span class="function"><a href="function.db2-num-rows.html" class="function">db2_num_rows()</a></span> で取得することができます。
                    </p>
                    <p class="para">
                     <em>DB2_ROWCOUNT_PREFETCH_OFF</em> -
                     クライアントは、取得する前に全行数を問い合わせることができません。
                    </p>
                  </dd>

                
              </dl>

            </p>            
            <p class="para">
             以下の新しいオプションが、ibm_db2 バージョン 1.7.0 以降で使用可能です。
              <dl>

                
                  <dt>
<code class="parameter">trusted_user</code></dt>

                  <dd>

                    <p class="para">
                     ユーザーを信頼済みユーザーに変更する際に、信頼済みユーザーのユーザー ID
                     (文字列) をこのキーの値として渡します。
                     このオプションは、接続リソース上でのみ設定可能です。
                     このオプションを使用するには、
                     信頼済みコンテキストを接続リソース上で有効にしなければなりません。
                    </p>
                  </dd>

                
                
                  <dt>
<code class="parameter">trusted_password</code></dt>

                  <dd>

                    <p class="para">
                     trusted_user キーで指定したユーザーに対応するパスワード (文字列)。
                    </p>
                  </dd>

                                
               </dl>

            </p>            
            <p class="para">
             以下の新しいオプションが、ibm_db2 バージョン 1.6.0 以降で使用可能です。
             これらは、有用な情報を提供します。これらの情報は、
             <span class="function"><a href="function.db2-get-option.html" class="function">db2_get_option()</a></span> によって取得します。
             <blockquote class="note"><p><strong class="note">注意</strong>: 
              <p class="para">
               各オプションの値を設定する際、
               サーバーによっては指定したすべての内容を処理できないことがあります。
               その場合、値が切り詰められます。
              </p>
              <p class="para">
               指定したオプションが正しく変換されてホストシステムに送信されることを確実にするには、
               A から Z までの文字と 0 から 9 までの数字、そしてアンダースコア
               (_) とピリオド (.) のみを使用するようにします。
              </p>
             </p></blockquote>
             <dl>

              
               <dt>
<code class="parameter">userid</code></dt>

               <dd>

                <p class="para">
                 <em>SQL_ATTR_INFO_USERID</em> -
                 ヌル終端の文字列へのポインタで、DB2 接続の際にホストデータベースサーバーに送信する
                 クライアントのユーザー ID として使用します。
                 <blockquote class="note"><p><strong class="note">注意</strong>: 
                  <p class="para">
                   z/OS および OS/390 サーバー版の DB2 は 16 文字までの長さをサポートしています。
                   このユーザー ID を、認証時に使用するユーザー ID と混同しないでください。
                   これは識別のためだけに使用するものであり、認証には用いられません。
                  </p>
                 </p></blockquote>
                </p>
               </dd>

              
              
               <dt>
<code class="parameter">acctstr</code></dt>

               <dd>

                <p class="para">
                 <em>SQL_ATTR_INFO_ACCTSTR</em> -
                 ヌル終端の文字列へのポインタで、DB2 接続の際にホストデータベースサーバーに送信する
                 クライアントのアカウンティング・ストリングとして使用します。
                 <blockquote class="note"><p><strong class="note">注意</strong>: 
                  <p class="para">
                   z/OS および OS/390 サーバー版の DB2 は 200 文字までの長さをサポートしています。
                  </p>
                 </p></blockquote>
                </p>
               </dd>

              
              
               <dt>
<code class="parameter">applname</code></dt>

               <dd>

                <p class="para">
                 <em>SQL_ATTR_INFO_APPLNAME</em> -
                 ヌル終端の文字列へのポインタで、DB2 接続の際にホストデータベースサーバーに送信する
                 クライアントのアプリケーション名として使用します。
                 <blockquote class="note"><p><strong class="note">注意</strong>: 
                  <p class="para">
                   z/OS および OS/390 サーバー版の DB2 は 32 文字までの長さをサポートしています。
                  </p>
                 </p></blockquote>
                </p>
               </dd>

              
              
               <dt>
<code class="parameter">wrkstnname</code></dt>

               <dd>

                <p class="para">
                 <em>SQL_ATTR_INFO_WRKSTNNAME</em> -
                 ヌル終端の文字列へのポインタで、DB2 接続の際にホストデータベースサーバーに送信する
                 クライアントのワークステーション名として使用します。
                 <blockquote class="note"><p><strong class="note">注意</strong>: 
                  <p class="para">
                   z/OS および OS/390 サーバー版の DB2 は 18 文字までの長さをサポートしています。
                  </p>
                 </p></blockquote>
                </p>
               </dd>

              
             </dl>

            </p>
          </dd>

        
        
          <dt>
<code class="parameter">type</code></dt>

          <dd>

            <p class="para">
             この関数に渡すリソースの型を、整数値で指定します。
             リソースの型とこの値は必ず一致していなければなりません。
            </p>
            <p class="para">
             <em>1</em> は、
             接続リソースがこの関数に渡されることを表します。
            </p>
            <p class="para">
             <em>1</em> 以外の整数を指定すると、
             ステートメントリソースがこの関数に渡されることを表します。
            </p>
          </dd>

        
      </dl>

    </p>
    <p class="para">
    </p>
    <p class="para">
     次の表は、それぞれのオプションがどのリソース型で使用可能かをまとめたものです。
      <table class="doctable table">
        <caption><strong>リソースとパラメータの対応</strong></caption>
        
          <col style="text-align: center;" />
          <col style="text-align: center;" />
          <col style="text-align: center;" />
          <col style="text-align: center;" />
          <col style="text-align: center;" />
          
          <thead>
            <tr>
              <th>キー</th>
              <th>値</th>
              <th colspan="3">リソースの型</th>
            </tr>

          </thead>


          <tbody class="tbody">
            <tr>
              <td class="empty">&nbsp;</td><td class="empty">&nbsp;</td><td>接続</td>
              <td>ステートメント</td>
              <td>結果セット</td>
            </tr>

            <tr>
              <td>autocommit</td>
              <td><em>DB2_AUTOCOMMIT_ON</em></td>
              <td>X</td>
              <td>-</td>
              <td>-</td>
            </tr>

            <tr>
              <td>autocommit</td>
              <td><em>DB2_AUTOCOMMIT_OFF</em></td>
              <td>X</td>
              <td>-</td>
              <td>-</td>
            </tr>

            <tr>
              <td>cursor</td>
              <td><em>DB2_SCROLLABLE</em></td>
              <td>-</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>cursor</td>
              <td><em>DB2_FORWARD_ONLY</em></td>
              <td>-</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>binmode</td>
              <td><em>DB2_BINARY</em></td>
              <td>X</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>binmode</td>
              <td><em>DB2_CONVERT</em></td>
              <td>X</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>binmode</td>
              <td><em>DB2_PASSTHRU</em></td>
              <td>X</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>db2_attr_case</td>
              <td><em>DB2_CASE_LOWER</em></td>
              <td>X</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>db2_attr_case</td>
              <td><em>DB2_CASE_UPPER</em></td>
              <td>X</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>db2_attr_case</td>
              <td><em>DB2_CASE_NATURAL</em></td>
              <td>X</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>deferred_prepare</td>
              <td><em>DB2_DEFERRED_PREPARE_ON</em></td>
              <td>-</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>deferred_prepare</td>
              <td><em>DB2_DEFERRED_PREPARE_OFF</em></td>
              <td>-</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>i5_fetch_only</td>
              <td><em>DB2_I5_FETCH_ON</em></td>
              <td>-</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>i5_fetch_only</td>
              <td><em>DB2_I5_FETCH_OFF</em></td>
              <td>-</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>rowcount</td>
              <td><em>DB2_ROWCOUNT_PREFETCH_ON</em></td>
              <td>-</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>rowcount</td>
              <td><em>DB2_ROWCOUNT_PREFETCH_OFF</em></td>
              <td>-</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>trusted_user</td>
              <td><em>&lt;USER NAME&gt; (文字列)</em></td>
              <td>X</td>
              <td>-</td>
              <td>-</td>
            </tr>

            <tr>
              <td>trusted_password</td>
              <td><em>&lt;PASSWORD&gt; (文字列)</em></td>
              <td>X</td>
              <td>-</td>
              <td>-</td>
            </tr>

            <tr>
              <td>userid</td>
              <td><em>SQL_ATTR_INFO_USERID</em></td>
              <td>X</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>acctstr</td>
              <td><em>SQL_ATTR_INFO_ACCTSTR</em></td>
              <td>X</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>applname</td>
              <td><em>SQL_ATTR_INFO_APPLNAME</em></td>
              <td>X</td>
              <td>X</td>
              <td>-</td>
            </tr>

            <tr>
              <td>wrkstnname</td>
              <td><em>SQL_ATTR_INFO_WRKSTNNAME</em></td>
              <td>X</td>
              <td>X</td>
              <td>-</td>
            </tr>

          </tbody>
        
      </table>

    </p>
  </div>

  
  <div class="refsect1 returnvalues" id="refsect1-function.db2-set-option-returnvalues">
    <h3 class="title">返り値</h3>
    <p class="para">
     成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
    </p>
  </div>

  
  
  
  <div class="refsect1 examples" id="refsect1-function.db2-set-option-examples">
    <h3 class="title">例</h3>
    <p class="para">

      <div class="example" id="example-1230">
        <p><strong>例1 接続リソースにひとつのパラメータを設定する</strong></p>
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;データベース接続用のパラメータ&nbsp;*/<br /></span><span style="color: #0000BB">$database&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'SAMPLE'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$hostname&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$port&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">50000</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'TCPIP'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'db2inst1'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'ibmdb2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続文字列&nbsp;*/<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"DRIVER={IBM&nbsp;DB2&nbsp;ODBC&nbsp;DRIVER};DATABASE=</span><span style="color: #0000BB">$database</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"HOSTNAME=</span><span style="color: #0000BB">$hostname</span><span style="color: #DD0000">;PORT=</span><span style="color: #0000BB">$port</span><span style="color: #DD0000">;PROTOCOL=</span><span style="color: #0000BB">$protocol</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"UID=</span><span style="color: #0000BB">$username</span><span style="color: #DD0000">;PWD=</span><span style="color: #0000BB">$password</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続リソースを取得します&nbsp;*/<br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn_string</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;有効なキーと値を使用して、オプションの連想配列を作成します&nbsp;*/<br /></span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'autocommit'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_AUTOCOMMIT_ON</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;正しいリソースとオプションの配列、そして型を表す値を指定して関数をコールします&nbsp;*/<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_set_option</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;すべてのオプションが正しく設定できたかどうかを調べます&nbsp;*/<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$result</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションの設定に成功しました'</span><span style="color: #007700">;<br />}<br />else<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションが設定できませんでした'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

        <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
        <div class="example-contents screen"><div class="cdata"><pre>オプションの設定に成功しました</pre></div></div>
      </div>

      <div class="example" id="example-1231">
        <p><strong>例2 接続リソースに複数のパラメータを設定する</strong></p>
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;データベース接続用のパラメータ&nbsp;*/<br /></span><span style="color: #0000BB">$database&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'SAMPLE'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$hostname&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$port&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">50000</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'TCPIP'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'db2inst1'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'ibmdb2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続文字列&nbsp;*/<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"DRIVER={IBM&nbsp;DB2&nbsp;ODBC&nbsp;DRIVER};DATABASE=</span><span style="color: #0000BB">$database</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"HOSTNAME=</span><span style="color: #0000BB">$hostname</span><span style="color: #DD0000">;PORT=</span><span style="color: #0000BB">$port</span><span style="color: #DD0000">;PROTOCOL=</span><span style="color: #0000BB">$protocol</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"UID=</span><span style="color: #0000BB">$username</span><span style="color: #DD0000">;PWD=</span><span style="color: #0000BB">$password</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続リソースを取得します&nbsp;*/<br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn_string</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;有効なキーと値を使用して、オプションの連想配列を作成します&nbsp;*/<br /></span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'autocommit'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_AUTOCOMMIT_OFF</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'binmode'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_PASSTHRU</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'db2_attr_case'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_CASE_UPPER</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'cursor'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_SCROLLABLE</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;正しいリソースとオプションの配列、そして型を表す値を指定して関数をコールします&nbsp;*/<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_set_option</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;すべてのオプションが正しく設定できたかどうかを調べます&nbsp;*/<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$result</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションの設定に成功しました'</span><span style="color: #007700">;<br />}<br />else<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションが設定できませんでした'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

        <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
        <div class="example-contents screen"><div class="cdata"><pre>オプションの設定に成功しました</pre></div></div>
      </div>

      
      <div class="example" id="example-1232">
        <p><strong>例3 複数のパラメータを間違ったキーで設定する</strong></p>
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;データベース接続用のパラメータ&nbsp;*/<br /></span><span style="color: #0000BB">$database&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'SAMPLE'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$hostname&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$port&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">50000</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'TCPIP'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'db2inst1'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'ibmdb2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続文字列&nbsp;*/<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"DRIVER={IBM&nbsp;DB2&nbsp;ODBC&nbsp;DRIVER};DATABASE=</span><span style="color: #0000BB">$database</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"HOSTNAME=</span><span style="color: #0000BB">$hostname</span><span style="color: #DD0000">;PORT=</span><span style="color: #0000BB">$port</span><span style="color: #DD0000">;PROTOCOL=</span><span style="color: #0000BB">$protocol</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"UID=</span><span style="color: #0000BB">$username</span><span style="color: #DD0000">;PWD=</span><span style="color: #0000BB">$password</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続リソースを取得します&nbsp;*/<br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn_string</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;有効なキーと値を使用して、オプションの連想配列を作成します&nbsp;*/<br /></span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'autocommit'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_AUTOCOMMIT_OFF</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'MY_INVALID_KEY'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_PASSTHRU</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'db2_attr_case'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_CASE_UPPER</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'cursor'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_SCROLLABLE</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;正しいリソースとオプションの配列、そして型を表す値を指定して関数をコールします&nbsp;*/<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_set_option</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;すべてのオプションが正しく設定できたかどうかを調べます&nbsp;*/<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$result</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションの設定に成功しました'</span><span style="color: #007700">;<br />}<br />else<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションが設定できませんでした'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

        <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
        <div class="example-contents screen"><div class="cdata"><pre>オプションが設定できませんでした</pre></div></div>
      </div>

      
      <div class="example" id="example-1233">
        <p><strong>例4 複数のパラメータを間違った値で設定する</strong></p>
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;データベース接続用のパラメータ&nbsp;*/<br /></span><span style="color: #0000BB">$database&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'SAMPLE'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$hostname&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$port&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">50000</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'TCPIP'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'db2inst1'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'ibmdb2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続文字列&nbsp;*/<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"DRIVER={IBM&nbsp;DB2&nbsp;ODBC&nbsp;DRIVER};DATABASE=</span><span style="color: #0000BB">$database</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"HOSTNAME=</span><span style="color: #0000BB">$hostname</span><span style="color: #DD0000">;PORT=</span><span style="color: #0000BB">$port</span><span style="color: #DD0000">;PROTOCOL=</span><span style="color: #0000BB">$protocol</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"UID=</span><span style="color: #0000BB">$username</span><span style="color: #DD0000">;PWD=</span><span style="color: #0000BB">$password</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続リソースを取得します&nbsp;*/<br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn_string</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;有効なキーと値を使用して、オプションの連想配列を作成します&nbsp;*/<br /></span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'autocommit'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_AUTOCOMMIT_OFF</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'binmode'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'INVALID_VALUE'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'db2_attr_case'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_CASE_UPPER</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'cursor'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_SCROLLABLE</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;正しいリソースとオプションの配列、そして型を表す値を指定して関数をコールします&nbsp;*/<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_set_option</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;すべてのオプションが正しく設定できたかどうかを調べます&nbsp;*/<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$result</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションの設定に成功しました'</span><span style="color: #007700">;<br />}<br />else<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションが設定できませんでした'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

        <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
        <div class="example-contents screen"><div class="cdata"><pre>オプションが設定できませんでした</pre></div></div>
      </div>

      <div class="example" id="example-1234">
        <p><strong>例5 複数のパラメータを接続リソースに設定する (間違った型を指定する)</strong></p>
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;データベース接続用のパラメータ&nbsp;*/<br /></span><span style="color: #0000BB">$database&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'SAMPLE'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$hostname&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$port&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">50000</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'TCPIP'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'db2inst1'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'ibmdb2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続文字列&nbsp;*/<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"DRIVER={IBM&nbsp;DB2&nbsp;ODBC&nbsp;DRIVER};DATABASE=</span><span style="color: #0000BB">$database</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"HOSTNAME=</span><span style="color: #0000BB">$hostname</span><span style="color: #DD0000">;PORT=</span><span style="color: #0000BB">$port</span><span style="color: #DD0000">;PROTOCOL=</span><span style="color: #0000BB">$protocol</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"UID=</span><span style="color: #0000BB">$username</span><span style="color: #DD0000">;PWD=</span><span style="color: #0000BB">$password</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続リソースを取得します&nbsp;*/<br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn_string</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;有効なキーと値を使用して、オプションの連想配列を作成します&nbsp;*/<br /></span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'autocommit'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_AUTOCOMMIT_OFF</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'binmode'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_PASSTHRU</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'db2_attr_case'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_CASE_UPPER</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'cursor'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_SCROLLABLE</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;正しいリソースとオプションの配列、そして間違った型を表す値を指定して関数をコールします&nbsp;*/<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_set_option</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;すべてのオプションが正しく設定できたかどうかを調べます&nbsp;*/<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$result</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションの設定に成功しました'</span><span style="color: #007700">;<br />}<br />else<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションが設定できませんでした'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

        <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
        <div class="example-contents screen"><div class="cdata"><pre>オプションが設定できませんでした</pre></div></div>
      </div>

      <div class="example" id="example-1235">
        <p><strong>例6 複数のパラメータを間違ったリソースに設定する</strong></p>
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;データベース接続用のパラメータ&nbsp;*/<br /></span><span style="color: #0000BB">$database&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'SAMPLE'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$hostname&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$port&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">50000</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'TCPIP'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'db2inst1'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'ibmdb2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続文字列&nbsp;*/<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"DRIVER={IBM&nbsp;DB2&nbsp;ODBC&nbsp;DRIVER};DATABASE=</span><span style="color: #0000BB">$database</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"HOSTNAME=</span><span style="color: #0000BB">$hostname</span><span style="color: #DD0000">;PORT=</span><span style="color: #0000BB">$port</span><span style="color: #DD0000">;PROTOCOL=</span><span style="color: #0000BB">$protocol</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"UID=</span><span style="color: #0000BB">$username</span><span style="color: #DD0000">;PWD=</span><span style="color: #0000BB">$password</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続リソースを取得します&nbsp;*/<br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn_string</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;有効なキーと値を使用して、オプションの連想配列を作成します&nbsp;*/<br /></span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'autocommit'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_AUTOCOMMIT_OFF</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'binmode'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_PASSTHRU</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'db2_attr_case'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_CASE_UPPER</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'cursor'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_SCROLLABLE</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;EMPLOYEE'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;間違ったリソース、そして正しいオプションの配列と型を表す値を指定して関数をコールします&nbsp;*/<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_set_option</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;すべてのオプションが正しく設定できたかどうかを調べます&nbsp;*/<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$result</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションの設定に成功しました'</span><span style="color: #007700">;<br />}<br />else<br />{<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'オプションが設定できませんでした'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

        <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
        <div class="example-contents screen"><div class="cdata"><pre>オプションが設定できませんでした</pre></div></div>
      </div>

      <div class="example" id="example-1236">
        <p><strong>例7 すべてひとつにまとめる</strong></p>
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;データベース接続用のパラメータ&nbsp;*/<br /></span><span style="color: #0000BB">$database&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'SAMPLE'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$hostname&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$port&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">50000</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'TCPIP'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'db2inst1'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'ibmdb2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続文字列&nbsp;*/<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"DRIVER={IBM&nbsp;DB2&nbsp;ODBC&nbsp;DRIVER};DATABASE=</span><span style="color: #0000BB">$database</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"HOSTNAME=</span><span style="color: #0000BB">$hostname</span><span style="color: #DD0000">;PORT=</span><span style="color: #0000BB">$port</span><span style="color: #DD0000">;PROTOCOL=</span><span style="color: #0000BB">$protocol</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn_string&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"UID=</span><span style="color: #0000BB">$username</span><span style="color: #DD0000">;PWD=</span><span style="color: #0000BB">$password</span><span style="color: #DD0000">;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続リソースを取得します&nbsp;*/<br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn_string</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;有効なキーと値を使用して、オプションの連想配列を作成します&nbsp;*/<br /></span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'db2_attr_case'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_CASE_LOWER</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'cursor'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">DB2_SCROLLABLE</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;EMPLOYEE&nbsp;WHERE&nbsp;EMPNO&nbsp;=&nbsp;?&nbsp;OR&nbsp;EMPNO&nbsp;=&nbsp;?'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;正しいリソースとオプションの配列、そして型を表す値を指定して関数をコールします&nbsp;*/<br /></span><span style="color: #0000BB">$option_result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_set_option</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'000130'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'000140'</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">/*&nbsp;スクロール可能なカーソルのため、1&nbsp;行目より先に&nbsp;2&nbsp;行目を取得します&nbsp;*/<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">db2_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">));<br />print&nbsp;</span><span style="color: #DD0000">'&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">db2_fetch_assoc</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

        <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
        <div class="example-contents screen"><div class="cdata"><pre>Array
(
    [empno] =&gt; 000140
    [firstnme] =&gt; HEATHER
    [midinit] =&gt; A
    [lastname] =&gt; NICHOLLS
    [workdept] =&gt; C01
    [phoneno] =&gt; 1793
    [hiredate] =&gt; 1976-12-15
    [job] =&gt; ANALYST
    [edlevel] =&gt; 18
    [sex] =&gt; F
    [birthdate] =&gt; 1946-01-19
    [salary] =&gt; 28420.00
    [bonus] =&gt; 600.00
    [comm] =&gt; 2274.00
)

Array
(
    [empno] =&gt; 000130
    [firstnme] =&gt; DELORES
    [midinit] =&gt; M
    [lastname] =&gt; QUINTANA
    [workdept] =&gt; C01
    [phoneno] =&gt; 4578
    [hiredate] =&gt; 1971-07-28
    [job] =&gt; ANALYST
    [edlevel] =&gt; 16
    [sex] =&gt; F
    [birthdate] =&gt; 1925-09-15
    [salary] =&gt; 23800.00
    [bonus] =&gt; 500.00
    [comm] =&gt; 1904.00
)</pre></div></div>
      </div>
      <div class="example" id="example-1237">
        <p><strong>例8 i5/OS カーソルは読み込み専用</strong></p>
        <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">""</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"i5_lib"</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"nobody"</span><span style="color: #007700">));<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'select&nbsp;*&nbsp;from&nbsp;names&nbsp;where&nbsp;first&nbsp;=&nbsp;?'</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"first2"</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">db2_bind_param</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"name"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">DB2_PARAM_IN</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"i5_fetch_only"</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">DB2_I5_FETCH_ON</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">db2_set_option</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,</span><span style="color: #0000BB">$options</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br />&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">db2_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">db2_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #007700">{</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]}</span><span style="color: #DD0000">&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]}</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
        </div>

        <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
        <div class="example-contents screen">
<div class="cdata"><pre>
first2 last2
</pre></div>
        </div>
      </div>
    </p>
  </div>

  <div class="refsect1 seealso" id="refsect1-function.db2-set-option-seealso">
    <h3 class="title">参考</h3>
    <p class="para">
      <ul class="simplelist">
        <li class="member"><span class="function"><a href="function.db2-connect.html" class="function" rel="rdfs-seeAlso">db2_connect()</a> - データベースへの接続を返す</span></li>
        <li class="member"><span class="function"><a href="function.db2-pconnect.html" class="function" rel="rdfs-seeAlso">db2_pconnect()</a> - データベースへの持続的接続を返す</span></li>
        <li class="member"><span class="function"><a href="function.db2-exec.html" class="function" rel="rdfs-seeAlso">db2_exec()</a> - SQL 文を直接実行する</span></li>
        <li class="member"><span class="function"><a href="function.db2-prepare.html" class="function" rel="rdfs-seeAlso">db2_prepare()</a> - 実行する SQL 文を準備する</span></li>
        <li class="member"><span class="function"><a href="function.db2-cursor-type.html" class="function" rel="rdfs-seeAlso">db2_cursor_type()</a> - ステートメントリソースが使用しているカーソルの型を返す</span></li>
      </ul>
    </p>
  </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="70903""></a>
  <div class="note">
   <strong class="user">rtejpar at ca dot ibm dot com</strong>
   <a href="#70903" class="date">03-Nov-2006 04:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Examples 3 and 4 should output 'Options Set Successfully.'&nbsp; This is because, only a single option's key/value is set incorrectly (other options are still correct), hence the function must return successfully. (Instead a PHP warning will most probably be issued).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
