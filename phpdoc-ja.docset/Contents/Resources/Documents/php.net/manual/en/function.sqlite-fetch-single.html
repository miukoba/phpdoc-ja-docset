<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>結果セットの最初のカラムを文字列として取得する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.sqlite-fetch-object.html">≪ sqlite_fetch_object</a></li>
      <li style="float: right;"><a href="function.sqlite-fetch-string.html">sqlite_fetch_string ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.sqlite.html">SQLite 関数</a></li>
    <li>結果セットの最初のカラムを文字列として取得する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.sqlite-fetch-single" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">sqlite_fetch_single</h1>
  <h1 class="refname">SQLiteResult::fetchSingle</h1>
  <h1 class="refname">SQLiteUnbuffered::fetchSingle</h1>
  <p class="verinfo">(PHP 5 &lt; 5.4.0, PECL sqlite &gt;= 1.0.1)</p><p class="refpurpose"><span class="refname">sqlite_fetch_single</span> -- <span class="refname">SQLiteResult::fetchSingle</span> -- <span class="refname">SQLiteUnbuffered::fetchSingle</span> &mdash; <span class="dc-title">結果セットの最初のカラムを文字列として取得する</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.sqlite-fetch-single-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>sqlite_fetch_single</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$decode_binary</code><span class="initializer"> = true</span></span>
  ] )</div>

  <p class="para rdfs-comment">オブジェクト指向型 (メソッド):</p>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>SQLiteResult::fetchSingle</strong></span>
    ([ <span class="methodparam"><span class="type">bool</span> <code class="parameter">$decode_binary</code><span class="initializer"> = true</span></span>
  ] )</div>

  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>SQLiteUnbuffered::fetchSingle</strong></span>
    ([ <span class="methodparam"><span class="type">bool</span> <code class="parameter">$decode_binary</code><span class="initializer"> = true</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>sqlite_fetch_single()</strong></span> は、
   レコードセットの最初のカラムの値を返すことを除いて
   <span class="function"><a href="function.sqlite-fetch-array.html" class="function">sqlite_fetch_array()</a></span> と等価です。
  </p>
  <p class="para">
   この関数は、データの単一カラムの値を確認するだけの場合に
   データを処理する最善の方法です。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.sqlite-fetch-single-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">result</code></dt>

     <dd>

      <p class="para">
       SQLite 結果リソース。
       このパラメータは、
       オブジェクト指向言語型メソッドを使用する場合は不要です。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">decode_binary</code></dt>

     <dd>

      <p class="para">
<code class="parameter">decode_binary</code> パラメータが <strong><code>TRUE</code></strong> (デフォルト)に
設定された場合、PHP はバイナリエンコーディングをデコードします。
これは、<span class="function"><a href="function.sqlite-escape-string.html" class="function">sqlite_escape_string()</a></span> によりエンコードされたデータに
適用されます。sqlite をサポートする他のアプリケーションにより
作成されたデータベースを処理する時以外は、この値をデフォルトのままにしておくべきです。</p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.sqlite-fetch-single-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   最初のカラムの値を文字列で返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.sqlite-fetch-single-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-2239">
    <p><strong>例1 <span class="function"><strong>sqlite_fetch_single()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$dbhandle&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">sqlite_open</span><span style="color: #007700">(</span><span style="color: #DD0000">'mysqlitedb'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0666</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sqliteerror</span><span style="color: #007700">))&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;id&nbsp;FROM&nbsp;sometable&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;42"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$res&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">sqlite_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbhandle</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">sqlite_num_rows</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">)&nbsp;&gt;&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">sqlite_fetch_single</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;42<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">sqlite_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbhandle</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.sqlite-fetch-single-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.sqlite-fetch-array.html" class="function" rel="rdfs-seeAlso">sqlite_fetch_array()</a> - 結果セットから次のレコードを配列として取得する</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="92771""></a>
  <div class="note">
   <strong class="user">visavi dot net at mail dot ru (Vantuz)</strong>
   <a href="#92771" class="date">08-Aug-2009 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With the help of sqlite_fetch_single, you can quickly and easily calculate the number of elements in the table<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// create new database (OO interface)<br />
</span><span class="default">$db </span><span class="keyword">= new </span><span class="default">SQLiteDatabase</span><span class="keyword">(</span><span class="string">'database.db'</span><span class="keyword">, </span><span class="default">0666</span><span class="keyword">);<br />
<br />
</span><span class="comment">// create table inbox and paste data<br />
</span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">queryExec</span><span class="keyword">(</span><span class="string">"<br />
CREATE TABLE inbox (<br />
inbox_id INTEGER NOT NULL PRIMARY KEY,<br />
inbox_send varchar(20) NOT NULL,<br />
inbox_text TEXT NOT NULL,<br />
inbox_time INTEGER UNSIGNED NOT NULL,<br />
inbox_user varchar(20) NOT NULL<br />
);"</span><span class="keyword">);<br />
<br />
</span><span class="default">$ins_query </span><span class="keyword">= </span><span class="string">"<br />
INSERT INTO inbox (inbox_send, inbox_text, inbox_time, inbox_user) VALUES ('Ilia1', 'Message1', '"</span><span class="keyword">.</span><span class="default">time</span><span class="keyword">().</span><span class="string">"', 'my_name');<br />
INSERT INTO inbox (inbox_send, inbox_text, inbox_time, inbox_user) VALUES ('Ilia2', 'Message2', '"</span><span class="keyword">.</span><span class="default">time</span><span class="keyword">().</span><span class="string">"', 'user');<br />
INSERT INTO inbox (inbox_send, inbox_text, inbox_time, inbox_user) VALUES ('Ilia2', 'Message3', '"</span><span class="keyword">.</span><span class="default">time</span><span class="keyword">().</span><span class="string">"', 'my_name');<br />
"</span><span class="keyword">;<br />
<br />
</span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">queryExec</span><span class="keyword">(</span><span class="default">$ins_query</span><span class="keyword">);<br />
<br />
</span><span class="comment">//view all posts by my_name<br />
</span><span class="default">$total </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">singleQuery</span><span class="keyword">(</span><span class="string">"SELECT count(*) FROM inbox WHERE inbox_user='my_name';"</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$total</span><span class="keyword">;<br />
</span><span class="comment">// the result will be the number 2<br />
<br />
/* P.S. sorry for my english */<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55055""></a>
  <div class="note">
   <strong class="user">jmarbas at hotmail dot com</strong>
   <a href="#55055" class="date">24-Jul-2005 02:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It isnt specified in the above description for this function, but yes this function will not only return the first column, but it will also return the first value (ie from the first row in the result set) of that column. Also the result set pointer is involved here in that if you use sqlite_fetch_single in a loop, it will return each value in the first column sequentially and advance the result set pointer each time.<br />
<br />
i.e. the first loop iteration it returns the first value in the first column. the second loop iteration it returns the second value in the first column. the third loop iteration the third value and so on.<br />
<br />
&nbsp; $handle = sqlite_open("database_file_name") or die("Could not open database");<br />
&nbsp; //generate query string<br />
&nbsp; $query = "select distinct field1 from database_name";<br />
&nbsp; //execute query<br />
&nbsp; $result = sqlite_query($handle,$query)<br />
&nbsp; //if a row exists<br />
&nbsp; if(sqlite_num_rows($result)&gt;0){<br />
&nbsp;&nbsp;&nbsp; echo "&lt;table cellpadding=\"10\" border=\"1\"&gt;";<br />
&nbsp;&nbsp;&nbsp; //check for more rows<br />
&nbsp;&nbsp;&nbsp; while(sqlite_has_more($result)){<br />
&nbsp;&nbsp; &nbsp;&nbsp; //get first field from each row<br />
&nbsp;&nbsp; &nbsp;&nbsp; //print values<br />
&nbsp;&nbsp; &nbsp;&nbsp; $row=sqlite_fetch_single($result);<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "&lt;tr&gt;";<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "&lt;td&gt;".$row."&lt;/td&gt;";<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "&lt;/tr&gt;";<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; echo "&lt;/table&gt;";<br />
&nbsp; }<br />
&nbsp; //close database file<br />
&nbsp; sqlite_close($handle);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43984""></a>
  <div class="note">
   <strong class="user">roga at yoopee dot de</strong>
   <a href="#43984" class="date">11-Jul-2004 10:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful with the use of sqlite_fetch_single() in a while-loop:<br />
<br />
<span class="default">&lt;?php<br />
$result </span><span class="keyword">= </span><span class="default">sqlite_query</span><span class="keyword">(</span><span class="default">$db_handle</span><span class="keyword">, </span><span class="string">'SELECT foo FROM bar;'</span><span class="keyword">);<br />
<br />
while (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">sqlite_fetch_single</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/*...do s.th. with $row...*/<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
This may not work as expected because the loop will stop if any of the foos has a false value (e.g. zero).<br />
<br />
Use sqlite_has_more() instead:<br />
<br />
<span class="default">&lt;?php<br />
$result </span><span class="keyword">= </span><span class="default">sqlite_query</span><span class="keyword">(</span><span class="default">$db_handle</span><span class="keyword">, </span><span class="string">'SELECT foo FROM bar;'</span><span class="keyword">);<br />
<br />
while (</span><span class="default">sqlite_has_more</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$row </span><span class="keyword">= </span><span class="default">sqlite_fetch_single</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/*...do s.th. with $row...*/<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
