<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>値の保存可能な表現を生成する</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.print-r.html">≪ print_r</a></li>
      <li style="float: right;"><a href="function.settype.html">settype ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.var.html">変数操作 関数</a></li>
    <li>値の保存可能な表現を生成する</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.serialize" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">serialize</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">serialize</span> &mdash; <span class="dc-title">値の保存可能な表現を生成する</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.serialize-description">
  <h3 class="title">説明</h3>
   <div class="methodsynopsis dc-description">
    <span class="type">string</span> <span class="methodname"><strong>serialize</strong></span>
     ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$value</code></span>
    )</div>

  <p class="para rdfs-comment">
   値の保存可能な表現を生成します。
  </p>
  <p class="para">
   型や構造を失わずに PHP の値を保存または渡す際に有用です。
  </p>
  <p class="para">
   シリアル化された文字列を PHP の値に戻すには、
   <span class="function"><a href="function.unserialize.html" class="function">unserialize()</a></span> を使用してください。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.serialize-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">value</code></dt>

     <dd>

      <p class="para">
       シリアル化する値。
       <span class="function"><strong>serialize()</strong></span> は、<span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>
       以外の全ての型を処理します。自分自身への参照を含む配列を
       <span class="function"><strong>serialize()</strong></span> することも可能です。
       シリアル化した配列/オブジェクト内の
       循環参照も保存されます。その他の参照は失われます。
      </p>
      <p class="para">
       PHP は、シリアル化の前にまずメンバ関数 <a href="language.oop5.magic.html#object.sleep" class="link">__sleep()</a>
       のコールを試みます。ここで、シリアル化の前のオブジェクトの後始末処理
       などを行います。同様に、<span class="function"><a href="function.unserialize.html" class="function">unserialize()</a></span> で
       オブジェクトを復元した際にはメンバ関数
       <a href="language.oop5.magic.html#object.wakeup" class="link">__wakeup()</a> がコールされます。
      </p>
      <blockquote class="note"><p><strong class="note">注意</strong>: 
       <p class="para">
       オブジェクトの private メンバは、メンバ名の前にクラス名がつきます。
       また protected メンバはメンバ名の前に &#039;*&#039; がつきます。
       前に付加されるこれらの値の前後には null バイトがついています。
       </p>
      </p></blockquote>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.serialize-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   <code class="parameter">value</code>
   の保存可能なバイトストリーム表現を含む文字列を返します。
  </p>
  <p class="para">
   これはバイナリ文字列であり、null バイトを含む可能性もあることに注意しましょう。
   保存したり利用したりするときも、null バイトが含まれることを想定しておかないといけません。
   たとえば、<span class="function"><strong>serialize()</strong></span> の出力をデータベースに格納するときには、
   通常は CHAR 型や TEXT 型ではなく BLOB 型を使わないといけません。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.serialize-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-5377">
    <p><strong>例1 <span class="function"><strong>serialize()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;$session_data&nbsp;はカレントユーザーのセッション情報を含む多次元配列を<br />//&nbsp;保持しています。リクエストの最後にこれをデータベースに保存するために<br />//&nbsp;serialize()&nbsp;を使用します。<br /><br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">odbc_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"webdb"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"php"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"chicken"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">odbc_prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"UPDATE&nbsp;sessions&nbsp;SET&nbsp;data&nbsp;=&nbsp;?&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;?"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$sqldata&nbsp;</span><span style="color: #007700">=&nbsp;array&nbsp;(</span><span style="color: #0000BB">serialize</span><span style="color: #007700">(</span><span style="color: #0000BB">$session_data</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'PHP_AUTH_USER'</span><span style="color: #007700">]);<br />if&nbsp;(!</span><span style="color: #0000BB">odbc_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sqldata</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$stmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">odbc_prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"INSERT&nbsp;INTO&nbsp;sessions&nbsp;(id,&nbsp;data)&nbsp;VALUES(?,&nbsp;?)"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">odbc_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sqldata</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;何か問題があったようです..&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.serialize-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    PHP の組み込みオブジェクトの多くはシリアル化できないことに注意しましょう。しかし、
    <span class="interfacename"><a href="class.serializable.html" class="interfacename">Serializable</a></span> インターフェイスを実装しているか、あるいはマジックメソッド
    <a href="language.oop5.magic.html#object.sleep" class="link">__sleep()</a> および
    <a href="language.oop5.magic.html#object.wakeup" class="link">__wakeup()</a>
    を実装していればシリアル化することができます。
    内部クラスがこれらの要件を満たしていない場合は、確実にシリアル化することはできません。
   </p>
   <p class="para">
    この規則には歴史的な例外もあり、
    上記のインターフェイスやマジックメソッドを実装していない内部オブジェクトの中にも
    シリアル化可能なものがあります。有名なものには、PHP 5.2.0 より前のバージョンにおける
    <a href="class.arrayobject.html" class="classname">ArrayObject</a> があります。
   </p>
  </p></blockquote>
  <div class="warning"><strong class="warning">警告</strong>
   <p class="para">
    <span class="function"><strong>serialize()</strong></span> でオブジェクトをシリアル化するときに、
    名前空間を指定したクラスの名前の先頭にあるスラッシュは含めません。これは互換性を高めるためです。
   </p>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.serialize-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.unserialize.html" class="function" rel="rdfs-seeAlso">unserialize()</a> - 保存用表現から PHP の値を生成する</span></li>
    <li class="member"><span class="function"><a href="function.var-export.html" class="function" rel="rdfs-seeAlso">var_export()</a> - 変数の文字列表現を出力または返す</span></li>
    <li class="member"><span class="function"><a href="function.json-encode.html" class="function" rel="rdfs-seeAlso">json_encode()</a> - 値を JSON 形式にして返す</span></li>
    <li class="member"><a href="language.oop5.serialization.html" class="link">オブジェクトのシリアル化</a></li>
    <li class="member"><a href="language.oop5.magic.html#object.sleep" class="link">__sleep()</a></li>
    <li class="member"><a href="language.oop5.magic.html#object.wakeup" class="link">__wakeup()</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115159""></a>
  <div class="note">
   <strong class="user">tuxedobob</strong>
   <a href="#115159" class="date">05-Jun-2014 01:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using serialize() to convert, say, an array to a string to pass via HTML forms, you will likely run into issues with quoting. This is because serialize() puts values in double quotes. The simplest solution is to quote your HTML form value with single quotes rather than double quotes. (This *is* allowed, according to W3C specs.)<br />
<br />
So, instead of:<br />
<br />
<span class="default">&lt;?php<br />
$arr </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$some_array</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>&lt;input type="hidden" name="array" value="$arr" /&gt;<br />
<br />
you would want to use:<br />
<br />
<span class="default">&lt;?php<br />
$arr </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$some_array</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>&lt;input type="hidden" name="array" value='$arr' /&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113994""></a>
  <div class="note">
   <strong class="user">Nanhe Kumar</strong>
   <a href="#113994" class="date">27-Dec-2013 02:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note : You cannot save the state of a static variable by serializing.<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
&nbsp;* student.class.php<br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">Student </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$name</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$roll</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$age</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$class</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="string">"Nanhe Kumar"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">roll </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">age </span><span class="keyword">= </span><span class="default">16</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">Student</span><span class="keyword">::</span><span class="default">$class </span><span class="keyword">= </span><span class="string">"10+2"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">?&gt;<br />
&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* serialize.php<br />
&nbsp;*/<br />
</span><span class="keyword">include_once(</span><span class="string">"student.class.php"</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Serialize<br />
</span><span class="default">$so </span><span class="keyword">= new </span><span class="default">Student</span><span class="keyword">();<br />
</span><span class="default">$serialized </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$so</span><span class="keyword">);<br />
</span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="string">"test.txt"</span><span class="keyword">, </span><span class="default">$serialized</span><span class="keyword">);<br />
echo </span><span class="default">$serialized</span><span class="keyword">; </span><span class="comment">//O:7:"Student":3:{s:4:"name";s:11:"Nanhe Kumar";s:13:"Studentroll";i:1;s:6:"*age";i:16;}<br />
</span><span class="default">?&gt;<br />
&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* unserialize.php<br />
&nbsp;*/<br />
</span><span class="keyword">include_once(</span><span class="string">"student.class.php"</span><span class="keyword">);<br />
</span><span class="default">$content </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"test.txt"</span><span class="keyword">);<br />
</span><span class="default">$unserialized </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$unserialized</span><span class="keyword">);</span><span class="comment">//Student Object ( [name] =&gt; Nanhe Kumar [roll:Student:private] =&gt; 1 [age:protected] =&gt; 16 ) <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113305""></a>
  <div class="note">
   <strong class="user">frost at easycast dot ru</strong>
   <a href="#113305" class="date">24-Sep-2013 07:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Closures cannot be serialized:<br />
<span class="default">&lt;?php<br />
$func </span><span class="keyword">= function () {echo </span><span class="string">'hello!'</span><span class="keyword">;};<br />
</span><span class="default">$func</span><span class="keyword">(); </span><span class="comment">// prints "hello!"<br />
<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$func</span><span class="keyword">);&nbsp; </span><span class="comment">// Fatal error: Uncaught exception 'Exception' with message 'Serialization of 'Closure' is not allowed' <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111602""></a>
  <div class="note">
   <strong class="user">allan666 at gmail.com</strong>
   <a href="#111602" class="date">07-Mar-2013 10:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Oddly, if you serialize a class that was previously unserialized, the class of the variable changes to string... Example:<br />
<br />
$R = unserialize($serialized_object);<br />
$R-&gt;method(); // this is ok<br />
$str = serialize($R);<br />
echo(get_class($R));<br />
<br />
this will output "string"!!!!! whereas if the first line was <br />
<br />
$R = new my_class(); <br />
<br />
it would output "my_class"!<br />
<br />
I don't know if that is a bug, but the manual is not clear about that! (somehow $R in serialize($R) is being passed by reference, since it changes class).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111168""></a>
  <div class="note">
   <strong class="user">nh at ngin dot de</strong>
   <a href="#111168" class="date">22-Jan-2013 06:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Serializing floating point numbers leads to weird precision offset errors:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">echo </span><span class="default">round</span><span class="keyword">(</span><span class="default">96.670000000000002</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
</span><span class="comment">// 96.67<br />
<br />
</span><span class="keyword">echo </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">round</span><span class="keyword">(</span><span class="default">96.670000000000002</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">));<br />
</span><span class="comment">// d:96.670000000000002;<br />
<br />
</span><span class="keyword">echo </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">96.67</span><span class="keyword">);<br />
</span><span class="comment">// d:96.670000000000002;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Not only is this wrong, but it adds a lot of unnecessary bulk to serialized data. Probably better to use json_encode() instead (which apparently is faster than serialize(), anyway).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109953""></a>
  <div class="note">
   <strong class="user">Andrew B</strong>
   <a href="#109953" class="date">05-Sep-2012 06:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you serialize an array the internal pointer will not be preserved. Apparently this is the expected behavior but was a bit of a gotcha moment for me. Copy and paste example below.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">//Internal Pointer will be 2 once variables have been assigned.
<br />
</span><span class="default">$array </span><span class="keyword">= array();
<br />
</span><span class="default">$array</span><span class="keyword">[] = </span><span class="default">1</span><span class="keyword">;
<br />
</span><span class="default">$array</span><span class="keyword">[] = </span><span class="default">2</span><span class="keyword">;
<br />
</span><span class="default">$array</span><span class="keyword">[] = </span><span class="default">3</span><span class="keyword">;
<br />

<br />
</span><span class="comment">//Unset variables. Internal pointer will still be at 2.&nbsp; &nbsp;&nbsp; 
<br />
</span><span class="keyword">unset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);
<br />
unset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);
<br />
unset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);
<br />

<br />
</span><span class="comment">//Serialize
<br />
</span><span class="default">$serializeArray </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//Unserialize
<br />
</span><span class="default">$array </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$serializeArray</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//Add a new element to the array
<br />
//If the internal pointer was preserved, the new array key should be 3.
<br />
//Instead the internal pointer has been reset, and the new array key is 0.
<br />
</span><span class="default">$array</span><span class="keyword">[] = </span><span class="default">4</span><span class="keyword">;
<br />

<br />
</span><span class="comment">//Expected Key - 3
<br />
//Actual Key - 0
<br />
</span><span class="keyword">echo </span><span class="string">"&lt;pre&gt;" </span><span class="keyword">, </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) , </span><span class="string">"&lt;/pre&gt;"</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107717""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#107717" class="date">29-Feb-2012 04:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please! please! please! DO NOT serialize data and place it into your database. Serialize can be used that way, but that's missing the point of a relational database and the datatypes inherent in your database engine. Doing this makes data in your database non-portable, difficult to read, and can complicate queries. If you want your application to be portable to other languages, like let's say you find that you want to use Java for some portion of your app that it makes sense to use Java in, serialization will become a pain in the buttocks. You should always be able to query and modify data in the database without using a third party intermediary tool to manipulate data to be inserted. <br />
<br />
I've encountered this too many times in my career, it makes for difficult to maintain code, code with portability issues, and data that is it more difficult to migrate to other RDMS systems, new schema, etc. It also has the added disadvantage of making it messy to search your database based on one of the fields that you've serialized. <br />
<br />
That's not to say serialize() is useless. It's not... A good place to use it may be a cache file that contains the result of a data intensive operation, for instance. There are tons of others... Just don't abuse serialize because the next guy who comes along will have a maintenance or migration nightmare.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102241""></a>
  <div class="note">
   <strong class="user">pgl at yoyo dot org</strong>
   <a href="#102241" class="date">03-Feb-2011 06:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another suggestion for coping with binary data in serialize()d variables is just to base64_encode() those fields before serializing. It will increase the size of the variable, but not by too much.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96504""></a>
  <div class="note">
   <strong class="user">travis at travishegner dot com</strong>
   <a href="#96504" class="date">02-Mar-2010 09:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If serializing objects to be stored into a postgresql database, the 'null byte' injected for private and protected members throws a wrench into the system. Even pg_escape_bytea() on the value, and storing the value as a binary type fails under certain circumstances.
<br />

<br />
For a dirty work around:
<br />
<span class="default">&lt;?php
<br />

<br />
$serialized_object </span><span class="keyword">= </span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$my_object</span><span class="keyword">);
<br />
</span><span class="default">$safe_object </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\0"</span><span class="keyword">, </span><span class="string">"~~NULL_BYTE~~"</span><span class="keyword">, </span><span class="default">$serialized_object</span><span class="keyword">);
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
this allows you to store the object in a readable text format as well. When reading the data back:
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
$serialized_object </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"~~NULL_BYTE~~"</span><span class="keyword">, </span><span class="string">"\0"</span><span class="keyword">, </span><span class="default">$safe_object</span><span class="keyword">);
<br />
</span><span class="default">$my_object </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$serialized_object</span><span class="keyword">);
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
The only gotcha's with this method is if your object member names or values may somehow contain the odd "~~NULL_BYTE~~" string. If that is the case, then str_replace() to a string that you are guaranteed not to have any where else in the string that serialize() returns.
<br />
Also remember to define the class before calling unserialize().
<br />

<br />
If you are storing session data into a postgresql database, then this workaround is an absolute must, because the $data passed to the session's write function is already serialized.
<br />

<br />
Thanks,
<br />
Travis Hegner</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95781""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#95781" class="date">21-Jan-2010 06:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you should really use mysql_real_escape_string() for escaping (serialized) strings that got thrown into a query (visit php.net/mysql_real_escape_string for further information)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93313""></a>
  <div class="note">
   <strong class="user">donotmail at me dot com</strong>
   <a href="#93313" class="date">02-Sep-2009 08:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
NOTE: php's serialize does not properly serialize arrays with which a slice of the array is a reference to the array itself, observe:
<br />

<br />
<span class="default">&lt;?php
<br />
$a </span><span class="keyword">= array();
<br />
</span><span class="default">$a</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"blah"</span><span class="keyword">;
<br />
</span><span class="default">$a</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] =&amp; </span><span class="default">$a</span><span class="keyword">;
<br />

<br />
</span><span class="default">$a</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"pleh"</span><span class="keyword">; </span><span class="comment">// $a[0] === "pleh"
<br />

<br />
</span><span class="default">$b </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">));
<br />

<br />
</span><span class="comment">// $b[0] == "pleh", $b[1][0] == "pleh"
<br />

<br />
</span><span class="default">$b</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"blah"</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
now $b[1][0] == "blah", but $b[0] == "pleh"
<br />
after serializing and unserializing, slice 1 is no longer a reference to the array itself... I have found no way around this problem... even manually modifying the serialized string from 
<br />
'a:2:{i:0;s:4:"pleh";i:1;a:2:{i:0;s:4:"pleh";i:1;R:3;}}'
<br />
to
<br />
'a:2:{i:0;s:4:"pleh";i:1;R:1;}'
<br />

<br />
to force the second slice to be a reference to the first element of the serialization (the array itself), it seemed to work at first glance, but then unreferences it when you alter it again, observe:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; $testser </span><span class="keyword">= </span><span class="string">'a:2:{i:0;s:4:"pleh";i:1;R:1;}'</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$testser</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"\n-----------------------\n"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tmp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="string">"blah"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">);
<br />
&nbsp;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
outputs:
<br />
Array
<br />
(
<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; pleh
<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; Array
<br />
&nbsp;*RECURSION*
<br />
)
<br />

<br />
-----------------------
<br />
Array
<br />
(
<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; pleh
<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; Array
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; blah
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1] =&gt; Array
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; pleh
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1] =&gt; Array
<br />
&nbsp;*RECURSION*
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )
<br />

<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92284""></a>
  <div class="note">
   <strong class="user">Alessandro Segala</strong>
   <a href="#92284" class="date">17-Jul-2009 05:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed to serialize an array to store it inside a database.<br />
I was looking for a fast, simple way to do serialization, and I came out with 2 options: serialize() or json_encode().<br />
<br />
I ran some benchmarks to see which is the faster, and, surprisingly, I found that serialize() is always between 46% and 96% SLOWER than json_encode().<br />
So, if you don't need to serialize objects and have the json extension available, consider using it instead of serialize().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79187""></a>
  <div class="note">
   <strong class="user">barbuj at NOSPAM dot yahoo dot com</strong>
   <a href="#79187" class="date">14-Nov-2007 11:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In my specific situation, I wanted to be able to pass some data from page to page, but without relying on a session variable. The answer I came up with was to serialize() the object in question, pass it on to the next page as a hidden form field, then unserialize() it. When ALL class variables are public, this worked fine. However, if there was at least one private/protected variable, the code no longer worked as expected ("Fatal error: Call to a member function display() on a non-object in page2.php on line 4")<br />
<br />
As others have already mentioned, private/protected class variables will not behave nicely (private variables are prefixed by class_name + &amp;#65533;, while protected variables are only prefixed by &amp;#65533; - when looking at the page source using Firefox). Internet Explorer does NOT display the extra character between the class name and variable name, but the code still doesn't work as one would expect.<br />
<br />
Suppose you have a simple class:<br />
<br />
testclass.php<br />
=============<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">TestClass </span><span class="keyword">{<br />
&nbsp; var </span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
<br />
&nbsp; function </span><span class="default">display</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"i=" </span><span class="keyword">. </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">i</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
page1.php<br />
=========<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">require_once </span><span class="string">'testclass.php'</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$tc </span><span class="keyword">= new </span><span class="default">TestClass</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$tc</span><span class="keyword">-&gt;</span><span class="default">display</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span>&lt;form method = "post" action = "page2.php"&gt;<br />
&lt;input type = "hidden" name = "str" value = "<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">htmlspecialchars</span><span class="keyword">( </span><span class="default">serialize</span><span class="keyword">( </span><span class="default">$tc </span><span class="keyword">) ); </span><span class="default">?&gt;</span>"&gt;<br />
&lt;input type = "submit"&gt;<br />
&lt;/form&gt;<br />
<br />
page2.php<br />
=========<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">require_once </span><span class="string">'testclass.php'</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$tc </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">( </span><span class="default">stripslashes</span><span class="keyword">( </span><span class="default">htmlspecialchars_decode</span><span class="keyword">( </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">"str"</span><span class="keyword">] ) ) );<br />
&nbsp; </span><span class="default">$tc</span><span class="keyword">-&gt;</span><span class="default">display</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
The fix, suggested by evulish on #php/irc.dal.net, is to replace htmlspecialchars()/htmlspecialchars_decode() by base64_encode()/base64_decode. The code becomes:<br />
<br />
page1.php<br />
=========<br />
&lt;input type = "hidden" name = "str" value = "<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">base64_encode</span><span class="keyword">( </span><span class="default">serialize</span><span class="keyword">( </span><span class="default">$tc </span><span class="keyword">) ); </span><span class="default">?&gt;</span>"&gt;<br />
<br />
page2.php<br />
=========<br />
<span class="default">&lt;?php<br />
&nbsp; $tc </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">( </span><span class="default">base64_decode</span><span class="keyword">( </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">"str"</span><span class="keyword">] ) );<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope this will help someone...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78994""></a>
  <div class="note">
   <strong class="user">Jeex</strong>
   <a href="#78994" class="date">06-Nov-2007 11:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It may be worth noting that, depending on the size of the object you are serializing, the serialize function can take up a lot of memory.<br />
<br />
If your script isn't working as expected, your serialize call may have pushed the memory usage over the limit set by memory_limit in php.ini.<br />
<br />
More info on memory limits here: <a href="http://www.php.net/manual/en/ini.core.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/ini.core.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75859""></a>
  <div class="note">
   <strong class="user">friday13 at ig dot com dot br</strong>
   <a href="#75859" class="date">19-Jun-2007 04:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have problem to use serialize function with hidden form field and the resolution was use htmlentities.<br />
<br />
Ex.:<br />
<br />
&lt;?<br />
<br />
$lista = array( 'pera', 'maca', 'laranja' );<br />
<br />
print "&lt; input type='hidden' name='teste' value='htmlentities( serialize( $lista ) )'" &gt;";<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68220""></a>
  <div class="note">
   <strong class="user">Ates Goral</strong>
   <a href="#68220" class="date">18-Jul-2006 08:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Corrections/clarifications to&nbsp; "Anatomy of a serialize()'ed value":<br />
<br />
All strings appear inside quotes. This applies to string values, object class names and array key names. For example:<br />
<br />
s:3:"foo"<br />
O:7:"MyClass":1:{...<br />
a:2:{s:3:"bar";i:42;...<br />
<br />
Object property names and values are delimited by semi-colons, not colons. For example:<br />
<br />
O:7:"MyClass":2:{s:3:"foo";i:10;s:3:"bar";i:20}<br />
<br />
Double/float values are represented as:<br />
<br />
d:0.23241446</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66147""></a>
  <div class="note">
   <strong class="user">egingell at sisna dot com</strong>
   <a href="#66147" class="date">16-May-2006 02:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&lt;?<br />
/*<br />
Anatomy of a serialize()'ed value:<br />
<br />
&nbsp;String<br />
&nbsp;s:size:value;<br />
<br />
&nbsp;Integer<br />
&nbsp;i:value;<br />
<br />
&nbsp;Boolean<br />
&nbsp;b:value; (does not store "true" or "false", does store '1' or '0')<br />
<br />
&nbsp;Null<br />
&nbsp;N;<br />
<br />
&nbsp;Array<br />
&nbsp;a:size:{key definition;value definition;(repeated per element)}<br />
<br />
&nbsp;Object<br />
&nbsp;O:strlen(object name):object name:object size:{s:strlen(property name):property name:property definition;(repeated per property)}<br />
<br />
&nbsp;String values are always in double quotes<br />
&nbsp;Array keys are always integers or strings<br />
&nbsp;&nbsp;&nbsp; "null =&gt; 'value'" equates to 's:0:"";s:5:"value";',<br />
&nbsp;&nbsp;&nbsp; "true =&gt; 'value'" equates to 'i:1;s:5:"value";',<br />
&nbsp;&nbsp;&nbsp; "false =&gt; 'value'" equates to 'i:0;s:5:"value";',<br />
&nbsp;&nbsp;&nbsp; "array(whatever the contents) =&gt; 'value'" equates to an "illegal offset type" warning because you can't use an<br />
&nbsp;&nbsp;&nbsp; array as a key; however, if you use a variable containing an array as a key, it will equate to 's:5:"Array";s:5:"value";',<br />
&nbsp;&nbsp; &nbsp; and<br />
&nbsp;&nbsp;&nbsp; attempting to use an object as a key will result in the same behavior as using an array will.<br />
*/<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60317""></a>
  <div class="note">
   <strong class="user">MC_Gurk at gmx dot net</strong>
   <a href="#60317" class="date">03-Jan-2006 04:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are going to serialie an object which contains references to other objects you want to serialize some time later, these references will be lost when the object is unserialized.<br />
The references can only be kept if all of your objects are serialized at once.<br />
That means:<br />
<br />
$a = new ClassA(); <br />
$b = new ClassB($a); //$b containes a reference to $a;<br />
<br />
$s1=serialize($a);<br />
$s2=serialize($b);<br />
<br />
$a=unserialize($s1);<br />
$b=unserialize($s2);<br />
<br />
now b references to an object of ClassA which is not $a. $a is another object of Class A.<br />
<br />
use this:<br />
$buf[0]=$a;<br />
$buf[1]=$b;<br />
$s=serialize($buf);<br />
$buf=unserialize($s);<br />
$a=$buf[0];<br />
$b=$buf[1];<br />
<br />
all references are intact.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59330""></a>
  <div class="note">
   <strong class="user">Alexander Podgorny</strong>
   <a href="#59330" class="date">03-Dec-2005 08:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an example of a base class to implement object persistence using serialize and unserialize:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">Persistent
<br />
</span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; var </span><span class="default">$filename</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**********************/
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">Persistent</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename </span><span class="keyword">= </span><span class="default">$filename</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename</span><span class="keyword">)) </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">save</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**********************/
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">save</span><span class="keyword">()
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$f </span><span class="keyword">= @</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename</span><span class="keyword">,</span><span class="string">"w"</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(@</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">,</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">))))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else die(</span><span class="string">"Could not write to file "</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename</span><span class="keyword">.</span><span class="string">" at Persistant::save"</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else die(</span><span class="string">"Could not open file "</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename</span><span class="keyword">.</span><span class="string">" for writing, at Persistant::save"</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**********************/
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">open</span><span class="keyword">()
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vars </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">filename</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$vars </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; eval(</span><span class="string">"$"</span><span class="keyword">.</span><span class="string">"this-&gt;</span><span class="default">$key</span><span class="string"> = $"</span><span class="keyword">.</span><span class="string">"vars['"</span><span class="keyword">.</span><span class="string">"</span><span class="default">$key</span><span class="string">'];"</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**********************/
<br />
</span><span class="keyword">}
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
When an object is extended from this one it can be easily saved and re-opened using it's own methods as follows:
<br />

<br />
&lt;?
<br />

<br />
class foo extends Persistent
<br />
{
<br />
&nbsp;&nbsp; var $counter;
<br />
&nbsp;&nbsp; function inc()
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; $this-&gt;counter++;
<br />
&nbsp;&nbsp; }
<br />
}
<br />

<br />
$fooObj = new $foo;
<br />
$foo-&gt;open();
<br />
print $foo-&gt;counter; // displays incrementing integer as page reloads
<br />
$foo-&gt;inc();
<br />
$foo-&gt;save();
<br />

<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58356""></a>
  <div class="note">
   <strong class="user">stephen dot adamson at smius dot com</strong>
   <a href="#58356" class="date">01-Nov-2005 06:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are serializing an object to store it in the database, using __sleep() can save you some space. The following code will not store empty (null) variables in the serialized string. For my purposes this saved a lot of space, since some of the member variables would not be given values.<br />
<br />
function __sleep()<br />
{<br />
&nbsp;&nbsp;&nbsp; $allVars = get_object_vars($this);<br />
&nbsp;&nbsp;&nbsp; $toReturn = array();<br />
&nbsp;&nbsp;&nbsp; foreach(array_keys($allVars) as $name)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset($this-&gt;$name))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $toReturn[] = $name;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $toReturn;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48239""></a>
  <div class="note">
   <strong class="user">wiart at yahoo dot com</strong>
   <a href="#48239" class="date">16-Dec-2004 12:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning: on 64 bits machines,&nbsp; if you use a long string only composed of numbers as a key in an array and serialize/unserialize it, you can run into problems:<br />
<br />
an example code:<br />
$arr["20041001103319"] = 'test';<br />
var_dump( $arr);<br />
$arr_in_str = serialize($arr);<br />
print "Now result is: $arr_in_str&lt;BR /&gt;";<br />
$final_arr = unserialize($arr_in_str);<br />
print "The final unserialized array:&lt;BR /&gt;";<br />
var_dump($final_arr);<br />
<br />
The result:<br />
array(1) { [20041001103319]=&gt;&nbsp; string(4) "test" } <br />
Now result is: a:1:{i:20041001103319;s:4:"test";}<br />
The final unserialized array:<br />
array(1) { [683700183]=&gt; string(4) "test" }<br />
<br />
As you can see, the original array :<br />
$arr["20041001103319"] = "test"<br />
<br />
after serialize/unserialize is:<br />
$arr[683700183] = "test"<br />
<br />
As you can see,&nbsp; the key has changed ...<br />
<br />
Apparently a problem of implicit casting + integer overflow (I posted a PHP bug report: <a href="http://bugs.php.net/bug.php?id=31117" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=31117</a>)<br />
<br />
I tested with the latest 4.3.10 compiled on my laptop (32 bits, Mandrake 9.1) --&gt; no such problem. But compiled on AMD 64 bits (Red Hat Taroon), the problem is present.<br />
<br />
Hope this will help some of you to not loose almost a whole day of debugging ;-)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47509""></a>
  <div class="note">
   <strong class="user">paul at moveNOtoSPAMiceland DOT com</strong>
   <a href="#47509" class="date">18-Nov-2004 05:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was trying to submit a serialized array through a hidden form field using POST and was having a lot of trouble with the quotes. I couldn't figure out a way to escape the quotes in the string so that they'd show up right inside the form, so only the characters up to the first set of quotes were being sent.<br />
<br />
My solution was to base64_encode() the string, put that in the hidden form field, and send that through the POST method. Then I decoded it (using base64_decode()) on the other end. This seemed to solve the problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41775""></a>
  <div class="note">
   <strong class="user">hfuecks at phppatterns dot com</strong>
   <a href="#41775" class="date">22-Apr-2004 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding serializing PHP data types to Javascript, following Ivans note below, theres an example at <a href="http://www.tekool.net/php/js_serializer/." rel="nofollow" target="_blank">http://www.tekool.net/php/js_serializer/.</a><br />
<br />
The basic serialization looks good although, in its current form, it works on the basis of generating Javascript source which a browser executes as a page loads. Using Javascripts eval() the same can be done with strings containing Javascript if youre working with something like XMLHTTPRequest</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29079""></a>
  <div class="note">
   <strong class="user">pli9 at itsa dot ucsf dot edu</strong>
   <a href="#29079" class="date">01-Feb-2003 08:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have also written some code for importing serialized PHP data into PERL and then writing it back into PHP.&nbsp; I think the similar library posted above is actually more robust for a few select cases, but mine is more compact and a little easier to follow.&nbsp; I'd really like comments if anyone finds this useful or has improvements.&nbsp; Please credit me if you use my code.<br />
<br />
<a href="http://www.hcs.harvard.edu/~pli/code/serialPHP.pm" rel="nofollow" target="_blank">http://www.hcs.harvard.edu/~pli/code/serialPHP.pm</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="3918""></a>
  <div class="note">
   <strong class="user">MarkRoedel at letu dot edu</strong>
   <a href="#3918" class="date">22-Feb-2000 07:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A call to serialize() appears to mess with the array's internal pointer.&nbsp; If you're going to be walking through your array after serializing it, you'll want to make a call to reset() first.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
