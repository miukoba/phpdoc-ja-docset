<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>基本的な SimpleXML の使用法</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="simplexml.examples.html">≪ 例</a></li>
      <li style="float: right;"><a href="simplexml.examples-errors.html">XML エラーの対応 ≫</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="simplexml.examples.html">例</a></li>
    <li>基本的な SimpleXML の使用法</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="simplexml.examples-basic" class="section">
  <h2 class="title">基本的な SimpleXML の使用法</h2>
  <p class="para">
   このリファレンスの多くの例では XML 文字列を必要とします。各例で
   この文字列をくり返す代わりに、あるファイルにこの文字列を保存して、
   各例で読みこむことにします。この読みこまれるファイルは、以下の例
   に関するセクションで使用されます。
   もしくは、XMLドキュメントを作成し、
   <span class="function"><a href="function.simplexml-load-file.html" class="function">simplexml_load_file()</a></span> により読みこむことも
   可能です。
  </p>
  <p class="para">
   <div class="example" id="example-5568">
    <p><strong>例1 XML 文字列を設定するインクルードファイル example.php</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$xmlstr&nbsp;</span><span style="color: #007700">=&nbsp;&lt;&lt;&lt;XML<br /></span><span style="color: #DD0000">&lt;?xml&nbsp;version='1.0'&nbsp;standalone='yes'?&gt;<br />&lt;movies&gt;<br />&nbsp;&lt;movie&gt;<br />&nbsp;&nbsp;&lt;title&gt;PHP:&nbsp;Behind&nbsp;the&nbsp;Parser&lt;/title&gt;<br />&nbsp;&nbsp;&lt;characters&gt;<br />&nbsp;&nbsp;&nbsp;&lt;character&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;Ms.&nbsp;Coder&lt;/name&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;actor&gt;Onlivia&nbsp;Actora&lt;/actor&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/character&gt;<br />&nbsp;&nbsp;&nbsp;&lt;character&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;Mr.&nbsp;Coder&lt;/name&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;actor&gt;El&nbsp;Act&amp;#211;r&lt;/actor&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/character&gt;<br />&nbsp;&nbsp;&lt;/characters&gt;<br />&nbsp;&nbsp;&lt;plot&gt;<br />&nbsp;&nbsp;&nbsp;So,&nbsp;this&nbsp;language.&nbsp;It's&nbsp;like,&nbsp;a&nbsp;programming&nbsp;language.&nbsp;Or&nbsp;is&nbsp;it&nbsp;a<br />&nbsp;&nbsp;&nbsp;scripting&nbsp;language?&nbsp;All&nbsp;is&nbsp;revealed&nbsp;in&nbsp;this&nbsp;thrilling&nbsp;horror&nbsp;spoof<br />&nbsp;&nbsp;&nbsp;of&nbsp;a&nbsp;documentary.<br />&nbsp;&nbsp;&lt;/plot&gt;<br />&nbsp;&nbsp;&lt;great-lines&gt;<br />&nbsp;&nbsp;&nbsp;&lt;line&gt;PHP&nbsp;solves&nbsp;all&nbsp;my&nbsp;web&nbsp;problems&lt;/line&gt;<br />&nbsp;&nbsp;&lt;/great-lines&gt;<br />&nbsp;&nbsp;&lt;rating&nbsp;type="thumbs"&gt;7&lt;/rating&gt;<br />&nbsp;&nbsp;&lt;rating&nbsp;type="stars"&gt;5&lt;/rating&gt;<br />&nbsp;&lt;/movie&gt;<br />&lt;/movies&gt;<br /></span><span style="color: #007700">XML;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   SimpleXML の容易さが最も明確に現われるのは、
   簡単な XML ドキュメントから文字列または数字を展開する時です。
   <div class="example" id="example-5569">
    <p><strong>例2 <em>&lt;plot&gt;</em> を取得する</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'example.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$movies&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SimpleXMLElement</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">movie</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">plot</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>

   So, this language. It&#039;s like, a programming language. Or is it a
   scripting language? All is revealed in this thrilling horror spoof
   of a documentary.

</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   XML ドキュメント内の要素のうち、PHP の命名規約で許可されていない文字
   (たとえばハイフンなど) を含む名前のものにアクセスするには、
   要素名を括弧とアポストロフィで囲みます。
   <div class="example" id="example-5570">
    <p><strong>例3 <em>&lt;line&gt;</em> を取得する</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'example.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$movies&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SimpleXMLElement</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">movie</span><span style="color: #007700">-&gt;{</span><span style="color: #DD0000">'great-lines'</span><span style="color: #007700">}-&gt;</span><span style="color: #0000BB">line</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
PHP solves all my web problems
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-5571">
    <p><strong>例4 SimpleXML でユニークでない要素にアクセスする</strong></p>
    <div class="example-contents"><p>
     単一の親要素の子要素としてある要素のインスタンスが複数存在する時、
     通常の反復処理を適用することができます。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'example.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$movies&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SimpleXMLElement</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;個々の&nbsp;&lt;character&gt;&nbsp;ノードに対して、&lt;name&gt;&nbsp;を分割して表示します&nbsp;*/<br /></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">movie</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">characters</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">character&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$character</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$character</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&nbsp;played&nbsp;by&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$character</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">actor</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Ms. Coder played by Onlivia Actora
Mr. Coder played by El ActOr
</pre></div>
    </div>
   </div>
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    プロパティ (先ほどの例の <em>$movies-&gt;movie</em>)
    は配列ではありません。<a href="class.iterator.html" class="link">反復処理</a> と
    <a href="class.arrayaccess.html" class="link">配列形式でのアクセス</a> ができるオブジェクトです。
   </p>
  </p></blockquote>
  <p class="para">
   <div class="example" id="example-5572">
    <p><strong>例5 属性を使用する</strong></p>
    <div class="example-contents"><p>
     ここまでは、要素の名前と値を読む方法のみを扱って来ました。
     SimpleXML は要素の属性にアクセスすることも可能です。
     要素の属性にアクセスする方法は、<span class="type"><span class="type 配列">配列</span></span> の要素に
     アクセスするのと全く同じです。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'example.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$movies&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SimpleXMLElement</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;最初の映画の&nbsp;&lt;rating&gt;&nbsp;ノードにアクセスします。<br />&nbsp;*&nbsp;また、その評価も出力します。*/<br /></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">movie</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">rating&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$rating</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;switch((string)&nbsp;</span><span style="color: #0000BB">$rating</span><span style="color: #007700">[</span><span style="color: #DD0000">'type'</span><span style="color: #007700">])&nbsp;{&nbsp;</span><span style="color: #FF8000">//&nbsp;要素のインデックスとして、属性を取得します<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">case&nbsp;</span><span style="color: #DD0000">'thumbs'</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$rating</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&nbsp;thumbs&nbsp;up'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #DD0000">'stars'</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$rating</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&nbsp;stars'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
7 thumbs up5 stars
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-5573">
    <p><strong>例6 要素および属性をテキストと比較する</strong></p>
    <div class="example-contents"><p>
     要素または属性を文字列と比較する、もしくは、文字列を引数とする関数に
     渡すには、<em>(string)</em> により文字列にキャストする
     必要があります。さもないと、PHP はこの要素をオブジェクトとして扱います。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'example.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$movies&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SimpleXMLElement</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">);<br /><br />if&nbsp;((string)&nbsp;</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">movie</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">title&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'PHP:&nbsp;Behind&nbsp;the&nbsp;Parser'</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'My&nbsp;favorite&nbsp;movie.'</span><span style="color: #007700">;<br />}<br /><br />echo&nbsp;</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">((string)&nbsp;</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">movie</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">title</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
My favorite movie.PHP: Behind the Parser
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-5574">
    <p><strong>例7 ふたつの要素の比較</strong></p>
    <div class="example-contents"><p>
     PHP 5.2.0 以降、たとえ同一の要素を指していたとしても
     2 つの SimpleXMLElements は異なるものと見なされます。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'example.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$movies1&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SimpleXMLElement</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$movies2&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SimpleXMLElement</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$movies1&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">$movies2</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;PHP&nbsp;5.2.0&nbsp;以降では&nbsp;false<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
bool(false)
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-5575">
    <p><strong>例8 XPath の使用</strong></p>
    <div class="example-contents"><p>
     SimpleXML は、<acronym title="XML Path Language">XPath</acronym> を標準でサポートしています。
     <em>&lt;character&gt;</em> 要素をすべて見つけるには、
     以下のようにします。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'example.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$movies&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SimpleXMLElement</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">);<br /><br />foreach&nbsp;(</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">xpath</span><span style="color: #007700">(</span><span style="color: #DD0000">'//character'</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$character</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$character</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'played&nbsp;by&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$character</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">actor</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
     &#039;<em>//</em>&#039; はワイルドカードとして動作します。絶対パスを指定するには、
     スラッシュを一つだけにします。
    </p></div>
    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Ms. Coder played by Onlivia Actora
Mr. Coder played by El ActOr
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-5576">
    <p><strong>例9 値を設定する</strong></p>
    <div class="example-contents"><p>
     SimpleXMLの中のデータは、定数とすることができません。
     オブジェクトは、その全ての要素について変更が可能です。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'example.php'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$movies&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SimpleXMLElement</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">movie</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">characters</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">character</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Miss&nbsp;Coder'</span><span style="color: #007700">;<br /><br />echo&nbsp;</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">asXML</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
&lt;?xml version=&quot;1.0&quot; standalone=&quot;yes&quot;?&gt;
&lt;movies&gt;
 &lt;movie&gt;
  &lt;title&gt;PHP: Behind the Parser&lt;/title&gt;
  &lt;characters&gt;
   &lt;character&gt;
    &lt;name&gt;Miss Coder&lt;/name&gt;
    &lt;actor&gt;Onlivia Actora&lt;/actor&gt;
   &lt;/character&gt;
   &lt;character&gt;
    &lt;name&gt;Mr. Coder&lt;/name&gt;
    &lt;actor&gt;El Act&amp;#xD3;r&lt;/actor&gt;
   &lt;/character&gt;
  &lt;/characters&gt;
  &lt;plot&gt;
   So, this language. It&#039;s like, a programming language. Or is it a
   scripting language? All is revealed in this thrilling horror spoof
   of a documentary.
  &lt;/plot&gt;
  &lt;great-lines&gt;
   &lt;line&gt;PHP solves all my web problems&lt;/line&gt;
  &lt;/great-lines&gt;
  &lt;rating type=&quot;thumbs&quot;&gt;7&lt;/rating&gt;
  &lt;rating type=&quot;stars&quot;&gt;5&lt;/rating&gt;
 &lt;/movie&gt;
&lt;/movies&gt;
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-5577">
    <p><strong>例10 要素と属性を追加する</strong></p>
    <div class="example-contents"><p>
     PHP 5.1.3 以降では、SimpleXML を使用して簡単に子要素および属性を追加することができます。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'example.php'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$movies&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SimpleXMLElement</span><span style="color: #007700">(</span><span style="color: #0000BB">$xmlstr</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$character&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">movie</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">characters</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addChild</span><span style="color: #007700">(</span><span style="color: #DD0000">'character'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$character</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addChild</span><span style="color: #007700">(</span><span style="color: #DD0000">'name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Mr.&nbsp;Parser'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$character</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addChild</span><span style="color: #007700">(</span><span style="color: #DD0000">'actor'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'John&nbsp;Doe'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$rating&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">movie</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">addChild</span><span style="color: #007700">(</span><span style="color: #DD0000">'rating'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'PG'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$rating</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addAttribute</span><span style="color: #007700">(</span><span style="color: #DD0000">'type'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'mpaa'</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$movies</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">asXML</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
&lt;?xml version=&quot;1.0&quot; standalone=&quot;yes&quot;?&gt;
&lt;movies&gt;
 &lt;movie&gt;
  &lt;title&gt;PHP: Behind the Parser&lt;/title&gt;
  &lt;characters&gt;
   &lt;character&gt;
    &lt;name&gt;Ms. Coder&lt;/name&gt;
    &lt;actor&gt;Onlivia Actora&lt;/actor&gt;
   &lt;/character&gt;
   &lt;character&gt;
    &lt;name&gt;Mr. Coder&lt;/name&gt;
    &lt;actor&gt;El Act&amp;#xD3;r&lt;/actor&gt;
   &lt;/character&gt;
  &lt;character&gt;&lt;name&gt;Mr. Parser&lt;/name&gt;&lt;actor&gt;John Doe&lt;/actor&gt;&lt;/character&gt;&lt;/characters&gt;
  &lt;plot&gt;
   So, this language. It&#039;s like, a programming language. Or is it a
   scripting language? All is revealed in this thrilling horror spoof
   of a documentary.
  &lt;/plot&gt;
  &lt;great-lines&gt;
   &lt;line&gt;PHP solves all my web problems&lt;/line&gt;
  &lt;/great-lines&gt;
  &lt;rating type=&quot;thumbs&quot;&gt;7&lt;/rating&gt;
  &lt;rating type=&quot;stars&quot;&gt;5&lt;/rating&gt;
 &lt;rating type=&quot;mpaa&quot;&gt;PG&lt;/rating&gt;&lt;/movie&gt;
&lt;/movies&gt;
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-5578">
    <p><strong>例11 DOM との相互運用性</strong></p>
    <div class="example-contents"><p>
     PHP は、SimpleXML 形式と DOM 形式の間で XML ノードを変換する機構を有しています。
     この例では、DOM 要素を SimpleXML に変換することができます。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$dom&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">DOMDocument</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$dom</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">loadXML</span><span style="color: #007700">(</span><span style="color: #DD0000">'&lt;books&gt;&lt;book&gt;&lt;title&gt;blah&lt;/title&gt;&lt;/book&gt;&lt;/books&gt;'</span><span style="color: #007700">);<br />if&nbsp;(!</span><span style="color: #0000BB">$dom</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Error&nbsp;while&nbsp;parsing&nbsp;the&nbsp;document'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br /></span><span style="color: #0000BB">$books&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">simplexml_import_dom</span><span style="color: #007700">(</span><span style="color: #0000BB">$dom</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #0000BB">$books</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">book</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">title</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
blah
</pre></div>
    </div>
   </div>
  </p>
 </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113792""></a>
  <div class="note">
   <strong class="user">RiKdnUA at mail dot ru</strong>
   <a href="#113792" class="date">03-Dec-2013 06:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Если кодировка XML-документа отличается от UTF-8, объявление кодировки должно следовать сразу после version='...' и перед standalone='...'. Это требование стандарта XML. <br />
<br />
If encoding XML-document differs from UTF-8. Encoding declaration should follow immediately after the version = '...' and before standalone = '...'. This requirement is standard XML. <br />
<br />
&lt;?xml version='1.0' encoding='windows-1251' standalone='yes'?&gt;<br />
Ok<br />
&lt;?xml version='1.0' standalone='yes' encoding='windows-1251'?&gt;<br />
&lt;body&gt;Русский язык. Russian language&lt;/body&gt;<br />
Fatal error: Uncaught exception 'Exception' with message 'String could not be parsed as XML' in...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113423""></a>
  <div class="note">
   <strong class="user">eng dot emad_2010 at yahoo dot com</strong>
   <a href="#113423" class="date">09-Oct-2013 08:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example #&nbsp; DOM Interoperability ??????? ??????&nbsp; &nbsp; <br />
PHP has a mechanism to convert XML nodes between SimpleXML and DOM formats. This example shows how one might change a DOM element to SimpleXML&nbsp; . <br />
The simplexml_import_dom() function returns a SimpleXMLElement object from a DOM node.<br />
DOM&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; object<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//create DOM&nbsp; document $dom that contain XML<br />
</span><span class="default">$dom </span><span class="keyword">= new </span><span class="default">DOMDocument</span><span class="keyword">;<br />
</span><span class="default">$dom</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;books&gt;&lt;book&gt;&lt;title&gt;blah&lt;/title&gt;&lt;/book&gt;&lt;/books&gt;'</span><span class="keyword">);<br />
if (!</span><span class="default">$dom</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Error while parsing the document'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; exit;<br />
}<br />
</span><span class="comment">//convert DOM document $dom to object $books <br />
</span><span class="default">$books </span><span class="keyword">= </span><span class="default">simplexml_import_dom</span><span class="keyword">(</span><span class="default">$dom</span><span class="keyword">);<br />
<br />
</span><span class="comment">//access object $books <br />
</span><span class="keyword">echo </span><span class="default">$books</span><span class="keyword">-&gt;</span><span class="default">book</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]-&gt;</span><span class="default">title</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112824""></a>
  <div class="note">
   <strong class="user">dmitron1036 at mail dot ru</strong>
   <a href="#112824" class="date">27-Jul-2013 03:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello, everyboady!<br />
How can I change attributes in xml object?<br />
like this:<br />
$children[0]["@attributes"]['x'] = '0';<br />
<br />
I try:<br />
$children = $xml-&gt;children();<br />
var_dump($children[0]["@attributes"]);//"NULL"<br />
var_dump($children[0]);//(2) ["@attributes"]=&gt;array(1) {['x']=&gt; string(1) '2'}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111643""></a>
  <div class="note">
   <strong class="user">jishcem at gmail dot com</strong>
   <a href="#111643" class="date">12-Mar-2013 04:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For me it was easier to use arrays than objects, <br />
<br />
So, I used this code, <br />
<br />
$xml = simplexml_load_file('xml_file.xml');<br />
&nbsp;&nbsp;&nbsp; <br />
$json_string = json_encode($xml);<br />
&nbsp;&nbsp;&nbsp; <br />
$result_array = json_decode($json_string, TRUE);<br />
<br />
Hope it would help someone</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102599""></a>
  <div class="note">
   <strong class="user">gkokmdam at zonnet dot nl</strong>
   <a href="#102599" class="date">23-Feb-2011 10:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A quick tip on xpath queries and default namespaces. It looks like the XML-system behind SimpleXML has the same workings as I believe the XML-system .NET uses: when one needs to address something in the default namespace, one will have to declare the namespace using registerXPathNamespace and then use its prefix to address the otherwise in the default namespace living element.<br />
<br />
<span class="default">&lt;?php<br />
$string </span><span class="keyword">= &lt;&lt;&lt;XML<br />
</span><span class="string">&lt;?xml version='1.0'?&gt; <br />
&lt;document xmlns="<a href="http://www.w3.org/2005/Atom" rel="nofollow" target="_blank">http://www.w3.org/2005/Atom</a>"&gt;<br />
&nbsp;&lt;title&gt;Forty What?&lt;/title&gt;<br />
&nbsp;&lt;from&gt;Joe&lt;/from&gt;<br />
&nbsp;&lt;to&gt;Jane&lt;/to&gt;<br />
&nbsp;&lt;body&gt;<br />
&nbsp; I know that's the answer -- but what's the question?<br />
&nbsp;&lt;/body&gt;<br />
&lt;/document&gt;<br />
</span><span class="keyword">XML;<br />
<br />
</span><span class="default">$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">registerXPathNamespace</span><span class="keyword">(</span><span class="string">"def"</span><span class="keyword">, </span><span class="string">"<a href="http://www.w3.org/2005/Atom" rel="nofollow" target="_blank">http://www.w3.org/2005/Atom</a>"</span><span class="keyword">);<br />
<br />
</span><span class="default">$nodes </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">xpath</span><span class="keyword">(</span><span class="string">"//def:document/def:title"</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102167""></a>
  <div class="note">
   <strong class="user">kdos</strong>
   <a href="#102167" class="date">31-Jan-2011 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using stuff like: is_object($xml-&gt;module-&gt;admin) to check if there actually is a node called "admin", doesn't seem to work as expected, since simplexml always returns an object- in that case an empty one&nbsp; - even if a particular node does not exist. <br />
For me good old empty() function seems to work just fine in such cases.<br />
<br />
Cheers</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98523""></a>
  <div class="note">
   <strong class="user">Max K.</strong>
   <a href="#98523" class="date">20-Jun-2010 11:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
From the README file:<br />
<br />
SimpleXML is meant to be an easy way to access XML data.<br />
<br />
SimpleXML objects follow four basic rules:<br />
<br />
1) properties denote element iterators<br />
2) numeric indices denote elements<br />
3) non numeric indices denote attributes<br />
4) string conversion allows to access TEXT data<br />
<br />
When iterating properties then the extension always iterates over<br />
all nodes with that element name. Thus method children() must be <br />
called to iterate over subnodes. But also doing the following:<br />
foreach ($obj-&gt;node_name as $elem) {<br />
&nbsp; // do something with $elem<br />
}<br />
always results in iteration of 'node_name' elements. So no further <br />
check is needed to distinguish the number of nodes of that type.<br />
<br />
When an elements TEXT data is being accessed through a property<br />
then the result does not include the TEXT data of subelements.<br />
<br />
Known issues<br />
============<br />
<br />
Due to engine problems it is currently not possible to access<br />
a subelement by index 0: $object-&gt;property[0].</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97111""></a>
  <div class="note">
   <strong class="user">ie dot raymond at gmail dot com</strong>
   <a href="#97111" class="date">02-Apr-2010 12:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need to output valid xml in your response, don't forget to set your header content type to xml in addition to echoing out the result of asXML():
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
$xml</span><span class="keyword">=</span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="string">'...'</span><span class="keyword">);
<br />
...
<br />
...</span><span class="default">xml stuff
<br />
</span><span class="keyword">...
<br />

<br />
</span><span class="comment">//output xml in your response:
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Type: text/xml'</span><span class="keyword">);
<br />
echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95282""></a>
  <div class="note">
   <strong class="user">php at keith tyler dot com</strong>
   <a href="#95282" class="date">23-Dec-2009 09:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editor's Note: The SimpleXMLIterator class, however, does implement these methods.]
<br />

<br />
While SimpleXMLElement claims to be iterable, it does not seem to implement the standard Iterator interface functions like ::next and ::reset properly. Therefore while foreach() works, functions like next(), current(), or each() don't seem to work as you would expect -- the pointer never seems to move or keeps getting reset.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93263""></a>
  <div class="note">
   <strong class="user">bjorn at xQmail dot eu</strong>
   <a href="#93263" class="date">31-Aug-2009 04:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're not sure the XML will be valid you'd better use:<br />
<br />
<span class="default">&lt;?php<br />
$xmlObject </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
</span><span class="comment">// or<br />
</span><span class="default">$xmlObject </span><span class="keyword">= </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">xml</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Both of these return a SimpleXMLElement Object or a libXMLError Object.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90490""></a>
  <div class="note">
   <strong class="user">radams at circlepix com</strong>
   <a href="#90490" class="date">24-Apr-2009 07:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To test whether an element exists: <br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; $xml </span><span class="keyword">= &lt;&lt;&lt;EOT<br />
</span><span class="string">&lt;?xml version='1.0' standalone='yes'?&gt;<br />
&lt;root&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;test1&gt;&lt;/test1&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;test2 /&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;test4&gt; &lt;/test4&gt;<br />
&lt;/root&gt;<br />
</span><span class="keyword">EOT;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xmlDoc </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
<br />
echo </span><span class="string">"Test1: \n"</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$xmlDoc</span><span class="keyword">-&gt;</span><span class="default">test1</span><span class="keyword">);<br />
echo </span><span class="string">"\n(" </span><span class="keyword">. (bool)</span><span class="default">$xmlDoc</span><span class="keyword">-&gt;</span><span class="default">test1 </span><span class="keyword">. </span><span class="string">")"</span><span class="keyword">;<br />
echo </span><span class="string">"\n\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="string">"Test2: \n"</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$xmlDoc</span><span class="keyword">-&gt;</span><span class="default">test2</span><span class="keyword">);<br />
echo </span><span class="string">"\n(" </span><span class="keyword">. (bool)</span><span class="default">$xmlDoc</span><span class="keyword">-&gt;</span><span class="default">test2 </span><span class="keyword">. </span><span class="string">")"</span><span class="keyword">;<br />
echo </span><span class="string">"\n\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="string">"Test3: \n"</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$xmlDoc</span><span class="keyword">-&gt;</span><span class="default">test3</span><span class="keyword">);<br />
echo </span><span class="string">"\n(" </span><span class="keyword">. (bool)</span><span class="default">$xmlDoc</span><span class="keyword">-&gt;</span><span class="default">test3 </span><span class="keyword">. </span><span class="string">")"</span><span class="keyword">;<br />
echo </span><span class="string">"\n\n"</span><span class="keyword">;<br />
<br />
echo </span><span class="string">"Test4: \n"</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$xmlDoc</span><span class="keyword">-&gt;</span><span class="default">test4</span><span class="keyword">);<br />
echo </span><span class="string">"\n(" </span><span class="keyword">. (bool)</span><span class="default">$xmlDoc</span><span class="keyword">-&gt;</span><span class="default">test4 </span><span class="keyword">. </span><span class="string">")"</span><span class="keyword">;<br />
echo </span><span class="string">"\n\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The var_dumps for test1, test2, and test3 are identical, but the (bool) test gives a '1' for test1 and test2, and a '' for test3.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
